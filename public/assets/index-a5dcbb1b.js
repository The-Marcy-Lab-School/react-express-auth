var Dae=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Tb=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)};var nYe=Dae((Va,ja)=>{function HY(t,e){for(var i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in t)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();function F1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var GY={exports:{}},aP={},VY={exports:{}},Ri={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z1=Symbol.for("react.element"),Iae=Symbol.for("react.portal"),Lae=Symbol.for("react.fragment"),Bae=Symbol.for("react.strict_mode"),Oae=Symbol.for("react.profiler"),Uae=Symbol.for("react.provider"),Nae=Symbol.for("react.context"),Fae=Symbol.for("react.forward_ref"),zae=Symbol.for("react.suspense"),Hae=Symbol.for("react.memo"),Gae=Symbol.for("react.lazy"),fG=Symbol.iterator;function Vae(t){return t===null||typeof t!="object"?null:(t=fG&&t[fG]||t["@@iterator"],typeof t=="function"?t:null)}var jY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WY=Object.assign,qY={};function P0(t,e,i){this.props=t,this.context=e,this.refs=qY,this.updater=i||jY}P0.prototype.isReactComponent={};P0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};P0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function XY(){}XY.prototype=P0.prototype;function vN(t,e,i){this.props=t,this.context=e,this.refs=qY,this.updater=i||jY}var bN=vN.prototype=new XY;bN.constructor=vN;WY(bN,P0.prototype);bN.isPureReactComponent=!0;var mG=Array.isArray,YY=Object.prototype.hasOwnProperty,xN={current:null},KY={key:!0,ref:!0,__self:!0,__source:!0};function JY(t,e,i){var r,n={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)YY.call(e,r)&&!KY.hasOwnProperty(r)&&(n[r]=e[r]);var a=arguments.length-2;if(a===1)n.children=i;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];n.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)n[r]===void 0&&(n[r]=a[r]);return{$$typeof:z1,type:t,key:s,ref:o,props:n,_owner:xN.current}}function jae(t,e){return{$$typeof:z1,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wN(t){return typeof t=="object"&&t!==null&&t.$$typeof===z1}function Wae(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(i){return e[i]})}var gG=/\/+/g;function ok(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Wae(""+t.key):e.toString(36)}function dM(t,e,i,r,n){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case z1:case Iae:o=!0}}if(o)return o=t,n=n(o),t=r===""?"."+ok(o,0):r,mG(n)?(i="",t!=null&&(i=t.replace(gG,"$&/")+"/"),dM(n,e,i,"",function(u){return u})):n!=null&&(wN(n)&&(n=jae(n,i+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(gG,"$&/")+"/")+t)),e.push(n)),1;if(o=0,r=r===""?".":r+":",mG(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+ok(s,a);o+=dM(s,e,i,l,n)}else if(l=Vae(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+ok(s,a++),o+=dM(s,e,i,l,n);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _S(t,e,i){if(t==null)return t;var r=[],n=0;return dM(t,r,"","",function(s){return e.call(i,s,n++)}),r}function qae(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(i){(t._status===0||t._status===-1)&&(t._status=1,t._result=i)},function(i){(t._status===0||t._status===-1)&&(t._status=2,t._result=i)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jo={current:null},pM={transition:null},Xae={ReactCurrentDispatcher:Jo,ReactCurrentBatchConfig:pM,ReactCurrentOwner:xN};Ri.Children={map:_S,forEach:function(t,e,i){_S(t,function(){e.apply(this,arguments)},i)},count:function(t){var e=0;return _S(t,function(){e++}),e},toArray:function(t){return _S(t,function(e){return e})||[]},only:function(t){if(!wN(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ri.Component=P0;Ri.Fragment=Lae;Ri.Profiler=Oae;Ri.PureComponent=vN;Ri.StrictMode=Bae;Ri.Suspense=zae;Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xae;Ri.cloneElement=function(t,e,i){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=WY({},t.props),n=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=xN.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)YY.call(e,l)&&!KY.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=i;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:z1,type:t.type,key:n,ref:s,props:r,_owner:o}};Ri.createContext=function(t){return t={$$typeof:Nae,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Uae,_context:t},t.Consumer=t};Ri.createElement=JY;Ri.createFactory=function(t){var e=JY.bind(null,t);return e.type=t,e};Ri.createRef=function(){return{current:null}};Ri.forwardRef=function(t){return{$$typeof:Fae,render:t}};Ri.isValidElement=wN;Ri.lazy=function(t){return{$$typeof:Gae,_payload:{_status:-1,_result:t},_init:qae}};Ri.memo=function(t,e){return{$$typeof:Hae,type:t,compare:e===void 0?null:e}};Ri.startTransition=function(t){var e=pM.transition;pM.transition={};try{t()}finally{pM.transition=e}};Ri.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ri.useCallback=function(t,e){return Jo.current.useCallback(t,e)};Ri.useContext=function(t){return Jo.current.useContext(t)};Ri.useDebugValue=function(){};Ri.useDeferredValue=function(t){return Jo.current.useDeferredValue(t)};Ri.useEffect=function(t,e){return Jo.current.useEffect(t,e)};Ri.useId=function(){return Jo.current.useId()};Ri.useImperativeHandle=function(t,e,i){return Jo.current.useImperativeHandle(t,e,i)};Ri.useInsertionEffect=function(t,e){return Jo.current.useInsertionEffect(t,e)};Ri.useLayoutEffect=function(t,e){return Jo.current.useLayoutEffect(t,e)};Ri.useMemo=function(t,e){return Jo.current.useMemo(t,e)};Ri.useReducer=function(t,e,i){return Jo.current.useReducer(t,e,i)};Ri.useRef=function(t){return Jo.current.useRef(t)};Ri.useState=function(t){return Jo.current.useState(t)};Ri.useSyncExternalStore=function(t,e,i){return Jo.current.useSyncExternalStore(t,e,i)};Ri.useTransition=function(){return Jo.current.useTransition()};Ri.version="18.2.0";VY.exports=Ri;var se=VY.exports;const Ho=F1(se),yG=HY({__proto__:null,default:Ho},[se]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yae=se,Kae=Symbol.for("react.element"),Jae=Symbol.for("react.fragment"),Qae=Object.prototype.hasOwnProperty,Zae=Yae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$ae={key:!0,ref:!0,__self:!0,__source:!0};function QY(t,e,i){var r,n={},s=null,o=null;i!==void 0&&(s=""+i),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Qae.call(e,r)&&!$ae.hasOwnProperty(r)&&(n[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:Kae,type:t,key:s,ref:o,props:n,_owner:Zae.current}}aP.Fragment=Jae;aP.jsx=QY;aP.jsxs=QY;GY.exports=aP;var U=GY.exports,XI={},ZY={exports:{}},Qa={},$Y={exports:{}},eK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var V=B.length;B.push(j);e:for(;0<V;){var q=V-1>>>1,K=B[q];if(0<n(K,j))B[q]=j,B[V]=K,V=q;else break e}}function i(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var j=B[0],V=B.pop();if(V!==j){B[0]=V;e:for(var q=0,K=B.length,le=K>>>1;q<le;){var Z=2*(q+1)-1,oe=B[Z],ae=Z+1,ve=B[ae];if(0>n(oe,V))ae<K&&0>n(ve,oe)?(B[q]=ve,B[ae]=V,q=ae):(B[q]=oe,B[Z]=V,q=Z);else if(ae<K&&0>n(ve,V))B[q]=ve,B[ae]=V,q=ae;else break e}}return j}function n(B,j){var V=B.sortIndex-j.sortIndex;return V!==0?V:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,p=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(B){for(var j=i(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=B)r(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=i(u)}}function _(B){if(m=!1,b(B),!f)if(i(l)!==null)f=!0,H(A);else{var j=i(u);j!==null&&z(_,j.startTime-B)}}function A(B,j){f=!1,m&&(m=!1,y(M),M=-1),p=!0;var V=d;try{for(b(j),h=i(l);h!==null&&(!(h.expirationTime>j)||B&&!T());){var q=h.callback;if(typeof q=="function"){h.callback=null,d=h.priorityLevel;var K=q(h.expirationTime<=j);j=t.unstable_now(),typeof K=="function"?h.callback=K:h===i(l)&&r(l),b(j)}else r(l);h=i(l)}if(h!==null)var le=!0;else{var Z=i(u);Z!==null&&z(_,Z.startTime-j),le=!1}return le}finally{h=null,d=V,p=!1}}var S=!1,E=null,M=-1,R=5,C=-1;function T(){return!(t.unstable_now()-C<R)}function L(){if(E!==null){var B=t.unstable_now();C=B;var j=!0;try{j=E(!0,B)}finally{j?I():(S=!1,E=null)}}else S=!1}var I;if(typeof v=="function")I=function(){v(L)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=L,I=function(){F.postMessage(null)}}else I=function(){g(L,0)};function H(B){E=B,S||(S=!0,I())}function z(B,j){M=g(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,H(A))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(B){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var V=d;d=j;try{return B()}finally{d=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var V=d;d=B;try{return j()}finally{d=V}},t.unstable_scheduleCallback=function(B,j,V){var q=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,B){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=V+K,B={id:c++,callback:j,priorityLevel:B,startTime:V,expirationTime:K,sortIndex:-1},V>q?(B.sortIndex=V,e(u,B),i(l)===null&&B===i(u)&&(m?(y(M),M=-1):m=!0,z(_,V-q))):(B.sortIndex=K,e(l,B),f||p||(f=!0,H(A))),B},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(B){var j=d;return function(){var V=d;d=j;try{return B.apply(this,arguments)}finally{d=V}}}})(eK);$Y.exports=eK;var ele=$Y.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tK=se,Ya=ele;function ft(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iK=new Set,Ew={};function qm(t,e){qv(t,e),qv(t+"Capture",e)}function qv(t,e){for(Ew[t]=e,t=0;t<e.length;t++)iK.add(e[t])}var Jc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),YI=Object.prototype.hasOwnProperty,tle=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vG={},bG={};function ile(t){return YI.call(bG,t)?!0:YI.call(vG,t)?!1:tle.test(t)?bG[t]=!0:(vG[t]=!0,!1)}function rle(t,e,i,r){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nle(t,e,i,r){if(e===null||typeof e>"u"||rle(t,e,i,r))return!0;if(r)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qo(t,e,i,r,n,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Xs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xs[t]=new Qo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xs[e]=new Qo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xs[t]=new Qo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xs[t]=new Qo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xs[t]=new Qo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xs[t]=new Qo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xs[t]=new Qo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xs[t]=new Qo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xs[t]=new Qo(t,5,!1,t.toLowerCase(),null,!1,!1)});var _N=/[\-:]([a-z])/g;function SN(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(_N,SN);Xs[e]=new Qo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(_N,SN);Xs[e]=new Qo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(_N,SN);Xs[e]=new Qo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xs[t]=new Qo(t,1,!1,t.toLowerCase(),null,!1,!1)});Xs.xlinkHref=new Qo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xs[t]=new Qo(t,1,!1,t.toLowerCase(),null,!0,!0)});function AN(t,e,i,r){var n=Xs.hasOwnProperty(e)?Xs[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nle(e,i,n,r)&&(i=null),r||n===null?ile(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):n.mustUseProperty?t[n.propertyName]=i===null?n.type===3?!1:"":i:(e=n.attributeName,r=n.attributeNamespace,i===null?t.removeAttribute(e):(n=n.type,i=n===3||n===4&&i===!0?"":""+i,r?t.setAttributeNS(r,e,i):t.setAttribute(e,i))))}var od=tK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,SS=Symbol.for("react.element"),qy=Symbol.for("react.portal"),Xy=Symbol.for("react.fragment"),EN=Symbol.for("react.strict_mode"),KI=Symbol.for("react.profiler"),rK=Symbol.for("react.provider"),nK=Symbol.for("react.context"),MN=Symbol.for("react.forward_ref"),JI=Symbol.for("react.suspense"),QI=Symbol.for("react.suspense_list"),CN=Symbol.for("react.memo"),Wd=Symbol.for("react.lazy"),sK=Symbol.for("react.offscreen"),xG=Symbol.iterator;function Rb(t){return t===null||typeof t!="object"?null:(t=xG&&t[xG]||t["@@iterator"],typeof t=="function"?t:null)}var Xr=Object.assign,ak;function Ix(t){if(ak===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);ak=e&&e[1]||""}return`
`+ak+t}var lk=!1;function uk(t,e){if(!t||lk)return"";lk=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),s=r.stack.split(`
`),o=n.length-1,a=s.length-1;1<=o&&0<=a&&n[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(n[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||n[o]!==s[a]){var l=`
`+n[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{lk=!1,Error.prepareStackTrace=i}return(t=t?t.displayName||t.name:"")?Ix(t):""}function sle(t){switch(t.tag){case 5:return Ix(t.type);case 16:return Ix("Lazy");case 13:return Ix("Suspense");case 19:return Ix("SuspenseList");case 0:case 2:case 15:return t=uk(t.type,!1),t;case 11:return t=uk(t.type.render,!1),t;case 1:return t=uk(t.type,!0),t;default:return""}}function ZI(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xy:return"Fragment";case qy:return"Portal";case KI:return"Profiler";case EN:return"StrictMode";case JI:return"Suspense";case QI:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nK:return(t.displayName||"Context")+".Consumer";case rK:return(t._context.displayName||"Context")+".Provider";case MN:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case CN:return e=t.displayName||null,e!==null?e:ZI(t.type)||"Memo";case Wd:e=t._payload,t=t._init;try{return ZI(t(e))}catch{}}return null}function ole(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ZI(e);case 8:return e===EN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Lp(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oK(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ale(t){var e=oK(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var n=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function AS(t){t._valueTracker||(t._valueTracker=ale(t))}function aK(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),r="";return t&&(r=oK(t)?t.checked?"true":"false":t.value),t=r,t!==i?(e.setValue(t),!0):!1}function pC(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $I(t,e){var i=e.checked;return Xr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??t._wrapperState.initialChecked})}function wG(t,e){var i=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;i=Lp(e.value!=null?e.value:i),t._wrapperState={initialChecked:r,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lK(t,e){e=e.checked,e!=null&&AN(t,"checked",e,!1)}function eL(t,e){lK(t,e);var i=Lp(e.value),r=e.type;if(i!=null)r==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?tL(t,e.type,i):e.hasOwnProperty("defaultValue")&&tL(t,e.type,Lp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _G(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function tL(t,e,i){(e!=="number"||pC(t.ownerDocument)!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}var Lx=Array.isArray;function yv(t,e,i,r){if(t=t.options,e){e={};for(var n=0;n<i.length;n++)e["$"+i[n]]=!0;for(i=0;i<t.length;i++)n=e.hasOwnProperty("$"+t[i].value),t[i].selected!==n&&(t[i].selected=n),n&&r&&(t[i].defaultSelected=!0)}else{for(i=""+Lp(i),e=null,n=0;n<t.length;n++){if(t[n].value===i){t[n].selected=!0,r&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function iL(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ft(91));return Xr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function SG(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(ft(92));if(Lx(i)){if(1<i.length)throw Error(ft(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:Lp(i)}}function uK(t,e){var i=Lp(e.value),r=Lp(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),r!=null&&(t.defaultValue=""+r)}function AG(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function hK(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rL(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?hK(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ES,cK=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,r,n){MSApp.execUnsafeLocalFunction(function(){return t(e,i,r,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ES=ES||document.createElement("div"),ES.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ES.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Mw(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}var Jx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lle=["Webkit","ms","Moz","O"];Object.keys(Jx).forEach(function(t){lle.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Jx[e]=Jx[t]})});function dK(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||Jx.hasOwnProperty(t)&&Jx[t]?(""+e).trim():e+"px"}function pK(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var r=i.indexOf("--")===0,n=dK(i,e[i],r);i==="float"&&(i="cssFloat"),r?t.setProperty(i,n):t[i]=n}}var ule=Xr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nL(t,e){if(e){if(ule[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ft(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ft(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ft(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ft(62))}}function sL(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oL=null;function PN(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var aL=null,vv=null,bv=null;function EG(t){if(t=V1(t)){if(typeof aL!="function")throw Error(ft(280));var e=t.stateNode;e&&(e=dP(e),aL(t.stateNode,t.type,e))}}function fK(t){vv?bv?bv.push(t):bv=[t]:vv=t}function mK(){if(vv){var t=vv,e=bv;if(bv=vv=null,EG(t),e)for(t=0;t<e.length;t++)EG(e[t])}}function gK(t,e){return t(e)}function yK(){}var hk=!1;function vK(t,e,i){if(hk)return t(e,i);hk=!0;try{return gK(t,e,i)}finally{hk=!1,(vv!==null||bv!==null)&&(yK(),mK())}}function Cw(t,e){var i=t.stateNode;if(i===null)return null;var r=dP(i);if(r===null)return null;i=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(ft(231,e,typeof i));return i}var lL=!1;if(Jc)try{var kb={};Object.defineProperty(kb,"passive",{get:function(){lL=!0}}),window.addEventListener("test",kb,kb),window.removeEventListener("test",kb,kb)}catch{lL=!1}function hle(t,e,i,r,n,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(i,u)}catch(c){this.onError(c)}}var Qx=!1,fC=null,mC=!1,uL=null,cle={onError:function(t){Qx=!0,fC=t}};function dle(t,e,i,r,n,s,o,a,l){Qx=!1,fC=null,hle.apply(cle,arguments)}function ple(t,e,i,r,n,s,o,a,l){if(dle.apply(this,arguments),Qx){if(Qx){var u=fC;Qx=!1,fC=null}else throw Error(ft(198));mC||(mC=!0,uL=u)}}function Xm(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function bK(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function MG(t){if(Xm(t)!==t)throw Error(ft(188))}function fle(t){var e=t.alternate;if(!e){if(e=Xm(t),e===null)throw Error(ft(188));return e!==t?null:t}for(var i=t,r=e;;){var n=i.return;if(n===null)break;var s=n.alternate;if(s===null){if(r=n.return,r!==null){i=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===i)return MG(n),t;if(s===r)return MG(n),e;s=s.sibling}throw Error(ft(188))}if(i.return!==r.return)i=n,r=s;else{for(var o=!1,a=n.child;a;){if(a===i){o=!0,i=n,r=s;break}if(a===r){o=!0,r=n,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,r=n;break}if(a===r){o=!0,r=s,i=n;break}a=a.sibling}if(!o)throw Error(ft(189))}}if(i.alternate!==r)throw Error(ft(190))}if(i.tag!==3)throw Error(ft(188));return i.stateNode.current===i?t:e}function xK(t){return t=fle(t),t!==null?wK(t):null}function wK(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=wK(t);if(e!==null)return e;t=t.sibling}return null}var _K=Ya.unstable_scheduleCallback,CG=Ya.unstable_cancelCallback,mle=Ya.unstable_shouldYield,gle=Ya.unstable_requestPaint,bn=Ya.unstable_now,yle=Ya.unstable_getCurrentPriorityLevel,TN=Ya.unstable_ImmediatePriority,SK=Ya.unstable_UserBlockingPriority,gC=Ya.unstable_NormalPriority,vle=Ya.unstable_LowPriority,AK=Ya.unstable_IdlePriority,lP=null,Ah=null;function ble(t){if(Ah&&typeof Ah.onCommitFiberRoot=="function")try{Ah.onCommitFiberRoot(lP,t,void 0,(t.current.flags&128)===128)}catch{}}var xu=Math.clz32?Math.clz32:_le,xle=Math.log,wle=Math.LN2;function _le(t){return t>>>=0,t===0?32:31-(xle(t)/wle|0)|0}var MS=64,CS=4194304;function Bx(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yC(t,e){var i=t.pendingLanes;if(i===0)return 0;var r=0,n=t.suspendedLanes,s=t.pingedLanes,o=i&268435455;if(o!==0){var a=o&~n;a!==0?r=Bx(a):(s&=o,s!==0&&(r=Bx(s)))}else o=i&~n,o!==0?r=Bx(o):s!==0&&(r=Bx(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,s=e&-e,n>=s||n===16&&(s&4194240)!==0))return e;if(r&4&&(r|=i&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)i=31-xu(e),n=1<<i,r|=t[i],e&=~n;return r}function Sle(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ale(t,e){for(var i=t.suspendedLanes,r=t.pingedLanes,n=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-xu(s),a=1<<o,l=n[o];l===-1?(!(a&i)||a&r)&&(n[o]=Sle(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function hL(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function EK(){var t=MS;return MS<<=1,!(MS&4194240)&&(MS=64),t}function ck(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function H1(t,e,i){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-xu(e),t[e]=i}function Ele(t,e){var i=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<i;){var n=31-xu(i),s=1<<n;e[n]=0,r[n]=-1,t[n]=-1,i&=~s}}function RN(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var r=31-xu(i),n=1<<r;n&e|t[r]&e&&(t[r]|=e),i&=~n}}var cr=0;function MK(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var CK,kN,PK,TK,RK,cL=!1,PS=[],vp=null,bp=null,xp=null,Pw=new Map,Tw=new Map,Jd=[],Mle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PG(t,e){switch(t){case"focusin":case"focusout":vp=null;break;case"dragenter":case"dragleave":bp=null;break;case"mouseover":case"mouseout":xp=null;break;case"pointerover":case"pointerout":Pw.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tw.delete(e.pointerId)}}function Db(t,e,i,r,n,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:i,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},e!==null&&(e=V1(e),e!==null&&kN(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function Cle(t,e,i,r,n){switch(e){case"focusin":return vp=Db(vp,t,e,i,r,n),!0;case"dragenter":return bp=Db(bp,t,e,i,r,n),!0;case"mouseover":return xp=Db(xp,t,e,i,r,n),!0;case"pointerover":var s=n.pointerId;return Pw.set(s,Db(Pw.get(s)||null,t,e,i,r,n)),!0;case"gotpointercapture":return s=n.pointerId,Tw.set(s,Db(Tw.get(s)||null,t,e,i,r,n)),!0}return!1}function kK(t){var e=Wf(t.target);if(e!==null){var i=Xm(e);if(i!==null){if(e=i.tag,e===13){if(e=bK(i),e!==null){t.blockedOn=e,RK(t.priority,function(){PK(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fM(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var i=dL(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(i===null){i=t.nativeEvent;var r=new i.constructor(i.type,i);oL=r,i.target.dispatchEvent(r),oL=null}else return e=V1(i),e!==null&&kN(e),t.blockedOn=i,!1;e.shift()}return!0}function TG(t,e,i){fM(t)&&i.delete(e)}function Ple(){cL=!1,vp!==null&&fM(vp)&&(vp=null),bp!==null&&fM(bp)&&(bp=null),xp!==null&&fM(xp)&&(xp=null),Pw.forEach(TG),Tw.forEach(TG)}function Ib(t,e){t.blockedOn===e&&(t.blockedOn=null,cL||(cL=!0,Ya.unstable_scheduleCallback(Ya.unstable_NormalPriority,Ple)))}function Rw(t){function e(n){return Ib(n,t)}if(0<PS.length){Ib(PS[0],t);for(var i=1;i<PS.length;i++){var r=PS[i];r.blockedOn===t&&(r.blockedOn=null)}}for(vp!==null&&Ib(vp,t),bp!==null&&Ib(bp,t),xp!==null&&Ib(xp,t),Pw.forEach(e),Tw.forEach(e),i=0;i<Jd.length;i++)r=Jd[i],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jd.length&&(i=Jd[0],i.blockedOn===null);)kK(i),i.blockedOn===null&&Jd.shift()}var xv=od.ReactCurrentBatchConfig,vC=!0;function Tle(t,e,i,r){var n=cr,s=xv.transition;xv.transition=null;try{cr=1,DN(t,e,i,r)}finally{cr=n,xv.transition=s}}function Rle(t,e,i,r){var n=cr,s=xv.transition;xv.transition=null;try{cr=4,DN(t,e,i,r)}finally{cr=n,xv.transition=s}}function DN(t,e,i,r){if(vC){var n=dL(t,e,i,r);if(n===null)wk(t,e,r,bC,i),PG(t,r);else if(Cle(n,t,e,i,r))r.stopPropagation();else if(PG(t,r),e&4&&-1<Mle.indexOf(t)){for(;n!==null;){var s=V1(n);if(s!==null&&CK(s),s=dL(t,e,i,r),s===null&&wk(t,e,r,bC,i),s===n)break;n=s}n!==null&&r.stopPropagation()}else wk(t,e,r,null,i)}}var bC=null;function dL(t,e,i,r){if(bC=null,t=PN(r),t=Wf(t),t!==null)if(e=Xm(t),e===null)t=null;else if(i=e.tag,i===13){if(t=bK(e),t!==null)return t;t=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return bC=t,null}function DK(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yle()){case TN:return 1;case SK:return 4;case gC:case vle:return 16;case AK:return 536870912;default:return 16}default:return 16}}var op=null,IN=null,mM=null;function IK(){if(mM)return mM;var t,e=IN,i=e.length,r,n="value"in op?op.value:op.textContent,s=n.length;for(t=0;t<i&&e[t]===n[t];t++);var o=i-t;for(r=1;r<=o&&e[i-r]===n[s-r];r++);return mM=n.slice(t,1<r?1-r:void 0)}function gM(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function TS(){return!0}function RG(){return!1}function Za(t){function e(i,r,n,s,o){this._reactName=i,this._targetInst=n,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(i=t[a],this[a]=i?i(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?TS:RG,this.isPropagationStopped=RG,this}return Xr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=TS)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=TS)},persist:function(){},isPersistent:TS}),e}var T0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LN=Za(T0),G1=Xr({},T0,{view:0,detail:0}),kle=Za(G1),dk,pk,Lb,uP=Xr({},G1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:BN,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Lb&&(Lb&&t.type==="mousemove"?(dk=t.screenX-Lb.screenX,pk=t.screenY-Lb.screenY):pk=dk=0,Lb=t),dk)},movementY:function(t){return"movementY"in t?t.movementY:pk}}),kG=Za(uP),Dle=Xr({},uP,{dataTransfer:0}),Ile=Za(Dle),Lle=Xr({},G1,{relatedTarget:0}),fk=Za(Lle),Ble=Xr({},T0,{animationName:0,elapsedTime:0,pseudoElement:0}),Ole=Za(Ble),Ule=Xr({},T0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Nle=Za(Ule),Fle=Xr({},T0,{data:0}),DG=Za(Fle),zle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hle={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gle={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vle(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Gle[t])?!!e[t]:!1}function BN(){return Vle}var jle=Xr({},G1,{key:function(t){if(t.key){var e=zle[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gM(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Hle[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:BN,charCode:function(t){return t.type==="keypress"?gM(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gM(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Wle=Za(jle),qle=Xr({},uP,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),IG=Za(qle),Xle=Xr({},G1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:BN}),Yle=Za(Xle),Kle=Xr({},T0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jle=Za(Kle),Qle=Xr({},uP,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Zle=Za(Qle),$le=[9,13,27,32],ON=Jc&&"CompositionEvent"in window,Zx=null;Jc&&"documentMode"in document&&(Zx=document.documentMode);var eue=Jc&&"TextEvent"in window&&!Zx,LK=Jc&&(!ON||Zx&&8<Zx&&11>=Zx),LG=String.fromCharCode(32),BG=!1;function BK(t,e){switch(t){case"keyup":return $le.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OK(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yy=!1;function tue(t,e){switch(t){case"compositionend":return OK(e);case"keypress":return e.which!==32?null:(BG=!0,LG);case"textInput":return t=e.data,t===LG&&BG?null:t;default:return null}}function iue(t,e){if(Yy)return t==="compositionend"||!ON&&BK(t,e)?(t=IK(),mM=IN=op=null,Yy=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LK&&e.locale!=="ko"?null:e.data;default:return null}}var rue={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OG(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rue[t.type]:e==="textarea"}function UK(t,e,i,r){fK(r),e=xC(e,"onChange"),0<e.length&&(i=new LN("onChange","change",null,i,r),t.push({event:i,listeners:e}))}var $x=null,kw=null;function nue(t){YK(t,0)}function hP(t){var e=Qy(t);if(aK(e))return t}function sue(t,e){if(t==="change")return e}var NK=!1;if(Jc){var mk;if(Jc){var gk="oninput"in document;if(!gk){var UG=document.createElement("div");UG.setAttribute("oninput","return;"),gk=typeof UG.oninput=="function"}mk=gk}else mk=!1;NK=mk&&(!document.documentMode||9<document.documentMode)}function NG(){$x&&($x.detachEvent("onpropertychange",FK),kw=$x=null)}function FK(t){if(t.propertyName==="value"&&hP(kw)){var e=[];UK(e,kw,t,PN(t)),vK(nue,e)}}function oue(t,e,i){t==="focusin"?(NG(),$x=e,kw=i,$x.attachEvent("onpropertychange",FK)):t==="focusout"&&NG()}function aue(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hP(kw)}function lue(t,e){if(t==="click")return hP(e)}function uue(t,e){if(t==="input"||t==="change")return hP(e)}function hue(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Au=typeof Object.is=="function"?Object.is:hue;function Dw(t,e){if(Au(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!YI.call(e,n)||!Au(t[n],e[n]))return!1}return!0}function FG(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function zG(t,e){var i=FG(t);t=0;for(var r;i;){if(i.nodeType===3){if(r=t+i.textContent.length,t<=e&&r>=e)return{node:i,offset:e-t};t=r}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=FG(i)}}function zK(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?zK(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function HK(){for(var t=window,e=pC();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=pC(t.document)}return e}function UN(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function cue(t){var e=HK(),i=t.focusedElem,r=t.selectionRange;if(e!==i&&i&&i.ownerDocument&&zK(i.ownerDocument.documentElement,i)){if(r!==null&&UN(i)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(t,i.value.length);else if(t=(e=i.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=i.textContent.length,s=Math.min(r.start,n);r=r.end===void 0?s:Math.min(r.end,n),!t.extend&&s>r&&(n=r,r=s,s=n),n=zG(i,s);var o=zG(i,r);n&&o&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=i;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)t=e[i],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var due=Jc&&"documentMode"in document&&11>=document.documentMode,Ky=null,pL=null,ew=null,fL=!1;function HG(t,e,i){var r=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;fL||Ky==null||Ky!==pC(r)||(r=Ky,"selectionStart"in r&&UN(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ew&&Dw(ew,r)||(ew=r,r=xC(pL,"onSelect"),0<r.length&&(e=new LN("onSelect","select",null,e,i),t.push({event:e,listeners:r}),e.target=Ky)))}function RS(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Jy={animationend:RS("Animation","AnimationEnd"),animationiteration:RS("Animation","AnimationIteration"),animationstart:RS("Animation","AnimationStart"),transitionend:RS("Transition","TransitionEnd")},yk={},GK={};Jc&&(GK=document.createElement("div").style,"AnimationEvent"in window||(delete Jy.animationend.animation,delete Jy.animationiteration.animation,delete Jy.animationstart.animation),"TransitionEvent"in window||delete Jy.transitionend.transition);function cP(t){if(yk[t])return yk[t];if(!Jy[t])return t;var e=Jy[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in GK)return yk[t]=e[i];return t}var VK=cP("animationend"),jK=cP("animationiteration"),WK=cP("animationstart"),qK=cP("transitionend"),XK=new Map,GG="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jp(t,e){XK.set(t,e),qm(e,[t])}for(var vk=0;vk<GG.length;vk++){var bk=GG[vk],pue=bk.toLowerCase(),fue=bk[0].toUpperCase()+bk.slice(1);jp(pue,"on"+fue)}jp(VK,"onAnimationEnd");jp(jK,"onAnimationIteration");jp(WK,"onAnimationStart");jp("dblclick","onDoubleClick");jp("focusin","onFocus");jp("focusout","onBlur");jp(qK,"onTransitionEnd");qv("onMouseEnter",["mouseout","mouseover"]);qv("onMouseLeave",["mouseout","mouseover"]);qv("onPointerEnter",["pointerout","pointerover"]);qv("onPointerLeave",["pointerout","pointerover"]);qm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qm("onBeforeInput",["compositionend","keypress","textInput","paste"]);qm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ox="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mue=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ox));function VG(t,e,i){var r=t.type||"unknown-event";t.currentTarget=i,ple(r,e,void 0,t),t.currentTarget=null}function YK(t,e){e=(e&4)!==0;for(var i=0;i<t.length;i++){var r=t[i],n=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&n.isPropagationStopped())break e;VG(n,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&n.isPropagationStopped())break e;VG(n,a,u),s=l}}}if(mC)throw t=uL,mC=!1,uL=null,t}function Mr(t,e){var i=e[bL];i===void 0&&(i=e[bL]=new Set);var r=t+"__bubble";i.has(r)||(KK(e,t,2,!1),i.add(r))}function xk(t,e,i){var r=0;e&&(r|=4),KK(i,t,r,e)}var kS="_reactListening"+Math.random().toString(36).slice(2);function Iw(t){if(!t[kS]){t[kS]=!0,iK.forEach(function(i){i!=="selectionchange"&&(mue.has(i)||xk(i,!1,t),xk(i,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kS]||(e[kS]=!0,xk("selectionchange",!1,e))}}function KK(t,e,i,r){switch(DK(e)){case 1:var n=Tle;break;case 4:n=Rle;break;default:n=DN}i=n.bind(null,e,i,t),n=void 0,!lL||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?t.addEventListener(e,i,{capture:!0,passive:n}):t.addEventListener(e,i,!0):n!==void 0?t.addEventListener(e,i,{passive:n}):t.addEventListener(e,i,!1)}function wk(t,e,i,r,n){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===n||a.nodeType===8&&a.parentNode===n)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;o=o.return}for(;a!==null;){if(o=Wf(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}vK(function(){var u=s,c=PN(i),h=[];e:{var d=XK.get(t);if(d!==void 0){var p=LN,f=t;switch(t){case"keypress":if(gM(i)===0)break e;case"keydown":case"keyup":p=Wle;break;case"focusin":f="focus",p=fk;break;case"focusout":f="blur",p=fk;break;case"beforeblur":case"afterblur":p=fk;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=kG;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Ile;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Yle;break;case VK:case jK:case WK:p=Ole;break;case qK:p=Jle;break;case"scroll":p=kle;break;case"wheel":p=Zle;break;case"copy":case"cut":case"paste":p=Nle;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=IG}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var v=u,b;v!==null;){b=v;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,y!==null&&(_=Cw(v,y),_!=null&&m.push(Lw(v,_,b)))),g)break;v=v.return}0<m.length&&(d=new p(d,f,null,i,c),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&i!==oL&&(f=i.relatedTarget||i.fromElement)&&(Wf(f)||f[Qc]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=i.relatedTarget||i.toElement,p=u,f=f?Wf(f):null,f!==null&&(g=Xm(f),f!==g||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=u),p!==f)){if(m=kG,_="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=IG,_="onPointerLeave",y="onPointerEnter",v="pointer"),g=p==null?d:Qy(p),b=f==null?d:Qy(f),d=new m(_,v+"leave",p,i,c),d.target=g,d.relatedTarget=b,_=null,Wf(c)===u&&(m=new m(y,v+"enter",f,i,c),m.target=b,m.relatedTarget=g,_=m),g=_,p&&f)t:{for(m=p,y=f,v=0,b=m;b;b=Eg(b))v++;for(b=0,_=y;_;_=Eg(_))b++;for(;0<v-b;)m=Eg(m),v--;for(;0<b-v;)y=Eg(y),b--;for(;v--;){if(m===y||y!==null&&m===y.alternate)break t;m=Eg(m),y=Eg(y)}m=null}else m=null;p!==null&&jG(h,d,p,m,!1),f!==null&&g!==null&&jG(h,g,f,m,!0)}}e:{if(d=u?Qy(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var A=sue;else if(OG(d))if(NK)A=uue;else{A=aue;var S=oue}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=lue);if(A&&(A=A(t,u))){UK(h,A,i,c);break e}S&&S(t,d,u),t==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&tL(d,"number",d.value)}switch(S=u?Qy(u):window,t){case"focusin":(OG(S)||S.contentEditable==="true")&&(Ky=S,pL=u,ew=null);break;case"focusout":ew=pL=Ky=null;break;case"mousedown":fL=!0;break;case"contextmenu":case"mouseup":case"dragend":fL=!1,HG(h,i,c);break;case"selectionchange":if(due)break;case"keydown":case"keyup":HG(h,i,c)}var E;if(ON)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Yy?BK(t,i)&&(M="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(M="onCompositionStart");M&&(LK&&i.locale!=="ko"&&(Yy||M!=="onCompositionStart"?M==="onCompositionEnd"&&Yy&&(E=IK()):(op=c,IN="value"in op?op.value:op.textContent,Yy=!0)),S=xC(u,M),0<S.length&&(M=new DG(M,t,null,i,c),h.push({event:M,listeners:S}),E?M.data=E:(E=OK(i),E!==null&&(M.data=E)))),(E=eue?tue(t,i):iue(t,i))&&(u=xC(u,"onBeforeInput"),0<u.length&&(c=new DG("onBeforeInput","beforeinput",null,i,c),h.push({event:c,listeners:u}),c.data=E))}YK(h,e)})}function Lw(t,e,i){return{instance:t,listener:e,currentTarget:i}}function xC(t,e){for(var i=e+"Capture",r=[];t!==null;){var n=t,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=Cw(t,i),s!=null&&r.unshift(Lw(t,s,n)),s=Cw(t,e),s!=null&&r.push(Lw(t,s,n))),t=t.return}return r}function Eg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jG(t,e,i,r,n){for(var s=e._reactName,o=[];i!==null&&i!==r;){var a=i,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,n?(l=Cw(i,s),l!=null&&o.unshift(Lw(i,l,a))):n||(l=Cw(i,s),l!=null&&o.push(Lw(i,l,a)))),i=i.return}o.length!==0&&t.push({event:e,listeners:o})}var gue=/\r\n?/g,yue=/\u0000|\uFFFD/g;function WG(t){return(typeof t=="string"?t:""+t).replace(gue,`
`).replace(yue,"")}function DS(t,e,i){if(e=WG(e),WG(t)!==e&&i)throw Error(ft(425))}function wC(){}var mL=null,gL=null;function yL(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vL=typeof setTimeout=="function"?setTimeout:void 0,vue=typeof clearTimeout=="function"?clearTimeout:void 0,qG=typeof Promise=="function"?Promise:void 0,bue=typeof queueMicrotask=="function"?queueMicrotask:typeof qG<"u"?function(t){return qG.resolve(null).then(t).catch(xue)}:vL;function xue(t){setTimeout(function(){throw t})}function _k(t,e){var i=e,r=0;do{var n=i.nextSibling;if(t.removeChild(i),n&&n.nodeType===8)if(i=n.data,i==="/$"){if(r===0){t.removeChild(n),Rw(e);return}r--}else i!=="$"&&i!=="$?"&&i!=="$!"||r++;i=n}while(i);Rw(e)}function wp(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function XG(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return t;e--}else i==="/$"&&e++}t=t.previousSibling}return null}var R0=Math.random().toString(36).slice(2),mh="__reactFiber$"+R0,Bw="__reactProps$"+R0,Qc="__reactContainer$"+R0,bL="__reactEvents$"+R0,wue="__reactListeners$"+R0,_ue="__reactHandles$"+R0;function Wf(t){var e=t[mh];if(e)return e;for(var i=t.parentNode;i;){if(e=i[Qc]||i[mh]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=XG(t);t!==null;){if(i=t[mh])return i;t=XG(t)}return e}t=i,i=t.parentNode}return null}function V1(t){return t=t[mh]||t[Qc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qy(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ft(33))}function dP(t){return t[Bw]||null}var xL=[],Zy=-1;function Wp(t){return{current:t}}function Dr(t){0>Zy||(t.current=xL[Zy],xL[Zy]=null,Zy--)}function Ar(t,e){Zy++,xL[Zy]=t.current,t.current=e}var Bp={},vo=Wp(Bp),ya=Wp(!1),Mm=Bp;function Xv(t,e){var i=t.type.contextTypes;if(!i)return Bp;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in i)n[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function va(t){return t=t.childContextTypes,t!=null}function _C(){Dr(ya),Dr(vo)}function YG(t,e,i){if(vo.current!==Bp)throw Error(ft(168));Ar(vo,e),Ar(ya,i)}function JK(t,e,i){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return i;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(ft(108,ole(t)||"Unknown",n));return Xr({},i,r)}function SC(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bp,Mm=vo.current,Ar(vo,t),Ar(ya,ya.current),!0}function KG(t,e,i){var r=t.stateNode;if(!r)throw Error(ft(169));i?(t=JK(t,e,Mm),r.__reactInternalMemoizedMergedChildContext=t,Dr(ya),Dr(vo),Ar(vo,t)):Dr(ya),Ar(ya,i)}var Mc=null,pP=!1,Sk=!1;function QK(t){Mc===null?Mc=[t]:Mc.push(t)}function Sue(t){pP=!0,QK(t)}function qp(){if(!Sk&&Mc!==null){Sk=!0;var t=0,e=cr;try{var i=Mc;for(cr=1;t<i.length;t++){var r=i[t];do r=r(!0);while(r!==null)}Mc=null,pP=!1}catch(n){throw Mc!==null&&(Mc=Mc.slice(t+1)),_K(TN,qp),n}finally{cr=e,Sk=!1}}return null}var $y=[],ev=0,AC=null,EC=0,Sl=[],Al=0,Cm=null,Lc=1,Bc="";function Pf(t,e){$y[ev++]=EC,$y[ev++]=AC,AC=t,EC=e}function ZK(t,e,i){Sl[Al++]=Lc,Sl[Al++]=Bc,Sl[Al++]=Cm,Cm=t;var r=Lc;t=Bc;var n=32-xu(r)-1;r&=~(1<<n),i+=1;var s=32-xu(e)+n;if(30<s){var o=n-n%5;s=(r&(1<<o)-1).toString(32),r>>=o,n-=o,Lc=1<<32-xu(e)+n|i<<n|r,Bc=s+t}else Lc=1<<s|i<<n|r,Bc=t}function NN(t){t.return!==null&&(Pf(t,1),ZK(t,1,0))}function FN(t){for(;t===AC;)AC=$y[--ev],$y[ev]=null,EC=$y[--ev],$y[ev]=null;for(;t===Cm;)Cm=Sl[--Al],Sl[Al]=null,Bc=Sl[--Al],Sl[Al]=null,Lc=Sl[--Al],Sl[Al]=null}var Wa=null,Fa=null,Nr=!1,cu=null;function $K(t,e){var i=kl(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=t,e=t.deletions,e===null?(t.deletions=[i],t.flags|=16):e.push(i)}function JG(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wa=t,Fa=wp(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wa=t,Fa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Cm!==null?{id:Lc,overflow:Bc}:null,t.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=kl(18,null,null,0),i.stateNode=e,i.return=t,t.child=i,Wa=t,Fa=null,!0):!1;default:return!1}}function wL(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _L(t){if(Nr){var e=Fa;if(e){var i=e;if(!JG(t,e)){if(wL(t))throw Error(ft(418));e=wp(i.nextSibling);var r=Wa;e&&JG(t,e)?$K(r,i):(t.flags=t.flags&-4097|2,Nr=!1,Wa=t)}}else{if(wL(t))throw Error(ft(418));t.flags=t.flags&-4097|2,Nr=!1,Wa=t}}}function QG(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wa=t}function IS(t){if(t!==Wa)return!1;if(!Nr)return QG(t),Nr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!yL(t.type,t.memoizedProps)),e&&(e=Fa)){if(wL(t))throw eJ(),Error(ft(418));for(;e;)$K(t,e),e=wp(e.nextSibling)}if(QG(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ft(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"){if(e===0){Fa=wp(t.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}t=t.nextSibling}Fa=null}}else Fa=Wa?wp(t.stateNode.nextSibling):null;return!0}function eJ(){for(var t=Fa;t;)t=wp(t.nextSibling)}function Yv(){Fa=Wa=null,Nr=!1}function zN(t){cu===null?cu=[t]:cu.push(t)}var Aue=od.ReactCurrentBatchConfig;function au(t,e){if(t&&t.defaultProps){e=Xr({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i]);return e}return e}var MC=Wp(null),CC=null,tv=null,HN=null;function GN(){HN=tv=CC=null}function VN(t){var e=MC.current;Dr(MC),t._currentValue=e}function SL(t,e,i){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===i)break;t=t.return}}function wv(t,e){CC=t,HN=tv=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(pa=!0),t.firstContext=null)}function Fl(t){var e=t._currentValue;if(HN!==t)if(t={context:t,memoizedValue:e,next:null},tv===null){if(CC===null)throw Error(ft(308));tv=t,CC.dependencies={lanes:0,firstContext:t}}else tv=tv.next=t;return e}var qf=null;function jN(t){qf===null?qf=[t]:qf.push(t)}function tJ(t,e,i,r){var n=e.interleaved;return n===null?(i.next=i,jN(e)):(i.next=n.next,n.next=i),e.interleaved=i,Zc(t,r)}function Zc(t,e){t.lanes|=e;var i=t.alternate;for(i!==null&&(i.lanes|=e),i=t,t=t.return;t!==null;)t.childLanes|=e,i=t.alternate,i!==null&&(i.childLanes|=e),i=t,t=t.return;return i.tag===3?i.stateNode:null}var qd=!1;function WN(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iJ(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _p(t,e,i){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ji&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,Zc(t,i)}return n=r.interleaved,n===null?(e.next=e,jN(r)):(e.next=n.next,n.next=e),r.interleaved=e,Zc(t,i)}function yM(t,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,i|=r,e.lanes=i,RN(t,i)}}function ZG(t,e){var i=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,i===r)){var n=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var o={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?n=s=o:s=s.next=o,i=i.next}while(i!==null);s===null?n=s=e:s=s.next=e}else n=s=e;i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}function PC(t,e,i,r){var n=t.updateQueue;qd=!1;var s=n.firstBaseUpdate,o=n.lastBaseUpdate,a=n.shared.pending;if(a!==null){n.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=n.baseState;o=0,c=u=l=null,a=s;do{var d=a.lane,p=a.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=t,m=a;switch(d=e,p=i,m.tag){case 1:if(f=m.payload,typeof f=="function"){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,d=typeof f=="function"?f.call(p,h,d):f,d==null)break e;h=Xr({},h,d);break e;case 2:qd=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=n.effects,d===null?n.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=p,l=h):c=c.next=p,o|=d;if(a=a.next,a===null){if(a=n.shared.pending,a===null)break;d=a,a=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(1);if(c===null&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else s===null&&(n.shared.lanes=0);Tm|=o,t.lanes=o,t.memoizedState=h}}function $G(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],n=r.callback;if(n!==null){if(r.callback=null,r=i,typeof n!="function")throw Error(ft(191,n));n.call(r)}}}var rJ=new tK.Component().refs;function AL(t,e,i,r){e=t.memoizedState,i=i(r,e),i=i==null?e:Xr({},e,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var fP={isMounted:function(t){return(t=t._reactInternals)?Xm(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternals;var r=Vo(),n=Ap(t),s=jc(r,n);s.payload=e,i!=null&&(s.callback=i),e=_p(t,s,n),e!==null&&(wu(e,t,n,r),yM(e,t,n))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var r=Vo(),n=Ap(t),s=jc(r,n);s.tag=1,s.payload=e,i!=null&&(s.callback=i),e=_p(t,s,n),e!==null&&(wu(e,t,n,r),yM(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Vo(),r=Ap(t),n=jc(i,r);n.tag=2,e!=null&&(n.callback=e),e=_p(t,n,r),e!==null&&(wu(e,t,r,i),yM(e,t,r))}};function eV(t,e,i,r,n,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Dw(i,r)||!Dw(n,s):!0}function nJ(t,e,i){var r=!1,n=Bp,s=e.contextType;return typeof s=="object"&&s!==null?s=Fl(s):(n=va(e)?Mm:vo.current,r=e.contextTypes,s=(r=r!=null)?Xv(t,n):Bp),e=new e(i,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fP,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=s),e}function tV(t,e,i,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,r),e.state!==t&&fP.enqueueReplaceState(e,e.state,null)}function EL(t,e,i,r){var n=t.stateNode;n.props=i,n.state=t.memoizedState,n.refs=rJ,WN(t);var s=e.contextType;typeof s=="object"&&s!==null?n.context=Fl(s):(s=va(e)?Mm:vo.current,n.context=Xv(t,s)),n.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(AL(t,e,s,i),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&fP.enqueueReplaceState(n,n.state,null),PC(t,i,n,r),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function Bb(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(ft(309));var r=i.stateNode}if(!r)throw Error(ft(147,t));var n=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=n.refs;a===rJ&&(a=n.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ft(284));if(!i._owner)throw Error(ft(290,t))}return t}function LS(t,e){throw t=Object.prototype.toString.call(e),Error(ft(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function iV(t){var e=t._init;return e(t._payload)}function sJ(t){function e(y,v){if(t){var b=y.deletions;b===null?(y.deletions=[v],y.flags|=16):b.push(v)}}function i(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function n(y,v){return y=Ep(y,v),y.index=0,y.sibling=null,y}function s(y,v,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<v?(y.flags|=2,v):b):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,b,_){return v===null||v.tag!==6?(v=Rk(b,y.mode,_),v.return=y,v):(v=n(v,b),v.return=y,v)}function l(y,v,b,_){var A=b.type;return A===Xy?c(y,v,b.props.children,_,b.key):v!==null&&(v.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Wd&&iV(A)===v.type)?(_=n(v,b.props),_.ref=Bb(y,v,b),_.return=y,_):(_=SM(b.type,b.key,b.props,null,y.mode,_),_.ref=Bb(y,v,b),_.return=y,_)}function u(y,v,b,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=kk(b,y.mode,_),v.return=y,v):(v=n(v,b.children||[]),v.return=y,v)}function c(y,v,b,_,A){return v===null||v.tag!==7?(v=hm(b,y.mode,_,A),v.return=y,v):(v=n(v,b),v.return=y,v)}function h(y,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Rk(""+v,y.mode,b),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case SS:return b=SM(v.type,v.key,v.props,null,y.mode,b),b.ref=Bb(y,null,v),b.return=y,b;case qy:return v=kk(v,y.mode,b),v.return=y,v;case Wd:var _=v._init;return h(y,_(v._payload),b)}if(Lx(v)||Rb(v))return v=hm(v,y.mode,b,null),v.return=y,v;LS(y,v)}return null}function d(y,v,b,_){var A=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return A!==null?null:a(y,v,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case SS:return b.key===A?l(y,v,b,_):null;case qy:return b.key===A?u(y,v,b,_):null;case Wd:return A=b._init,d(y,v,A(b._payload),_)}if(Lx(b)||Rb(b))return A!==null?null:c(y,v,b,_,null);LS(y,b)}return null}function p(y,v,b,_,A){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(b)||null,a(v,y,""+_,A);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case SS:return y=y.get(_.key===null?b:_.key)||null,l(v,y,_,A);case qy:return y=y.get(_.key===null?b:_.key)||null,u(v,y,_,A);case Wd:var S=_._init;return p(y,v,b,S(_._payload),A)}if(Lx(_)||Rb(_))return y=y.get(b)||null,c(v,y,_,A,null);LS(v,_)}return null}function f(y,v,b,_){for(var A=null,S=null,E=v,M=v=0,R=null;E!==null&&M<b.length;M++){E.index>M?(R=E,E=null):R=E.sibling;var C=d(y,E,b[M],_);if(C===null){E===null&&(E=R);break}t&&E&&C.alternate===null&&e(y,E),v=s(C,v,M),S===null?A=C:S.sibling=C,S=C,E=R}if(M===b.length)return i(y,E),Nr&&Pf(y,M),A;if(E===null){for(;M<b.length;M++)E=h(y,b[M],_),E!==null&&(v=s(E,v,M),S===null?A=E:S.sibling=E,S=E);return Nr&&Pf(y,M),A}for(E=r(y,E);M<b.length;M++)R=p(E,y,M,b[M],_),R!==null&&(t&&R.alternate!==null&&E.delete(R.key===null?M:R.key),v=s(R,v,M),S===null?A=R:S.sibling=R,S=R);return t&&E.forEach(function(T){return e(y,T)}),Nr&&Pf(y,M),A}function m(y,v,b,_){var A=Rb(b);if(typeof A!="function")throw Error(ft(150));if(b=A.call(b),b==null)throw Error(ft(151));for(var S=A=null,E=v,M=v=0,R=null,C=b.next();E!==null&&!C.done;M++,C=b.next()){E.index>M?(R=E,E=null):R=E.sibling;var T=d(y,E,C.value,_);if(T===null){E===null&&(E=R);break}t&&E&&T.alternate===null&&e(y,E),v=s(T,v,M),S===null?A=T:S.sibling=T,S=T,E=R}if(C.done)return i(y,E),Nr&&Pf(y,M),A;if(E===null){for(;!C.done;M++,C=b.next())C=h(y,C.value,_),C!==null&&(v=s(C,v,M),S===null?A=C:S.sibling=C,S=C);return Nr&&Pf(y,M),A}for(E=r(y,E);!C.done;M++,C=b.next())C=p(E,y,M,C.value,_),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?M:C.key),v=s(C,v,M),S===null?A=C:S.sibling=C,S=C);return t&&E.forEach(function(L){return e(y,L)}),Nr&&Pf(y,M),A}function g(y,v,b,_){if(typeof b=="object"&&b!==null&&b.type===Xy&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case SS:e:{for(var A=b.key,S=v;S!==null;){if(S.key===A){if(A=b.type,A===Xy){if(S.tag===7){i(y,S.sibling),v=n(S,b.props.children),v.return=y,y=v;break e}}else if(S.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Wd&&iV(A)===S.type){i(y,S.sibling),v=n(S,b.props),v.ref=Bb(y,S,b),v.return=y,y=v;break e}i(y,S);break}else e(y,S);S=S.sibling}b.type===Xy?(v=hm(b.props.children,y.mode,_,b.key),v.return=y,y=v):(_=SM(b.type,b.key,b.props,null,y.mode,_),_.ref=Bb(y,v,b),_.return=y,y=_)}return o(y);case qy:e:{for(S=b.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){i(y,v.sibling),v=n(v,b.children||[]),v.return=y,y=v;break e}else{i(y,v);break}else e(y,v);v=v.sibling}v=kk(b,y.mode,_),v.return=y,y=v}return o(y);case Wd:return S=b._init,g(y,v,S(b._payload),_)}if(Lx(b))return f(y,v,b,_);if(Rb(b))return m(y,v,b,_);LS(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(i(y,v.sibling),v=n(v,b),v.return=y,y=v):(i(y,v),v=Rk(b,y.mode,_),v.return=y,y=v),o(y)):i(y,v)}return g}var Kv=sJ(!0),oJ=sJ(!1),j1={},Eh=Wp(j1),Ow=Wp(j1),Uw=Wp(j1);function Xf(t){if(t===j1)throw Error(ft(174));return t}function qN(t,e){switch(Ar(Uw,e),Ar(Ow,t),Ar(Eh,j1),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rL(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rL(e,t)}Dr(Eh),Ar(Eh,e)}function Jv(){Dr(Eh),Dr(Ow),Dr(Uw)}function aJ(t){Xf(Uw.current);var e=Xf(Eh.current),i=rL(e,t.type);e!==i&&(Ar(Ow,t),Ar(Eh,i))}function XN(t){Ow.current===t&&(Dr(Eh),Dr(Ow))}var Hr=Wp(0);function TC(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ak=[];function YN(){for(var t=0;t<Ak.length;t++)Ak[t]._workInProgressVersionPrimary=null;Ak.length=0}var vM=od.ReactCurrentDispatcher,Ek=od.ReactCurrentBatchConfig,Pm=0,jr=null,$n=null,vs=null,RC=!1,tw=!1,Nw=0,Eue=0;function eo(){throw Error(ft(321))}function KN(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!Au(t[i],e[i]))return!1;return!0}function JN(t,e,i,r,n,s){if(Pm=s,jr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vM.current=t===null||t.memoizedState===null?Tue:Rue,t=i(r,n),tw){s=0;do{if(tw=!1,Nw=0,25<=s)throw Error(ft(301));s+=1,vs=$n=null,e.updateQueue=null,vM.current=kue,t=i(r,n)}while(tw)}if(vM.current=kC,e=$n!==null&&$n.next!==null,Pm=0,vs=$n=jr=null,RC=!1,e)throw Error(ft(300));return t}function QN(){var t=Nw!==0;return Nw=0,t}function ah(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vs===null?jr.memoizedState=vs=t:vs=vs.next=t,vs}function zl(){if($n===null){var t=jr.alternate;t=t!==null?t.memoizedState:null}else t=$n.next;var e=vs===null?jr.memoizedState:vs.next;if(e!==null)vs=e,$n=t;else{if(t===null)throw Error(ft(310));$n=t,t={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},vs===null?jr.memoizedState=vs=t:vs=vs.next=t}return vs}function Fw(t,e){return typeof e=="function"?e(t):e}function Mk(t){var e=zl(),i=e.queue;if(i===null)throw Error(ft(311));i.lastRenderedReducer=t;var r=$n,n=r.baseQueue,s=i.pending;if(s!==null){if(n!==null){var o=n.next;n.next=s.next,s.next=o}r.baseQueue=n=s,i.pending=null}if(n!==null){s=n.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Pm&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,jr.lanes|=c,Tm|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Au(r,e.memoizedState)||(pa=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,i.lastRenderedState=r}if(t=i.interleaved,t!==null){n=t;do s=n.lane,jr.lanes|=s,Tm|=s,n=n.next;while(n!==t)}else n===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function Ck(t){var e=zl(),i=e.queue;if(i===null)throw Error(ft(311));i.lastRenderedReducer=t;var r=i.dispatch,n=i.pending,s=e.memoizedState;if(n!==null){i.pending=null;var o=n=n.next;do s=t(s,o.action),o=o.next;while(o!==n);Au(s,e.memoizedState)||(pa=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),i.lastRenderedState=s}return[s,r]}function lJ(){}function uJ(t,e){var i=jr,r=zl(),n=e(),s=!Au(r.memoizedState,n);if(s&&(r.memoizedState=n,pa=!0),r=r.queue,ZN(dJ.bind(null,i,r,t),[t]),r.getSnapshot!==e||s||vs!==null&&vs.memoizedState.tag&1){if(i.flags|=2048,zw(9,cJ.bind(null,i,r,n,e),void 0,null),Ms===null)throw Error(ft(349));Pm&30||hJ(i,e,n)}return n}function hJ(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},e=jr.updateQueue,e===null?(e={lastEffect:null,stores:null},jr.updateQueue=e,e.stores=[t]):(i=e.stores,i===null?e.stores=[t]:i.push(t))}function cJ(t,e,i,r){e.value=i,e.getSnapshot=r,pJ(e)&&fJ(t)}function dJ(t,e,i){return i(function(){pJ(e)&&fJ(t)})}function pJ(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!Au(t,i)}catch{return!0}}function fJ(t){var e=Zc(t,1);e!==null&&wu(e,t,1,-1)}function rV(t){var e=ah();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fw,lastRenderedState:t},e.queue=t,t=t.dispatch=Pue.bind(null,jr,t),[e.memoizedState,t]}function zw(t,e,i,r){return t={tag:t,create:e,destroy:i,deps:r,next:null},e=jr.updateQueue,e===null?(e={lastEffect:null,stores:null},jr.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(r=i.next,i.next=t,t.next=r,e.lastEffect=t)),t}function mJ(){return zl().memoizedState}function bM(t,e,i,r){var n=ah();jr.flags|=t,n.memoizedState=zw(1|e,i,void 0,r===void 0?null:r)}function mP(t,e,i,r){var n=zl();r=r===void 0?null:r;var s=void 0;if($n!==null){var o=$n.memoizedState;if(s=o.destroy,r!==null&&KN(r,o.deps)){n.memoizedState=zw(e,i,s,r);return}}jr.flags|=t,n.memoizedState=zw(1|e,i,s,r)}function nV(t,e){return bM(8390656,8,t,e)}function ZN(t,e){return mP(2048,8,t,e)}function gJ(t,e){return mP(4,2,t,e)}function yJ(t,e){return mP(4,4,t,e)}function vJ(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bJ(t,e,i){return i=i!=null?i.concat([t]):null,mP(4,4,vJ.bind(null,e,t),i)}function $N(){}function xJ(t,e){var i=zl();e=e===void 0?null:e;var r=i.memoizedState;return r!==null&&e!==null&&KN(e,r[1])?r[0]:(i.memoizedState=[t,e],t)}function wJ(t,e){var i=zl();e=e===void 0?null:e;var r=i.memoizedState;return r!==null&&e!==null&&KN(e,r[1])?r[0]:(t=t(),i.memoizedState=[t,e],t)}function _J(t,e,i){return Pm&21?(Au(i,e)||(i=EK(),jr.lanes|=i,Tm|=i,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,pa=!0),t.memoizedState=i)}function Mue(t,e){var i=cr;cr=i!==0&&4>i?i:4,t(!0);var r=Ek.transition;Ek.transition={};try{t(!1),e()}finally{cr=i,Ek.transition=r}}function SJ(){return zl().memoizedState}function Cue(t,e,i){var r=Ap(t);if(i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},AJ(t))EJ(e,i);else if(i=tJ(t,e,i,r),i!==null){var n=Vo();wu(i,t,r,n),MJ(i,e,r)}}function Pue(t,e,i){var r=Ap(t),n={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(AJ(t))EJ(e,n);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,i);if(n.hasEagerState=!0,n.eagerState=a,Au(a,o)){var l=e.interleaved;l===null?(n.next=n,jN(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}i=tJ(t,e,n,r),i!==null&&(n=Vo(),wu(i,t,r,n),MJ(i,e,r))}}function AJ(t){var e=t.alternate;return t===jr||e!==null&&e===jr}function EJ(t,e){tw=RC=!0;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function MJ(t,e,i){if(i&4194240){var r=e.lanes;r&=t.pendingLanes,i|=r,e.lanes=i,RN(t,i)}}var kC={readContext:Fl,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useInsertionEffect:eo,useLayoutEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useMutableSource:eo,useSyncExternalStore:eo,useId:eo,unstable_isNewReconciler:!1},Tue={readContext:Fl,useCallback:function(t,e){return ah().memoizedState=[t,e===void 0?null:e],t},useContext:Fl,useEffect:nV,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,bM(4194308,4,vJ.bind(null,e,t),i)},useLayoutEffect:function(t,e){return bM(4194308,4,t,e)},useInsertionEffect:function(t,e){return bM(4,2,t,e)},useMemo:function(t,e){var i=ah();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var r=ah();return e=i!==void 0?i(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Cue.bind(null,jr,t),[r.memoizedState,t]},useRef:function(t){var e=ah();return t={current:t},e.memoizedState=t},useState:rV,useDebugValue:$N,useDeferredValue:function(t){return ah().memoizedState=t},useTransition:function(){var t=rV(!1),e=t[0];return t=Mue.bind(null,t[1]),ah().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,i){var r=jr,n=ah();if(Nr){if(i===void 0)throw Error(ft(407));i=i()}else{if(i=e(),Ms===null)throw Error(ft(349));Pm&30||hJ(r,e,i)}n.memoizedState=i;var s={value:i,getSnapshot:e};return n.queue=s,nV(dJ.bind(null,r,s,t),[t]),r.flags|=2048,zw(9,cJ.bind(null,r,s,i,e),void 0,null),i},useId:function(){var t=ah(),e=Ms.identifierPrefix;if(Nr){var i=Bc,r=Lc;i=(r&~(1<<32-xu(r)-1)).toString(32)+i,e=":"+e+"R"+i,i=Nw++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=Eue++,e=":"+e+"r"+i.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Rue={readContext:Fl,useCallback:xJ,useContext:Fl,useEffect:ZN,useImperativeHandle:bJ,useInsertionEffect:gJ,useLayoutEffect:yJ,useMemo:wJ,useReducer:Mk,useRef:mJ,useState:function(){return Mk(Fw)},useDebugValue:$N,useDeferredValue:function(t){var e=zl();return _J(e,$n.memoizedState,t)},useTransition:function(){var t=Mk(Fw)[0],e=zl().memoizedState;return[t,e]},useMutableSource:lJ,useSyncExternalStore:uJ,useId:SJ,unstable_isNewReconciler:!1},kue={readContext:Fl,useCallback:xJ,useContext:Fl,useEffect:ZN,useImperativeHandle:bJ,useInsertionEffect:gJ,useLayoutEffect:yJ,useMemo:wJ,useReducer:Ck,useRef:mJ,useState:function(){return Ck(Fw)},useDebugValue:$N,useDeferredValue:function(t){var e=zl();return $n===null?e.memoizedState=t:_J(e,$n.memoizedState,t)},useTransition:function(){var t=Ck(Fw)[0],e=zl().memoizedState;return[t,e]},useMutableSource:lJ,useSyncExternalStore:uJ,useId:SJ,unstable_isNewReconciler:!1};function Qv(t,e){try{var i="",r=e;do i+=sle(r),r=r.return;while(r);var n=i}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:n,digest:null}}function Pk(t,e,i){return{value:t,source:null,stack:i??null,digest:e??null}}function ML(t,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Due=typeof WeakMap=="function"?WeakMap:Map;function CJ(t,e,i){i=jc(-1,i),i.tag=3,i.payload={element:null};var r=e.value;return i.callback=function(){IC||(IC=!0,OL=r),ML(t,e)},i}function PJ(t,e,i){i=jc(-1,i),i.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;i.payload=function(){return r(n)},i.callback=function(){ML(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){ML(t,e),typeof r!="function"&&(Sp===null?Sp=new Set([this]):Sp.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),i}function sV(t,e,i){var r=t.pingCache;if(r===null){r=t.pingCache=new Due;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(i)||(n.add(i),t=que.bind(null,t,e,i),e.then(t,t))}function oV(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function aV(t,e,i,r,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=jc(-1,1),e.tag=2,_p(i,e,1))),i.lanes|=1),t)}var Iue=od.ReactCurrentOwner,pa=!1;function Do(t,e,i,r){e.child=t===null?oJ(e,null,i,r):Kv(e,t.child,i,r)}function lV(t,e,i,r,n){i=i.render;var s=e.ref;return wv(e,n),r=JN(t,e,i,r,s,n),i=QN(),t!==null&&!pa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,$c(t,e,n)):(Nr&&i&&NN(e),e.flags|=1,Do(t,e,r,n),e.child)}function uV(t,e,i,r,n){if(t===null){var s=i.type;return typeof s=="function"&&!aF(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=s,TJ(t,e,s,r,n)):(t=SM(i.type,null,r,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&n)){var o=s.memoizedProps;if(i=i.compare,i=i!==null?i:Dw,i(o,r)&&t.ref===e.ref)return $c(t,e,n)}return e.flags|=1,t=Ep(s,r),t.ref=e.ref,t.return=e,e.child=t}function TJ(t,e,i,r,n){if(t!==null){var s=t.memoizedProps;if(Dw(s,r)&&t.ref===e.ref)if(pa=!1,e.pendingProps=r=s,(t.lanes&n)!==0)t.flags&131072&&(pa=!0);else return e.lanes=t.lanes,$c(t,e,n)}return CL(t,e,i,r,n)}function RJ(t,e,i){var r=e.pendingProps,n=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ar(rv,Ia),Ia|=i;else{if(!(i&1073741824))return t=s!==null?s.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ar(rv,Ia),Ia|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:i,Ar(rv,Ia),Ia|=r}else s!==null?(r=s.baseLanes|i,e.memoizedState=null):r=i,Ar(rv,Ia),Ia|=r;return Do(t,e,n,i),e.child}function kJ(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function CL(t,e,i,r,n){var s=va(i)?Mm:vo.current;return s=Xv(e,s),wv(e,n),i=JN(t,e,i,r,s,n),r=QN(),t!==null&&!pa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,$c(t,e,n)):(Nr&&r&&NN(e),e.flags|=1,Do(t,e,i,n),e.child)}function hV(t,e,i,r,n){if(va(i)){var s=!0;SC(e)}else s=!1;if(wv(e,n),e.stateNode===null)xM(t,e),nJ(e,i,r),EL(e,i,r,n),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=i.contextType;typeof u=="object"&&u!==null?u=Fl(u):(u=va(i)?Mm:vo.current,u=Xv(e,u));var c=i.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&tV(e,o,r,u),qd=!1;var d=e.memoizedState;o.state=d,PC(e,r,o,n),l=e.memoizedState,a!==r||d!==l||ya.current||qd?(typeof c=="function"&&(AL(e,i,c,r),l=e.memoizedState),(a=qd||eV(e,i,a,r,d,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,iJ(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:au(e.type,a),o.props=u,h=e.pendingProps,d=o.context,l=i.contextType,typeof l=="object"&&l!==null?l=Fl(l):(l=va(i)?Mm:vo.current,l=Xv(e,l));var p=i.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||d!==l)&&tV(e,o,r,l),qd=!1,d=e.memoizedState,o.state=d,PC(e,r,o,n);var f=e.memoizedState;a!==h||d!==f||ya.current||qd?(typeof p=="function"&&(AL(e,i,p,r),f=e.memoizedState),(u=qd||eV(e,i,u,r,d,f,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,f,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,f,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return PL(t,e,i,r,s,n)}function PL(t,e,i,r,n,s){kJ(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return n&&KG(e,i,!1),$c(t,e,s);r=e.stateNode,Iue.current=e;var a=o&&typeof i.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Kv(e,t.child,null,s),e.child=Kv(e,null,a,s)):Do(t,e,a,s),e.memoizedState=r.state,n&&KG(e,i,!0),e.child}function DJ(t){var e=t.stateNode;e.pendingContext?YG(t,e.pendingContext,e.pendingContext!==e.context):e.context&&YG(t,e.context,!1),qN(t,e.containerInfo)}function cV(t,e,i,r,n){return Yv(),zN(n),e.flags|=256,Do(t,e,i,r),e.child}var TL={dehydrated:null,treeContext:null,retryLane:0};function RL(t){return{baseLanes:t,cachePool:null,transitions:null}}function IJ(t,e,i){var r=e.pendingProps,n=Hr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(n&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),Ar(Hr,n&1),t===null)return _L(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=vP(o,r,0,null),t=hm(t,r,i,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=RL(i),e.memoizedState=TL,t):eF(e,o));if(n=t.memoizedState,n!==null&&(a=n.dehydrated,a!==null))return Lue(t,e,o,r,a,n,i);if(s){s=r.fallback,o=e.mode,n=t.child,a=n.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ep(n,l),r.subtreeFlags=n.subtreeFlags&14680064),a!==null?s=Ep(a,s):(s=hm(s,o,i,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?RL(i):{baseLanes:o.baseLanes|i,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~i,e.memoizedState=TL,r}return s=t.child,t=s.sibling,r=Ep(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=i),r.return=e,r.sibling=null,t!==null&&(i=e.deletions,i===null?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=r,e.memoizedState=null,r}function eF(t,e){return e=vP({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function BS(t,e,i,r){return r!==null&&zN(r),Kv(e,t.child,null,i),t=eF(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Lue(t,e,i,r,n,s,o){if(i)return e.flags&256?(e.flags&=-257,r=Pk(Error(ft(422))),BS(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,n=e.mode,r=vP({mode:"visible",children:r.children},n,0,null),s=hm(s,n,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Kv(e,t.child,null,o),e.child.memoizedState=RL(o),e.memoizedState=TL,s);if(!(e.mode&1))return BS(t,e,o,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ft(419)),r=Pk(s,r,void 0),BS(t,e,o,r)}if(a=(o&t.childLanes)!==0,pa||a){if(r=Ms,r!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|o)?0:n,n!==0&&n!==s.retryLane&&(s.retryLane=n,Zc(t,n),wu(r,t,n,-1))}return oF(),r=Pk(Error(ft(421))),BS(t,e,o,r)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=Xue.bind(null,t),n._reactRetry=e,null):(t=s.treeContext,Fa=wp(n.nextSibling),Wa=e,Nr=!0,cu=null,t!==null&&(Sl[Al++]=Lc,Sl[Al++]=Bc,Sl[Al++]=Cm,Lc=t.id,Bc=t.overflow,Cm=e),e=eF(e,r.children),e.flags|=4096,e)}function dV(t,e,i){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),SL(t.return,e,i)}function Tk(t,e,i,r,n){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=i,s.tailMode=n)}function LJ(t,e,i){var r=e.pendingProps,n=r.revealOrder,s=r.tail;if(Do(t,e,r.children,i),r=Hr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dV(t,i,e);else if(t.tag===19)dV(t,i,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ar(Hr,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(i=e.child,n=null;i!==null;)t=i.alternate,t!==null&&TC(t)===null&&(n=i),i=i.sibling;i=n,i===null?(n=e.child,e.child=null):(n=i.sibling,i.sibling=null),Tk(e,!1,n,i,s);break;case"backwards":for(i=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&TC(t)===null){e.child=n;break}t=n.sibling,n.sibling=i,i=n,n=t}Tk(e,!0,i,null,s);break;case"together":Tk(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xM(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function $c(t,e,i){if(t!==null&&(e.dependencies=t.dependencies),Tm|=e.lanes,!(i&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ft(153));if(e.child!==null){for(t=e.child,i=Ep(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=Ep(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}function Bue(t,e,i){switch(e.tag){case 3:DJ(e),Yv();break;case 5:aJ(e);break;case 1:va(e.type)&&SC(e);break;case 4:qN(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;Ar(MC,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ar(Hr,Hr.current&1),e.flags|=128,null):i&e.child.childLanes?IJ(t,e,i):(Ar(Hr,Hr.current&1),t=$c(t,e,i),t!==null?t.sibling:null);Ar(Hr,Hr.current&1);break;case 19:if(r=(i&e.childLanes)!==0,t.flags&128){if(r)return LJ(t,e,i);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ar(Hr,Hr.current),r)break;return null;case 22:case 23:return e.lanes=0,RJ(t,e,i)}return $c(t,e,i)}var BJ,kL,OJ,UJ;BJ=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};kL=function(){};OJ=function(t,e,i,r){var n=t.memoizedProps;if(n!==r){t=e.stateNode,Xf(Eh.current);var s=null;switch(i){case"input":n=$I(t,n),r=$I(t,r),s=[];break;case"select":n=Xr({},n,{value:void 0}),r=Xr({},r,{value:void 0}),s=[];break;case"textarea":n=iL(t,n),r=iL(t,r),s=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=wC)}nL(i,r);var o;i=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var a=n[u];for(o in a)a.hasOwnProperty(o)&&(i||(i={}),i[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ew.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(i||(i={}),i[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(i||(i={}),i[o]=l[o])}else i||(s||(s=[]),s.push(u,i)),i=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ew.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Mr("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}i&&(s=s||[]).push("style",i);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};UJ=function(t,e,i,r){i!==r&&(e.flags|=4)};function Ob(t,e){if(!Nr)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var r=null;i!==null;)i.alternate!==null&&(r=i),i=i.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function to(t){var e=t.alternate!==null&&t.alternate.child===t.child,i=0,r=0;if(e)for(var n=t.child;n!==null;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=r,t.childLanes=i,e}function Oue(t,e,i){var r=e.pendingProps;switch(FN(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return to(e),null;case 1:return va(e.type)&&_C(),to(e),null;case 3:return r=e.stateNode,Jv(),Dr(ya),Dr(vo),YN(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(IS(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cu!==null&&(FL(cu),cu=null))),kL(t,e),to(e),null;case 5:XN(e);var n=Xf(Uw.current);if(i=e.type,t!==null&&e.stateNode!=null)OJ(t,e,i,r,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ft(166));return to(e),null}if(t=Xf(Eh.current),IS(e)){r=e.stateNode,i=e.type;var s=e.memoizedProps;switch(r[mh]=e,r[Bw]=s,t=(e.mode&1)!==0,i){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(n=0;n<Ox.length;n++)Mr(Ox[n],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":wG(r,s),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Mr("invalid",r);break;case"textarea":SG(r,s),Mr("invalid",r)}nL(i,s),n=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&DS(r.textContent,a,t),n=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&DS(r.textContent,a,t),n=["children",""+a]):Ew.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Mr("scroll",r)}switch(i){case"input":AS(r),_G(r,s,!0);break;case"textarea":AS(r),AG(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=wC)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=hK(i)),t==="http://www.w3.org/1999/xhtml"?i==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(i,{is:r.is}):(t=o.createElement(i),i==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,i),t[mh]=e,t[Bw]=r,BJ(t,e,!1,!1),e.stateNode=t;e:{switch(o=sL(i,r),i){case"dialog":Mr("cancel",t),Mr("close",t),n=r;break;case"iframe":case"object":case"embed":Mr("load",t),n=r;break;case"video":case"audio":for(n=0;n<Ox.length;n++)Mr(Ox[n],t);n=r;break;case"source":Mr("error",t),n=r;break;case"img":case"image":case"link":Mr("error",t),Mr("load",t),n=r;break;case"details":Mr("toggle",t),n=r;break;case"input":wG(t,r),n=$I(t,r),Mr("invalid",t);break;case"option":n=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},n=Xr({},r,{value:void 0}),Mr("invalid",t);break;case"textarea":SG(t,r),n=iL(t,r),Mr("invalid",t);break;default:n=r}nL(i,n),a=n;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?pK(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&cK(t,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&Mw(t,l):typeof l=="number"&&Mw(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ew.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Mr("scroll",t):l!=null&&AN(t,s,l,o))}switch(i){case"input":AS(t),_G(t,r,!1);break;case"textarea":AS(t),AG(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Lp(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?yv(t,!!r.multiple,s,!1):r.defaultValue!=null&&yv(t,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=wC)}switch(i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return to(e),null;case 6:if(t&&e.stateNode!=null)UJ(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ft(166));if(i=Xf(Uw.current),Xf(Eh.current),IS(e)){if(r=e.stateNode,i=e.memoizedProps,r[mh]=e,(s=r.nodeValue!==i)&&(t=Wa,t!==null))switch(t.tag){case 3:DS(r.nodeValue,i,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&DS(r.nodeValue,i,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(i.nodeType===9?i:i.ownerDocument).createTextNode(r),r[mh]=e,e.stateNode=r}return to(e),null;case 13:if(Dr(Hr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nr&&Fa!==null&&e.mode&1&&!(e.flags&128))eJ(),Yv(),e.flags|=98560,s=!1;else if(s=IS(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ft(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ft(317));s[mh]=e}else Yv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;to(e),s=!1}else cu!==null&&(FL(cu),cu=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Hr.current&1?is===0&&(is=3):oF())),e.updateQueue!==null&&(e.flags|=4),to(e),null);case 4:return Jv(),kL(t,e),t===null&&Iw(e.stateNode.containerInfo),to(e),null;case 10:return VN(e.type._context),to(e),null;case 17:return va(e.type)&&_C(),to(e),null;case 19:if(Dr(Hr),s=e.memoizedState,s===null)return to(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ob(s,!1);else{if(is!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=TC(t),o!==null){for(e.flags|=128,Ob(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=i,i=e.child;i!==null;)s=i,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),i=i.sibling;return Ar(Hr,Hr.current&1|2),e.child}t=t.sibling}s.tail!==null&&bn()>Zv&&(e.flags|=128,r=!0,Ob(s,!1),e.lanes=4194304)}else{if(!r)if(t=TC(o),t!==null){if(e.flags|=128,r=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),Ob(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Nr)return to(e),null}else 2*bn()-s.renderingStartTime>Zv&&i!==1073741824&&(e.flags|=128,r=!0,Ob(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(i=s.last,i!==null?i.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=bn(),e.sibling=null,i=Hr.current,Ar(Hr,r?i&1|2:i&1),e):(to(e),null);case 22:case 23:return sF(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ia&1073741824&&(to(e),e.subtreeFlags&6&&(e.flags|=8192)):to(e),null;case 24:return null;case 25:return null}throw Error(ft(156,e.tag))}function Uue(t,e){switch(FN(e),e.tag){case 1:return va(e.type)&&_C(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Jv(),Dr(ya),Dr(vo),YN(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return XN(e),null;case 13:if(Dr(Hr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ft(340));Yv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Dr(Hr),null;case 4:return Jv(),null;case 10:return VN(e.type._context),null;case 22:case 23:return sF(),null;case 24:return null;default:return null}}var OS=!1,lo=!1,Nue=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function iv(t,e){var i=t.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(r){sn(t,e,r)}else i.current=null}function DL(t,e,i){try{i()}catch(r){sn(t,e,r)}}var pV=!1;function Fue(t,e){if(mL=vC,t=HK(),UN(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var r=i.getSelection&&i.getSelection();if(r&&r.rangeCount!==0){i=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=t,d=null;t:for(;;){for(var p;h!==i||n!==0&&h.nodeType!==3||(a=o+n),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===i&&++u===n&&(a=o),d===s&&++c===r&&(l=o),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}i=a===-1||l===-1?null:{start:a,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(gL={focusedElem:t,selectionRange:i},vC=!1,Dt=e;Dt!==null;)if(e=Dt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Dt=t;else for(;Dt!==null;){e=Dt;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,g=f.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:au(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ft(163))}}catch(_){sn(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,Dt=t;break}Dt=e.return}return f=pV,pV=!1,f}function iw(t,e,i){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&t)===t){var s=n.destroy;n.destroy=void 0,s!==void 0&&DL(e,i,s)}n=n.next}while(n!==r)}}function gP(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var r=i.create;i.destroy=r()}i=i.next}while(i!==e)}}function IL(t){var e=t.ref;if(e!==null){var i=t.stateNode;switch(t.tag){case 5:t=i;break;default:t=i}typeof e=="function"?e(t):e.current=t}}function NJ(t){var e=t.alternate;e!==null&&(t.alternate=null,NJ(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mh],delete e[Bw],delete e[bL],delete e[wue],delete e[_ue])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FJ(t){return t.tag===5||t.tag===3||t.tag===4}function fV(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FJ(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function LL(t,e,i){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=wC));else if(r!==4&&(t=t.child,t!==null))for(LL(t,e,i),t=t.sibling;t!==null;)LL(t,e,i),t=t.sibling}function BL(t,e,i){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(BL(t,e,i),t=t.sibling;t!==null;)BL(t,e,i),t=t.sibling}var Bs=null,uu=!1;function bd(t,e,i){for(i=i.child;i!==null;)zJ(t,e,i),i=i.sibling}function zJ(t,e,i){if(Ah&&typeof Ah.onCommitFiberUnmount=="function")try{Ah.onCommitFiberUnmount(lP,i)}catch{}switch(i.tag){case 5:lo||iv(i,e);case 6:var r=Bs,n=uu;Bs=null,bd(t,e,i),Bs=r,uu=n,Bs!==null&&(uu?(t=Bs,i=i.stateNode,t.nodeType===8?t.parentNode.removeChild(i):t.removeChild(i)):Bs.removeChild(i.stateNode));break;case 18:Bs!==null&&(uu?(t=Bs,i=i.stateNode,t.nodeType===8?_k(t.parentNode,i):t.nodeType===1&&_k(t,i),Rw(t)):_k(Bs,i.stateNode));break;case 4:r=Bs,n=uu,Bs=i.stateNode.containerInfo,uu=!0,bd(t,e,i),Bs=r,uu=n;break;case 0:case 11:case 14:case 15:if(!lo&&(r=i.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var s=n,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&DL(i,e,o),n=n.next}while(n!==r)}bd(t,e,i);break;case 1:if(!lo&&(iv(i,e),r=i.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=i.memoizedProps,r.state=i.memoizedState,r.componentWillUnmount()}catch(a){sn(i,e,a)}bd(t,e,i);break;case 21:bd(t,e,i);break;case 22:i.mode&1?(lo=(r=lo)||i.memoizedState!==null,bd(t,e,i),lo=r):bd(t,e,i);break;default:bd(t,e,i)}}function mV(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new Nue),e.forEach(function(r){var n=Yue.bind(null,t,r);i.has(r)||(i.add(r),r.then(n,n))})}}function Xl(t,e){var i=e.deletions;if(i!==null)for(var r=0;r<i.length;r++){var n=i[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Bs=a.stateNode,uu=!1;break e;case 3:Bs=a.stateNode.containerInfo,uu=!0;break e;case 4:Bs=a.stateNode.containerInfo,uu=!0;break e}a=a.return}if(Bs===null)throw Error(ft(160));zJ(s,o,n),Bs=null,uu=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){sn(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HJ(e,t),e=e.sibling}function HJ(t,e){var i=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xl(e,t),Wu(t),r&4){try{iw(3,t,t.return),gP(3,t)}catch(m){sn(t,t.return,m)}try{iw(5,t,t.return)}catch(m){sn(t,t.return,m)}}break;case 1:Xl(e,t),Wu(t),r&512&&i!==null&&iv(i,i.return);break;case 5:if(Xl(e,t),Wu(t),r&512&&i!==null&&iv(i,i.return),t.flags&32){var n=t.stateNode;try{Mw(n,"")}catch(m){sn(t,t.return,m)}}if(r&4&&(n=t.stateNode,n!=null)){var s=t.memoizedProps,o=i!==null?i.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&lK(n,s),sL(a,o);var u=sL(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?pK(n,h):c==="dangerouslySetInnerHTML"?cK(n,h):c==="children"?Mw(n,h):AN(n,c,h,u)}switch(a){case"input":eL(n,s);break;case"textarea":uK(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?yv(n,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?yv(n,!!s.multiple,s.defaultValue,!0):yv(n,!!s.multiple,s.multiple?[]:"",!1))}n[Bw]=s}catch(m){sn(t,t.return,m)}}break;case 6:if(Xl(e,t),Wu(t),r&4){if(t.stateNode===null)throw Error(ft(162));n=t.stateNode,s=t.memoizedProps;try{n.nodeValue=s}catch(m){sn(t,t.return,m)}}break;case 3:if(Xl(e,t),Wu(t),r&4&&i!==null&&i.memoizedState.isDehydrated)try{Rw(e.containerInfo)}catch(m){sn(t,t.return,m)}break;case 4:Xl(e,t),Wu(t);break;case 13:Xl(e,t),Wu(t),n=t.child,n.flags&8192&&(s=n.memoizedState!==null,n.stateNode.isHidden=s,!s||n.alternate!==null&&n.alternate.memoizedState!==null||(rF=bn())),r&4&&mV(t);break;case 22:if(c=i!==null&&i.memoizedState!==null,t.mode&1?(lo=(u=lo)||c,Xl(e,t),lo=u):Xl(e,t),Wu(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Dt=t,c=t.child;c!==null;){for(h=Dt=c;Dt!==null;){switch(d=Dt,p=d.child,d.tag){case 0:case 11:case 14:case 15:iw(4,d,d.return);break;case 1:iv(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){r=d,i=d.return;try{e=r,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(m){sn(r,i,m)}}break;case 5:iv(d,d.return);break;case 22:if(d.memoizedState!==null){yV(h);continue}}p!==null?(p.return=d,Dt=p):yV(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{n=h.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=dK("display",o))}catch(m){sn(t,t.return,m)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){sn(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Xl(e,t),Wu(t),r&4&&mV(t);break;case 21:break;default:Xl(e,t),Wu(t)}}function Wu(t){var e=t.flags;if(e&2){try{e:{for(var i=t.return;i!==null;){if(FJ(i)){var r=i;break e}i=i.return}throw Error(ft(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(Mw(n,""),r.flags&=-33);var s=fV(t);BL(t,s,n);break;case 3:case 4:var o=r.stateNode.containerInfo,a=fV(t);LL(t,a,o);break;default:throw Error(ft(161))}}catch(l){sn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zue(t,e,i){Dt=t,GJ(t)}function GJ(t,e,i){for(var r=(t.mode&1)!==0;Dt!==null;){var n=Dt,s=n.child;if(n.tag===22&&r){var o=n.memoizedState!==null||OS;if(!o){var a=n.alternate,l=a!==null&&a.memoizedState!==null||lo;a=OS;var u=lo;if(OS=o,(lo=l)&&!u)for(Dt=n;Dt!==null;)o=Dt,l=o.child,o.tag===22&&o.memoizedState!==null?vV(n):l!==null?(l.return=o,Dt=l):vV(n);for(;s!==null;)Dt=s,GJ(s),s=s.sibling;Dt=n,OS=a,lo=u}gV(t)}else n.subtreeFlags&8772&&s!==null?(s.return=n,Dt=s):gV(t)}}function gV(t){for(;Dt!==null;){var e=Dt;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:lo||gP(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!lo)if(i===null)r.componentDidMount();else{var n=e.elementType===e.type?i.memoizedProps:au(e.type,i.memoizedProps);r.componentDidUpdate(n,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$G(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}$G(e,o,i)}break;case 5:var a=e.stateNode;if(i===null&&e.flags&4){i=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Rw(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ft(163))}lo||e.flags&512&&IL(e)}catch(d){sn(e,e.return,d)}}if(e===t){Dt=null;break}if(i=e.sibling,i!==null){i.return=e.return,Dt=i;break}Dt=e.return}}function yV(t){for(;Dt!==null;){var e=Dt;if(e===t){Dt=null;break}var i=e.sibling;if(i!==null){i.return=e.return,Dt=i;break}Dt=e.return}}function vV(t){for(;Dt!==null;){var e=Dt;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{gP(4,e)}catch(l){sn(e,i,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){sn(e,n,l)}}var s=e.return;try{IL(e)}catch(l){sn(e,s,l)}break;case 5:var o=e.return;try{IL(e)}catch(l){sn(e,o,l)}}}catch(l){sn(e,e.return,l)}if(e===t){Dt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Dt=a;break}Dt=e.return}}var Hue=Math.ceil,DC=od.ReactCurrentDispatcher,tF=od.ReactCurrentOwner,Ll=od.ReactCurrentBatchConfig,ji=0,Ms=null,Un=null,Vs=0,Ia=0,rv=Wp(0),is=0,Hw=null,Tm=0,yP=0,iF=0,rw=null,la=null,rF=0,Zv=1/0,Sc=null,IC=!1,OL=null,Sp=null,US=!1,ap=null,LC=0,nw=0,UL=null,wM=-1,_M=0;function Vo(){return ji&6?bn():wM!==-1?wM:wM=bn()}function Ap(t){return t.mode&1?ji&2&&Vs!==0?Vs&-Vs:Aue.transition!==null?(_M===0&&(_M=EK()),_M):(t=cr,t!==0||(t=window.event,t=t===void 0?16:DK(t.type)),t):1}function wu(t,e,i,r){if(50<nw)throw nw=0,UL=null,Error(ft(185));H1(t,i,r),(!(ji&2)||t!==Ms)&&(t===Ms&&(!(ji&2)&&(yP|=i),is===4&&Qd(t,Vs)),ba(t,r),i===1&&ji===0&&!(e.mode&1)&&(Zv=bn()+500,pP&&qp()))}function ba(t,e){var i=t.callbackNode;Ale(t,e);var r=yC(t,t===Ms?Vs:0);if(r===0)i!==null&&CG(i),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(i!=null&&CG(i),e===1)t.tag===0?Sue(bV.bind(null,t)):QK(bV.bind(null,t)),bue(function(){!(ji&6)&&qp()}),i=null;else{switch(MK(r)){case 1:i=TN;break;case 4:i=SK;break;case 16:i=gC;break;case 536870912:i=AK;break;default:i=gC}i=JJ(i,VJ.bind(null,t))}t.callbackPriority=e,t.callbackNode=i}}function VJ(t,e){if(wM=-1,_M=0,ji&6)throw Error(ft(327));var i=t.callbackNode;if(_v()&&t.callbackNode!==i)return null;var r=yC(t,t===Ms?Vs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=BC(t,r);else{e=r;var n=ji;ji|=2;var s=WJ();(Ms!==t||Vs!==e)&&(Sc=null,Zv=bn()+500,um(t,e));do try{jue();break}catch(a){jJ(t,a)}while(1);GN(),DC.current=s,ji=n,Un!==null?e=0:(Ms=null,Vs=0,e=is)}if(e!==0){if(e===2&&(n=hL(t),n!==0&&(r=n,e=NL(t,n))),e===1)throw i=Hw,um(t,0),Qd(t,r),ba(t,bn()),i;if(e===6)Qd(t,r);else{if(n=t.current.alternate,!(r&30)&&!Gue(n)&&(e=BC(t,r),e===2&&(s=hL(t),s!==0&&(r=s,e=NL(t,s))),e===1))throw i=Hw,um(t,0),Qd(t,r),ba(t,bn()),i;switch(t.finishedWork=n,t.finishedLanes=r,e){case 0:case 1:throw Error(ft(345));case 2:Tf(t,la,Sc);break;case 3:if(Qd(t,r),(r&130023424)===r&&(e=rF+500-bn(),10<e)){if(yC(t,0)!==0)break;if(n=t.suspendedLanes,(n&r)!==r){Vo(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=vL(Tf.bind(null,t,la,Sc),e);break}Tf(t,la,Sc);break;case 4:if(Qd(t,r),(r&4194240)===r)break;for(e=t.eventTimes,n=-1;0<r;){var o=31-xu(r);s=1<<o,o=e[o],o>n&&(n=o),r&=~s}if(r=n,r=bn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Hue(r/1960))-r,10<r){t.timeoutHandle=vL(Tf.bind(null,t,la,Sc),r);break}Tf(t,la,Sc);break;case 5:Tf(t,la,Sc);break;default:throw Error(ft(329))}}}return ba(t,bn()),t.callbackNode===i?VJ.bind(null,t):null}function NL(t,e){var i=rw;return t.current.memoizedState.isDehydrated&&(um(t,e).flags|=256),t=BC(t,e),t!==2&&(e=la,la=i,e!==null&&FL(e)),t}function FL(t){la===null?la=t:la.push.apply(la,t)}function Gue(t){for(var e=t;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var r=0;r<i.length;r++){var n=i[r],s=n.getSnapshot;n=n.value;try{if(!Au(s(),n))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qd(t,e){for(e&=~iF,e&=~yP,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var i=31-xu(e),r=1<<i;t[i]=-1,e&=~r}}function bV(t){if(ji&6)throw Error(ft(327));_v();var e=yC(t,0);if(!(e&1))return ba(t,bn()),null;var i=BC(t,e);if(t.tag!==0&&i===2){var r=hL(t);r!==0&&(e=r,i=NL(t,r))}if(i===1)throw i=Hw,um(t,0),Qd(t,e),ba(t,bn()),i;if(i===6)throw Error(ft(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tf(t,la,Sc),ba(t,bn()),null}function nF(t,e){var i=ji;ji|=1;try{return t(e)}finally{ji=i,ji===0&&(Zv=bn()+500,pP&&qp())}}function Rm(t){ap!==null&&ap.tag===0&&!(ji&6)&&_v();var e=ji;ji|=1;var i=Ll.transition,r=cr;try{if(Ll.transition=null,cr=1,t)return t()}finally{cr=r,Ll.transition=i,ji=e,!(ji&6)&&qp()}}function sF(){Ia=rv.current,Dr(rv)}function um(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,vue(i)),Un!==null)for(i=Un.return;i!==null;){var r=i;switch(FN(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_C();break;case 3:Jv(),Dr(ya),Dr(vo),YN();break;case 5:XN(r);break;case 4:Jv();break;case 13:Dr(Hr);break;case 19:Dr(Hr);break;case 10:VN(r.type._context);break;case 22:case 23:sF()}i=i.return}if(Ms=t,Un=t=Ep(t.current,null),Vs=Ia=e,is=0,Hw=null,iF=yP=Tm=0,la=rw=null,qf!==null){for(e=0;e<qf.length;e++)if(i=qf[e],r=i.interleaved,r!==null){i.interleaved=null;var n=r.next,s=i.pending;if(s!==null){var o=s.next;s.next=n,r.next=o}i.pending=r}qf=null}return t}function jJ(t,e){do{var i=Un;try{if(GN(),vM.current=kC,RC){for(var r=jr.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}RC=!1}if(Pm=0,vs=$n=jr=null,tw=!1,Nw=0,tF.current=null,i===null||i.return===null){is=1,Hw=e,Un=null;break}e:{var s=t,o=i.return,a=i,l=e;if(e=Vs,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=oV(o);if(p!==null){p.flags&=-257,aV(p,o,a,s,e),p.mode&1&&sV(s,u,e),e=p,l=u;var f=e.updateQueue;if(f===null){var m=new Set;m.add(l),e.updateQueue=m}else f.add(l);break e}else{if(!(e&1)){sV(s,u,e),oF();break e}l=Error(ft(426))}}else if(Nr&&a.mode&1){var g=oV(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),aV(g,o,a,s,e),zN(Qv(l,a));break e}}s=l=Qv(l,a),is!==4&&(is=2),rw===null?rw=[s]:rw.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=CJ(s,l,e);ZG(s,y);break e;case 1:a=l;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Sp===null||!Sp.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=PJ(s,a,e);ZG(s,_);break e}}s=s.return}while(s!==null)}XJ(i)}catch(A){e=A,Un===i&&i!==null&&(Un=i=i.return);continue}break}while(1)}function WJ(){var t=DC.current;return DC.current=kC,t===null?kC:t}function oF(){(is===0||is===3||is===2)&&(is=4),Ms===null||!(Tm&268435455)&&!(yP&268435455)||Qd(Ms,Vs)}function BC(t,e){var i=ji;ji|=2;var r=WJ();(Ms!==t||Vs!==e)&&(Sc=null,um(t,e));do try{Vue();break}catch(n){jJ(t,n)}while(1);if(GN(),ji=i,DC.current=r,Un!==null)throw Error(ft(261));return Ms=null,Vs=0,is}function Vue(){for(;Un!==null;)qJ(Un)}function jue(){for(;Un!==null&&!mle();)qJ(Un)}function qJ(t){var e=KJ(t.alternate,t,Ia);t.memoizedProps=t.pendingProps,e===null?XJ(t):Un=e,tF.current=null}function XJ(t){var e=t;do{var i=e.alternate;if(t=e.return,e.flags&32768){if(i=Uue(i,e),i!==null){i.flags&=32767,Un=i;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{is=6,Un=null;return}}else if(i=Oue(i,e,Ia),i!==null){Un=i;return}if(e=e.sibling,e!==null){Un=e;return}Un=e=t}while(e!==null);is===0&&(is=5)}function Tf(t,e,i){var r=cr,n=Ll.transition;try{Ll.transition=null,cr=1,Wue(t,e,i,r)}finally{Ll.transition=n,cr=r}return null}function Wue(t,e,i,r){do _v();while(ap!==null);if(ji&6)throw Error(ft(327));i=t.finishedWork;var n=t.finishedLanes;if(i===null)return null;if(t.finishedWork=null,t.finishedLanes=0,i===t.current)throw Error(ft(177));t.callbackNode=null,t.callbackPriority=0;var s=i.lanes|i.childLanes;if(Ele(t,s),t===Ms&&(Un=Ms=null,Vs=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||US||(US=!0,JJ(gC,function(){return _v(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=Ll.transition,Ll.transition=null;var o=cr;cr=1;var a=ji;ji|=4,tF.current=null,Fue(t,i),HJ(i,t),cue(gL),vC=!!mL,gL=mL=null,t.current=i,zue(i),gle(),ji=a,cr=o,Ll.transition=s}else t.current=i;if(US&&(US=!1,ap=t,LC=n),s=t.pendingLanes,s===0&&(Sp=null),ble(i.stateNode),ba(t,bn()),e!==null)for(r=t.onRecoverableError,i=0;i<e.length;i++)n=e[i],r(n.value,{componentStack:n.stack,digest:n.digest});if(IC)throw IC=!1,t=OL,OL=null,t;return LC&1&&t.tag!==0&&_v(),s=t.pendingLanes,s&1?t===UL?nw++:(nw=0,UL=t):nw=0,qp(),null}function _v(){if(ap!==null){var t=MK(LC),e=Ll.transition,i=cr;try{if(Ll.transition=null,cr=16>t?16:t,ap===null)var r=!1;else{if(t=ap,ap=null,LC=0,ji&6)throw Error(ft(331));var n=ji;for(ji|=4,Dt=t.current;Dt!==null;){var s=Dt,o=s.child;if(Dt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Dt=u;Dt!==null;){var c=Dt;switch(c.tag){case 0:case 11:case 15:iw(8,c,s)}var h=c.child;if(h!==null)h.return=c,Dt=h;else for(;Dt!==null;){c=Dt;var d=c.sibling,p=c.return;if(NJ(c),c===u){Dt=null;break}if(d!==null){d.return=p,Dt=d;break}Dt=p}}}var f=s.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Dt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Dt=o;else e:for(;Dt!==null;){if(s=Dt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:iw(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Dt=y;break e}Dt=s.return}}var v=t.current;for(Dt=v;Dt!==null;){o=Dt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Dt=b;else e:for(o=v;Dt!==null;){if(a=Dt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:gP(9,a)}}catch(A){sn(a,a.return,A)}if(a===o){Dt=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,Dt=_;break e}Dt=a.return}}if(ji=n,qp(),Ah&&typeof Ah.onPostCommitFiberRoot=="function")try{Ah.onPostCommitFiberRoot(lP,t)}catch{}r=!0}return r}finally{cr=i,Ll.transition=e}}return!1}function xV(t,e,i){e=Qv(i,e),e=CJ(t,e,1),t=_p(t,e,1),e=Vo(),t!==null&&(H1(t,1,e),ba(t,e))}function sn(t,e,i){if(t.tag===3)xV(t,t,i);else for(;e!==null;){if(e.tag===3){xV(e,t,i);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sp===null||!Sp.has(r))){t=Qv(i,t),t=PJ(e,t,1),e=_p(e,t,1),t=Vo(),e!==null&&(H1(e,1,t),ba(e,t));break}}e=e.return}}function que(t,e,i){var r=t.pingCache;r!==null&&r.delete(e),e=Vo(),t.pingedLanes|=t.suspendedLanes&i,Ms===t&&(Vs&i)===i&&(is===4||is===3&&(Vs&130023424)===Vs&&500>bn()-rF?um(t,0):iF|=i),ba(t,e)}function YJ(t,e){e===0&&(t.mode&1?(e=CS,CS<<=1,!(CS&130023424)&&(CS=4194304)):e=1);var i=Vo();t=Zc(t,e),t!==null&&(H1(t,e,i),ba(t,i))}function Xue(t){var e=t.memoizedState,i=0;e!==null&&(i=e.retryLane),YJ(t,i)}function Yue(t,e){var i=0;switch(t.tag){case 13:var r=t.stateNode,n=t.memoizedState;n!==null&&(i=n.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ft(314))}r!==null&&r.delete(e),YJ(t,i)}var KJ;KJ=function(t,e,i){if(t!==null)if(t.memoizedProps!==e.pendingProps||ya.current)pa=!0;else{if(!(t.lanes&i)&&!(e.flags&128))return pa=!1,Bue(t,e,i);pa=!!(t.flags&131072)}else pa=!1,Nr&&e.flags&1048576&&ZK(e,EC,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;xM(t,e),t=e.pendingProps;var n=Xv(e,vo.current);wv(e,i),n=JN(null,e,r,t,n,i);var s=QN();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,va(r)?(s=!0,SC(e)):s=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,WN(e),n.updater=fP,e.stateNode=n,n._reactInternals=e,EL(e,r,t,i),e=PL(null,e,r,!0,s,i)):(e.tag=0,Nr&&s&&NN(e),Do(null,e,n,i),e=e.child),e;case 16:r=e.elementType;e:{switch(xM(t,e),t=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=Jue(r),t=au(r,t),n){case 0:e=CL(null,e,r,t,i);break e;case 1:e=hV(null,e,r,t,i);break e;case 11:e=lV(null,e,r,t,i);break e;case 14:e=uV(null,e,r,au(r.type,t),i);break e}throw Error(ft(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:au(r,n),CL(t,e,r,n,i);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:au(r,n),hV(t,e,r,n,i);case 3:e:{if(DJ(e),t===null)throw Error(ft(387));r=e.pendingProps,s=e.memoizedState,n=s.element,iJ(t,e),PC(e,r,null,i);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){n=Qv(Error(ft(423)),e),e=cV(t,e,r,i,n);break e}else if(r!==n){n=Qv(Error(ft(424)),e),e=cV(t,e,r,i,n);break e}else for(Fa=wp(e.stateNode.containerInfo.firstChild),Wa=e,Nr=!0,cu=null,i=oJ(e,null,r,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Yv(),r===n){e=$c(t,e,i);break e}Do(t,e,r,i)}e=e.child}return e;case 5:return aJ(e),t===null&&_L(e),r=e.type,n=e.pendingProps,s=t!==null?t.memoizedProps:null,o=n.children,yL(r,n)?o=null:s!==null&&yL(r,s)&&(e.flags|=32),kJ(t,e),Do(t,e,o,i),e.child;case 6:return t===null&&_L(e),null;case 13:return IJ(t,e,i);case 4:return qN(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Kv(e,null,r,i):Do(t,e,r,i),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:au(r,n),lV(t,e,r,n,i);case 7:return Do(t,e,e.pendingProps,i),e.child;case 8:return Do(t,e,e.pendingProps.children,i),e.child;case 12:return Do(t,e,e.pendingProps.children,i),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,s=e.memoizedProps,o=n.value,Ar(MC,r._currentValue),r._currentValue=o,s!==null)if(Au(s.value,o)){if(s.children===n.children&&!ya.current){e=$c(t,e,i);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=jc(-1,i&-i),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),SL(s.return,i,e),a.lanes|=i;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ft(341));o.lanes|=i,a=o.alternate,a!==null&&(a.lanes|=i),SL(o,i,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Do(t,e,n.children,i),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,wv(e,i),n=Fl(n),r=r(n),e.flags|=1,Do(t,e,r,i),e.child;case 14:return r=e.type,n=au(r,e.pendingProps),n=au(r.type,n),uV(t,e,r,n,i);case 15:return TJ(t,e,e.type,e.pendingProps,i);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:au(r,n),xM(t,e),e.tag=1,va(r)?(t=!0,SC(e)):t=!1,wv(e,i),nJ(e,r,n),EL(e,r,n,i),PL(null,e,r,!0,t,i);case 19:return LJ(t,e,i);case 22:return RJ(t,e,i)}throw Error(ft(156,e.tag))};function JJ(t,e){return _K(t,e)}function Kue(t,e,i,r){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kl(t,e,i,r){return new Kue(t,e,i,r)}function aF(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Jue(t){if(typeof t=="function")return aF(t)?1:0;if(t!=null){if(t=t.$$typeof,t===MN)return 11;if(t===CN)return 14}return 2}function Ep(t,e){var i=t.alternate;return i===null?(i=kl(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&14680064,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function SM(t,e,i,r,n,s){var o=2;if(r=t,typeof t=="function")aF(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xy:return hm(i.children,n,s,e);case EN:o=8,n|=8;break;case KI:return t=kl(12,i,e,n|2),t.elementType=KI,t.lanes=s,t;case JI:return t=kl(13,i,e,n),t.elementType=JI,t.lanes=s,t;case QI:return t=kl(19,i,e,n),t.elementType=QI,t.lanes=s,t;case sK:return vP(i,n,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case rK:o=10;break e;case nK:o=9;break e;case MN:o=11;break e;case CN:o=14;break e;case Wd:o=16,r=null;break e}throw Error(ft(130,t==null?t:typeof t,""))}return e=kl(o,i,e,n),e.elementType=t,e.type=r,e.lanes=s,e}function hm(t,e,i,r){return t=kl(7,t,r,e),t.lanes=i,t}function vP(t,e,i,r){return t=kl(22,t,r,e),t.elementType=sK,t.lanes=i,t.stateNode={isHidden:!1},t}function Rk(t,e,i){return t=kl(6,t,null,e),t.lanes=i,t}function kk(t,e,i){return e=kl(4,t.children!==null?t.children:[],t.key,e),e.lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Que(t,e,i,r,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ck(0),this.expirationTimes=ck(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ck(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function lF(t,e,i,r,n,s,o,a,l){return t=new Que(t,e,i,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=kl(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},WN(s),t}function Zue(t,e,i){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qy,key:r==null?null:""+r,children:t,containerInfo:e,implementation:i}}function QJ(t){if(!t)return Bp;t=t._reactInternals;e:{if(Xm(t)!==t||t.tag!==1)throw Error(ft(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(va(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ft(171))}if(t.tag===1){var i=t.type;if(va(i))return JK(t,i,e)}return e}function ZJ(t,e,i,r,n,s,o,a,l){return t=lF(i,r,!0,t,n,s,o,a,l),t.context=QJ(null),i=t.current,r=Vo(),n=Ap(i),s=jc(r,n),s.callback=e??null,_p(i,s,n),t.current.lanes=n,H1(t,n,r),ba(t,r),t}function bP(t,e,i,r){var n=e.current,s=Vo(),o=Ap(n);return i=QJ(i),e.context===null?e.context=i:e.pendingContext=i,e=jc(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=_p(n,e,o),t!==null&&(wu(t,n,o,s),yM(t,n,o)),o}function OC(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wV(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<e?i:e}}function uF(t,e){wV(t,e),(t=t.alternate)&&wV(t,e)}function $ue(){return null}var $J=typeof reportError=="function"?reportError:function(t){console.error(t)};function hF(t){this._internalRoot=t}xP.prototype.render=hF.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ft(409));bP(t,e,null,null)};xP.prototype.unmount=hF.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rm(function(){bP(null,t,null,null)}),e[Qc]=null}};function xP(t){this._internalRoot=t}xP.prototype.unstable_scheduleHydration=function(t){if(t){var e=TK();t={blockedOn:null,target:t,priority:e};for(var i=0;i<Jd.length&&e!==0&&e<Jd[i].priority;i++);Jd.splice(i,0,t),i===0&&kK(t)}};function cF(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wP(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _V(){}function ehe(t,e,i,r,n){if(n){if(typeof r=="function"){var s=r;r=function(){var u=OC(o);s.call(u)}}var o=ZJ(e,r,t,0,null,!1,!1,"",_V);return t._reactRootContainer=o,t[Qc]=o.current,Iw(t.nodeType===8?t.parentNode:t),Rm(),o}for(;n=t.lastChild;)t.removeChild(n);if(typeof r=="function"){var a=r;r=function(){var u=OC(l);a.call(u)}}var l=lF(t,0,!1,null,null,!1,!1,"",_V);return t._reactRootContainer=l,t[Qc]=l.current,Iw(t.nodeType===8?t.parentNode:t),Rm(function(){bP(e,l,i,r)}),l}function _P(t,e,i,r,n){var s=i._reactRootContainer;if(s){var o=s;if(typeof n=="function"){var a=n;n=function(){var l=OC(o);a.call(l)}}bP(e,o,t,n)}else o=ehe(i,e,t,n,r);return OC(o)}CK=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var i=Bx(e.pendingLanes);i!==0&&(RN(e,i|1),ba(e,bn()),!(ji&6)&&(Zv=bn()+500,qp()))}break;case 13:Rm(function(){var r=Zc(t,1);if(r!==null){var n=Vo();wu(r,t,1,n)}}),uF(t,1)}};kN=function(t){if(t.tag===13){var e=Zc(t,134217728);if(e!==null){var i=Vo();wu(e,t,134217728,i)}uF(t,134217728)}};PK=function(t){if(t.tag===13){var e=Ap(t),i=Zc(t,e);if(i!==null){var r=Vo();wu(i,t,e,r)}uF(t,e)}};TK=function(){return cr};RK=function(t,e){var i=cr;try{return cr=t,e()}finally{cr=i}};aL=function(t,e,i){switch(e){case"input":if(eL(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var r=i[e];if(r!==t&&r.form===t.form){var n=dP(r);if(!n)throw Error(ft(90));aK(r),eL(r,n)}}}break;case"textarea":uK(t,i);break;case"select":e=i.value,e!=null&&yv(t,!!i.multiple,e,!1)}};gK=nF;yK=Rm;var the={usingClientEntryPoint:!1,Events:[V1,Qy,dP,fK,mK,nF]},Ub={findFiberByHostInstance:Wf,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ihe={bundleType:Ub.bundleType,version:Ub.version,rendererPackageName:Ub.rendererPackageName,rendererConfig:Ub.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:od.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=xK(t),t===null?null:t.stateNode},findFiberByHostInstance:Ub.findFiberByHostInstance||$ue,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var NS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!NS.isDisabled&&NS.supportsFiber)try{lP=NS.inject(ihe),Ah=NS}catch{}}Qa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=the;Qa.createPortal=function(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cF(e))throw Error(ft(200));return Zue(t,e,null,i)};Qa.createRoot=function(t,e){if(!cF(t))throw Error(ft(299));var i=!1,r="",n=$J;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=lF(t,1,!1,null,null,i,!1,r,n),t[Qc]=e.current,Iw(t.nodeType===8?t.parentNode:t),new hF(e)};Qa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ft(188)):(t=Object.keys(t).join(","),Error(ft(268,t)));return t=xK(e),t=t===null?null:t.stateNode,t};Qa.flushSync=function(t){return Rm(t)};Qa.hydrate=function(t,e,i){if(!wP(e))throw Error(ft(200));return _P(null,t,e,!0,i)};Qa.hydrateRoot=function(t,e,i){if(!cF(t))throw Error(ft(405));var r=i!=null&&i.hydratedSources||null,n=!1,s="",o=$J;if(i!=null&&(i.unstable_strictMode===!0&&(n=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(o=i.onRecoverableError)),e=ZJ(e,null,t,1,i??null,n,!1,s,o),t[Qc]=e.current,Iw(t),r)for(t=0;t<r.length;t++)i=r[t],n=i._getVersion,n=n(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,n]:e.mutableSourceEagerHydrationData.push(i,n);return new xP(e)};Qa.render=function(t,e,i){if(!wP(e))throw Error(ft(200));return _P(null,t,e,!1,i)};Qa.unmountComponentAtNode=function(t){if(!wP(t))throw Error(ft(40));return t._reactRootContainer?(Rm(function(){_P(null,null,t,!1,function(){t._reactRootContainer=null,t[Qc]=null})}),!0):!1};Qa.unstable_batchedUpdates=nF;Qa.unstable_renderSubtreeIntoContainer=function(t,e,i,r){if(!wP(i))throw Error(ft(200));if(t==null||t._reactInternals===void 0)throw Error(ft(38));return _P(t,e,i,!1,r)};Qa.version="18.2.0-next-9e3b772b8-20220608";function eQ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eQ)}catch(t){console.error(t)}}eQ(),ZY.exports=Qa;var rhe=ZY.exports,tQ,SV=rhe;tQ=XI.createRoot=SV.createRoot,XI.hydrateRoot=SV.hydrateRoot;/**
 * @remix-run/router v1.6.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gw(){return Gw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Gw.apply(this,arguments)}var lp;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(lp||(lp={}));const AV="popstate";function nhe(t){t===void 0&&(t={});function e(r,n){let{pathname:s,search:o,hash:a}=r.location;return zL("",{pathname:s,search:o,hash:a},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function i(r,n){return typeof n=="string"?n:UC(n)}return ohe(e,i,null,t)}function Sn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function dF(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function she(){return Math.random().toString(36).substr(2,8)}function EV(t,e){return{usr:t.state,key:t.key,idx:e}}function zL(t,e,i,r){return i===void 0&&(i=null),Gw({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?k0(e):e,{state:i,key:e&&e.key||r||she()})}function UC(t){let{pathname:e="/",search:i="",hash:r=""}=t;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function k0(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substr(i),t=t.substr(0,i));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function ohe(t,e,i,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:s=!1}=r,o=n.history,a=lp.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Gw({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function h(){a=lp.Pop;let g=c(),y=g==null?null:g-u;u=g,l&&l({action:a,location:m.location,delta:y})}function d(g,y){a=lp.Push;let v=zL(m.location,g,y);i&&i(v,g),u=c()+1;let b=EV(v,u),_=m.createHref(v);try{o.pushState(b,"",_)}catch{n.location.assign(_)}s&&l&&l({action:a,location:m.location,delta:1})}function p(g,y){a=lp.Replace;let v=zL(m.location,g,y);i&&i(v,g),u=c();let b=EV(v,u),_=m.createHref(v);o.replaceState(b,"",_),s&&l&&l({action:a,location:m.location,delta:0})}function f(g){let y=n.location.origin!=="null"?n.location.origin:n.location.href,v=typeof g=="string"?g:UC(g);return Sn(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let m={get action(){return a},get location(){return t(n,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(AV,h),l=g,()=>{n.removeEventListener(AV,h),l=null}},createHref(g){return e(n,g)},createURL:f,encodeLocation(g){let y=f(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:p,go(g){return o.go(g)}};return m}var MV;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(MV||(MV={}));function ahe(t,e,i){i===void 0&&(i="/");let r=typeof e=="string"?k0(e):e,n=pF(r.pathname||"/",i);if(n==null)return null;let s=iQ(t);lhe(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=yhe(s[a],xhe(n));return o}function iQ(t,e,i,r){e===void 0&&(e=[]),i===void 0&&(i=[]),r===void 0&&(r="");let n=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Sn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Mp([r,l.relativePath]),c=i.concat(l);s.children&&s.children.length>0&&(Sn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),iQ(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:mhe(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))n(s,o);else for(let l of rQ(s.path))n(s,o,l)}),e}function rQ(t){let e=t.split("/");if(e.length===0)return[];let[i,...r]=e,n=i.endsWith("?"),s=i.replace(/\?$/,"");if(r.length===0)return n?[s,""]:[s];let o=rQ(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),n&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function lhe(t){t.sort((e,i)=>e.score!==i.score?i.score-e.score:ghe(e.routesMeta.map(r=>r.childrenIndex),i.routesMeta.map(r=>r.childrenIndex)))}const uhe=/^:\w+$/,hhe=3,che=2,dhe=1,phe=10,fhe=-2,CV=t=>t==="*";function mhe(t,e){let i=t.split("/"),r=i.length;return i.some(CV)&&(r+=fhe),e&&(r+=che),i.filter(n=>!CV(n)).reduce((n,s)=>n+(uhe.test(s)?hhe:s===""?dhe:phe),r)}function ghe(t,e){return t.length===e.length&&t.slice(0,-1).every((r,n)=>r===e[n])?t[t.length-1]-e[e.length-1]:0}function yhe(t,e){let{routesMeta:i}=t,r={},n="/",s=[];for(let o=0;o<i.length;++o){let a=i[o],l=o===i.length-1,u=n==="/"?e:e.slice(n.length)||"/",c=vhe({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let h=a.route;s.push({params:r,pathname:Mp([n,c.pathname]),pathnameBase:Ahe(Mp([n,c.pathnameBase])),route:h}),c.pathnameBase!=="/"&&(n=Mp([n,c.pathnameBase]))}return s}function vhe(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[i,r]=bhe(t.path,t.caseSensitive,t.end),n=e.match(i);if(!n)return null;let s=n[0],o=s.replace(/(.)\/+$/,"$1"),a=n.slice(1);return{params:r.reduce((u,c,h)=>{if(c==="*"){let d=a[h]||"";o=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return u[c]=whe(a[h]||"",c),u},{}),pathname:s,pathnameBase:o,pattern:t}}function bhe(t,e,i){e===void 0&&(e=!1),i===void 0&&(i=!0),dF(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,a)=>(r.push(a),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function xhe(t){try{return decodeURI(t)}catch(e){return dF(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function whe(t,e){try{return decodeURIComponent(t)}catch(i){return dF(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+i+").")),t}}function pF(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,r=t.charAt(i);return r&&r!=="/"?null:t.slice(i)||"/"}function _he(t,e){e===void 0&&(e="/");let{pathname:i,search:r="",hash:n=""}=typeof t=="string"?k0(t):t;return{pathname:i?i.startsWith("/")?i:She(i,e):e,search:Ehe(r),hash:Mhe(n)}}function She(t,e){let i=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?i.length>1&&i.pop():n!=="."&&i.push(n)}),i.length>1?i.join("/"):"/"}function Dk(t,e,i,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fF(t){return t.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function mF(t,e,i,r){r===void 0&&(r=!1);let n;typeof t=="string"?n=k0(t):(n=Gw({},t),Sn(!n.pathname||!n.pathname.includes("?"),Dk("?","pathname","search",n)),Sn(!n.pathname||!n.pathname.includes("#"),Dk("#","pathname","hash",n)),Sn(!n.search||!n.search.includes("#"),Dk("#","search","hash",n)));let s=t===""||n.pathname==="",o=s?"/":n.pathname,a;if(r||o==null)a=i;else{let h=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=_he(n,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&i.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Mp=t=>t.join("/").replace(/\/\/+/g,"/"),Ahe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Ehe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Mhe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Che(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const nQ=["post","put","patch","delete"];new Set(nQ);const Phe=["get",...nQ];new Set(Phe);/**
 * React Router v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function NC(){return NC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},NC.apply(this,arguments)}const gF=se.createContext(null),sQ=se.createContext(null),Ym=se.createContext(null),SP=se.createContext(null),ad=se.createContext({outlet:null,matches:[],isDataRoute:!1}),oQ=se.createContext(null);function The(t,e){let{relative:i}=e===void 0?{}:e;D0()||Sn(!1);let{basename:r,navigator:n}=se.useContext(Ym),{hash:s,pathname:o,search:a}=vF(t,{relative:i}),l=o;return r!=="/"&&(l=o==="/"?r:Mp([r,o])),n.createHref({pathname:l,search:a,hash:s})}function D0(){return se.useContext(SP)!=null}function I0(){return D0()||Sn(!1),se.useContext(SP).location}function aQ(t){se.useContext(Ym).static||se.useLayoutEffect(t)}function Op(){let{isDataRoute:t}=se.useContext(ad);return t?Ghe():Rhe()}function Rhe(){D0()||Sn(!1);let t=se.useContext(gF),{basename:e,navigator:i}=se.useContext(Ym),{matches:r}=se.useContext(ad),{pathname:n}=I0(),s=JSON.stringify(fF(r).map(l=>l.pathnameBase)),o=se.useRef(!1);return aQ(()=>{o.current=!0}),se.useCallback(function(l,u){if(u===void 0&&(u={}),!o.current)return;if(typeof l=="number"){i.go(l);return}let c=mF(l,JSON.parse(s),n,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Mp([e,c.pathname])),(u.replace?i.replace:i.push)(c,u.state,u)},[e,i,s,n,t])}function yF(){let{matches:t}=se.useContext(ad),e=t[t.length-1];return e?e.params:{}}function vF(t,e){let{relative:i}=e===void 0?{}:e,{matches:r}=se.useContext(ad),{pathname:n}=I0(),s=JSON.stringify(fF(r).map(o=>o.pathnameBase));return se.useMemo(()=>mF(t,JSON.parse(s),n,i==="path"),[t,s,n,i])}function khe(t,e){return Dhe(t,e)}function Dhe(t,e,i){D0()||Sn(!1);let{navigator:r}=se.useContext(Ym),{matches:n}=se.useContext(ad),s=n[n.length-1],o=s?s.params:{};s&&s.pathname;let a=s?s.pathnameBase:"/";s&&s.route;let l=I0(),u;if(e){var c;let m=typeof e=="string"?k0(e):e;a==="/"||(c=m.pathname)!=null&&c.startsWith(a)||Sn(!1),u=m}else u=l;let h=u.pathname||"/",d=a==="/"?h:h.slice(a.length)||"/",p=ahe(t,{pathname:d}),f=Uhe(p&&p.map(m=>Object.assign({},m,{params:Object.assign({},o,m.params),pathname:Mp([a,r.encodeLocation?r.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?a:Mp([a,r.encodeLocation?r.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),n,i);return e&&f?se.createElement(SP.Provider,{value:{location:NC({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:lp.Pop}},f):f}function Ihe(){let t=Hhe(),e=Che(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return se.createElement(se.Fragment,null,se.createElement("h2",null,"Unexpected Application Error!"),se.createElement("h3",{style:{fontStyle:"italic"}},e),i?se.createElement("pre",{style:n},i):null,s)}const Lhe=se.createElement(Ihe,null);class Bhe extends se.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,i){return i.location!==e.location||i.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||i.error,location:i.location,revalidation:e.revalidation||i.revalidation}}componentDidCatch(e,i){console.error("React Router caught the following error during render",e,i)}render(){return this.state.error?se.createElement(ad.Provider,{value:this.props.routeContext},se.createElement(oQ.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ohe(t){let{routeContext:e,match:i,children:r}=t,n=se.useContext(gF);return n&&n.static&&n.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=i.route.id),se.createElement(ad.Provider,{value:e},r)}function Uhe(t,e,i){var r;if(e===void 0&&(e=[]),i===void 0&&(i=null),t==null){var n;if((n=i)!=null&&n.errors)t=i.matches;else return null}let s=t,o=(r=i)==null?void 0:r.errors;if(o!=null){let a=s.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||Sn(!1),s=s.slice(0,Math.min(s.length,a+1))}return s.reduceRight((a,l,u)=>{let c=l.route.id?o==null?void 0:o[l.route.id]:null,h=null;i&&(h=l.route.errorElement||Lhe);let d=e.concat(s.slice(0,u+1)),p=()=>{let f;return c?f=h:l.route.Component?f=se.createElement(l.route.Component,null):l.route.element?f=l.route.element:f=a,se.createElement(Ohe,{match:l,routeContext:{outlet:a,matches:d,isDataRoute:i!=null},children:f})};return i&&(l.route.ErrorBoundary||l.route.errorElement||u===0)?se.createElement(Bhe,{location:i.location,revalidation:i.revalidation,component:h,error:c,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var HL;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(HL||(HL={}));var Vw;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(Vw||(Vw={}));function Nhe(t){let e=se.useContext(gF);return e||Sn(!1),e}function Fhe(t){let e=se.useContext(sQ);return e||Sn(!1),e}function zhe(t){let e=se.useContext(ad);return e||Sn(!1),e}function lQ(t){let e=zhe(),i=e.matches[e.matches.length-1];return i.route.id||Sn(!1),i.route.id}function Hhe(){var t;let e=se.useContext(oQ),i=Fhe(Vw.UseRouteError),r=lQ(Vw.UseRouteError);return e||((t=i.errors)==null?void 0:t[r])}function Ghe(){let{router:t}=Nhe(HL.UseNavigateStable),e=lQ(Vw.UseNavigateStable),i=se.useRef(!1);return aQ(()=>{i.current=!0}),se.useCallback(function(n,s){s===void 0&&(s={}),i.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,NC({fromRouteId:e},s)))},[t,e])}function Vhe(t){let{to:e,replace:i,state:r,relative:n}=t;D0()||Sn(!1);let{matches:s}=se.useContext(ad),{pathname:o}=I0(),a=Op(),l=mF(e,fF(s).map(c=>c.pathnameBase),o,n==="path"),u=JSON.stringify(l);return se.useEffect(()=>a(JSON.parse(u),{replace:i,state:r,relative:n}),[a,u,n,i,r]),null}function sh(t){Sn(!1)}function jhe(t){let{basename:e="/",children:i=null,location:r,navigationType:n=lp.Pop,navigator:s,static:o=!1}=t;D0()&&Sn(!1);let a=e.replace(/^\/*/,"/"),l=se.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof r=="string"&&(r=k0(r));let{pathname:u="/",search:c="",hash:h="",state:d=null,key:p="default"}=r,f=se.useMemo(()=>{let m=pF(u,a);return m==null?null:{location:{pathname:m,search:c,hash:h,state:d,key:p},navigationType:n}},[a,u,c,h,d,p,n]);return f==null?null:se.createElement(Ym.Provider,{value:l},se.createElement(SP.Provider,{children:i,value:f}))}function Whe(t){let{children:e,location:i}=t;return khe(GL(e),i)}var PV;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(PV||(PV={}));new Promise(()=>{});function GL(t,e){e===void 0&&(e=[]);let i=[];return se.Children.forEach(t,(r,n)=>{if(!se.isValidElement(r))return;let s=[...e,n];if(r.type===se.Fragment){i.push.apply(i,GL(r.props.children,s));return}r.type!==sh&&Sn(!1),!r.props.index||!r.props.children||Sn(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=GL(r.props.children,s)),i.push(o)}),i}/**
 * React Router DOM v6.11.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function FC(){return FC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},FC.apply(this,arguments)}function uQ(t,e){if(t==null)return{};var i={},r=Object.keys(t),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(i[n]=t[n]);return i}function qhe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Xhe(t,e){return t.button===0&&(!e||e==="_self")&&!qhe(t)}const Yhe=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],Khe=["aria-current","caseSensitive","className","end","style","to","children"];function Jhe(t){let{basename:e,children:i,window:r}=t,n=se.useRef();n.current==null&&(n.current=nhe({window:r,v5Compat:!0}));let s=n.current,[o,a]=se.useState({action:s.action,location:s.location});return se.useLayoutEffect(()=>s.listen(a),[s]),se.createElement(jhe,{basename:e,children:i,location:o.location,navigationType:o.action,navigator:s})}const Qhe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Zhe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,AM=se.forwardRef(function(e,i){let{onClick:r,relative:n,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c}=e,h=uQ(e,Yhe),{basename:d}=se.useContext(Ym),p,f=!1;if(typeof u=="string"&&Zhe.test(u)&&(p=u,Qhe))try{let v=new URL(window.location.href),b=u.startsWith("//")?new URL(v.protocol+u):new URL(u),_=pF(b.pathname,d);b.origin===v.origin&&_!=null?u=_+b.search+b.hash:f=!0}catch{}let m=The(u,{relative:n}),g=$he(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:n});function y(v){r&&r(v),v.defaultPrevented||g(v)}return se.createElement("a",FC({},h,{href:p||m,onClick:f||s?r:y,ref:i,target:l}))}),Zd=se.forwardRef(function(e,i){let{"aria-current":r="page",caseSensitive:n=!1,className:s="",end:o=!1,style:a,to:l,children:u}=e,c=uQ(e,Khe),h=vF(l,{relative:c.relative}),d=I0(),p=se.useContext(sQ),{navigator:f}=se.useContext(Ym),m=f.encodeLocation?f.encodeLocation(h).pathname:h.pathname,g=d.pathname,y=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(g=g.toLowerCase(),y=y?y.toLowerCase():null,m=m.toLowerCase());let v=g===m||!o&&g.startsWith(m)&&g.charAt(m.length)==="/",b=y!=null&&(y===m||!o&&y.startsWith(m)&&y.charAt(m.length)==="/"),_=v?r:void 0,A;typeof s=="function"?A=s({isActive:v,isPending:b}):A=[s,v?"active":null,b?"pending":null].filter(Boolean).join(" ");let S=typeof a=="function"?a({isActive:v,isPending:b}):a;return se.createElement(AM,FC({},c,{"aria-current":_,className:A,ref:i,style:S,to:l}),typeof u=="function"?u({isActive:v,isPending:b}):u)});var TV;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(TV||(TV={}));var RV;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(RV||(RV={}));function $he(t,e){let{target:i,replace:r,state:n,preventScrollReset:s,relative:o}=e===void 0?{}:e,a=Op(),l=I0(),u=vF(t,{relative:o});return se.useCallback(c=>{if(Xhe(c,i)){c.preventDefault();let h=r!==void 0?r:UC(l)===UC(u);a(t,{replace:h,state:n,preventScrollReset:s,relative:o})}},[l,a,u,r,n,i,t,s,o])}const ece="modulepreload",tce=function(t){return"/"+t},kV={},L0=function(e,i,r){if(!i||i.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=tce(s),s in kV)return;kV[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=n.length-1;c>=0;c--){const h=n[c];if(h.href===s&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":ece,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((c,h)=>{u.addEventListener("load",c),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};var ice=Object.create,AP=Object.defineProperty,rce=Object.getOwnPropertyDescriptor,nce=Object.getOwnPropertyNames,sce=Object.getPrototypeOf,oce=Object.prototype.hasOwnProperty,ace=(t,e,i)=>e in t?AP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,Rs=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),lce=(t,e)=>{for(var i in e)AP(t,i,{get:e[i],enumerable:!0})},uce=(t,e,i,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of nce(e))!oce.call(t,n)&&n!==i&&AP(t,n,{get:()=>e[n],enumerable:!(r=rce(e,n))||r.enumerable});return t},qn=(t,e,i)=>(i=t!=null?ice(sce(t)):{},uce(e||!t||!t.__esModule?AP(i,"default",{value:t,enumerable:!0}):i,t)),Io=(t,e,i)=>(ace(t,typeof e!="symbol"?e+"":e,i),i),hce=Rs((t,e)=>{(function(i,r){typeof t=="object"?e.exports=r():typeof define=="function"&&define.amd?define(r):i.Alea=r()})(t,function(){return i.importState=function(n){var s=new i;return s.importState(n),s},i;function i(){return function(n){var s=0,o=0,a=0,l=1;n.length==0&&(n=[+new Date]);var u=r();s=u(" "),o=u(" "),a=u(" ");for(var c=0;c<n.length;c++)s-=u(n[c]),s<0&&(s+=1),o-=u(n[c]),o<0&&(o+=1),a-=u(n[c]),a<0&&(a+=1);u=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=n,h.exportState=function(){return[s,o,a,l]},h.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function r(){var n=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){n+=o.charCodeAt(a);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),hQ=Rs((t,e)=>{(function(i,r){typeof t=="object"&&typeof e<"u"?r(t):typeof define=="function"&&define.amd?define(["exports"],r):r((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(t,function(i){i.SVD=function(r,n,s,o,a){if(n=n===void 0||n,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!r)throw new TypeError("Matrix a is not defined");var l,u,c,h,d,p,f,m,g,y,v,b,_=r[0].length,A=r.length;if(A<_)throw new TypeError("Invalid matrix: m < n");for(var S=[],E=[],M=[],R=n==="f"?A:_,C=y=f=0;C<A;C++)E[C]=new Array(R).fill(0);for(C=0;C<_;C++)M[C]=new Array(_).fill(0);var T,L=new Array(_).fill(0);for(C=0;C<A;C++)for(l=0;l<_;l++)E[C][l]=r[C][l];for(C=0;C<_;C++){for(S[C]=f,g=0,c=C+1,l=C;l<A;l++)g+=Math.pow(E[l][C],2);if(g<a)f=0;else for(m=(p=E[C][C])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,E[C][C]=p-f,l=c;l<_;l++){for(g=0,u=C;u<A;u++)g+=E[u][C]*E[u][l];for(p=g/m,u=C;u<A;u++)E[u][l]=E[u][l]+p*E[u][C]}for(L[C]=f,g=0,l=c;l<_;l++)g+=Math.pow(E[C][l],2);if(g<a)f=0;else{for(m=(p=E[C][C+1])*(f=p<0?Math.sqrt(g):-Math.sqrt(g))-g,E[C][C+1]=p-f,l=c;l<_;l++)S[l]=E[C][l]/m;for(l=c;l<A;l++){for(g=0,u=c;u<_;u++)g+=E[l][u]*E[C][u];for(u=c;u<_;u++)E[l][u]=E[l][u]+g*S[u]}}y<(v=Math.abs(L[C])+Math.abs(S[C]))&&(y=v)}if(s)for(C=_-1;0<=C;C--){if(f!==0){for(m=E[C][C+1]*f,l=c;l<_;l++)M[l][C]=E[C][l]/m;for(l=c;l<_;l++){for(g=0,u=c;u<_;u++)g+=E[C][u]*M[u][l];for(u=c;u<_;u++)M[u][l]=M[u][l]+g*M[u][C]}}for(l=c;l<_;l++)M[C][l]=0,M[l][C]=0;M[C][C]=1,f=S[C],c=C}if(n){if(n==="f")for(C=_;C<A;C++){for(l=_;l<A;l++)E[C][l]=0;E[C][C]=1}for(C=_-1;0<=C;C--){for(c=C+1,f=L[C],l=c;l<R;l++)E[C][l]=0;if(f!==0){for(m=E[C][C]*f,l=c;l<R;l++){for(g=0,u=c;u<A;u++)g+=E[u][C]*E[u][l];for(p=g/m,u=C;u<A;u++)E[u][l]=E[u][l]+p*E[u][C]}for(l=C;l<A;l++)E[l][C]=E[l][C]/f}else for(l=C;l<A;l++)E[l][C]=0;E[C][C]=E[C][C]+1}}for(o*=y,u=_-1;0<=u;u--)for(var I=0;I<50;I++){for(T=!1,c=u;0<=c;c--){if(Math.abs(S[c])<=o){T=!0;break}if(Math.abs(L[c-1])<=o)break}if(!T){for(d=0,h=c-(g=1),C=c;C<u+1&&(p=g*S[C],S[C]=d*S[C],!(Math.abs(p)<=o));C++)if(f=L[C],L[C]=Math.sqrt(p*p+f*f),d=f/(m=L[C]),g=-p/m,n)for(l=0;l<A;l++)v=E[l][h],b=E[l][C],E[l][h]=v*d+b*g,E[l][C]=-v*g+b*d}if(b=L[u],c===u){if(b<0&&(L[u]=-b,s))for(l=0;l<_;l++)M[l][u]=-M[l][u];break}for(y=L[c],p=(((v=L[u-1])-b)*(v+b)+((f=S[u-1])-(m=S[u]))*(f+m))/(2*m*v),f=Math.sqrt(p*p+1),p=((y-b)*(y+b)+m*(v/(p<0?p-f:p+f)-m))/y,C=c+(g=d=1);C<u+1;C++){if(f=S[C],v=L[C],m=g*f,f*=d,b=Math.sqrt(p*p+m*m),p=y*(d=p/(S[C-1]=b))+f*(g=m/b),f=-y*g+f*d,m=v*g,v*=d,s)for(l=0;l<_;l++)y=M[l][C-1],b=M[l][C],M[l][C-1]=y*d+b*g,M[l][C]=-y*g+b*d;if(b=Math.sqrt(p*p+m*m),p=(d=p/(L[C-1]=b))*f+(g=m/b)*v,y=-g*f+d*v,n)for(l=0;l<A;l++)v=E[l][C-1],b=E[l][C],E[l][C-1]=v*d+b*g,E[l][C]=-v*g+b*d}S[c]=0,S[u]=p,L[u]=y}for(C=0;C<_;C++)L[C]<o&&(L[C]=0);return{u:E,q:L,v:M}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),cce=Rs((t,e)=>{(function(i,r){typeof t=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(i=i||self,i.TinyQueue=r())})(t,function(){var i=function(n,s){if(n===void 0&&(n=[]),s===void 0&&(s=r),this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(var o=(this.length>>1)-1;o>=0;o--)this._down(o)};i.prototype.push=function(n){this.data.push(n),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(n){for(var s=this,o=s.data,a=s.compare,l=o[n];n>0;){var u=n-1>>1,c=o[u];if(a(l,c)>=0)break;o[n]=c,n=u}o[n]=l},i.prototype._down=function(n){for(var s=this,o=s.data,a=s.compare,l=this.length>>1,u=o[n];n<l;){var c=(n<<1)+1,h=o[c],d=c+1;if(d<this.length&&a(o[d],h)<0&&(c=d,h=o[d]),a(h,u)>=0)break;o[n]=h,n=c}o[n]=u};function r(n,s){return n<s?-1:n>s?1:0}return i})}),dce=Rs((t,e)=>{var i=cce();i.default&&(i=i.default),e.exports=r,e.exports.default=r;function r(u,c,h){c=c||1;for(var d,p,f,m,g=0;g<u[0].length;g++){var y=u[0][g];(!g||y[0]<d)&&(d=y[0]),(!g||y[1]<p)&&(p=y[1]),(!g||y[0]>f)&&(f=y[0]),(!g||y[1]>m)&&(m=y[1])}var v=f-d,b=m-p,_=Math.min(v,b),A=_/2;if(_===0){var S=[d,p];return S.distance=0,S}for(var E=new i(void 0,n),M=d;M<f;M+=_)for(var R=p;R<m;R+=_)E.push(new s(M+A,R+A,A,u));var C=a(u),T=new s(d+v/2,p+b/2,0,u);T.d>C.d&&(C=T);for(var L=E.length;E.length;){var I=E.pop();I.d>C.d&&(C=I,h&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,L)),!(I.max-C.d<=c)&&(A=I.h/2,E.push(new s(I.x-A,I.y-A,A,u)),E.push(new s(I.x+A,I.y-A,A,u)),E.push(new s(I.x-A,I.y+A,A,u)),E.push(new s(I.x+A,I.y+A,A,u)),L+=4)}h&&(console.log("num probes: "+L),console.log("best distance: "+C.d));var D=[C.x,C.y];return D.distance=C.d,D}function n(u,c){return c.max-u.max}function s(u,c,h,d){this.x=u,this.y=c,this.h=h,this.d=o(u,c,d),this.max=this.d+this.h*Math.SQRT2}function o(u,c,h){for(var d=!1,p=1/0,f=0;f<h.length;f++)for(var m=h[f],g=0,y=m.length,v=y-1;g<y;v=g++){var b=m[g],_=m[v];b[1]>c!=_[1]>c&&u<(_[0]-b[0])*(c-b[1])/(_[1]-b[1])+b[0]&&(d=!d),p=Math.min(p,l(u,c,b,_))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function a(u){for(var c=0,h=0,d=0,p=u[0],f=0,m=p.length,g=m-1;f<m;g=f++){var y=p[f],v=p[g],b=y[0]*v[1]-v[0]*y[1];h+=(y[0]+v[0])*b,d+=(y[1]+v[1])*b,c+=b*3}return c===0?new s(p[0][0],p[0][1],0,u):new s(h/c,d/c,0,u)}function l(u,c,h,d){var p=h[0],f=h[1],m=d[0]-p,g=d[1]-f;if(m!==0||g!==0){var y=((u-p)*m+(c-f)*g)/(m*m+g*g);y>1?(p=d[0],f=d[1]):y>0&&(p+=m*y,f+=g*y)}return m=u-p,g=c-f,m*m+g*g}}),pce=Rs((t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;function i(r){if(r===null||r===!0||r===!1)return NaN;var n=Number(r);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}e.exports=t.default}),fce=Rs((t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;function i(r){var n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return n.setUTCFullYear(r.getFullYear()),r.getTime()-n.getTime()}e.exports=t.default}),mce=Rs(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var h=this||i;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||i;if(h=parseFloat(h),d.ctx||c(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,i.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.volume=g._volume*h)}return d}return d._volume},mute:function(h){var d=this||i;d.ctx||c(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,i.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),m=0;m<f.length;m++){var g=d._howls[p]._soundById(f[m]);g&&g._node&&(g._node.muted=h?!0:g._muted)}return d},stop:function(){for(var h=this||i,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||i,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,c()),h},codecs:function(h){return(this||i)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||i;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||i,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var p=d.canPlayType("audio/mpeg;").replace(/^no$/,""),f=h._navigator?h._navigator.userAgent:"",m=f.match(/OPR\/([0-6].)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,y=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,v=f.match(/Version\/(.*?) /),b=y&&v&&parseInt(v[1],10)<15;return h._codecs={mp3:!!(!g&&(p||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||i;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(p){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,h._releaseHtml5Audio(f)}catch{h.noAudio=!0;break}for(var m=0;m<h._howls.length;m++)if(!h._howls[m]._webAudio)for(var g=h._howls[m]._getSoundIds(),y=0;y<g.length;y++){var v=h._howls[m]._soundById(g[y]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}h._autoResume();var b=h.ctx.createBufferSource();b.buffer=h._scratchBuffer,b.connect(h.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),b.onended=function(){b.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var _=0;_<h._howls.length;_++)h._howls[_]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||i;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||i;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!i.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var p=0;p<h._howls[d]._sounds.length;p++)if(!h._howls[d]._sounds[p]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var f=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(f,f)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!i.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var i=new e,r=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};r.prototype={init:function(h){var d=this;return i.ctx||c(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=i.usingWebAudio&&!d._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(i.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var p=0;p<h._src.length;p++){var f,m;if(h._format&&h._format[p])f=h._format[p];else{if(m=h._src[p],typeof m!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&i.codecs(f)){d=h._src[p];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new n(h),h._webAudio&&o(h),h},play:function(h,d){var p=this,f=null;if(typeof h=="number")f=h,h=null;else{if(typeof h=="string"&&p._state==="loaded"&&!p._sprite[h])return null;if(typeof h>"u"&&(h="__default",!p._playLock)){for(var m=0,g=0;g<p._sounds.length;g++)p._sounds[g]._paused&&!p._sounds[g]._ended&&(m++,f=p._sounds[g]._id);m===1?h=null:f=null}}var y=f?p._soundById(f):p._inactiveSound();if(!y)return null;if(f&&!h&&(h=y._sprite||"__default"),p._state!=="loaded"){y._sprite=h,y._ended=!1;var v=y._id;return p._queue.push({event:"play",action:function(){p.play(v)}}),v}if(f&&!y._paused)return d||p._loadQueue("play"),y._id;p._webAudio&&i._autoResume();var b=Math.max(0,y._seek>0?y._seek:p._sprite[h][0]/1e3),_=Math.max(0,(p._sprite[h][0]+p._sprite[h][1])/1e3-b),A=_*1e3/Math.abs(y._rate),S=p._sprite[h][0]/1e3,E=(p._sprite[h][0]+p._sprite[h][1])/1e3;y._sprite=h,y._ended=!1;var M=function(){y._paused=!1,y._seek=b,y._start=S,y._stop=E,y._loop=!!(y._loop||p._sprite[h][2])};if(b>=E){p._ended(y);return}var R=y._node;if(p._webAudio){var C=function(){p._playLock=!1,M(),p._refreshBuffer(y);var D=y._muted||p._muted?0:y._volume;R.gain.setValueAtTime(D,i.ctx.currentTime),y._playStart=i.ctx.currentTime,typeof R.bufferSource.start>"u"?y._loop?R.bufferSource.noteGrainOn(0,b,86400):R.bufferSource.noteGrainOn(0,b,_):y._loop?R.bufferSource.start(0,b,86400):R.bufferSource.start(0,b,_),A!==1/0&&(p._endTimers[y._id]=setTimeout(p._ended.bind(p,y),A)),d||setTimeout(function(){p._emit("play",y._id),p._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?C():(p._playLock=!0,p.once("resume",C),p._clearTimer(y._id))}else{var T=function(){R.currentTime=b,R.muted=y._muted||p._muted||i._muted||R.muted,R.volume=y._volume*i.volume(),R.playbackRate=y._rate;try{var D=R.play();if(D&&typeof Promise<"u"&&(D instanceof Promise||typeof D.then=="function")?(p._playLock=!0,M(),D.then(function(){p._playLock=!1,R._unlocked=!0,d?p._loadQueue():p._emit("play",y._id)}).catch(function(){p._playLock=!1,p._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),y._ended=!0,y._paused=!0})):d||(p._playLock=!1,M(),p._emit("play",y._id)),R.playbackRate=y._rate,R.paused){p._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||y._loop?p._endTimers[y._id]=setTimeout(p._ended.bind(p,y),A):(p._endTimers[y._id]=function(){p._ended(y),R.removeEventListener("ended",p._endTimers[y._id],!1)},R.addEventListener("ended",p._endTimers[y._id],!1))}catch(F){p._emit("playerror",y._id,F)}};R.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(R.src=p._src,R.load());var L=window&&window.ejecta||!R.readyState&&i._navigator.isCocoonJS;if(R.readyState>=3||L)T();else{p._playLock=!0,p._state="loading";var I=function(){p._state="loaded",T(),R.removeEventListener(i._canPlayEvent,I,!1)};R.addEventListener(i._canPlayEvent,I,!1),p._clearTimer(y._id)}}return y._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var p=d._getSoundIds(h),f=0;f<p.length;f++){d._clearTimer(p[f]);var m=d._soundById(p[f]);if(m&&!m._paused&&(m._seek=d.seek(p[f]),m._rateSeek=0,m._paused=!0,d._stopFade(p[f]),m._node))if(d._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),d._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||d._emit("pause",m?m._id:null)}return d},stop:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(h)}}),p;for(var f=p._getSoundIds(h),m=0;m<f.length;m++){p._clearTimer(f[m]);var g=p._soundById(f[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,p._stopFade(f[m]),g._node&&(p._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),p._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&p._clearSound(g._node))),d||p._emit("stop",g._id))}return p},mute:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(h,d)}}),p;if(typeof d>"u")if(typeof h=="boolean")p._muted=h;else return p._muted;for(var f=p._getSoundIds(d),m=0;m<f.length;m++){var g=p._soundById(f[m]);g&&(g._muted=h,g._interval&&p._stopFade(g._id),p._webAudio&&g._node?g._node.gain.setValueAtTime(h?0:g._volume,i.ctx.currentTime):g._node&&(g._node.muted=i._muted?!0:h),p._emit("mute",g._id))}return p},volume:function(){var h=this,d=arguments,p,f;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length>=2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var y;if(typeof p<"u"&&p>=0&&p<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof f>"u"&&(h._volume=p),f=h._getSoundIds(f);for(var v=0;v<f.length;v++)y=h._soundById(f[v]),y&&(y._volume=p,d[2]||h._stopFade(f[v]),h._webAudio&&y._node&&!y._muted?y._node.gain.setValueAtTime(p,i.ctx.currentTime):y._node&&!y._muted&&(y._node.volume=p*i.volume()),h._emit("volume",y._id))}else return y=f?h._soundById(f):h._sounds[0],y?y._volume:0;return h},fade:function(h,d,p,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(h,d,p,f)}}),m;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),p=parseFloat(p),m.volume(h,f);for(var g=m._getSoundIds(f),y=0;y<g.length;y++){var v=m._soundById(g[y]);if(v){if(f||m._stopFade(g[y]),m._webAudio&&!v._muted){var b=i.ctx.currentTime,_=b+p/1e3;v._volume=h,v._node.gain.setValueAtTime(h,b),v._node.gain.linearRampToValueAtTime(d,_)}m._startFadeInterval(v,h,d,p,g[y],typeof f>"u")}}return m},_startFadeInterval:function(h,d,p,f,m,g){var y=this,v=d,b=p-d,_=Math.abs(b/.01),A=Math.max(4,_>0?f/_:f),S=Date.now();h._fadeTo=p,h._interval=setInterval(function(){var E=(Date.now()-S)/f;S=Date.now(),v+=b*E,v=Math.round(v*100)/100,b<0?v=Math.max(p,v):v=Math.min(p,v),y._webAudio?h._volume=v:y.volume(v,h._id,!0),g&&(y._volume=v),(p<d&&v<=p||p>d&&v>=p)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,y.volume(p,h._id),y._emit("fade",h._id))},A)},_stopFade:function(h){var d=this,p=d._soundById(h);return p&&p._interval&&(d._webAudio&&p._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(p._interval),p._interval=null,d.volume(p._fadeTo,h),p._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,p,f,m;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")p=d[0],h._loop=p;else return m=h._soundById(parseInt(d[0],10)),m?m._loop:!1;else d.length===2&&(p=d[0],f=parseInt(d[1],10));for(var g=h._getSoundIds(f),y=0;y<g.length;y++)m=h._soundById(g[y]),m&&(m._loop=p,h._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=p,p&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,h.playing(g[y])&&(h.pause(g[y],!0),h.play(g[y],!0)))));return h},rate:function(){var h=this,d=arguments,p,f;if(d.length===0)f=h._sounds[0]._id;else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var y;if(typeof p=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof f>"u"&&(h._rate=p),f=h._getSoundIds(f);for(var v=0;v<f.length;v++)if(y=h._soundById(f[v]),y){h.playing(f[v])&&(y._rateSeek=h.seek(f[v]),y._playStart=h._webAudio?i.ctx.currentTime:y._playStart),y._rate=p,h._webAudio&&y._node&&y._node.bufferSource?y._node.bufferSource.playbackRate.setValueAtTime(p,i.ctx.currentTime):y._node&&(y._node.playbackRate=p);var b=h.seek(f[v]),_=(h._sprite[y._sprite][0]+h._sprite[y._sprite][1])/1e3-b,A=_*1e3/Math.abs(y._rate);(h._endTimers[f[v]]||!y._paused)&&(h._clearTimer(f[v]),h._endTimers[f[v]]=setTimeout(h._ended.bind(h,y),A)),h._emit("rate",y._id)}}else return y=h._soundById(f),y?y._rate:h._rate;return h},seek:function(){var h=this,d=arguments,p,f;if(d.length===0)h._sounds.length&&(f=h._sounds[0]._id);else if(d.length===1){var m=h._getSoundIds(),g=m.indexOf(d[0]);g>=0?f=parseInt(d[0],10):h._sounds.length&&(f=h._sounds[0]._id,p=parseFloat(d[0]))}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));if(typeof f>"u")return 0;if(typeof p=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var y=h._soundById(f);if(y)if(typeof p=="number"&&p>=0){var v=h.playing(f);v&&h.pause(f,!0),y._seek=p,y._ended=!1,h._clearTimer(f),!h._webAudio&&y._node&&!isNaN(y._node.duration)&&(y._node.currentTime=p);var b=function(){v&&h.play(f,!0),h._emit("seek",f)};if(v&&!h._webAudio){var _=function(){h._playLock?setTimeout(_,0):b()};setTimeout(_,0)}else b()}else if(h._webAudio){var A=h.playing(f)?i.ctx.currentTime-y._playStart:0,S=y._rateSeek?y._rateSeek-y._seek:0;return y._seek+(S+A*Math.abs(y._rate))}else return y._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var p=d._soundById(h);return p?!p._paused:!1}for(var f=0;f<d._sounds.length;f++)if(!d._sounds[f]._paused)return!0;return!1},duration:function(h){var d=this,p=d._duration,f=d._soundById(h);return f&&(p=d._sprite[f._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,p=0;p<d.length;p++)d[p]._paused||h.stop(d[p]._id),h._webAudio||(h._clearSound(d[p]._node),d[p]._node.removeEventListener("error",d[p]._errorFn,!1),d[p]._node.removeEventListener(i._canPlayEvent,d[p]._loadFn,!1),d[p]._node.removeEventListener("ended",d[p]._endFn,!1),i._releaseHtml5Audio(d[p]._node)),delete d[p]._node,h._clearTimer(d[p]._id);var f=i._howls.indexOf(h);f>=0&&i._howls.splice(f,1);var m=!0;for(p=0;p<i._howls.length;p++)if(i._howls[p]._src===h._src||h._src.indexOf(i._howls[p]._src)>=0){m=!1;break}return s&&m&&delete s[h._src],i.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,p,f){var m=this,g=m["_on"+h];return typeof d=="function"&&g.push(f?{id:p,fn:d,once:f}:{id:p,fn:d}),m},off:function(h,d,p){var f=this,m=f["_on"+h],g=0;if(typeof d=="number"&&(p=d,d=null),d||p)for(g=0;g<m.length;g++){var y=p===m[g].id;if(d===m[g].fn&&y||!d&&y){m.splice(g,1);break}}else if(h)f["_on"+h]=[];else{var v=Object.keys(f);for(g=0;g<v.length;g++)v[g].indexOf("_on")===0&&Array.isArray(f[v[g]])&&(f[v[g]]=[])}return f},once:function(h,d,p){var f=this;return f.on(h,d,p,1),f},_emit:function(h,d,p){for(var f=this,m=f["_on"+h],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===d||h==="load")&&(setTimeout((function(y){y.call(this,d,p)}).bind(f,m[g].fn),0),m[g].once&&f.off(h,m[g].fn,m[g].id));return f._loadQueue(h),f},_loadQueue:function(h){var d=this;if(d._queue.length>0){var p=d._queue[0];p.event===h&&(d._queue.shift(),d._loadQueue()),h||p.action()}return d},_ended:function(h){var d=this,p=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var f=!!(h._loop||d._sprite[p][2]);if(d._emit("end",h._id),!d._webAudio&&f&&d.stop(h._id,!0).play(h._id),d._webAudio&&f){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=i.ctx.currentTime;var m=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),m)}return d._webAudio&&!f&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),i._autoSuspend()),!d._webAudio&&!f&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var p=d._soundById(h);p&&p._node&&p._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,p=0;p<d._sounds.length;p++)if(h===d._sounds[p]._id)return d._sounds[p];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new n(h)},_drain:function(){var h=this,d=h._pool,p=0,f=0;if(!(h._sounds.length<d)){for(f=0;f<h._sounds.length;f++)h._sounds[f]._ended&&p++;for(f=h._sounds.length-1;f>=0;f--){if(p<=d)return;h._sounds[f]._ended&&(h._webAudio&&h._sounds[f]._node&&h._sounds[f]._node.disconnect(0),h._sounds.splice(f,1),p--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var p=[],f=0;f<d._sounds.length;f++)p.push(d._sounds[f]._id);return p}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=i.ctx.createBufferSource(),h._node.bufferSource.buffer=s[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,i.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,p=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),p))try{h.bufferSource.buffer=i._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(h){this._parent=h,this.init()};n.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++i._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,p=i._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),h._node.gain.setValueAtTime(p,i.ctx.currentTime),h._node.paused=!0,h._node.connect(i.masterGain)):i.noAudio||(h._node=i._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(i._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=p*i.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++i._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(i._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var s={},o=function(h){var d=h._src;if(s[d]){h._duration=s[d].duration,u(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var p=atob(d.split(",")[1]),f=new Uint8Array(p.length),m=0;m<p.length;++m)f[m]=p.charCodeAt(m);l(f.buffer,h)}else{var g=new XMLHttpRequest;g.open(h._xhr.method,d,!0),g.withCredentials=h._xhr.withCredentials,g.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(y){g.setRequestHeader(y,h._xhr.headers[y])}),g.onload=function(){var y=(g.status+"")[0];if(y!=="0"&&y!=="2"&&y!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,h)},g.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete s[d],h.load())},a(g)}},a=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var p=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&d._sounds.length>0?(s[d._src]=m,u(d,m)):p()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(h).then(f).catch(p):i.ctx.decodeAudioData(h,f,p)},u=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},c=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),d=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=d?parseInt(d[1],10):null;if(h&&p&&p<9){var f=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!f&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:i,Howl:r}}),typeof t<"u"&&(t.Howler=i,t.Howl=r),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=i,global.Howl=r,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=i,window.Howl=r,window.Sound=n)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var r=this;if(!r.ctx||!r.ctx.listener)return r;for(var n=r._howls.length-1;n>=0;n--)r._howls[n].stereo(i);return r},HowlerGlobal.prototype.pos=function(i,r,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(r=typeof r!="number"?s._pos[1]:r,n=typeof n!="number"?s._pos[2]:n,typeof i=="number")s._pos=[i,r,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(i,r,n,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var u=l._orientation;if(r=typeof r!="number"?u[1]:r,n=typeof n!="number"?u[2]:n,s=typeof s!="number"?u[3]:s,o=typeof o!="number"?u[4]:o,a=typeof a!="number"?u[5]:a,typeof i=="number")l._orientation=[i,r,n,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(i,r,n,s,o,a);else return u;return l},Howl.prototype.init=function(i){return function(r){var n=this;return n._orientation=r.orientation||[1,0,0],n._stereo=r.stereo||null,n._pos=r.pos||null,n._pannerAttr={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:360,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:360,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:0,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:"inverse",maxDistance:typeof r.maxDistance<"u"?r.maxDistance:1e4,panningModel:typeof r.panningModel<"u"?r.panningModel:"HRTF",refDistance:typeof r.refDistance<"u"?r.refDistance:1,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:1},n._onstereo=r.onstereo?[{fn:r.onstereo}]:[],n._onpos=r.onpos?[{fn:r.onpos}]:[],n._onorientation=r.onorientation?[{fn:r.onorientation}]:[],i.call(this,r)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,r){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(i,r)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof r>"u")if(typeof i=="number")n._stereo=i,n._pos=[i,0,0];else return n._stereo;for(var o=n._getSoundIds(r),a=0;a<o.length;a++){var l=n._soundById(o[a]);if(l)if(typeof i=="number")l._stereo=i,l._pos=[i,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(i,0,0):l._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(i,r,n,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(i,r,n,s)}}),o;if(r=typeof r!="number"?0:r,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof i=="number")o._pos=[i,r,n];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof i=="number")u._pos=[i,r,n],u._node&&((!u._panner||u._panner.pan)&&e(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):u._panner.setPosition(i,r,n)),o._emit("pos",u._id);else return u._pos}return o},Howl.prototype.orientation=function(i,r,n,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(i,r,n,s)}}),o;if(r=typeof r!="number"?o._orientation[1]:r,n=typeof n!="number"?o._orientation[2]:n,typeof s>"u")if(typeof i=="number")o._orientation=[i,r,n];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof i=="number")u._orientation=[i,r,n],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):u._panner.setOrientation(i,r,n)),o._emit("orientation",u._id);else return u._orientation}return o},Howl.prototype.pannerAttr=function(){var i=this,r=arguments,n,s,o;if(!i._webAudio)return i;if(r.length===0)return i._pannerAttr;if(r.length===1)if(typeof r[0]=="object")n=r[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),i._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:i._panningModel});else return o=i._soundById(parseInt(r[0],10)),o?o._pannerAttr:i._pannerAttr;else r.length===2&&(n=r[0],s=parseInt(r[1],10));for(var a=i._getSoundIds(s),l=0;l<a.length;l++)if(o=i._soundById(a[l]),o){var u=o._pannerAttr;u={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:u.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:u.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:u.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:u.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:u.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:u.panningModel};var c=o._panner;c?(c.coneInnerAngle=u.coneInnerAngle,c.coneOuterAngle=u.coneOuterAngle,c.coneOuterGain=u.coneOuterGain,c.distanceModel=u.distanceModel,c.maxDistance=u.maxDistance,c.refDistance=u.refDistance,c.rolloffFactor=u.rolloffFactor,c.panningModel=u.panningModel):(o._pos||(o._pos=i._pos||[0,0,-.5]),e(o,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var r=this,n=r._parent;r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,i.call(this),r._stereo?n.stereo(r._stereo):r._pos&&n.pos(r._pos[0],r._pos[1],r._pos[2],r._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var r=this,n=r._parent;return r._orientation=n._orientation,r._stereo=n._stereo,r._pos=n._pos,r._pannerAttr=n._pannerAttr,r._stereo?n.stereo(r._stereo):r._pos?n.pos(r._pos[0],r._pos[1],r._pos[2],r._id):r._panner&&(r._panner.disconnect(0),r._panner=void 0,n._refreshBuffer(r)),i.call(this)}}(Sound.prototype.reset);var e=function(i,r){r=r||"spatial",r==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}}()}),gce=Rs((t,e)=>{function i(s,o){function a(){this.constructor=s}a.prototype=o.prototype,s.prototype=new a}function r(s,o,a,l){this.message=s,this.expected=o,this.found=a,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,r)}i(r,Error),r.buildMessage=function(s,o){var a={literal:function(f){return'"'+u(f.text)+'"'},class:function(f){var m="",g;for(g=0;g<f.parts.length;g++)m+=f.parts[g]instanceof Array?c(f.parts[g][0])+"-"+c(f.parts[g][1]):c(f.parts[g]);return"["+(f.inverted?"^":"")+m+"]"},any:function(f){return"any character"},end:function(f){return"end of input"},other:function(f){return f.description}};function l(f){return f.charCodeAt(0).toString(16).toUpperCase()}function u(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function c(f){return f.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+l(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+l(m)})}function h(f){return a[f.type](f)}function d(f){var m=new Array(f.length),g,y;for(g=0;g<f.length;g++)m[g]=h(f[g]);if(m.sort(),m.length>0){for(g=1,y=1;g<m.length;g++)m[g-1]!==m[g]&&(m[y]=m[g],y++);m.length=y}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function p(f){return f?'"'+u(f)+'"':"end of input"}return"Expected "+d(s)+" but "+p(o)+" found."};function n(s,o){o=o!==void 0?o:{};var a={},l={svg_path:ti},u=ti,c=function(W){if(!W)return[];for(var Q=[],fe=0;fe<W.length;fe++)Q=Q.concat.apply(Q,W[fe]);var re=Q[0];return re&&re.code=="m"&&(delete re.relative,re.code="M"),Q},h=function(W,Q){return Vi(W,Q)},d=/^[Mm]/,p=rt(["M","m"],!1,!1),f=function(W,Q,fe){var re=rr(W,[Q]);return fe&&(re=re.concat(rr(W=="M"?"L":"l",fe[1]))),re},m=/^[Zz]/,g=rt(["Z","z"],!1,!1),y=function(){return rr("Z")},v=/^[Ll]/,b=rt(["L","l"],!1,!1),_=function(W,Q){return rr(W,Q)},A=/^[Hh]/,S=rt(["H","h"],!1,!1),E=function(W,Q){return rr(W,Q.map(function(fe){return{x:fe}}))},M=/^[Vv]/,R=rt(["V","v"],!1,!1),C=function(W,Q){return rr(W,Q.map(function(fe){return{y:fe}}))},T=/^[Cc]/,L=rt(["C","c"],!1,!1),I=function(W,Q,fe){return{x1:W.x,y1:W.y,x2:Q.x,y2:Q.y,x:fe.x,y:fe.y}},D=/^[Ss]/,F=rt(["S","s"],!1,!1),H=function(W,Q){return{x2:W.x,y2:W.y,x:Q.x,y:Q.y}},z=/^[Qq]/,B=rt(["Q","q"],!1,!1),j=function(W,Q){return{x1:W.x,y1:W.y,x:Q.x,y:Q.y}},V=/^[Tt]/,q=rt(["T","t"],!1,!1),K=/^[Aa]/,le=rt(["A","a"],!1,!1),Z=function(W,Q,fe,re,Ae,at){return{rx:W,ry:Q,xAxisRotation:fe,largeArc:re,sweep:Ae,x:at.x,y:at.y}},oe=function(W,Q){return{x:W,y:Q}},ae=function(W){return W*1},ve=function(W){return W.join("")*1},ye=/^[01]/,pe=rt(["0","1"],!1,!1),Se=function(W){return W=="1"},be=function(){return""},ee=",",_e=ct(",",!1),Me=function(W){return W.join("")},Ce=".",Re=ct(".",!1),Xe=/^[eE]/,Oe=rt(["e","E"],!1,!1),$=/^[+\-]/,J=rt(["+","-"],!1,!1),we=/^[0-9]/,te=rt([["0","9"]],!1,!1),Y=function(W){return W.join("")},ce=/^[ \t\n\r]/,Le=rt([" ","	",`
`,"\r"],!1,!1),X=0,Ue=[{line:1,column:1}],et=0,ze=[],ge;if("startRule"in o){if(!(o.startRule in l))throw new Error(`Can't start parsing from rule "`+o.startRule+'".');u=l[o.startRule]}function ct(W,Q){return{type:"literal",text:W,ignoreCase:Q}}function rt(W,Q,fe){return{type:"class",parts:W,inverted:Q,ignoreCase:fe}}function ut(){return{type:"end"}}function ht(W){var Q=Ue[W],fe;if(Q)return Q;for(fe=W-1;!Ue[fe];)fe--;for(Q=Ue[fe],Q={line:Q.line,column:Q.column};fe<W;)s.charCodeAt(fe)===10?(Q.line++,Q.column=1):Q.column++,fe++;return Ue[W]=Q,Q}function tt(W,Q){var fe=ht(W),re=ht(Q);return{start:{offset:W,line:fe.line,column:fe.column},end:{offset:Q,line:re.line,column:re.column}}}function pt(W){X<et||(X>et&&(et=X,ze=[]),ze.push(W))}function Nt(W,Q,fe){return new r(r.buildMessage(W,Q),W,Q,fe)}function ti(){var W,Q,fe,re,Ae;for(W=X,Q=[],fe=yt();fe!==a;)Q.push(fe),fe=yt();if(Q!==a)if(fe=xe(),fe===a&&(fe=null),fe!==a){for(re=[],Ae=yt();Ae!==a;)re.push(Ae),Ae=yt();re!==a?(Q=c(fe),W=Q):(X=W,W=a)}else X=W,W=a;else X=W,W=a;return W}function xe(){var W,Q,fe,re,Ae,at;if(W=X,Q=Ge(),Q!==a){for(fe=[],re=X,Ae=[],at=yt();at!==a;)Ae.push(at),at=yt();for(Ae!==a?(at=Ge(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;){for(fe.push(re),re=X,Ae=[],at=yt();at!==a;)Ae.push(at),at=yt();Ae!==a?(at=Ge(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a)}fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function Ge(){var W,Q,fe,re,Ae,at;if(W=X,Q=He(),Q!==a){for(fe=[],re=X,Ae=[],at=yt();at!==a;)Ae.push(at),at=yt();for(Ae!==a?(at=ie(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;){for(fe.push(re),re=X,Ae=[],at=yt();at!==a;)Ae.push(at),at=yt();Ae!==a?(at=ie(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a)}fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function ie(){var W;return W=Ye(),W===a&&(W=dt(),W===a&&(W=ri(),W===a&&(W=li(),W===a&&(W=yr(),W===a&&(W=Ks(),W===a&&(W=he(),W===a&&(W=Ne(),W===a&&(W=Lt())))))))),W}function He(){var W,Q,fe,re,Ae,at,Yr;if(W=X,d.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(p)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=ne(),re!==a?(Ae=X,at=ke(),at===a&&(at=null),at!==a?(Yr=At(),Yr!==a?(at=[at,Yr],Ae=at):(X=Ae,Ae=a)):(X=Ae,Ae=a),Ae===a&&(Ae=null),Ae!==a?(Q=f(Q,re,Ae),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function Ye(){var W,Q;return W=X,m.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(g)),Q!==a&&(Q=y()),W=Q,W}function dt(){var W,Q,fe,re;if(W=X,v.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(b)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=At(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function At(){var W,Q,fe,re,Ae,at;if(W=X,Q=ne(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=ne(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=ne(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function ri(){var W,Q,fe,re;if(W=X,A.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(S)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=Si(),re!==a?(Q=E(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function Si(){var W,Q,fe,re,Ae,at;if(W=X,Q=De(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=De(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=De(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function li(){var W,Q,fe,re;if(W=X,M.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(R)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=Si(),re!==a?(Q=C(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function yr(){var W,Q,fe,re;if(W=X,T.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(L)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=gi(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function gi(){var W,Q,fe,re,Ae,at;if(W=X,Q=Br(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Br(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Br(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function Br(){var W,Q,fe,re,Ae,at;return W=X,Q=ne(),Q!==a?(fe=ke(),fe===a&&(fe=null),fe!==a?(re=ne(),re!==a?(Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=ne(),at!==a?(Q=I(Q,re,at),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a),W}function Ks(){var W,Q,fe,re;if(W=X,D.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(F)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=Kh(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function Kh(){var W,Q,fe,re,Ae,at;if(W=X,Q=Vl(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Vl(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Vl(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function Vl(){var W,Q,fe,re;return W=X,Q=ne(),Q!==a?(fe=ke(),fe===a&&(fe=null),fe!==a?(re=ne(),re!==a?(Q=H(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a),W}function he(){var W,Q,fe,re;if(W=X,z.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(B)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=Ve(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function Ve(){var W,Q,fe,re,Ae,at;if(W=X,Q=Qe(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Qe(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=Qe(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function Qe(){var W,Q,fe,re;return W=X,Q=ne(),Q!==a?(fe=ke(),fe===a&&(fe=null),fe!==a?(re=ne(),re!==a?(Q=j(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a),W}function Ne(){var W,Q,fe,re;if(W=X,V.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(q)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=$e(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function $e(){var W,Q,fe,re,Ae,at;if(W=X,Q=ne(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=ne(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=ne(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function Lt(){var W,Q,fe,re;if(W=X,K.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(le)),Q!==a){for(fe=[],re=yt();re!==a;)fe.push(re),re=yt();fe!==a?(re=oi(),re!==a?(Q=_(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)}else X=W,W=a;return W}function oi(){var W,Q,fe,re,Ae,at;if(W=X,Q=hi(),Q!==a){for(fe=[],re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=hi(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);re!==a;)fe.push(re),re=X,Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=hi(),at!==a?(Ae=[Ae,at],re=Ae):(X=re,re=a)):(X=re,re=a);fe!==a?(Q=h(Q,fe),W=Q):(X=W,W=a)}else X=W,W=a;return W}function hi(){var W,Q,fe,re,Ae,at,Yr,Kr,xr,$o,jl,dn;return W=X,Q=Pe(),Q!==a?(fe=ke(),fe===a&&(fe=null),fe!==a?(re=Pe(),re!==a?(Ae=ke(),Ae===a&&(Ae=null),Ae!==a?(at=De(),at!==a?(Yr=ke(),Yr!==a?(Kr=Be(),Kr!==a?(xr=ke(),xr===a&&(xr=null),xr!==a?($o=Be(),$o!==a?(jl=ke(),jl===a&&(jl=null),jl!==a?(dn=ne(),dn!==a?(Q=Z(Q,re,at,Kr,$o,dn),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a)):(X=W,W=a),W}function ne(){var W,Q,fe,re;return W=X,Q=De(),Q!==a?(fe=ke(),fe===a&&(fe=null),fe!==a?(re=De(),re!==a?(Q=oe(Q,re),W=Q):(X=W,W=a)):(X=W,W=a)):(X=W,W=a),W}function Pe(){var W,Q;return W=X,Q=Rt(),Q===a&&(Q=Gt()),Q!==a&&(Q=ae(Q)),W=Q,W}function De(){var W,Q,fe,re;return W=X,Q=X,fe=bt(),fe===a&&(fe=null),fe!==a?(re=Rt(),re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)):(X=Q,Q=a),Q===a&&(Q=X,fe=bt(),fe===a&&(fe=null),fe!==a?(re=Gt(),re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)):(X=Q,Q=a)),Q!==a&&(Q=ve(Q)),W=Q,W}function Be(){var W,Q;return W=X,ye.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(pe)),Q!==a&&(Q=Se(Q)),W=Q,W}function ke(){var W,Q,fe,re,Ae;if(W=X,Q=[],fe=yt(),fe!==a)for(;fe!==a;)Q.push(fe),fe=yt();else Q=a;if(Q!==a)if(fe=gt(),fe===a&&(fe=null),fe!==a){for(re=[],Ae=yt();Ae!==a;)re.push(Ae),Ae=yt();re!==a?(Q=[Q,fe,re],W=Q):(X=W,W=a)}else X=W,W=a;else X=W,W=a;if(W===a){if(W=X,Q=X,fe=gt(),fe!==a){for(re=[],Ae=yt();Ae!==a;)re.push(Ae),Ae=yt();re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)}else X=Q,Q=a;Q!==a&&(Q=be()),W=Q}return W}function gt(){var W;return s.charCodeAt(X)===44?(W=ee,X++):(W=a,pt(_e)),W}function Rt(){var W,Q,fe,re;return W=X,Q=X,fe=zt(),fe!==a?(re=Mt(),re===a&&(re=null),re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)):(X=Q,Q=a),Q===a&&(Q=X,fe=Gt(),fe!==a?(re=Mt(),re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)):(X=Q,Q=a)),Q!==a&&(Q=Me(Q)),W=Q,W}function zt(){var W,Q,fe,re,Ae;return W=X,Q=X,fe=Gt(),fe===a&&(fe=null),fe!==a?(s.charCodeAt(X)===46?(re=Ce,X++):(re=a,pt(Re)),re!==a?(Ae=Gt(),Ae!==a?(fe=[fe,re,Ae],Q=fe):(X=Q,Q=a)):(X=Q,Q=a)):(X=Q,Q=a),Q===a&&(Q=X,fe=Gt(),fe!==a?(s.charCodeAt(X)===46?(re=Ce,X++):(re=a,pt(Re)),re!==a?(fe=[fe,re],Q=fe):(X=Q,Q=a)):(X=Q,Q=a)),Q!==a&&(Q=Me(Q)),W=Q,W}function Mt(){var W,Q,fe,re,Ae;return W=X,Q=X,Xe.test(s.charAt(X))?(fe=s.charAt(X),X++):(fe=a,pt(Oe)),fe!==a?(re=bt(),re===a&&(re=null),re!==a?(Ae=Gt(),Ae!==a?(fe=[fe,re,Ae],Q=fe):(X=Q,Q=a)):(X=Q,Q=a)):(X=Q,Q=a),Q!==a&&(Q=Me(Q)),W=Q,W}function bt(){var W;return $.test(s.charAt(X))?(W=s.charAt(X),X++):(W=a,pt(J)),W}function Gt(){var W,Q,fe;if(W=X,Q=[],we.test(s.charAt(X))?(fe=s.charAt(X),X++):(fe=a,pt(te)),fe!==a)for(;fe!==a;)Q.push(fe),we.test(s.charAt(X))?(fe=s.charAt(X),X++):(fe=a,pt(te));else Q=a;return Q!==a&&(Q=Y(Q)),W=Q,W}function yt(){var W,Q;return W=X,ce.test(s.charAt(X))?(Q=s.charAt(X),X++):(Q=a,pt(Le)),Q!==a&&(Q=be()),W=Q,W}function Vi(W,Q){if(!Q)return[W];for(var fe=[W],re=0,Ae=Q.length;re<Ae;re++)fe[re+1]=Q[re][1];return fe}var Er={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Ni in Er)Er[Ni.toUpperCase()]=Er[Ni];function rr(W,Q){Q||(Q=[{}]);for(var fe=Q.length;fe--;){var re={code:W,command:Er[W]};W==W.toLowerCase()&&(re.relative=!0);for(var Ae in Q[fe])re[Ae]=Q[fe][Ae];Q[fe]=re}return Q}if(ge=u(),ge!==a&&X===s.length)return ge;throw ge!==a&&X<s.length&&pt(ut()),Nt(ze,et<s.length?s.charAt(et):null,et<s.length?tt(et,et+1):tt(et,et))}e.exports={SyntaxError:r,parse:n}}),cQ=Rs((t,e)=>{var i=gce().parse;i.parseSVG=i,i.makeAbsolute=r,e.exports=i;function r(n){var s,o={x:0,y:0},a={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(s=l),l.x0=o.x,l.y0=o.y;for(var u in a)u in l&&(l[u]+=l.relative?l[a[u]]:0);"x"in l||(l.x=o.x),"y"in l||(l.y=o.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=s.x,l.y=s.y),o=l}),n}}),yce=Rs((t,e)=>{function i(r){for(var n=new Array(r),s=0;s<r;++s)n[s]=s;return n}e.exports=i}),vce=Rs((t,e)=>{e.exports=function(n){return n!=null&&(i(n)||r(n)||!!n._isBuffer)};function i(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function r(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&i(n.slice(0,0))}}),W1=Rs((t,e)=>{var i=yce(),r=vce(),n=typeof Float64Array<"u";function s(h,d){return h[0]-d[0]}function o(){var h=this.stride,d=new Array(h.length),p;for(p=0;p<d.length;++p)d[p]=[Math.abs(h[p]),p];d.sort(s);var f=new Array(d.length);for(p=0;p<f.length;++p)f[p]=d[p][1];return f}function a(h,d){var p=["View",d,"d",h].join("");d<0&&(p="View_Nil"+h);var f=h==="generic";if(d===-1){var m="function "+p+"(a){this.data=a;};var proto="+p+".prototype;proto.dtype='"+h+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+p+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+p+"(a){return new "+p+"(a);}",C=new Function(m);return C()}else if(d===0){var m="function "+p+"(a,d) {this.data = a;this.offset = d};var proto="+p+".prototype;proto.dtype='"+h+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+p+"_copy() {return new "+p+"(this.data,this.offset)};proto.pick=function "+p+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+p+"_get(){return "+(f?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+p+"_set(v){return "+(f?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+p+"(a,b,c,d){return new "+p+"(a,d)}",C=new Function("TrivialArray",m);return C(u[h][0])}var m=["'use strict'"],g=i(d),y=g.map(function(T){return"i"+T}),v="this.offset+"+g.map(function(T){return"this.stride["+T+"]*i"+T}).join("+"),b=g.map(function(T){return"b"+T}).join(","),_=g.map(function(T){return"c"+T}).join(",");m.push("function "+p+"(a,"+b+","+_+",d){this.data=a","this.shape=["+b+"]","this.stride=["+_+"]","this.offset=d|0}","var proto="+p+".prototype","proto.dtype='"+h+"'","proto.dimension="+d),m.push("Object.defineProperty(proto,'size',{get:function "+p+"_size(){return "+g.map(function(T){return"this.shape["+T+"]"}).join("*"),"}})"),d===1?m.push("proto.order=[0]"):(m.push("Object.defineProperty(proto,'order',{get:"),d<4?(m.push("function "+p+"_order(){"),d===2?m.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):d===3&&m.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):m.push("ORDER})")),m.push("proto.set=function "+p+"_set("+y.join(",")+",v){"),f?m.push("return this.data.set("+v+",v)}"):m.push("return this.data["+v+"]=v}"),m.push("proto.get=function "+p+"_get("+y.join(",")+"){"),f?m.push("return this.data.get("+v+")}"):m.push("return this.data["+v+"]}"),m.push("proto.index=function "+p+"_index(",y.join(),"){return "+v+"}"),m.push("proto.hi=function "+p+"_hi("+y.join(",")+"){return new "+p+"(this.data,"+g.map(function(T){return["(typeof i",T,"!=='number'||i",T,"<0)?this.shape[",T,"]:i",T,"|0"].join("")}).join(",")+","+g.map(function(T){return"this.stride["+T+"]"}).join(",")+",this.offset)}");var A=g.map(function(T){return"a"+T+"=this.shape["+T+"]"}),S=g.map(function(T){return"c"+T+"=this.stride["+T+"]"});m.push("proto.lo=function "+p+"_lo("+y.join(",")+"){var b=this.offset,d=0,"+A.join(",")+","+S.join(","));for(var E=0;E<d;++E)m.push("if(typeof i"+E+"==='number'&&i"+E+">=0){d=i"+E+"|0;b+=c"+E+"*d;a"+E+"-=d}");m.push("return new "+p+"(this.data,"+g.map(function(T){return"a"+T}).join(",")+","+g.map(function(T){return"c"+T}).join(",")+",b)}"),m.push("proto.step=function "+p+"_step("+y.join(",")+"){var "+g.map(function(T){return"a"+T+"=this.shape["+T+"]"}).join(",")+","+g.map(function(T){return"b"+T+"=this.stride["+T+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var E=0;E<d;++E)m.push("if(typeof i"+E+"==='number'){d=i"+E+"|0;if(d<0){c+=b"+E+"*(a"+E+"-1);a"+E+"=ceil(-a"+E+"/d)}else{a"+E+"=ceil(a"+E+"/d)}b"+E+"*=d}");m.push("return new "+p+"(this.data,"+g.map(function(T){return"a"+T}).join(",")+","+g.map(function(T){return"b"+T}).join(",")+",c)}");for(var M=new Array(d),R=new Array(d),E=0;E<d;++E)M[E]="a[i"+E+"]",R[E]="b[i"+E+"]";m.push("proto.transpose=function "+p+"_transpose("+y+"){"+y.map(function(T,L){return T+"=("+T+"===undefined?"+L+":"+T+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+p+"(this.data,"+M.join(",")+","+R.join(",")+",this.offset)}"),m.push("proto.pick=function "+p+"_pick("+y+"){var a=[],b=[],c=this.offset");for(var E=0;E<d;++E)m.push("if(typeof i"+E+"==='number'&&i"+E+">=0){c=(c+this.stride["+E+"]*i"+E+")|0}else{a.push(this.shape["+E+"]);b.push(this.stride["+E+"])}");m.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),m.push("return function construct_"+p+"(data,shape,stride,offset){return new "+p+"(data,"+g.map(function(T){return"shape["+T+"]"}).join(",")+","+g.map(function(T){return"stride["+T+"]"}).join(",")+",offset)}");var C=new Function("CTOR_LIST","ORDER",m.join(`
`));return C(u[h],o)}function l(h){if(r(h))return"buffer";if(n)switch(Object.prototype.toString.call(h)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(h)?"array":"generic"}var u={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function c(h,d,p,f){if(h===void 0){var _=u.array[0];return _([])}else typeof h=="number"&&(h=[h]);d===void 0&&(d=[h.length]);var m=d.length;if(p===void 0){p=new Array(m);for(var g=m-1,y=1;g>=0;--g)p[g]=y,y*=d[g]}if(f===void 0){f=0;for(var g=0;g<m;++g)p[g]<0&&(f-=(d[g]-1)*p[g])}for(var v=l(h),b=u[v];b.length<=m+1;)b.push(a(v,b.length-1));var _=b[m+1];return _(h,d,p,f)}e.exports=c}),bce=Rs((t,e)=>{function i(s,o){for(var a=1,l=s.length,u=s[0],c=s[0],h=1;h<l;++h)if(c=u,u=s[h],o(u,c)){if(h===a){a++;continue}s[a++]=u}return s.length=a,s}function r(s){for(var o=1,a=s.length,l=s[0],u=s[0],c=1;c<a;++c,u=l)if(u=l,l=s[c],l!==u){if(c===o){o++;continue}s[o++]=l}return s.length=o,s}function n(s,o,a){return s.length===0?s:o?(a||s.sort(o),i(s,o)):(a||s.sort(),r(s))}e.exports=n}),xce=Rs((t,e)=>{var i=bce();function r(u,c,h){var d=u.length,p=c.arrayArgs.length,f=c.indexArgs.length>0,m=[],g=[],y=0,v=0,b,_;for(b=0;b<d;++b)g.push(["i",b,"=0"].join(""));for(_=0;_<p;++_)for(b=0;b<d;++b)v=y,y=u[b],b===0?g.push(["d",_,"s",b,"=t",_,"p",y].join("")):g.push(["d",_,"s",b,"=(t",_,"p",y,"-s",v,"*t",_,"p",v,")"].join(""));for(g.length>0&&m.push("var "+g.join(",")),b=d-1;b>=0;--b)y=u[b],m.push(["for(i",b,"=0;i",b,"<s",y,";++i",b,"){"].join(""));for(m.push(h),b=0;b<d;++b){for(v=y,y=u[b],_=0;_<p;++_)m.push(["p",_,"+=d",_,"s",b].join(""));f&&(b>0&&m.push(["index[",v,"]-=s",v].join("")),m.push(["++index[",y,"]"].join(""))),m.push("}")}return m.join(`
`)}function n(u,c,h,d){for(var p=c.length,f=h.arrayArgs.length,m=h.blockSize,g=h.indexArgs.length>0,y=[],v=0;v<f;++v)y.push(["var offset",v,"=p",v].join(""));for(var v=u;v<p;++v)y.push(["for(var j"+v+"=SS[",c[v],"]|0;j",v,">0;){"].join("")),y.push(["if(j",v,"<",m,"){"].join("")),y.push(["s",c[v],"=j",v].join("")),y.push(["j",v,"=0"].join("")),y.push(["}else{s",c[v],"=",m].join("")),y.push(["j",v,"-=",m,"}"].join("")),g&&y.push(["index[",c[v],"]=j",v].join(""));for(var v=0;v<f;++v){for(var b=["offset"+v],_=u;_<p;++_)b.push(["j",_,"*t",v,"p",c[_]].join(""));y.push(["p",v,"=(",b.join("+"),")"].join(""))}y.push(r(c,h,d));for(var v=u;v<p;++v)y.push("}");return y.join(`
`)}function s(u){for(var c=0,h=u[0].length;c<h;){for(var d=1;d<u.length;++d)if(u[d][c]!==u[0][c])return c;++c}return c}function o(u,c,h){for(var d=u.body,p=[],f=[],m=0;m<u.args.length;++m){var g=u.args[m];if(!(g.count<=0)){var y=new RegExp(g.name,"g"),v="",b=c.arrayArgs.indexOf(m);switch(c.argTypes[m]){case"offset":var _=c.offsetArgIndex.indexOf(m),A=c.offsetArgs[_];b=A.array,v="+q"+_;case"array":v="p"+b+v;var S="l"+m,E="a"+b;if(c.arrayBlockIndices[b]===0)g.count===1?h[b]==="generic"?g.lvalue?(p.push(["var ",S,"=",E,".get(",v,")"].join("")),d=d.replace(y,S),f.push([E,".set(",v,",",S,")"].join(""))):d=d.replace(y,[E,".get(",v,")"].join("")):d=d.replace(y,[E,"[",v,"]"].join("")):h[b]==="generic"?(p.push(["var ",S,"=",E,".get(",v,")"].join("")),d=d.replace(y,S),g.lvalue&&f.push([E,".set(",v,",",S,")"].join(""))):(p.push(["var ",S,"=",E,"[",v,"]"].join("")),d=d.replace(y,S),g.lvalue&&f.push([E,"[",v,"]=",S].join("")));else{for(var M=[g.name],R=[v],C=0;C<Math.abs(c.arrayBlockIndices[b]);C++)M.push("\\s*\\[([^\\]]+)\\]"),R.push("$"+(C+1)+"*t"+b+"b"+C);if(y=new RegExp(M.join(""),"g"),v=R.join("+"),h[b]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");d=d.replace(y,[E,"[",v,"]"].join(""))}break;case"scalar":d=d.replace(y,"Y"+c.scalarArgs.indexOf(m));break;case"index":d=d.replace(y,"index");break;case"shape":d=d.replace(y,"shape");break}}}return[p.join(`
`),d,f.join(`
`)].join(`
`).trim()}function a(u){for(var c=new Array(u.length),h=!0,d=0;d<u.length;++d){var p=u[d],f=p.match(/\d+/);f?f=f[0]:f="",p.charAt(0)===0?c[d]="u"+p.charAt(1)+f:c[d]=p.charAt(0)+f,d>0&&(h=h&&c[d]===c[d-1])}return h?c[0]:c.join("")}function l(u,c){for(var h=c[1].length-Math.abs(u.arrayBlockIndices[0])|0,d=new Array(u.arrayArgs.length),p=new Array(u.arrayArgs.length),f=0;f<u.arrayArgs.length;++f)p[f]=c[2*f],d[f]=c[2*f+1];for(var m=[],g=[],y=[],v=[],b=[],f=0;f<u.arrayArgs.length;++f){u.arrayBlockIndices[f]<0?(y.push(0),v.push(h),m.push(h),g.push(h+u.arrayBlockIndices[f])):(y.push(u.arrayBlockIndices[f]),v.push(u.arrayBlockIndices[f]+h),m.push(0),g.push(u.arrayBlockIndices[f]));for(var _=[],A=0;A<d[f].length;A++)y[f]<=d[f][A]&&d[f][A]<v[f]&&_.push(d[f][A]-y[f]);b.push(_)}for(var S=["SS"],E=["'use strict'"],M=[],A=0;A<h;++A)M.push(["s",A,"=SS[",A,"]"].join(""));for(var f=0;f<u.arrayArgs.length;++f){S.push("a"+f),S.push("t"+f),S.push("p"+f);for(var A=0;A<h;++A)M.push(["t",f,"p",A,"=t",f,"[",y[f]+A,"]"].join(""));for(var A=0;A<Math.abs(u.arrayBlockIndices[f]);++A)M.push(["t",f,"b",A,"=t",f,"[",m[f]+A,"]"].join(""))}for(var f=0;f<u.scalarArgs.length;++f)S.push("Y"+f);if(u.shapeArgs.length>0&&M.push("shape=SS.slice(0)"),u.indexArgs.length>0){for(var R=new Array(h),f=0;f<h;++f)R[f]="0";M.push(["index=[",R.join(","),"]"].join(""))}for(var f=0;f<u.offsetArgs.length;++f){for(var C=u.offsetArgs[f],T=[],A=0;A<C.offset.length;++A)C.offset[A]!==0&&(C.offset[A]===1?T.push(["t",C.array,"p",A].join("")):T.push([C.offset[A],"*t",C.array,"p",A].join("")));T.length===0?M.push("q"+f+"=0"):M.push(["q",f,"=",T.join("+")].join(""))}var L=i([].concat(u.pre.thisVars).concat(u.body.thisVars).concat(u.post.thisVars));M=M.concat(L),M.length>0&&E.push("var "+M.join(","));for(var f=0;f<u.arrayArgs.length;++f)E.push("p"+f+"|=0");u.pre.body.length>3&&E.push(o(u.pre,u,p));var I=o(u.body,u,p),D=s(b);D<h?E.push(n(D,b[0],u,I)):E.push(r(b[0],u,I)),u.post.body.length>3&&E.push(o(u.post,u,p)),u.debug&&console.log("-----Generated cwise routine for ",c,`:
`+E.join(`
`)+`
----------`);var F=[u.funcName||"unnamed","_cwise_loop_",d[0].join("s"),"m",D,a(p)].join(""),H=new Function(["function ",F,"(",S.join(","),"){",E.join(`
`),"} return ",F].join(""));return H()}e.exports=l}),wce=Rs((t,e)=>{var i=xce();function r(n){var s=["'use strict'","var CACHED={}"],o=[],a=n.funcName+"_cwise_thunk";s.push(["return function ",a,"(",n.shimArgs.join(","),"){"].join(""));for(var l=[],u=[],c=[["array",n.arrayArgs[0],".shape.slice(",Math.max(0,n.arrayBlockIndices[0]),n.arrayBlockIndices[0]<0?","+n.arrayBlockIndices[0]+")":")"].join("")],h=[],d=[],p=0;p<n.arrayArgs.length;++p){var f=n.arrayArgs[p];o.push(["t",f,"=array",f,".dtype,","r",f,"=array",f,".order"].join("")),l.push("t"+f),l.push("r"+f),u.push("t"+f),u.push("r"+f+".join()"),c.push("array"+f+".data"),c.push("array"+f+".stride"),c.push("array"+f+".offset|0"),p>0&&(h.push("array"+n.arrayArgs[0]+".shape.length===array"+f+".shape.length+"+(Math.abs(n.arrayBlockIndices[0])-Math.abs(n.arrayBlockIndices[p]))),d.push("array"+n.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[0])+"]===array"+f+".shape[shapeIndex+"+Math.max(0,n.arrayBlockIndices[p])+"]"))}n.arrayArgs.length>1&&(s.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),s.push("for(var shapeIndex=array"+n.arrayArgs[0]+".shape.length-"+Math.abs(n.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),s.push("if (!("+d.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),s.push("}"));for(var p=0;p<n.scalarArgs.length;++p)c.push("scalar"+n.scalarArgs[p]);o.push(["type=[",u.join(","),"].join()"].join("")),o.push("proc=CACHED[type]"),s.push("var "+o.join(",")),s.push(["if(!proc){","CACHED[type]=proc=compile([",l.join(","),"])}","return proc(",c.join(","),")}"].join("")),n.debug&&console.log(`-----Generated thunk:
`+s.join(`
`)+`
----------`);var m=new Function("compile",s.join(`
`));return m(i.bind(void 0,n))}e.exports=r}),_ce=Rs((t,e)=>{var i=wce();function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function n(s){var o=new r;o.pre=s.pre,o.body=s.body,o.post=s.post;var a=s.args.slice(0);o.argTypes=a;for(var l=0;l<a.length;++l){var u=a[l];if(u==="array"||typeof u=="object"&&u.blockIndices){if(o.argTypes[l]="array",o.arrayArgs.push(l),o.arrayBlockIndices.push(u.blockIndices?u.blockIndices:0),o.shimArgs.push("array"+l),l<o.pre.args.length&&o.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array args");if(l<o.post.args.length&&o.post.args[l].count>0)throw new Error("cwise: post() block may not reference array args")}else if(u==="scalar")o.scalarArgs.push(l),o.shimArgs.push("scalar"+l);else if(u==="index"){if(o.indexArgs.push(l),l<o.pre.args.length&&o.pre.args[l].count>0)throw new Error("cwise: pre() block may not reference array index");if(l<o.body.args.length&&o.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array index");if(l<o.post.args.length&&o.post.args[l].count>0)throw new Error("cwise: post() block may not reference array index")}else if(u==="shape"){if(o.shapeArgs.push(l),l<o.pre.args.length&&o.pre.args[l].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(l<o.body.args.length&&o.body.args[l].lvalue)throw new Error("cwise: body() block may not write to array shape");if(l<o.post.args.length&&o.post.args[l].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if(typeof u=="object"&&u.offset)o.argTypes[l]="offset",o.offsetArgs.push({array:u.array,offset:u.offset}),o.offsetArgIndex.push(l);else throw new Error("cwise: Unknown argument type "+a[l])}if(o.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(o.pre.args.length>a.length)throw new Error("cwise: Too many arguments in pre() block");if(o.body.args.length>a.length)throw new Error("cwise: Too many arguments in body() block");if(o.post.args.length>a.length)throw new Error("cwise: Too many arguments in post() block");return o.debug=!!s.printCode||!!s.debug,o.funcName=s.funcName||"cwise",o.blockSize=s.blockSize||64,i(o)}e.exports=n}),q1=Rs(t=>{var e=_ce(),i={body:"",args:[],thisVars:[],localVars:[]};function r(d){if(!d)return i;for(var p=0;p<d.args.length;++p){var f=d.args[p];p===0?d.args[p]={name:f,lvalue:!0,rvalue:!!d.rvalue,count:d.count||1}:d.args[p]={name:f,lvalue:!1,rvalue:!0,count:1}}return d.thisVars||(d.thisVars=[]),d.localVars||(d.localVars=[]),d}function n(d){return e({args:d.args,pre:r(d.pre),body:r(d.body),post:r(d.proc),funcName:d.funcName})}function s(d){for(var p=[],f=0;f<d.args.length;++f)p.push("a"+f);var m=new Function("P",["return function ",d.funcName,"_ndarrayops(",p.join(","),") {P(",p.join(","),");return a0}"].join(""));return m(n(d))}var o={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var d in o){var p=o[d];t[d]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+p+"c"},funcName:d}),t[d+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+p+"=b"},rvalue:!0,funcName:d+"eq"}),t[d+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+p+"s"},funcName:d+"s"}),t[d+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+p+"=s"},rvalue:!0,funcName:d+"seq"})}})();var a={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var d in a){var p=a[d];t[d]=s({args:["array","array"],body:{args:["a","b"],body:"a="+p+"b"},funcName:d}),t[d+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+p+"a"},rvalue:!0,count:2,funcName:d+"eq"})}})();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var d in l){var p=l[d];t[d]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+p+"c"},funcName:d}),t[d+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+p+"s"},funcName:d+"s"}),t[d+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+p+"b"},rvalue:!0,count:2,funcName:d+"eq"}),t[d+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+p+"s"},rvalue:!0,count:2,funcName:d+"seq"})}})();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var d=0;d<u.length;++d){var p=u[d];t[p]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:p}),t[p+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:p+"eq"})}})();var c=["max","min","atan2","pow"];(function(){for(var d=0;d<c.length;++d){var p=c[d];t[p]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:p}),t[p+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:p+"s"}),t[p+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:p+"eq"}),t[p+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:p+"seq"})}})();var h=["atan2","pow"];(function(){for(var d=0;d<h.length;++d){var p=h[d];t[p+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:p+"op"}),t[p+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:p+"ops"}),t[p+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:p+"opeq"}),t[p+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+p,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:p+"opseq"})}})(),t.any=e({args:["array"],pre:i,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=e({args:["array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=e({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=e({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=e({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=e({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=e({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=e({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),Sce=Rs((t,e)=>{e.exports=function(i,r){for(var n=i.split("."),s=r.split("."),o=0;o<3;o++){var a=Number(n[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),B0="149",ll={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ace=0,DV=1,Ece=2,bF=1,Mce=2,Ux=3,Eu=0,As=1,fa=2,Gn=0,cm=1,IV=2,LV=3,BV=4,Cce=5,Uy=100,Pce=101,Tce=102,OV=103,UV=104,Rce=200,kce=201,Dce=202,Ice=203,dQ=204,pQ=205,Lce=206,Bce=207,Oce=208,Uce=209,Nce=210,Fce=0,zce=1,Hce=2,VL=3,Gce=4,Vce=5,jce=6,Wce=7,fQ=0,qce=1,Xce=2,Mh=0,Yce=1,Kce=2,Jce=3,Qce=4,Zce=5,mQ=300,km=301,Dm=302,jL=303,WL=304,X1=306,Oc=1e3,kr=1001,qL=1002,Zi=1003,NV=1004,Ik=1005,mi=1006,$ce=1007,$v=1008,bo=1009,ede=1010,tde=1011,gQ=1012,ide=1013,Uc=1014,Fn=1015,Im=1016,rde=1017,nde=1018,dm=1020,sde=1021,_s=1023,ode=1024,ade=1025,pm=1026,Lm=1027,lde=1028,ude=1029,zC=1030,hde=1031,yQ=1033,Lk=33776,Bk=33777,Ok=33778,Uk=33779,FV=35840,zV=35841,HV=35842,GV=35843,cde=36196,VV=37492,jV=37496,WV=37808,qV=37809,XV=37810,YV=37811,KV=37812,JV=37813,QV=37814,ZV=37815,$V=37816,ej=37817,tj=37818,ij=37819,rj=37820,nj=37821,Nk=36492,dde=36283,sj=36284,oj=36285,aj=36286,vQ=2200,bQ=2201,xF=2202,HC=2300,GC=2301,Fk=2302,nv=2400,sv=2401,VC=2402,wF=2500,pde=2501,Mu=3e3,pi=3001,ld=3200,xQ=3201,fde=0,mde=1,lh="srgb",jC="srgb-linear",zk=7680,gde=519,XL=35044,yde=35048,lj="300 es",YL=1035,Ys=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let i=this._listeners[t];if(i!==void 0){let r=i.indexOf(e);r!==-1&&i.splice(r,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let e=this._listeners[t.type];if(e!==void 0){t.target=this;let i=e.slice(0);for(let r=0,n=i.length;r<n;r++)i[r].call(this,t);t.target=null}}},io=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],uj=1234567,sw=Math.PI/180,jw=180/Math.PI;function Bl(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(io[t&255]+io[t>>8&255]+io[t>>16&255]+io[t>>24&255]+"-"+io[e&255]+io[e>>8&255]+"-"+io[e>>16&15|64]+io[e>>24&255]+"-"+io[i&63|128]+io[i>>8&255]+"-"+io[i>>16&255]+io[i>>24&255]+io[r&255]+io[r>>8&255]+io[r>>16&255]+io[r>>24&255]).toLowerCase()}function Bn(t,e,i){return Math.max(e,Math.min(i,t))}function _F(t,e){return(t%e+e)%e}function vde(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)}function bde(t,e,i){return t!==e?(i-t)/(e-t):0}function ow(t,e,i){return(1-i)*t+i*e}function xde(t,e,i,r){return ow(t,e,1-Math.exp(-i*r))}function wde(t,e=1){return e-Math.abs(_F(t,e*2)-e)}function _de(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function Sde(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function Ade(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Ede(t,e){return t+Math.random()*(e-t)}function Mde(t){return t*(.5-Math.random())}function Cde(t){t!==void 0&&(uj=t);let e=uj+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Pde(t){return t*sw}function Tde(t){return t*jw}function KL(t){return(t&t-1)===0&&t!==0}function wQ(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function WC(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Rde(t,e,i,r,n){let s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),u=s((e+r)/2),c=o((e+r)/2),h=s((e-r)/2),d=o((e-r)/2),p=s((r-e)/2),f=o((r-e)/2);switch(n){case"XYX":t.set(a*c,l*h,l*d,a*u);break;case"YZY":t.set(l*d,a*c,l*h,a*u);break;case"ZXZ":t.set(l*h,l*d,a*c,a*u);break;case"XZX":t.set(a*c,l*f,l*p,a*u);break;case"YXY":t.set(l*p,a*c,l*f,a*u);break;case"ZYZ":t.set(l*f,l*p,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Nc(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function br(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var kt=Object.freeze({__proto__:null,DEG2RAD:sw,RAD2DEG:jw,ceilPowerOfTwo:wQ,clamp:Bn,damp:xde,degToRad:Pde,denormalize:Nc,euclideanModulo:_F,floorPowerOfTwo:WC,generateUUID:Bl,inverseLerp:bde,isPowerOfTwo:KL,lerp:ow,mapLinear:vde,normalize:br,pingpong:wde,radToDeg:Tde,randFloat:Ede,randFloatSpread:Mde,randInt:Ade,seededRandom:Cde,setQuaternionFromProperEuler:Rde,smootherstep:Sde,smoothstep:_de}),me=class{constructor(t=0,e=0){me.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,i=this.y,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6],this.y=r[1]*e+r[4]*i+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,s=this.y-t.y;return this.x=n*i-s*r+t.x,this.y=n*r+s*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},wn=class{constructor(){wn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,i,r,n,s,o,a,l){let u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=e,u[4]=n,u[5]=a,u[6]=i,u[7]=s,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,r=e.elements,n=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],u=i[4],c=i[7],h=i[2],d=i[5],p=i[8],f=r[0],m=r[3],g=r[6],y=r[1],v=r[4],b=r[7],_=r[2],A=r[5],S=r[8];return n[0]=s*f+o*y+a*_,n[3]=s*m+o*v+a*A,n[6]=s*g+o*b+a*S,n[1]=l*f+u*y+c*_,n[4]=l*m+u*v+c*A,n[7]=l*g+u*b+c*S,n[2]=h*f+d*y+p*_,n[5]=h*m+d*v+p*A,n[8]=h*g+d*b+p*S,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*s*u-e*o*l-i*n*u+i*o*a+r*n*l-r*s*a}invert(){let t=this.elements,e=t[0],i=t[1],r=t[2],n=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=u*s-o*l,h=o*a-u*n,d=l*n-s*a,p=e*c+i*h+r*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return t[0]=c*f,t[1]=(r*l-u*i)*f,t[2]=(o*i-r*s)*f,t[3]=h*f,t[4]=(u*e-r*a)*f,t[5]=(r*n-o*e)*f,t[6]=d*f,t[7]=(i*a-l*e)*f,t[8]=(s*e-i*n)*f,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,r,n,s,o){let a=Math.cos(n),l=Math.sin(n);return this.set(i*a,i*l,-i*(a*s+l*o)+s+t,-r*l,r*a,-r*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(Hk.makeScale(t,e)),this}rotate(t){return this.premultiply(Hk.makeRotation(-t)),this}translate(t,e){return this.premultiply(Hk.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,i=t.elements;for(let r=0;r<9;r++)if(e[r]!==i[r])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}},Hk=new wn;function _Q(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}var kde={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function FS(t,e){return new kde[t](e)}function Ww(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function fm(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function EM(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var Gk={[lh]:{[jC]:fm},[jC]:{[lh]:EM}},Eo={legacyMode:!0,get workingColorSpace(){return jC},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,i){if(this.legacyMode||e===i||!e||!i)return t;if(Gk[e]&&Gk[e][i]!==void 0){let r=Gk[e][i];return t.r=r(t.r),t.g=r(t.g),t.b=r(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},SQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yn={r:0,g:0,b:0},Yl={h:0,s:0,l:0},zS={h:0,s:0,l:0};function Vk(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}function HS(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var Xt=class{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,e===void 0&&i===void 0?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=lh){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Eo.toWorkingColorSpace(this,e),this}setRGB(t,e,i,r=Eo.workingColorSpace){return this.r=t,this.g=e,this.b=i,Eo.toWorkingColorSpace(this,r),this}setHSL(t,e,i,r=Eo.workingColorSpace){if(t=_F(t,1),e=Bn(e,0,1),i=Bn(i,0,1),e===0)this.r=this.g=this.b=i;else{let n=i<=.5?i*(1+e):i+e-i*e,s=2*i-n;this.r=Vk(s,n,t+1/3),this.g=Vk(s,n,t),this.b=Vk(s,n,t-1/3)}return Eo.toWorkingColorSpace(this,r),this}setStyle(t,e=lh){function i(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let n,s=r[1],o=r[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,Eo.toWorkingColorSpace(this,e),i(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,Eo.toWorkingColorSpace(this,e),i(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let a=parseFloat(n[1])/360,l=parseFloat(n[2])/100,u=parseFloat(n[3])/100;return i(n[4]),this.setHSL(a,l,u,e)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){let n=r[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,Eo.toWorkingColorSpace(this,e),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,Eo.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=lh){let i=SQ[t.toLowerCase()];return i!==void 0?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=fm(t.r),this.g=fm(t.g),this.b=fm(t.b),this}copyLinearToSRGB(t){return this.r=EM(t.r),this.g=EM(t.g),this.b=EM(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=lh){return Eo.fromWorkingColorSpace(HS(this,Yn),t),Bn(Yn.r*255,0,255)<<16^Bn(Yn.g*255,0,255)<<8^Bn(Yn.b*255,0,255)<<0}getHexString(t=lh){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Eo.workingColorSpace){Eo.fromWorkingColorSpace(HS(this,Yn),e);let i=Yn.r,r=Yn.g,n=Yn.b,s=Math.max(i,r,n),o=Math.min(i,r,n),a,l,u=(o+s)/2;if(o===s)a=0,l=0;else{let c=s-o;switch(l=u<=.5?c/(s+o):c/(2-s-o),s){case i:a=(r-n)/c+(r<n?6:0);break;case r:a=(n-i)/c+2;break;case n:a=(i-r)/c+4;break}a/=6}return t.h=a,t.s=l,t.l=u,t}getRGB(t,e=Eo.workingColorSpace){return Eo.fromWorkingColorSpace(HS(this,Yn),e),t.r=Yn.r,t.g=Yn.g,t.b=Yn.b,t}getStyle(t=lh){return Eo.fromWorkingColorSpace(HS(this,Yn),t),t!==lh?`color(${t} ${Yn.r} ${Yn.g} ${Yn.b})`:`rgb(${Yn.r*255|0},${Yn.g*255|0},${Yn.b*255|0})`}offsetHSL(t,e,i){return this.getHSL(Yl),Yl.h+=t,Yl.s+=e,Yl.l+=i,this.setHSL(Yl.h,Yl.s,Yl.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Yl),t.getHSL(zS);let i=ow(Yl.h,zS.h,e),r=ow(Yl.s,zS.s,e),n=ow(Yl.l,zS.l,e);return this.setHSL(i,r,n),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Xt.NAMES=SQ;var Mg,AQ=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Mg===void 0&&(Mg=Ww("canvas")),Mg.width=t.width,Mg.height=t.height;let i=Mg.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=Mg}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=Ww("canvas");e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);let r=i.getImageData(0,0,t.width,t.height),n=r.data;for(let s=0;s<n.length;s++)n[s]=fm(n[s]/255)*255;return i.putImageData(r,0,0),e}else if(t.data){let e=t.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(fm(e[i]/255)*255):e[i]=fm(e[i]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},EQ=class{constructor(t=null){this.isSource=!0,this.uuid=Bl(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let n;if(Array.isArray(r)){n=[];for(let s=0,o=r.length;s<o;s++)r[s].isDataTexture?n.push(jk(r[s].image)):n.push(jk(r[s]))}else n=jk(r);i.url=n}return e||(t.images[this.uuid]=i),i}};function jk(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?AQ.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Dde=0,Wr=class extends Ys{constructor(t=Wr.DEFAULT_IMAGE,e=Wr.DEFAULT_MAPPING,i=kr,r=kr,n=mi,s=$v,o=_s,a=bo,l=Wr.DEFAULT_ANISOTROPY,u=Mu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Dde++}),this.uuid=Bl(),this.name="",this.source=new EQ(t),this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new me(0,0),this.repeat=new me(1,1),this.center=new me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new wn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==mQ)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Oc:t.x=t.x-Math.floor(t.x);break;case kr:t.x=t.x<0?0:1;break;case qL:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Oc:t.y=t.y-Math.floor(t.y);break;case kr:t.y=t.y<0?0:1;break;case qL:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};Wr.DEFAULT_IMAGE=null;Wr.DEFAULT_MAPPING=mQ;Wr.DEFAULT_ANISOTROPY=1;var si=class{constructor(t=0,e=0,i=0,r=1){si.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,i=this.y,r=this.z,n=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*r+s[12]*n,this.y=s[1]*e+s[5]*i+s[9]*r+s[13]*n,this.z=s[2]*e+s[6]*i+s[10]*r+s[14]*n,this.w=s[3]*e+s[7]*i+s[11]*r+s[15]*n,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,r,n,s=t.elements,o=s[0],a=s[4],l=s[8],u=s[1],c=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(a-u)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(a+u)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(o+c+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let g=(o+1)/2,y=(c+1)/2,v=(f+1)/2,b=(a+u)/4,_=(l+d)/4,A=(h+p)/4;return g>y&&g>v?g<.01?(i=0,r=.707106781,n=.707106781):(i=Math.sqrt(g),r=b/i,n=_/i):y>v?y<.01?(i=.707106781,r=0,n=.707106781):(r=Math.sqrt(y),i=b/r,n=A/r):v<.01?(i=.707106781,r=.707106781,n=0):(n=Math.sqrt(v),i=_/n,r=A/n),this.set(i,r,n,e),this}let m=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(u-a)*(u-a));return Math.abs(m)<.001&&(m=1),this.x=(p-h)/m,this.y=(l-d)/m,this.z=(u-a)/m,this.w=Math.acos((o+c+f-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},$i=class extends Ys{constructor(t=1,e=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new si(0,0,t,e),this.scissorTest=!1,this.viewport=new si(0,0,t,e);let r={width:t,height:e,depth:1};this.texture=new Wr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:mi,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,e,i=1){(this.width!==t||this.height!==e||this.depth!==i)&&(this.width=t,this.height=e,this.depth=i,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let e=Object.assign({},t.texture.image);return this.texture.source=new EQ(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},MQ=class extends Wr{constructor(t=null,e=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:r},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Ide=class extends Wr{constructor(t=null,e=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:r},this.magFilter=Zi,this.minFilter=Zi,this.wrapR=kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Lde=class extends $i{constructor(t=1,e=1,i=1,r={}){super(t,e,r),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let r=0,n=this.texture.length;r<n;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,i=t.texture.length;e<i;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}},ni=class{constructor(t=0,e=0,i=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=r}static slerpFlat(t,e,i,r,n,s,o){let a=i[r+0],l=i[r+1],u=i[r+2],c=i[r+3],h=n[s+0],d=n[s+1],p=n[s+2],f=n[s+3];if(o===0){t[e+0]=a,t[e+1]=l,t[e+2]=u,t[e+3]=c;return}if(o===1){t[e+0]=h,t[e+1]=d,t[e+2]=p,t[e+3]=f;return}if(c!==f||a!==h||l!==d||u!==p){let m=1-o,g=a*h+l*d+u*p+c*f,y=g>=0?1:-1,v=1-g*g;if(v>Number.EPSILON){let _=Math.sqrt(v),A=Math.atan2(_,g*y);m=Math.sin(m*A)/_,o=Math.sin(o*A)/_}let b=o*y;if(a=a*m+h*b,l=l*m+d*b,u=u*m+p*b,c=c*m+f*b,m===1-o){let _=1/Math.sqrt(a*a+l*l+u*u+c*c);a*=_,l*=_,u*=_,c*=_}}t[e]=a,t[e+1]=l,t[e+2]=u,t[e+3]=c}static multiplyQuaternionsFlat(t,e,i,r,n,s){let o=i[r],a=i[r+1],l=i[r+2],u=i[r+3],c=n[s],h=n[s+1],d=n[s+2],p=n[s+3];return t[e]=o*p+u*c+a*d-l*h,t[e+1]=a*p+u*h+l*c-o*d,t[e+2]=l*p+u*d+o*h-a*c,t[e+3]=u*p-o*c-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){let i=t._x,r=t._y,n=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(i/2),u=o(r/2),c=o(n/2),h=a(i/2),d=a(r/2),p=a(n/2);switch(s){case"XYZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"YXZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"ZXY":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"ZYX":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"YZX":this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p;break;case"XZY":this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,i=e[0],r=e[4],n=e[8],s=e[1],o=e[5],a=e[9],l=e[2],u=e[6],c=e[10],h=i+o+c;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(u-a)*d,this._y=(n-l)*d,this._z=(s-r)*d}else if(i>o&&i>c){let d=2*Math.sqrt(1+i-o-c);this._w=(u-a)/d,this._x=.25*d,this._y=(r+s)/d,this._z=(n+l)/d}else if(o>c){let d=2*Math.sqrt(1+o-i-c);this._w=(n-l)/d,this._x=(r+s)/d,this._y=.25*d,this._z=(a+u)/d}else{let d=2*Math.sqrt(1+c-i-o);this._w=(s-r)/d,this._x=(n+l)/d,this._y=(a+u)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Bn(this.dot(t),-1,1)))}rotateTowards(t,e){let i=this.angleTo(t);if(i===0)return this;let r=Math.min(1,e/i);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let i=t._x,r=t._y,n=t._z,s=t._w,o=e._x,a=e._y,l=e._z,u=e._w;return this._x=i*u+s*o+r*l-n*a,this._y=r*u+s*a+n*o-i*l,this._z=n*u+s*l+i*a-r*o,this._w=s*u-i*o-r*a-n*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let i=this._x,r=this._y,n=this._z,s=this._w,o=s*t._w+i*t._x+r*t._y+n*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=i,this._y=r,this._z=n,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*i+e*this._x,this._y=d*r+e*this._y,this._z=d*n+e*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),u=Math.atan2(l,o),c=Math.sin((1-e)*u)/l,h=Math.sin(e*u)/l;return this._w=s*c+this._w*h,this._x=i*c+this._x*h,this._y=r*c+this._y*h,this._z=n*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){let t=Math.random(),e=Math.sqrt(1-t),i=Math.sqrt(t),r=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(e*Math.cos(r),i*Math.sin(n),i*Math.cos(n),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},N=class{constructor(e=0,i=0,r=0){N.prototype.isVector3=!0,this.x=e,this.y=i,this.z=r}set(e,i,r){return r===void 0&&(r=this.z),this.x=e,this.y=i,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(hj.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(hj.setFromAxisAngle(e,i))}applyMatrix3(e){let i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[3]*r+s[6]*n,this.y=s[1]*i+s[4]*r+s[7]*n,this.z=s[2]*i+s[5]*r+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let i=this.x,r=this.y,n=this.z,s=e.elements,o=1/(s[3]*i+s[7]*r+s[11]*n+s[15]);return this.x=(s[0]*i+s[4]*r+s[8]*n+s[12])*o,this.y=(s[1]*i+s[5]*r+s[9]*n+s[13])*o,this.z=(s[2]*i+s[6]*r+s[10]*n+s[14])*o,this}applyQuaternion(e){let i=this.x,r=this.y,n=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=l*i+o*n-a*r,c=l*r+a*i-s*n,h=l*n+s*r-o*i,d=-s*i-o*r-a*n;return this.x=u*l+d*-s+c*-a-h*-o,this.y=c*l+d*-o+h*-s-u*-a,this.z=h*l+d*-a+u*-o-c*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[4]*r+s[8]*n,this.y=s[1]*i+s[5]*r+s[9]*n,this.z=s[2]*i+s[6]*r+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this.z=e.z+(i.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){let r=e.x,n=e.y,s=e.z,o=i.x,a=i.y,l=i.z;return this.x=n*l-s*a,this.y=s*o-r*l,this.z=r*a-n*o,this}projectOnVector(e){let i=e.lengthSq();if(i===0)return this.set(0,0,0);let r=e.dot(this)/i;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return Wk.copy(this).projectOnVector(e),this.sub(Wk)}reflect(e){return this.sub(Wk.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;let r=this.dot(e)/i;return Math.acos(Bn(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let i=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return i*i+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,r){let n=Math.sin(i)*e;return this.x=n*Math.sin(r),this.y=Math.cos(i)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,r){return this.x=e*Math.sin(i),this.y=r,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){let i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){let i=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=r,this.z=n,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(i),this.y=r*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},Wk=new N,hj=new ni,Mn=class{constructor(t=new N(1/0,1/0,1/0),e=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){let u=t[a],c=t[a+1],h=t[a+2];u<e&&(e=u),c<i&&(i=c),h<r&&(r=h),u>n&&(n=u),c>s&&(s=c),h>o&&(o=h)}return this.min.set(e,i,r),this.max.set(n,s,o),this}setFromBufferAttribute(t){let e=1/0,i=1/0,r=1/0,n=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){let u=t.getX(a),c=t.getY(a),h=t.getZ(a);u<e&&(e=u),c<i&&(i=c),h<r&&(r=h),u>n&&(n=u),c>s&&(s=c),h>o&&(o=h)}return this.min.set(e,i,r),this.max.set(n,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=hf.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let i=t.geometry;if(i!==void 0)if(e&&i.attributes!=null&&i.attributes.position!==void 0){let n=i.attributes.position;for(let s=0,o=n.count;s<o;s++)hf.fromBufferAttribute(n,s).applyMatrix4(t.matrixWorld),this.expandByPoint(hf)}else i.boundingBox===null&&i.computeBoundingBox(),qk.copy(i.boundingBox),qk.applyMatrix4(t.matrixWorld),this.union(qk);let r=t.children;for(let n=0,s=r.length;n<s;n++)this.expandByObject(r[n],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,hf),hf.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Nb),GS.subVectors(this.max,Nb),Cg.subVectors(t.a,Nb),Pg.subVectors(t.b,Nb),Tg.subVectors(t.c,Nb),xd.subVectors(Pg,Cg),wd.subVectors(Tg,Pg),cf.subVectors(Cg,Tg);let e=[0,-xd.z,xd.y,0,-wd.z,wd.y,0,-cf.z,cf.y,xd.z,0,-xd.x,wd.z,0,-wd.x,cf.z,0,-cf.x,-xd.y,xd.x,0,-wd.y,wd.x,0,-cf.y,cf.x,0];return!Xk(e,Cg,Pg,Tg,GS)||(e=[1,0,0,0,1,0,0,0,1],!Xk(e,Cg,Pg,Tg,GS))?!1:(VS.crossVectors(xd,wd),e=[VS.x,VS.y,VS.z],Xk(e,Cg,Pg,Tg,GS))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return hf.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(hf).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(ic[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ic[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ic[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ic[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ic[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ic[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ic[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ic[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ic),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},ic=[new N,new N,new N,new N,new N,new N,new N,new N],hf=new N,qk=new Mn,Cg=new N,Pg=new N,Tg=new N,xd=new N,wd=new N,cf=new N,Nb=new N,GS=new N,VS=new N,df=new N;function Xk(t,e,i,r,n){for(let s=0,o=t.length-3;s<=o;s+=3){df.fromArray(t,s);let a=n.x*Math.abs(df.x)+n.y*Math.abs(df.y)+n.z*Math.abs(df.z),l=e.dot(df),u=i.dot(df),c=r.dot(df);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}var Bde=new Mn,Fb=new N,Yk=new N,xa=class{constructor(t=new N,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let i=this.center;e!==void 0?i.copy(e):Bde.setFromPoints(t).getCenter(i);let r=0;for(let n=0,s=t.length;n<s;n++)r=Math.max(r,i.distanceToSquared(t[n]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Fb.subVectors(t,this.center);let e=Fb.lengthSq();if(e>this.radius*this.radius){let i=Math.sqrt(e),r=(i-this.radius)*.5;this.center.addScaledVector(Fb,r/i),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Yk.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Fb.copy(t.center).add(Yk)),this.expandByPoint(Fb.copy(t.center).sub(Yk))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},rc=new N,Kk=new N,jS=new N,_d=new N,Jk=new N,WS=new N,Qk=new N,O0=class{constructor(t=new N,e=new N(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,rc)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=rc.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(rc.copy(this.direction).multiplyScalar(e).add(this.origin),rc.distanceToSquared(t))}distanceSqToSegment(t,e,i,r){Kk.copy(t).add(e).multiplyScalar(.5),jS.copy(e).sub(t).normalize(),_d.copy(this.origin).sub(Kk);let n=t.distanceTo(e)*.5,s=-this.direction.dot(jS),o=_d.dot(this.direction),a=-_d.dot(jS),l=_d.lengthSq(),u=Math.abs(1-s*s),c,h,d,p;if(u>0)if(c=s*a-o,h=s*o-a,p=n*u,c>=0)if(h>=-p)if(h<=p){let f=1/u;c*=f,h*=f,d=c*(c+s*h+2*o)+h*(s*c+h+2*a)+l}else h=n,c=Math.max(0,-(s*h+o)),d=-c*c+h*(h+2*a)+l;else h=-n,c=Math.max(0,-(s*h+o)),d=-c*c+h*(h+2*a)+l;else h<=-p?(c=Math.max(0,-(-s*n+o)),h=c>0?-n:Math.min(Math.max(-n,-a),n),d=-c*c+h*(h+2*a)+l):h<=p?(c=0,h=Math.min(Math.max(-n,-a),n),d=h*(h+2*a)+l):(c=Math.max(0,-(s*n+o)),h=c>0?n:Math.min(Math.max(-n,-a),n),d=-c*c+h*(h+2*a)+l);else h=s>0?-n:n,c=Math.max(0,-(s*h+o)),d=-c*c+h*(h+2*a)+l;return i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),r&&r.copy(jS).multiplyScalar(h).add(Kk),d}intersectSphere(t,e){rc.subVectors(t.center,this.origin);let i=rc.dot(this.direction),r=rc.dot(rc)-i*i,n=t.radius*t.radius;if(r>n)return null;let s=Math.sqrt(n-r),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){let i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,r,n,s,o,a,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(i=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(i=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),u>=0?(n=(t.min.y-h.y)*u,s=(t.max.y-h.y)*u):(n=(t.max.y-h.y)*u,s=(t.min.y-h.y)*u),i>s||n>r||((n>i||isNaN(i))&&(i=n),(s<r||isNaN(r))&&(r=s),c>=0?(o=(t.min.z-h.z)*c,a=(t.max.z-h.z)*c):(o=(t.max.z-h.z)*c,a=(t.min.z-h.z)*c),i>a||o>r)||((o>i||i!==i)&&(i=o),(a<r||r!==r)&&(r=a),r<0)?null:this.at(i>=0?i:r,e)}intersectsBox(t){return this.intersectBox(t,rc)!==null}intersectTriangle(t,e,i,r,n){Jk.subVectors(e,t),WS.subVectors(i,t),Qk.crossVectors(Jk,WS);let s=this.direction.dot(Qk),o;if(s>0){if(r)return null;o=1}else if(s<0)o=-1,s=-s;else return null;_d.subVectors(this.origin,t);let a=o*this.direction.dot(WS.crossVectors(_d,WS));if(a<0)return null;let l=o*this.direction.dot(Jk.cross(_d));if(l<0||a+l>s)return null;let u=-o*_d.dot(Qk);return u<0?null:this.at(u/s,n)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},lt=class{constructor(){lt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g){let y=this.elements;return y[0]=e,y[4]=i,y[8]=r,y[12]=n,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=u,y[6]=c,y[10]=h,y[14]=d,y[3]=p,y[7]=f,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new lt().fromArray(this.elements)}copy(e){let i=this.elements,r=e.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this}copyPosition(e){let i=this.elements,r=e.elements;return i[12]=r[12],i[13]=r[13],i[14]=r[14],this}setFromMatrix3(e){let i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,r){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,i,r){return this.set(e.x,i.x,r.x,0,e.y,i.y,r.y,0,e.z,i.z,r.z,0,0,0,0,1),this}extractRotation(e){let i=this.elements,r=e.elements,n=1/Rg.setFromMatrixColumn(e,0).length(),s=1/Rg.setFromMatrixColumn(e,1).length(),o=1/Rg.setFromMatrixColumn(e,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[3]=0,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=0,i[8]=r[8]*o,i[9]=r[9]*o,i[10]=r[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){let i=this.elements,r=e.x,n=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){let d=o*c,p=o*h,f=a*c,m=a*h;i[0]=l*c,i[4]=-l*h,i[8]=u,i[1]=p+f*u,i[5]=d-m*u,i[9]=-a*l,i[2]=m-d*u,i[6]=f+p*u,i[10]=o*l}else if(e.order==="YXZ"){let d=l*c,p=l*h,f=u*c,m=u*h;i[0]=d+m*a,i[4]=f*a-p,i[8]=o*u,i[1]=o*h,i[5]=o*c,i[9]=-a,i[2]=p*a-f,i[6]=m+d*a,i[10]=o*l}else if(e.order==="ZXY"){let d=l*c,p=l*h,f=u*c,m=u*h;i[0]=d-m*a,i[4]=-o*h,i[8]=f+p*a,i[1]=p+f*a,i[5]=o*c,i[9]=m-d*a,i[2]=-o*u,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){let d=o*c,p=o*h,f=a*c,m=a*h;i[0]=l*c,i[4]=f*u-p,i[8]=d*u+m,i[1]=l*h,i[5]=m*u+d,i[9]=p*u-f,i[2]=-u,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){let d=o*l,p=o*u,f=a*l,m=a*u;i[0]=l*c,i[4]=m-d*h,i[8]=f*h+p,i[1]=h,i[5]=o*c,i[9]=-a*c,i[2]=-u*c,i[6]=p*h+f,i[10]=d-m*h}else if(e.order==="XZY"){let d=o*l,p=o*u,f=a*l,m=a*u;i[0]=l*c,i[4]=-h,i[8]=u*c,i[1]=d*h+m,i[5]=o*c,i[9]=p*h-f,i[2]=f*h-p,i[6]=a*c,i[10]=m*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ode,e,Ude)}lookAt(e,i,r){let n=this.elements;return Pa.subVectors(e,i),Pa.lengthSq()===0&&(Pa.z=1),Pa.normalize(),Sd.crossVectors(r,Pa),Sd.lengthSq()===0&&(Math.abs(r.z)===1?Pa.x+=1e-4:Pa.z+=1e-4,Pa.normalize(),Sd.crossVectors(r,Pa)),Sd.normalize(),qS.crossVectors(Pa,Sd),n[0]=Sd.x,n[4]=qS.x,n[8]=Pa.x,n[1]=Sd.y,n[5]=qS.y,n[9]=Pa.y,n[2]=Sd.z,n[6]=qS.z,n[10]=Pa.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){let r=e.elements,n=i.elements,s=this.elements,o=r[0],a=r[4],l=r[8],u=r[12],c=r[1],h=r[5],d=r[9],p=r[13],f=r[2],m=r[6],g=r[10],y=r[14],v=r[3],b=r[7],_=r[11],A=r[15],S=n[0],E=n[4],M=n[8],R=n[12],C=n[1],T=n[5],L=n[9],I=n[13],D=n[2],F=n[6],H=n[10],z=n[14],B=n[3],j=n[7],V=n[11],q=n[15];return s[0]=o*S+a*C+l*D+u*B,s[4]=o*E+a*T+l*F+u*j,s[8]=o*M+a*L+l*H+u*V,s[12]=o*R+a*I+l*z+u*q,s[1]=c*S+h*C+d*D+p*B,s[5]=c*E+h*T+d*F+p*j,s[9]=c*M+h*L+d*H+p*V,s[13]=c*R+h*I+d*z+p*q,s[2]=f*S+m*C+g*D+y*B,s[6]=f*E+m*T+g*F+y*j,s[10]=f*M+m*L+g*H+y*V,s[14]=f*R+m*I+g*z+y*q,s[3]=v*S+b*C+_*D+A*B,s[7]=v*E+b*T+_*F+A*j,s[11]=v*M+b*L+_*H+A*V,s[15]=v*R+b*I+_*z+A*q,this}multiplyScalar(e){let i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){let e=this.elements,i=e[0],r=e[4],n=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],p=e[14],f=e[3],m=e[7],g=e[11],y=e[15];return f*(+s*l*h-n*u*h-s*a*d+r*u*d+n*a*p-r*l*p)+m*(+i*l*p-i*u*d+s*o*d-n*o*p+n*u*c-s*l*c)+g*(+i*u*h-i*a*p-s*o*h+r*o*p+s*a*c-r*u*c)+y*(-n*a*c-i*l*h+i*a*d+n*o*h-r*o*d+r*l*c)}transpose(){let e=this.elements,i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=i,n[14]=r),this}invert(){let e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=h*g*u-m*d*u+m*l*p-a*g*p-h*l*y+a*d*y,b=f*d*u-c*g*u-f*l*p+o*g*p+c*l*y-o*d*y,_=c*m*u-f*h*u+f*a*p-o*m*p-c*a*y+o*h*y,A=f*h*l-c*m*l-f*a*d+o*m*d+c*a*g-o*h*g,S=i*v+r*b+n*_+s*A;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/S;return e[0]=v*E,e[1]=(m*d*s-h*g*s-m*n*p+r*g*p+h*n*y-r*d*y)*E,e[2]=(a*g*s-m*l*s+m*n*u-r*g*u-a*n*y+r*l*y)*E,e[3]=(h*l*s-a*d*s-h*n*u+r*d*u+a*n*p-r*l*p)*E,e[4]=b*E,e[5]=(c*g*s-f*d*s+f*n*p-i*g*p-c*n*y+i*d*y)*E,e[6]=(f*l*s-o*g*s-f*n*u+i*g*u+o*n*y-i*l*y)*E,e[7]=(o*d*s-c*l*s+c*n*u-i*d*u-o*n*p+i*l*p)*E,e[8]=_*E,e[9]=(f*h*s-c*m*s-f*r*p+i*m*p+c*r*y-i*h*y)*E,e[10]=(o*m*s-f*a*s+f*r*u-i*m*u-o*r*y+i*a*y)*E,e[11]=(c*a*s-o*h*s-c*r*u+i*h*u+o*r*p-i*a*p)*E,e[12]=A*E,e[13]=(c*m*n-f*h*n+f*r*d-i*m*d-c*r*g+i*h*g)*E,e[14]=(f*a*n-o*m*n-f*r*l+i*m*l+o*r*g-i*a*g)*E,e[15]=(o*h*n-c*a*n+c*r*l-i*h*l-o*r*d+i*a*d)*E,this}scale(e){let i=this.elements,r=e.x,n=e.y,s=e.z;return i[0]*=r,i[4]*=n,i[8]*=s,i[1]*=r,i[5]*=n,i[9]*=s,i[2]*=r,i[6]*=n,i[10]*=s,i[3]*=r,i[7]*=n,i[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,r,n))}makeTranslation(e,i,r){return this.set(1,0,0,e,0,1,0,i,0,0,1,r,0,0,0,1),this}makeRotationX(e){let i=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,i,-r,0,0,r,i,0,0,0,0,1),this}makeRotationY(e){let i=Math.cos(e),r=Math.sin(e);return this.set(i,0,r,0,0,1,0,0,-r,0,i,0,0,0,0,1),this}makeRotationZ(e){let i=Math.cos(e),r=Math.sin(e);return this.set(i,-r,0,0,r,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){let r=Math.cos(i),n=Math.sin(i),s=1-r,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+r,u*a-n*l,u*l+n*a,0,u*a+n*l,c*a+r,c*l-n*o,0,u*l-n*a,c*l+n*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,i,r){return this.set(e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,i,r,n,s,o){return this.set(1,r,s,0,e,1,o,0,i,n,1,0,0,0,0,1),this}compose(e,i,r){let n=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,u=s+s,c=o+o,h=a+a,d=s*u,p=s*c,f=s*h,m=o*c,g=o*h,y=a*h,v=l*u,b=l*c,_=l*h,A=r.x,S=r.y,E=r.z;return n[0]=(1-(m+y))*A,n[1]=(p+_)*A,n[2]=(f-b)*A,n[3]=0,n[4]=(p-_)*S,n[5]=(1-(d+y))*S,n[6]=(g+v)*S,n[7]=0,n[8]=(f+b)*E,n[9]=(g-v)*E,n[10]=(1-(d+m))*E,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,i,r){let n=this.elements,s=Rg.set(n[0],n[1],n[2]).length(),o=Rg.set(n[4],n[5],n[6]).length(),a=Rg.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],Kl.copy(this);let l=1/s,u=1/o,c=1/a;return Kl.elements[0]*=l,Kl.elements[1]*=l,Kl.elements[2]*=l,Kl.elements[4]*=u,Kl.elements[5]*=u,Kl.elements[6]*=u,Kl.elements[8]*=c,Kl.elements[9]*=c,Kl.elements[10]*=c,i.setFromRotationMatrix(Kl),r.x=s,r.y=o,r.z=a,this}makePerspective(e,i,r,n,s,o){let a=this.elements,l=2*s/(i-e),u=2*s/(r-n),c=(i+e)/(i-e),h=(r+n)/(r-n),d=-(o+s)/(o-s),p=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,i,r,n,s,o){let a=this.elements,l=1/(i-e),u=1/(r-n),c=1/(o-s),h=(i+e)*l,d=(r+n)*u,p=(o+s)*c;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let i=this.elements,r=e.elements;for(let n=0;n<16;n++)if(i[n]!==r[n])return!1;return!0}fromArray(e,i=0){for(let r=0;r<16;r++)this.elements[r]=e[r+i];return this}toArray(e=[],i=0){let r=this.elements;return e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7],e[i+8]=r[8],e[i+9]=r[9],e[i+10]=r[10],e[i+11]=r[11],e[i+12]=r[12],e[i+13]=r[13],e[i+14]=r[14],e[i+15]=r[15],e}},Rg=new N,Kl=new lt,Ode=new N(0,0,0),Ude=new N(1,1,1),Sd=new N,qS=new N,Pa=new N,cj=new lt,dj=new ni,ts=class{constructor(t=0,e=0,i=0,r=ts.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,r=this._order){return this._x=t,this._y=e,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){let r=t.elements,n=r[0],s=r[4],o=r[8],a=r[1],l=r[5],u=r[9],c=r[2],h=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(Bn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Bn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-c,n),this._z=0);break;case"ZXY":this._x=Math.asin(Bn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,n));break;case"ZYX":this._y=Math.asin(-Bn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Bn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Bn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return cj.makeRotationFromQuaternion(t),this.setFromRotationMatrix(cj,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return dj.setFromEuler(this),this.setFromQuaternion(dj,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};ts.DEFAULT_ORDER="XYZ";var SF=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},Nde=0,pj=new N,kg=new ni,nc=new lt,XS=new N,zb=new N,Fde=new N,zde=new ni,fj=new N(1,0,0),mj=new N(0,1,0),gj=new N(0,0,1),Hde={type:"added"},yj={type:"removed"},ir=class extends Ys{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Nde++}),this.uuid=Bl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ir.DEFAULT_UP.clone();let e=new N,i=new ts,r=new ni,n=new N(1,1,1);function s(){r.setFromEuler(i,!1)}function o(){i.setFromQuaternion(r,void 0,!1)}i._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new lt},normalMatrix:{value:new wn}}),this.matrix=new lt,this.matrixWorld=new lt,this.matrixAutoUpdate=ir.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ir.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new SF,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return kg.setFromAxisAngle(e,i),this.quaternion.multiply(kg),this}rotateOnWorldAxis(e,i){return kg.setFromAxisAngle(e,i),this.quaternion.premultiply(kg),this}rotateX(e){return this.rotateOnAxis(fj,e)}rotateY(e){return this.rotateOnAxis(mj,e)}rotateZ(e){return this.rotateOnAxis(gj,e)}translateOnAxis(e,i){return pj.copy(e).applyQuaternion(this.quaternion),this.position.add(pj.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(fj,e)}translateY(e){return this.translateOnAxis(mj,e)}translateZ(e){return this.translateOnAxis(gj,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(nc.copy(this.matrixWorld).invert())}lookAt(e,i,r){e.isVector3?XS.copy(e):XS.set(e,i,r);let n=this.parent;this.updateWorldMatrix(!0,!1),zb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?nc.lookAt(zb,XS,this.up):nc.lookAt(XS,zb,this.up),this.quaternion.setFromRotationMatrix(nc),n&&(nc.extractRotation(n.matrixWorld),kg.setFromRotationMatrix(nc),this.quaternion.premultiply(kg.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Hde)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(yj)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let i=this.children[e];i.parent=null,i.dispatchEvent(yj)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),nc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),nc.multiply(e.parent.matrixWorld)),e.applyMatrix4(nc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let r=0,n=this.children.length;r<n;r++){let s=this.children[r].getObjectByProperty(e,i);if(s!==void 0)return s}}getObjectsByProperty(e,i){let r=[];this[e]===i&&r.push(this);for(let n=0,s=this.children.length;n<s;n++){let o=this.children[n].getObjectsByProperty(e,i);o.length>0&&(r=r.concat(o))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zb,e,Fde),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zb,zde,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);let i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverseVisible(e)}traverseAncestors(e){let i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let i=this.children;for(let r=0,n=i.length;r<n;r++){let s=i[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,i){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){let n=this.children;for(let s=0,o=n.length;s<o;s++){let a=n[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let i=e===void 0||typeof e=="string",r={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){let h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));n.material=a}else n.material=s(e.materials,this.material);if(this.children.length>0){n.children=[];for(let a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let a=0;a<this.animations.length;a++){let l=this.animations[a];n.animations.push(s(e.animations,l))}}if(i){let a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),p=o(e.animations),f=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),h.length>0&&(r.shapes=h),d.length>0&&(r.skeletons=d),p.length>0&&(r.animations=p),f.length>0&&(r.nodes=f)}return r.object=n,r;function o(a){let l=[];for(let u in a){let c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};ir.DEFAULT_UP=new N(0,1,0);ir.DEFAULT_MATRIX_AUTO_UPDATE=!0;ir.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Jl=new N,sc=new N,Zk=new N,oc=new N,Dg=new N,Ig=new N,vj=new N,$k=new N,eD=new N,tD=new N,Fs=class{constructor(e=new N,i=new N,r=new N){this.a=e,this.b=i,this.c=r}static getNormal(e,i,r,n){n.subVectors(r,i),Jl.subVectors(e,i),n.cross(Jl);let s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(e,i,r,n,s){Jl.subVectors(n,i),sc.subVectors(r,i),Zk.subVectors(e,i);let o=Jl.dot(Jl),a=Jl.dot(sc),l=Jl.dot(Zk),u=sc.dot(sc),c=sc.dot(Zk),h=o*u-a*a;if(h===0)return s.set(-2,-1,-1);let d=1/h,p=(u*l-a*c)*d,f=(o*c-a*l)*d;return s.set(1-p-f,f,p)}static containsPoint(e,i,r,n){return this.getBarycoord(e,i,r,n,oc),oc.x>=0&&oc.y>=0&&oc.x+oc.y<=1}static getUV(e,i,r,n,s,o,a,l){return this.getBarycoord(e,i,r,n,oc),l.set(0,0),l.addScaledVector(s,oc.x),l.addScaledVector(o,oc.y),l.addScaledVector(a,oc.z),l}static isFrontFacing(e,i,r,n){return Jl.subVectors(r,i),sc.subVectors(e,i),Jl.cross(sc).dot(n)<0}set(e,i,r){return this.a.copy(e),this.b.copy(i),this.c.copy(r),this}setFromPointsAndIndices(e,i,r,n){return this.a.copy(e[i]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,i,r,n){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jl.subVectors(this.c,this.b),sc.subVectors(this.a,this.b),Jl.cross(sc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return Fs.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,r,n,s){return Fs.getUV(e,this.a,this.b,this.c,i,r,n,s)}containsPoint(e){return Fs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){let r=this.a,n=this.b,s=this.c,o,a;Dg.subVectors(n,r),Ig.subVectors(s,r),$k.subVectors(e,r);let l=Dg.dot($k),u=Ig.dot($k);if(l<=0&&u<=0)return i.copy(r);eD.subVectors(e,n);let c=Dg.dot(eD),h=Ig.dot(eD);if(c>=0&&h<=c)return i.copy(n);let d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),i.copy(r).addScaledVector(Dg,o);tD.subVectors(e,s);let p=Dg.dot(tD),f=Ig.dot(tD);if(f>=0&&p<=f)return i.copy(s);let m=p*u-l*f;if(m<=0&&u>=0&&f<=0)return a=u/(u-f),i.copy(r).addScaledVector(Ig,a);let g=c*f-p*h;if(g<=0&&h-c>=0&&p-f>=0)return vj.subVectors(s,n),a=(h-c)/(h-c+(p-f)),i.copy(n).addScaledVector(vj,a);let y=1/(g+m+d);return o=m*y,a=d*y,i.copy(r).addScaledVector(Dg,o).addScaledVector(Ig,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Gde=0,Y1=class extends Ys{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Gde++}),this.uuid=Bl(),this.name="",this.type="Material",this.blending=cm,this.side=Eu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=dQ,this.blendDst=pQ,this.blendEquation=Uy,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=VL,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=gde,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zk,this.stencilZFail=zk,this.stencilZPass=zk,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let i=t[e];if(i===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}let r=this[e];if(r===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[e]=i}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==cm&&(i.blending=this.blending),this.side!==Eu&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(n){let s=[];for(let o in n){let a=n[o];delete a.metadata,s.push(a)}return s}if(e){let n=r(t.textures),s=r(t.images);n.length>0&&(i.textures=n),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,i=null;if(e!==null){let r=e.length;i=new Array(r);for(let n=0;n!==r;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},Km=class extends Y1{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=fQ,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},kn=new N,YS=new me,ei=class{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=i,this.usage=XL,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let r=0,n=this.itemSize;r<n;r++)this.array[t+r]=e.array[i+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)YS.fromBufferAttribute(this,e),YS.applyMatrix3(t),this.setXY(e,YS.x,YS.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)kn.fromBufferAttribute(this,e),kn.applyMatrix3(t),this.setXYZ(e,kn.x,kn.y,kn.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)kn.fromBufferAttribute(this,e),kn.applyMatrix4(t),this.setXYZ(e,kn.x,kn.y,kn.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)kn.fromBufferAttribute(this,e),kn.applyNormalMatrix(t),this.setXYZ(e,kn.x,kn.y,kn.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)kn.fromBufferAttribute(this,e),kn.transformDirection(t),this.setXYZ(e,kn.x,kn.y,kn.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Nc(e,this.array)),e}setX(t,e){return this.normalized&&(e=br(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Nc(e,this.array)),e}setY(t,e){return this.normalized&&(e=br(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Nc(e,this.array)),e}setZ(t,e){return this.normalized&&(e=br(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Nc(e,this.array)),e}setW(t,e){return this.normalized&&(e=br(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=br(e,this.array),i=br(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,r){return t*=this.itemSize,this.normalized&&(e=br(e,this.array),i=br(i,this.array),r=br(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this}setXYZW(t,e,i,r,n){return t*=this.itemSize,this.normalized&&(e=br(e,this.array),i=br(i,this.array),r=br(r,this.array),n=br(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=n,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==XL&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},CQ=class extends ei{constructor(t,e,i){super(new Uint16Array(t),e,i)}},Sv=class extends ei{constructor(t,e,i){super(new Uint32Array(t),e,i)}},_t=class extends ei{constructor(t,e,i){super(new Float32Array(t),e,i)}},Vde=0,ul=new lt,iD=new ir,Lg=new N,Ta=new Mn,Hb=new Mn,ds=new N,Ht=class extends Ys{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Vde++}),this.uuid=Bl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(_Q(t)?Sv:CQ)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let n=new wn().getNormalMatrix(t);i.applyNormalMatrix(n),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return ul.makeRotationFromQuaternion(t),this.applyMatrix4(ul),this}rotateX(t){return ul.makeRotationX(t),this.applyMatrix4(ul),this}rotateY(t){return ul.makeRotationY(t),this.applyMatrix4(ul),this}rotateZ(t){return ul.makeRotationZ(t),this.applyMatrix4(ul),this}translate(t,e,i){return ul.makeTranslation(t,e,i),this.applyMatrix4(ul),this}scale(t,e,i){return ul.makeScale(t,e,i),this.applyMatrix4(ul),this}lookAt(t){return iD.lookAt(t),iD.updateMatrix(),this.applyMatrix4(iD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Lg).negate(),this.translate(Lg.x,Lg.y,Lg.z),this}setFromPoints(t){let e=[];for(let i=0,r=t.length;i<r;i++){let n=t[i];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new _t(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Mn);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let i=0,r=e.length;i<r;i++){let n=e[i];Ta.setFromBufferAttribute(n),this.morphTargetsRelative?(ds.addVectors(this.boundingBox.min,Ta.min),this.boundingBox.expandByPoint(ds),ds.addVectors(this.boundingBox.max,Ta.max),this.boundingBox.expandByPoint(ds)):(this.boundingBox.expandByPoint(Ta.min),this.boundingBox.expandByPoint(Ta.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xa);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new N,1/0);return}if(t){let i=this.boundingSphere.center;if(Ta.setFromBufferAttribute(t),e)for(let n=0,s=e.length;n<s;n++){let o=e[n];Hb.setFromBufferAttribute(o),this.morphTargetsRelative?(ds.addVectors(Ta.min,Hb.min),Ta.expandByPoint(ds),ds.addVectors(Ta.max,Hb.max),Ta.expandByPoint(ds)):(Ta.expandByPoint(Hb.min),Ta.expandByPoint(Hb.max))}Ta.getCenter(i);let r=0;for(let n=0,s=t.count;n<s;n++)ds.fromBufferAttribute(t,n),r=Math.max(r,i.distanceToSquared(ds));if(e)for(let n=0,s=e.length;n<s;n++){let o=e[n],a=this.morphTargetsRelative;for(let l=0,u=o.count;l<u;l++)ds.fromBufferAttribute(o,l),a&&(Lg.fromBufferAttribute(t,l),ds.add(Lg)),r=Math.max(r,i.distanceToSquared(ds))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.array,r=e.position.array,n=e.normal.array,s=e.uv.array,o=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ei(new Float32Array(4*o),4));let a=this.getAttribute("tangent").array,l=[],u=[];for(let R=0;R<o;R++)l[R]=new N,u[R]=new N;let c=new N,h=new N,d=new N,p=new me,f=new me,m=new me,g=new N,y=new N;function v(R,C,T){c.fromArray(r,R*3),h.fromArray(r,C*3),d.fromArray(r,T*3),p.fromArray(s,R*2),f.fromArray(s,C*2),m.fromArray(s,T*2),h.sub(c),d.sub(c),f.sub(p),m.sub(p);let L=1/(f.x*m.y-m.x*f.y);!isFinite(L)||(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(L),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(L),l[R].add(g),l[C].add(g),l[T].add(g),u[R].add(y),u[C].add(y),u[T].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let R=0,C=b.length;R<C;++R){let T=b[R],L=T.start,I=T.count;for(let D=L,F=L+I;D<F;D+=3)v(i[D+0],i[D+1],i[D+2])}let _=new N,A=new N,S=new N,E=new N;function M(R){S.fromArray(n,R*3),E.copy(S);let C=l[R];_.copy(C),_.sub(S.multiplyScalar(S.dot(C))).normalize(),A.crossVectors(E,C);let T=A.dot(u[R])<0?-1:1;a[R*4]=_.x,a[R*4+1]=_.y,a[R*4+2]=_.z,a[R*4+3]=T}for(let R=0,C=b.length;R<C;++R){let T=b[R],L=T.start,I=T.count;for(let D=L,F=L+I;D<F;D+=3)M(i[D+0]),M(i[D+1]),M(i[D+2])}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(e!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ei(new Float32Array(e.count*3),3),this.setAttribute("normal",i);else for(let h=0,d=i.count;h<d;h++)i.setXYZ(h,0,0,0);let r=new N,n=new N,s=new N,o=new N,a=new N,l=new N,u=new N,c=new N;if(t)for(let h=0,d=t.count;h<d;h+=3){let p=t.getX(h+0),f=t.getX(h+1),m=t.getX(h+2);r.fromBufferAttribute(e,p),n.fromBufferAttribute(e,f),s.fromBufferAttribute(e,m),u.subVectors(s,n),c.subVectors(r,n),u.cross(c),o.fromBufferAttribute(i,p),a.fromBufferAttribute(i,f),l.fromBufferAttribute(i,m),o.add(u),a.add(u),l.add(u),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(f,a.x,a.y,a.z),i.setXYZ(m,l.x,l.y,l.z)}else for(let h=0,d=e.count;h<d;h+=3)r.fromBufferAttribute(e,h+0),n.fromBufferAttribute(e,h+1),s.fromBufferAttribute(e,h+2),u.subVectors(s,n),c.subVectors(r,n),u.cross(c),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)ds.fromBufferAttribute(t,e),ds.normalize(),t.setXYZ(e,ds.x,ds.y,ds.z)}toNonIndexed(){function t(o,a){let l=o.array,u=o.itemSize,c=o.normalized,h=new l.constructor(a.length*u),d=0,p=0;for(let f=0,m=a.length;f<m;f++){o.isInterleavedBufferAttribute?d=a[f]*o.data.stride+o.offset:d=a[f]*u;for(let g=0;g<u;g++)h[p++]=l[d++]}return new ei(h,u,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new Ht,i=this.index.array,r=this.attributes;for(let o in r){let a=r[o],l=t(a,i);e.setAttribute(o,l)}let n=this.morphAttributes;for(let o in n){let a=[],l=n[o];for(let u=0,c=l.length;u<c;u++){let h=l[u],d=t(h,i);a.push(d)}e.morphAttributes[o]=a}e.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let o=0,a=s.length;o<a;o++){let l=s[o];e.addGroup(l.start,l.count,l.materialIndex)}return e}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let a=this.parameters;for(let l in a)a[l]!==void 0&&(t[l]=a[l]);return t}t.data={attributes:{}};let e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let i=this.attributes;for(let a in i){let l=i[a];t.data.attributes[a]=l.toJSON(t.data)}let r={},n=!1;for(let a in this.morphAttributes){let l=this.morphAttributes[a],u=[];for(let c=0,h=l.length;c<h;c++){let d=l[c];u.push(d.toJSON(t.data))}u.length>0&&(r[a]=u,n=!0)}n&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));let o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone(e));let r=t.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(e))}let n=t.morphAttributes;for(let l in n){let u=[],c=n[l];for(let h=0,d=c.length;h<d;h++)u.push(c[h].clone(e));this.morphAttributes[l]=u}this.morphTargetsRelative=t.morphTargetsRelative;let s=t.groups;for(let l=0,u=s.length;l<u;l++){let c=s[l];this.addGroup(c.start,c.count,c.materialIndex)}let o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());let a=t.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},bj=new lt,Bg=new O0,rD=new xa,Gb=new N,Vb=new N,jb=new N,nD=new N,KS=new N,JS=new me,QS=new me,ZS=new me,sD=new N,$S=new N,zn=class extends ir{constructor(t=new Ht,e=new Km){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=i.length;r<n;r++){let s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}getVertexPosition(t,e){let i=this.geometry,r=i.attributes.position,n=i.morphAttributes.position,s=i.morphTargetsRelative;e.fromBufferAttribute(r,t);let o=this.morphTargetInfluences;if(n&&o){KS.set(0,0,0);for(let a=0,l=n.length;a<l;a++){let u=o[a],c=n[a];u!==0&&(nD.fromBufferAttribute(c,t),s?KS.addScaledVector(nD,u):KS.addScaledVector(nD.sub(e),u))}e.add(KS)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){let i=this.geometry,r=this.material,n=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),rD.copy(i.boundingSphere),rD.applyMatrix4(n),t.ray.intersectsSphere(rD)===!1)||(bj.copy(n).invert(),Bg.copy(t.ray).applyMatrix4(bj),i.boundingBox!==null&&Bg.intersectsBox(i.boundingBox)===!1))return;let s,o=i.index,a=i.attributes.position,l=i.attributes.uv,u=i.attributes.uv2,c=i.groups,h=i.drawRange;if(o!==null)if(Array.isArray(r))for(let d=0,p=c.length;d<p;d++){let f=c[d],m=r[f.materialIndex],g=Math.max(f.start,h.start),y=Math.min(o.count,Math.min(f.start+f.count,h.start+h.count));for(let v=g,b=y;v<b;v+=3){let _=o.getX(v),A=o.getX(v+1),S=o.getX(v+2);s=eA(this,m,t,Bg,l,u,_,A,S),s&&(s.faceIndex=Math.floor(v/3),s.face.materialIndex=f.materialIndex,e.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=o.getX(f),y=o.getX(f+1),v=o.getX(f+2);s=eA(this,r,t,Bg,l,u,g,y,v),s&&(s.faceIndex=Math.floor(f/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(r))for(let d=0,p=c.length;d<p;d++){let f=c[d],m=r[f.materialIndex],g=Math.max(f.start,h.start),y=Math.min(a.count,Math.min(f.start+f.count,h.start+h.count));for(let v=g,b=y;v<b;v+=3){let _=v,A=v+1,S=v+2;s=eA(this,m,t,Bg,l,u,_,A,S),s&&(s.faceIndex=Math.floor(v/3),s.face.materialIndex=f.materialIndex,e.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(a.count,h.start+h.count);for(let f=d,m=p;f<m;f+=3){let g=f,y=f+1,v=f+2;s=eA(this,r,t,Bg,l,u,g,y,v),s&&(s.faceIndex=Math.floor(f/3),e.push(s))}}}};function jde(t,e,i,r,n,s,o,a){let l;if(e.side===As?l=r.intersectTriangle(o,s,n,!0,a):l=r.intersectTriangle(n,s,o,e.side===Eu,a),l===null)return null;$S.copy(a),$S.applyMatrix4(t.matrixWorld);let u=i.ray.origin.distanceTo($S);return u<i.near||u>i.far?null:{distance:u,point:$S.clone(),object:t}}function eA(t,e,i,r,n,s,o,a,l){t.getVertexPosition(o,Gb),t.getVertexPosition(a,Vb),t.getVertexPosition(l,jb);let u=jde(t,e,i,r,Gb,Vb,jb,sD);if(u){n&&(JS.fromBufferAttribute(n,o),QS.fromBufferAttribute(n,a),ZS.fromBufferAttribute(n,l),u.uv=Fs.getUV(sD,Gb,Vb,jb,JS,QS,ZS,new me)),s&&(JS.fromBufferAttribute(s,o),QS.fromBufferAttribute(s,a),ZS.fromBufferAttribute(s,l),u.uv2=Fs.getUV(sD,Gb,Vb,jb,JS,QS,ZS,new me));let c={a:o,b:a,c:l,normal:new N,materialIndex:0};Fs.getNormal(Gb,Vb,jb,c.normal),u.face=c}return u}var Cu=class extends Ht{constructor(t=1,e=1,i=1,r=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:n,depthSegments:s};let o=this;r=Math.floor(r),n=Math.floor(n),s=Math.floor(s);let a=[],l=[],u=[],c=[],h=0,d=0;p("z","y","x",-1,-1,i,e,t,s,n,0),p("z","y","x",1,-1,i,e,-t,s,n,1),p("x","z","y",1,1,t,i,e,r,s,2),p("x","z","y",1,-1,t,i,-e,r,s,3),p("x","y","z",1,-1,t,e,i,r,n,4),p("x","y","z",-1,-1,t,e,-i,r,n,5),this.setIndex(a),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(u,3)),this.setAttribute("uv",new _t(c,2));function p(f,m,g,y,v,b,_,A,S,E,M){let R=b/S,C=_/E,T=b/2,L=_/2,I=A/2,D=S+1,F=E+1,H=0,z=0,B=new N;for(let j=0;j<F;j++){let V=j*C-L;for(let q=0;q<D;q++){let K=q*R-T;B[f]=K*y,B[m]=V*v,B[g]=I,l.push(B.x,B.y,B.z),B[f]=0,B[m]=0,B[g]=A>0?1:-1,u.push(B.x,B.y,B.z),c.push(q/S),c.push(1-j/E),H+=1}}for(let j=0;j<E;j++)for(let V=0;V<S;V++){let q=h+V+D*j,K=h+V+D*(j+1),le=h+(V+1)+D*(j+1),Z=h+(V+1)+D*j;a.push(q,K,Z),a.push(K,le,Z),z+=6}o.addGroup(d,z,M),d+=z,h+=H}}static fromJSON(t){return new Cu(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function e0(t){let e={};for(let i in t){e[i]={};for(let r in t[i]){let n=t[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[i][r]=n.clone():Array.isArray(n)?e[i][r]=n.slice():e[i][r]=n}}return e}function Ro(t){let e={};for(let i=0;i<t.length;i++){let r=e0(t[i]);for(let n in r)e[n]=r[n]}return e}function Wde(t){let e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function PQ(t){return t.getRenderTarget()===null&&t.outputEncoding===pi?lh:jC}var U0={clone:e0,merge:Ro},qde=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Xde=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,er=class extends Y1{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=qde,this.fragmentShader=Xde,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=e0(t.uniforms),this.uniformsGroups=Wde(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let r in this.uniforms){let n=this.uniforms[r].value;n&&n.isTexture?e.uniforms[r]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[r]={type:"m4",value:n.toArray()}:e.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}},Jm=class extends ir{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new lt,this.projectionMatrix=new lt,this.projectionMatrixInverse=new lt}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},uo=class extends Jm{constructor(t=50,e=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=jw*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(sw*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return jw*2*Math.atan(Math.tan(sw*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,i,r,n,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(sw*.5*this.fov)/this.zoom,i=2*e,r=this.aspect*i,n=-.5*r,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;n+=s.offsetX*r/a,e-=s.offsetY*i/l,r*=s.width/a,i*=s.height/l}let o=this.filmOffset;o!==0&&(n+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,e,e-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},Og=-90,Ug=1,Yde=class extends ir{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i;let r=new uo(Og,Ug,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);let n=new uo(Og,Ug,t,e);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new uo(Og,Ug,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new uo(Og,Ug,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new uo(Og,Ug,t,e);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new uo(Og,Ug,t,e);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(t,e){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[r,n,s,o,a,l]=this.children,u=t.getRenderTarget(),c=t.toneMapping,h=t.xr.enabled;t.toneMapping=Mh,t.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,r),t.setRenderTarget(i,1),t.render(e,n),t.setRenderTarget(i,2),t.render(e,s),t.setRenderTarget(i,3),t.render(e,o),t.setRenderTarget(i,4),t.render(e,a),i.texture.generateMipmaps=d,t.setRenderTarget(i,5),t.render(e,l),t.setRenderTarget(u),t.toneMapping=c,t.xr.enabled=h,i.texture.needsPMREMUpdate=!0}},AF=class extends Wr{constructor(t,e,i,r,n,s,o,a,l,u){t=t!==void 0?t:[],e=e!==void 0?e:km,super(t,e,i,r,n,s,o,a,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},Kde=class extends $i{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let i={width:t,height:t,depth:1},r=[i,i,i,i,i,i];this.texture=new AF(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:mi}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Cu(5,5,5),n=new er({name:"CubemapFromEquirect",uniforms:e0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:As,blending:Gn});n.uniforms.tEquirect.value=e;let s=new zn(r,n),o=e.minFilter;return e.minFilter===$v&&(e.minFilter=mi),new Yde(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,i,r){let n=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,i,r);t.setRenderTarget(n)}},oD=new N,Jde=new N,Qde=new wn,Ba=class{constructor(t=new N(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){let r=oD.subVectors(i,e).cross(Jde.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let i=t.delta(oD),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let n=-(t.start.dot(this.normal)+this.constant)/r;return n<0||n>1?null:e.copy(i).multiplyScalar(n).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let i=e||Qde.getNormalMatrix(t),r=this.coplanarPoint(oD).applyMatrix4(t),n=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(n),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ng=new xa,tA=new N,EF=class{constructor(t=new Ba,e=new Ba,i=new Ba,r=new Ba,n=new Ba,s=new Ba){this.planes=[t,e,i,r,n,s]}set(t,e,i,r,n,s){let o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(r),o[4].copy(n),o[5].copy(s),this}copy(t){let e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){let e=this.planes,i=t.elements,r=i[0],n=i[1],s=i[2],o=i[3],a=i[4],l=i[5],u=i[6],c=i[7],h=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],y=i[14],v=i[15];return e[0].setComponents(o-r,c-a,f-h,v-m).normalize(),e[1].setComponents(o+r,c+a,f+h,v+m).normalize(),e[2].setComponents(o+n,c+l,f+d,v+g).normalize(),e[3].setComponents(o-n,c-l,f-d,v-g).normalize(),e[4].setComponents(o-s,c-u,f-p,v-y).normalize(),e[5].setComponents(o+s,c+u,f+p,v+y).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),Ng.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ng)}intersectsSprite(t){return Ng.center.set(0,0,0),Ng.radius=.7071067811865476,Ng.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ng)}intersectsSphere(t){let e=this.planes,i=t.center,r=-t.radius;for(let n=0;n<6;n++)if(e[n].distanceToPoint(i)<r)return!1;return!0}intersectsBox(t){let e=this.planes;for(let i=0;i<6;i++){let r=e[i];if(tA.x=r.normal.x>0?t.max.x:t.min.x,tA.y=r.normal.y>0?t.max.y:t.min.y,tA.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(tA)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function TQ(){let t=null,e=!1,i=null,r=null;function n(s,o){i(s,o),r=t.requestAnimationFrame(n)}return{start:function(){e!==!0&&i!==null&&(r=t.requestAnimationFrame(n),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function Zde(t,e){let i=e.isWebGL2,r=new WeakMap;function n(u,c){let h=u.array,d=u.usage,p=t.createBuffer();t.bindBuffer(c,p),t.bufferData(c,h,d),u.onUploadCallback();let f;if(h instanceof Float32Array)f=5126;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(i)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(h instanceof Int16Array)f=5122;else if(h instanceof Uint32Array)f=5125;else if(h instanceof Int32Array)f=5124;else if(h instanceof Int8Array)f=5120;else if(h instanceof Uint8Array)f=5121;else if(h instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version}}function s(u,c,h){let d=c.array,p=c.updateRange;t.bindBuffer(h,u),p.count===-1?t.bufferSubData(h,0,d):(i?t.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):t.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),c.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);let c=r.get(u);c&&(t.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){let d=r.get(u);(!d||d.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);let h=r.get(u);h===void 0?r.set(u,n(u,c)):h.version<u.version&&(s(h.buffer,u,c),h.version=u.version)}return{get:o,remove:a,update:l}}var Qm=class extends Ht{constructor(t=1,e=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r};let n=t/2,s=e/2,o=Math.floor(i),a=Math.floor(r),l=o+1,u=a+1,c=t/o,h=e/a,d=[],p=[],f=[],m=[];for(let g=0;g<u;g++){let y=g*h-s;for(let v=0;v<l;v++){let b=v*c-n;p.push(b,-y,0),f.push(0,0,1),m.push(v/o),m.push(1-g/a)}}for(let g=0;g<a;g++)for(let y=0;y<o;y++){let v=y+l*g,b=y+l*(g+1),_=y+1+l*(g+1),A=y+1+l*g;d.push(v,b,A),d.push(b,_,A)}this.setIndex(d),this.setAttribute("position",new _t(p,3)),this.setAttribute("normal",new _t(f,3)),this.setAttribute("uv",new _t(m,2))}static fromJSON(t){return new Qm(t.width,t.height,t.widthSegments,t.heightSegments)}},$de=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,epe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tpe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,ipe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,rpe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,npe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,spe="vec3 transformed = vec3( position );",ope=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ape=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,lpe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,upe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hpe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,cpe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,dpe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ppe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,fpe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,mpe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,gpe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ype=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,vpe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,bpe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,xpe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,wpe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,_pe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Spe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ape=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Epe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Mpe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Cpe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Ppe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Tpe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Rpe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,kpe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Dpe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Ipe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Lpe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Bpe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ope=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Upe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Npe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Fpe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,zpe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Hpe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Gpe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Vpe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,jpe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Wpe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,qpe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Xpe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Ype=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Kpe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Jpe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Qpe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Zpe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,$pe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,efe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,tfe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,ife=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,rfe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,nfe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,sfe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ofe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,afe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,lfe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ufe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,hfe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,cfe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,dfe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,pfe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ffe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,mfe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,gfe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,yfe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,vfe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,bfe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,xfe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,wfe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,_fe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Sfe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Afe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Efe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Mfe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Cfe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Pfe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Tfe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Rfe=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,kfe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Dfe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Ife=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Lfe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Bfe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,Ofe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ufe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Nfe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Ffe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,zfe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Hfe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Gfe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,Vfe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,jfe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Wfe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,qfe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Xfe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Yfe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Kfe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Jfe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Qfe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Zfe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,$fe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,eme=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,tme=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ime=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,rme=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,nme=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,sme=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ome=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ame=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,lme=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ume=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hme=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cme=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,dme=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pme=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fme=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mme=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,gme=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yme=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,vme=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,bme=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xme=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wme=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,_me=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Sme=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ame=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Eme=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Mme=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Cme=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Pme=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Tme=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Rme=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,fi={alphamap_fragment:$de,alphamap_pars_fragment:epe,alphatest_fragment:tpe,alphatest_pars_fragment:ipe,aomap_fragment:rpe,aomap_pars_fragment:npe,begin_vertex:spe,beginnormal_vertex:ope,bsdfs:ape,iridescence_fragment:lpe,bumpmap_pars_fragment:upe,clipping_planes_fragment:hpe,clipping_planes_pars_fragment:cpe,clipping_planes_pars_vertex:dpe,clipping_planes_vertex:ppe,color_fragment:fpe,color_pars_fragment:mpe,color_pars_vertex:gpe,color_vertex:ype,common:vpe,cube_uv_reflection_fragment:bpe,defaultnormal_vertex:xpe,displacementmap_pars_vertex:wpe,displacementmap_vertex:_pe,emissivemap_fragment:Spe,emissivemap_pars_fragment:Ape,encodings_fragment:Epe,encodings_pars_fragment:Mpe,envmap_fragment:Cpe,envmap_common_pars_fragment:Ppe,envmap_pars_fragment:Tpe,envmap_pars_vertex:Rpe,envmap_physical_pars_fragment:Gpe,envmap_vertex:kpe,fog_vertex:Dpe,fog_pars_vertex:Ipe,fog_fragment:Lpe,fog_pars_fragment:Bpe,gradientmap_pars_fragment:Ope,lightmap_fragment:Upe,lightmap_pars_fragment:Npe,lights_lambert_fragment:Fpe,lights_lambert_pars_fragment:zpe,lights_pars_begin:Hpe,lights_toon_fragment:Vpe,lights_toon_pars_fragment:jpe,lights_phong_fragment:Wpe,lights_phong_pars_fragment:qpe,lights_physical_fragment:Xpe,lights_physical_pars_fragment:Ype,lights_fragment_begin:Kpe,lights_fragment_maps:Jpe,lights_fragment_end:Qpe,logdepthbuf_fragment:Zpe,logdepthbuf_pars_fragment:$pe,logdepthbuf_pars_vertex:efe,logdepthbuf_vertex:tfe,map_fragment:ife,map_pars_fragment:rfe,map_particle_fragment:nfe,map_particle_pars_fragment:sfe,metalnessmap_fragment:ofe,metalnessmap_pars_fragment:afe,morphcolor_vertex:lfe,morphnormal_vertex:ufe,morphtarget_pars_vertex:hfe,morphtarget_vertex:cfe,normal_fragment_begin:dfe,normal_fragment_maps:pfe,normal_pars_fragment:ffe,normal_pars_vertex:mfe,normal_vertex:gfe,normalmap_pars_fragment:yfe,clearcoat_normal_fragment_begin:vfe,clearcoat_normal_fragment_maps:bfe,clearcoat_pars_fragment:xfe,iridescence_pars_fragment:wfe,output_fragment:_fe,packing:Sfe,premultiplied_alpha_fragment:Afe,project_vertex:Efe,dithering_fragment:Mfe,dithering_pars_fragment:Cfe,roughnessmap_fragment:Pfe,roughnessmap_pars_fragment:Tfe,shadowmap_pars_fragment:Rfe,shadowmap_pars_vertex:kfe,shadowmap_vertex:Dfe,shadowmask_pars_fragment:Ife,skinbase_vertex:Lfe,skinning_pars_vertex:Bfe,skinning_vertex:Ofe,skinnormal_vertex:Ufe,specularmap_fragment:Nfe,specularmap_pars_fragment:Ffe,tonemapping_fragment:zfe,tonemapping_pars_fragment:Hfe,transmission_fragment:Gfe,transmission_pars_fragment:Vfe,uv_pars_fragment:jfe,uv_pars_vertex:Wfe,uv_vertex:qfe,uv2_pars_fragment:Xfe,uv2_pars_vertex:Yfe,uv2_vertex:Kfe,worldpos_vertex:Jfe,background_vert:Qfe,background_frag:Zfe,backgroundCube_vert:$fe,backgroundCube_frag:eme,cube_vert:tme,cube_frag:ime,depth_vert:rme,depth_frag:nme,distanceRGBA_vert:sme,distanceRGBA_frag:ome,equirect_vert:ame,equirect_frag:lme,linedashed_vert:ume,linedashed_frag:hme,meshbasic_vert:cme,meshbasic_frag:dme,meshlambert_vert:pme,meshlambert_frag:fme,meshmatcap_vert:mme,meshmatcap_frag:gme,meshnormal_vert:yme,meshnormal_frag:vme,meshphong_vert:bme,meshphong_frag:xme,meshphysical_vert:wme,meshphysical_frag:_me,meshtoon_vert:Sme,meshtoon_frag:Ame,points_vert:Eme,points_frag:Mme,shadow_vert:Cme,shadow_frag:Pme,sprite_vert:Tme,sprite_frag:Rme},vt={common:{diffuse:{value:new Xt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new wn},uv2Transform:{value:new wn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new me(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new wn}},sprite:{diffuse:{value:new Xt(16777215)},opacity:{value:1},center:{value:new me(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new wn}}},ch={basic:{uniforms:Ro([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.fog]),vertexShader:fi.meshbasic_vert,fragmentShader:fi.meshbasic_frag},lambert:{uniforms:Ro([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:fi.meshlambert_vert,fragmentShader:fi.meshlambert_frag},phong:{uniforms:Ro([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new Xt(0)},specular:{value:new Xt(1118481)},shininess:{value:30}}]),vertexShader:fi.meshphong_vert,fragmentShader:fi.meshphong_frag},standard:{uniforms:Ro([vt.common,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.roughnessmap,vt.metalnessmap,vt.fog,vt.lights,{emissive:{value:new Xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag},toon:{uniforms:Ro([vt.common,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.gradientmap,vt.fog,vt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:fi.meshtoon_vert,fragmentShader:fi.meshtoon_frag},matcap:{uniforms:Ro([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,{matcap:{value:null}}]),vertexShader:fi.meshmatcap_vert,fragmentShader:fi.meshmatcap_frag},points:{uniforms:Ro([vt.points,vt.fog]),vertexShader:fi.points_vert,fragmentShader:fi.points_frag},dashed:{uniforms:Ro([vt.common,vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fi.linedashed_vert,fragmentShader:fi.linedashed_frag},depth:{uniforms:Ro([vt.common,vt.displacementmap]),vertexShader:fi.depth_vert,fragmentShader:fi.depth_frag},normal:{uniforms:Ro([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,{opacity:{value:1}}]),vertexShader:fi.meshnormal_vert,fragmentShader:fi.meshnormal_frag},sprite:{uniforms:Ro([vt.sprite,vt.fog]),vertexShader:fi.sprite_vert,fragmentShader:fi.sprite_frag},background:{uniforms:{uvTransform:{value:new wn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fi.background_vert,fragmentShader:fi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:fi.backgroundCube_vert,fragmentShader:fi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fi.cube_vert,fragmentShader:fi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fi.equirect_vert,fragmentShader:fi.equirect_frag},distanceRGBA:{uniforms:Ro([vt.common,vt.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fi.distanceRGBA_vert,fragmentShader:fi.distanceRGBA_frag},shadow:{uniforms:Ro([vt.lights,vt.fog,{color:{value:new Xt(0)},opacity:{value:1}}]),vertexShader:fi.shadow_vert,fragmentShader:fi.shadow_frag}};ch.physical={uniforms:Ro([ch.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new me(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Xt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Xt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Xt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:fi.meshphysical_vert,fragmentShader:fi.meshphysical_frag};var iA={r:0,b:0,g:0};function kme(t,e,i,r,n,s,o){let a=new Xt(0),l=s===!0?0:1,u,c,h=null,d=0,p=null;function f(g,y){let v=!1,b=y.isScene===!0?y.background:null;b&&b.isTexture&&(b=(y.backgroundBlurriness>0?i:e).get(b));let _=t.xr,A=_.getSession&&_.getSession();A&&A.environmentBlendMode==="additive"&&(b=null),b===null?m(a,l):b&&b.isColor&&(m(b,1),v=!0),(t.autoClear||v)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),b&&(b.isCubeTexture||b.mapping===X1)?(c===void 0&&(c=new zn(new Cu(1,1,1),new er({name:"BackgroundCubeMaterial",uniforms:e0(ch.backgroundCube.uniforms),vertexShader:ch.backgroundCube.vertexShader,fragmentShader:ch.backgroundCube.fragmentShader,side:As,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(S,E,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=b,c.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=b.encoding!==pi,(h!==b||d!==b.version||p!==t.toneMapping)&&(c.material.needsUpdate=!0,h=b,d=b.version,p=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null)):b&&b.isTexture&&(u===void 0&&(u=new zn(new Qm(2,2),new er({name:"BackgroundMaterial",uniforms:e0(ch.background.uniforms),vertexShader:ch.background.vertexShader,fragmentShader:ch.background.fragmentShader,side:Eu,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=b,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=b.encoding!==pi,b.matrixAutoUpdate===!0&&b.updateMatrix(),u.material.uniforms.uvTransform.value.copy(b.matrix),(h!==b||d!==b.version||p!==t.toneMapping)&&(u.material.needsUpdate=!0,h=b,d=b.version,p=t.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null))}function m(g,y){g.getRGB(iA,PQ(t)),r.buffers.color.setClear(iA.r,iA.g,iA.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(g,y=1){a.set(g),l=y,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(a,l)},render:f}}function Dme(t,e,i,r){let n=t.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=g(null),u=l,c=!1;function h(D,F,H,z,B){let j=!1;if(o){let V=m(z,H,F);u!==V&&(u=V,p(u.object)),j=y(D,z,H,B),j&&v(D,z,H,B)}else{let V=F.wireframe===!0;(u.geometry!==z.id||u.program!==H.id||u.wireframe!==V)&&(u.geometry=z.id,u.program=H.id,u.wireframe=V,j=!0)}B!==null&&i.update(B,34963),(j||c)&&(c=!1,M(D,F,H,z),B!==null&&t.bindBuffer(34963,i.get(B).buffer))}function d(){return r.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function p(D){return r.isWebGL2?t.bindVertexArray(D):s.bindVertexArrayOES(D)}function f(D){return r.isWebGL2?t.deleteVertexArray(D):s.deleteVertexArrayOES(D)}function m(D,F,H){let z=H.wireframe===!0,B=a[D.id];B===void 0&&(B={},a[D.id]=B);let j=B[F.id];j===void 0&&(j={},B[F.id]=j);let V=j[z];return V===void 0&&(V=g(d()),j[z]=V),V}function g(D){let F=[],H=[],z=[];for(let B=0;B<n;B++)F[B]=0,H[B]=0,z[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:H,attributeDivisors:z,object:D,attributes:{},index:null}}function y(D,F,H,z){let B=u.attributes,j=F.attributes,V=0,q=H.getAttributes();for(let K in q)if(q[K].location>=0){let le=B[K],Z=j[K];if(Z===void 0&&(K==="instanceMatrix"&&D.instanceMatrix&&(Z=D.instanceMatrix),K==="instanceColor"&&D.instanceColor&&(Z=D.instanceColor)),le===void 0||le.attribute!==Z||Z&&le.data!==Z.data)return!0;V++}return u.attributesNum!==V||u.index!==z}function v(D,F,H,z){let B={},j=F.attributes,V=0,q=H.getAttributes();for(let K in q)if(q[K].location>=0){let le=j[K];le===void 0&&(K==="instanceMatrix"&&D.instanceMatrix&&(le=D.instanceMatrix),K==="instanceColor"&&D.instanceColor&&(le=D.instanceColor));let Z={};Z.attribute=le,le&&le.data&&(Z.data=le.data),B[K]=Z,V++}u.attributes=B,u.attributesNum=V,u.index=z}function b(){let D=u.newAttributes;for(let F=0,H=D.length;F<H;F++)D[F]=0}function _(D){A(D,0)}function A(D,F){let H=u.newAttributes,z=u.enabledAttributes,B=u.attributeDivisors;H[D]=1,z[D]===0&&(t.enableVertexAttribArray(D),z[D]=1),B[D]!==F&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,F),B[D]=F)}function S(){let D=u.newAttributes,F=u.enabledAttributes;for(let H=0,z=F.length;H<z;H++)F[H]!==D[H]&&(t.disableVertexAttribArray(H),F[H]=0)}function E(D,F,H,z,B,j){r.isWebGL2===!0&&(H===5124||H===5125)?t.vertexAttribIPointer(D,F,H,B,j):t.vertexAttribPointer(D,F,H,z,B,j)}function M(D,F,H,z){if(r.isWebGL2===!1&&(D.isInstancedMesh||z.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();let B=z.attributes,j=H.getAttributes(),V=F.defaultAttributeValues;for(let q in j){let K=j[q];if(K.location>=0){let le=B[q];if(le===void 0&&(q==="instanceMatrix"&&D.instanceMatrix&&(le=D.instanceMatrix),q==="instanceColor"&&D.instanceColor&&(le=D.instanceColor)),le!==void 0){let Z=le.normalized,oe=le.itemSize,ae=i.get(le);if(ae===void 0)continue;let ve=ae.buffer,ye=ae.type,pe=ae.bytesPerElement;if(le.isInterleavedBufferAttribute){let Se=le.data,be=Se.stride,ee=le.offset;if(Se.isInstancedInterleavedBuffer){for(let _e=0;_e<K.locationSize;_e++)A(K.location+_e,Se.meshPerAttribute);D.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Se.meshPerAttribute*Se.count)}else for(let _e=0;_e<K.locationSize;_e++)_(K.location+_e);t.bindBuffer(34962,ve);for(let _e=0;_e<K.locationSize;_e++)E(K.location+_e,oe/K.locationSize,ye,Z,be*pe,(ee+oe/K.locationSize*_e)*pe)}else{if(le.isInstancedBufferAttribute){for(let Se=0;Se<K.locationSize;Se++)A(K.location+Se,le.meshPerAttribute);D.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let Se=0;Se<K.locationSize;Se++)_(K.location+Se);t.bindBuffer(34962,ve);for(let Se=0;Se<K.locationSize;Se++)E(K.location+Se,oe/K.locationSize,ye,Z,oe*pe,oe/K.locationSize*Se*pe)}}else if(V!==void 0){let Z=V[q];if(Z!==void 0)switch(Z.length){case 2:t.vertexAttrib2fv(K.location,Z);break;case 3:t.vertexAttrib3fv(K.location,Z);break;case 4:t.vertexAttrib4fv(K.location,Z);break;default:t.vertexAttrib1fv(K.location,Z)}}}}S()}function R(){L();for(let D in a){let F=a[D];for(let H in F){let z=F[H];for(let B in z)f(z[B].object),delete z[B];delete F[H]}delete a[D]}}function C(D){if(a[D.id]===void 0)return;let F=a[D.id];for(let H in F){let z=F[H];for(let B in z)f(z[B].object),delete z[B];delete F[H]}delete a[D.id]}function T(D){for(let F in a){let H=a[F];if(H[D.id]===void 0)continue;let z=H[D.id];for(let B in z)f(z[B].object),delete z[B];delete H[D.id]}}function L(){I(),c=!0,u!==l&&(u=l,p(u.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:L,resetDefaultState:I,dispose:R,releaseStatesOfGeometry:C,releaseStatesOfProgram:T,initAttributes:b,enableAttribute:_,disableUnusedAttributes:S}}function Ime(t,e,i,r){let n=r.isWebGL2,s;function o(u){s=u}function a(u,c){t.drawArrays(s,u,c),i.update(c,s,1)}function l(u,c,h){if(h===0)return;let d,p;if(n)d=t,p="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,u,c,h),i.update(c,s,h)}this.setMode=o,this.render=a,this.renderInstances=l}function Lme(t,e,i){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,a=i.precision!==void 0?i.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let u=o||e.has("WEBGL_draw_buffers"),c=i.logarithmicDepthBuffer===!0,h=t.getParameter(34930),d=t.getParameter(35660),p=t.getParameter(3379),f=t.getParameter(34076),m=t.getParameter(34921),g=t.getParameter(36347),y=t.getParameter(36348),v=t.getParameter(36349),b=d>0,_=o||e.has("OES_texture_float"),A=b&&_,S=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:n,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:_,floatVertexTextures:A,maxSamples:S}}function Bme(t){let e=this,i=null,r=0,n=!1,s=!1,o=new Ba,a=new wn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||r!==0||n;return n=d,r=h.length,p},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=c(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,y=t.get(h);if(!n||f===null||f.length===0||s&&!g)s?c(null):u();else{let v=s?0:r,b=v*4,_=y.clippingState||null;l.value=_,_=c(f,d,b,p);for(let A=0;A!==b;++A)_[A]=i[A];y.clippingState=_,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}};function u(){l.value!==i&&(l.value=i,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(h,d,p,f){let m=h!==null?h.length:0,g=null;if(m!==0){if(g=l.value,f!==!0||g===null){let y=p+m*4,v=d.matrixWorldInverse;a.getNormalMatrix(v),(g===null||g.length<y)&&(g=new Float32Array(y));for(let b=0,_=p;b!==m;++b,_+=4)o.copy(h[b]).applyMatrix4(v,a),o.normal.toArray(g,_),g[_+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function Ome(t){let e=new WeakMap;function i(o,a){return a===jL?o.mapping=km:a===WL&&(o.mapping=Dm),o}function r(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===jL||a===WL)if(e.has(o)){let l=e.get(o).texture;return i(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let u=new Kde(l.height/2);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",n),i(u.texture,o.mapping)}else return null}}return o}function n(o){let a=o.target;a.removeEventListener("dispose",n);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}var MF=class extends Jm{constructor(t=-1,e=1,i=1,r=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=r,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,i,r,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=i-t,s=i+t,o=r+e,a=r-e;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,o-=u*this.view.offsetY,a=o-u*this.view.height}this.projectionMatrix.makeOrthographic(n,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},ov=4,xj=[.125,.215,.35,.446,.526,.582],Nf=20,aD=new MF,wj=new Xt,lD=null,Rf=(1+Math.sqrt(5))/2,Fg=1/Rf,_j=[new N(1,1,1),new N(-1,1,1),new N(1,1,-1),new N(-1,1,-1),new N(0,Rf,Fg),new N(0,Rf,-Fg),new N(Fg,0,Rf),new N(-Fg,0,Rf),new N(Rf,Fg,0),new N(-Rf,Fg,0)],Sj=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,i=.1,r=100){lD=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(t,i,r,n),e>0&&this._blur(n,0,0,e),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Mj(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Ej(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(lD),t.scissorTest=!1,rA(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===km||t.mapping===Dm?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),lD=this._renderer.getRenderTarget();let i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:mi,minFilter:mi,generateMipmaps:!1,type:Im,format:_s,encoding:Mu,depthBuffer:!1},r=Aj(t,e,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Aj(t,e,i);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Ume(n)),this._blurMaterial=Nme(n,t,e)}return r}_compileMaterial(t){let e=new zn(this._lodPlanes[0],t);this._renderer.compile(e,aD)}_sceneToCubeUV(t,e,i,r){let n=new uo(90,1,e,i),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,u=a.toneMapping;a.getClearColor(wj),a.toneMapping=Mh,a.autoClear=!1;let c=new Km({name:"PMREM.Background",side:As,depthWrite:!1,depthTest:!1}),h=new zn(new Cu,c),d=!1,p=t.background;p?p.isColor&&(c.color.copy(p),t.background=null,d=!0):(c.color.copy(wj),d=!0);for(let f=0;f<6;f++){let m=f%3;m===0?(n.up.set(0,s[f],0),n.lookAt(o[f],0,0)):m===1?(n.up.set(0,0,s[f]),n.lookAt(0,o[f],0)):(n.up.set(0,s[f],0),n.lookAt(0,0,o[f]));let g=this._cubeSize;rA(r,m*g,f>2?g:0,g,g),a.setRenderTarget(r),d&&a.render(h,n),a.render(t,n)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=u,a.autoClear=l,t.background=p}_textureToCubeUV(t,e){let i=this._renderer,r=t.mapping===km||t.mapping===Dm;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=Mj()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Ej());let n=r?this._cubemapMaterial:this._equirectMaterial,s=new zn(this._lodPlanes[0],n),o=n.uniforms;o.envMap.value=t;let a=this._cubeSize;rA(e,0,0,3*a,2*a),i.setRenderTarget(e),i.render(s,aD)}_applyPMREM(t){let e=this._renderer,i=e.autoClear;e.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){let n=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),s=_j[(r-1)%_j.length];this._blur(t,r-1,r,n,s)}e.autoClear=i}_blur(t,e,i,r,n){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,i,r,"latitudinal",n),this._halfBlur(s,t,i,i,r,"longitudinal",n)}_halfBlur(t,e,i,r,n,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,c=new zn(this._lodPlanes[r],l),h=l.uniforms,d=this._sizeLods[i]-1,p=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*Nf-1),f=n/p,m=isFinite(n)?1+Math.floor(u*f):Nf;m>Nf&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Nf}`);let g=[],y=0;for(let S=0;S<Nf;++S){let E=S/f,M=Math.exp(-E*E/2);g.push(M),S===0?y+=M:S<m&&(y+=2*M)}for(let S=0;S<g.length;S++)g[S]=g[S]/y;h.envMap.value=t.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value=s==="latitudinal",o&&(h.poleAxis.value=o);let{_lodMax:v}=this;h.dTheta.value=p,h.mipInt.value=v-i;let b=this._sizeLods[r],_=3*b*(r>v-ov?r-v+ov:0),A=4*(this._cubeSize-b);rA(e,_,A,3*b,2*b),a.setRenderTarget(e),a.render(c,aD)}};function Ume(t){let e=[],i=[],r=[],n=t,s=t-ov+1+xj.length;for(let o=0;o<s;o++){let a=Math.pow(2,n);i.push(a);let l=1/a;o>t-ov?l=xj[o-t+ov-1]:o===0&&(l=0),r.push(l);let u=1/(a-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],p=6,f=6,m=3,g=2,y=1,v=new Float32Array(m*f*p),b=new Float32Array(g*f*p),_=new Float32Array(y*f*p);for(let S=0;S<p;S++){let E=S%3*2/3-1,M=S>2?0:-1,R=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];v.set(R,m*f*S),b.set(d,g*f*S);let C=[S,S,S,S,S,S];_.set(C,y*f*S)}let A=new Ht;A.setAttribute("position",new ei(v,m)),A.setAttribute("uv",new ei(b,g)),A.setAttribute("faceIndex",new ei(_,y)),e.push(A),n>ov&&n--}return{lodPlanes:e,sizeLods:i,sigmas:r}}function Aj(t,e,i){let r=new $i(t,e,i);return r.texture.mapping=X1,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function rA(t,e,i,r,n){t.viewport.set(e,i,r,n),t.scissor.set(e,i,r,n)}function Nme(t,e,i){let r=new Float32Array(Nf),n=new N(0,1,0);return new er({name:"SphericalGaussianBlur",defines:{n:Nf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:CF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Gn,depthTest:!1,depthWrite:!1})}function Ej(){return new er({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:CF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Gn,depthTest:!1,depthWrite:!1})}function Mj(){return new er({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:CF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Gn,depthTest:!1,depthWrite:!1})}function CF(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Fme(t){let e=new WeakMap,i=null;function r(a){if(a&&a.isTexture){let l=a.mapping,u=l===jL||l===WL,c=l===km||l===Dm;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return i===null&&(i=new Sj(t)),h=u?i.fromEquirectangular(a,h):i.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{let h=a.image;if(u&&h&&h.height>0||c&&h&&n(h)){i===null&&(i=new Sj(t));let d=u?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function n(a){let l=0,u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){let l=a.target;l.removeEventListener("dispose",s);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:r,dispose:o}}function zme(t){let e={};function i(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return e[r]=n,n}return{has:function(r){return i(r)!==null},init:function(r){r.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(r){let n=i(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function Hme(t,e,i,r){let n={},s=new WeakMap;function o(h){let d=h.target;d.index!==null&&e.remove(d.index);for(let f in d.attributes)e.remove(d.attributes[f]);d.removeEventListener("dispose",o),delete n[d.id];let p=s.get(d);p&&(e.remove(p),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(h,d){return n[d.id]===!0||(d.addEventListener("dispose",o),n[d.id]=!0,i.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)e.update(d[f],34962);let p=h.morphAttributes;for(let f in p){let m=p[f];for(let g=0,y=m.length;g<y;g++)e.update(m[g],34962)}}function u(h){let d=[],p=h.index,f=h.attributes.position,m=0;if(p!==null){let v=p.array;m=p.version;for(let b=0,_=v.length;b<_;b+=3){let A=v[b+0],S=v[b+1],E=v[b+2];d.push(A,S,S,E,E,A)}}else{let v=f.array;m=f.version;for(let b=0,_=v.length/3-1;b<_;b+=3){let A=b+0,S=b+1,E=b+2;d.push(A,S,S,E,E,A)}}let g=new(_Q(d)?Sv:CQ)(d,1);g.version=m;let y=s.get(h);y&&e.remove(y),s.set(h,g)}function c(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&u(h)}else u(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function Gme(t,e,i,r){let n=r.isWebGL2,s;function o(d){s=d}let a,l;function u(d){a=d.type,l=d.bytesPerElement}function c(d,p){t.drawElements(s,p,a,d*l),i.update(p,s,1)}function h(d,p,f){if(f===0)return;let m,g;if(n)m=t,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,p,a,d*l,f),i.update(p,s,f)}this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=h}function Vme(t){let e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(i.calls++,o){case 4:i.triangles+=a*(s/3);break;case 1:i.lines+=a*(s/2);break;case 3:i.lines+=a*(s-1);break;case 2:i.lines+=a*s;break;case 0:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:n,update:r}}function jme(t,e){return t[0]-e[0]}function Wme(t,e){return Math.abs(e[1])-Math.abs(t[1])}function qme(t,e,i){let r={},n=new Float32Array(8),s=new WeakMap,o=new si,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,h,d){let p=u.morphTargetInfluences;if(e.isWebGL2===!0){let f=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,m=f!==void 0?f.length:0,g=s.get(c);if(g===void 0||g.count!==m){let b=function(){D.dispose(),s.delete(c),c.removeEventListener("dispose",b)};g!==void 0&&g.texture.dispose();let _=c.morphAttributes.position!==void 0,A=c.morphAttributes.normal!==void 0,S=c.morphAttributes.color!==void 0,E=c.morphAttributes.position||[],M=c.morphAttributes.normal||[],R=c.morphAttributes.color||[],C=0;_===!0&&(C=1),A===!0&&(C=2),S===!0&&(C=3);let T=c.attributes.position.count*C,L=1;T>e.maxTextureSize&&(L=Math.ceil(T/e.maxTextureSize),T=e.maxTextureSize);let I=new Float32Array(T*L*4*m),D=new MQ(I,T,L,m);D.type=Fn,D.needsUpdate=!0;let F=C*4;for(let H=0;H<m;H++){let z=E[H],B=M[H],j=R[H],V=T*L*4*H;for(let q=0;q<z.count;q++){let K=q*F;_===!0&&(o.fromBufferAttribute(z,q),I[V+K+0]=o.x,I[V+K+1]=o.y,I[V+K+2]=o.z,I[V+K+3]=0),A===!0&&(o.fromBufferAttribute(B,q),I[V+K+4]=o.x,I[V+K+5]=o.y,I[V+K+6]=o.z,I[V+K+7]=0),S===!0&&(o.fromBufferAttribute(j,q),I[V+K+8]=o.x,I[V+K+9]=o.y,I[V+K+10]=o.z,I[V+K+11]=j.itemSize===4?o.w:1)}}g={count:m,texture:D,size:new me(T,L)},s.set(c,g),c.addEventListener("dispose",b)}let y=0;for(let b=0;b<p.length;b++)y+=p[b];let v=c.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",v),d.getUniforms().setValue(t,"morphTargetInfluences",p),d.getUniforms().setValue(t,"morphTargetsTexture",g.texture,i),d.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{let f=p===void 0?0:p.length,m=r[c.id];if(m===void 0||m.length!==f){m=[];for(let _=0;_<f;_++)m[_]=[_,0];r[c.id]=m}for(let _=0;_<f;_++){let A=m[_];A[0]=_,A[1]=p[_]}m.sort(Wme);for(let _=0;_<8;_++)_<f&&m[_][1]?(a[_][0]=m[_][0],a[_][1]=m[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(jme);let g=c.morphAttributes.position,y=c.morphAttributes.normal,v=0;for(let _=0;_<8;_++){let A=a[_],S=A[0],E=A[1];S!==Number.MAX_SAFE_INTEGER&&E?(g&&c.getAttribute("morphTarget"+_)!==g[S]&&c.setAttribute("morphTarget"+_,g[S]),y&&c.getAttribute("morphNormal"+_)!==y[S]&&c.setAttribute("morphNormal"+_,y[S]),n[_]=E,v+=E):(g&&c.hasAttribute("morphTarget"+_)===!0&&c.deleteAttribute("morphTarget"+_),y&&c.hasAttribute("morphNormal"+_)===!0&&c.deleteAttribute("morphNormal"+_),n[_]=0)}let b=c.morphTargetsRelative?1:1-v;d.getUniforms().setValue(t,"morphTargetBaseInfluence",b),d.getUniforms().setValue(t,"morphTargetInfluences",n)}}return{update:l}}function Xme(t,e,i,r){let n=new WeakMap;function s(l){let u=r.render.frame,c=l.geometry,h=e.get(l,c);return n.get(h)!==u&&(e.update(h),n.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),h}function o(){n=new WeakMap}function a(l){let u=l.target;u.removeEventListener("dispose",a),i.remove(u.instanceMatrix),u.instanceColor!==null&&i.remove(u.instanceColor)}return{update:s,dispose:o}}var RQ=new Wr,kQ=new MQ,DQ=new Ide,IQ=new AF,Cj=[],Pj=[],Tj=new Float32Array(16),Rj=new Float32Array(9),kj=new Float32Array(4);function N0(t,e,i){let r=t[0];if(r<=0||r>0)return t;let n=e*i,s=Cj[n];if(s===void 0&&(s=new Float32Array(n),Cj[n]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function ns(t,e){if(t.length!==e.length)return!1;for(let i=0,r=t.length;i<r;i++)if(t[i]!==e[i])return!1;return!0}function ss(t,e){for(let i=0,r=e.length;i<r;i++)t[i]=e[i]}function EP(t,e){let i=Pj[e];i===void 0&&(i=new Int32Array(e),Pj[e]=i);for(let r=0;r!==e;++r)i[r]=t.allocateTextureUnit();return i}function Yme(t,e){let i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Kme(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ns(i,e))return;t.uniform2fv(this.addr,e),ss(i,e)}}function Jme(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(ns(i,e))return;t.uniform3fv(this.addr,e),ss(i,e)}}function Qme(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ns(i,e))return;t.uniform4fv(this.addr,e),ss(i,e)}}function Zme(t,e){let i=this.cache,r=e.elements;if(r===void 0){if(ns(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),ss(i,e)}else{if(ns(i,r))return;kj.set(r),t.uniformMatrix2fv(this.addr,!1,kj),ss(i,r)}}function $me(t,e){let i=this.cache,r=e.elements;if(r===void 0){if(ns(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),ss(i,e)}else{if(ns(i,r))return;Rj.set(r),t.uniformMatrix3fv(this.addr,!1,Rj),ss(i,r)}}function ege(t,e){let i=this.cache,r=e.elements;if(r===void 0){if(ns(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),ss(i,e)}else{if(ns(i,r))return;Tj.set(r),t.uniformMatrix4fv(this.addr,!1,Tj),ss(i,r)}}function tge(t,e){let i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function ige(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ns(i,e))return;t.uniform2iv(this.addr,e),ss(i,e)}}function rge(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ns(i,e))return;t.uniform3iv(this.addr,e),ss(i,e)}}function nge(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ns(i,e))return;t.uniform4iv(this.addr,e),ss(i,e)}}function sge(t,e){let i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function oge(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ns(i,e))return;t.uniform2uiv(this.addr,e),ss(i,e)}}function age(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ns(i,e))return;t.uniform3uiv(this.addr,e),ss(i,e)}}function lge(t,e){let i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ns(i,e))return;t.uniform4uiv(this.addr,e),ss(i,e)}}function uge(t,e,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTexture2D(e||RQ,n)}function hge(t,e,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(e||DQ,n)}function cge(t,e,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTextureCube(e||IQ,n)}function dge(t,e,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(e||kQ,n)}function pge(t){switch(t){case 5126:return Yme;case 35664:return Kme;case 35665:return Jme;case 35666:return Qme;case 35674:return Zme;case 35675:return $me;case 35676:return ege;case 5124:case 35670:return tge;case 35667:case 35671:return ige;case 35668:case 35672:return rge;case 35669:case 35673:return nge;case 5125:return sge;case 36294:return oge;case 36295:return age;case 36296:return lge;case 35678:case 36198:case 36298:case 36306:case 35682:return uge;case 35679:case 36299:case 36307:return hge;case 35680:case 36300:case 36308:case 36293:return cge;case 36289:case 36303:case 36311:case 36292:return dge}}function fge(t,e){t.uniform1fv(this.addr,e)}function mge(t,e){let i=N0(e,this.size,2);t.uniform2fv(this.addr,i)}function gge(t,e){let i=N0(e,this.size,3);t.uniform3fv(this.addr,i)}function yge(t,e){let i=N0(e,this.size,4);t.uniform4fv(this.addr,i)}function vge(t,e){let i=N0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function bge(t,e){let i=N0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function xge(t,e){let i=N0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function wge(t,e){t.uniform1iv(this.addr,e)}function _ge(t,e){t.uniform2iv(this.addr,e)}function Sge(t,e){t.uniform3iv(this.addr,e)}function Age(t,e){t.uniform4iv(this.addr,e)}function Ege(t,e){t.uniform1uiv(this.addr,e)}function Mge(t,e){t.uniform2uiv(this.addr,e)}function Cge(t,e){t.uniform3uiv(this.addr,e)}function Pge(t,e){t.uniform4uiv(this.addr,e)}function Tge(t,e,i){let r=this.cache,n=e.length,s=EP(i,n);ns(r,s)||(t.uniform1iv(this.addr,s),ss(r,s));for(let o=0;o!==n;++o)i.setTexture2D(e[o]||RQ,s[o])}function Rge(t,e,i){let r=this.cache,n=e.length,s=EP(i,n);ns(r,s)||(t.uniform1iv(this.addr,s),ss(r,s));for(let o=0;o!==n;++o)i.setTexture3D(e[o]||DQ,s[o])}function kge(t,e,i){let r=this.cache,n=e.length,s=EP(i,n);ns(r,s)||(t.uniform1iv(this.addr,s),ss(r,s));for(let o=0;o!==n;++o)i.setTextureCube(e[o]||IQ,s[o])}function Dge(t,e,i){let r=this.cache,n=e.length,s=EP(i,n);ns(r,s)||(t.uniform1iv(this.addr,s),ss(r,s));for(let o=0;o!==n;++o)i.setTexture2DArray(e[o]||kQ,s[o])}function Ige(t){switch(t){case 5126:return fge;case 35664:return mge;case 35665:return gge;case 35666:return yge;case 35674:return vge;case 35675:return bge;case 35676:return xge;case 5124:case 35670:return wge;case 35667:case 35671:return _ge;case 35668:case 35672:return Sge;case 35669:case 35673:return Age;case 5125:return Ege;case 36294:return Mge;case 36295:return Cge;case 36296:return Pge;case 35678:case 36198:case 36298:case 36306:case 35682:return Tge;case 35679:case 36299:case 36307:return Rge;case 35680:case 36300:case 36308:case 36293:return kge;case 36289:case 36303:case 36311:case 36292:return Dge}}var Lge=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=pge(e.type)}},Bge=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=Ige(e.type)}},Oge=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){let r=this.seq;for(let n=0,s=r.length;n!==s;++n){let o=r[n];o.setValue(t,e[o.id],i)}}},uD=/(\w+)(\])?(\[|\.)?/g;function Dj(t,e){t.seq.push(e),t.map[e.id]=e}function Uge(t,e,i){let r=t.name,n=r.length;for(uD.lastIndex=0;;){let s=uD.exec(r),o=uD.lastIndex,a=s[1],l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===n){Dj(i,u===void 0?new Lge(a,t,e):new Bge(a,t,e));break}else{let c=i.map[a];c===void 0&&(c=new Oge(a),Dj(i,c)),i=c}}}var MM=class{constructor(t,e){this.seq=[],this.map={};let i=t.getProgramParameter(e,35718);for(let r=0;r<i;++r){let n=t.getActiveUniform(e,r),s=t.getUniformLocation(e,n.name);Uge(n,s,this)}}setValue(t,e,i,r){let n=this.map[e];n!==void 0&&n.setValue(t,i,r)}setOptional(t,e,i){let r=e[i];r!==void 0&&this.setValue(t,i,r)}static upload(t,e,i,r){for(let n=0,s=e.length;n!==s;++n){let o=e[n],a=i[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,r)}}static seqWithValue(t,e){let i=[];for(let r=0,n=t.length;r!==n;++r){let s=t[r];s.id in e&&i.push(s)}return i}};function Ij(t,e,i){let r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}var Nge=0;function Fge(t,e){let i=t.split(`
`),r=[],n=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=n;o<s;o++){let a=o+1;r.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return r.join(`
`)}function zge(t){switch(t){case Mu:return["Linear","( value )"];case pi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Lj(t,e,i){let r=t.getShaderParameter(e,35713),n=t.getShaderInfoLog(e).trim();if(r&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let o=parseInt(s[1]);return i.toUpperCase()+`

`+n+`

`+Fge(t.getShaderSource(e),o)}else return n}function Hge(t,e){let i=zge(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Gge(t,e){let i;switch(e){case Yce:i="Linear";break;case Kce:i="Reinhard";break;case Jce:i="OptimizedCineon";break;case Qce:i="ACESFilmic";break;case Zce:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Vge(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Nx).join(`
`)}function jge(t){let e=[];for(let i in t){let r=t[i];r!==!1&&e.push("#define "+i+" "+r)}return e.join(`
`)}function Wge(t,e){let i={},r=t.getProgramParameter(e,35721);for(let n=0;n<r;n++){let s=t.getActiveAttrib(e,n),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function Nx(t){return t!==""}function Bj(t,e){let i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Oj(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var qge=/^[ \t]*#include +<([\w\d./]+)>/gm;function JL(t){return t.replace(qge,Xge)}function Xge(t,e){let i=fi[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return JL(i)}var Yge=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Uj(t){return t.replace(Yge,Kge)}function Kge(t,e,i,r){let n="";for(let s=parseInt(e);s<parseInt(i);s++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function Nj(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Jge(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===bF?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Mce?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ux&&(e="SHADOWMAP_TYPE_VSM"),e}function Qge(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case km:case Dm:e="ENVMAP_TYPE_CUBE";break;case X1:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Zge(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Dm:e="ENVMAP_MODE_REFRACTION";break}return e}function $ge(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case fQ:e="ENVMAP_BLENDING_MULTIPLY";break;case qce:e="ENVMAP_BLENDING_MIX";break;case Xce:e="ENVMAP_BLENDING_ADD";break}return e}function eye(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let i=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:r,maxMip:i}}function tye(t,e,i,r){let n=t.getContext(),s=i.defines,o=i.vertexShader,a=i.fragmentShader,l=Jge(i),u=Qge(i),c=Zge(i),h=$ge(i),d=eye(i),p=i.isWebGL2?"":Vge(i),f=jge(s),m=n.createProgram(),g,y,v=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(g=[f].filter(Nx).join(`
`),g.length>0&&(g+=`
`),y=[p,f].filter(Nx).join(`
`),y.length>0&&(y+=`
`)):(g=[Nj(i),"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Nx).join(`
`),y=[p,Nj(i),"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Mh?"#define TONE_MAPPING":"",i.toneMapping!==Mh?fi.tonemapping_pars_fragment:"",i.toneMapping!==Mh?Gge("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",fi.encodings_pars_fragment,Hge("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Nx).join(`
`)),o=JL(o),o=Bj(o,i),o=Oj(o,i),a=JL(a),a=Bj(a,i),a=Oj(a,i),o=Uj(o),a=Uj(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,y=["#define varying in",i.glslVersion===lj?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===lj?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);let b=v+g+o,_=v+y+a,A=Ij(n,35633,b),S=Ij(n,35632,_);if(n.attachShader(m,A),n.attachShader(m,S),i.index0AttributeName!==void 0?n.bindAttribLocation(m,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),t.debug.checkShaderErrors){let R=n.getProgramInfoLog(m).trim(),C=n.getShaderInfoLog(A).trim(),T=n.getShaderInfoLog(S).trim(),L=!0,I=!0;if(n.getProgramParameter(m,35714)===!1){L=!1;let D=Lj(n,A,"vertex"),F=Lj(n,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+R+`
`+D+`
`+F)}else R!==""?console.warn("THREE.WebGLProgram: Program Info Log:",R):(C===""||T==="")&&(I=!1);I&&(this.diagnostics={runnable:L,programLog:R,vertexShader:{log:C,prefix:g},fragmentShader:{log:T,prefix:y}})}n.deleteShader(A),n.deleteShader(S);let E;this.getUniforms=function(){return E===void 0&&(E=new MM(n,m)),E};let M;return this.getAttributes=function(){return M===void 0&&(M=Wge(n,m)),M},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=i.shaderName,this.id=Nge++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=A,this.fragmentShader=S,this}var iye=0,rye=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,i=t.fragmentShader,r=this._getShaderStage(e),n=this._getShaderStage(i),s=this._getShaderCacheForMaterial(t);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let i of e)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,i=e.get(t);return i===void 0&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){let e=this.shaderCache,i=e.get(t);return i===void 0&&(i=new nye(t),e.set(t,i)),i}},nye=class{constructor(t){this.id=iye++,this.code=t,this.usedTimes=0}};function sye(t,e,i,r,n,s,o){let a=new SF,l=new rye,u=[],c=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.vertexTextures,p=n.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(M,R,C,T,L){let I=T.fog,D=L.geometry,F=M.isMeshStandardMaterial?T.environment:null,H=(M.isMeshStandardMaterial?i:e).get(M.envMap||F),z=H&&H.mapping===X1?H.image.height:null,B=f[M.type];M.precision!==null&&(p=n.getMaxPrecision(M.precision),p!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",p,"instead."));let j=D.morphAttributes.position||D.morphAttributes.normal||D.morphAttributes.color,V=j!==void 0?j.length:0,q=0;D.morphAttributes.position!==void 0&&(q=1),D.morphAttributes.normal!==void 0&&(q=2),D.morphAttributes.color!==void 0&&(q=3);let K,le,Z,oe;if(B){let Se=ch[B];K=Se.vertexShader,le=Se.fragmentShader}else K=M.vertexShader,le=M.fragmentShader,l.update(M),Z=l.getVertexShaderID(M),oe=l.getFragmentShaderID(M);let ae=t.getRenderTarget(),ve=M.alphaTest>0,ye=M.clearcoat>0,pe=M.iridescence>0;return{isWebGL2:c,shaderID:B,shaderName:M.type,vertexShader:K,fragmentShader:le,defines:M.defines,customVertexShaderID:Z,customFragmentShaderID:oe,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:p,instancing:L.isInstancedMesh===!0,instancingColor:L.isInstancedMesh===!0&&L.instanceColor!==null,supportsVertexTextures:d,outputEncoding:ae===null?t.outputEncoding:ae.isXRRenderTarget===!0?ae.texture.encoding:Mu,map:!!M.map,matcap:!!M.matcap,envMap:!!H,envMapMode:H&&H.mapping,envMapCubeUVHeight:z,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===mde,tangentSpaceNormalMap:M.normalMapType===fde,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===pi,clearcoat:ye,clearcoatMap:ye&&!!M.clearcoatMap,clearcoatRoughnessMap:ye&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:ye&&!!M.clearcoatNormalMap,iridescence:pe,iridescenceMap:pe&&!!M.iridescenceMap,iridescenceThicknessMap:pe&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===cm,alphaMap:!!M.alphaMap,alphaTest:ve,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!D.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!D.attributes.color&&D.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!I,useFog:M.fog===!0,fogExp2:I&&I.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:h,skinning:L.isSkinnedMesh===!0,morphTargets:D.morphAttributes.position!==void 0,morphNormals:D.morphAttributes.normal!==void 0,morphColors:D.morphAttributes.color!==void 0,morphTargetsCount:V,morphTextureStride:q,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&C.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:Mh,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===fa,flipSided:M.side===As,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){let R=[];if(M.shaderID?R.push(M.shaderID):(R.push(M.customVertexShaderID),R.push(M.customFragmentShaderID)),M.defines!==void 0)for(let C in M.defines)R.push(C),R.push(M.defines[C]);return M.isRawShaderMaterial===!1&&(y(R,M),v(R,M),R.push(t.outputEncoding)),R.push(M.customProgramCacheKey),R.join()}function y(M,R){M.push(R.precision),M.push(R.outputEncoding),M.push(R.envMapMode),M.push(R.envMapCubeUVHeight),M.push(R.combine),M.push(R.vertexUvs),M.push(R.fogExp2),M.push(R.sizeAttenuation),M.push(R.morphTargetsCount),M.push(R.morphAttributeCount),M.push(R.numDirLights),M.push(R.numPointLights),M.push(R.numSpotLights),M.push(R.numSpotLightMaps),M.push(R.numHemiLights),M.push(R.numRectAreaLights),M.push(R.numDirLightShadows),M.push(R.numPointLightShadows),M.push(R.numSpotLightShadows),M.push(R.numSpotLightShadowsWithMaps),M.push(R.shadowMapType),M.push(R.toneMapping),M.push(R.numClippingPlanes),M.push(R.numClipIntersection),M.push(R.depthPacking)}function v(M,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.map&&a.enable(4),R.matcap&&a.enable(5),R.envMap&&a.enable(6),R.lightMap&&a.enable(7),R.aoMap&&a.enable(8),R.emissiveMap&&a.enable(9),R.bumpMap&&a.enable(10),R.normalMap&&a.enable(11),R.objectSpaceNormalMap&&a.enable(12),R.tangentSpaceNormalMap&&a.enable(13),R.clearcoat&&a.enable(14),R.clearcoatMap&&a.enable(15),R.clearcoatRoughnessMap&&a.enable(16),R.clearcoatNormalMap&&a.enable(17),R.iridescence&&a.enable(18),R.iridescenceMap&&a.enable(19),R.iridescenceThicknessMap&&a.enable(20),R.displacementMap&&a.enable(21),R.specularMap&&a.enable(22),R.roughnessMap&&a.enable(23),R.metalnessMap&&a.enable(24),R.gradientMap&&a.enable(25),R.alphaMap&&a.enable(26),R.alphaTest&&a.enable(27),R.vertexColors&&a.enable(28),R.vertexAlphas&&a.enable(29),R.vertexUvs&&a.enable(30),R.vertexTangents&&a.enable(31),R.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),R.fog&&a.enable(0),R.useFog&&a.enable(1),R.flatShading&&a.enable(2),R.logarithmicDepthBuffer&&a.enable(3),R.skinning&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.morphColors&&a.enable(7),R.premultipliedAlpha&&a.enable(8),R.shadowMapEnabled&&a.enable(9),R.physicallyCorrectLights&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.useDepthPacking&&a.enable(13),R.dithering&&a.enable(14),R.specularIntensityMap&&a.enable(15),R.specularColorMap&&a.enable(16),R.transmission&&a.enable(17),R.transmissionMap&&a.enable(18),R.thicknessMap&&a.enable(19),R.sheen&&a.enable(20),R.sheenColorMap&&a.enable(21),R.sheenRoughnessMap&&a.enable(22),R.decodeVideoTexture&&a.enable(23),R.opaque&&a.enable(24),M.push(a.mask)}function b(M){let R=f[M.type],C;if(R){let T=ch[R];C=U0.clone(T.uniforms)}else C=M.uniforms;return C}function _(M,R){let C;for(let T=0,L=u.length;T<L;T++){let I=u[T];if(I.cacheKey===R){C=I,++C.usedTimes;break}}return C===void 0&&(C=new tye(t,R,M,s),u.push(C)),C}function A(M){if(--M.usedTimes===0){let R=u.indexOf(M);u[R]=u[u.length-1],u.pop(),M.destroy()}}function S(M){l.remove(M)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:b,acquireProgram:_,releaseProgram:A,releaseShaderCache:S,programs:u,dispose:E}}function oye(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function r(s,o,a){t.get(s)[o]=a}function n(){t=new WeakMap}return{get:e,remove:i,update:r,dispose:n}}function aye(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Fj(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function zj(){let t=[],e=0,i=[],r=[],n=[];function s(){e=0,i.length=0,r.length=0,n.length=0}function o(h,d,p,f,m,g){let y=t[e];return y===void 0?(y={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:m,group:g},t[e]=y):(y.id=h.id,y.object=h,y.geometry=d,y.material=p,y.groupOrder=f,y.renderOrder=h.renderOrder,y.z=m,y.group=g),e++,y}function a(h,d,p,f,m,g){let y=o(h,d,p,f,m,g);p.transmission>0?r.push(y):p.transparent===!0?n.push(y):i.push(y)}function l(h,d,p,f,m,g){let y=o(h,d,p,f,m,g);p.transmission>0?r.unshift(y):p.transparent===!0?n.unshift(y):i.unshift(y)}function u(h,d){i.length>1&&i.sort(h||aye),r.length>1&&r.sort(d||Fj),n.length>1&&n.sort(d||Fj)}function c(){for(let h=e,d=t.length;h<d;h++){let p=t[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:i,transmissive:r,transparent:n,init:s,push:a,unshift:l,finish:c,sort:u}}function lye(){let t=new WeakMap;function e(r,n){let s=t.get(r),o;return s===void 0?(o=new zj,t.set(r,[o])):n>=s.length?(o=new zj,s.push(o)):o=s[n],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function uye(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new N,color:new Xt};break;case"SpotLight":i={position:new N,direction:new N,color:new Xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new N,color:new Xt,distance:0,decay:0};break;case"HemisphereLight":i={direction:new N,skyColor:new Xt,groundColor:new Xt};break;case"RectAreaLight":i={color:new Xt,position:new N,halfWidth:new N,halfHeight:new N};break}return t[e.id]=i,i}}}function hye(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}var cye=0;function dye(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function pye(t,e){let i=new uye,r=hye(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)n.probe.push(new N);let s=new N,o=new lt,a=new lt;function l(c,h){let d=0,p=0,f=0;for(let T=0;T<9;T++)n.probe[T].set(0,0,0);let m=0,g=0,y=0,v=0,b=0,_=0,A=0,S=0,E=0,M=0;c.sort(dye);let R=h!==!0?Math.PI:1;for(let T=0,L=c.length;T<L;T++){let I=c[T],D=I.color,F=I.intensity,H=I.distance,z=I.shadow&&I.shadow.map?I.shadow.map.texture:null;if(I.isAmbientLight)d+=D.r*F*R,p+=D.g*F*R,f+=D.b*F*R;else if(I.isLightProbe)for(let B=0;B<9;B++)n.probe[B].addScaledVector(I.sh.coefficients[B],F);else if(I.isDirectionalLight){let B=i.get(I);if(B.color.copy(I.color).multiplyScalar(I.intensity*R),I.castShadow){let j=I.shadow,V=r.get(I);V.shadowBias=j.bias,V.shadowNormalBias=j.normalBias,V.shadowRadius=j.radius,V.shadowMapSize=j.mapSize,n.directionalShadow[m]=V,n.directionalShadowMap[m]=z,n.directionalShadowMatrix[m]=I.shadow.matrix,_++}n.directional[m]=B,m++}else if(I.isSpotLight){let B=i.get(I);B.position.setFromMatrixPosition(I.matrixWorld),B.color.copy(D).multiplyScalar(F*R),B.distance=H,B.coneCos=Math.cos(I.angle),B.penumbraCos=Math.cos(I.angle*(1-I.penumbra)),B.decay=I.decay,n.spot[y]=B;let j=I.shadow;if(I.map&&(n.spotLightMap[E]=I.map,E++,j.updateMatrices(I),I.castShadow&&M++),n.spotLightMatrix[y]=j.matrix,I.castShadow){let V=r.get(I);V.shadowBias=j.bias,V.shadowNormalBias=j.normalBias,V.shadowRadius=j.radius,V.shadowMapSize=j.mapSize,n.spotShadow[y]=V,n.spotShadowMap[y]=z,S++}y++}else if(I.isRectAreaLight){let B=i.get(I);B.color.copy(D).multiplyScalar(F),B.halfWidth.set(I.width*.5,0,0),B.halfHeight.set(0,I.height*.5,0),n.rectArea[v]=B,v++}else if(I.isPointLight){let B=i.get(I);if(B.color.copy(I.color).multiplyScalar(I.intensity*R),B.distance=I.distance,B.decay=I.decay,I.castShadow){let j=I.shadow,V=r.get(I);V.shadowBias=j.bias,V.shadowNormalBias=j.normalBias,V.shadowRadius=j.radius,V.shadowMapSize=j.mapSize,V.shadowCameraNear=j.camera.near,V.shadowCameraFar=j.camera.far,n.pointShadow[g]=V,n.pointShadowMap[g]=z,n.pointShadowMatrix[g]=I.shadow.matrix,A++}n.point[g]=B,g++}else if(I.isHemisphereLight){let B=i.get(I);B.skyColor.copy(I.color).multiplyScalar(F*R),B.groundColor.copy(I.groundColor).multiplyScalar(F*R),n.hemi[b]=B,b++}}v>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=vt.LTC_FLOAT_1,n.rectAreaLTC2=vt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=vt.LTC_HALF_1,n.rectAreaLTC2=vt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=f;let C=n.hash;(C.directionalLength!==m||C.pointLength!==g||C.spotLength!==y||C.rectAreaLength!==v||C.hemiLength!==b||C.numDirectionalShadows!==_||C.numPointShadows!==A||C.numSpotShadows!==S||C.numSpotMaps!==E)&&(n.directional.length=m,n.spot.length=y,n.rectArea.length=v,n.point.length=g,n.hemi.length=b,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=A,n.pointShadowMap.length=A,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=A,n.spotLightMatrix.length=S+E-M,n.spotLightMap.length=E,n.numSpotLightShadowsWithMaps=M,C.directionalLength=m,C.pointLength=g,C.spotLength=y,C.rectAreaLength=v,C.hemiLength=b,C.numDirectionalShadows=_,C.numPointShadows=A,C.numSpotShadows=S,C.numSpotMaps=E,n.version=cye++)}function u(c,h){let d=0,p=0,f=0,m=0,g=0,y=h.matrixWorldInverse;for(let v=0,b=c.length;v<b;v++){let _=c[v];if(_.isDirectionalLight){let A=n.directional[d];A.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),d++}else if(_.isSpotLight){let A=n.spot[f];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),A.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),f++}else if(_.isRectAreaLight){let A=n.rectArea[m];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),a.identity(),o.copy(_.matrixWorld),o.premultiply(y),a.extractRotation(o),A.halfWidth.set(_.width*.5,0,0),A.halfHeight.set(0,_.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),m++}else if(_.isPointLight){let A=n.point[p];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),p++}else if(_.isHemisphereLight){let A=n.hemi[g];A.direction.setFromMatrixPosition(_.matrixWorld),A.direction.transformDirection(y),g++}}}return{setup:l,setupView:u,state:n}}function Hj(t,e){let i=new pye(t,e),r=[],n=[];function s(){r.length=0,n.length=0}function o(c){r.push(c)}function a(c){n.push(c)}function l(c){i.setup(r,c)}function u(c){i.setupView(r,c)}return{init:s,state:{lightsArray:r,shadowsArray:n,lights:i},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function fye(t,e){let i=new WeakMap;function r(s,o=0){let a=i.get(s),l;return a===void 0?(l=new Hj(t,e),i.set(s,[l])):o>=a.length?(l=new Hj(t,e),a.push(l)):l=a[o],l}function n(){i=new WeakMap}return{get:r,dispose:n}}var LQ=class extends Y1{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ld,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},mye=class extends Y1{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new N,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},gye=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,yye=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function vye(t,e,i){let r=new EF,n=new me,s=new me,o=new si,a=new LQ({depthPacking:xQ}),l=new mye,u={},c=i.maxTextureSize,h={[Eu]:As,[As]:Eu,[fa]:fa},d=new er({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new me},radius:{value:4}},vertexShader:gye,fragmentShader:yye}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new Ht;f.setAttribute("position",new ei(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new zn(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=bF,this.render=function(_,A,S){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||_.length===0)return;let E=t.getRenderTarget(),M=t.getActiveCubeFace(),R=t.getActiveMipmapLevel(),C=t.state;C.setBlending(Gn),C.buffers.color.setClear(1,1,1,1),C.buffers.depth.setTest(!0),C.setScissorTest(!1);for(let T=0,L=_.length;T<L;T++){let I=_[T],D=I.shadow;if(D===void 0){console.warn("THREE.WebGLShadowMap:",I,"has no shadow.");continue}if(D.autoUpdate===!1&&D.needsUpdate===!1)continue;n.copy(D.mapSize);let F=D.getFrameExtents();if(n.multiply(F),s.copy(D.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(s.x=Math.floor(c/F.x),n.x=s.x*F.x,D.mapSize.x=s.x),n.y>c&&(s.y=Math.floor(c/F.y),n.y=s.y*F.y,D.mapSize.y=s.y)),D.map===null){let z=this.type!==Ux?{minFilter:Zi,magFilter:Zi}:{};D.map=new $i(n.x,n.y,z),D.map.texture.name=I.name+".shadowMap",D.camera.updateProjectionMatrix()}t.setRenderTarget(D.map),t.clear();let H=D.getViewportCount();for(let z=0;z<H;z++){let B=D.getViewport(z);o.set(s.x*B.x,s.y*B.y,s.x*B.z,s.y*B.w),C.viewport(o),D.updateMatrices(I,z),r=D.getFrustum(),b(A,S,D.camera,I,this.type)}D.isPointLightShadow!==!0&&this.type===Ux&&y(D,S),D.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(E,M,R)};function y(_,A){let S=e.update(m);d.defines.VSM_SAMPLES!==_.blurSamples&&(d.defines.VSM_SAMPLES=_.blurSamples,p.defines.VSM_SAMPLES=_.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),_.mapPass===null&&(_.mapPass=new $i(n.x,n.y)),d.uniforms.shadow_pass.value=_.map.texture,d.uniforms.resolution.value=_.mapSize,d.uniforms.radius.value=_.radius,t.setRenderTarget(_.mapPass),t.clear(),t.renderBufferDirect(A,null,S,d,m,null),p.uniforms.shadow_pass.value=_.mapPass.texture,p.uniforms.resolution.value=_.mapSize,p.uniforms.radius.value=_.radius,t.setRenderTarget(_.map),t.clear(),t.renderBufferDirect(A,null,S,p,m,null)}function v(_,A,S,E,M,R){let C=null,T=S.isPointLight===!0?_.customDistanceMaterial:_.customDepthMaterial;if(T!==void 0)C=T;else if(C=S.isPointLight===!0?l:a,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){let L=C.uuid,I=A.uuid,D=u[L];D===void 0&&(D={},u[L]=D);let F=D[I];F===void 0&&(F=C.clone(),D[I]=F),C=F}return C.visible=A.visible,C.wireframe=A.wireframe,R===Ux?C.side=A.shadowSide!==null?A.shadowSide:A.side:C.side=A.shadowSide!==null?A.shadowSide:h[A.side],C.alphaMap=A.alphaMap,C.alphaTest=A.alphaTest,C.map=A.map,C.clipShadows=A.clipShadows,C.clippingPlanes=A.clippingPlanes,C.clipIntersection=A.clipIntersection,C.displacementMap=A.displacementMap,C.displacementScale=A.displacementScale,C.displacementBias=A.displacementBias,C.wireframeLinewidth=A.wireframeLinewidth,C.linewidth=A.linewidth,S.isPointLight===!0&&C.isMeshDistanceMaterial===!0&&(C.referencePosition.setFromMatrixPosition(S.matrixWorld),C.nearDistance=E,C.farDistance=M),C}function b(_,A,S,E,M){if(_.visible===!1)return;if(_.layers.test(A.layers)&&(_.isMesh||_.isLine||_.isPoints)&&(_.castShadow||_.receiveShadow&&M===Ux)&&(!_.frustumCulled||r.intersectsObject(_))){_.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,_.matrixWorld);let C=e.update(_),T=_.material;if(Array.isArray(T)){let L=C.groups;for(let I=0,D=L.length;I<D;I++){let F=L[I],H=T[F.materialIndex];if(H&&H.visible){let z=v(_,H,E,S.near,S.far,M);t.renderBufferDirect(S,null,C,z,_,F)}}}else if(T.visible){let L=v(_,T,E,S.near,S.far,M);t.renderBufferDirect(S,null,C,L,_,null)}}let R=_.children;for(let C=0,T=R.length;C<T;C++)b(R[C],A,S,E,M)}}function bye(t,e,i){let r=i.isWebGL2;function n(){let xe=!1,Ge=new si,ie=null,He=new si(0,0,0,0);return{setMask:function(Ye){ie!==Ye&&!xe&&(t.colorMask(Ye,Ye,Ye,Ye),ie=Ye)},setLocked:function(Ye){xe=Ye},setClear:function(Ye,dt,At,ri,Si){Si===!0&&(Ye*=ri,dt*=ri,At*=ri),Ge.set(Ye,dt,At,ri),He.equals(Ge)===!1&&(t.clearColor(Ye,dt,At,ri),He.copy(Ge))},reset:function(){xe=!1,ie=null,He.set(-1,0,0,0)}}}function s(){let xe=!1,Ge=null,ie=null,He=null;return{setTest:function(Ye){Ye?ve(2929):ye(2929)},setMask:function(Ye){Ge!==Ye&&!xe&&(t.depthMask(Ye),Ge=Ye)},setFunc:function(Ye){if(ie!==Ye){switch(Ye){case Fce:t.depthFunc(512);break;case zce:t.depthFunc(519);break;case Hce:t.depthFunc(513);break;case VL:t.depthFunc(515);break;case Gce:t.depthFunc(514);break;case Vce:t.depthFunc(518);break;case jce:t.depthFunc(516);break;case Wce:t.depthFunc(517);break;default:t.depthFunc(515)}ie=Ye}},setLocked:function(Ye){xe=Ye},setClear:function(Ye){He!==Ye&&(t.clearDepth(Ye),He=Ye)},reset:function(){xe=!1,Ge=null,ie=null,He=null}}}function o(){let xe=!1,Ge=null,ie=null,He=null,Ye=null,dt=null,At=null,ri=null,Si=null;return{setTest:function(li){xe||(li?ve(2960):ye(2960))},setMask:function(li){Ge!==li&&!xe&&(t.stencilMask(li),Ge=li)},setFunc:function(li,yr,gi){(ie!==li||He!==yr||Ye!==gi)&&(t.stencilFunc(li,yr,gi),ie=li,He=yr,Ye=gi)},setOp:function(li,yr,gi){(dt!==li||At!==yr||ri!==gi)&&(t.stencilOp(li,yr,gi),dt=li,At=yr,ri=gi)},setLocked:function(li){xe=li},setClear:function(li){Si!==li&&(t.clearStencil(li),Si=li)},reset:function(){xe=!1,Ge=null,ie=null,He=null,Ye=null,dt=null,At=null,ri=null,Si=null}}}let a=new n,l=new s,u=new o,c=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,m=[],g=null,y=!1,v=null,b=null,_=null,A=null,S=null,E=null,M=null,R=!1,C=null,T=null,L=null,I=null,D=null,F=t.getParameter(35661),H=!1,z=0,B=t.getParameter(7938);B.indexOf("WebGL")!==-1?(z=parseFloat(/^WebGL (\d)/.exec(B)[1]),H=z>=1):B.indexOf("OpenGL ES")!==-1&&(z=parseFloat(/^OpenGL ES (\d)/.exec(B)[1]),H=z>=2);let j=null,V={},q=t.getParameter(3088),K=t.getParameter(2978),le=new si().fromArray(q),Z=new si().fromArray(K);function oe(xe,Ge,ie){let He=new Uint8Array(4),Ye=t.createTexture();t.bindTexture(xe,Ye),t.texParameteri(xe,10241,9728),t.texParameteri(xe,10240,9728);for(let dt=0;dt<ie;dt++)t.texImage2D(Ge+dt,0,6408,1,1,0,6408,5121,He);return Ye}let ae={};ae[3553]=oe(3553,3553,1),ae[34067]=oe(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),ve(2929),l.setFunc(VL),Re(!1),Xe(DV),ve(2884),Me(Gn);function ve(xe){d[xe]!==!0&&(t.enable(xe),d[xe]=!0)}function ye(xe){d[xe]!==!1&&(t.disable(xe),d[xe]=!1)}function pe(xe,Ge){return p[xe]!==Ge?(t.bindFramebuffer(xe,Ge),p[xe]=Ge,r&&(xe===36009&&(p[36160]=Ge),xe===36160&&(p[36009]=Ge)),!0):!1}function Se(xe,Ge){let ie=m,He=!1;if(xe)if(ie=f.get(Ge),ie===void 0&&(ie=[],f.set(Ge,ie)),xe.isWebGLMultipleRenderTargets){let Ye=xe.texture;if(ie.length!==Ye.length||ie[0]!==36064){for(let dt=0,At=Ye.length;dt<At;dt++)ie[dt]=36064+dt;ie.length=Ye.length,He=!0}}else ie[0]!==36064&&(ie[0]=36064,He=!0);else ie[0]!==1029&&(ie[0]=1029,He=!0);He&&(i.isWebGL2?t.drawBuffers(ie):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ie))}function be(xe){return g!==xe?(t.useProgram(xe),g=xe,!0):!1}let ee={[Uy]:32774,[Pce]:32778,[Tce]:32779};if(r)ee[OV]=32775,ee[UV]=32776;else{let xe=e.get("EXT_blend_minmax");xe!==null&&(ee[OV]=xe.MIN_EXT,ee[UV]=xe.MAX_EXT)}let _e={[Rce]:0,[kce]:1,[Dce]:768,[dQ]:770,[Nce]:776,[Oce]:774,[Lce]:772,[Ice]:769,[pQ]:771,[Uce]:775,[Bce]:773};function Me(xe,Ge,ie,He,Ye,dt,At,ri){if(xe===Gn){y===!0&&(ye(3042),y=!1);return}if(y===!1&&(ve(3042),y=!0),xe!==Cce){if(xe!==v||ri!==R){if((b!==Uy||S!==Uy)&&(t.blendEquation(32774),b=Uy,S=Uy),ri)switch(xe){case cm:t.blendFuncSeparate(1,771,1,771);break;case IV:t.blendFunc(1,1);break;case LV:t.blendFuncSeparate(0,769,0,1);break;case BV:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}else switch(xe){case cm:t.blendFuncSeparate(770,771,1,771);break;case IV:t.blendFunc(770,1);break;case LV:t.blendFuncSeparate(0,769,0,1);break;case BV:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}_=null,A=null,E=null,M=null,v=xe,R=ri}return}Ye=Ye||Ge,dt=dt||ie,At=At||He,(Ge!==b||Ye!==S)&&(t.blendEquationSeparate(ee[Ge],ee[Ye]),b=Ge,S=Ye),(ie!==_||He!==A||dt!==E||At!==M)&&(t.blendFuncSeparate(_e[ie],_e[He],_e[dt],_e[At]),_=ie,A=He,E=dt,M=At),v=xe,R=!1}function Ce(xe,Ge){xe.side===fa?ye(2884):ve(2884);let ie=xe.side===As;Ge&&(ie=!ie),Re(ie),xe.blending===cm&&xe.transparent===!1?Me(Gn):Me(xe.blending,xe.blendEquation,xe.blendSrc,xe.blendDst,xe.blendEquationAlpha,xe.blendSrcAlpha,xe.blendDstAlpha,xe.premultipliedAlpha),l.setFunc(xe.depthFunc),l.setTest(xe.depthTest),l.setMask(xe.depthWrite),a.setMask(xe.colorWrite);let He=xe.stencilWrite;u.setTest(He),He&&(u.setMask(xe.stencilWriteMask),u.setFunc(xe.stencilFunc,xe.stencilRef,xe.stencilFuncMask),u.setOp(xe.stencilFail,xe.stencilZFail,xe.stencilZPass)),$(xe.polygonOffset,xe.polygonOffsetFactor,xe.polygonOffsetUnits),xe.alphaToCoverage===!0?ve(32926):ye(32926)}function Re(xe){C!==xe&&(xe?t.frontFace(2304):t.frontFace(2305),C=xe)}function Xe(xe){xe!==Ace?(ve(2884),xe!==T&&(xe===DV?t.cullFace(1029):xe===Ece?t.cullFace(1028):t.cullFace(1032))):ye(2884),T=xe}function Oe(xe){xe!==L&&(H&&t.lineWidth(xe),L=xe)}function $(xe,Ge,ie){xe?(ve(32823),(I!==Ge||D!==ie)&&(t.polygonOffset(Ge,ie),I=Ge,D=ie)):ye(32823)}function J(xe){xe?ve(3089):ye(3089)}function we(xe){xe===void 0&&(xe=33984+F-1),j!==xe&&(t.activeTexture(xe),j=xe)}function te(xe,Ge,ie){ie===void 0&&(j===null?ie=33984+F-1:ie=j);let He=V[ie];He===void 0&&(He={type:void 0,texture:void 0},V[ie]=He),(He.type!==xe||He.texture!==Ge)&&(j!==ie&&(t.activeTexture(ie),j=ie),t.bindTexture(xe,Ge||ae[xe]),He.type=xe,He.texture=Ge)}function Y(){let xe=V[j];xe!==void 0&&xe.type!==void 0&&(t.bindTexture(xe.type,null),xe.type=void 0,xe.texture=void 0)}function ce(){try{t.compressedTexImage2D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Le(){try{t.compressedTexImage3D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function X(){try{t.texSubImage2D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function Ue(){try{t.texSubImage3D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function et(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ze(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ge(){try{t.texStorage2D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ct(){try{t.texStorage3D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function rt(){try{t.texImage2D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ut(){try{t.texImage3D.apply(t,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ht(xe){le.equals(xe)===!1&&(t.scissor(xe.x,xe.y,xe.z,xe.w),le.copy(xe))}function tt(xe){Z.equals(xe)===!1&&(t.viewport(xe.x,xe.y,xe.z,xe.w),Z.copy(xe))}function pt(xe,Ge){let ie=h.get(Ge);ie===void 0&&(ie=new WeakMap,h.set(Ge,ie));let He=ie.get(xe);He===void 0&&(He=t.getUniformBlockIndex(Ge,xe.name),ie.set(xe,He))}function Nt(xe,Ge){let ie=h.get(Ge).get(xe);c.get(Ge)!==ie&&(t.uniformBlockBinding(Ge,ie,xe.__bindingPointIndex),c.set(Ge,ie))}function ti(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),r===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},j=null,V={},p={},f=new WeakMap,m=[],g=null,y=!1,v=null,b=null,_=null,A=null,S=null,E=null,M=null,R=!1,C=null,T=null,L=null,I=null,D=null,le.set(0,0,t.canvas.width,t.canvas.height),Z.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:ve,disable:ye,bindFramebuffer:pe,drawBuffers:Se,useProgram:be,setBlending:Me,setMaterial:Ce,setFlipSided:Re,setCullFace:Xe,setLineWidth:Oe,setPolygonOffset:$,setScissorTest:J,activeTexture:we,bindTexture:te,unbindTexture:Y,compressedTexImage2D:ce,compressedTexImage3D:Le,texImage2D:rt,texImage3D:ut,updateUBOMapping:pt,uniformBlockBinding:Nt,texStorage2D:ge,texStorage3D:ct,texSubImage2D:X,texSubImage3D:Ue,compressedTexSubImage2D:et,compressedTexSubImage3D:ze,scissor:ht,viewport:tt,reset:ti}}function xye(t,e,i,r,n,s,o){let a=n.isWebGL2,l=n.maxTextures,u=n.maxCubemapSize,c=n.maxTextureSize,h=n.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,m,g=new WeakMap,y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(te,Y){return y?new OffscreenCanvas(te,Y):Ww("canvas")}function b(te,Y,ce,Le){let X=1;if((te.width>Le||te.height>Le)&&(X=Le/Math.max(te.width,te.height)),X<1||Y===!0)if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap){let Ue=Y?WC:Math.floor,et=Ue(X*te.width),ze=Ue(X*te.height);m===void 0&&(m=v(et,ze));let ge=ce?v(et,ze):m;return ge.width=et,ge.height=ze,ge.getContext("2d").drawImage(te,0,0,et,ze),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+te.width+"x"+te.height+") to ("+et+"x"+ze+")."),ge}else return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+te.width+"x"+te.height+")."),te;return te}function _(te){return KL(te.width)&&KL(te.height)}function A(te){return a?!1:te.wrapS!==kr||te.wrapT!==kr||te.minFilter!==Zi&&te.minFilter!==mi}function S(te,Y){return te.generateMipmaps&&Y&&te.minFilter!==Zi&&te.minFilter!==mi}function E(te){t.generateMipmap(te)}function M(te,Y,ce,Le,X=!1){if(a===!1)return Y;if(te!==null){if(t[te]!==void 0)return t[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let Ue=Y;return Y===6403&&(ce===5126&&(Ue=33326),ce===5131&&(Ue=33325),ce===5121&&(Ue=33321)),Y===33319&&(ce===5126&&(Ue=33328),ce===5131&&(Ue=33327),ce===5121&&(Ue=33323)),Y===6408&&(ce===5126&&(Ue=34836),ce===5131&&(Ue=34842),ce===5121&&(Ue=Le===pi&&X===!1?35907:32856),ce===32819&&(Ue=32854),ce===32820&&(Ue=32855)),(Ue===33325||Ue===33326||Ue===33327||Ue===33328||Ue===34842||Ue===34836)&&e.get("EXT_color_buffer_float"),Ue}function R(te,Y,ce){return S(te,ce)===!0||te.isFramebufferTexture&&te.minFilter!==Zi&&te.minFilter!==mi?Math.log2(Math.max(Y.width,Y.height))+1:te.mipmaps!==void 0&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?Y.mipmaps.length:1}function C(te){return te===Zi||te===NV||te===Ik?9728:9729}function T(te){let Y=te.target;Y.removeEventListener("dispose",T),I(Y),Y.isVideoTexture&&f.delete(Y)}function L(te){let Y=te.target;Y.removeEventListener("dispose",L),F(Y)}function I(te){let Y=r.get(te);if(Y.__webglInit===void 0)return;let ce=te.source,Le=g.get(ce);if(Le){let X=Le[Y.__cacheKey];X.usedTimes--,X.usedTimes===0&&D(te),Object.keys(Le).length===0&&g.delete(ce)}r.remove(te)}function D(te){let Y=r.get(te);t.deleteTexture(Y.__webglTexture);let ce=te.source,Le=g.get(ce);delete Le[Y.__cacheKey],o.memory.textures--}function F(te){let Y=te.texture,ce=r.get(te),Le=r.get(Y);if(Le.__webglTexture!==void 0&&(t.deleteTexture(Le.__webglTexture),o.memory.textures--),te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let X=0;X<6;X++)t.deleteFramebuffer(ce.__webglFramebuffer[X]),ce.__webglDepthbuffer&&t.deleteRenderbuffer(ce.__webglDepthbuffer[X]);else{if(t.deleteFramebuffer(ce.__webglFramebuffer),ce.__webglDepthbuffer&&t.deleteRenderbuffer(ce.__webglDepthbuffer),ce.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ce.__webglMultisampledFramebuffer),ce.__webglColorRenderbuffer)for(let X=0;X<ce.__webglColorRenderbuffer.length;X++)ce.__webglColorRenderbuffer[X]&&t.deleteRenderbuffer(ce.__webglColorRenderbuffer[X]);ce.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ce.__webglDepthRenderbuffer)}if(te.isWebGLMultipleRenderTargets)for(let X=0,Ue=Y.length;X<Ue;X++){let et=r.get(Y[X]);et.__webglTexture&&(t.deleteTexture(et.__webglTexture),o.memory.textures--),r.remove(Y[X])}r.remove(Y),r.remove(te)}let H=0;function z(){H=0}function B(){let te=H;return te>=l&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+l),H+=1,te}function j(te){let Y=[];return Y.push(te.wrapS),Y.push(te.wrapT),Y.push(te.wrapR||0),Y.push(te.magFilter),Y.push(te.minFilter),Y.push(te.anisotropy),Y.push(te.internalFormat),Y.push(te.format),Y.push(te.type),Y.push(te.generateMipmaps),Y.push(te.premultiplyAlpha),Y.push(te.flipY),Y.push(te.unpackAlignment),Y.push(te.encoding),Y.join()}function V(te,Y){let ce=r.get(te);if(te.isVideoTexture&&J(te),te.isRenderTargetTexture===!1&&te.version>0&&ce.__version!==te.version){let Le=te.image;if(Le===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Le.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ye(ce,te,Y);return}}i.bindTexture(3553,ce.__webglTexture,33984+Y)}function q(te,Y){let ce=r.get(te);if(te.version>0&&ce.__version!==te.version){ye(ce,te,Y);return}i.bindTexture(35866,ce.__webglTexture,33984+Y)}function K(te,Y){let ce=r.get(te);if(te.version>0&&ce.__version!==te.version){ye(ce,te,Y);return}i.bindTexture(32879,ce.__webglTexture,33984+Y)}function le(te,Y){let ce=r.get(te);if(te.version>0&&ce.__version!==te.version){pe(ce,te,Y);return}i.bindTexture(34067,ce.__webglTexture,33984+Y)}let Z={[Oc]:10497,[kr]:33071,[qL]:33648},oe={[Zi]:9728,[NV]:9984,[Ik]:9986,[mi]:9729,[$ce]:9985,[$v]:9987};function ae(te,Y,ce){if(ce?(t.texParameteri(te,10242,Z[Y.wrapS]),t.texParameteri(te,10243,Z[Y.wrapT]),(te===32879||te===35866)&&t.texParameteri(te,32882,Z[Y.wrapR]),t.texParameteri(te,10240,oe[Y.magFilter]),t.texParameteri(te,10241,oe[Y.minFilter])):(t.texParameteri(te,10242,33071),t.texParameteri(te,10243,33071),(te===32879||te===35866)&&t.texParameteri(te,32882,33071),(Y.wrapS!==kr||Y.wrapT!==kr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(te,10240,C(Y.magFilter)),t.texParameteri(te,10241,C(Y.minFilter)),Y.minFilter!==Zi&&Y.minFilter!==mi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let Le=e.get("EXT_texture_filter_anisotropic");if(Y.magFilter===Zi||Y.minFilter!==Ik&&Y.minFilter!==$v||Y.type===Fn&&e.has("OES_texture_float_linear")===!1||a===!1&&Y.type===Im&&e.has("OES_texture_half_float_linear")===!1)return;(Y.anisotropy>1||r.get(Y).__currentAnisotropy)&&(t.texParameterf(te,Le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Y.anisotropy,n.getMaxAnisotropy())),r.get(Y).__currentAnisotropy=Y.anisotropy)}}function ve(te,Y){let ce=!1;te.__webglInit===void 0&&(te.__webglInit=!0,Y.addEventListener("dispose",T));let Le=Y.source,X=g.get(Le);X===void 0&&(X={},g.set(Le,X));let Ue=j(Y);if(Ue!==te.__cacheKey){X[Ue]===void 0&&(X[Ue]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,ce=!0),X[Ue].usedTimes++;let et=X[te.__cacheKey];et!==void 0&&(X[te.__cacheKey].usedTimes--,et.usedTimes===0&&D(Y)),te.__cacheKey=Ue,te.__webglTexture=X[Ue].texture}return ce}function ye(te,Y,ce){let Le=3553;(Y.isDataArrayTexture||Y.isCompressedArrayTexture)&&(Le=35866),Y.isData3DTexture&&(Le=32879);let X=ve(te,Y),Ue=Y.source;i.bindTexture(Le,te.__webglTexture,33984+ce);let et=r.get(Ue);if(Ue.version!==et.__version||X===!0){i.activeTexture(33984+ce),t.pixelStorei(37440,Y.flipY),t.pixelStorei(37441,Y.premultiplyAlpha),t.pixelStorei(3317,Y.unpackAlignment),t.pixelStorei(37443,0);let ze=A(Y)&&_(Y.image)===!1,ge=b(Y.image,ze,!1,c);ge=we(Y,ge);let ct=_(ge)||a,rt=s.convert(Y.format,Y.encoding),ut=s.convert(Y.type),ht=M(Y.internalFormat,rt,ut,Y.encoding,Y.isVideoTexture);ae(Le,Y,ct);let tt,pt=Y.mipmaps,Nt=a&&Y.isVideoTexture!==!0,ti=et.__version===void 0||X===!0,xe=R(Y,ge,ct);if(Y.isDepthTexture)ht=6402,a?Y.type===Fn?ht=36012:Y.type===Uc?ht=33190:Y.type===dm?ht=35056:ht=33189:Y.type===Fn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Y.format===pm&&ht===6402&&Y.type!==gQ&&Y.type!==Uc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Y.type=Uc,ut=s.convert(Y.type)),Y.format===Lm&&ht===6402&&(ht=34041,Y.type!==dm&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Y.type=dm,ut=s.convert(Y.type))),ti&&(Nt?i.texStorage2D(3553,1,ht,ge.width,ge.height):i.texImage2D(3553,0,ht,ge.width,ge.height,0,rt,ut,null));else if(Y.isDataTexture)if(pt.length>0&&ct){Nt&&ti&&i.texStorage2D(3553,xe,ht,pt[0].width,pt[0].height);for(let Ge=0,ie=pt.length;Ge<ie;Ge++)tt=pt[Ge],Nt?i.texSubImage2D(3553,Ge,0,0,tt.width,tt.height,rt,ut,tt.data):i.texImage2D(3553,Ge,ht,tt.width,tt.height,0,rt,ut,tt.data);Y.generateMipmaps=!1}else Nt?(ti&&i.texStorage2D(3553,xe,ht,ge.width,ge.height),i.texSubImage2D(3553,0,0,0,ge.width,ge.height,rt,ut,ge.data)):i.texImage2D(3553,0,ht,ge.width,ge.height,0,rt,ut,ge.data);else if(Y.isCompressedTexture)if(Y.isCompressedArrayTexture){Nt&&ti&&i.texStorage3D(35866,xe,ht,pt[0].width,pt[0].height,ge.depth);for(let Ge=0,ie=pt.length;Ge<ie;Ge++)tt=pt[Ge],Y.format!==_s?rt!==null?Nt?i.compressedTexSubImage3D(35866,Ge,0,0,0,tt.width,tt.height,ge.depth,rt,tt.data,0,0):i.compressedTexImage3D(35866,Ge,ht,tt.width,tt.height,ge.depth,0,tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Nt?i.texSubImage3D(35866,Ge,0,0,0,tt.width,tt.height,ge.depth,rt,ut,tt.data):i.texImage3D(35866,Ge,ht,tt.width,tt.height,ge.depth,0,rt,ut,tt.data)}else{Nt&&ti&&i.texStorage2D(3553,xe,ht,pt[0].width,pt[0].height);for(let Ge=0,ie=pt.length;Ge<ie;Ge++)tt=pt[Ge],Y.format!==_s?rt!==null?Nt?i.compressedTexSubImage2D(3553,Ge,0,0,tt.width,tt.height,rt,tt.data):i.compressedTexImage2D(3553,Ge,ht,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Nt?i.texSubImage2D(3553,Ge,0,0,tt.width,tt.height,rt,ut,tt.data):i.texImage2D(3553,Ge,ht,tt.width,tt.height,0,rt,ut,tt.data)}else if(Y.isDataArrayTexture)Nt?(ti&&i.texStorage3D(35866,xe,ht,ge.width,ge.height,ge.depth),i.texSubImage3D(35866,0,0,0,0,ge.width,ge.height,ge.depth,rt,ut,ge.data)):i.texImage3D(35866,0,ht,ge.width,ge.height,ge.depth,0,rt,ut,ge.data);else if(Y.isData3DTexture)Nt?(ti&&i.texStorage3D(32879,xe,ht,ge.width,ge.height,ge.depth),i.texSubImage3D(32879,0,0,0,0,ge.width,ge.height,ge.depth,rt,ut,ge.data)):i.texImage3D(32879,0,ht,ge.width,ge.height,ge.depth,0,rt,ut,ge.data);else if(Y.isFramebufferTexture){if(ti)if(Nt)i.texStorage2D(3553,xe,ht,ge.width,ge.height);else{let Ge=ge.width,ie=ge.height;for(let He=0;He<xe;He++)i.texImage2D(3553,He,ht,Ge,ie,0,rt,ut,null),Ge>>=1,ie>>=1}}else if(pt.length>0&&ct){Nt&&ti&&i.texStorage2D(3553,xe,ht,pt[0].width,pt[0].height);for(let Ge=0,ie=pt.length;Ge<ie;Ge++)tt=pt[Ge],Nt?i.texSubImage2D(3553,Ge,0,0,rt,ut,tt):i.texImage2D(3553,Ge,ht,rt,ut,tt);Y.generateMipmaps=!1}else Nt?(ti&&i.texStorage2D(3553,xe,ht,ge.width,ge.height),i.texSubImage2D(3553,0,0,0,rt,ut,ge)):i.texImage2D(3553,0,ht,rt,ut,ge);S(Y,ct)&&E(Le),et.__version=Ue.version,Y.onUpdate&&Y.onUpdate(Y)}te.__version=Y.version}function pe(te,Y,ce){if(Y.image.length!==6)return;let Le=ve(te,Y),X=Y.source;i.bindTexture(34067,te.__webglTexture,33984+ce);let Ue=r.get(X);if(X.version!==Ue.__version||Le===!0){i.activeTexture(33984+ce),t.pixelStorei(37440,Y.flipY),t.pixelStorei(37441,Y.premultiplyAlpha),t.pixelStorei(3317,Y.unpackAlignment),t.pixelStorei(37443,0);let et=Y.isCompressedTexture||Y.image[0].isCompressedTexture,ze=Y.image[0]&&Y.image[0].isDataTexture,ge=[];for(let Ge=0;Ge<6;Ge++)!et&&!ze?ge[Ge]=b(Y.image[Ge],!1,!0,u):ge[Ge]=ze?Y.image[Ge].image:Y.image[Ge],ge[Ge]=we(Y,ge[Ge]);let ct=ge[0],rt=_(ct)||a,ut=s.convert(Y.format,Y.encoding),ht=s.convert(Y.type),tt=M(Y.internalFormat,ut,ht,Y.encoding),pt=a&&Y.isVideoTexture!==!0,Nt=Ue.__version===void 0||Le===!0,ti=R(Y,ct,rt);ae(34067,Y,rt);let xe;if(et){pt&&Nt&&i.texStorage2D(34067,ti,tt,ct.width,ct.height);for(let Ge=0;Ge<6;Ge++){xe=ge[Ge].mipmaps;for(let ie=0;ie<xe.length;ie++){let He=xe[ie];Y.format!==_s?ut!==null?pt?i.compressedTexSubImage2D(34069+Ge,ie,0,0,He.width,He.height,ut,He.data):i.compressedTexImage2D(34069+Ge,ie,tt,He.width,He.height,0,He.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?i.texSubImage2D(34069+Ge,ie,0,0,He.width,He.height,ut,ht,He.data):i.texImage2D(34069+Ge,ie,tt,He.width,He.height,0,ut,ht,He.data)}}}else{xe=Y.mipmaps,pt&&Nt&&(xe.length>0&&ti++,i.texStorage2D(34067,ti,tt,ge[0].width,ge[0].height));for(let Ge=0;Ge<6;Ge++)if(ze){pt?i.texSubImage2D(34069+Ge,0,0,0,ge[Ge].width,ge[Ge].height,ut,ht,ge[Ge].data):i.texImage2D(34069+Ge,0,tt,ge[Ge].width,ge[Ge].height,0,ut,ht,ge[Ge].data);for(let ie=0;ie<xe.length;ie++){let He=xe[ie].image[Ge].image;pt?i.texSubImage2D(34069+Ge,ie+1,0,0,He.width,He.height,ut,ht,He.data):i.texImage2D(34069+Ge,ie+1,tt,He.width,He.height,0,ut,ht,He.data)}}else{pt?i.texSubImage2D(34069+Ge,0,0,0,ut,ht,ge[Ge]):i.texImage2D(34069+Ge,0,tt,ut,ht,ge[Ge]);for(let ie=0;ie<xe.length;ie++){let He=xe[ie];pt?i.texSubImage2D(34069+Ge,ie+1,0,0,ut,ht,He.image[Ge]):i.texImage2D(34069+Ge,ie+1,tt,ut,ht,He.image[Ge])}}}S(Y,rt)&&E(34067),Ue.__version=X.version,Y.onUpdate&&Y.onUpdate(Y)}te.__version=Y.version}function Se(te,Y,ce,Le,X){let Ue=s.convert(ce.format,ce.encoding),et=s.convert(ce.type),ze=M(ce.internalFormat,Ue,et,ce.encoding);r.get(Y).__hasExternalTextures||(X===32879||X===35866?i.texImage3D(X,0,ze,Y.width,Y.height,Y.depth,0,Ue,et,null):i.texImage2D(X,0,ze,Y.width,Y.height,0,Ue,et,null)),i.bindFramebuffer(36160,te),$(Y)?d.framebufferTexture2DMultisampleEXT(36160,Le,X,r.get(ce).__webglTexture,0,Oe(Y)):(X===3553||X>=34069&&X<=34074)&&t.framebufferTexture2D(36160,Le,X,r.get(ce).__webglTexture,0),i.bindFramebuffer(36160,null)}function be(te,Y,ce){if(t.bindRenderbuffer(36161,te),Y.depthBuffer&&!Y.stencilBuffer){let Le=33189;if(ce||$(Y)){let X=Y.depthTexture;X&&X.isDepthTexture&&(X.type===Fn?Le=36012:X.type===Uc&&(Le=33190));let Ue=Oe(Y);$(Y)?d.renderbufferStorageMultisampleEXT(36161,Ue,Le,Y.width,Y.height):t.renderbufferStorageMultisample(36161,Ue,Le,Y.width,Y.height)}else t.renderbufferStorage(36161,Le,Y.width,Y.height);t.framebufferRenderbuffer(36160,36096,36161,te)}else if(Y.depthBuffer&&Y.stencilBuffer){let Le=Oe(Y);ce&&$(Y)===!1?t.renderbufferStorageMultisample(36161,Le,35056,Y.width,Y.height):$(Y)?d.renderbufferStorageMultisampleEXT(36161,Le,35056,Y.width,Y.height):t.renderbufferStorage(36161,34041,Y.width,Y.height),t.framebufferRenderbuffer(36160,33306,36161,te)}else{let Le=Y.isWebGLMultipleRenderTargets===!0?Y.texture:[Y.texture];for(let X=0;X<Le.length;X++){let Ue=Le[X],et=s.convert(Ue.format,Ue.encoding),ze=s.convert(Ue.type),ge=M(Ue.internalFormat,et,ze,Ue.encoding),ct=Oe(Y);ce&&$(Y)===!1?t.renderbufferStorageMultisample(36161,ct,ge,Y.width,Y.height):$(Y)?d.renderbufferStorageMultisampleEXT(36161,ct,ge,Y.width,Y.height):t.renderbufferStorage(36161,ge,Y.width,Y.height)}}t.bindRenderbuffer(36161,null)}function ee(te,Y){if(Y&&Y.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,te),!(Y.depthTexture&&Y.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Y.depthTexture).__webglTexture||Y.depthTexture.image.width!==Y.width||Y.depthTexture.image.height!==Y.height)&&(Y.depthTexture.image.width=Y.width,Y.depthTexture.image.height=Y.height,Y.depthTexture.needsUpdate=!0),V(Y.depthTexture,0);let ce=r.get(Y.depthTexture).__webglTexture,Le=Oe(Y);if(Y.depthTexture.format===pm)$(Y)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,ce,0,Le):t.framebufferTexture2D(36160,36096,3553,ce,0);else if(Y.depthTexture.format===Lm)$(Y)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,ce,0,Le):t.framebufferTexture2D(36160,33306,3553,ce,0);else throw new Error("Unknown depthTexture format")}function _e(te){let Y=r.get(te),ce=te.isWebGLCubeRenderTarget===!0;if(te.depthTexture&&!Y.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");ee(Y.__webglFramebuffer,te)}else if(ce){Y.__webglDepthbuffer=[];for(let Le=0;Le<6;Le++)i.bindFramebuffer(36160,Y.__webglFramebuffer[Le]),Y.__webglDepthbuffer[Le]=t.createRenderbuffer(),be(Y.__webglDepthbuffer[Le],te,!1)}else i.bindFramebuffer(36160,Y.__webglFramebuffer),Y.__webglDepthbuffer=t.createRenderbuffer(),be(Y.__webglDepthbuffer,te,!1);i.bindFramebuffer(36160,null)}function Me(te,Y,ce){let Le=r.get(te);Y!==void 0&&Se(Le.__webglFramebuffer,te,te.texture,36064,3553),ce!==void 0&&_e(te)}function Ce(te){let Y=te.texture,ce=r.get(te),Le=r.get(Y);te.addEventListener("dispose",L),te.isWebGLMultipleRenderTargets!==!0&&(Le.__webglTexture===void 0&&(Le.__webglTexture=t.createTexture()),Le.__version=Y.version,o.memory.textures++);let X=te.isWebGLCubeRenderTarget===!0,Ue=te.isWebGLMultipleRenderTargets===!0,et=_(te)||a;if(X){ce.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)ce.__webglFramebuffer[ze]=t.createFramebuffer()}else{if(ce.__webglFramebuffer=t.createFramebuffer(),Ue)if(n.drawBuffers){let ze=te.texture;for(let ge=0,ct=ze.length;ge<ct;ge++){let rt=r.get(ze[ge]);rt.__webglTexture===void 0&&(rt.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&te.samples>0&&$(te)===!1){let ze=Ue?Y:[Y];ce.__webglMultisampledFramebuffer=t.createFramebuffer(),ce.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,ce.__webglMultisampledFramebuffer);for(let ge=0;ge<ze.length;ge++){let ct=ze[ge];ce.__webglColorRenderbuffer[ge]=t.createRenderbuffer(),t.bindRenderbuffer(36161,ce.__webglColorRenderbuffer[ge]);let rt=s.convert(ct.format,ct.encoding),ut=s.convert(ct.type),ht=M(ct.internalFormat,rt,ut,ct.encoding,te.isXRRenderTarget===!0),tt=Oe(te);t.renderbufferStorageMultisample(36161,tt,ht,te.width,te.height),t.framebufferRenderbuffer(36160,36064+ge,36161,ce.__webglColorRenderbuffer[ge])}t.bindRenderbuffer(36161,null),te.depthBuffer&&(ce.__webglDepthRenderbuffer=t.createRenderbuffer(),be(ce.__webglDepthRenderbuffer,te,!0)),i.bindFramebuffer(36160,null)}}if(X){i.bindTexture(34067,Le.__webglTexture),ae(34067,Y,et);for(let ze=0;ze<6;ze++)Se(ce.__webglFramebuffer[ze],te,Y,36064,34069+ze);S(Y,et)&&E(34067),i.unbindTexture()}else if(Ue){let ze=te.texture;for(let ge=0,ct=ze.length;ge<ct;ge++){let rt=ze[ge],ut=r.get(rt);i.bindTexture(3553,ut.__webglTexture),ae(3553,rt,et),Se(ce.__webglFramebuffer,te,rt,36064+ge,3553),S(rt,et)&&E(3553)}i.unbindTexture()}else{let ze=3553;(te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(a?ze=te.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(ze,Le.__webglTexture),ae(ze,Y,et),Se(ce.__webglFramebuffer,te,Y,36064,ze),S(Y,et)&&E(ze),i.unbindTexture()}te.depthBuffer&&_e(te)}function Re(te){let Y=_(te)||a,ce=te.isWebGLMultipleRenderTargets===!0?te.texture:[te.texture];for(let Le=0,X=ce.length;Le<X;Le++){let Ue=ce[Le];if(S(Ue,Y)){let et=te.isWebGLCubeRenderTarget?34067:3553,ze=r.get(Ue).__webglTexture;i.bindTexture(et,ze),E(et),i.unbindTexture()}}}function Xe(te){if(a&&te.samples>0&&$(te)===!1){let Y=te.isWebGLMultipleRenderTargets?te.texture:[te.texture],ce=te.width,Le=te.height,X=16384,Ue=[],et=te.stencilBuffer?33306:36096,ze=r.get(te),ge=te.isWebGLMultipleRenderTargets===!0;if(ge)for(let ct=0;ct<Y.length;ct++)i.bindFramebuffer(36160,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+ct,36161,null),i.bindFramebuffer(36160,ze.__webglFramebuffer),t.framebufferTexture2D(36009,36064+ct,3553,null,0);i.bindFramebuffer(36008,ze.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,ze.__webglFramebuffer);for(let ct=0;ct<Y.length;ct++){Ue.push(36064+ct),te.depthBuffer&&Ue.push(et);let rt=ze.__ignoreDepthValues!==void 0?ze.__ignoreDepthValues:!1;if(rt===!1&&(te.depthBuffer&&(X|=256),te.stencilBuffer&&(X|=1024)),ge&&t.framebufferRenderbuffer(36008,36064,36161,ze.__webglColorRenderbuffer[ct]),rt===!0&&(t.invalidateFramebuffer(36008,[et]),t.invalidateFramebuffer(36009,[et])),ge){let ut=r.get(Y[ct]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,ut,0)}t.blitFramebuffer(0,0,ce,Le,0,0,ce,Le,X,9728),p&&t.invalidateFramebuffer(36008,Ue)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ge)for(let ct=0;ct<Y.length;ct++){i.bindFramebuffer(36160,ze.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+ct,36161,ze.__webglColorRenderbuffer[ct]);let rt=r.get(Y[ct]).__webglTexture;i.bindFramebuffer(36160,ze.__webglFramebuffer),t.framebufferTexture2D(36009,36064+ct,3553,rt,0)}i.bindFramebuffer(36009,ze.__webglMultisampledFramebuffer)}}function Oe(te){return Math.min(h,te.samples)}function $(te){let Y=r.get(te);return a&&te.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Y.__useRenderToTexture!==!1}function J(te){let Y=o.render.frame;f.get(te)!==Y&&(f.set(te,Y),te.update())}function we(te,Y){let ce=te.encoding,Le=te.format,X=te.type;return te.isCompressedTexture===!0||te.isVideoTexture===!0||te.format===YL||ce!==Mu&&(ce===pi?a===!1?e.has("EXT_sRGB")===!0&&Le===_s?(te.format=YL,te.minFilter=mi,te.generateMipmaps=!1):Y=AQ.sRGBToLinear(Y):(Le!==_s||X!==bo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ce)),Y}this.allocateTextureUnit=B,this.resetTextureUnits=z,this.setTexture2D=V,this.setTexture2DArray=q,this.setTexture3D=K,this.setTextureCube=le,this.rebindTextures=Me,this.setupRenderTarget=Ce,this.updateRenderTargetMipmap=Re,this.updateMultisampleRenderTarget=Xe,this.setupDepthRenderbuffer=_e,this.setupFrameBufferTexture=Se,this.useMultisampledRTT=$}function wye(t,e,i){let r=i.isWebGL2;function n(s,o=null){let a;if(s===bo)return 5121;if(s===rde)return 32819;if(s===nde)return 32820;if(s===ede)return 5120;if(s===tde)return 5122;if(s===gQ)return 5123;if(s===ide)return 5124;if(s===Uc)return 5125;if(s===Fn)return 5126;if(s===Im)return r?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===sde)return 6406;if(s===_s)return 6408;if(s===ode)return 6409;if(s===ade)return 6410;if(s===pm)return 6402;if(s===Lm)return 34041;if(s===YL)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===lde)return 6403;if(s===ude)return 36244;if(s===zC)return 33319;if(s===hde)return 33320;if(s===yQ)return 36249;if(s===Lk||s===Bk||s===Ok||s===Uk)if(o===pi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Lk)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Bk)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Ok)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Uk)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Lk)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Bk)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Ok)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Uk)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===FV||s===zV||s===HV||s===GV)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===FV)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===zV)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===HV)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===GV)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===cde)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===VV||s===jV)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===VV)return o===pi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===jV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===WV||s===qV||s===XV||s===YV||s===KV||s===JV||s===QV||s===ZV||s===$V||s===ej||s===tj||s===ij||s===rj||s===nj)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===WV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===qV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===XV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===YV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===KV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===JV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===QV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===ZV)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===$V)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ej)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===tj)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===ij)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===rj)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===nj)return o===pi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Nk)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Nk)return o===pi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===dde||s===sj||s===oj||s===aj)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Nk)return a.COMPRESSED_RED_RGTC1_EXT;if(s===sj)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===oj)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===aj)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===dm?r?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:n}}var _ye=class extends uo{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}},Yf=class extends ir{constructor(){super(),this.isGroup=!0,this.type="Group"}},Sye={type:"move"},hD=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Yf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Yf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Yf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,i){let r=null,n=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(l&&t.hand){s=!0;for(let f of t.hand.values()){let m=e.getJointPose(f,i),g=this._getHandJoint(l,f);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let u=l.joints["index-finger-tip"],c=l.joints["thumb-tip"],h=u.position.distanceTo(c.position),d=.02,p=.005;l.inputState.pinching&&h>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&h<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else a!==null&&t.gripSpace&&(n=e.getPose(t.gripSpace,i),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(r=e.getPose(t.targetRaySpace,i),r===null&&n!==null&&(r=n),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Sye)))}return o!==null&&(o.visible=r!==null),a!==null&&(a.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let i=new Yf;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}},t0=class extends Wr{constructor(t,e,i,r,n,s,o,a,l,u){if(u=u!==void 0?u:pm,u!==pm&&u!==Lm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===pm&&(i=Uc),i===void 0&&u===Lm&&(i=dm),super(null,r,n,s,o,a,u,i,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=o!==void 0?o:Zi,this.minFilter=a!==void 0?a:Zi,this.flipY=!1,this.generateMipmaps=!1}},Aye=class extends Ys{constructor(t,e){super();let i=this,r=null,n=1,s=null,o="local-floor",a=1,l=null,u=null,c=null,h=null,d=null,p=null,f=e.getContextAttributes(),m=null,g=null,y=[],v=[],b=new Set,_=new Map,A=new uo;A.layers.enable(1),A.viewport=new si;let S=new uo;S.layers.enable(2),S.viewport=new si;let E=[A,S],M=new _ye;M.layers.enable(1),M.layers.enable(2);let R=null,C=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let K=y[q];return K===void 0&&(K=new hD,y[q]=K),K.getTargetRaySpace()},this.getControllerGrip=function(q){let K=y[q];return K===void 0&&(K=new hD,y[q]=K),K.getGripSpace()},this.getHand=function(q){let K=y[q];return K===void 0&&(K=new hD,y[q]=K),K.getHandSpace()};function T(q){let K=v.indexOf(q.inputSource);if(K===-1)return;let le=y[K];le!==void 0&&le.dispatchEvent({type:q.type,data:q.inputSource})}function L(){r.removeEventListener("select",T),r.removeEventListener("selectstart",T),r.removeEventListener("selectend",T),r.removeEventListener("squeeze",T),r.removeEventListener("squeezestart",T),r.removeEventListener("squeezeend",T),r.removeEventListener("end",L),r.removeEventListener("inputsourceschange",I);for(let q=0;q<y.length;q++){let K=v[q];K!==null&&(v[q]=null,y[q].disconnect(K))}R=null,C=null,t.setRenderTarget(m),d=null,h=null,c=null,r=null,g=null,V.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){n=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){o=q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(q){l=q},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(q){if(r=q,r!==null){if(m=t.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",L),r.addEventListener("inputsourceschange",I),f.xrCompatible!==!0&&await e.makeXRCompatible(),r.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let K={antialias:r.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};d=new XRWebGLLayer(r,e,K),r.updateRenderState({baseLayer:d}),g=new $i(d.framebufferWidth,d.framebufferHeight,{format:_s,type:bo,encoding:t.outputEncoding,stencilBuffer:f.stencil})}else{let K=null,le=null,Z=null;f.depth&&(Z=f.stencil?35056:33190,K=f.stencil?Lm:pm,le=f.stencil?dm:Uc);let oe={colorFormat:32856,depthFormat:Z,scaleFactor:n};c=new XRWebGLBinding(r,e),h=c.createProjectionLayer(oe),r.updateRenderState({layers:[h]}),g=new $i(h.textureWidth,h.textureHeight,{format:_s,type:bo,depthTexture:new t0(h.textureWidth,h.textureHeight,le,void 0,void 0,void 0,void 0,void 0,void 0,K),stencilBuffer:f.stencil,encoding:t.outputEncoding,samples:f.antialias?4:0});let ae=t.properties.get(g);ae.__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await r.requestReferenceSpace(o),V.setContext(r),V.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function I(q){for(let K=0;K<q.removed.length;K++){let le=q.removed[K],Z=v.indexOf(le);Z>=0&&(v[Z]=null,y[Z].disconnect(le))}for(let K=0;K<q.added.length;K++){let le=q.added[K],Z=v.indexOf(le);if(Z===-1){for(let ae=0;ae<y.length;ae++)if(ae>=v.length){v.push(le),Z=ae;break}else if(v[ae]===null){v[ae]=le,Z=ae;break}if(Z===-1)break}let oe=y[Z];oe&&oe.connect(le)}}let D=new N,F=new N;function H(q,K,le){D.setFromMatrixPosition(K.matrixWorld),F.setFromMatrixPosition(le.matrixWorld);let Z=D.distanceTo(F),oe=K.projectionMatrix.elements,ae=le.projectionMatrix.elements,ve=oe[14]/(oe[10]-1),ye=oe[14]/(oe[10]+1),pe=(oe[9]+1)/oe[5],Se=(oe[9]-1)/oe[5],be=(oe[8]-1)/oe[0],ee=(ae[8]+1)/ae[0],_e=ve*be,Me=ve*ee,Ce=Z/(-be+ee),Re=Ce*-be;K.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(Re),q.translateZ(Ce),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();let Xe=ve+Ce,Oe=ye+Ce,$=_e-Re,J=Me+(Z-Re),we=pe*ye/Oe*Xe,te=Se*ye/Oe*Xe;q.projectionMatrix.makePerspective($,J,we,te,Xe,Oe)}function z(q,K){K===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(K.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(r===null)return;M.near=S.near=A.near=q.near,M.far=S.far=A.far=q.far,(R!==M.near||C!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),R=M.near,C=M.far);let K=q.parent,le=M.cameras;z(M,K);for(let oe=0;oe<le.length;oe++)z(le[oe],K);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),q.matrix.copy(M.matrix),q.matrix.decompose(q.position,q.quaternion,q.scale);let Z=q.children;for(let oe=0,ae=Z.length;oe<ae;oe++)Z[oe].updateMatrixWorld(!0);le.length===2?H(M,A,S):M.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(!(h===null&&d===null))return a},this.setFoveation=function(q){a=q,h!==null&&(h.fixedFoveation=q),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=q)},this.getPlanes=function(){return b};let B=null;function j(q,K){if(u=K.getViewerPose(l||s),p=K,u!==null){let le=u.views;d!==null&&(t.setRenderTargetFramebuffer(g,d.framebuffer),t.setRenderTarget(g));let Z=!1;le.length!==M.cameras.length&&(M.cameras.length=0,Z=!0);for(let oe=0;oe<le.length;oe++){let ae=le[oe],ve=null;if(d!==null)ve=d.getViewport(ae);else{let pe=c.getViewSubImage(h,ae);ve=pe.viewport,oe===0&&(t.setRenderTargetTextures(g,pe.colorTexture,h.ignoreDepthValues?void 0:pe.depthStencilTexture),t.setRenderTarget(g))}let ye=E[oe];ye===void 0&&(ye=new uo,ye.layers.enable(oe),ye.viewport=new si,E[oe]=ye),ye.matrix.fromArray(ae.transform.matrix),ye.projectionMatrix.fromArray(ae.projectionMatrix),ye.viewport.set(ve.x,ve.y,ve.width,ve.height),oe===0&&M.matrix.copy(ye.matrix),Z===!0&&M.cameras.push(ye)}}for(let le=0;le<y.length;le++){let Z=v[le],oe=y[le];Z!==null&&oe!==void 0&&oe.update(Z,K,l||s)}if(B&&B(q,K),K.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:K.detectedPlanes});let le=null;for(let Z of b)K.detectedPlanes.has(Z)||(le===null&&(le=[]),le.push(Z));if(le!==null)for(let Z of le)b.delete(Z),_.delete(Z),i.dispatchEvent({type:"planeremoved",data:Z});for(let Z of K.detectedPlanes)if(!b.has(Z))b.add(Z),_.set(Z,K.lastChangedTime),i.dispatchEvent({type:"planeadded",data:Z});else{let oe=_.get(Z);Z.lastChangedTime>oe&&(_.set(Z,Z.lastChangedTime),i.dispatchEvent({type:"planechanged",data:Z}))}}p=null}let V=new TQ;V.setAnimationLoop(j),this.setAnimationLoop=function(q){B=q},this.dispose=function(){}}};function Eye(t,e){function i(m,g){g.color.getRGB(m.fogColor.value,PQ(t)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function r(m,g,y,v,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),c(m,g)):g.isMeshPhongMaterial?(n(m,g),u(m,g)):g.isMeshStandardMaterial?(n(m,g),h(m,g),g.isMeshPhysicalMaterial&&d(m,g,b)):g.isMeshMatcapMaterial?(n(m,g),p(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),f(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&o(m,g)):g.isPointsMaterial?a(m,g,y,v):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===As&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===As&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let y=e.get(g).envMap;if(y&&(m.envMap.value=y,m.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let _=t.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*_}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let v;g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),v!==void 0&&(v.isWebGLRenderTarget&&(v=v.texture),v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix));let b;g.aoMap?b=g.aoMap:g.lightMap&&(b=g.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uv2Transform.value.copy(b.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function a(m,g,y,v){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*y,m.scale.value=v*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let b;g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let y;g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function c(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,y){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===As&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function f(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Mye(t,e,i,r){let n={},s={},o=[],a=i.isWebGL2?t.getParameter(35375):0;function l(v,b){let _=b.program;r.uniformBlockBinding(v,_)}function u(v,b){let _=n[v.id];_===void 0&&(f(v),_=c(v),n[v.id]=_,v.addEventListener("dispose",g));let A=b.program;r.updateUBOMapping(v,A);let S=e.render.frame;s[v.id]!==S&&(d(v),s[v.id]=S)}function c(v){let b=h();v.__bindingPointIndex=b;let _=t.createBuffer(),A=v.__size,S=v.usage;return t.bindBuffer(35345,_),t.bufferData(35345,A,S),t.bindBuffer(35345,null),t.bindBufferBase(35345,b,_),_}function h(){for(let v=0;v<a;v++)if(o.indexOf(v)===-1)return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(v){let b=n[v.id],_=v.uniforms,A=v.__cache;t.bindBuffer(35345,b);for(let S=0,E=_.length;S<E;S++){let M=_[S];if(p(M,S,A)===!0){let R=M.__offset,C=Array.isArray(M.value)?M.value:[M.value],T=0;for(let L=0;L<C.length;L++){let I=C[L],D=m(I);typeof I=="number"?(M.__data[0]=I,t.bufferSubData(35345,R+T,M.__data)):I.isMatrix3?(M.__data[0]=I.elements[0],M.__data[1]=I.elements[1],M.__data[2]=I.elements[2],M.__data[3]=I.elements[0],M.__data[4]=I.elements[3],M.__data[5]=I.elements[4],M.__data[6]=I.elements[5],M.__data[7]=I.elements[0],M.__data[8]=I.elements[6],M.__data[9]=I.elements[7],M.__data[10]=I.elements[8],M.__data[11]=I.elements[0]):(I.toArray(M.__data,T),T+=D.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,R,M.__data)}}t.bindBuffer(35345,null)}function p(v,b,_){let A=v.value;if(_[b]===void 0){if(typeof A=="number")_[b]=A;else{let S=Array.isArray(A)?A:[A],E=[];for(let M=0;M<S.length;M++)E.push(S[M].clone());_[b]=E}return!0}else if(typeof A=="number"){if(_[b]!==A)return _[b]=A,!0}else{let S=Array.isArray(_[b])?_[b]:[_[b]],E=Array.isArray(A)?A:[A];for(let M=0;M<S.length;M++){let R=S[M];if(R.equals(E[M])===!1)return R.copy(E[M]),!0}}return!1}function f(v){let b=v.uniforms,_=0,A=16,S=0;for(let E=0,M=b.length;E<M;E++){let R=b[E],C={boundary:0,storage:0},T=Array.isArray(R.value)?R.value:[R.value];for(let L=0,I=T.length;L<I;L++){let D=T[L],F=m(D);C.boundary+=F.boundary,C.storage+=F.storage}if(R.__data=new Float32Array(C.storage/Float32Array.BYTES_PER_ELEMENT),R.__offset=_,E>0){S=_%A;let L=A-S;S!==0&&L-C.boundary<0&&(_+=A-S,R.__offset=_)}_+=C.storage}return S=_%A,S>0&&(_+=A-S),v.__size=_,v.__cache={},this}function m(v){let b={boundary:0,storage:0};return typeof v=="number"?(b.boundary=4,b.storage=4):v.isVector2?(b.boundary=8,b.storage=8):v.isVector3||v.isColor?(b.boundary=16,b.storage=12):v.isVector4?(b.boundary=16,b.storage=16):v.isMatrix3?(b.boundary=48,b.storage=48):v.isMatrix4?(b.boundary=64,b.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),b}function g(v){let b=v.target;b.removeEventListener("dispose",g);let _=o.indexOf(b.__bindingPointIndex);o.splice(_,1),t.deleteBuffer(n[b.id]),delete n[b.id],delete s[b.id]}function y(){for(let v in n)t.deleteBuffer(n[v]);o=[],n={},s={}}return{bind:l,update:u,dispose:y}}function Cye(){let t=Ww("canvas");return t.style.display="block",t}function BQ(t={}){this.isWebGLRenderer=!0;let e=t.canvas!==void 0?t.canvas:Cye(),i=t.context!==void 0?t.context:null,r=t.depth!==void 0?t.depth:!0,n=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",u=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,c;i!==null?c=i.getContextAttributes().alpha:c=t.alpha!==void 0?t.alpha:!1;let h=null,d=null,p=[],f=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Mu,this.physicallyCorrectLights=!1,this.toneMapping=Mh,this.toneMappingExposure=1;let m=this,g=!1,y=0,v=0,b=null,_=-1,A=null,S=new si,E=new si,M=null,R=e.width,C=e.height,T=1,L=null,I=null,D=new si(0,0,R,C),F=new si(0,0,R,C),H=!1,z=new EF,B=!1,j=!1,V=null,q=new lt,K=new me,le=new N,Z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function oe(){return b===null?T:1}let ae=i;function ve(he,Ve){for(let Qe=0;Qe<he.length;Qe++){let Ne=he[Qe],$e=e.getContext(Ne,Ve);if($e!==null)return $e}return null}try{let he={alpha:!0,depth:r,stencil:n,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${B0}`),e.addEventListener("webglcontextlost",ht,!1),e.addEventListener("webglcontextrestored",tt,!1),e.addEventListener("webglcontextcreationerror",pt,!1),ae===null){let Ve=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&Ve.shift(),ae=ve(Ve,he),ae===null)throw ve(Ve)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ae.getShaderPrecisionFormat===void 0&&(ae.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}let ye,pe,Se,be,ee,_e,Me,Ce,Re,Xe,Oe,$,J,we,te,Y,ce,Le,X,Ue,et,ze,ge,ct;function rt(){ye=new zme(ae),pe=new Lme(ae,ye,t),ye.init(pe),ze=new wye(ae,ye,pe),Se=new bye(ae,ye,pe),be=new Vme,ee=new oye,_e=new xye(ae,ye,Se,ee,pe,ze,be),Me=new Ome(m),Ce=new Fme(m),Re=new Zde(ae,pe),ge=new Dme(ae,ye,Re,pe),Xe=new Hme(ae,Re,be,ge),Oe=new Xme(ae,Xe,Re,be),X=new qme(ae,pe,_e),Y=new Bme(ee),$=new sye(m,Me,Ce,ye,pe,ge,Y),J=new Eye(m,ee),we=new lye,te=new fye(ye,pe),Le=new kme(m,Me,Ce,Se,Oe,c,o),ce=new vye(m,Oe,pe),ct=new Mye(ae,be,pe,Se),Ue=new Ime(ae,ye,be,pe),et=new Gme(ae,ye,be,pe),be.programs=$.programs,m.capabilities=pe,m.extensions=ye,m.properties=ee,m.renderLists=we,m.shadowMap=ce,m.state=Se,m.info=be}rt();let ut=new Aye(m,ae);this.xr=ut,this.getContext=function(){return ae},this.getContextAttributes=function(){return ae.getContextAttributes()},this.forceContextLoss=function(){let he=ye.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){let he=ye.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(he){he!==void 0&&(T=he,this.setSize(R,C,!1))},this.getSize=function(he){return he.set(R,C)},this.setSize=function(he,Ve,Qe){if(ut.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}R=he,C=Ve,e.width=Math.floor(he*T),e.height=Math.floor(Ve*T),Qe!==!1&&(e.style.width=he+"px",e.style.height=Ve+"px"),this.setViewport(0,0,he,Ve)},this.getDrawingBufferSize=function(he){return he.set(R*T,C*T).floor()},this.setDrawingBufferSize=function(he,Ve,Qe){R=he,C=Ve,T=Qe,e.width=Math.floor(he*Qe),e.height=Math.floor(Ve*Qe),this.setViewport(0,0,he,Ve)},this.getCurrentViewport=function(he){return he.copy(S)},this.getViewport=function(he){return he.copy(D)},this.setViewport=function(he,Ve,Qe,Ne){he.isVector4?D.set(he.x,he.y,he.z,he.w):D.set(he,Ve,Qe,Ne),Se.viewport(S.copy(D).multiplyScalar(T).floor())},this.getScissor=function(he){return he.copy(F)},this.setScissor=function(he,Ve,Qe,Ne){he.isVector4?F.set(he.x,he.y,he.z,he.w):F.set(he,Ve,Qe,Ne),Se.scissor(E.copy(F).multiplyScalar(T).floor())},this.getScissorTest=function(){return H},this.setScissorTest=function(he){Se.setScissorTest(H=he)},this.setOpaqueSort=function(he){L=he},this.setTransparentSort=function(he){I=he},this.getClearColor=function(he){return he.copy(Le.getClearColor())},this.setClearColor=function(){Le.setClearColor.apply(Le,arguments)},this.getClearAlpha=function(){return Le.getClearAlpha()},this.setClearAlpha=function(){Le.setClearAlpha.apply(Le,arguments)},this.clear=function(he=!0,Ve=!0,Qe=!0){let Ne=0;he&&(Ne|=16384),Ve&&(Ne|=256),Qe&&(Ne|=1024),ae.clear(Ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ht,!1),e.removeEventListener("webglcontextrestored",tt,!1),e.removeEventListener("webglcontextcreationerror",pt,!1),we.dispose(),te.dispose(),ee.dispose(),Me.dispose(),Ce.dispose(),Oe.dispose(),ge.dispose(),ct.dispose(),$.dispose(),ut.dispose(),ut.removeEventListener("sessionstart",He),ut.removeEventListener("sessionend",Ye),V&&(V.dispose(),V=null),dt.stop()};function ht(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function tt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let he=be.autoReset,Ve=ce.enabled,Qe=ce.autoUpdate,Ne=ce.needsUpdate,$e=ce.type;rt(),be.autoReset=he,ce.enabled=Ve,ce.autoUpdate=Qe,ce.needsUpdate=Ne,ce.type=$e}function pt(he){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",he.statusMessage)}function Nt(he){let Ve=he.target;Ve.removeEventListener("dispose",Nt),ti(Ve)}function ti(he){xe(he),ee.remove(he)}function xe(he){let Ve=ee.get(he).programs;Ve!==void 0&&(Ve.forEach(function(Qe){$.releaseProgram(Qe)}),he.isShaderMaterial&&$.releaseShaderCache(he))}this.renderBufferDirect=function(he,Ve,Qe,Ne,$e,Lt){Ve===null&&(Ve=Z);let oi=$e.isMesh&&$e.matrixWorld.determinant()<0,hi=Ks(he,Ve,Qe,Ne,$e);Se.setMaterial(Ne,oi);let ne=Qe.index,Pe=1;Ne.wireframe===!0&&(ne=Xe.getWireframeAttribute(Qe),Pe=2);let De=Qe.drawRange,Be=Qe.attributes.position,ke=De.start*Pe,gt=(De.start+De.count)*Pe;Lt!==null&&(ke=Math.max(ke,Lt.start*Pe),gt=Math.min(gt,(Lt.start+Lt.count)*Pe)),ne!==null?(ke=Math.max(ke,0),gt=Math.min(gt,ne.count)):Be!=null&&(ke=Math.max(ke,0),gt=Math.min(gt,Be.count));let Rt=gt-ke;if(Rt<0||Rt===1/0)return;ge.setup($e,Ne,hi,Qe,ne);let zt,Mt=Ue;if(ne!==null&&(zt=Re.get(ne),Mt=et,Mt.setIndex(zt)),$e.isMesh)Ne.wireframe===!0?(Se.setLineWidth(Ne.wireframeLinewidth*oe()),Mt.setMode(1)):Mt.setMode(4);else if($e.isLine){let bt=Ne.linewidth;bt===void 0&&(bt=1),Se.setLineWidth(bt*oe()),$e.isLineSegments?Mt.setMode(1):$e.isLineLoop?Mt.setMode(2):Mt.setMode(3)}else $e.isPoints?Mt.setMode(0):$e.isSprite&&Mt.setMode(4);if($e.isInstancedMesh)Mt.renderInstances(ke,Rt,$e.count);else if(Qe.isInstancedBufferGeometry){let bt=Qe._maxInstanceCount!==void 0?Qe._maxInstanceCount:1/0,Gt=Math.min(Qe.instanceCount,bt);Mt.renderInstances(ke,Rt,Gt)}else Mt.render(ke,Rt)},this.compile=function(he,Ve){function Qe(Ne,$e,Lt){Ne.transparent===!0&&Ne.side===fa&&Ne.forceSinglePass===!1?(Ne.side=As,Ne.needsUpdate=!0,gi(Ne,$e,Lt),Ne.side=Eu,Ne.needsUpdate=!0,gi(Ne,$e,Lt),Ne.side=fa):gi(Ne,$e,Lt)}d=te.get(he),d.init(),f.push(d),he.traverseVisible(function(Ne){Ne.isLight&&Ne.layers.test(Ve.layers)&&(d.pushLight(Ne),Ne.castShadow&&d.pushShadow(Ne))}),d.setupLights(m.physicallyCorrectLights),he.traverse(function(Ne){let $e=Ne.material;if($e)if(Array.isArray($e))for(let Lt=0;Lt<$e.length;Lt++){let oi=$e[Lt];Qe(oi,he,Ne)}else Qe($e,he,Ne)}),f.pop(),d=null};let Ge=null;function ie(he){Ge&&Ge(he)}function He(){dt.stop()}function Ye(){dt.start()}let dt=new TQ;dt.setAnimationLoop(ie),typeof self<"u"&&dt.setContext(self),this.setAnimationLoop=function(he){Ge=he,ut.setAnimationLoop(he),he===null?dt.stop():dt.start()},ut.addEventListener("sessionstart",He),ut.addEventListener("sessionend",Ye),this.render=function(he,Ve){if(Ve!==void 0&&Ve.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Ve.parent===null&&Ve.matrixWorldAutoUpdate===!0&&Ve.updateMatrixWorld(),ut.enabled===!0&&ut.isPresenting===!0&&(ut.cameraAutoUpdate===!0&&ut.updateCamera(Ve),Ve=ut.getCamera()),he.isScene===!0&&he.onBeforeRender(m,he,Ve,b),d=te.get(he,f.length),d.init(),f.push(d),q.multiplyMatrices(Ve.projectionMatrix,Ve.matrixWorldInverse),z.setFromProjectionMatrix(q),j=this.localClippingEnabled,B=Y.init(this.clippingPlanes,j),h=we.get(he,p.length),h.init(),p.push(h),At(he,Ve,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(L,I),B===!0&&Y.beginShadows();let Qe=d.state.shadowsArray;if(ce.render(Qe,he,Ve),B===!0&&Y.endShadows(),this.info.autoReset===!0&&this.info.reset(),Le.render(h,he),d.setupLights(m.physicallyCorrectLights),Ve.isArrayCamera){let Ne=Ve.cameras;for(let $e=0,Lt=Ne.length;$e<Lt;$e++){let oi=Ne[$e];ri(h,he,oi,oi.viewport)}}else ri(h,he,Ve);b!==null&&(_e.updateMultisampleRenderTarget(b),_e.updateRenderTargetMipmap(b)),he.isScene===!0&&he.onAfterRender(m,he,Ve),ge.resetDefaultState(),_=-1,A=null,f.pop(),f.length>0?d=f[f.length-1]:d=null,p.pop(),p.length>0?h=p[p.length-1]:h=null};function At(he,Ve,Qe,Ne){if(he.visible===!1)return;if(he.layers.test(Ve.layers)){if(he.isGroup)Qe=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(Ve);else if(he.isLight)d.pushLight(he),he.castShadow&&d.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||z.intersectsSprite(he)){Ne&&le.setFromMatrixPosition(he.matrixWorld).applyMatrix4(q);let Lt=Oe.update(he),oi=he.material;oi.visible&&h.push(he,Lt,oi,Qe,le.z,null)}}else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==be.render.frame&&(he.skeleton.update(),he.skeleton.frame=be.render.frame),!he.frustumCulled||z.intersectsObject(he))){Ne&&le.setFromMatrixPosition(he.matrixWorld).applyMatrix4(q);let Lt=Oe.update(he),oi=he.material;if(Array.isArray(oi)){let hi=Lt.groups;for(let ne=0,Pe=hi.length;ne<Pe;ne++){let De=hi[ne],Be=oi[De.materialIndex];Be&&Be.visible&&h.push(he,Lt,Be,Qe,le.z,De)}}else oi.visible&&h.push(he,Lt,oi,Qe,le.z,null)}}let $e=he.children;for(let Lt=0,oi=$e.length;Lt<oi;Lt++)At($e[Lt],Ve,Qe,Ne)}function ri(he,Ve,Qe,Ne){let $e=he.opaque,Lt=he.transmissive,oi=he.transparent;d.setupLightsView(Qe),B===!0&&Y.setGlobalState(m.clippingPlanes,Qe),Lt.length>0&&Si($e,Ve,Qe),Ne&&Se.viewport(S.copy(Ne)),$e.length>0&&li($e,Ve,Qe),Lt.length>0&&li(Lt,Ve,Qe),oi.length>0&&li(oi,Ve,Qe),Se.buffers.depth.setTest(!0),Se.buffers.depth.setMask(!0),Se.buffers.color.setMask(!0),Se.setPolygonOffset(!1)}function Si(he,Ve,Qe){let Ne=pe.isWebGL2;V===null&&(V=new $i(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")?Im:bo,minFilter:$v,samples:Ne&&s===!0?4:0})),m.getDrawingBufferSize(K),Ne?V.setSize(K.x,K.y):V.setSize(WC(K.x),WC(K.y));let $e=m.getRenderTarget();m.setRenderTarget(V),m.clear();let Lt=m.toneMapping;m.toneMapping=Mh,li(he,Ve,Qe),m.toneMapping=Lt,_e.updateMultisampleRenderTarget(V),_e.updateRenderTargetMipmap(V),m.setRenderTarget($e)}function li(he,Ve,Qe){let Ne=Ve.isScene===!0?Ve.overrideMaterial:null;for(let $e=0,Lt=he.length;$e<Lt;$e++){let oi=he[$e],hi=oi.object,ne=oi.geometry,Pe=Ne===null?oi.material:Ne,De=oi.group;hi.layers.test(Qe.layers)&&yr(hi,Ve,Qe,ne,Pe,De)}}function yr(he,Ve,Qe,Ne,$e,Lt){he.onBeforeRender(m,Ve,Qe,Ne,$e,Lt),he.modelViewMatrix.multiplyMatrices(Qe.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),$e.onBeforeRender(m,Ve,Qe,Ne,he,Lt),$e.transparent===!0&&$e.side===fa&&$e.forceSinglePass===!1?($e.side=As,$e.needsUpdate=!0,m.renderBufferDirect(Qe,Ve,Ne,$e,he,Lt),$e.side=Eu,$e.needsUpdate=!0,m.renderBufferDirect(Qe,Ve,Ne,$e,he,Lt),$e.side=fa):m.renderBufferDirect(Qe,Ve,Ne,$e,he,Lt),he.onAfterRender(m,Ve,Qe,Ne,$e,Lt)}function gi(he,Ve,Qe){Ve.isScene!==!0&&(Ve=Z);let Ne=ee.get(he),$e=d.state.lights,Lt=d.state.shadowsArray,oi=$e.state.version,hi=$.getParameters(he,$e.state,Lt,Ve,Qe),ne=$.getProgramCacheKey(hi),Pe=Ne.programs;Ne.environment=he.isMeshStandardMaterial?Ve.environment:null,Ne.fog=Ve.fog,Ne.envMap=(he.isMeshStandardMaterial?Ce:Me).get(he.envMap||Ne.environment),Pe===void 0&&(he.addEventListener("dispose",Nt),Pe=new Map,Ne.programs=Pe);let De=Pe.get(ne);if(De!==void 0){if(Ne.currentProgram===De&&Ne.lightsStateVersion===oi)return Br(he,hi),De}else hi.uniforms=$.getUniforms(he),he.onBuild(Qe,hi,m),he.onBeforeCompile(hi,m),De=$.acquireProgram(hi,ne),Pe.set(ne,De),Ne.uniforms=hi.uniforms;let Be=Ne.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(Be.clippingPlanes=Y.uniform),Br(he,hi),Ne.needsLights=Vl(he),Ne.lightsStateVersion=oi,Ne.needsLights&&(Be.ambientLightColor.value=$e.state.ambient,Be.lightProbe.value=$e.state.probe,Be.directionalLights.value=$e.state.directional,Be.directionalLightShadows.value=$e.state.directionalShadow,Be.spotLights.value=$e.state.spot,Be.spotLightShadows.value=$e.state.spotShadow,Be.rectAreaLights.value=$e.state.rectArea,Be.ltc_1.value=$e.state.rectAreaLTC1,Be.ltc_2.value=$e.state.rectAreaLTC2,Be.pointLights.value=$e.state.point,Be.pointLightShadows.value=$e.state.pointShadow,Be.hemisphereLights.value=$e.state.hemi,Be.directionalShadowMap.value=$e.state.directionalShadowMap,Be.directionalShadowMatrix.value=$e.state.directionalShadowMatrix,Be.spotShadowMap.value=$e.state.spotShadowMap,Be.spotLightMatrix.value=$e.state.spotLightMatrix,Be.spotLightMap.value=$e.state.spotLightMap,Be.pointShadowMap.value=$e.state.pointShadowMap,Be.pointShadowMatrix.value=$e.state.pointShadowMatrix);let ke=De.getUniforms(),gt=MM.seqWithValue(ke.seq,Be);return Ne.currentProgram=De,Ne.uniformsList=gt,De}function Br(he,Ve){let Qe=ee.get(he);Qe.outputEncoding=Ve.outputEncoding,Qe.instancing=Ve.instancing,Qe.skinning=Ve.skinning,Qe.morphTargets=Ve.morphTargets,Qe.morphNormals=Ve.morphNormals,Qe.morphColors=Ve.morphColors,Qe.morphTargetsCount=Ve.morphTargetsCount,Qe.numClippingPlanes=Ve.numClippingPlanes,Qe.numIntersection=Ve.numClipIntersection,Qe.vertexAlphas=Ve.vertexAlphas,Qe.vertexTangents=Ve.vertexTangents,Qe.toneMapping=Ve.toneMapping}function Ks(he,Ve,Qe,Ne,$e){Ve.isScene!==!0&&(Ve=Z),_e.resetTextureUnits();let Lt=Ve.fog,oi=Ne.isMeshStandardMaterial?Ve.environment:null,hi=b===null?m.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:Mu,ne=(Ne.isMeshStandardMaterial?Ce:Me).get(Ne.envMap||oi),Pe=Ne.vertexColors===!0&&!!Qe.attributes.color&&Qe.attributes.color.itemSize===4,De=!!Ne.normalMap&&!!Qe.attributes.tangent,Be=!!Qe.morphAttributes.position,ke=!!Qe.morphAttributes.normal,gt=!!Qe.morphAttributes.color,Rt=Ne.toneMapped?m.toneMapping:Mh,zt=Qe.morphAttributes.position||Qe.morphAttributes.normal||Qe.morphAttributes.color,Mt=zt!==void 0?zt.length:0,bt=ee.get(Ne),Gt=d.state.lights;if(B===!0&&(j===!0||he!==A)){let re=he===A&&Ne.id===_;Y.setState(Ne,he,re)}let yt=!1;Ne.version===bt.__version?(bt.needsLights&&bt.lightsStateVersion!==Gt.state.version||bt.outputEncoding!==hi||$e.isInstancedMesh&&bt.instancing===!1||!$e.isInstancedMesh&&bt.instancing===!0||$e.isSkinnedMesh&&bt.skinning===!1||!$e.isSkinnedMesh&&bt.skinning===!0||bt.envMap!==ne||Ne.fog===!0&&bt.fog!==Lt||bt.numClippingPlanes!==void 0&&(bt.numClippingPlanes!==Y.numPlanes||bt.numIntersection!==Y.numIntersection)||bt.vertexAlphas!==Pe||bt.vertexTangents!==De||bt.morphTargets!==Be||bt.morphNormals!==ke||bt.morphColors!==gt||bt.toneMapping!==Rt||pe.isWebGL2===!0&&bt.morphTargetsCount!==Mt)&&(yt=!0):(yt=!0,bt.__version=Ne.version);let Vi=bt.currentProgram;yt===!0&&(Vi=gi(Ne,Ve,$e));let Er=!1,Ni=!1,rr=!1,W=Vi.getUniforms(),Q=bt.uniforms;if(Se.useProgram(Vi.program)&&(Er=!0,Ni=!0,rr=!0),Ne.id!==_&&(_=Ne.id,Ni=!0),Er||A!==he){if(W.setValue(ae,"projectionMatrix",he.projectionMatrix),pe.logarithmicDepthBuffer&&W.setValue(ae,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),A!==he&&(A=he,Ni=!0,rr=!0),Ne.isShaderMaterial||Ne.isMeshPhongMaterial||Ne.isMeshToonMaterial||Ne.isMeshStandardMaterial||Ne.envMap){let re=W.map.cameraPosition;re!==void 0&&re.setValue(ae,le.setFromMatrixPosition(he.matrixWorld))}(Ne.isMeshPhongMaterial||Ne.isMeshToonMaterial||Ne.isMeshLambertMaterial||Ne.isMeshBasicMaterial||Ne.isMeshStandardMaterial||Ne.isShaderMaterial)&&W.setValue(ae,"isOrthographic",he.isOrthographicCamera===!0),(Ne.isMeshPhongMaterial||Ne.isMeshToonMaterial||Ne.isMeshLambertMaterial||Ne.isMeshBasicMaterial||Ne.isMeshStandardMaterial||Ne.isShaderMaterial||Ne.isShadowMaterial||$e.isSkinnedMesh)&&W.setValue(ae,"viewMatrix",he.matrixWorldInverse)}if($e.isSkinnedMesh){W.setOptional(ae,$e,"bindMatrix"),W.setOptional(ae,$e,"bindMatrixInverse");let re=$e.skeleton;re&&(pe.floatVertexTextures?(re.boneTexture===null&&re.computeBoneTexture(),W.setValue(ae,"boneTexture",re.boneTexture,_e),W.setValue(ae,"boneTextureSize",re.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let fe=Qe.morphAttributes;if((fe.position!==void 0||fe.normal!==void 0||fe.color!==void 0&&pe.isWebGL2===!0)&&X.update($e,Qe,Ne,Vi),(Ni||bt.receiveShadow!==$e.receiveShadow)&&(bt.receiveShadow=$e.receiveShadow,W.setValue(ae,"receiveShadow",$e.receiveShadow)),Ne.isMeshGouraudMaterial&&Ne.envMap!==null&&(Q.envMap.value=ne,Q.flipEnvMap.value=ne.isCubeTexture&&ne.isRenderTargetTexture===!1?-1:1),Ni&&(W.setValue(ae,"toneMappingExposure",m.toneMappingExposure),bt.needsLights&&Kh(Q,rr),Lt&&Ne.fog===!0&&J.refreshFogUniforms(Q,Lt),J.refreshMaterialUniforms(Q,Ne,T,C,V),MM.upload(ae,bt.uniformsList,Q,_e)),Ne.isShaderMaterial&&Ne.uniformsNeedUpdate===!0&&(MM.upload(ae,bt.uniformsList,Q,_e),Ne.uniformsNeedUpdate=!1),Ne.isSpriteMaterial&&W.setValue(ae,"center",$e.center),W.setValue(ae,"modelViewMatrix",$e.modelViewMatrix),W.setValue(ae,"normalMatrix",$e.normalMatrix),W.setValue(ae,"modelMatrix",$e.matrixWorld),$e.previousModelViewMatrix&&W.setValue(ae,"previousModelViewMatrix",$e.previousModelViewMatrix),he.previousProjectionMatrix&&W.setValue(ae,"previousProjectionMatrix",he.previousProjectionMatrix),Ne.isShaderMaterial||Ne.isRawShaderMaterial){let re=Ne.uniformsGroups;for(let Ae=0,at=re.length;Ae<at;Ae++)if(pe.isWebGL2){let Yr=re[Ae];ct.update(Yr,Vi),ct.bind(Yr,Vi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Vi}function Kh(he,Ve){he.ambientLightColor.needsUpdate=Ve,he.lightProbe.needsUpdate=Ve,he.directionalLights.needsUpdate=Ve,he.directionalLightShadows.needsUpdate=Ve,he.pointLights.needsUpdate=Ve,he.pointLightShadows.needsUpdate=Ve,he.spotLights.needsUpdate=Ve,he.spotLightShadows.needsUpdate=Ve,he.rectAreaLights.needsUpdate=Ve,he.hemisphereLights.needsUpdate=Ve}function Vl(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(he,Ve,Qe){ee.get(he.texture).__webglTexture=Ve,ee.get(he.depthTexture).__webglTexture=Qe;let Ne=ee.get(he);Ne.__hasExternalTextures=!0,Ne.__hasExternalTextures&&(Ne.__autoAllocateDepthBuffer=Qe===void 0,Ne.__autoAllocateDepthBuffer||ye.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ne.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(he,Ve){let Qe=ee.get(he);Qe.__webglFramebuffer=Ve,Qe.__useDefaultFramebuffer=Ve===void 0},this.setRenderTarget=function(he,Ve=0,Qe=0){b=he,y=Ve,v=Qe;let Ne=!0,$e=null,Lt=!1,oi=!1;if(he){let hi=ee.get(he);hi.__useDefaultFramebuffer!==void 0?(Se.bindFramebuffer(36160,null),Ne=!1):hi.__webglFramebuffer===void 0?_e.setupRenderTarget(he):hi.__hasExternalTextures&&_e.rebindTextures(he,ee.get(he.texture).__webglTexture,ee.get(he.depthTexture).__webglTexture);let ne=he.texture;(ne.isData3DTexture||ne.isDataArrayTexture||ne.isCompressedArrayTexture)&&(oi=!0);let Pe=ee.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?($e=Pe[Ve],Lt=!0):pe.isWebGL2&&he.samples>0&&_e.useMultisampledRTT(he)===!1?$e=ee.get(he).__webglMultisampledFramebuffer:$e=Pe,S.copy(he.viewport),E.copy(he.scissor),M=he.scissorTest}else S.copy(D).multiplyScalar(T).floor(),E.copy(F).multiplyScalar(T).floor(),M=H;if(Se.bindFramebuffer(36160,$e)&&pe.drawBuffers&&Ne&&Se.drawBuffers(he,$e),Se.viewport(S),Se.scissor(E),Se.setScissorTest(M),Lt){let hi=ee.get(he.texture);ae.framebufferTexture2D(36160,36064,34069+Ve,hi.__webglTexture,Qe)}else if(oi){let hi=ee.get(he.texture),ne=Ve||0;ae.framebufferTextureLayer(36160,36064,hi.__webglTexture,Qe||0,ne)}_=-1},this.readRenderTargetPixels=function(he,Ve,Qe,Ne,$e,Lt,oi){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let hi=ee.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&oi!==void 0&&(hi=hi[oi]),hi){Se.bindFramebuffer(36160,hi);try{let ne=he.texture,Pe=ne.format,De=ne.type;if(Pe!==_s&&ze.convert(Pe)!==ae.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Be=De===Im&&(ye.has("EXT_color_buffer_half_float")||pe.isWebGL2&&ye.has("EXT_color_buffer_float"));if(De!==bo&&ze.convert(De)!==ae.getParameter(35738)&&!(De===Fn&&(pe.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float")))&&!Be){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ve>=0&&Ve<=he.width-Ne&&Qe>=0&&Qe<=he.height-$e&&ae.readPixels(Ve,Qe,Ne,$e,ze.convert(Pe),ze.convert(De),Lt)}finally{let ne=b!==null?ee.get(b).__webglFramebuffer:null;Se.bindFramebuffer(36160,ne)}}},this.copyFramebufferToTexture=function(he,Ve,Qe=0){let Ne=Math.pow(2,-Qe),$e=Math.floor(Ve.image.width*Ne),Lt=Math.floor(Ve.image.height*Ne);_e.setTexture2D(Ve,0),ae.copyTexSubImage2D(3553,Qe,0,0,he.x,he.y,$e,Lt),Se.unbindTexture()},this.copyTextureToTexture=function(he,Ve,Qe,Ne=0){let $e=Ve.image.width,Lt=Ve.image.height,oi=ze.convert(Qe.format),hi=ze.convert(Qe.type);_e.setTexture2D(Qe,0),ae.pixelStorei(37440,Qe.flipY),ae.pixelStorei(37441,Qe.premultiplyAlpha),ae.pixelStorei(3317,Qe.unpackAlignment),Ve.isDataTexture?ae.texSubImage2D(3553,Ne,he.x,he.y,$e,Lt,oi,hi,Ve.image.data):Ve.isCompressedTexture?ae.compressedTexSubImage2D(3553,Ne,he.x,he.y,Ve.mipmaps[0].width,Ve.mipmaps[0].height,oi,Ve.mipmaps[0].data):ae.texSubImage2D(3553,Ne,he.x,he.y,oi,hi,Ve.image),Ne===0&&Qe.generateMipmaps&&ae.generateMipmap(3553),Se.unbindTexture()},this.copyTextureToTexture3D=function(he,Ve,Qe,Ne,$e=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Lt=he.max.x-he.min.x+1,oi=he.max.y-he.min.y+1,hi=he.max.z-he.min.z+1,ne=ze.convert(Ne.format),Pe=ze.convert(Ne.type),De;if(Ne.isData3DTexture)_e.setTexture3D(Ne,0),De=32879;else if(Ne.isDataArrayTexture)_e.setTexture2DArray(Ne,0),De=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ae.pixelStorei(37440,Ne.flipY),ae.pixelStorei(37441,Ne.premultiplyAlpha),ae.pixelStorei(3317,Ne.unpackAlignment);let Be=ae.getParameter(3314),ke=ae.getParameter(32878),gt=ae.getParameter(3316),Rt=ae.getParameter(3315),zt=ae.getParameter(32877),Mt=Qe.isCompressedTexture?Qe.mipmaps[0]:Qe.image;ae.pixelStorei(3314,Mt.width),ae.pixelStorei(32878,Mt.height),ae.pixelStorei(3316,he.min.x),ae.pixelStorei(3315,he.min.y),ae.pixelStorei(32877,he.min.z),Qe.isDataTexture||Qe.isData3DTexture?ae.texSubImage3D(De,$e,Ve.x,Ve.y,Ve.z,Lt,oi,hi,ne,Pe,Mt.data):Qe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ae.compressedTexSubImage3D(De,$e,Ve.x,Ve.y,Ve.z,Lt,oi,hi,ne,Mt.data)):ae.texSubImage3D(De,$e,Ve.x,Ve.y,Ve.z,Lt,oi,hi,ne,Pe,Mt),ae.pixelStorei(3314,Be),ae.pixelStorei(32878,ke),ae.pixelStorei(3316,gt),ae.pixelStorei(3315,Rt),ae.pixelStorei(32877,zt),$e===0&&Ne.generateMipmaps&&ae.generateMipmap(De),Se.unbindTexture()},this.initTexture=function(he){he.isCubeTexture?_e.setTextureCube(he,0):he.isData3DTexture?_e.setTexture3D(he,0):he.isDataArrayTexture||he.isCompressedArrayTexture?_e.setTexture2DArray(he,0):_e.setTexture2D(he,0),Se.unbindTexture()},this.resetState=function(){y=0,v=0,b=null,Se.reset(),ge.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var Pye=class extends BQ{};Pye.prototype.isWebGL1Renderer=!0;var OQ=class{constructor(t,e=1,i=1e3){this.isFog=!0,this.name="",this.color=new Xt(t),this.near=e,this.far=i}clone(){return new OQ(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Wc=class extends ir{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}},Tye=class{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=XL,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Bl()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,i){t*=this.stride,i*=e.stride;for(let r=0,n=this.stride;r<n;r++)this.array[t+r]=e.array[i+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bl()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(e,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Bl()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Mo=new N,QL=class{constructor(t,e,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,i=this.data.count;e<i;e++)Mo.fromBufferAttribute(this,e),Mo.applyMatrix4(t),this.setXYZ(e,Mo.x,Mo.y,Mo.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Mo.fromBufferAttribute(this,e),Mo.applyNormalMatrix(t),this.setXYZ(e,Mo.x,Mo.y,Mo.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Mo.fromBufferAttribute(this,e),Mo.transformDirection(t),this.setXYZ(e,Mo.x,Mo.y,Mo.z);return this}setX(t,e){return this.normalized&&(e=br(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=br(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=br(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=br(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Nc(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Nc(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Nc(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Nc(e,this.array)),e}setXY(t,e,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=br(e,this.array),i=br(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this}setXYZ(t,e,i,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=br(e,this.array),i=br(i,this.array),r=br(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this}setXYZW(t,e,i,r,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=br(e,this.array),i=br(i,this.array),r=br(r,this.array),n=br(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=r,this.data.array[t+3]=n,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)e.push(this.data.array[r+n])}return new ei(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new QL(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)e.push(this.data.array[r+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},UQ=class extends ir{constructor(){super(),this.isBone=!0,this.type="Bone"}},Dl=class extends Wr{constructor(t=null,e=1,i=1,r,n,s,o,a,l=Zi,u=Zi,c,h){super(null,s,o,a,l,u,r,n,c,h),this.isDataTexture=!0,this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Gj=new lt,Rye=new lt,PF=class{constructor(t=[],e=[]){this.uuid=Bl(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),e.length===0)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new lt)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){let i=new lt;this.bones[t]&&i.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&i.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){let i=this.bones[t];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let t=this.bones,e=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let n=0,s=t.length;n<s;n++){let o=t[n]?t[n].matrixWorld:Rye;Gj.multiplyMatrices(o,e[n]),Gj.toArray(i,n*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new PF(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=wQ(t),t=Math.max(t,4);let e=new Float32Array(t*t*4);e.set(this.boneMatrices);let i=new Dl(e,t,t,_s,Fn);return i.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=i,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,i=this.bones.length;e<i;e++){let r=this.bones[e];if(r.name===t)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let i=0,r=t.bones.length;i<r;i++){let n=t.bones[i],s=e[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new UQ),this.bones.push(s),this.boneInverses.push(new lt().fromArray(t.boneInverses[i]))}return this.init(),this}toJSON(){let t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;let e=this.bones,i=this.boneInverses;for(let r=0,n=e.length;r<n;r++){let s=e[r];t.bones.push(s.uuid);let o=i[r];t.boneInverses.push(o.toArray())}return t}},qw=class extends ei{constructor(t,e,i,r=1){super(t,e,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},Vj=new lt,jj=new lt,nA=[],kye=new lt,Wb=new zn,Dye=class extends zn{constructor(e,i,r){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new qw(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let n=0;n<r;n++)this.setMatrixAt(n,kye)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){let r=this.matrixWorld,n=this.count;if(Wb.geometry=this.geometry,Wb.material=this.material,Wb.material!==void 0)for(let s=0;s<n;s++){this.getMatrixAt(s,Vj),jj.multiplyMatrices(r,Vj),Wb.matrixWorld=jj,Wb.raycast(e,nA);for(let o=0,a=nA.length;o<a;o++){let l=nA[o];l.instanceId=s,l.object=this,i.push(l)}nA.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new qw(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},Xp=class extends Y1{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},Wj=new N,qj=new N,Xj=new lt,cD=new O0,sA=new xa,qC=class extends ir{constructor(t=new Ht,e=new Xp){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[0];for(let r=1,n=e.count;r<n;r++)Wj.fromBufferAttribute(e,r-1),qj.fromBufferAttribute(e,r),i[r]=i[r-1],i[r]+=Wj.distanceTo(qj);t.setAttribute("lineDistance",new _t(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let i=this.geometry,r=this.matrixWorld,n=t.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),sA.copy(i.boundingSphere),sA.applyMatrix4(r),sA.radius+=n,t.ray.intersectsSphere(sA)===!1)return;Xj.copy(r).invert(),cD.copy(t.ray).applyMatrix4(Xj);let o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new N,u=new N,c=new N,h=new N,d=this.isLineSegments?2:1,p=i.index,f=i.attributes.position;if(p!==null){let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let y=m,v=g-1;y<v;y+=d){let b=p.getX(y),_=p.getX(y+1);if(l.fromBufferAttribute(f,b),u.fromBufferAttribute(f,_),cD.distanceSqToSegment(l,u,h,c)>a)continue;h.applyMatrix4(this.matrixWorld);let A=t.ray.origin.distanceTo(h);A<t.near||A>t.far||e.push({distance:A,point:c.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let y=m,v=g-1;y<v;y+=d){if(l.fromBufferAttribute(f,y),u.fromBufferAttribute(f,y+1),cD.distanceSqToSegment(l,u,h,c)>a)continue;h.applyMatrix4(this.matrixWorld);let b=t.ray.origin.distanceTo(h);b<t.near||b>t.far||e.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let i=t[e[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=i.length;r<n;r++){let s=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=r}}}}},Yj=new N,Kj=new N,K1=class extends qC{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[];for(let r=0,n=e.count;r<n;r+=2)Yj.fromBufferAttribute(e,r),Kj.fromBufferAttribute(e,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Yj.distanceTo(Kj);t.setAttribute("lineDistance",new _t(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},Iye=class extends Wr{constructor(t,e,i,r,n,s,o,a,l){super(t,e,i,r,n,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:mi,this.magFilter=n!==void 0?n:mi,this.generateMipmaps=!1;let u=this;function c(){u.needsUpdate=!0,t.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},Lye=class extends Wr{constructor(t,e,i,r,n,s,o,a,l){super(t,e,i,r,n,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},Gh=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){let e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],i,r=this.getPoint(0),n=0;e.push(0);for(let s=1;s<=t;s++)i=this.getPoint(s/t),n+=i.distanceTo(r),e.push(n),r=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let i=this.getLengths(),r=0,n=i.length,s;e?s=e:s=t*i[n-1];let o=0,a=n-1,l;for(;o<=a;)if(r=Math.floor(o+(a-o)/2),l=i[r]-s,l<0)o=r+1;else if(l>0)a=r-1;else{a=r;break}if(r=a,i[r]===s)return r/(n-1);let u=i[r],c=i[r+1]-u,h=(s-u)/c;return(r+h)/(n-1)}getTangent(t,e){let i=t-1e-4,r=t+1e-4;i<0&&(i=0),r>1&&(r=1);let n=this.getPoint(i),s=this.getPoint(r),o=e||(n.isVector2?new me:new N);return o.copy(s).sub(n).normalize(),o}getTangentAt(t,e){let i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e){let i=new N,r=[],n=[],s=[],o=new N,a=new lt;for(let d=0;d<=t;d++){let p=d/t;r[d]=this.getTangentAt(p,new N)}n[0]=new N,s[0]=new N;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),c<=l&&(l=c,i.set(0,1,0)),h<=l&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),n[0].crossVectors(r[0],o),s[0].crossVectors(r[0],n[0]);for(let d=1;d<=t;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(r[d-1],r[d]),o.length()>Number.EPSILON){o.normalize();let p=Math.acos(Bn(r[d-1].dot(r[d]),-1,1));n[d].applyMatrix4(a.makeRotationAxis(o,p))}s[d].crossVectors(r[d],n[d])}if(e===!0){let d=Math.acos(Bn(n[0].dot(n[t]),-1,1));d/=t,r[0].dot(o.crossVectors(n[0],n[t]))>0&&(d=-d);for(let p=1;p<=t;p++)n[p].applyMatrix4(a.makeRotationAxis(r[p],d*p)),s[p].crossVectors(r[p],n[p])}return{tangents:r,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},MP=class extends Gh{constructor(t=0,e=0,i=1,r=1,n=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){let i=e||new me,r=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(s?n=0:n=r),this.aClockwise===!0&&!s&&(n===r?n=-r:n=n-r);let o=this.aStartAngle+t*n,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=a-this.aX,d=l-this.aY;a=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return i.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},Bye=class extends MP{constructor(t,e,i,r,n,s){super(t,e,i,i,r,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function TF(){let t=0,e=0,i=0,r=0;function n(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){n(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,c,h){let d=(o-s)/u-(a-s)/(u+c)+(a-o)/c,p=(a-o)/c-(l-o)/(c+h)+(l-a)/h;d*=c,p*=c,n(o,a,d,p)},calc:function(s){let o=s*s,a=o*s;return t+e*s+i*o+r*a}}}var oA=new N,dD=new TF,pD=new TF,fD=new TF,Oye=class extends Gh{constructor(t=[],e=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=r}getPoint(t,e=new N){let i=e,r=this.points,n=r.length,s=(n-(this.closed?0:1))*t,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/n)+1)*n:a===0&&o===n-1&&(o=n-2,a=1);let l,u;this.closed||o>0?l=r[(o-1)%n]:(oA.subVectors(r[0],r[1]).add(r[0]),l=oA);let c=r[o%n],h=r[(o+1)%n];if(this.closed||o+2<n?u=r[(o+2)%n]:(oA.subVectors(r[n-1],r[n-2]).add(r[n-1]),u=oA),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(c),d),f=Math.pow(c.distanceToSquared(h),d),m=Math.pow(h.distanceToSquared(u),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),dD.initNonuniformCatmullRom(l.x,c.x,h.x,u.x,p,f,m),pD.initNonuniformCatmullRom(l.y,c.y,h.y,u.y,p,f,m),fD.initNonuniformCatmullRom(l.z,c.z,h.z,u.z,p,f,m)}else this.curveType==="catmullrom"&&(dD.initCatmullRom(l.x,c.x,h.x,u.x,this.tension),pD.initCatmullRom(l.y,c.y,h.y,u.y,this.tension),fD.initCatmullRom(l.z,c.z,h.z,u.z,this.tension));return i.set(dD.calc(a),pD.calc(a),fD.calc(a)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let r=t.points[e];this.points.push(new N().fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function Jj(t,e,i,r,n){let s=(r-e)*.5,o=(n-i)*.5,a=t*t,l=t*a;return(2*i-2*r+s+o)*l+(-3*i+3*r-2*s-o)*a+s*t+i}function Uye(t,e){let i=1-t;return i*i*e}function Nye(t,e){return 2*(1-t)*t*e}function Fye(t,e){return t*t*e}function aw(t,e,i,r){return Uye(t,e)+Nye(t,i)+Fye(t,r)}function zye(t,e){let i=1-t;return i*i*i*e}function Hye(t,e){let i=1-t;return 3*i*i*t*e}function Gye(t,e){return 3*(1-t)*t*t*e}function Vye(t,e){return t*t*t*e}function lw(t,e,i,r,n){return zye(t,e)+Hye(t,i)+Gye(t,r)+Vye(t,n)}var gu=class extends Gh{constructor(t=new me,e=new me,i=new me,r=new me){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=i,this.v3=r}getPoint(t,e=new me){let i=e,r=this.v0,n=this.v1,s=this.v2,o=this.v3;return i.set(lw(t,r.x,n.x,s.x,o.x),lw(t,r.y,n.y,s.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},CM=class extends Gh{constructor(t=new N,e=new N,i=new N,r=new N){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=r}getPoint(t,e=new N){let i=e,r=this.v0,n=this.v1,s=this.v2,o=this.v3;return i.set(lw(t,r.x,n.x,s.x,o.x),lw(t,r.y,n.y,s.y,o.y),lw(t,r.z,n.z,s.z,o.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},_u=class extends Gh{constructor(t=new me,e=new me){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new me){let i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){let i=e||new me;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},NQ=class extends Gh{constructor(t=new N,e=new N){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new N){let i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Up=class extends Gh{constructor(e=new me,i=new me,r=new me){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=r}getPoint(e,i=new me){let r=i,n=this.v0,s=this.v1,o=this.v2;return r.set(aw(e,n.x,s.x,o.x),aw(e,n.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},jye=class extends Gh{constructor(t=new N,e=new N,i=new N){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new N){let i=e,r=this.v0,n=this.v1,s=this.v2;return i.set(aw(t,r.x,n.x,s.x),aw(t,r.y,n.y,s.y),aw(t,r.z,n.z,s.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},RF=class extends Gh{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new me){let i=e,r=this.points,n=(r.length-1)*t,s=Math.floor(n),o=n-s,a=r[s===0?s:s-1],l=r[s],u=r[s>r.length-2?r.length-1:s+1],c=r[s>r.length-3?r.length-1:s+2];return i.set(Jj(o,a.x,l.x,u.x,c.x),Jj(o,a.y,l.y,u.y,c.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let r=t.points[e];this.points.push(r.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){let r=this.points[e];t.points.push(r.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){let r=t.points[e];this.points.push(new me().fromArray(r))}return this}},Wye=Object.freeze({__proto__:null,ArcCurve:Bye,CatmullRomCurve3:Oye,CubicBezierCurve:gu,CubicBezierCurve3:CM,EllipseCurve:MP,LineCurve:_u,LineCurve3:NQ,QuadraticBezierCurve:Up,QuadraticBezierCurve3:jye,SplineCurve:RF}),FQ=class extends Gh{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new _u(e,t))}getPoint(t,e){let i=t*this.getLength(),r=this.getCurveLengths(),n=0;for(;n<r.length;){if(r[n]>=i){let s=r[n]-i,o=this.curves[n],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,e)}n++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let i=0,r=this.curves.length;i<r;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],i;for(let r=0,n=this.curves;r<n.length;r++){let s=n[r],o=s.isEllipseCurve?t*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let l=0;l<a.length;l++){let u=a[l];i&&i.equals(u)||(e.push(u),i=u)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){let r=this.curves[e];t.curves.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){let r=t.curves[e];this.curves.push(new Wye[r.type]().fromJSON(r))}return this}},XC=class extends FQ{constructor(t){super(),this.type="Path",this.currentPoint=new me,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let i=new _u(this.currentPoint.clone(),new me(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,r){let n=new Up(this.currentPoint.clone(),new me(t,e),new me(i,r));return this.curves.push(n),this.currentPoint.set(i,r),this}bezierCurveTo(t,e,i,r,n,s){let o=new gu(this.currentPoint.clone(),new me(t,e),new me(i,r),new me(n,s));return this.curves.push(o),this.currentPoint.set(n,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),i=new RF(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,r,n,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,i,r,n,s),this}absarc(t,e,i,r,n,s){return this.absellipse(t,e,i,i,r,n,s),this}ellipse(t,e,i,r,n,s,o,a){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,i,r,n,s,o,a),this}absellipse(t,e,i,r,n,s,o,a){let l=new MP(t,e,i,r,n,s,o,a);if(this.curves.length>0){let c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},zQ=class extends Ht{constructor(t=[new me(0,-.5),new me(.5,0),new me(0,.5)],e=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:r},e=Math.floor(e),r=Bn(r,0,Math.PI*2);let n=[],s=[],o=[],a=[],l=[],u=1/e,c=new N,h=new me,d=new N,p=new N,f=new N,m=0,g=0;for(let y=0;y<=t.length-1;y++)switch(y){case 0:m=t[y+1].x-t[y].x,g=t[y+1].y-t[y].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(f.x,f.y,f.z);break;default:m=t[y+1].x-t[y].x,g=t[y+1].y-t[y].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),a.push(d.x,d.y,d.z),f.copy(p)}for(let y=0;y<=e;y++){let v=i+y*u*r,b=Math.sin(v),_=Math.cos(v);for(let A=0;A<=t.length-1;A++){c.x=t[A].x*b,c.y=t[A].y,c.z=t[A].x*_,s.push(c.x,c.y,c.z),h.x=y/e,h.y=A/(t.length-1),o.push(h.x,h.y);let S=a[3*A+0]*b,E=a[3*A+1],M=a[3*A+0]*_;l.push(S,E,M)}}for(let y=0;y<e;y++)for(let v=0;v<t.length-1;v++){let b=v+y*t.length,_=b,A=b+t.length,S=b+t.length+1,E=b+1;n.push(_,A,E),n.push(S,E,A)}this.setIndex(n),this.setAttribute("position",new _t(s,3)),this.setAttribute("uv",new _t(o,2)),this.setAttribute("normal",new _t(l,3))}static fromJSON(t){return new zQ(t.points,t.segments,t.phiStart,t.phiLength)}},kF=class extends Ht{constructor(t=1,e=1,i=1,r=32,n=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:n,openEnded:s,thetaStart:o,thetaLength:a};let l=this;r=Math.floor(r),n=Math.floor(n);let u=[],c=[],h=[],d=[],p=0,f=[],m=i/2,g=0;y(),s===!1&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new _t(c,3)),this.setAttribute("normal",new _t(h,3)),this.setAttribute("uv",new _t(d,2));function y(){let b=new N,_=new N,A=0,S=(e-t)/i;for(let E=0;E<=n;E++){let M=[],R=E/n,C=R*(e-t)+t;for(let T=0;T<=r;T++){let L=T/r,I=L*a+o,D=Math.sin(I),F=Math.cos(I);_.x=C*D,_.y=-R*i+m,_.z=C*F,c.push(_.x,_.y,_.z),b.set(D,S,F).normalize(),h.push(b.x,b.y,b.z),d.push(L,1-R),M.push(p++)}f.push(M)}for(let E=0;E<r;E++)for(let M=0;M<n;M++){let R=f[M][E],C=f[M+1][E],T=f[M+1][E+1],L=f[M][E+1];u.push(R,C,L),u.push(C,T,L),A+=6}l.addGroup(g,A,0),g+=A}function v(b){let _=p,A=new me,S=new N,E=0,M=b===!0?t:e,R=b===!0?1:-1;for(let T=1;T<=r;T++)c.push(0,m*R,0),h.push(0,R,0),d.push(.5,.5),p++;let C=p;for(let T=0;T<=r;T++){let L=T/r*a+o,I=Math.cos(L),D=Math.sin(L);S.x=M*D,S.y=m*R,S.z=M*I,c.push(S.x,S.y,S.z),h.push(0,R,0),A.x=I*.5+.5,A.y=D*.5*R+.5,d.push(A.x,A.y),p++}for(let T=0;T<r;T++){let L=_+T,I=C+T;b===!0?u.push(I,I+1,L):u.push(I+1,I,L),E+=3}l.addGroup(g,E,b===!0?1:2),g+=E}}static fromJSON(t){return new kF(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},DF=class extends kF{constructor(t=1,e=1,i=32,r=1,n=!1,s=0,o=Math.PI*2){super(0,t,e,i,r,n,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:s,thetaLength:o}}static fromJSON(t){return new DF(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},IF=class extends Ht{constructor(t=[],e=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:r};let n=[],s=[];o(r),l(i),u(),this.setAttribute("position",new _t(n,3)),this.setAttribute("normal",new _t(n.slice(),3)),this.setAttribute("uv",new _t(s,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(y){let v=new N,b=new N,_=new N;for(let A=0;A<e.length;A+=3)d(e[A+0],v),d(e[A+1],b),d(e[A+2],_),a(v,b,_,y)}function a(y,v,b,_){let A=_+1,S=[];for(let E=0;E<=A;E++){S[E]=[];let M=y.clone().lerp(b,E/A),R=v.clone().lerp(b,E/A),C=A-E;for(let T=0;T<=C;T++)T===0&&E===A?S[E][T]=M:S[E][T]=M.clone().lerp(R,T/C)}for(let E=0;E<A;E++)for(let M=0;M<2*(A-E)-1;M++){let R=Math.floor(M/2);M%2===0?(h(S[E][R+1]),h(S[E+1][R]),h(S[E][R])):(h(S[E][R+1]),h(S[E+1][R+1]),h(S[E+1][R]))}}function l(y){let v=new N;for(let b=0;b<n.length;b+=3)v.x=n[b+0],v.y=n[b+1],v.z=n[b+2],v.normalize().multiplyScalar(y),n[b+0]=v.x,n[b+1]=v.y,n[b+2]=v.z}function u(){let y=new N;for(let v=0;v<n.length;v+=3){y.x=n[v+0],y.y=n[v+1],y.z=n[v+2];let b=m(y)/2/Math.PI+.5,_=g(y)/Math.PI+.5;s.push(b,1-_)}p(),c()}function c(){for(let y=0;y<s.length;y+=6){let v=s[y+0],b=s[y+2],_=s[y+4],A=Math.max(v,b,_),S=Math.min(v,b,_);A>.9&&S<.1&&(v<.2&&(s[y+0]+=1),b<.2&&(s[y+2]+=1),_<.2&&(s[y+4]+=1))}}function h(y){n.push(y.x,y.y,y.z)}function d(y,v){let b=y*3;v.x=t[b+0],v.y=t[b+1],v.z=t[b+2]}function p(){let y=new N,v=new N,b=new N,_=new N,A=new me,S=new me,E=new me;for(let M=0,R=0;M<n.length;M+=9,R+=6){y.set(n[M+0],n[M+1],n[M+2]),v.set(n[M+3],n[M+4],n[M+5]),b.set(n[M+6],n[M+7],n[M+8]),A.set(s[R+0],s[R+1]),S.set(s[R+2],s[R+3]),E.set(s[R+4],s[R+5]),_.copy(y).add(v).add(b).divideScalar(3);let C=m(_);f(A,R+0,y,C),f(S,R+2,v,C),f(E,R+4,b,C)}}function f(y,v,b,_){_<0&&y.x===1&&(s[v]=y.x-1),b.x===0&&b.z===0&&(s[v]=_/2/Math.PI+.5)}function m(y){return Math.atan2(y.z,-y.x)}function g(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}static fromJSON(t){return new IF(t.vertices,t.indices,t.radius,t.details)}},HQ=class extends IF{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new HQ(t.radius,t.detail)}},YC=class extends XC{constructor(t){super(t),this.uuid=Bl(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let i=0,r=this.holes.length;i<r;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let r=t.holes[e];this.holes.push(r.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){let r=this.holes[e];t.holes.push(r.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){let r=t.holes[e];this.holes.push(new XC().fromJSON(r))}return this}},qye={triangulate:function(t,e,i=2){let r=e&&e.length,n=r?e[0]*i:t.length,s=GQ(t,0,n,i,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,u,c,h,d,p;if(r&&(s=Qye(t,e,s,i)),t.length>80*i){a=u=t[0],l=c=t[1];for(let f=i;f<n;f+=i)h=t[f],d=t[f+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);p=Math.max(u-a,c-l),p=p!==0?32767/p:0}return Xw(s,o,i,a,l,p,0),o}};function GQ(t,e,i,r,n){let s,o;if(n===lve(t,e,i,r)>0)for(s=e;s<i;s+=r)o=Qj(s,t[s],t[s+1],o);else for(s=i-r;s>=e;s-=r)o=Qj(s,t[s],t[s+1],o);return o&&CP(o,o.next)&&(Kw(o),o=o.next),o}function Bm(t,e){if(!t)return t;e||(e=t);let i=t,r;do if(r=!1,!i.steiner&&(CP(i,i.next)||Gr(i.prev,i,i.next)===0)){if(Kw(i),i=e=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==e);return e}function Xw(t,e,i,r,n,s,o){if(!t)return;!o&&s&&ive(t,r,n,s);let a=t,l,u;for(;t.prev!==t.next;){if(l=t.prev,u=t.next,s?Yye(t,r,n,s):Xye(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(u.i/i|0),Kw(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=Kye(Bm(t),e,i),Xw(t,e,i,r,n,s,2)):o===2&&Jye(t,e,i,r,n,s):Xw(Bm(t),e,i,r,n,s,1);break}}}function Xye(t){let e=t.prev,i=t,r=t.next;if(Gr(e,i,r)>=0)return!1;let n=e.x,s=i.x,o=r.x,a=e.y,l=i.y,u=r.y,c=n<s?n<o?n:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=n>s?n>o?n:o:s>o?s:o,p=a>l?a>u?a:u:l>u?l:u,f=r.next;for(;f!==e;){if(f.x>=c&&f.x<=d&&f.y>=h&&f.y<=p&&av(n,a,s,l,o,u,f.x,f.y)&&Gr(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Yye(t,e,i,r){let n=t.prev,s=t,o=t.next;if(Gr(n,s,o)>=0)return!1;let a=n.x,l=s.x,u=o.x,c=n.y,h=s.y,d=o.y,p=a<l?a<u?a:u:l<u?l:u,f=c<h?c<d?c:d:h<d?h:d,m=a>l?a>u?a:u:l>u?l:u,g=c>h?c>d?c:d:h>d?h:d,y=ZL(p,f,e,i,r),v=ZL(m,g,e,i,r),b=t.prevZ,_=t.nextZ;for(;b&&b.z>=y&&_&&_.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==o&&av(a,c,l,h,u,d,b.x,b.y)&&Gr(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==o&&av(a,c,l,h,u,d,_.x,_.y)&&Gr(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==o&&av(a,c,l,h,u,d,b.x,b.y)&&Gr(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==o&&av(a,c,l,h,u,d,_.x,_.y)&&Gr(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Kye(t,e,i){let r=t;do{let n=r.prev,s=r.next.next;!CP(n,s)&&VQ(n,r,r.next,s)&&Yw(n,s)&&Yw(s,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(s.i/i|0),Kw(r),Kw(r.next),r=t=s),r=r.next}while(r!==t);return Bm(r)}function Jye(t,e,i,r,n,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&sve(o,a)){let l=jQ(o,a);o=Bm(o,o.next),l=Bm(l,l.next),Xw(o,e,i,r,n,s,0),Xw(l,e,i,r,n,s,0);return}a=a.next}o=o.next}while(o!==t)}function Qye(t,e,i,r){let n=[],s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,u=GQ(t,a,l,r,!1),u===u.next&&(u.steiner=!0),n.push(nve(u));for(n.sort(Zye),s=0;s<n.length;s++)i=$ye(n[s],i);return i}function Zye(t,e){return t.x-e.x}function $ye(t,e){let i=eve(t,e);if(!i)return e;let r=jQ(i,t);return Bm(r,r.next),Bm(i,i.next)}function eve(t,e){let i=e,r=-1/0,n,s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){let d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>r&&(r=d,n=i.x<i.next.x?i:i.next,d===s))return n}i=i.next}while(i!==e);if(!n)return null;let a=n,l=n.x,u=n.y,c=1/0,h;i=n;do s>=i.x&&i.x>=l&&s!==i.x&&av(o<u?s:r,o,l,u,o<u?r:s,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(s-i.x),Yw(i,t)&&(h<c||h===c&&(i.x>n.x||i.x===n.x&&tve(n,i)))&&(n=i,c=h)),i=i.next;while(i!==a);return n}function tve(t,e){return Gr(t.prev,t,e.prev)<0&&Gr(e.next,t,t.next)<0}function ive(t,e,i,r){let n=t;do n.z===0&&(n.z=ZL(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,rve(n)}function rve(t){let e,i,r,n,s,o,a,l,u=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,r=i,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(l=u;a>0||l>0&&r;)a!==0&&(l===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,l--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,u*=2}while(o>1);return t}function ZL(t,e,i,r,n){return t=(t-i)*n|0,e=(e-r)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function nve(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function av(t,e,i,r,n,s,o,a){return(n-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(n-o)*(r-a)}function sve(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ove(t,e)&&(Yw(t,e)&&Yw(e,t)&&ave(t,e)&&(Gr(t.prev,t,e.prev)||Gr(t,e.prev,e))||CP(t,e)&&Gr(t.prev,t,t.next)>0&&Gr(e.prev,e,e.next)>0)}function Gr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function CP(t,e){return t.x===e.x&&t.y===e.y}function VQ(t,e,i,r){let n=lA(Gr(t,e,i)),s=lA(Gr(t,e,r)),o=lA(Gr(i,r,t)),a=lA(Gr(i,r,e));return!!(n!==s&&o!==a||n===0&&aA(t,i,e)||s===0&&aA(t,r,e)||o===0&&aA(i,t,r)||a===0&&aA(i,e,r))}function aA(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function lA(t){return t>0?1:t<0?-1:0}function ove(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&VQ(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function Yw(t,e){return Gr(t.prev,t,t.next)<0?Gr(t,e,t.next)>=0&&Gr(t,t.prev,e)>=0:Gr(t,e,t.prev)<0||Gr(t,t.next,e)<0}function ave(t,e){let i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==t);return r}function jQ(t,e){let i=new $L(t.i,t.x,t.y),r=new $L(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function Qj(t,e,i,r){let n=new $L(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Kw(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $L(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lve(t,e,i,r){let n=0;for(let s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}var WQ=class{static area(t){let e=t.length,i=0;for(let r=e-1,n=0;n<e;r=n++)i+=t[r].x*t[n].y-t[n].x*t[r].y;return i*.5}static isClockWise(t){return WQ.area(t)<0}static triangulateShape(t,e){let i=[],r=[],n=[];Zj(t),$j(i,t);let s=t.length;e.forEach(Zj);for(let a=0;a<e.length;a++)r.push(s),s+=e[a].length,$j(i,e[a]);let o=qye.triangulate(i,r);for(let a=0;a<o.length;a+=3)n.push(o.slice(a,a+3));return n}};function Zj(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function $j(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}var qQ=class extends IF{constructor(t=1,e=0){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,n,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new qQ(t.radius,t.detail)}},Av=class extends Ht{constructor(t=1,e=32,i=16,r=0,n=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:n,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));let a=Math.min(s+o,Math.PI),l=0,u=[],c=new N,h=new N,d=[],p=[],f=[],m=[];for(let g=0;g<=i;g++){let y=[],v=g/i,b=0;g==0&&s==0?b=.5/e:g==i&&a==Math.PI&&(b=-.5/e);for(let _=0;_<=e;_++){let A=_/e;c.x=-t*Math.cos(r+A*n)*Math.sin(s+v*o),c.y=t*Math.cos(s+v*o),c.z=t*Math.sin(r+A*n)*Math.sin(s+v*o),p.push(c.x,c.y,c.z),h.copy(c).normalize(),f.push(h.x,h.y,h.z),m.push(A+b,1-v),y.push(l++)}u.push(y)}for(let g=0;g<i;g++)for(let y=0;y<e;y++){let v=u[g][y+1],b=u[g][y],_=u[g+1][y],A=u[g+1][y+1];(g!==0||s>0)&&d.push(v,b,A),(g!==i-1||a<Math.PI)&&d.push(b,_,A)}this.setIndex(d),this.setAttribute("position",new _t(p,3)),this.setAttribute("normal",new _t(f,3)),this.setAttribute("uv",new _t(m,2))}static fromJSON(t){return new Av(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},XQ=class extends Ht{constructor(t=1,e=.4,i=12,r=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:r,arc:n},i=Math.floor(i),r=Math.floor(r);let s=[],o=[],a=[],l=[],u=new N,c=new N,h=new N;for(let d=0;d<=i;d++)for(let p=0;p<=r;p++){let f=p/r*n,m=d/i*Math.PI*2;c.x=(t+e*Math.cos(m))*Math.cos(f),c.y=(t+e*Math.cos(m))*Math.sin(f),c.z=e*Math.sin(m),o.push(c.x,c.y,c.z),u.x=t*Math.cos(f),u.y=t*Math.sin(f),h.subVectors(c,u).normalize(),a.push(h.x,h.y,h.z),l.push(p/r),l.push(d/i)}for(let d=1;d<=i;d++)for(let p=1;p<=r;p++){let f=(r+1)*d+p-1,m=(r+1)*(d-1)+p-1,g=(r+1)*(d-1)+p,y=(r+1)*d+p;s.push(f,m,y),s.push(m,g,y)}this.setIndex(s),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(a,3)),this.setAttribute("uv",new _t(l,2))}static fromJSON(t){return new XQ(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}},YQ=class extends Ht{constructor(t=1,e=.4,i=64,r=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:r,p:n,q:s},i=Math.floor(i),r=Math.floor(r);let o=[],a=[],l=[],u=[],c=new N,h=new N,d=new N,p=new N,f=new N,m=new N,g=new N;for(let v=0;v<=i;++v){let b=v/i*n*Math.PI*2;y(b,n,s,t,d),y(b+.01,n,s,t,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let _=0;_<=r;++_){let A=_/r*Math.PI*2,S=-e*Math.cos(A),E=e*Math.sin(A);c.x=d.x+(S*g.x+E*f.x),c.y=d.y+(S*g.y+E*f.y),c.z=d.z+(S*g.z+E*f.z),a.push(c.x,c.y,c.z),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(v/i),u.push(_/r)}}for(let v=1;v<=i;v++)for(let b=1;b<=r;b++){let _=(r+1)*(v-1)+(b-1),A=(r+1)*v+(b-1),S=(r+1)*v+b,E=(r+1)*(v-1)+b;o.push(_,A,E),o.push(A,S,E)}this.setIndex(o),this.setAttribute("position",new _t(a,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(u,2));function y(v,b,_,A,S){let E=Math.cos(v),M=Math.sin(v),R=_/b*v,C=Math.cos(R);S.x=A*(2+C)*.5*E,S.y=A*(2+C)*M*.5,S.z=A*Math.sin(R)*.5}}static fromJSON(t){return new YQ(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}};function Ad(t,e,i){return KQ(t)?new t.constructor(t.subarray(e,i!==void 0?i:t.length)):t.slice(e,i)}function uA(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function KQ(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function uve(t){function e(n,s){return t[n]-t[s]}let i=t.length,r=new Array(i);for(let n=0;n!==i;++n)r[n]=n;return r.sort(e),r}function e6(t,e,i){let r=t.length,n=new t.constructor(r);for(let s=0,o=0;o!==r;++s){let a=i[s]*e;for(let l=0;l!==e;++l)n[o++]=t[a+l]}return n}function JQ(t,e,i,r){let n=1,s=t[0];for(;s!==void 0&&s[r]===void 0;)s=t[n++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[n++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[n++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),i.push(o)),s=t[n++];while(s!==void 0)}var PP=class{constructor(t,e,i,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,i=this._cachedIndex,r=e[i],n=e[i-1];e:{t:{let s;i:{r:if(!(t<r)){for(let o=i+2;;){if(r===void 0){if(t<n)break r;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(n=r,r=e[++i],t<r)break t}s=e.length;break i}if(!(t>=n)){let o=e[1];t<o&&(i=2,n=o);for(let a=i-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(r=n,n=e[--i-1],t>=n)break t}s=i,i=0;break i}break e}for(;i<s;){let o=i+s>>>1;t<e[o]?s=o:i=o+1}if(r=e[i],n=e[i-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=t*r;for(let s=0;s!==r;++s)e[s]=i[n+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},hve=class extends PP{constructor(t,e,i,r){super(t,e,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:nv,endingEnd:nv}}intervalChanged_(t,e,i){let r=this.parameterPositions,n=t-2,s=t+1,o=r[n],a=r[s];if(o===void 0)switch(this.getSettings_().endingStart){case sv:n=t,o=2*e-i;break;case VC:n=r.length-2,o=e+r[n]-r[n+1];break;default:n=t,o=i}if(a===void 0)switch(this.getSettings_().endingEnd){case sv:s=t,a=2*i-e;break;case VC:s=1,a=i+r[1]-r[0];break;default:s=t-1,a=e}let l=(i-e)*.5,u=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-i),this._offsetPrev=n*u,this._offsetNext=s*u}interpolate_(t,e,i,r){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-e)/(r-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f;for(let _=0;_!==o;++_)n[_]=g*s[u+_]+y*s[l+_]+v*s[a+_]+b*s[c+_];return n}},QQ=class extends PP{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t,e,i,r){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,u=(i-e)/(r-e),c=1-u;for(let h=0;h!==o;++h)n[h]=s[l+h]*c+s[a+h]*u;return n}},cve=class extends PP{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t){return this.copySampleValue_(t-1)}},Vh=class{constructor(t,e,i,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=uA(e,this.TimeBufferType),this.values=uA(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){let e=t.constructor,i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:uA(t.times,Array),values:uA(t.values,Array)};let r=t.getInterpolation();r!==t.DefaultInterpolation&&(i.interpolation=r)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new cve(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new QQ(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new hve(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case HC:e=this.InterpolantFactoryMethodDiscrete;break;case GC:e=this.InterpolantFactoryMethodLinear;break;case Fk:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return HC;case this.InterpolantFactoryMethodLinear:return GC;case this.InterpolantFactoryMethodSmooth:return Fk}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let e=this.times;for(let i=0,r=e.length;i!==r;++i)e[i]+=t}return this}scale(t){if(t!==1){let e=this.times;for(let i=0,r=e.length;i!==r;++i)e[i]*=t}return this}trim(t,e){let i=this.times,r=i.length,n=0,s=r-1;for(;n!==r&&i[n]<t;)++n;for(;s!==-1&&i[s]>e;)--s;if(++s,n!==0||s!==r){n>=s&&(s=Math.max(s,1),n=s-1);let o=this.getValueSize();this.times=Ad(i,n,s),this.values=Ad(this.values,n*o,s*o)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let i=this.times,r=this.values,n=i.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==n;o++){let a=i[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(s!==null&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),t=!1;break}s=a}if(r!==void 0&&KQ(r))for(let o=0,a=r.length;o!==a;++o){let l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}return t}optimize(){let t=Ad(this.times),e=Ad(this.values),i=this.getValueSize(),r=this.getInterpolation()===Fk,n=t.length-1,s=1;for(let o=1;o<n;++o){let a=!1,l=t[o],u=t[o+1];if(l!==u&&(o!==1||l!==t[0]))if(r)a=!0;else{let c=o*i,h=c-i,d=c+i;for(let p=0;p!==i;++p){let f=e[c+p];if(f!==e[h+p]||f!==e[d+p]){a=!0;break}}}if(a){if(o!==s){t[s]=t[o];let c=o*i,h=s*i;for(let d=0;d!==i;++d)e[h+d]=e[c+d]}++s}}if(n>0){t[s]=t[n];for(let o=n*i,a=s*i,l=0;l!==i;++l)e[a+l]=e[o+l];++s}return s!==t.length?(this.times=Ad(t,0,s),this.values=Ad(e,0,s*i)):(this.times=t,this.values=e),this}clone(){let t=Ad(this.times,0),e=Ad(this.values,0),i=this.constructor,r=new i(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}};Vh.prototype.TimeBufferType=Float32Array;Vh.prototype.ValueBufferType=Float32Array;Vh.prototype.DefaultInterpolation=GC;var F0=class extends Vh{};F0.prototype.ValueTypeName="bool";F0.prototype.ValueBufferType=Array;F0.prototype.DefaultInterpolation=HC;F0.prototype.InterpolantFactoryMethodLinear=void 0;F0.prototype.InterpolantFactoryMethodSmooth=void 0;var ZQ=class extends Vh{};ZQ.prototype.ValueTypeName="color";var KC=class extends Vh{};KC.prototype.ValueTypeName="number";var dve=class extends PP{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t,e,i,r){let n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(i-e)/(r-e),l=t*o;for(let u=l+o;l!==u;l+=4)ni.slerpFlat(n,0,s,l-o,s,l,a);return n}},J1=class extends Vh{InterpolantFactoryMethodLinear(t){return new dve(this.times,this.values,this.getValueSize(),t)}};J1.prototype.ValueTypeName="quaternion";J1.prototype.DefaultInterpolation=GC;J1.prototype.InterpolantFactoryMethodSmooth=void 0;var z0=class extends Vh{};z0.prototype.ValueTypeName="string";z0.prototype.ValueBufferType=Array;z0.prototype.DefaultInterpolation=HC;z0.prototype.InterpolantFactoryMethodLinear=void 0;z0.prototype.InterpolantFactoryMethodSmooth=void 0;var JC=class extends Vh{};JC.prototype.ValueTypeName="vector";var eB=class{constructor(t,e=-1,i,r=wF){this.name=t,this.tracks=i,this.duration=e,this.blendMode=r,this.uuid=Bl(),this.duration<0&&this.resetDuration()}static parse(t){let e=[],i=t.tracks,r=1/(t.fps||1);for(let s=0,o=i.length;s!==o;++s)e.push(fve(i[s]).scale(r));let n=new this(t.name,t.duration,e,t.blendMode);return n.uuid=t.uuid,n}static toJSON(t){let e=[],i=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let n=0,s=i.length;n!==s;++n)e.push(Vh.toJSON(i[n]));return r}static CreateFromMorphTargetSequence(t,e,i,r){let n=e.length,s=[];for(let o=0;o<n;o++){let a=[],l=[];a.push((o+n-1)%n,o,(o+1)%n),l.push(0,1,0);let u=uve(a);a=e6(a,1,u),l=e6(l,1,u),!r&&a[0]===0&&(a.push(n),l.push(l[0])),s.push(new KC(".morphTargetInfluences["+e[o].name+"]",a,l).scale(1/i))}return new this(t,-1,s)}static findByName(t,e){let i=t;if(!Array.isArray(t)){let r=t;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null}static CreateClipsFromMorphTargetSequences(t,e,i){let r={},n=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){let l=t[o],u=l.name.match(n);if(u&&u.length>1){let c=u[1],h=r[c];h||(r[c]=h=[]),h.push(l)}}let s=[];for(let o in r)s.push(this.CreateFromMorphTargetSequence(o,r[o],e,i));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(u,c,h,d,p){if(h.length!==0){let f=[],m=[];JQ(h,f,m,d),f.length!==0&&p.push(new u(c,f,m))}},r=[],n=t.name||"default",s=t.fps||30,o=t.blendMode,a=t.length||-1,l=t.hierarchy||[];for(let u=0;u<l.length;u++){let c=l[u].keys;if(!(!c||c.length===0))if(c[0].morphTargets){let h={},d;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(let p=0;p<c[d].morphTargets.length;p++)h[c[d].morphTargets[p]]=-1;for(let p in h){let f=[],m=[];for(let g=0;g!==c[d].morphTargets.length;++g){let y=c[d];f.push(y.time),m.push(y.morphTarget===p?1:0)}r.push(new KC(".morphTargetInfluence["+p+"]",f,m))}a=h.length*s}else{let h=".bones["+e[u].name+"]";i(JC,h+".position",c,"pos",r),i(J1,h+".quaternion",c,"rot",r),i(JC,h+".scale",c,"scl",r)}}return r.length===0?null:new this(n,a,r,o)}resetDuration(){let t=this.tracks,e=0;for(let i=0,r=t.length;i!==r;++i){let n=this.tracks[i];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function pve(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return KC;case"vector":case"vector2":case"vector3":case"vector4":return JC;case"color":return ZQ;case"quaternion":return J1;case"bool":case"boolean":return F0;case"string":return z0}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function fve(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=pve(t.type);if(t.times===void 0){let i=[],r=[];JQ(t.keys,i,r,"value"),t.times=i,t.values=r}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var QC={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},$Q=class{constructor(t,e,i){let r=this,n=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(u){o++,n===!1&&r.onStart!==void 0&&r.onStart(u,s,o),n=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,o),s===o&&(n=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return a?a(u):u},this.setURLModifier=function(u){return a=u,this},this.addHandler=function(u,c){return l.push(u,c),this},this.removeHandler=function(u){let c=l.indexOf(u);return c!==-1&&l.splice(c,2),this},this.getHandler=function(u){for(let c=0,h=l.length;c<h;c+=2){let d=l[c],p=l[c+1];if(d.global&&(d.lastIndex=0),d.test(u))return p}return null}}},mve=new $Q,Q1=class{constructor(t){this.manager=t!==void 0?t:mve,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let i=this;return new Promise(function(r,n){i.load(t,r,e,n)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},ac={},gve=class extends Error{constructor(t,e){super(t),this.response=e}},tB=class extends Q1{constructor(t){super(t)}load(t,e,i,r){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let n=QC.get(t);if(n!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(n),this.manager.itemEnd(t)},0),n;if(ac[t]!==void 0){ac[t].push({onLoad:e,onProgress:i,onError:r});return}ac[t]=[],ac[t].push({onLoad:e,onProgress:i,onError:r});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let u=ac[t],c=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0,f=0,m=new ReadableStream({start(g){y();function y(){c.read().then(({done:v,value:b})=>{if(v)g.close();else{f+=b.byteLength;let _=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:d});for(let A=0,S=u.length;A<S;A++){let E=u[A];E.onProgress&&E.onProgress(_)}g.enqueue(b),y()}})}}});return new Response(m)}else throw new gve(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return l.json();default:if(o===void 0)return l.text();{let u=/charset="?([^;"\s]*)"?/i.exec(o),c=u&&u[1]?u[1].toLowerCase():void 0,h=new TextDecoder(c);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{QC.add(t,l);let u=ac[t];delete ac[t];for(let c=0,h=u.length;c<h;c++){let d=u[c];d.onLoad&&d.onLoad(l)}}).catch(l=>{let u=ac[t];if(u===void 0)throw this.manager.itemError(t),l;delete ac[t];for(let c=0,h=u.length;c<h;c++){let d=u[c];d.onError&&d.onError(l)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},yve=class extends Q1{constructor(t){super(t)}load(t,e,i,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let n=this,s=QC.get(t);if(s!==void 0)return n.manager.itemStart(t),setTimeout(function(){e&&e(s),n.manager.itemEnd(t)},0),s;let o=Ww("img");function a(){u(),QC.add(t,this),e&&e(this),n.manager.itemEnd(t)}function l(c){u(),r&&r(c),n.manager.itemError(t),n.manager.itemEnd(t)}function u(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(t),o.src=t,o}},vve=class extends Q1{constructor(t){super(t)}load(t,e,i,r){let n=new Wr,s=new yve(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(o){n.image=o,n.needsUpdate=!0,e!==void 0&&e(n)},i,r),n}},Z1=class extends ir{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Xt(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},bve=class extends Z1{constructor(t,e,i){super(t,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ir.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Xt(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}},mD=new lt,t6=new N,i6=new N,LF=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new me(512,512),this.map=null,this.mapPass=null,this.matrix=new lt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new EF,this._frameExtents=new me(1,1),this._viewportCount=1,this._viewports=[new si(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,i=this.matrix;t6.setFromMatrixPosition(t.matrixWorld),e.position.copy(t6),i6.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(i6),e.updateMatrixWorld(),mD.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mD),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(mD)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},xve=class extends LF{constructor(){super(new uo(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){let e=this.camera,i=jw*2*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=t.distance||e.far;(i!==e.fov||r!==e.aspect||n!==e.far)&&(e.fov=i,e.aspect=r,e.far=n,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}},wve=class extends Z1{constructor(t,e,i=0,r=Math.PI/3,n=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ir.DEFAULT_UP),this.updateMatrix(),this.target=new ir,this.distance=i,this.angle=r,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new xve}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},r6=new lt,qb=new N,gD=new N,_ve=class extends LF{constructor(){super(new uo(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new me(4,2),this._viewportCount=6,this._viewports=[new si(2,1,1,1),new si(0,1,1,1),new si(3,1,1,1),new si(1,1,1,1),new si(3,0,1,1),new si(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(t,e=0){let i=this.camera,r=this.matrix,n=t.distance||i.far;n!==i.far&&(i.far=n,i.updateProjectionMatrix()),qb.setFromMatrixPosition(t.matrixWorld),i.position.copy(qb),gD.copy(i.position),gD.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(gD),i.updateMatrixWorld(),r.makeTranslation(-qb.x,-qb.y,-qb.z),r6.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r6)}},Sve=class extends Z1{constructor(t,e,i=0,r=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new _ve}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}},Ave=class extends LF{constructor(){super(new MF(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Eve=class extends Z1{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ir.DEFAULT_UP),this.updateMatrix(),this.target=new ir,this.shadow=new Ave}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},eZ=class extends Ht{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){let t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}},tZ=class extends Q1{constructor(t){super(t)}load(t,e,i,r){let n=this,s=new tB(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(t,function(o){try{e(n.parse(JSON.parse(o)))}catch(a){r?r(a):console.error(a),n.manager.itemError(t)}},i,r)}parse(t){let e={},i={};function r(h,d){if(e[d]!==void 0)return e[d];let p=h.interleavedBuffers[d],f=n(h,p.buffer),m=FS(p.type,f),g=new Tye(m,p.stride);return g.uuid=p.uuid,e[d]=g,g}function n(h,d){if(i[d]!==void 0)return i[d];let p=h.arrayBuffers[d],f=new Uint32Array(p).buffer;return i[d]=f,f}let s=t.isInstancedBufferGeometry?new eZ:new Ht,o=t.data.index;if(o!==void 0){let h=FS(o.type,o.array);s.setIndex(new ei(h,1))}let a=t.data.attributes;for(let h in a){let d=a[h],p;if(d.isInterleavedBufferAttribute){let f=r(t.data,d.data);p=new QL(f,d.itemSize,d.offset,d.normalized)}else{let f=FS(d.type,d.array),m=d.isInstancedBufferAttribute?qw:ei;p=new m(f,d.itemSize,d.normalized)}d.name!==void 0&&(p.name=d.name),d.usage!==void 0&&p.setUsage(d.usage),d.updateRange!==void 0&&(p.updateRange.offset=d.updateRange.offset,p.updateRange.count=d.updateRange.count),s.setAttribute(h,p)}let l=t.data.morphAttributes;if(l)for(let h in l){let d=l[h],p=[];for(let f=0,m=d.length;f<m;f++){let g=d[f],y;if(g.isInterleavedBufferAttribute){let v=r(t.data,g.data);y=new QL(v,g.itemSize,g.offset,g.normalized)}else{let v=FS(g.type,g.array);y=new ei(v,g.itemSize,g.normalized)}g.name!==void 0&&(y.name=g.name),p.push(y)}s.morphAttributes[h]=p}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let u=t.data.groups||t.data.drawcalls||t.data.offsets;if(u!==void 0)for(let h=0,d=u.length;h!==d;++h){let p=u[h];s.addGroup(p.start,p.count,p.materialIndex)}let c=t.data.boundingSphere;if(c!==void 0){let h=new N;c.center!==void 0&&h.fromArray(c.center),s.boundingSphere=new xa(h,c.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}},Mve=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=n6(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=n6();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function n6(){return(typeof performance>"u"?Date:performance).now()}var Cve=class{constructor(t,e,i){this.binding=t,this.valueSize=i;let r,n,s;switch(e){case"quaternion":r=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){let i=this.buffer,r=this.valueSize,n=t*r+r,s=this.cumulativeWeight;if(s===0){for(let o=0;o!==r;++o)i[n+o]=i[o];s=e}else{s+=e;let o=e/s;this._mixBufferRegion(i,n,0,o,r)}this.cumulativeWeight=s}accumulateAdditive(t){let e=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){let e=this.valueSize,i=this.buffer,r=t*e+e,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let a=e*this._origIndex;this._mixBufferRegion(i,r,a,1-n,e)}s>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(i[a]!==i[a+e]){o.setValue(i,r);break}}saveOriginalState(){let t=this.binding,e=this.buffer,i=this.valueSize,r=i*this._origIndex;t.getValue(e,r);for(let n=i,s=r;n!==s;++n)e[n]=e[r+n%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){let t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]}_select(t,e,i,r,n){if(r>=.5)for(let s=0;s!==n;++s)t[e+s]=t[i+s]}_slerp(t,e,i,r){ni.slerpFlat(t,e,t,e,t,i,r)}_slerpAdditive(t,e,i,r,n){let s=this._workIndex*n;ni.multiplyQuaternionsFlat(t,s,t,e,t,i),ni.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,i,r,n){let s=1-r;for(let o=0;o!==n;++o){let a=e+o;t[a]=t[a]*s+t[i+o]*r}}_lerpAdditive(t,e,i,r,n){for(let s=0;s!==n;++s){let o=e+s;t[o]=t[o]+t[i+s]*r}}},BF="\\[\\]\\.:\\/",Pve=new RegExp("["+BF+"]","g"),OF="[^"+BF+"]",Tve="[^"+BF.replace("\\.","")+"]",Rve=/((?:WC+[\/:])*)/.source.replace("WC",OF),kve=/(WCOD+)?/.source.replace("WCOD",Tve),Dve=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",OF),Ive=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",OF),Lve=new RegExp("^"+Rve+kve+Dve+Ive+"$"),Bve=["material","materials","bones","map"],Ove=class{constructor(t,e,i){let r=i||fr.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(t,e)}setValue(t,e){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},fr=class{constructor(t,e,i){this.path=e,this.parsedPath=i||fr.parseTrackName(e),this.node=fr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new fr.Composite(t,e,i):new fr(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Pve,"")}static parseTrackName(t){let e=Lve.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){let n=i.nodeName.substring(r+1);Bve.indexOf(n)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=n)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){let i=t.skeleton.getBoneByName(e);if(i!==void 0)return i}if(t.children){let i=function(n){for(let s=0;s<n.length;s++){let o=n[s];if(o.name===e||o.uuid===e)return o;let a=i(o.children);if(a)return a}return null},r=i(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)t[e++]=i[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node,e=this.parsedPath,i=e.objectName,r=e.propertyName,n=e.propertyIndex;if(t||(t=fr.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let l=e.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let u=0;u<t.length;u++)if(t[u].name===l){l=u;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(l!==void 0){if(t[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[l]}}let s=t[r];if(s===void 0){let l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(n!==void 0){if(r==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[n]!==void 0&&(n=t.morphTargetDictionary[n])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};fr.Composite=Ove;fr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};fr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};fr.prototype.GetterByBindingType=[fr.prototype._getValue_direct,fr.prototype._getValue_array,fr.prototype._getValue_arrayElement,fr.prototype._getValue_toArray];fr.prototype.SetterByBindingTypeAndVersioning=[[fr.prototype._setValue_direct,fr.prototype._setValue_direct_setNeedsUpdate,fr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_array,fr.prototype._setValue_array_setNeedsUpdate,fr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_arrayElement,fr.prototype._setValue_arrayElement_setNeedsUpdate,fr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_fromArray,fr.prototype._setValue_fromArray_setNeedsUpdate,fr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Uve=class{constructor(t,e,i=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=r;let n=e.tracks,s=n.length,o=new Array(s),a={endingStart:nv,endingEnd:nv};for(let l=0;l!==s;++l){let u=n[l].createInterpolant(null);o[l]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bQ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){let r=this._clip.duration,n=t._clip.duration,s=n/r,o=r/n;t.warp(1,s,e),this.warp(o,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){let t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){let r=this._mixer,n=r.time,s=this.timeScale,o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);let a=o.parameterPositions,l=o.sampleValues;return a[0]=n,a[1]=n+i,l[0]=t/s,l[1]=e/s,this}stopWarping(){let t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,r){if(!this.enabled){this._updateWeight(t);return}let n=this._startTime;if(n!==null){let a=(t-n)*i;a<0||i===0?e=0:(this._startTime=null,e=i*a)}e*=this._updateTimeScale(t);let s=this._updateTime(e),o=this._updateWeight(t);if(o>0){let a=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case pde:for(let u=0,c=a.length;u!==c;++u)a[u].evaluate(s),l[u].accumulateAdditive(o);break;case wF:default:for(let u=0,c=a.length;u!==c;++u)a[u].evaluate(s),l[u].accumulate(r,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;let i=this._weightInterpolant;if(i!==null){let r=i.evaluate(t)[0];e*=r,t>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let r=i.evaluate(t)[0];e*=r,t>i.parameterPositions[1]&&(this.stopWarping(),e===0?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){let e=this._clip.duration,i=this.loop,r=this.time+t,n=this._loopCount,s=i===xF;if(t===0)return n===-1?r:s&&(n&1)===1?e-r:r;if(i===vQ){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=e)r=e;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(n===-1&&(t>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=e||r<0){let o=Math.floor(r/e);r-=e*o,n+=Math.abs(o);let a=this.repetitions-n;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(a===1){let l=t<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(s&&(n&1)===1)return e-r}return r}_setEndings(t,e,i){let r=this._interpolantSettings;i?(r.endingStart=sv,r.endingEnd=sv):(t?r.endingStart=this.zeroSlopeAtStart?sv:nv:r.endingStart=VC,e?r.endingEnd=this.zeroSlopeAtEnd?sv:nv:r.endingEnd=VC)}_scheduleFading(t,e,i){let r=this._mixer,n=r.time,s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);let o=s.parameterPositions,a=s.sampleValues;return o[0]=n,a[0]=e,o[1]=n+t,a[1]=i,this}},Nve=new Float32Array(1),Fve=class extends Ys{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){let i=t._localRoot||this._root,r=t._clip.tracks,n=r.length,s=t._propertyBindings,o=t._interpolants,a=i.uuid,l=this._bindingsByRootAndName,u=l[a];u===void 0&&(u={},l[a]=u);for(let c=0;c!==n;++c){let h=r[c],d=h.name,p=u[d];if(p!==void 0)++p.referenceCount,s[c]=p;else{if(p=s[c],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,a,d));continue}let f=e&&e._propertyBindings[c].binding.parsedPath;p=new Cve(fr.create(i,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,a,d),s[c]=p}o[c].resultBuffer=p.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){let i=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,i)}let e=t._propertyBindings;for(let i=0,r=e.length;i!==r;++i){let n=e[i];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){let e=t._propertyBindings;for(let i=0,r=e.length;i!==r;++i){let n=e[i];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){let e=t._cacheIndex;return e!==null&&e<this._nActiveActions}_addInactiveAction(t,e,i){let r=this._actions,n=this._actionsByClip,s=n[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,n[e]=s;else{let o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=r.length,r.push(t),s.actionByRoot[i]=t}_removeInactiveAction(t){let e=this._actions,i=e[e.length-1],r=t._cacheIndex;i._cacheIndex=r,e[r]=i,e.pop(),t._cacheIndex=null;let n=t._clip.uuid,s=this._actionsByClip,o=s[n],a=o.knownActions,l=a[a.length-1],u=t._byClipCacheIndex;l._byClipCacheIndex=u,a[u]=l,a.pop(),t._byClipCacheIndex=null;let c=o.actionByRoot,h=(t._localRoot||this._root).uuid;delete c[h],a.length===0&&delete s[n],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){let e=t._propertyBindings;for(let i=0,r=e.length;i!==r;++i){let n=e[i];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(t){let e=this._actions,i=t._cacheIndex,r=this._nActiveActions++,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n}_takeBackAction(t){let e=this._actions,i=t._cacheIndex,r=--this._nActiveActions,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n}_addInactiveBinding(t,e,i){let r=this._bindingsByRootAndName,n=this._bindings,s=r[e];s===void 0&&(s={},r[e]=s),s[i]=t,t._cacheIndex=n.length,n.push(t)}_removeInactiveBinding(t){let e=this._bindings,i=t.binding,r=i.rootNode.uuid,n=i.path,s=this._bindingsByRootAndName,o=s[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[n],Object.keys(o).length===0&&delete s[r]}_lendBinding(t){let e=this._bindings,i=t._cacheIndex,r=this._nActiveBindings++,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n}_takeBackBinding(t){let e=this._bindings,i=t._cacheIndex,r=--this._nActiveBindings,n=e[r];t._cacheIndex=r,e[r]=t,n._cacheIndex=i,e[i]=n}_lendControlInterpolant(){let t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return i===void 0&&(i=new QQ(new Float32Array(2),new Float32Array(2),1,Nve),i.__cacheIndex=e,t[e]=i),i}_takeBackControlInterpolant(t){let e=this._controlInterpolants,i=t.__cacheIndex,r=--this._nActiveControlInterpolants,n=e[r];t.__cacheIndex=r,e[r]=t,n.__cacheIndex=i,e[i]=n}clipAction(t,e,i){let r=e||this._root,n=r.uuid,s=typeof t=="string"?eB.findByName(r,t):t,o=s!==null?s.uuid:t,a=this._actionsByClip[o],l=null;if(i===void 0&&(s!==null?i=s.blendMode:i=wF),a!==void 0){let c=a.actionByRoot[n];if(c!==void 0&&c.blendMode===i)return c;l=a.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let u=new Uve(this,s,e,i);return this._bindAction(u,l),this._addInactiveAction(u,o,n),u}existingAction(t,e){let i=e||this._root,r=i.uuid,n=typeof t=="string"?eB.findByName(i,t):t,s=n?n.uuid:t,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){let t=this._actions,e=this._nActiveActions;for(let i=e-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;let e=this._actions,i=this._nActiveActions,r=this.time+=t,n=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==i;++l)e[l]._update(r,t,n,s);let o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){let e=this._actions,i=t.uuid,r=this._actionsByClip,n=r[i];if(n!==void 0){let s=n.knownActions;for(let o=0,a=s.length;o!==a;++o){let l=s[o];this._deactivateAction(l);let u=l._cacheIndex,c=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,e[u]=c,e.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(t){let e=t.uuid,i=this._actionsByClip;for(let s in i){let o=i[s].actionByRoot,a=o[e];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}let r=this._bindingsByRootAndName,n=r[e];if(n!==void 0)for(let s in n){let o=n[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(t,e){let i=this.existingAction(t,e);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},st=class{constructor(t){this.value=t}clone(){return new st(this.value.clone===void 0?this.value:this.value.clone())}},iZ=class{constructor(t,e,i=0,r=1/0){this.ray=new O0(t,e),this.near=i,this.far=r,this.camera=null,this.layers=new SF,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,i=[]){return iB(t,this,i,e),i.sort(s6),i}intersectObjects(t,e=!0,i=[]){for(let r=0,n=t.length;r<n;r++)iB(t[r],this,i,e);return i.sort(s6),i}};function s6(t,e){return t.distance-e.distance}function iB(t,e,i,r){if(t.layers.test(e.layers)&&t.raycast(e,i),r===!0){let n=t.children;for(let s=0,o=n.length;s<o;s++)iB(n[s],e,i,!0)}}var o6=class{constructor(t=1,e=0,i=0){return this.radius=t,this.phi=e,this.theta=i,this}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(Bn(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},a6=new me,rZ=class{constructor(t=new me(1/0,1/0),e=new me(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=a6.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return a6.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},l6=new N,hA=new N,Ol=class{constructor(t=new N,e=new N){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){l6.subVectors(t,this.start),hA.subVectors(this.end,this.start);let i=hA.dot(hA),r=hA.dot(l6)/i;return e&&(r=Bn(r,0,1)),r}closestPointToPoint(t,e,i){let r=this.closestPointToPointParameter(t,e);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},u6=new N,zve=class extends ir{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";let i=new Ht,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,u=o/a*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new _t(r,3));let n=new Xp({fog:!1,toneMapped:!1});this.cone=new K1(i,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),u6.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(u6),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Hve=class extends zn{constructor(t,e,i){let r=new Av(e,4,2),n=new Km({wireframe:!0,fog:!1,toneMapped:!1});super(r,n),this.light=t,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},h6=new N,cA=new N,c6=new N,Gve=class extends ir{constructor(t,e,i){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",e===void 0&&(e=1);let r=new Ht;r.setAttribute("position",new _t([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));let n=new Xp({fog:!1,toneMapped:!1});this.lightPlane=new qC(r,n),this.add(this.lightPlane),r=new Ht,r.setAttribute("position",new _t([0,0,0,0,0,1],3)),this.targetLine=new qC(r,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),h6.setFromMatrixPosition(this.light.matrixWorld),cA.setFromMatrixPosition(this.light.target.matrixWorld),c6.subVectors(cA,h6),this.lightPlane.lookAt(cA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(cA),this.targetLine.scale.z=c6.length()}},dA=new N,Qr=new Jm,ZC=class extends K1{constructor(t){let e=new Ht,i=new Xp({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],n=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,f){a(p),a(f)}function a(p){r.push(0,0,0),n.push(0,0,0),s[p]===void 0&&(s[p]=[]),s[p].push(r.length/3-1)}e.setAttribute("position",new _t(r,3)),e.setAttribute("color",new _t(n,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Xt(16755200),u=new Xt(16711680),c=new Xt(43775),h=new Xt(16777215),d=new Xt(3355443);this.setColors(l,u,c,h,d)}setColors(t,e,i,r,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let t=this.geometry,e=this.pointMap,i=1,r=1;Qr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),fn("c",e,t,Qr,0,0,-1),fn("t",e,t,Qr,0,0,1),fn("n1",e,t,Qr,-i,-r,-1),fn("n2",e,t,Qr,i,-r,-1),fn("n3",e,t,Qr,-i,r,-1),fn("n4",e,t,Qr,i,r,-1),fn("f1",e,t,Qr,-i,-r,1),fn("f2",e,t,Qr,i,-r,1),fn("f3",e,t,Qr,-i,r,1),fn("f4",e,t,Qr,i,r,1),fn("u1",e,t,Qr,i*.7,r*1.1,-1),fn("u2",e,t,Qr,-i*.7,r*1.1,-1),fn("u3",e,t,Qr,0,r*2,-1),fn("cf1",e,t,Qr,-i,0,1),fn("cf2",e,t,Qr,i,0,1),fn("cf3",e,t,Qr,0,-r,1),fn("cf4",e,t,Qr,0,r,1),fn("cn1",e,t,Qr,-i,0,-1),fn("cn2",e,t,Qr,i,0,-1),fn("cn3",e,t,Qr,0,-r,-1),fn("cn4",e,t,Qr,0,r,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function fn(t,e,i,r,n,s,o){dA.set(n,s,o).unproject(r);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],dA.x,dA.y,dA.z)}}var $C=class extends K1{constructor(t,e=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new Ht;n.setIndex(new ei(i,1)),n.setAttribute("position",new _t(r,3)),super(n,new Xp({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},Vve=class extends K1{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ht;r.setAttribute("position",new _t(e,3)),r.setAttribute("color",new _t(i,3));let n=new Xp({vertexColors:!0,toneMapped:!1});super(r,n),this.type="AxesHelper"}setColors(t,e,i){let r=new Xt,n=this.geometry.attributes.color.array;return r.set(t),r.toArray(n,0),r.toArray(n,3),r.set(e),r.toArray(n,6),r.toArray(n,9),r.set(i),r.toArray(n,12),r.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},kc=jve();function jve(){let t=new ArrayBuffer(4),e=new Float32Array(t),i=new Uint32Array(t),r=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let u=l-127;u<-27?(r[l]=0,r[l|256]=32768,n[l]=24,n[l|256]=24):u<-14?(r[l]=1024>>-u-14,r[l|256]=1024>>-u-14|32768,n[l]=-u-1,n[l|256]=-u-1):u<=15?(r[l]=u+15<<10,r[l|256]=u+15<<10|32768,n[l]=13,n[l|256]=13):u<128?(r[l]=31744,r[l|256]=64512,n[l]=24,n[l|256]=24):(r[l]=31744,r[l|256]=64512,n[l]=13,n[l|256]=13)}let s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:i,baseTable:r,shiftTable:n,mantissaTable:s,exponentTable:o,offsetTable:a}}function Wve(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Bn(t,-65504,65504),kc.floatView[0]=t;let e=kc.uint32View[0],i=e>>23&511;return kc.baseTable[i]+((e&8388607)>>kc.shiftTable[i])}function qve(t){let e=t>>10;return kc.uint32View[0]=kc.mantissaTable[kc.offsetTable[e]+(t&1023)]+kc.exponentTable[e],kc.floatView[0]}var Xve=Object.freeze({__proto__:null,fromHalfFloat:qve,toHalfFloat:Wve});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:B0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=B0);var Xb=".",UF=Symbol("target"),nZ=Symbol("unsubscribe");function rB(t){return t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap||ArrayBuffer.isView(t)}function Yve(t){return(typeof t=="object"?t===null:typeof t!="function")||t instanceof RegExp}var gh=Array.isArray;function NF(t){return typeof t=="symbol"}var Kve={after:(t,e)=>gh(t)?t.slice(e.length):e===""?t:t.slice(e.length+1),concat:(t,e)=>gh(t)?(t=[...t],e&&t.push(e),t):e&&e.toString!==void 0?(t!==""&&(t+=Xb),NF(e)?t+e.toString():t+e):t,initial:t=>{if(gh(t))return t.slice(0,-1);if(t==="")return t;let e=t.lastIndexOf(Xb);return e===-1?"":t.slice(0,e)},last:t=>{if(gh(t))return t[t.length-1]||"";if(t==="")return t;let e=t.lastIndexOf(Xb);return e===-1?t:t.slice(e+1)},walk:(t,e)=>{if(gh(t))for(let i of t)e(i);else if(t!==""){let i=0,r=t.indexOf(Xb);if(r===-1)e(t);else for(;i<t.length;)r===-1&&(r=t.length),e(t.slice(i,r)),i=r+1,r=t.indexOf(Xb,i)}},get(t,e){return this.walk(e,i=>{t&&(t=t[i])}),t}},bl=Kve;function Jve(t){return typeof t=="object"&&typeof t.next=="function"}function Qve(t,e,i,r,n){let s=t.next;if(e.name==="entries")t.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=n(o.value[0],e,o.value[0],r),o.value[1]=n(o.value[1],e,o.value[0],r)),o};else if(e.name==="values"){let o=i[UF].keys();t.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,e,o.next().value,r)),a}}else t.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,e,o.value,r)),o};return t}function d6(t,e,i){return t.isUnsubscribed||e.ignoreSymbols&&NF(i)||e.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(i)}var Zve=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){let e=this._getDescriptorCache(),i=e.get(t);return i===void 0&&(i={},e.set(t,i)),i}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);let i=this._getProperties(t),r=i[e];return r===void 0&&(r=Reflect.getOwnPropertyDescriptor(t,e),i[e]=r),r}getProxy(t,e,i,r){if(this.isUnsubscribed)return t;let n=t[r],s=n||t;this._pathCache.set(s,e);let o=this._proxyCache.get(s);return o===void 0&&(o=n===void 0?new Proxy(t,i):t,this._proxyCache.set(s,o)),o}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return!Object.is(t,bl.get(e,this.getPath(t)))}defineProperty(t,e,i){return Reflect.defineProperty(t,e,i)?(this.isUnsubscribed||(this._getProperties(t)[e]=i),!0):!1}setProperty(t,e,i,r,n){if(!this._equals(n,i)||!(e in t)){let s=this._getOwnPropertyDescriptor(t,e);return s!==void 0&&"set"in s?Reflect.set(t,e,i,r):Reflect.set(t,e,i)}return!0}deleteProperty(t,e,i){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){let r=this._getDescriptorCache().get(t);r&&(delete r[e],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(t,e,i){let r=this._getOwnPropertyDescriptor(e,i);return t!==void 0&&r!==void 0&&Object.is(t.value,r.value)&&(t.writable||!1)===(r.writable||!1)&&(t.enumerable||!1)===(r.enumerable||!1)&&(t.configurable||!1)===(r.configurable||!1)&&t.get===r.get&&t.set===r.set}isGetInvariant(t,e){let i=this._getOwnPropertyDescriptor(t,e);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function nB(t){return toString.call(t)==="[object Object]"}function pA(){return!0}function zg(t,e){return t.length!==e.length||t.some((i,r)=>e[r]!==i)}var sZ=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),$ve=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),oZ={push:pA,pop:pA,shift:pA,unshift:pA,copyWithin:zg,reverse:zg,sort:zg,splice:zg,flat:zg,fill:zg},e0e=new Set([...sZ,...$ve,...Object.keys(oZ)]);function fA(t,e){if(t.size!==e.size)return!0;for(let i of t)if(!e.has(i))return!0;return!1}var aZ=["keys","values","entries"],lZ=new Set(["has","toString"]),uZ={add:fA,clear:fA,delete:fA,forEach:fA},t0e=new Set([...lZ,...Object.keys(uZ),...aZ]);function mA(t,e){if(t.size!==e.size)return!0;let i;for(let[r,n]of t)if(i=e.get(r),i!==n||i===void 0&&!e.has(r))return!0;return!1}var i0e=new Set([...lZ,"get"]),hZ={set:mA,clear:mA,delete:mA,forEach:mA},r0e=new Set([...i0e,...Object.keys(hZ),...aZ]),Np=class{constructor(t,e,i,r){this._path=e,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=r,this._changes=r?[]:null,this.clone=e===void 0?t:this._shallowClone(t)}static isHandledMethod(t){return sZ.has(t)}_shallowClone(t){let e=t;if(nB(t))e={...t};else if(gh(t))e=[...t];else if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set([...t].map(i=>this._shallowClone(i)));else if(t instanceof Map){e=new Map;for(let[i,r]of t.entries())e.set(i,this._shallowClone(r))}return this._clonedCache.add(e),e}preferredThisArg(t,e,i,r){return t?(gh(r)?this._onIsChanged=oZ[e]:r instanceof Set?this._onIsChanged=uZ[e]:r instanceof Map&&(this._onIsChanged=hZ[e]),r):i}update(t,e,i){let r=bl.after(t,this._path);if(e!=="length"){let n=this.clone;bl.walk(r,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:r,property:e,previous:i}),n&&n[e]&&(n[e]=i)}this._isChanged=!0}undo(t){let e;for(let i=this._changes.length-1;i!==-1;i--)e=this._changes[i],bl.get(t,e.path)[e.property]=e.previous}isChanged(t){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,t)}},p6=class extends Np{static isHandledMethod(t){return e0e.has(t)}},n0e=class extends Np{undo(t){t.setTime(this.clone.getTime())}isChanged(t,e){return!e(this.clone.valueOf(),t.valueOf())}},f6=class extends Np{static isHandledMethod(t){return t0e.has(t)}undo(t){for(let e of this.clone)t.add(e);for(let e of t)this.clone.has(e)||t.delete(e)}},m6=class extends Np{static isHandledMethod(t){return r0e.has(t)}undo(t){for(let[e,i]of this.clone.entries())t.set(e,i);for(let e of t.keys())this.clone.has(e)||t.delete(e)}},s0e=class extends Np{constructor(t,e,i,r){super(void 0,e,i,r),this._arg1=i[0],this._weakValue=t.has(this._arg1)}isChanged(t){return this._weakValue!==t.has(this._arg1)}undo(t){this._weakValue&&!t.has(this._arg1)?t.add(this._arg1):t.delete(this._arg1)}},o0e=class extends Np{constructor(t,e,i,r){super(void 0,e,i,r),this._weakKey=i[0],this._weakHas=t.has(this._weakKey),this._weakValue=t.get(this._weakKey)}isChanged(t){return this._weakValue!==t.get(this._weakKey)}undo(t){let e=t.has(this._weakKey);this._weakHas&&!e?t.set(this._weakKey,this._weakValue):!this._weakHas&&e?t.delete(this._weakKey):this._weakValue!==t.get(this._weakKey)&&t.set(this._weakKey,this._weakValue)}},Ny=class{constructor(t){this._stack=[],this._hasOnValidate=t}static isHandledType(t){return nB(t)||gh(t)||rB(t)}static isHandledMethod(t,e){return nB(t)?Np.isHandledMethod(e):gh(t)?p6.isHandledMethod(e):t instanceof Set?f6.isHandledMethod(e):t instanceof Map?m6.isHandledMethod(e):rB(t)}get isCloning(){return this._stack.length>0}start(t,e,i){let r=Np;gh(t)?r=p6:t instanceof Date?r=n0e:t instanceof Set?r=f6:t instanceof Map?r=m6:t instanceof WeakSet?r=s0e:t instanceof WeakMap&&(r=o0e),this._stack.push(new r(t,e,i,this._hasOnValidate))}update(t,e,i){this._stack[this._stack.length-1].update(t,e,i)}preferredThisArg(t,e,i){let{name:r}=t,n=Ny.isHandledMethod(i,r);return this._stack[this._stack.length-1].preferredThisArg(n,r,e,i)}isChanged(t,e,i){return this._stack[this._stack.length-1].isChanged(t,e,i)}undo(t){this._previousClone!==void 0&&this._previousClone.undo(t)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},a0e={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},FF=(t,e,i={})=>{i={...a0e,...i};let r=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:o,details:a}=i,l=new Zve(n),u=typeof i.onValidate=="function",c=new Ny(u),h=(v,b,_,A,S)=>!u||c.isCloning||i.onValidate(bl.concat(l.getPath(v),b),_,A,S)===!0,d=(v,b,_,A)=>{!d6(l,i,b)&&!(o&&l.isDetached(v,t))&&p(l.getPath(v),b,_,A)},p=(v,b,_,A,S)=>{c.isCloning?c.update(v,b,A):e(bl.concat(v,b),_,A,S)},f=v=>v&&(v[r]||v),m=(v,b,_,A)=>Yve(v)||_==="constructor"||s&&!Ny.isHandledMethod(b,_)||d6(l,i,_)||l.isGetInvariant(b,_)||o&&l.isDetached(b,t)?v:(A===void 0&&(A=l.getPath(b)),l.getProxy(v,bl.concat(A,_),g,r)),g={get(v,b,_){if(NF(b)){if(b===r||b===UF)return v;if(b===nZ&&!l.isUnsubscribed&&l.getPath(v).length===0)return l.unsubscribe(),v}let A=rB(v)?Reflect.get(v,b):Reflect.get(v,b,_);return m(A,v,b)},set(v,b,_,A){_=f(_);let S=v[r]||v,E=S[b];if(n(E,_)&&b in v)return!0;let M=h(v,b,_,E);return M&&l.setProperty(S,b,_,A,E)?(d(v,b,v[b],E),!0):!M},defineProperty(v,b,_){if(!l.isSameDescriptor(_,v,b)){let A=v[b];h(v,b,_.value,A)&&l.defineProperty(v,b,_,A)&&d(v,b,_.value,A)}return!0},deleteProperty(v,b){if(!Reflect.has(v,b))return!0;let _=Reflect.get(v,b),A=h(v,b,void 0,_);return A&&l.deleteProperty(v,b,_)?(d(v,b,void 0,_),!0):!A},apply(v,b,_){let A=b[r]||b;if(l.isUnsubscribed)return Reflect.apply(v,A,_);if((a===!1||a!==!0&&!a.includes(v.name))&&Ny.isHandledType(A)){let S=bl.initial(l.getPath(v)),E=Ny.isHandledMethod(A,v.name);c.start(A,S,_);let M=Reflect.apply(v,c.preferredThisArg(v,b,A),E?_.map(T=>f(T)):_),R=c.isChanged(A,n),C=c.stop();if(Ny.isHandledType(M)&&E&&(b instanceof Map&&v.name==="get"&&(S=bl.concat(S,_[0])),M=l.getProxy(M,S,g)),R){let T={name:v.name,args:_,result:M},L=c.isCloning?bl.initial(S):S,I=c.isCloning?bl.last(S):"";h(bl.get(t,L),I,A,C,T)?p(L,I,A,C,T):c.undo(A)}return(b instanceof Map||b instanceof Set)&&Jve(M)?Qve(M,v,b,S,m):M}return Reflect.apply(v,b,_)}},y=l.getProxy(t,i.pathAsArray?[]:"",g);return e=e.bind(y),u&&(i.onValidate=i.onValidate.bind(y)),y};FF.target=t=>t&&t[UF]||t;FF.unsubscribe=t=>t[nZ]||t;var g6=FF,l0e=typeof global=="object"&&global&&global.Object===Object&&global,cZ=l0e,u0e=typeof self=="object"&&self&&self.Object===Object&&self,h0e=cZ||u0e||Function("return this")(),Du=h0e,c0e=Du.Symbol,Hl=c0e,dZ=Object.prototype,d0e=dZ.hasOwnProperty,p0e=dZ.toString,Yb=Hl?Hl.toStringTag:void 0;function f0e(t){var e=d0e.call(t,Yb),i=t[Yb];try{t[Yb]=void 0;var r=!0}catch{}var n=p0e.call(t);return r&&(e?t[Yb]=i:delete t[Yb]),n}var m0e=f0e,g0e=Object.prototype,y0e=g0e.toString;function v0e(t){return y0e.call(t)}var b0e=v0e,x0e="[object Null]",w0e="[object Undefined]",y6=Hl?Hl.toStringTag:void 0;function _0e(t){return t==null?t===void 0?w0e:x0e:y6&&y6 in Object(t)?m0e(t):b0e(t)}var Zm=_0e;function S0e(t){return t!=null&&typeof t=="object"}var ed=S0e,A0e="[object Symbol]";function E0e(t){return typeof t=="symbol"||ed(t)&&Zm(t)==A0e}var TP=E0e;function M0e(t,e){for(var i=-1,r=t==null?0:t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}var pZ=M0e,C0e=Array.isArray,Bh=C0e,P0e=1/0,v6=Hl?Hl.prototype:void 0,b6=v6?v6.toString:void 0;function fZ(t){if(typeof t=="string")return t;if(Bh(t))return pZ(t,fZ)+"";if(TP(t))return b6?b6.call(t):"";var e=t+"";return e=="0"&&1/t==-P0e?"-0":e}var T0e=fZ,R0e=/\s/;function k0e(t){for(var e=t.length;e--&&R0e.test(t.charAt(e)););return e}var D0e=k0e,I0e=/^\s+/;function L0e(t){return t&&t.slice(0,D0e(t)+1).replace(I0e,"")}var B0e=L0e;function O0e(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Pu=O0e,x6=0/0,U0e=/^[-+]0x[0-9a-f]+$/i,N0e=/^0b[01]+$/i,F0e=/^0o[0-7]+$/i,z0e=parseInt;function H0e(t){if(typeof t=="number")return t;if(TP(t))return x6;if(Pu(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Pu(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=B0e(t);var i=N0e.test(t);return i||F0e.test(t)?z0e(t.slice(2),i?2:8):U0e.test(t)?x6:+t}var w6=H0e;function G0e(t){return t}var V0e=G0e,j0e="[object AsyncFunction]",W0e="[object Function]",q0e="[object GeneratorFunction]",X0e="[object Proxy]";function Y0e(t){if(!Pu(t))return!1;var e=Zm(t);return e==W0e||e==q0e||e==j0e||e==X0e}var mZ=Y0e,K0e=Du["__core-js_shared__"],yD=K0e,_6=function(){var t=/[^.]+$/.exec(yD&&yD.keys&&yD.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function J0e(t){return!!_6&&_6 in t}var Q0e=J0e,Z0e=Function.prototype,$0e=Z0e.toString;function ebe(t){if(t!=null){try{return $0e.call(t)}catch{}try{return t+""}catch{}}return""}var $m=ebe,tbe=/[\\^$.*+?()[\]{}|]/g,ibe=/^\[object .+?Constructor\]$/,rbe=Function.prototype,nbe=Object.prototype,sbe=rbe.toString,obe=nbe.hasOwnProperty,abe=RegExp("^"+sbe.call(obe).replace(tbe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function lbe(t){if(!Pu(t)||Q0e(t))return!1;var e=mZ(t)?abe:ibe;return e.test($m(t))}var ube=lbe;function hbe(t,e){return t==null?void 0:t[e]}var cbe=hbe;function dbe(t,e){var i=cbe(t,e);return ube(i)?i:void 0}var eg=dbe,pbe=eg(Du,"WeakMap"),sB=pbe,S6=Object.create,fbe=function(){function t(){}return function(e){if(!Pu(e))return{};if(S6)return S6(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),mbe=fbe;function gbe(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}var ybe=gbe;function vbe(t,e){var i=-1,r=t.length;for(e||(e=Array(r));++i<r;)e[i]=t[i];return e}var bbe=vbe,xbe=800,wbe=16,_be=Date.now;function Sbe(t){var e=0,i=0;return function(){var r=_be(),n=wbe-(r-i);if(i=r,n>0){if(++e>=xbe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Abe=Sbe;function Ebe(t){return function(){return t}}var Mbe=Ebe,Cbe=function(){try{var t=eg(Object,"defineProperty");return t({},"",{}),t}catch{}}(),e2=Cbe,Pbe=e2?function(t,e){return e2(t,"toString",{configurable:!0,enumerable:!1,value:Mbe(e),writable:!0})}:V0e,Tbe=Pbe,Rbe=Abe(Tbe),kbe=Rbe;function Dbe(t,e){for(var i=-1,r=t==null?0:t.length;++i<r&&e(t[i],i,t)!==!1;);return t}var Ibe=Dbe,Lbe=9007199254740991,Bbe=/^(?:0|[1-9]\d*)$/;function Obe(t,e){var i=typeof t;return e=e??Lbe,!!e&&(i=="number"||i!="symbol"&&Bbe.test(t))&&t>-1&&t%1==0&&t<e}var zF=Obe;function Ube(t,e,i){e=="__proto__"&&e2?e2(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}var gZ=Ube;function Nbe(t,e){return t===e||t!==t&&e!==e}var HF=Nbe,Fbe=Object.prototype,zbe=Fbe.hasOwnProperty;function Hbe(t,e,i){var r=t[e];(!(zbe.call(t,e)&&HF(r,i))||i===void 0&&!(e in t))&&gZ(t,e,i)}var GF=Hbe;function Gbe(t,e,i,r){var n=!i;i||(i={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=r?r(i[a],t[a],a,i,t):void 0;l===void 0&&(l=t[a]),n?gZ(i,a,l):GF(i,a,l)}return i}var $1=Gbe,A6=Math.max;function Vbe(t,e,i){return e=A6(e===void 0?t.length-1:e,0),function(){for(var r=arguments,n=-1,s=A6(r.length-e,0),o=Array(s);++n<s;)o[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i(o),ybe(t,this,a)}}var jbe=Vbe,Wbe=9007199254740991;function qbe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Wbe}var VF=qbe;function Xbe(t){return t!=null&&VF(t.length)&&!mZ(t)}var yZ=Xbe,Ybe=Object.prototype;function Kbe(t){var e=t&&t.constructor,i=typeof e=="function"&&e.prototype||Ybe;return t===i}var jF=Kbe;function Jbe(t,e){for(var i=-1,r=Array(t);++i<t;)r[i]=e(i);return r}var Qbe=Jbe,Zbe="[object Arguments]";function $be(t){return ed(t)&&Zm(t)==Zbe}var E6=$be,vZ=Object.prototype,exe=vZ.hasOwnProperty,txe=vZ.propertyIsEnumerable,ixe=E6(function(){return arguments}())?E6:function(t){return ed(t)&&exe.call(t,"callee")&&!txe.call(t,"callee")},WF=ixe;function rxe(){return!1}var nxe=rxe,bZ=typeof Va=="object"&&Va&&!Va.nodeType&&Va,M6=bZ&&typeof ja=="object"&&ja&&!ja.nodeType&&ja,sxe=M6&&M6.exports===bZ,C6=sxe?Du.Buffer:void 0,oxe=C6?C6.isBuffer:void 0,axe=oxe||nxe,t2=axe,lxe="[object Arguments]",uxe="[object Array]",hxe="[object Boolean]",cxe="[object Date]",dxe="[object Error]",pxe="[object Function]",fxe="[object Map]",mxe="[object Number]",gxe="[object Object]",yxe="[object RegExp]",vxe="[object Set]",bxe="[object String]",xxe="[object WeakMap]",wxe="[object ArrayBuffer]",_xe="[object DataView]",Sxe="[object Float32Array]",Axe="[object Float64Array]",Exe="[object Int8Array]",Mxe="[object Int16Array]",Cxe="[object Int32Array]",Pxe="[object Uint8Array]",Txe="[object Uint8ClampedArray]",Rxe="[object Uint16Array]",kxe="[object Uint32Array]",Pr={};Pr[Sxe]=Pr[Axe]=Pr[Exe]=Pr[Mxe]=Pr[Cxe]=Pr[Pxe]=Pr[Txe]=Pr[Rxe]=Pr[kxe]=!0;Pr[lxe]=Pr[uxe]=Pr[wxe]=Pr[hxe]=Pr[_xe]=Pr[cxe]=Pr[dxe]=Pr[pxe]=Pr[fxe]=Pr[mxe]=Pr[gxe]=Pr[yxe]=Pr[vxe]=Pr[bxe]=Pr[xxe]=!1;function Dxe(t){return ed(t)&&VF(t.length)&&!!Pr[Zm(t)]}var Ixe=Dxe;function Lxe(t){return function(e){return t(e)}}var qF=Lxe,xZ=typeof Va=="object"&&Va&&!Va.nodeType&&Va,uw=xZ&&typeof ja=="object"&&ja&&!ja.nodeType&&ja,Bxe=uw&&uw.exports===xZ,vD=Bxe&&cZ.process,Oxe=function(){try{var t=uw&&uw.require&&uw.require("util").types;return t||vD&&vD.binding&&vD.binding("util")}catch{}}(),i0=Oxe,P6=i0&&i0.isTypedArray,Uxe=P6?qF(P6):Ixe,wZ=Uxe,Nxe=Object.prototype,Fxe=Nxe.hasOwnProperty;function zxe(t,e){var i=Bh(t),r=!i&&WF(t),n=!i&&!r&&t2(t),s=!i&&!r&&!n&&wZ(t),o=i||r||n||s,a=o?Qbe(t.length,String):[],l=a.length;for(var u in t)(e||Fxe.call(t,u))&&!(o&&(u=="length"||n&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||zF(u,l)))&&a.push(u);return a}var _Z=zxe;function Hxe(t,e){return function(i){return t(e(i))}}var SZ=Hxe,Gxe=SZ(Object.keys,Object),Vxe=Gxe,jxe=Object.prototype,Wxe=jxe.hasOwnProperty;function qxe(t){if(!jF(t))return Vxe(t);var e=[];for(var i in Object(t))Wxe.call(t,i)&&i!="constructor"&&e.push(i);return e}var Xxe=qxe;function Yxe(t){return yZ(t)?_Z(t):Xxe(t)}var XF=Yxe;function Kxe(t){var e=[];if(t!=null)for(var i in Object(t))e.push(i);return e}var Jxe=Kxe,Qxe=Object.prototype,Zxe=Qxe.hasOwnProperty;function $xe(t){if(!Pu(t))return Jxe(t);var e=jF(t),i=[];for(var r in t)r=="constructor"&&(e||!Zxe.call(t,r))||i.push(r);return i}var ewe=$xe;function twe(t){return yZ(t)?_Z(t,!0):ewe(t)}var Kf=twe,iwe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rwe=/^\w*$/;function nwe(t,e){if(Bh(t))return!1;var i=typeof t;return i=="number"||i=="symbol"||i=="boolean"||t==null||TP(t)?!0:rwe.test(t)||!iwe.test(t)||e!=null&&t in Object(e)}var swe=nwe,owe=eg(Object,"create"),Jw=owe;function awe(){this.__data__=Jw?Jw(null):{},this.size=0}var lwe=awe;function uwe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var hwe=uwe,cwe="__lodash_hash_undefined__",dwe=Object.prototype,pwe=dwe.hasOwnProperty;function fwe(t){var e=this.__data__;if(Jw){var i=e[t];return i===cwe?void 0:i}return pwe.call(e,t)?e[t]:void 0}var mwe=fwe,gwe=Object.prototype,ywe=gwe.hasOwnProperty;function vwe(t){var e=this.__data__;return Jw?e[t]!==void 0:ywe.call(e,t)}var bwe=vwe,xwe="__lodash_hash_undefined__";function wwe(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Jw&&e===void 0?xwe:e,this}var _we=wwe;function H0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}H0.prototype.clear=lwe;H0.prototype.delete=hwe;H0.prototype.get=mwe;H0.prototype.has=bwe;H0.prototype.set=_we;var T6=H0;function Swe(){this.__data__=[],this.size=0}var Awe=Swe;function Ewe(t,e){for(var i=t.length;i--;)if(HF(t[i][0],e))return i;return-1}var RP=Ewe,Mwe=Array.prototype,Cwe=Mwe.splice;function Pwe(t){var e=this.__data__,i=RP(e,t);if(i<0)return!1;var r=e.length-1;return i==r?e.pop():Cwe.call(e,i,1),--this.size,!0}var Twe=Pwe;function Rwe(t){var e=this.__data__,i=RP(e,t);return i<0?void 0:e[i][1]}var kwe=Rwe;function Dwe(t){return RP(this.__data__,t)>-1}var Iwe=Dwe;function Lwe(t,e){var i=this.__data__,r=RP(i,t);return r<0?(++this.size,i.push([t,e])):i[r][1]=e,this}var Bwe=Lwe;function G0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}G0.prototype.clear=Awe;G0.prototype.delete=Twe;G0.prototype.get=kwe;G0.prototype.has=Iwe;G0.prototype.set=Bwe;var kP=G0,Owe=eg(Du,"Map"),Qw=Owe;function Uwe(){this.size=0,this.__data__={hash:new T6,map:new(Qw||kP),string:new T6}}var Nwe=Uwe;function Fwe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var zwe=Fwe;function Hwe(t,e){var i=t.__data__;return zwe(e)?i[typeof e=="string"?"string":"hash"]:i.map}var DP=Hwe;function Gwe(t){var e=DP(this,t).delete(t);return this.size-=e?1:0,e}var Vwe=Gwe;function jwe(t){return DP(this,t).get(t)}var Wwe=jwe;function qwe(t){return DP(this,t).has(t)}var Xwe=qwe;function Ywe(t,e){var i=DP(this,t),r=i.size;return i.set(t,e),this.size+=i.size==r?0:1,this}var Kwe=Ywe;function V0(t){var e=-1,i=t==null?0:t.length;for(this.clear();++e<i;){var r=t[e];this.set(r[0],r[1])}}V0.prototype.clear=Nwe;V0.prototype.delete=Vwe;V0.prototype.get=Wwe;V0.prototype.has=Xwe;V0.prototype.set=Kwe;var IP=V0,Jwe="Expected a function";function YF(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Jwe);var i=function(){var r=arguments,n=e?e.apply(this,r):r[0],s=i.cache;if(s.has(n))return s.get(n);var o=t.apply(this,r);return i.cache=s.set(n,o)||s,o};return i.cache=new(YF.Cache||IP),i}YF.Cache=IP;var Qwe=YF,Zwe=500;function $we(t){var e=Qwe(t,function(r){return i.size===Zwe&&i.clear(),r}),i=e.cache;return e}var e1e=$we,t1e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i1e=/\\(\\)?/g,r1e=e1e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(t1e,function(i,r,n,s){e.push(n?s.replace(i1e,"$1"):r||i)}),e}),n1e=r1e;function s1e(t){return t==null?"":T0e(t)}var o1e=s1e;function a1e(t,e){return Bh(t)?t:swe(t,e)?[t]:n1e(o1e(t))}var j0=a1e,l1e=1/0;function u1e(t){if(typeof t=="string"||TP(t))return t;var e=t+"";return e=="0"&&1/t==-l1e?"-0":e}var LP=u1e;function h1e(t,e){e=j0(e,t);for(var i=0,r=e.length;t!=null&&i<r;)t=t[LP(e[i++])];return i&&i==r?t:void 0}var AZ=h1e;function c1e(t,e){for(var i=-1,r=e.length,n=t.length;++i<r;)t[n+i]=e[i];return t}var KF=c1e,R6=Hl?Hl.isConcatSpreadable:void 0;function d1e(t){return Bh(t)||WF(t)||!!(R6&&t&&t[R6])}var p1e=d1e;function EZ(t,e,i,r,n){var s=-1,o=t.length;for(i||(i=p1e),n||(n=[]);++s<o;){var a=t[s];e>0&&i(a)?e>1?EZ(a,e-1,i,r,n):KF(n,a):r||(n[n.length]=a)}return n}var f1e=EZ;function m1e(t){var e=t==null?0:t.length;return e?f1e(t,1):[]}var g1e=m1e;function y1e(t){return kbe(jbe(t,void 0,g1e),t+"")}var MZ=y1e,v1e=SZ(Object.getPrototypeOf,Object),JF=v1e,b1e="[object Object]",x1e=Function.prototype,w1e=Object.prototype,CZ=x1e.toString,_1e=w1e.hasOwnProperty,S1e=CZ.call(Object);function A1e(t){if(!ed(t)||Zm(t)!=b1e)return!1;var e=JF(t);if(e===null)return!0;var i=_1e.call(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&CZ.call(i)==S1e}var E1e=A1e;function M1e(t,e,i){var r=-1,n=t.length;e<0&&(e=-e>n?0:n+e),i=i>n?n:i,i<0&&(i+=n),n=e>i?0:i-e>>>0,e>>>=0;for(var s=Array(n);++r<n;)s[r]=t[r+e];return s}var C1e=M1e;function P1e(){this.__data__=new kP,this.size=0}var T1e=P1e;function R1e(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i}var k1e=R1e;function D1e(t){return this.__data__.get(t)}var I1e=D1e;function L1e(t){return this.__data__.has(t)}var B1e=L1e,O1e=200;function U1e(t,e){var i=this.__data__;if(i instanceof kP){var r=i.__data__;if(!Qw||r.length<O1e-1)return r.push([t,e]),this.size=++i.size,this;i=this.__data__=new IP(r)}return i.set(t,e),this.size=i.size,this}var N1e=U1e;function W0(t){var e=this.__data__=new kP(t);this.size=e.size}W0.prototype.clear=T1e;W0.prototype.delete=k1e;W0.prototype.get=I1e;W0.prototype.has=B1e;W0.prototype.set=N1e;var PM=W0;function F1e(t,e){return t&&$1(e,XF(e),t)}var z1e=F1e;function H1e(t,e){return t&&$1(e,Kf(e),t)}var G1e=H1e,PZ=typeof Va=="object"&&Va&&!Va.nodeType&&Va,k6=PZ&&typeof ja=="object"&&ja&&!ja.nodeType&&ja,V1e=k6&&k6.exports===PZ,D6=V1e?Du.Buffer:void 0,I6=D6?D6.allocUnsafe:void 0;function j1e(t,e){if(e)return t.slice();var i=t.length,r=I6?I6(i):new t.constructor(i);return t.copy(r),r}var W1e=j1e;function q1e(t,e){for(var i=-1,r=t==null?0:t.length,n=0,s=[];++i<r;){var o=t[i];e(o,i,t)&&(s[n++]=o)}return s}var X1e=q1e;function Y1e(){return[]}var TZ=Y1e,K1e=Object.prototype,J1e=K1e.propertyIsEnumerable,L6=Object.getOwnPropertySymbols,Q1e=L6?function(t){return t==null?[]:(t=Object(t),X1e(L6(t),function(e){return J1e.call(t,e)}))}:TZ,QF=Q1e;function Z1e(t,e){return $1(t,QF(t),e)}var $1e=Z1e,e_e=Object.getOwnPropertySymbols,t_e=e_e?function(t){for(var e=[];t;)KF(e,QF(t)),t=JF(t);return e}:TZ,RZ=t_e;function i_e(t,e){return $1(t,RZ(t),e)}var r_e=i_e;function n_e(t,e,i){var r=e(t);return Bh(t)?r:KF(r,i(t))}var kZ=n_e;function s_e(t){return kZ(t,XF,QF)}var oB=s_e;function o_e(t){return kZ(t,Kf,RZ)}var DZ=o_e,a_e=eg(Du,"DataView"),aB=a_e,l_e=eg(Du,"Promise"),lB=l_e,u_e=eg(Du,"Set"),uB=u_e,B6="[object Map]",h_e="[object Object]",O6="[object Promise]",U6="[object Set]",N6="[object WeakMap]",F6="[object DataView]",c_e=$m(aB),d_e=$m(Qw),p_e=$m(lB),f_e=$m(uB),m_e=$m(sB),kf=Zm;(aB&&kf(new aB(new ArrayBuffer(1)))!=F6||Qw&&kf(new Qw)!=B6||lB&&kf(lB.resolve())!=O6||uB&&kf(new uB)!=U6||sB&&kf(new sB)!=N6)&&(kf=function(t){var e=Zm(t),i=e==h_e?t.constructor:void 0,r=i?$m(i):"";if(r)switch(r){case c_e:return F6;case d_e:return B6;case p_e:return O6;case f_e:return U6;case m_e:return N6}return e});var Zw=kf,g_e=Object.prototype,y_e=g_e.hasOwnProperty;function v_e(t){var e=t.length,i=new t.constructor(e);return e&&typeof t[0]=="string"&&y_e.call(t,"index")&&(i.index=t.index,i.input=t.input),i}var b_e=v_e,x_e=Du.Uint8Array,i2=x_e;function w_e(t){var e=new t.constructor(t.byteLength);return new i2(e).set(new i2(t)),e}var ZF=w_e;function __e(t,e){var i=e?ZF(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}var S_e=__e,A_e=/\w*$/;function E_e(t){var e=new t.constructor(t.source,A_e.exec(t));return e.lastIndex=t.lastIndex,e}var M_e=E_e,z6=Hl?Hl.prototype:void 0,H6=z6?z6.valueOf:void 0;function C_e(t){return H6?Object(H6.call(t)):{}}var P_e=C_e;function T_e(t,e){var i=e?ZF(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}var R_e=T_e,k_e="[object Boolean]",D_e="[object Date]",I_e="[object Map]",L_e="[object Number]",B_e="[object RegExp]",O_e="[object Set]",U_e="[object String]",N_e="[object Symbol]",F_e="[object ArrayBuffer]",z_e="[object DataView]",H_e="[object Float32Array]",G_e="[object Float64Array]",V_e="[object Int8Array]",j_e="[object Int16Array]",W_e="[object Int32Array]",q_e="[object Uint8Array]",X_e="[object Uint8ClampedArray]",Y_e="[object Uint16Array]",K_e="[object Uint32Array]";function J_e(t,e,i){var r=t.constructor;switch(e){case F_e:return ZF(t);case k_e:case D_e:return new r(+t);case z_e:return S_e(t,i);case H_e:case G_e:case V_e:case j_e:case W_e:case q_e:case X_e:case Y_e:case K_e:return R_e(t,i);case I_e:return new r;case L_e:case U_e:return new r(t);case B_e:return M_e(t);case O_e:return new r;case N_e:return P_e(t)}}var Q_e=J_e;function Z_e(t){return typeof t.constructor=="function"&&!jF(t)?mbe(JF(t)):{}}var $_e=Z_e,eSe="[object Map]";function tSe(t){return ed(t)&&Zw(t)==eSe}var iSe=tSe,G6=i0&&i0.isMap,rSe=G6?qF(G6):iSe,nSe=rSe,sSe="[object Set]";function oSe(t){return ed(t)&&Zw(t)==sSe}var aSe=oSe,V6=i0&&i0.isSet,lSe=V6?qF(V6):aSe,uSe=lSe,hSe=1,cSe=2,dSe=4,IZ="[object Arguments]",pSe="[object Array]",fSe="[object Boolean]",mSe="[object Date]",gSe="[object Error]",LZ="[object Function]",ySe="[object GeneratorFunction]",vSe="[object Map]",bSe="[object Number]",BZ="[object Object]",xSe="[object RegExp]",wSe="[object Set]",_Se="[object String]",SSe="[object Symbol]",ASe="[object WeakMap]",ESe="[object ArrayBuffer]",MSe="[object DataView]",CSe="[object Float32Array]",PSe="[object Float64Array]",TSe="[object Int8Array]",RSe="[object Int16Array]",kSe="[object Int32Array]",DSe="[object Uint8Array]",ISe="[object Uint8ClampedArray]",LSe="[object Uint16Array]",BSe="[object Uint32Array]",wr={};wr[IZ]=wr[pSe]=wr[ESe]=wr[MSe]=wr[fSe]=wr[mSe]=wr[CSe]=wr[PSe]=wr[TSe]=wr[RSe]=wr[kSe]=wr[vSe]=wr[bSe]=wr[BZ]=wr[xSe]=wr[wSe]=wr[_Se]=wr[SSe]=wr[DSe]=wr[ISe]=wr[LSe]=wr[BSe]=!0;wr[gSe]=wr[LZ]=wr[ASe]=!1;function TM(t,e,i,r,n,s){var o,a=e&hSe,l=e&cSe,u=e&dSe;if(i&&(o=n?i(t,r,n,s):i(t)),o!==void 0)return o;if(!Pu(t))return t;var c=Bh(t);if(c){if(o=b_e(t),!a)return bbe(t,o)}else{var h=Zw(t),d=h==LZ||h==ySe;if(t2(t))return W1e(t,a);if(h==BZ||h==IZ||d&&!n){if(o=l||d?{}:$_e(t),!a)return l?r_e(t,G1e(o,t)):$1e(t,z1e(o,t))}else{if(!wr[h])return n?t:{};o=Q_e(t,h,a)}}s||(s=new PM);var p=s.get(t);if(p)return p;s.set(t,o),uSe(t)?t.forEach(function(g){o.add(TM(g,e,i,g,t,s))}):nSe(t)&&t.forEach(function(g,y){o.set(y,TM(g,e,i,y,t,s))});var f=u?l?DZ:oB:l?Kf:XF,m=c?void 0:f(t);return Ibe(m||t,function(g,y){m&&(y=g,g=t[y]),GF(o,y,TM(g,e,i,y,t,s))}),o}var OZ=TM,OSe=1,USe=4;function NSe(t){return OZ(t,OSe|USe)}var BP=NSe,FSe="__lodash_hash_undefined__";function zSe(t){return this.__data__.set(t,FSe),this}var HSe=zSe;function GSe(t){return this.__data__.has(t)}var VSe=GSe;function r2(t){var e=-1,i=t==null?0:t.length;for(this.__data__=new IP;++e<i;)this.add(t[e])}r2.prototype.add=r2.prototype.push=HSe;r2.prototype.has=VSe;var jSe=r2;function WSe(t,e){for(var i=-1,r=t==null?0:t.length;++i<r;)if(e(t[i],i,t))return!0;return!1}var qSe=WSe;function XSe(t,e){return t.has(e)}var YSe=XSe,KSe=1,JSe=2;function QSe(t,e,i,r,n,s){var o=i&KSe,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var u=s.get(t),c=s.get(e);if(u&&c)return u==e&&c==t;var h=-1,d=!0,p=i&JSe?new jSe:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var f=t[h],m=e[h];if(r)var g=o?r(m,f,h,e,t,s):r(f,m,h,t,e,s);if(g!==void 0){if(g)continue;d=!1;break}if(p){if(!qSe(e,function(y,v){if(!YSe(p,v)&&(f===y||n(f,y,i,r,s)))return p.push(v)})){d=!1;break}}else if(!(f===m||n(f,m,i,r,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var UZ=QSe;function ZSe(t){var e=-1,i=Array(t.size);return t.forEach(function(r,n){i[++e]=[n,r]}),i}var $Se=ZSe;function eAe(t){var e=-1,i=Array(t.size);return t.forEach(function(r){i[++e]=r}),i}var tAe=eAe,iAe=1,rAe=2,nAe="[object Boolean]",sAe="[object Date]",oAe="[object Error]",aAe="[object Map]",lAe="[object Number]",uAe="[object RegExp]",hAe="[object Set]",cAe="[object String]",dAe="[object Symbol]",pAe="[object ArrayBuffer]",fAe="[object DataView]",j6=Hl?Hl.prototype:void 0,bD=j6?j6.valueOf:void 0;function mAe(t,e,i,r,n,s,o){switch(i){case fAe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case pAe:return!(t.byteLength!=e.byteLength||!s(new i2(t),new i2(e)));case nAe:case sAe:case lAe:return HF(+t,+e);case oAe:return t.name==e.name&&t.message==e.message;case uAe:case cAe:return t==e+"";case aAe:var a=$Se;case hAe:var l=r&iAe;if(a||(a=tAe),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;r|=rAe,o.set(t,e);var c=UZ(a(t),a(e),r,n,s,o);return o.delete(t),c;case dAe:if(bD)return bD.call(t)==bD.call(e)}return!1}var gAe=mAe,yAe=1,vAe=Object.prototype,bAe=vAe.hasOwnProperty;function xAe(t,e,i,r,n,s){var o=i&yAe,a=oB(t),l=a.length,u=oB(e),c=u.length;if(l!=c&&!o)return!1;for(var h=l;h--;){var d=a[h];if(!(o?d in e:bAe.call(e,d)))return!1}var p=s.get(t),f=s.get(e);if(p&&f)return p==e&&f==t;var m=!0;s.set(t,e),s.set(e,t);for(var g=o;++h<l;){d=a[h];var y=t[d],v=e[d];if(r)var b=o?r(v,y,d,e,t,s):r(y,v,d,t,e,s);if(!(b===void 0?y===v||n(y,v,i,r,s):b)){m=!1;break}g||(g=d=="constructor")}if(m&&!g){var _=t.constructor,A=e.constructor;_!=A&&"constructor"in t&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof A=="function"&&A instanceof A)&&(m=!1)}return s.delete(t),s.delete(e),m}var wAe=xAe,_Ae=1,W6="[object Arguments]",q6="[object Array]",gA="[object Object]",SAe=Object.prototype,X6=SAe.hasOwnProperty;function AAe(t,e,i,r,n,s){var o=Bh(t),a=Bh(e),l=o?q6:Zw(t),u=a?q6:Zw(e);l=l==W6?gA:l,u=u==W6?gA:u;var c=l==gA,h=u==gA,d=l==u;if(d&&t2(t)){if(!t2(e))return!1;o=!0,c=!1}if(d&&!c)return s||(s=new PM),o||wZ(t)?UZ(t,e,i,r,n,s):gAe(t,e,l,i,r,n,s);if(!(i&_Ae)){var p=c&&X6.call(t,"__wrapped__"),f=h&&X6.call(e,"__wrapped__");if(p||f){var m=p?t.value():t,g=f?e.value():e;return s||(s=new PM),n(m,g,i,r,s)}}return d?(s||(s=new PM),wAe(t,e,i,r,n,s)):!1}var EAe=AAe;function NZ(t,e,i,r,n){return t===e?!0:t==null||e==null||!ed(t)&&!ed(e)?t!==t&&e!==e:EAe(t,e,i,r,NZ,n)}var MAe=NZ;function CAe(t,e){return t!=null&&e in Object(t)}var PAe=CAe;function TAe(t,e,i){e=j0(e,t);for(var r=-1,n=e.length,s=!1;++r<n;){var o=LP(e[r]);if(!(s=t!=null&&i(t,o)))break;t=t[o]}return s||++r!=n?s:(n=t==null?0:t.length,!!n&&VF(n)&&zF(o,n)&&(Bh(t)||WF(t)))}var RAe=TAe;function kAe(t,e){return t!=null&&RAe(t,e,PAe)}var DAe=kAe,IAe=function(){return Du.Date.now()},xD=IAe,LAe="Expected a function",BAe=Math.max,OAe=Math.min;function UAe(t,e,i){var r,n,s,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(LAe);e=w6(e)||0,Pu(i)&&(c=!!i.leading,h="maxWait"in i,s=h?BAe(w6(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function p(S){var E=r,M=n;return r=n=void 0,u=S,o=t.apply(M,E),o}function f(S){return u=S,a=setTimeout(y,e),c?p(S):o}function m(S){var E=S-l,M=S-u,R=e-E;return h?OAe(R,s-M):R}function g(S){var E=S-l,M=S-u;return l===void 0||E>=e||E<0||h&&M>=s}function y(){var S=xD();if(g(S))return v(S);a=setTimeout(y,m(S))}function v(S){return a=void 0,d&&r?p(S):(r=n=void 0,o)}function b(){a!==void 0&&clearTimeout(a),u=0,r=l=n=a=void 0}function _(){return a===void 0?o:v(xD())}function A(){var S=xD(),E=g(S);if(r=arguments,n=this,l=S,E){if(a===void 0)return f(l);if(h)return clearTimeout(a),a=setTimeout(y,e),p(l)}return a===void 0&&(a=setTimeout(y,e)),o}return A.cancel=b,A.flush=_,A}var $F=UAe;function NAe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var FAe=NAe;function zAe(t,e){return e.length<2?t:AZ(t,C1e(e,0,-1))}var HAe=zAe;function GAe(t,e){return MAe(t,e)}var FZ=GAe;function VAe(t,e){return e=j0(e,t),t=HAe(t,e),t==null||delete t[LP(FAe(e))]}var jAe=VAe;function WAe(t){return E1e(t)?void 0:t}var qAe=WAe,XAe=1,YAe=2,KAe=4,JAe=MZ(function(t,e){var i={};if(t==null)return i;var r=!1;e=pZ(e,function(s){return s=j0(s,t),r||(r=s.length>1),s}),$1(t,DZ(t),i),r&&(i=OZ(i,XAe|YAe|KAe,qAe));for(var n=e.length;n--;)jAe(i,e[n]);return i}),hB=JAe;function QAe(t,e,i,r){if(!Pu(t))return t;e=j0(e,t);for(var n=-1,s=e.length,o=s-1,a=t;a!=null&&++n<s;){var l=LP(e[n]),u=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(n!=o){var c=a[l];u=r?r(c,l,a):void 0,u===void 0&&(u=Pu(c)?c:zF(e[n+1])?[]:{})}GF(a,l,u),a=a[l]}return t}var ZAe=QAe;function $Ae(t,e,i){for(var r=-1,n=e.length,s={};++r<n;){var o=e[r],a=AZ(t,o);i(a,o)&&ZAe(s,j0(o,t),a)}return s}var eEe=$Ae;function tEe(t,e){return eEe(t,e,function(i,r){return DAe(t,r)})}var iEe=tEe,rEe=MZ(function(t,e){return t==null?{}:iEe(t,e)}),qc=rEe,nEe="Expected a function";function sEe(t,e,i){var r=!0,n=!0;if(typeof t!="function")throw new TypeError(nEe);return Pu(i)&&(r="leading"in i?!!i.leading:r,n="trailing"in i?!!i.trailing:n),$F(t,e,{leading:r,maxWait:e,trailing:n})}var oEe=sEe;function zZ(t){for(let e of Object.keys(t))t[e]===void 0&&delete t[e];return t}function Oh(t,e){return Object.setPrototypeOf(t,e),t}var aEe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),lEe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),uEe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||OP&&"ontouchend"in document,hEe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,cEe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,dEe=()=>{if(typeof window>"u")return!1;let t=navigator.userAgent,e=navigator.vendor;return/Safari/i.test(t)&&/Apple Computer/.test(e)},pEe=()=>{if(typeof window>"u")return null;let t=navigator.userAgent.match(/Version\/(\d+\.\d)/);return t&&t[1]},fEe=()=>{if(typeof window>"u")return;let t=new URLSearchParams(window.location.search).get("desktop-app-version");return t?(window.localStorage.setItem("desktop-app-version",t),t):window.localStorage.getItem("desktop-app-version")??"0.0.6"},mEe=aEe();mEe&&fEe();var OP=lEe(),ez=uEe(),gEe=hEe(),za=cEe(),Y6=dEe(),K6=Number(pEe());function HZ(t){return Array.isArray(t)?t:[t]}function GZ(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}function yA(t){return OP?t.metaKey:t.ctrlKey}function yEe(t){return t.wheelDeltaY===0||t.deltaY===0?OP&&t.shiftKey&&Math.abs(t.wheelDeltaX)>=120?!1:t.wheelDeltaX?t.wheelDeltaX===-3*t.deltaX||t.wheelDeltaX===-3*window.devicePixelRatio*t.deltaX:t.deltaMode===0:t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY||t.wheelDeltaY===-3*window.devicePixelRatio*t.deltaY:t.deltaMode===0}var Qt=[],n2={},Fx={},RM={};function VZ(t){Qt.includes(t)||Qt.push(t)}function Ev(t){delete n2[t.pointerId];for(let e=0;e<Qt.length;e++)if(Qt[e].pointerId===t.pointerId){Qt.splice(e,1);break}}function vEe(){Qt.splice(0,Qt.length)}function s2(t){if(t.pointerType!=="touch")return;let e=n2[t.pointerId];e===void 0&&(e={x:0,y:0},n2[t.pointerId]=e),e.x=t.pageX,e.y=t.pageY}function wD(t){let e=t.pointerId===Qt[0].pointerId?Qt[1]:Qt[0];return n2[e.pointerId]}function jZ(t){Fx[t.key]=!0,RM[t.key]=RM[t.key]===void 0?1:RM[t.key]+1}function WZ(t){if(OP&&Fx.Meta)for(let e in Fx)Fx[e]=!1;else Fx[t.key]=!1;RM={}}function bEe(t){t.addEventListener("pointerdown",VZ,!0),t.addEventListener("pointerdown",s2,!0),t.addEventListener("pointermove",s2,!0),t.addEventListener("pointerup",Ev,!0),t.addEventListener("pointercancel",Ev,!0),t.addEventListener("pointerleave",Ev,!0),window.addEventListener("keydown",jZ,!0),window.addEventListener("keyup",WZ,!0)}function xEe(t){t.removeEventListener("pointerdown",VZ,!0),t.removeEventListener("pointerdown",s2,!0),t.removeEventListener("pointermove",s2,!0),t.removeEventListener("pointerup",Ev,!0),t.removeEventListener("pointercancel",Ev,!0),t.removeEventListener("pointerleave",Ev,!0),window.removeEventListener("keydown",jZ,!0),window.removeEventListener("keyup",WZ,!0)}var qZ,wEe=new Promise(t=>{qZ=t}),vA;function _Ee(){if(vA)return vA;async function t(){let e="https://unpkg.com/@splinetool/navmesh-wasm@1.0.53/build",i=L0(()=>import("./navmesh-0b92f809.js"),[]),[r,n]=await Promise.all([i,fetch(`${e}/navmesh.wasm`).then(a=>a.arrayBuffer())]),s=r.default,o=await s({wasmBinary:n});qZ(o)}return vA=t(),vA}var XZ,SEe=new Promise(t=>{XZ=t}),bA;function AEe(){if(bA)return bA;async function t(){let e=await L0(()=>import("./physics-dee4de67.js"),[]);await e.init(),XZ(e)}return bA=t(),bA}var ui=class{modifyById(t,e){let i=this;if(i[t]===void 0)throw new Error("not expected");{let r={...i,[t]:e};return Object.setPrototypeOf(r,ui.prototype),r}}add(t,e){var i;return((i=this.runOp({type:1,id:t,data:e}))==null?void 0:i.data)??this}runOp(t){let e=this;if(t.type===1){let i=e[t.id],r;i===void 0?r={type:2,id:t.id}:r={type:1,id:t.id,data:i};let{id:n,data:s}=t,o={...e,[n]:s};return Object.setPrototypeOf(o,ui.prototype),{data:o,actual:t,reverse:r}}else if(t.type===2){let{id:i}=t,r=e[i];if(r===void 0)return null;{let n={...e};return Object.setPrototypeOf(n,ui.prototype),delete n[i],{data:n,actual:t,reverse:{type:1,id:i,data:r}}}}return null}};function tz(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let i of e){let r=t[i];r&&typeof r=="object"&&tz(r)}return Object.freeze(t)}function EEe(t,e){let i=0;for(;i<t.length&&i<e.length;){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1;i+=1}return i!==e.length?-1:i!==t.length?1:0}var YZ=class extends Error{};function _D(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function up(t,e,i){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let r=[],n=1/(i+1);for(let s=0;s<i;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*n;r.push(o)}return r}function iz(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function MEe(){return typeof process<"u"}function KZ(t,e){for(let i of t)e(i.id,i.data)!==!0&&KZ(i.children,e)}function JZ(t,e){if(e(t.id,t.data)!==!0)for(let i of t.children)JZ(i,e)}var Gs=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Gs.prototype)}deepFreeze(){let e=0;for(;e<this.length;)tz(this[e]),e++}fillCaches0(e,i){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,i);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,i){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===i)return!0;e=r}return!1}rootAcestor(e){for(;e;){let i=this.parent(e);if(i)e=i;else return e}return e}isDescendantOf(e,i){for(;e;){let r=this.parent(e);if(r===i)return!0;e=r}return!1}data(e){var i;return(i=this.get(e))==null?void 0:i.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var i;return e===null?this:(i=this.get(e))==null?void 0:i.children}traverseFrom(e,i){if(e===null)this.traverse(i);else{let r=this.get(e);r&&JZ(r,i)}}traverse(e){KZ(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,i){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),n=this.childrenArray(r),s=n.findIndex(a=>a.id===e);if(s<0)throw new Error("not expected");let o=n[s];return n=[...n],n[s]={...o,data:i},this.modifyArrayBy(r,n)}}modifyArrayBy(e,i){let r=e,n=i;for(;r!==null;){let o=n,a=r;if(r=this.parent(r),r===void 0)throw new Error;n=this.childrenArray(r);let l=n.findIndex(u=>u.id===a);if(l<0)throw new Error;n=[...n],n[l]={...n[l],children:o}}Object.setPrototypeOf(n,Gs.prototype);let s=n;return s.fillCaches(),s}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:i}){if(this.get(e)!==void 0)return!0;for(let r of i)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:i,fi:r,id:n,data:s,children:o}=e;if(i!==null&&this.get(i)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=i,l=this.childrenArray(a),u={fi:r,id:n,data:s,children:o};return l=[...l,u],l.sort((c,h)=>c.fi-h.fi),e.localIndex=l.indexOf(u),{data:this.modifyArrayBy(a,l),actual:e,reverse:{type:8,id:n}}}}deleteOp(e){let{id:i}=e;if(this.get(i)===null)return null;{let r=this.parent(i);if(r===void 0)return null;let n=this.childrenArray(r),s=n.findIndex(a=>a.id===i);e.localIndex=s,n=[...n];let o=n.splice(s,1)[0];return{data:this.modifyArrayBy(r,n),actual:e,reverse:{type:7,...o,parent:r}}}}moveOp(e){let{parent:i,fi:r,id:n}=e;if(i!==null&&this.get(i)===void 0)return this.deleteOp({type:8,id:n});if(i!==null){let d=i;for(;d!==null;){if(d===void 0)throw new Error;if(d===n)throw new YZ("cyclic tree");d=this.parent(d)}}let s=this.parent(n);if(s===void 0)return null;let o=s,a=this.childrenArray(s),l=a.findIndex(d=>d.id===n);a=[...a];let u=a.splice(l,1)[0],c=this.modifyArrayBy(s,a);s=i,a=c.childrenArray(s);let h=u.fi;return u={...u,fi:r},a=[...a,u],a.sort((d,p)=>d.fi-p.fi),e.localIndex=a.indexOf(u),c=c.modifyArrayBy(s,a),{data:c,actual:e,reverse:{type:9,parent:o,fi:h,id:n}}}previous(e,i){if(i===null){let n=this.childrenArray(e);return n.length===0?null:n[n.length-1].id}let r=null;for(let n of this.childrenArray(e)){if(n.id===i)return r;r=n.id}return null}traverseSortNext(e){let i=this.parent(e);if(i!==void 0){let r=this.childrenArray(i),n=r.findIndex(s=>s.id===e)+1;if(n<r.length)return r[n].id;if(i)return this.traverseSortNext(i)}}sortNext(e){let i=this.childrenArray(e);return i.length>0?i[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let i=this.childrenArray(e);return i.length>0?this.traverseSortPrevious(i[i.length-1].id):e}sortPrevious(e){let i=this.parent(e);if(i!==void 0){let r=this.childrenArray(i),n=r.findIndex(s=>s.id===e)-1;return n>=0?this.traverseSortPrevious(r[n].id):i}}getAllSorted(e){let i=[];for(let r of e){let n=this.getWithSortKey(r.id);n!==void 0&&i.push({...r,...n})}i.sort((r,n)=>EEe(r.sortKey,n.sortKey));for(let r of i)delete r.sortKey;return i}getWithSortKey(e){var i=e;let r=[],n=this.get(i),s=n;if(n!==void 0){for(;i;)r.splice(0,0,n.fi),i=this.parent(i),i!==null&&(n=this.get(i));return{...s,sortKey:r}}}insertBeforeHelper(e,i,r){return this.insertAfterHelper(e,this.previous(e,i),r)}insertAfterHelper(e,i,r){let n=this.childrenArray(e);if(i===null){if(n.length===0)return up(0,r,r);{let s=n[0].fi;return up(s-r,s,r)}}else{let s=this.get(i);if(s===void 0||this.parent(i)!==e)throw new Error("illegal args");let o=n.find(a=>a.fi>s.fi);if(o===void 0){let a=n[n.length-1].fi;return up(a,a+r,r)}else return up(s.fi,o.fi,r)}}},o2;(t=>{function e(i,r){if(r.type!==0)return null;if(Array.isArray(i)){let n=r.props,s={},o=[...i],a=!1;if(n)for(let l of Object.keys(n)){let u=parseInt(l);if(isNaN(u))throw new Error("wrong index");s[l]=o[u],o[u]=n[l],a=!0}return a?{data:o,actual:r,reverse:{type:0,props:s}}:null}else{let n=r.props,s={},o={...i},a=!1;if(n)for(let l of Object.keys(n)){s[l]=o[l];let u=n[l];u===void 0?delete o[l]:o[l]=u,a=!0}return a?{data:o,actual:r,reverse:{type:0,props:s}}:null}}t.runOp=e})(o2||(o2={}));var qt=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,qt.prototype)}deepFreeze(){let t=0;for(;t<this.length;)tz(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){var e;return(e=this.get(t))==null?void 0:e.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let i=this,r=i.findIndex(s=>s.id===t);if(r<0)throw new Error("not expected");let n=i[r];return i=[...i],i[r]={...n,data:e},this.modifyArrayBy(i)}}modifyArrayBy(t){Object.setPrototypeOf(t,qt.prototype);let e=t;return MEe()||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:i,data:r}=t,n=this,s={fi:e,id:i,data:r};return n=[...n,s],n.sort((o,a)=>o.fi-a.fi),t.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:t,reverse:{type:5,id:i}}}deleteOp(t){let{id:e}=t,i=this,r=i.findIndex(s=>s.id===e);if(r===-1)return null;t.localIndex=r,i=[...i];let n=i.splice(r,1)[0];return{data:this.modifyArrayBy(i),actual:t,reverse:{type:4,...n}}}moveOp(t){let{fi:e,id:i}=t,r=this;r=[...r];let n=r.findIndex(a=>a.id===i);if(n===-1)return null;let s=r[n].fi,o={...r[n],fi:e};return r[n]=o,r.sort((a,l)=>a.fi-l.fi),t.localIndex=r.indexOf(o),{data:this.modifyArrayBy(r),actual:t,reverse:{type:6,fi:s,id:i}}}previous(t){if(t===null)return this.length===0?null:this[this.length-1].id;let e=null;for(let i of this){if(i.id===t)return e;e=i.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let i=this;if(t===null){if(i.length===0)return up(0,e,e);{let r=i[0].fi;return up(r-e,r,e)}}else{let r=this.get(t);if(r===void 0)throw new Error("illegal args");let n=i.find(s=>s.fi>r.fi);if(n===void 0){let s=i[i.length-1].fi;return up(s,s+e,e)}else return up(r.fi,n.fi,e)}}};function r0(t){return t&&typeof t=="object"&&t instanceof Vn}var Vn=class{unusedFunOverridesTable(t){}runOp(t){let e=[],i=this,r=0,n={};for(;r<t.path.length;){if(e.push(i),i=i===void 0?void 0:i[t.path[r]],i!==void 0&&!r0(i))return null;r+=1}i=i?_D(i):new Vn;for(let[a,l]of Object.entries(t.props)){let u=i[a];n[a]=u,l===void 0?delete i[a]:i[a]=l}for(;r>0;){if(Object.keys(i).length===0){let a=e[r-1];a&&(i=_D(a),delete i[t.path[r-1]])}else{let a=e[r-1];if(a){let l=_D(a);l[t.path[r-1]]=i,i=l}else{let l=new Vn;l[t.path[r-1]]=i,i=l}}r-=1}let s=Object.setPrototypeOf(i,Vn.prototype),o={...t,props:n};return{data:s,actual:t,reverse:o}}},Cp;(t=>{function e(n,s){return $w(n,s)??n}t.apply=e;function i(n,s){return nz(n,s)}t.merge=i;function r(n,s){let o=0,a=s.path,l=n;for(;o<a.length&&l!==void 0;){if(l=zs.zoomOnce(l,a[o]),l===void 0)return s;if(!r0(l))return;o+=1}if(l===void 0)return s;if(r0(l))if(s.type===0){let u={...s.props};for(let c of Object.keys(l))delete u[c];return{...s,props:u}}else if(s.type===1||s.type===4||s.type===7){let u=rz([s],l);return u?(console.log(u),u):s}else return s}t.filterOp=r})(Cp||(Cp={}));function rz(t,e){if(e===void 0)return;let i=!1,r=t.map(n=>{let s=n.id,o=$w(n.data,e[s]);if(i=i||o!==void 0,o===void 0&&(o=n.data),n.children){let a=rz(n.children,e);return a!==void 0?i=!0:a=n.children,{...n,id:s,data:o,children:a}}else return{...n,id:s,data:o}});if(i)return r}function CEe(t,e){if(e===void 0)return;let i=!1,r=t.map(n=>{let s=n.id,o=$w(n.data,e[s]);return i=i||o!==void 0,o===void 0&&(o=n.data),{...n,id:s,data:o}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function $w(t,e){if(!r0(e))return e;if(t instanceof Gs){let i=rz(t,e);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof qt)return CEe(t,e);if(Array.isArray(t)){let i=!1,r=t.map((n,s)=>{let o=$w(n,e[s]);return i=i||o!==void 0,o===void 0&&(o=n),o});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else{if(t instanceof Vn)return nz(t,e);if(t&&typeof t=="object"){let i={},r=!1;for(let[n,s]of Object.entries(t)){let o=$w(s,e[n]);r=r||o!==void 0,o===void 0&&(o=s),i[n]=o}return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}}}}function nz(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!r0(e))return e;if(!r0(t))return Cp.apply(t,e);let i=new Set;for(let n of Object.keys(t))i.add(n);for(let n of Object.keys(e))i.add(n);let r=new Vn;for(let n of i){let s=nz(t===void 0?void 0:t[n],e===void 0?void 0:e[n]);r[n]=s}return r}function PEe(t,e){let i={cur:[],result:[],len:0};return t=e1(t,e,i)??t,[t,i.result]}function a2(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function l2(t){t&&(t.len-=1)}function TEe(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function QZ(t,e,i){let r=!1,n=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(r=!0,o=a,i!==null))throw new Error("not supported");let l=e1(s.data,e,a2(i,o));l2(i),r=r||l!==void 0,l===void 0&&(l=s.data);let u=QZ(s.children,e,i);return u!==void 0?r=!0:u=s.children,{...s,id:o,data:l,children:u}});if(r)return n}function REe(t,e,i){let r=!1,n=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(r=!0,o=a,i!==null))throw new Error("not supported");let l=e1(s.data,e,a2(i,o));return l2(i),r=r||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(r)return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}function e1(t,e,i){if(t instanceof Gs){let r=QZ(t,e,i);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}else{if(t instanceof qt)return REe(t,e,i);if(Array.isArray(t)){let r=!1,n=t.map((s,o)=>{let a=e1(s,e,a2(i,o));return l2(i),r=r||a!==void 0,a===void 0&&(a=s),a});return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}else if(t&&typeof t=="object"&&!iz(t)){let r={},n=!1;for(let[s,o]of Object.entries(t))if(s!=="name"){let a=e[s];if(typeof a=="string"){if(i!==null)throw new Error("not supported");n=!0,s=a}let l=e1(o,e,a2(i,s));l2(i),n=n||l!==void 0,l===void 0&&(l=o),r[s]=l}else r[s]=o;return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(typeof t=="string"){let r=e[t];return r!==void 0&&TEe(i),r}else return}}var u2;(t=>{function e(i,r){let n=zs.zoom(r,i.path);if(typeof n=="object"){let s={};for(let o of Object.keys(i.props))s[o]=n[o];return{...i,props:s}}else return{...i,props:{}}}t.replaceProps=e})(u2||(u2={}));var Ss;(t=>{function e(l,u){return{...l,path:l.path.slice(u)}}t.drop=e;function i(l,u){var c;return((c=r(l,u))==null?void 0:c.data)??l}t.applySimple=i;function r(l,u){var d,p;let c=u.path;for(var h=[];;){let f;if(l instanceof Vn&&u.type===0&&(f=l.runOp({...u,path:c.slice(h.length)}),f===null&&(f=void 0)),f===void 0&&h.length===c.length&&(l instanceof Gs||l instanceof qt||l instanceof ui?f=l.runOp(u):f=o2.runOp(l,u)),f!==void 0)if(f!==null){let y=f.data;for(let v=h.length-1;v>=0;v--){let b=c[v],_=h[v];if(_ instanceof Gs){if(typeof b=="number")throw new Error("illegal arg");y=_.modifyById(b,y)}else if(_ instanceof qt){if(typeof b=="number")throw new Error("illegal arg");y=_.modifyById(b,y)}else if(_ instanceof ui){if(typeof b=="number")throw new Error("illegal arg");y=_.modifyById(b,y)}else if(_ instanceof Vn){let A={..._,[b]:y};y=Object.setPrototypeOf(A,Vn.prototype)}else if(typeof _=="object")if(Array.isArray(_)){if(typeof b=="string"&&(b=parseInt(b),isNaN(b)))throw new Error("Invalid path");let A=y;y=[..._],y[b]=A}else y={..._,[b]:y};else return null}return{data:y,actual:{...f.actual,path:c},reverse:{...f.reverse,path:c}}}else return null;let m=c[h.length],g;if(l instanceof Gs){if(typeof m=="number")throw new Error("");g=(d=l.get(m))==null?void 0:d.data}else if(l instanceof qt){if(typeof m=="number")throw new Error("");g=(p=l.get(m))==null?void 0:p.data}else l!==null&&(g=l[m]);if(g!==void 0)h.push(l),l=g;else return null}}t.apply=r;function n(l,u){for(let c=0;c<l.length&&c<u.length;c++)if(l[c]!==u[c])return!0;return!1}t.pathDisjoint=n;function s(l,u){if(l.length!==u.length)return!1;for(let c=0;c<l.length;c++)if(l[c]!==u[c])return!1;return!0}t.pathEq=s;function o(l,u){return n(l.path,u.path)}t.commutative=o;function a(l,u){return l.type===0&&u.type===0&&s(l.path,u.path)?Object.keys(l.props).every(c=>u.props[c]!==void 0):!1}t.subsumed=a})(Ss||(Ss={}));var cB;(t=>{function e(){return[]}t.empty=e;function i(u,c){let h=[];for(let d of u){let[p,...f]=d.path;p===c&&h.push({...d,path:f})}return h}t.removePrefix=i;function r(u,c){return u.map(h=>({...h,path:[c,...h.path]}))}t.addPrefix=r;function n(u,c){return[...u,...c]}t.concat=n;function s(u,c){return[...u.filter(h=>!c.some(d=>Ss.subsumed(h,d))),...c]}t.compress=s;function o(u,c){return u.every(h=>c.every(d=>Ss.commutative(h,d)))}t.commutative=o;function a(u,c){for(let h of c){let d=l(u,h);d!==null&&(u=d.data)}return u}t.applyAll=a;function l(u,c){var h=u;let d=[],p=[];for(let f of c)try{if(f.type===3||f.type===5&&f.path[f.path.length-1]==="variables"){let m,g,y;if(f.type===3?(m=zs.zoom(h,[...f.path,f.id]),y=Ss.apply(h,{...f,type:2})):(m=zs.zoom(h,[...f.path,f.id,"value"]),y=Ss.apply(h,f)),y!==null){h=y.data;let[v,b]=PEe(h,{[f.id]:m});h=v;for(let _=0;_<b.length;_++){let A=b[_],S=A.pop();if(typeof S=="number"){let E=[S];for(let R=_+1;R<b.length;R++){let C=b[R],T=C[C.length-1];if(typeof T=="number"&&zs.equal(A,C.slice(0,C.length-1)))E.push(T),b.splice(R,1);else break}let M=zs.zoom(h,A);g=M.map((R,C)=>E.includes(C)?f.id:R),m=M,S=A.pop()}else{if(S==="alphaOverride"||S==="alpha"){m/=100;let E=m,M=zs.zoom(h,A.slice(0,A.length-2)),R=M.layers.map(C=>C.id===A[A.length-1]?{...C,data:{...C.data,[S]:E}}:C);Object.setPrototypeOf(R,Object.getPrototypeOf(M.layers)),M.layers=R}g=f.id}d.push({type:0,path:A,props:{[S]:m}}),p.push({type:0,path:A,props:{[S]:g}})}p.push(y.reverse),d.push(y.actual)}}else{let m=Ss.apply(h,f);m!==null&&(d.push(m.actual),h=m.data,p.push(m.reverse))}}catch(m){if(m instanceof YZ)return null;throw m}return{data:h,actual:d,reverse:p.reverse()}}t.apply=l})(cB||(cB={}));var ZZ=Symbol(),kEe=Symbol(),UP=Symbol(),e_=class{reportOp(t,e,i=[]){let r=this;if(e===null)return;r._current=e.data;let n=i;for(;!(r instanceof e$);){let s=r._path,o=r._current;if(s!==""&&n.splice(0,0,s),r=r._parent,r===null)return;r.update(s,o)}r.push(n,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let i=e[UP];i&&i(),delete this._children[t]}}}},DEe=class extends e_{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,o2.runOp(this._current,t),t.path)}},IEe=class extends e_{constructor(t,e,i){super(),this._parent=t,this._path=e,this._current=i}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,ui.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},$Z={get(t,e){if(e===UP)return()=>{t._parent=null};if(e===ZZ)return t._current;if(e===kEe)return t;let{_current:i,_children:r}=t;if(e==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let n=r===void 0?void 0:r[e];if(n!==void 0)return n;let s=i[e],o=NP(t,e,s);return o!==s?(r===void 0&&(r={},t._children=r),r[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let i=t._current,r=Reflect.getOwnPropertyDescriptor(i,e);return r&&{writable:!0,configurable:!0,enumerable:r.enumerable,value:i[e]}}},LEe={...$Z,set(t,e,i){let r={type:0,props:{[e]:An(i)??i}};return t.deleteChildren(e),t.runOp(r),!0},deleteProperty(t,e){let i={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(i),!0}},BEe={...$Z,set(t,e,i){return i===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:i})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},sz=class extends e_{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[UP]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,i)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:i}=this,r=i===void 0?void 0:i[t];if(r!==void 0)return r;let n=(o=e.get(t))==null?void 0:o.data,s=NP(this,t,n);return s!==n?(i===void 0&&(i={},this._children=i),i[t]=s,s):n}add(t,e,i,r,n){this.runOp({type:7,parent:t,fi:e,id:i,data:r,children:n})}move(t,e,i){this.runOp({type:9,parent:t,fi:e,id:i})}insertAfter(t,e,i){let r=this._current.insertAfterHelper(t,e,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.add(t,r[n],s.id,s.data,s.children)}}insertBefore(t,e,i){let r=this._current.insertBeforeHelper(t,e,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.add(t,r[n],s.id,s.data,s.children)}}moveAfter(t,e,i){let r=this._current.insertAfterHelper(t,e,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.move(t,r[n],s)}}moveBefore(t,e,i){let r=this._current.insertBeforeHelper(t,e,i.length);for(let n=0;n<i.length;n++){let s=i[n];this.move(t,r[n],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},oz=class extends e_{constructor(t,e,i){super(),this._children={},this._parent=t,this._path=e,this._current=i,this[UP]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let i=0;i<e;i++){let r=this._current[i].id,n=this._current[i].fi;t(this.data(this._current[i].id),r,n)}}find(t){let e=this.length;for(let i=0;i<e;i++){let r=this._current[i].id;if(t(this.data(r),r))return this.get(r)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:i}=this,r=i===void 0?void 0:i[t];if(r!==void 0)return r;let n=(o=e.get(t))==null?void 0:o.data,s=NP(this,t,n);return s!==n?(i===void 0&&(i={},this._children=i),i[t]=s,s):n}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,i){this.runOp({type:4,fi:t,id:e,data:i})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let r=0;r<e.length;r++){let n=e[r];this.add(i[r],n.id,n.data)}}insertBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let r=0;r<e.length;r++){let n=e[r];this.add(i[r],n.id,n.data)}}moveAfter(t,e){let i=this._current.insertAfterHelper(t,e.length);for(let r=0;r<e.length;r++){let n=e[r];this.move(i[r],n)}}moveBefore(t,e){let i=this._current.insertBeforeHelper(t,e.length);for(let r=0;r<e.length;r++){let n=e[r];this.move(i[r],n)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function SD(t,e,i){if(t.length>0){let r=t[t.length-1];if(r.type===0&&e.type===0&&zs.equal(r.path,i)){Object.assign(r.props,e.props);return}}t.push({...e,path:i})}var e$=class extends e_{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,i,r){SD(this.ts,e,t),SD(this.actual,i,t),SD(this.reverse,r,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function NP(t,e,i){return i instanceof Gs?new sz(t,e,i):i instanceof qt?new oz(t,e,i):i instanceof ui?new Proxy(new IEe(t,e,i),BEe):i!==null&&typeof i=="object"?iz(i)?i:new Proxy(new DEe(t,e,i),LEe):i}function t$(t){let e=new e$(t);return[NP(e,"",t),e]}function t1(t,e){let[i,r]=t$(t);return e(i),r.result()}function An(t){return t instanceof sz||t instanceof oz?t._current:t!==null&&typeof t=="object"?t[ZZ]:t}var zs;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function i(s,o,a){let l=n(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let u={...o};return Object.keys(l).forEach(c=>{delete u[c]}),u}else return o}t.removeOverridden=i;function r(s,o){if((s instanceof Gs||s instanceof sz)&&typeof o=="string"||(s instanceof qt||s instanceof oz)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=r;function n(s,o,a=0){for(;a<o.length&&s!==void 0;)s=r(s,o[a]),a+=1;return s}t.zoom=n})(zs||(zs={}));function OEe(t,e){let i=[];if(e.length===t.length)for(var r=0;r<t.length;){if(e[r]==="*")i.push(t[r]);else if(t[r]!==e[r])return null;r+=1}else return null;return i}function gr(t,e){let i=[];if(e.length<=t.length)for(var r=0;r<e.length;){if(e[r]==="*")i.push(t[r]);else if(t[r]!==e[r])return null;r+=1}else return null;return i}var i$=class{},J6=class extends i${constructor(t){super(),this.id=t}},Q6=class extends i${constructor(t){super(),this.data=t}},dB;try{dB=new TextDecoder}catch{}var Tt,Pp,Fe=0,ha={},Yi,hp,xl=0,yh=0,La,Xc,Wo=[],tr,Z6={useRecords:!1,mapsAsObjects:!0},r$=class{},n$=new r$;n$.name="MessagePack 0xC1";var n0=!1,h2=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(Tt)return h$(()=>(fB(),this?this.unpack(t,e):h2.prototype.unpack.call(Z6,t,e)));Pp=e>-1?e:t.length,Fe=0,yh=0,hp=null,La=null,Tt=t;try{tr=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(i){throw Tt=null,t instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof h2){if(ha=this,this.structures)return Yi=this.structures,xA();(!Yi||Yi.length>0)&&(Yi=[])}else ha=Z6,(!Yi||Yi.length>0)&&(Yi=[]);return xA()}unpackMultiple(t,e){let i,r=0;try{n0=!0;let n=t.length,s=this?this.unpack(t,n):zP.unpack(t,n);if(e){for(e(s);Fe<n;)if(r=Fe,e(xA())===!1)return}else{for(i=[s];Fe<n;)r=Fe,i.push(xA());return i}}catch(n){throw n.lastPosition=r,n.values=i,n}finally{n0=!1,fB()}}_mergeStructures(t,e){t=t||[];for(let i=0,r=t.length;i<r;i++){let n=t[i];n&&(n.isShared=!0,i>=32&&(n.highByte=i-32>>5))}t.sharedLength=t.length;for(let i in e||[])if(i>=0){let r=t[i],n=e[i];n&&(r&&((t.restoreStructures||(t.restoreStructures=[]))[i]=r),t[i]=n)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function xA(){try{if(!ha.trusted&&!n0){let e=Yi.sharedLength||0;e<Yi.length&&(Yi.length=e)}let t=ln();if(Fe==Pp)Yi.restoreStructures&&$6(),Yi=null,Tt=null,Xc&&(Xc=null);else if(Fe>Pp){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!n0)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Yi.restoreStructures&&$6(),fB(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function $6(){for(let t in Yi.restoreStructures)Yi[t]=Yi.restoreStructures[t];Yi.restoreStructures=null}function ln(){let t=Tt[Fe++];if(t<160)if(t<128){if(t<64)return t;{let e=Yi[t&63]||ha.getStructures&&s$()[t&63];return e?(e.read||(e.read=az(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,ha.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[a$()]=ln();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(ln(),ln());return e}else{t-=144;let e=new Array(t);for(let i=0;i<t;i++)e[i]=ln();return e}else if(t<192){let e=t-160;if(yh>=Fe)return hp.slice(Fe-xl,(Fe+=e)-xl);if(yh==0&&Pp<140){let i=e<16?lz(e):o$(e);if(i!=null)return i}return pB(e)}else{let e;switch(t){case 192:return null;case 193:return La?(e=ln(),e>0?La[1].slice(La.position1,La.position1+=e):La[0].slice(La.position0,La.position0-=e)):n$;case 194:return!1;case 195:return!0;case 196:return AD(Tt[Fe++]);case 197:return e=tr.getUint16(Fe),Fe+=2,AD(e);case 198:return e=tr.getUint32(Fe),Fe+=4,AD(e);case 199:return pf(Tt[Fe++]);case 200:return e=tr.getUint16(Fe),Fe+=2,pf(e);case 201:return e=tr.getUint32(Fe),Fe+=4,pf(e);case 202:if(e=tr.getFloat32(Fe),ha.useFloat32>2){let i=uz[(Tt[Fe]&127)<<1|Tt[Fe+1]>>7];return Fe+=4,(i*e+(e>0?.5:-.5)>>0)/i}return Fe+=4,e;case 203:return e=tr.getFloat64(Fe),Fe+=8,e;case 204:return Tt[Fe++];case 205:return e=tr.getUint16(Fe),Fe+=2,e;case 206:return e=tr.getUint32(Fe),Fe+=4,e;case 207:return ha.int64AsNumber?(e=tr.getUint32(Fe)*4294967296,e+=tr.getUint32(Fe+4)):e=tr.getBigUint64(Fe),Fe+=8,e;case 208:return tr.getInt8(Fe++);case 209:return e=tr.getInt16(Fe),Fe+=2,e;case 210:return e=tr.getInt32(Fe),Fe+=4,e;case 211:return ha.int64AsNumber?(e=tr.getInt32(Fe)*4294967296,e+=tr.getUint32(Fe+4)):e=tr.getBigInt64(Fe),Fe+=8,e;case 212:if(e=Tt[Fe++],e==114)return n8(Tt[Fe++]&63);{let i=Wo[e];if(i)return i.read?(Fe++,i.read(ln())):i.noBuffer?(Fe++,i()):i(Tt.subarray(Fe,++Fe));throw new Error("Unknown extension "+e)}case 213:return e=Tt[Fe],e==114?(Fe++,n8(Tt[Fe++]&63,Tt[Fe++])):pf(2);case 214:return pf(4);case 215:return pf(8);case 216:return pf(16);case 217:return e=Tt[Fe++],yh>=Fe?hp.slice(Fe-xl,(Fe+=e)-xl):NEe(e);case 218:return e=tr.getUint16(Fe),Fe+=2,yh>=Fe?hp.slice(Fe-xl,(Fe+=e)-xl):FEe(e);case 219:return e=tr.getUint32(Fe),Fe+=4,yh>=Fe?hp.slice(Fe-xl,(Fe+=e)-xl):zEe(e);case 220:return e=tr.getUint16(Fe),Fe+=2,t8(e);case 221:return e=tr.getUint32(Fe),Fe+=4,t8(e);case 222:return e=tr.getUint16(Fe),Fe+=2,i8(e);case 223:return e=tr.getUint32(Fe),Fe+=4,i8(e);default:if(t>=224)return t-256;if(t===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+t)}}}var UEe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function az(t,e){function i(){if(i.count++>2){let n=t.read=new Function("r","return function(){return {"+t.map(s=>UEe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(ln);return t.highByte===0&&(t.read=e8(e,t.read)),n()}let r={};for(let n=0,s=t.length;n<s;n++){let o=t[n];r[o]=ln()}return r}return i.count=0,t.highByte===0?e8(e,i):i}var e8=(t,e)=>function(){let i=Tt[Fe++];if(i===0)return e();let r=t<32?-(t+(i<<5)):t+(i<<5),n=Yi[r]||s$()[r];if(!n)throw new Error("Record id is not defined for "+r);return n.read||(n.read=az(n,t)),n.read()};function s$(){let t=h$(()=>(Tt=null,ha.getStructures()));return Yi=ha._mergeStructures(t,Yi)}var pB=FP,NEe=FP,FEe=FP,zEe=FP;function FP(t){let e;if(t<16&&(e=lz(t)))return e;if(t>64&&dB)return dB.decode(Tt.subarray(Fe,Fe+=t));let i=Fe+t,r=[];for(e="";Fe<i;){let n=Tt[Fe++];if(!(n&128))r.push(n);else if((n&224)===192){let s=Tt[Fe++]&63;r.push((n&31)<<6|s)}else if((n&240)===224){let s=Tt[Fe++]&63,o=Tt[Fe++]&63;r.push((n&31)<<12|s<<6|o)}else if((n&248)===240){let s=Tt[Fe++]&63,o=Tt[Fe++]&63,a=Tt[Fe++]&63,l=(n&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(n);r.length>=4096&&(e+=ms.apply(String,r),r.length=0)}return r.length>0&&(e+=ms.apply(String,r)),e}function t8(t){let e=new Array(t);for(let i=0;i<t;i++)e[i]=ln();return e}function i8(t){if(ha.mapsAsObjects){let e={};for(let i=0;i<t;i++)e[a$()]=ln();return e}else{let e=new Map;for(let i=0;i<t;i++)e.set(ln(),ln());return e}}var ms=String.fromCharCode;function o$(t){let e=Fe,i=new Array(t);for(let r=0;r<t;r++){let n=Tt[Fe++];if((n&128)>0){Fe=e;return}i[r]=n}return ms.apply(String,i)}function lz(t){if(t<4)if(t<2){if(t===0)return"";{let e=Tt[Fe++];if((e&128)>1){Fe-=1;return}return ms(e)}}else{let e=Tt[Fe++],i=Tt[Fe++];if((e&128)>0||(i&128)>0){Fe-=2;return}if(t<3)return ms(e,i);let r=Tt[Fe++];if((r&128)>0){Fe-=3;return}return ms(e,i,r)}else{let e=Tt[Fe++],i=Tt[Fe++],r=Tt[Fe++],n=Tt[Fe++];if((e&128)>0||(i&128)>0||(r&128)>0||(n&128)>0){Fe-=4;return}if(t<6){if(t===4)return ms(e,i,r,n);{let s=Tt[Fe++];if((s&128)>0){Fe-=5;return}return ms(e,i,r,n,s)}}else if(t<8){let s=Tt[Fe++],o=Tt[Fe++];if((s&128)>0||(o&128)>0){Fe-=6;return}if(t<7)return ms(e,i,r,n,s,o);let a=Tt[Fe++];if((a&128)>0){Fe-=7;return}return ms(e,i,r,n,s,o,a)}else{let s=Tt[Fe++],o=Tt[Fe++],a=Tt[Fe++],l=Tt[Fe++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Fe-=8;return}if(t<10){if(t===8)return ms(e,i,r,n,s,o,a,l);{let u=Tt[Fe++];if((u&128)>0){Fe-=9;return}return ms(e,i,r,n,s,o,a,l,u)}}else if(t<12){let u=Tt[Fe++],c=Tt[Fe++];if((u&128)>0||(c&128)>0){Fe-=10;return}if(t<11)return ms(e,i,r,n,s,o,a,l,u,c);let h=Tt[Fe++];if((h&128)>0){Fe-=11;return}return ms(e,i,r,n,s,o,a,l,u,c,h)}else{let u=Tt[Fe++],c=Tt[Fe++],h=Tt[Fe++],d=Tt[Fe++];if((u&128)>0||(c&128)>0||(h&128)>0||(d&128)>0){Fe-=12;return}if(t<14){if(t===12)return ms(e,i,r,n,s,o,a,l,u,c,h,d);{let p=Tt[Fe++];if((p&128)>0){Fe-=13;return}return ms(e,i,r,n,s,o,a,l,u,c,h,d,p)}}else{let p=Tt[Fe++],f=Tt[Fe++];if((p&128)>0||(f&128)>0){Fe-=14;return}if(t<15)return ms(e,i,r,n,s,o,a,l,u,c,h,d,p,f);let m=Tt[Fe++];if((m&128)>0){Fe-=15;return}return ms(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m)}}}}}function AD(t){return ha.copyBuffers?Uint8Array.prototype.slice.call(Tt,Fe,Fe+=t):Tt.subarray(Fe,Fe+=t)}function pf(t){let e=Tt[Fe++];if(Wo[e])return Wo[e](Tt.subarray(Fe,Fe+=t));throw new Error("Unknown extension type "+e)}var r8=new Array(4096);function a$(){let t=Tt[Fe++];if(t>=160&&t<192){if(t=t-160,yh>=Fe)return hp.slice(Fe-xl,(Fe+=t)-xl);if(!(yh==0&&Pp<180))return pB(t)}else return Fe--,ln();let e=(t<<5^(t>1?tr.getUint16(Fe):t>0?Tt[Fe]:0))&4095,i=r8[e],r=Fe,n=Fe+t-3,s,o=0;if(i&&i.bytes==t){for(;r<n;){if(s=tr.getUint32(r),s!=i[o++]){r=1879048192;break}r+=4}for(n+=3;r<n;)if(s=Tt[r++],s!=i[o++]){r=1879048192;break}if(r===n)return Fe=r,i.string;n-=3,r=Fe}for(i=[],r8[e]=i,i.bytes=t;r<n;)s=tr.getUint32(r),i.push(s),r+=4;for(n+=3;r<n;)s=Tt[r++],i.push(s);let a=t<16?lz(t):o$(t);return a!=null?i.string=a:i.string=pB(t)}var n8=(t,e)=>{var i=ln();let r=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,i.highByte=e);let n=Yi[t];return n&&n.isShared&&((Yi.restoreStructures||(Yi.restoreStructures=[]))[t]=n),Yi[t]=i,i.read=az(i,r),i.read()},l$=typeof self=="object"?self:global;Wo[0]=()=>{};Wo[0].noBuffer=!0;Wo[101]=()=>{let t=ln();return(l$[t[0]]||Error)(t[1])};Wo[105]=t=>{let e=tr.getUint32(Fe-4);Xc||(Xc=new Map);let i=Tt[Fe],r;i>=144&&i<160||i==220||i==221?r=[]:r={};let n={target:r};Xc.set(e,n);let s=ln();return n.used?Object.assign(r,s):(n.target=s,s)};Wo[112]=t=>{let e=tr.getUint32(Fe-4),i=Xc.get(e);return i.used=!0,i.target};Wo[115]=()=>new Set(ln());var u$=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");Wo[116]=t=>{let e=t[0],i=u$[e];if(!i)throw new Error("Could not find typed array for code "+e);return new l$[i](Uint8Array.prototype.slice.call(t,1).buffer)};Wo[120]=()=>{let t=ln();return new RegExp(t[0],t[1])};Wo[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],i=Fe;Fe+=e-4,La=[ln(),ln()],La.position0=0,La.position1=0;let r=Fe;Fe=i;try{return ln()}finally{Fe=r}};Wo[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function h$(t){let e=Pp,i=Fe,r=xl,n=yh,s=hp,o=Xc,a=La,l=new Uint8Array(Tt.slice(0,Pp)),u=Yi,c=Yi.slice(0,Yi.length),h=ha,d=n0,p=t();return Pp=e,Fe=i,xl=r,yh=n,hp=s,Xc=o,La=a,Tt=l,n0=d,Yi=u,Yi.splice(0,Yi.length,...c),ha=h,tr=new DataView(Tt.buffer,Tt.byteOffset,Tt.byteLength),p}function fB(){Tt=null,Xc=null,Yi=null}function HEe(t){t.unpack?Wo[t.type]=t.unpack:Wo[t.type]=t}var uz=new Array(147);for(let t=0;t<256;t++)uz[t]=+("1e"+Math.floor(45.15-t*.30103));var zP=new h2({useRecords:!1});zP.unpack;zP.unpackMultiple;zP.unpack;var GEe=new Float32Array(1);new Uint8Array(GEe.buffer,0,4);var kM;try{kM=new TextEncoder}catch{}var c2,hz,HP=typeof Buffer<"u",ED=HP?Buffer.allocUnsafeSlow:Uint8Array,c$=HP?Buffer:Uint8Array,s8=HP?4294967296:2144337920,it,mn,qe=0,qu,Xu=null,VEe=/[\u0080-\uFFFF]/,Kb=Symbol("record-id"),d$=class extends h2{constructor(t){super(t),this.offset=0;let e,i,r,n,s,o=0,a=c$.prototype.utf8Write?function(S,E,M){return it.utf8Write(S,E,M)}:kM&&kM.encodeInto?function(S,E){return kM.encodeInto(S,it.subarray(E)).written}:!1,l=this;t||(t={});let u=t&&t.sequential,c=t.structures||t.saveStructures,h=t.maxSharedStructures;if(h==null&&(h=c?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=t.maxOwnStructures;d==null&&(d=c?32:64),u&&!t.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,m=h+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],y=0,v=0;this.pack=this.encode=function(S,E){if(it||(it=new ED(8192),mn=new DataView(it.buffer,0,8192),qe=0),qu=it.length-10,qu-qe<2048?(it=new ED(it.length),mn=new DataView(it.buffer,0,it.length),qu=it.length-10,qe=0):qe=qe+7&2147483640,e=qe,s=l.structuredClone?new Map:null,l.bundleStrings?(Xu=["",""],it[qe++]=214,it[qe++]=98,Xu.position=qe-e,qe+=4):Xu=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let M=i.sharedLength||0;if(M>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let R=0;R<M;R++){let C=i[R];if(!C)continue;let T,L=i.transitions;for(let I=0,D=C.length;I<D;I++){let F=C[I];T=L[F],T||(T=L[F]=Object.create(null)),L=T}L[Kb]=R+64}o=M}u||(i.nextId=M+64)}r&&(r=!1),n=i||[];try{if(b(S),Xu){mn.setUint32(Xu.position+e,qe-Xu.position-e);let M=Xu;Xu=null,b(M[0]),b(M[1])}if(l.offset=qe,s&&s.idsToInsert){qe+=s.idsToInsert.length*6,qe>qu&&A(qe),l.offset=qe;let M=WEe(it.subarray(e,qe),s.idsToInsert);return s=null,M}return E&qEe?(it.start=e,it.end=qe,it):it.subarray(e,qe)}finally{if(i){if(v<10&&v++,y>1e4)i.transitions=null,v=0,y=0,g.length>0&&(g=[]);else if(g.length>0&&!u){for(let M=0,R=g.length;M<R;M++)g[M][Kb]=0;g=[]}if(r&&l.saveStructures){let M=i.sharedLength||h;i.length>M&&(i=i.slice(0,M));let R=it.subarray(e,qe);return l.saveStructures(i,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(S)):(o=M,R)}}E&XEe&&(qe=e)}};let b=S=>{qe>qu&&(it=A(qe));var E=typeof S,M;if(E==="string"){let R=S.length;if(Xu&&R>=8&&R<4096){let L=VEe.test(S);Xu[L?0:1]+=S,it[qe++]=193,b(L?-R:R);return}let C;R<32?C=1:R<256?C=2:R<65536?C=3:C=5;let T=R*3;if(qe+T>qu&&(it=A(qe+T)),R<64||!a){let L,I,D,F=qe+C;for(L=0;L<R;L++)I=S.charCodeAt(L),I<128?it[F++]=I:I<2048?(it[F++]=I>>6|192,it[F++]=I&63|128):(I&64512)===55296&&((D=S.charCodeAt(L+1))&64512)===56320?(I=65536+((I&1023)<<10)+(D&1023),L++,it[F++]=I>>18|240,it[F++]=I>>12&63|128,it[F++]=I>>6&63|128,it[F++]=I&63|128):(it[F++]=I>>12|224,it[F++]=I>>6&63|128,it[F++]=I&63|128);M=F-qe-C}else M=a(S,qe+C,T);M<32?it[qe++]=160|M:M<256?(C<2&&it.copyWithin(qe+2,qe+1,qe+1+M),it[qe++]=217,it[qe++]=M):M<65536?(C<3&&it.copyWithin(qe+3,qe+2,qe+2+M),it[qe++]=218,it[qe++]=M>>8,it[qe++]=M&255):(C<5&&it.copyWithin(qe+5,qe+3,qe+3+M),it[qe++]=219,mn.setUint32(qe,M),qe+=4),qe+=M}else if(E==="number")if(S>>>0===S)S<64?it[qe++]=S:S<256?(it[qe++]=204,it[qe++]=S):S<65536?(it[qe++]=205,it[qe++]=S>>8,it[qe++]=S&255):(it[qe++]=206,mn.setUint32(qe,S),qe+=4);else if(S>>0===S)S>=-32?it[qe++]=256+S:S>=-128?(it[qe++]=208,it[qe++]=S+256):S>=-32768?(it[qe++]=209,mn.setInt16(qe,S),qe+=2):(it[qe++]=210,mn.setInt32(qe,S),qe+=4);else{let R;if((R=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){it[qe++]=202,mn.setFloat32(qe,S);let C;if(R<4||(C=S*uz[(it[qe]&127)<<1|it[qe+1]>>7])>>0===C){qe+=4;return}else qe--}it[qe++]=203,mn.setFloat64(qe,S),qe+=8}else if(E==="object")if(!S)it[qe++]=192;else{if(s){let C=s.get(S);if(C){if(!C.id){let T=s.idsToInsert||(s.idsToInsert=[]);C.id=T.push(C)}it[qe++]=214,it[qe++]=112,mn.setUint32(qe,C.id),qe+=4;return}else s.set(S,{offset:qe-e})}let R=S.constructor;if(R===Object)_(S,!0);else if(R===Array){M=S.length,M<16?it[qe++]=144|M:M<65536?(it[qe++]=220,it[qe++]=M>>8,it[qe++]=M&255):(it[qe++]=221,mn.setUint32(qe,M),qe+=4);for(let C=0;C<M;C++)b(S[C])}else if(R===Map){M=S.size,M<16?it[qe++]=128|M:M<65536?(it[qe++]=222,it[qe++]=M>>8,it[qe++]=M&255):(it[qe++]=223,mn.setUint32(qe,M),qe+=4);for(let[C,T]of S)b(C),b(T)}else{for(let C=0,T=c2.length;C<T;C++){let L=hz[C];if(S instanceof L){let I=c2[C];if(I.write){I.type&&(it[qe++]=212,it[qe++]=I.type,it[qe++]=0),b(I.write.call(this,S));return}let D=it,F=mn,H=qe;it=null;let z;try{z=I.pack.call(this,S,B=>(it=D,D=null,qe+=B,qe>qu&&A(qe),{target:it,targetView:mn,position:qe-B}),b)}finally{D&&(it=D,mn=F,qe=H,qu=it.length-10)}z&&(z.length+qe>qu&&A(z.length+qe),qe=jEe(z,it,qe,I.type));return}}_(S,!S.hasOwnProperty)}}else if(E==="boolean")it[qe++]=S?195:194;else if(E==="bigint"){if(S<BigInt(1)<<BigInt(63)&&S>=-(BigInt(1)<<BigInt(63)))it[qe++]=211,mn.setBigInt64(qe,S);else if(S<BigInt(1)<<BigInt(64)&&S>0)it[qe++]=207,mn.setBigUint64(qe,S);else if(this.largeBigIntToFloat)it[qe++]=203,mn.setFloat64(qe,Number(S));else throw new RangeError(S+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");qe+=8}else if(E==="undefined")this.encodeUndefinedAsNil?it[qe++]=192:(it[qe++]=212,it[qe++]=0,it[qe++]=0);else if(E==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+E)},_=this.useRecords===!1?this.variableMapSize?S=>{let E=Object.keys(S),M=E.length;M<16?it[qe++]=128|M:M<65536?(it[qe++]=222,it[qe++]=M>>8,it[qe++]=M&255):(it[qe++]=223,mn.setUint32(qe,M),qe+=4);let R;for(let C=0;C<M;C++)b(R=E[C]),b(S[R])}:(S,E)=>{it[qe++]=222;let M=qe-e;qe+=2;let R=0;for(let C in S)(E||S.hasOwnProperty(C))&&(b(C),b(S[C]),R++);it[M+++e]=R>>8,it[M+e]=R&255}:S=>{let E=Object.keys(S),M,R=n.transitions||(n.transitions=Object.create(null)),C=0;for(let L=0,I=E.length;L<I;L++){let D=E[L];M=R[D],M||(M=R[D]=Object.create(null),C++),R=M}let T=R[Kb];if(T)T>=96&&p?(it[qe++]=((T-=96)&31)+96,it[qe++]=T>>5):it[qe++]=T;else{T=n.nextId,T||(T=64),T<f&&this.shouldShareStructure&&!this.shouldShareStructure(E)?(T=n.nextOwnId,T<m||(T=f),n.nextOwnId=T+1):(T>=m&&(T=f),n.nextId=T+1);let L=E.highByte=T>=96&&p?T-96>>5:-1;R[Kb]=T,n[T-64]=E,T<f?(E.isShared=!0,n.sharedLength=T-63,r=!0,L>=0?(it[qe++]=(T&31)+96,it[qe++]=L):it[qe++]=T):(L>=0?(it[qe++]=213,it[qe++]=114,it[qe++]=(T&31)+96,it[qe++]=L):(it[qe++]=212,it[qe++]=114,it[qe++]=T),C&&(y+=v*C),g.length>=d&&(g.shift()[Kb]=0),g.push(R),b(E))}for(let L=0,I=E.length;L<I;L++)b(S[E[L]])},A=S=>{let E;if(S>16777216){if(S-e>s8)throw new Error("Packed buffer would be larger than maximum buffer size");E=Math.min(s8,Math.round(Math.max((S-e)*(S>67108864?1.25:2),4194304)/4096)*4096)}else E=(Math.max(S-e<<2,it.length-1)>>12)+1<<12;let M=new ED(E);return mn=new DataView(M.buffer,0,E),it.copy?it.copy(M,0,e,S):M.set(it.slice(e,S)),qe-=e,e=0,qu=M.length-10,it=M}}useBuffer(t){it=t,mn=new DataView(it.buffer,it.byteOffset,it.byteLength),qe=0}};hz=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,r$];c2=[{pack(t,e,i){let r=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:n,targetView:s,position:o}=e(6);n[o++]=214,n[o++]=255,s.setUint32(o,r)}else if(r>0&&r<17179869184){let{target:n,targetView:s,position:o}=e(10);n[o++]=215,n[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(o+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),i(this.onInvalidDate());let{target:n,targetView:s,position:o}=e(3);n[o++]=212,n[o++]=255,n[o++]=255}else{let{target:n,targetView:s,position:o}=e(15);n[o++]=199,n[o++]=12,n[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(r)))}}},{pack(t,e,i){let r=Array.from(t),{target:n,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),i(r)}},{pack(t,e,i){let{target:r,position:n}=e(this.structuredClone?3:0);this.structuredClone&&(r[n++]=212,r[n++]=101,r[n++]=0),i([t.name,t.message])}},{pack(t,e,i){let{target:r,position:n}=e(this.structuredClone?3:0);this.structuredClone&&(r[n++]=212,r[n++]=120,r[n++]=0),i([t.source,t.flags])}},{pack(t,e){this.structuredClone?o8(t,16,e):a8(HP?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let i=t.constructor;i!==c$&&this.structuredClone?o8(t,u$.indexOf(i.name),e):a8(t,e)}},{pack(t,e){let{target:i,position:r}=e(1);i[r]=193}}];function o8(t,e,i,r){let n=t.byteLength;if(n+1<256){var{target:s,position:o}=i(4+n);s[o++]=199,s[o++]=n+1}else if(n+1<65536){var{target:s,position:o}=i(5+n);s[o++]=200,s[o++]=n+1>>8,s[o++]=n+1&255}else{var{target:s,position:o,targetView:a}=i(7+n);s[o++]=201,a.setUint32(o,n+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function a8(t,e){let i=t.byteLength;var r,n;if(i<256){var{target:r,position:n}=e(i+2);r[n++]=196,r[n++]=i}else if(i<65536){var{target:r,position:n}=e(i+3);r[n++]=197,r[n++]=i>>8,r[n++]=i&255}else{var{target:r,position:n,targetView:s}=e(i+5);r[n++]=198,s.setUint32(n,i),n+=4}r.set(t,n)}function jEe(t,e,i,r){let n=t.length;switch(n){case 1:e[i++]=212;break;case 2:e[i++]=213;break;case 4:e[i++]=214;break;case 8:e[i++]=215;break;case 16:e[i++]=216;break;default:n<256?(e[i++]=199,e[i++]=n):n<65536?(e[i++]=200,e[i++]=n>>8,e[i++]=n&255):(e[i++]=201,e[i++]=n>>24,e[i++]=n>>16&255,e[i++]=n>>8&255,e[i++]=n&255)}return e[i++]=r,e.set(t,i),i+=n,i}function WEe(t,e){let i,r=e.length*6,n=t.length-r;for(e.sort((s,o)=>s.offset>o.offset?1:-1);i=e.pop();){let s=i.offset,o=i.id;t.copyWithin(s+r,s,n),r-=6;let a=s+r;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,n=s}return t}function q0(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");hz.unshift(t.Class),c2.unshift(t)}HEe(t)}var p$=new d$({useRecords:!1});p$.pack;p$.pack;var qEe=512,XEe=1024,l8=new d$({structuredClone:!0});q0({Class:ui.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,ui.prototype),t}});q0({Class:qt.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,qt.prototype),t}});q0({Class:Gs.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,Gs.prototype),t}});q0({Class:J6.prototype.constructor,type:4,write(t){return t.id},read(t){return new J6(t)}});q0({Class:Q6.prototype.constructor,type:5,write(t){return t.data},read(t){return new Q6(t)}});q0({Class:Vn.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Vn.prototype),t}});function YEe(t){var e=0;if(t.length===0)return e;for(let i=0;i<t.length;i++){let r=t[i];e=(e<<5)-e+r,e=e&e}return e}function mB(t){if(iz(t))return t;if(Array.isArray(t))return t.map(mB);if(typeof t=="object"&&t!==null){let e={};for(let i of Object.keys(t).sort())e[i]=mB(t[i]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var gB;(t=>{function e(n){return l8.pack(n)}t.serialize=e;function i(n){return l8.unpack(n)}t.deserialize=i;function r(n){return YEe(e(mB(n))).toString()}t.checksum=r})(gB||(gB={}));var u8;(t=>{function e(r){return r.type==="Conditional"?r.condition.type==="Distance"?"Distance":"StateChange":r.type}t.toEventUIType=e;function i(r){return r==="Distance"||r==="StateChange"?"Conditional":r}t.fromEventUIType=i})(u8||(u8={}));var ra={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional"]},h8;(t=>{function e(r){return r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress"||r.type==="KeyDown"||r.type==="KeyUp"||r.type==="KeyPress"}t.is=e;function i(r){return r==="MouseDown"||r==="MouseUp"||r==="MousePress"?{type:r,mode:"Object",disabled:!1,runMode:"Once",actions:new qt}:{type:r,disabled:!1,key:void 0,runMode:"Once",actions:new qt}}t.defaultData=i})(h8||(h8={}));var d2;(t=>{function e(i){return{type:"Property",value:[i??null,"position","x"]}}t.propertyDefaultData=e,t.valueDefaultData={type:"Literal",value:0}})(d2||(d2={}));var yB;(t=>{function e(n){return{type:"Comparison",operator:"==",lOperand:d2.propertyDefaultData(n),rOperand:{...d2.valueDefaultData}}}t.comparisonDefaultData=e;function i(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}t.distanceDefaultData=i;function r(n,s){return{type:"State",object:n??null,state:s??null}}t.stateDefaultData=r})(yB||(yB={}));var c8;(t=>{function e(r){return r.type==="Conditional"}t.is=e;function i(r){return{type:"Conditional",disabled:!1,inActions:new qt,outActions:new qt,condition:yB.distanceDefaultData(r)}}t.defaultData=i})(c8||(c8={}));var d8;(t=>t.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new qt,drop:new qt}})(d8||(d8={}));var vB;(t=>t.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new qt})(vB||(vB={}));var bB;(t=>t.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(bB||(bB={}));var p8;(t=>{function e(r){return r.type==="MouseHover"}t.is=e;function i(){return{type:"MouseHover",disabled:!1,actions:new qt}}t.defaultData=i})(p8||(p8={}));var f8;(t=>{function e(r){return r.type==="Scroll"}t.is=e;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new qt}}t.defaultData=i})(f8||(f8={}));var m8;(t=>{function e(r){return r.type==="Start"}t.is=e;function i(){return{type:"Start",disabled:!1,actions:new qt}}t.defaultData=i})(m8||(m8={}));var g8;(t=>{function e(r){return r.type==="Collision"}t.is=e;function i(){return{type:"Collision",disabled:!1,runMode:"Once",target:"character",actions:new qt}}t.defaultData=i})(g8||(g8={}));var y8;(t=>{function e(r){return r.type==="Trigger"}t.is=e;function i(r,n){return{type:"Trigger",disabled:!1,runMode:"Once",target:"all",triggeringObjects:[],actions:new qt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:r.toArray(),radius:r.length()/2,helperVisible:!0}}t.defaultData=i})(y8||(y8={}));var xB;(t=>{t.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function e(o){return o.type==="Resize"}t.is=e;function i(o){return typeof o=="string"?o:"custom"}t.sizeToDevice=i;function r(o){return typeof o=="string"?[...t.defaultSizes[o]]:[...o]}t.deviceToSize=r;function n(){let o={size:"mobile",operator:"<",actions:new qt},a={size:"tablet",operator:"<",actions:new qt},l={size:[...t.defaultSizes.custom],operator:"<>",actions:new qt},u=new qt;return u.push({id:kt.generateUUID(),fi:0,data:o},{id:kt.generateUUID(),fi:1,data:a},{id:kt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:u}}t.defaultData=n;function s(){return{size:[...t.defaultSizes.custom],operator:"<>",actions:new qt}}t.defaultBreakpointData=s})(xB||(xB={}));var wB;(t=>{t.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function e(r){return r.type==="VariableChange"}t.is=e;function i(){return{disabled:!1,type:"VariableChange",actions:new qt,variableId:"",objectId:null,property:"Position X"}}t.defaultData=i})(wB||(wB={}));var X0="personal camera",hw="a218fcc3-276b-49b9-b485-49037fd14f5f",KEe=2960946,Ka=5526619,Fc;(t=>{function e(f,m){return f[0]===m[0]&&f[1]===m[1]}t.isEqual=e;function i(f,m,g){return[f[0]+(m[0]-f[0])*g,f[1]+(m[1]-f[1])*g]}t.lerp=i;function r(f,m){return[f[0]+m[0],f[1]+m[1]]}t.add=r;function n(f,m){return[f[0]-m[0],f[1]-m[1]]}t.sub=n;function s(f,m){return[f[0]*m[0],f[1]*m[1]]}t.multiply=s;function o(f,m){return[f[0]/m[0],f[1]/m[1]]}t.divide=o;function a(f,m){return Math.pow(m[0]-f[0],2)+Math.pow(m[1]-f[1],2)}t.distanceSquared=a;function l(f,m){return Math.sqrt(a(f,m))}t.distance=l;function u(f,m){return f[0]*m[0]+f[1]*m[1]}t.dot=u;function c(f,m){return[f[0]*m,f[1]*m]}t.scalarMultiply=c;function h(f,m,g){let y=t.sub(m,f),v=t.sub(g,f),b=t.dot(y,v)/t.dot(y,y),_=t.scalarMultiply(y,b);return t.add(f,_)}t.projectionOnto=h;function d(f,m,g){return l(f,h(f,m,g))}t.projectionOntoDistance=d;function p(f,m){return[(f[0]+m[0])*.5,(f[1]+m[1])*.5]}t.center=p})(Fc||(Fc={}));var mm;(t=>{function e(l,u){return l[0]===u[0]&&l[1]===u[1]&&l[2]===u[2]}t.isEqual=e;function i(l,u){return[l[0]+u[0],l[1]+u[1],l[2]+u[2]]}t.add=i;function r(l,u){return[l[0]-u[0],l[1]-u[1],l[2]-u[2]]}t.sub=r;function n(l,u){return[l[0]/u[0],l[1]/u[1],l[2]/u[2]]}t.div=n;function s(l,u){return[l[0]*u[0],l[1]*u[1],l[2]*u[2]]}t.mul=s;function o(l,u){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])}t.dist=o;function a(l,u,c){return[l[0]+(u[0]-l[0])*c,l[1]+(u[1]-l[1])*c,l[2]+(u[2]-l[2])*c]}t.lerp=a})(mm||(mm={}));var p2;(t=>{function e(r,n){return r[0]===n[0]&&r[1]===n[1]&&r[2]===n[2]&&r[3]===n[3]}t.isEqual=e;function i(r,n,s){return[r[0]+(n[0]-r[0])*s,r[1]+(n[1]-r[1])*s,r[2]+(n[2]-r[2])*s,r[3]+(n[3]-r[3])*s]}t.lerp=i})(p2||(p2={}));var s0;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(n,s){for(let o=0;o<16;o++)if(n[o]!==s[o])return!1;return!0}t.isEqual=e;function i(n){return n??t.identity}t.simplify=i;function r(n,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let u=n[3]*s[a]+n[7]*s[a+1]+n[11]*s[a+2]+n[15];o[a]=(n[0]*s[a]+n[4]*s[a+1]+n[8]*s[a+2]+n[12])/u,o[a+1]=(n[1]*s[a]+n[5]*s[a+1]+n[9]*s[a+2]+n[13])/u,o[a+2]=(n[2]*s[a]+n[6]*s[a+1]+n[10]*s[a+2]+n[14])/u}return o}t.applyMatrix4=r})(s0||(s0={}));var ao;(t=>{function e(u){return typeof u=="object"&&typeof u.r=="number"&&typeof u.g=="number"&&typeof u.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function i(u){return{r:Math.round(u.r*255),g:Math.round(u.g*255),b:Math.round(u.b*255),a:1}}t.toRgb255a1=i;function r(u){return{r:u.r,g:u.g,b:u.b}}t.clone=r;function n(u){return u=Math.floor(u),{r:(u>>16&255)/255,g:(u>>8&255)/255,b:(u&255)/255}}t.fromHex=n;function s(u){return Math.round(u.r*255)*65536+Math.round(u.g*255)*256+Math.round(u.b*255)}t.toHex=s;function o(u,c){return u.r===c.r&&u.g===c.g&&u.b===c.b}t.equals=o;function a(u,c){return u.r.toFixed(2)===c.r.toFixed(2)&&u.g.toFixed(2)===c.g.toFixed(2)&&u.b.toFixed(2)===c.b.toFixed(2)}t.equalsFixed=a;function l(u,c,h){return{r:u.r+(c.r-u.r)*h,g:u.g+(c.g-u.g)*h,b:u.b+(c.b-u.b)*h}}t.lerp=l})(ao||(ao={}));var hr;(t=>{t.white={...ao.white,a:1},t.transparent={...ao.white,a:0};function e(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}t.from0to1=e;function i(l,u){return{...ao.fromHex(l),a:u}}t.fromHexAndA=i;function r(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}t.toRgb255a1=r;function n(l,u){return ao.equals(l,u)&&l.a===u.a}t.equals=n;function s(l,u){return ao.equalsFixed(l,u)&&l.a.toFixed(2)===u.a.toFixed(2)}t.equalsFixed=s;function o(l,u,c){return{r:l.r+(u.r-l.r)*c,g:l.g+(u.g-l.g)*c,b:l.b+(u.b-l.b)*c,a:l.a+(u.a-l.a)*c}}t.lerp=o;function a({r:l,g:u,b:c,a:h}=t.white){return`rgba(${l*255}, ${u*255}, ${c*255}, ${h})`}t.toStyle=a})(hr||(hr={}));var _B;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(_B||(_B={}));var v8;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(v8||(v8={}));var b8;(t=>t.defaultData={control1:[.5,0],control2:[.5,1]})(b8||(b8={}));var Xd;(t=>(t.linear=[0,0,1,1],t.ease=[.25,.1,.25,1],t.easeIn=[.42,0,1,1],t.easeOut=[0,0,.58,1],t.easeInOut=[.42,0,.58,1]))(Xd||(Xd={}));function x8(t){return typeof t=="string"&&t.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t):!1}var Om;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(i){return t.all.includes(i)}t.is=e})(Om||(Om={}));var o0;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(i){return i.type==="PerspectiveCamera"?i.perspective.zoom:i.orthographic.zoom}t.getZoom=e})(o0||(o0={}));var cp;(t=>{function e(r,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(r[0],r[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[r[0]+r[0]*n,0,0]},grid:{count:[2,2,2],size:r.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function i(r,n){let s={...r};if(f$.forEach(o=>{Object.assign(s,{[o]:n[o]??r[o]})}),s.radial={...r.radial},n.radial){let o=r.radial,a=n.radial;m$.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...r.linear},n.linear){let o=r.linear,a=n.linear;g$.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...r.grid},n.grid){let o=r.grid,a=n.grid;y$.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...r.toObject},n.toObject){let o=r.toObject,a=n.toObject;v$.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...r.randomnessObject},n.randomnessObject){let o=r.randomnessObject,a=n.randomnessObject;b$.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=i})(cp||(cp={}));var SB;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function i(r,n){let s=[];r.count!==void 0&&s.push({type:0,path:n,props:{count:r.count}});for(let o of e){let a=r[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...n,o],props:a})}return s}t.toOps=i})(SB||(SB={}));var f$=["count"],m$=["radius","start","end","position","scale","rotation"],g$=["position","scale","rotation"],y$=["count","size"],v$=["count","position","scale","rotation"],b$=["strength","scale","rotation","position","movement","seed","freqScale"],AB;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(i){return t.all.includes(i)}t.is=e})(AB||(AB={}));var EB;(t=>{function e(r){return i(r)}t.defaultData=e;function i(r){if(r==="PointLight")return{type:r,color:hr.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(r==="SpotLight")return{type:r,color:hr.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(r==="DirectionalLight")return{type:r,color:hr.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(EB||(EB={}));var f2;(t=>(t.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},t.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},t.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:t.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeLoopDelayStart:"end",emitTimeDuration:1,...t.defaultCollisionData}))(f2||(f2={}));var a0;(t=>t.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(a0||(a0={}));var MB;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(i,r){return i.castShadow===r.castShadow&&i.receiveShadow===r.receiveShadow}t.equals=e})(MB||(MB={}));var CB;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(i,r){return i.flatShading===r.flatShading&&i.side===r.side&&i.wireframe===r.wireframe}t.equals=e})(CB||(CB={}));var PB;(t=>t.defaultData={...CB.defaultData,...MB.defaultData})(PB||(PB={}));var w8;(t=>{function e(i,r){var s,o;let n=[];if("material"in i){let a=typeof i.material=="string"?r.materials[i.material]??((s=r.lib.materials[i.material])==null?void 0:s.asset):i.material;a&&n.push(a)}else if("materials"in i)for(let a of i.materials){let l=typeof a=="string"?r.materials[a]??((o=r.lib.materials[a])==null?void 0:o.asset):a;l&&n.push(l)}return n}t.getMaterialData=e})(w8||(w8={}));var m2;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(m2||(m2={}));var _8;(t=>{function e(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="particle"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}t.is=e})(_8||(_8={}));function JEe(t){return t.type!=="displace"}var S8;(t=>{function e(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}t.is=e})(S8||(S8={}));var x$=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],QEe=["wrapping","image","video","name","minFilter"],ys;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let u=s.texture;u&&Object.assign(u,a)}}t.patch=e;function i(s,o){return s==="light"&&o?r(o):n(s)}t.defaultData=i;function r(s){let o={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...o,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...o,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...o,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...o,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let o={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...o,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],minFilter:1008},crop:!1};case"video":return{...o,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:m2.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],minFilter:1008},crop:!1};case"color":return{...o,type:"color",color:ao.fromHex(Ka)};case"depth":return{...o,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...o,type:"normal",cnormal:[1,1,1]};case"gradient":return{...o,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...o,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ao.fromHex(6710886),a:1},colorB:{...ao.fromHex(6710886),a:1},colorC:{...ao.fromHex(16777215),a:1},colorD:{...ao.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...o,type:"fresnel",color:hr.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...o,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...o,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:hr.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...o,type:"outline",outlineColor:hr.fromHexAndA(0,1),contourColor:hr.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...o,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],minFilter:1008}};case"transmission":return{...o,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...o,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ao.fromHex(0),a:1},colorB:{...ao.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(ys||(ys={}));var fo;(t=>{function e(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}t.isMergable=e;function i(c){let h="";return c.layers.forEach(d=>{Object.entries(d.data).forEach(([p,f])=>{h+=`${p}${f}`,Array.isArray(f)?f.forEach(m=>h+=`${m}`):typeof f=="object"?Object.values(f).forEach(m=>{typeof m=="number"?h+=`${m.toFixed(4)}`:h+=`${m}`}):h+=`${f}`})}),h}t.getHash=i;function r(){return{layers:new qt}}t.defaultEmptyData=r;function n(c="layer1",h="layer2"){return o("phong",c,h)}t.defaultData=n;function s(c,h){return{...c,name:h}}t.withName=s;function o(c,h="layer1",d="layer2"){let p=new qt;return p.push({fi:0,data:ys.defaultData("light",c),id:h}),p.push({fi:1,data:ys.defaultData("color"),id:d}),{layers:p}}t.defaultTwoLayerData=o;function a(c){let h=ys.defaultData("texture");c&&Object.assign(h.texture,{image:c});let d=new qt;return d.push({fi:0,data:h,id:"layer1"}),d.push({fi:1,data:{...ys.defaultData("transmission"),alpha:1},id:"layer2"}),d.push({fi:2,data:{...ys.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:d}}t.defaultUIObjectMaterial=a;function l(c,h="phong",d="layer1",p="layer2"){let f=ys.defaultData("texture");Object.assign(f.texture,{image:c});let m=new qt;return m.push({fi:0,data:f,id:d}),m.push({fi:1,data:ys.defaultData("light",h),id:p}),{layers:m}}t.defaultTwoLayerTextureData=l;function u(c,h="phong",d="layer1",p="layer2"){let f=ys.defaultData("video");Object.assign(f.texture,{video:c});let m=new qt;return m.push({fi:0,data:f,id:d}),m.push({fi:1,data:ys.defaultData("light",h),id:p}),{layers:m}}t.defaultTwoLayerVideoTextureData=u})(fo||(fo={}));var g2;(t=>{function e(){return{points:new qt,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(g2||(g2={}));var y2;(t=>{function e(){return{points:new qt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(y2||(y2={}));var w$={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},TB;(t=>{function e(i,r){let n={...i};return S$.forEach(s=>{Object.assign(n,{[s]:r[s]??i[s]})}),n}t.merge=e})(TB||(TB={}));var _$={shape:w$,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},S$=["depth","offset","angle","twist","startScale","endScale"],v2;(t=>{function e(r){return r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="UIGeometry"}t.is2DParametricMesh=e;function i(r){return r==="PolygonGeometry"||r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"||r==="PathGeometry"||r==="VectorGeometry"||r==="ConeGeometry"||r==="CubeGeometry"||r==="CylinderGeometry"||r==="DodecahedronGeometry"||r==="HelixGeometry"||r==="IcosahedronGeometry"||r==="LatheGeometry"||r==="PyramidGeometry"||r==="SphereGeometry"||r==="PlaneGeometry"||r==="BackdropGeometry"||r==="TorusGeometry"||r==="TorusKnotGeometry"||r==="BooleanGeometry"||r==="TextGeometry"}t.isParametricMesh=i})(v2||(v2={}));var RB;(t=>{function e(i,r){let n={...i};return Object.assign(n,r),n.type==="PathGeometry"&&"extrusion"in r&&r.extrusion&&(n.extrusion={...i.extrusion},Object.assign(n.extrusion,TB.merge(n.extrusion,r.extrusion))),n}t.merge=e})(RB||(RB={}));var Mv;(t=>{function e(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="UIGeometry")return{type:i,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:y2.defaultData(),extrusion:_$};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:g2.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}t.defaultData=e})(Mv||(Mv={}));var A8=["width","height","depth"],kB;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:ao.white,near:.1,far:2e3})(kB||(kB={}));var b2;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(b2||(b2={}));var DB;(t=>t.defaultData={softShadowQuality:"low"})(DB||(DB={}));var IB;(t=>t.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(IB||(IB={}));var LB;(t=>t.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(LB||(LB={}));var l0;(t=>t.defaultData={usePhysics:!1,gravity:-10})(l0||(l0={}));var BB;(t=>t.defaultData={playCamera:X0,gameControlObject:null})(BB||(BB={}));var OB;(t=>t.defaultData={backgroundColor:hr.fromHexAndA(KEe,1),postprocessing:b2.defaultData,fog:kB.defaultData,globalPhysics:l0.defaultData,ambient:IB.defaultData,ao:LB.defaultData,shadow:DB.defaultData,publish:BB.defaultData})(OB||(OB={}));var UB;(t=>t.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(UB||(UB={}));var E8;(t=>{function e(r){return r==="Component"||r==="Instance"}t.isComponentRelated=e;function i(r){return r==="Empty"||r==="Instance"}t.isEmptyOrComponent=i})(E8||(E8={}));var u0;(t=>{t.identity={..._B.identity,hiddenMatrix:s0.identity};function e(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}t.fromObject=e;function i(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}t.merge=i;function r(n,s){return zZ({position:mm.isEqual(n.position,s.position)?void 0:s.position,rotation:mm.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:mm.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:s0.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}t.diff=r})(u0||(u0={}));var js;(t=>t.defaultData={states:new qt,events:new qt,visible:!0,raycastLock:!1,physics:a0.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...u0.identity,cloner:null})(js||(js={}));var NB;(t=>t.defaultData={type:"Empty",...js.defaultData})(NB||(NB={}));var M8;(t=>t.defaultData={type:"ParticleCollider",...UB.defaultData,...js.defaultData})(M8||(M8={}));var C8;(t=>t.defaultData={type:"Component",...js.defaultData})(C8||(C8={}));var P8;(t=>t.defaultData={type:"Particle",...js.defaultData,...f2.defaultData})(P8||(P8={}));var Cv;(t=>t.defaultData={type:"Mesh",...js.defaultData,...PB.defaultData})(Cv||(Cv={}));var i1;(t=>t.defaultData={...js.defaultData,...u0.identity,position:[0,0,o0.DefaultTargetOffset],...o0.defaultData})(i1||(i1={}));var FB;(t=>{function e(i){return{...js.defaultData,...EB.defaultData(i)}}t.defaultData=e,t.defaultDirectionalLightData={...t.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(FB||(FB={}));var x2;(t=>{function e(r,n,s=0){for(;s<n.length;){let o=r?r[n[s]]:void 0;if(n.length===s+1)return o;if(o)r=o.descendants,s+=1;else return}}t.resolveWithDes=e;function i(r,n,s=0){let o=e(r,n,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=i})(x2||(x2={}));var dp;(t=>{t.rootOverrideProps=["physics","events"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(r,n){return{...js.defaultData,...n,component:r,overrides:new Vn,physics:void 0,events:void 0,type:"Instance"}}t.ofComponent=e;function i(r){let n=u0.fromObject(r.data);return e(r.id,n)}t.fromComponentData=i})(dp||(dp={}));var h0;(t=>{t.defaultData={type:"Page",...js.defaultData,physics:{...a0.defaultData,fusedBody:!1},...OB.defaultData,camera:i1.defaultData};function e(i){return i.uiScene!==void 0}t.isUIPage=e})(h0||(h0={}));var zB;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:s0.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:a0.defaultData,states:new qt,events:new qt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...o0.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...js.defaultData,...Cv.defaultData,geometry:Mv.defaultData("RectangleGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...js.defaultData,...Cv.defaultData,geometry:Mv.defaultData("BooleanGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...js.defaultData,...Cv.defaultData,geometry:Mv.defaultData("TextGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")}))(zB||(zB={}));var Jf;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new Vn}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new Vn})))):Om.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function i(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=t1(a.material,l=>{if(typeof l!="string")for(let[u,c]of Object.entries(o.material.layers)){let h=l.layers.data(u);h&&ys.patch(h,c)}}).data),a.materials&&o.materials&&(a.materials=t1(a.materials,l=>{var u,c;for(let h=0;h<a.materials.length;h++){let d=o.materials[h];if(typeof d!="string")for(let[p,f]of Object.entries(d.layers)){let m=(c=(u=l[h])==null?void 0:u.layers)==null?void 0:c.data(p);m&&ys.patch(m,f)}}}).data),a}function r(s,o){let a,l=[],u={orthographic:0,perspective:0,geometry:0};function c(h,d){for(let[p,f]of Object.entries(d.layers)){let{texture:m,...g}=f;if(m!==void 0&&Object.keys(m).length>0){let y={path:[...h,"layers",p,"texture"],props:m,type:0};l.push(y)}if(Object.keys(g).length>0){let y={path:[...h,"layers",p],props:g,type:0};l.push(y)}}}for(let[h,d]of Object.entries(o))if(h!=="name")if(h==="cloner")l.push(...SB.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")c(["material"],d);else if(h==="materials")for(let[p,f]of Object.entries(d))c(["materials",p],f);else if(u[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let p={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(p),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let p={path:[h],props:d,type:0};l.push(p)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[h]=d;return l}t.toOps=r;function n(s,o){var l,u,c,h,d,p;if(o===void 0)return s;let a={...s};if(Object.assign(a,u0.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((u=a.pathSnapping)==null?void 0:u.slide)??0,offset:((c=o.pathSnapping)==null?void 0:c.offset)??((h=a.pathSnapping)==null?void 0:h.offset)??0})}),Om.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let f=o;((d=f.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(a.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(a.targetOffset=f.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:RB.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=i(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:cp.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:cp.merge(a.cloner,o.cloner)});else if(AB.is(s.type)){let f=o;f.intensity!==void 0&&(a.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?a.color=f.color:a.color=ao.clone(f.color))}return a}t.patch=n})(Jf||(Jf={}));var w2;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(w2||(w2={}));var pp;(t=>t.defaultData={orbitControls:w2.defaultData,playPage:hw,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((e,i)=>{let r=0,n=0;return i<5?n=-30:i<10&&(n=30),i===0||i===10||i===5?r=30:(i===4||i===11||i===9)&&(r=-30),[120,[r,n],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(pp||(pp={}));var HB;(t=>t.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(HB||(HB={}));var GB;(t=>t.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(GB||(GB={}));var Qf;(t=>(t.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...HB.defaultData},isRandomSeed:!0,seed:t.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:GB.defaultData}),t.generateSeed=()=>Math.round(Math.random()*1e5)))(Qf||(Qf={}));var r1;(t=>{function e(r){return r.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}t.physicsEnabled=e;function i(r,n,s){r.scene.objects.traverseFrom(n,(o,a)=>{var l;if(a.type==="Instance"){let u=(l=E2.getComponentData(r,a.component))==null?void 0:l.data;u&&s(o,a,u.events)}else s(o,a,a.events)})}t.traverseModuleInstances=i})(r1||(r1={}));var Zf;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(n={withLight:!0,withSquare:!0}){let s=[],o=zB.defaultMeshObject;n.withLight===!0&&s.push({fi:-1,data:FB.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),n.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]});let a=new Gs;return a.push({fi:1,id:hw,data:{...h0.defaultData,name:"Scene 1"},children:s}),a}t.defaultData={objects:e(),publish:pp.defaultData,styles:Qf.defaultData()},t.emptyDataWithoutPage=function(){return{objects:new Gs,publish:pp.defaultData,styles:Qf.defaultData()}},t.emptyDataWithPage=function(n){return{objects:e(n),publish:pp.defaultData,styles:Qf.defaultData()}},t.emptyData=function(){return{objects:new Gs,publish:{...pp.defaultData},styles:Qf.defaultData()}};function i(n){return{...t.defaultData,objects:Oh(n,Gs.prototype)}}t.withObjs=i;function r(n,s){return i([{id:n,data:s,children:[],fi:0}])}t.withObj=r})(Zf||(Zf={}));var cw;(t=>t.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(cw||(cw={}));var _2;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(_2||(_2={}));var Ha;(t=>{function e(o){return o.textValue!==void 0}t.isTextValue=e;function i(o){return typeof o=="number"}t.isNumber=i;function r(o){return typeof o=="boolean"}t.isBoolean=r;function n(o){return e(o)?"string":r(o)?"boolean":"number"}t.typeOfVariable=n;function s(o){return t.isTextValue(o)?Array.isArray(o.textValue)?o.textValue.map(a=>a.toString().padStart(o.padding??2,"0")).join(o.deliminator??":")+(o.suffix!==void 0?" "+o.suffix:""):o.textValue.toString():t.isBoolean(o)?o?"True":"False":t.isNumber(o)?parseFloat(o.toFixed(3)).toString():o.toString()}t.getDisplayedValue=s})(Ha||(Ha={}));var VB;(t=>t.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(VB||(VB={}));var T8;(t=>t.all=[...VB.all,"components"])(T8||(T8={}));var R8;(t=>{function e(){return{images:new ui,videos:new ui,colors:new ui,audios:new ui,particles:new ui,fonts:new ui,materials:new ui,components:new ui,variables:new ui}}t.defaultData=e})(R8||(R8={}));var Um;(t=>{function e(){return{images:new ui,videos:new ui,colors:new ui,audios:new ui,particles:new ui,fonts:new ui,materials:new ui,components:new ui,variables:new ui}}t.defaultData=e})(Um||(Um={}));var wl;(t=>{function e(){let o={};return o["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Oh(o,ui.prototype)}t.defaultColors=e;function i(o){let a={};return o!=null&&o.withAITexture&&(a["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={..._2.emptyImage,name:"AI generated image"}),Oh(a,ui.prototype)}t.defaultImages=i;function r(){return{catelogs:new ui,materials:new ui,images:new ui,videos:new ui,colors:new ui,audios:new ui,particles:new ui,fonts:new ui,variables:new qt,lib:Um.defaultData()}}t.emptyData=r;function n(o){switch(o){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let a=[0,0,0];return{name:"Time",value:{textValue:a,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:a,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",o)}}t.defaultVariables=n;function s(o,a){if(a.format==="HH:mm:ss"){let l=Math.floor(o/3600),u=Math.floor((o-l*3600)/60),c=Math.round(o-l*3600-u*60);return{textValue:[l,u,c]}}else if(a.format==="mm:ss"){let l=Math.floor(o/60),u=Math.round(o-l*60);return{textValue:[l,u]}}else return a.format==="number"?o=Math.round(o):o=Math.round(o*1e3)/1e3,o}t.getFormattedTimerTime=s})(wl||(wl={}));var S2;(t=>t.list=["idle","move","jump","run"])(S2||(S2={}));var A2;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"],["run",""],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new qt,move:new qt,jump:new qt,run:new qt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:hr.fromHexAndA(3728051,1)}}))(A2||(A2={}));function k8(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let i=e.colorA,r=e.colorB,n=[[i.r,i.g,i.b,i.a],[r.r,r.g,r.b,r.a]],s=[0,1];for(let a=2;a<10;a++)n.push(n[1]),s.push(1);let o={...qc(An(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let i={...An(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,i)}})}function $d(t,e){Object.values(t.shared.materials).forEach(i=>e(i))}function ep(t,e){t.scene.objects.traverse((i,r)=>{"materials"in r?r.materials.forEach((n,s)=>{n===void 0&&(r.materials[s]=fo.defaultData(),n=r.materials[s]),typeof n!="string"&&e(n)}):"material"in r?typeof r.material!="string"&&(r.material===void 0&&(r.material=fo.defaultData()),e(r.material)):r.type==="Mesh"&&(r.material===void 0&&(r.material=fo.defaultData()),e(r.material)),"overrides"in r&&Object.values(r.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==Vn.prototype&&e(n.material)})})}function ZEe(t){Object.assign(t.scene.publish,{orbitControls:{...w2.defaultData,...An(t.scene.publish.orbitControls)}})}function $Ee(t){Object.assign(t.scene.publish.settings,{video:{...pp.defaultData.settings.video,...An(t.scene.publish.settings.video)}})}function eMe(t){function e(i){if(i.layers){for(let r of Object.values(i.layers))if(r){for(let[n,s]of Object.entries(r))if((x$.includes(n)||typeof s=="boolean")&&delete r[n],n==="texture")for(let[o,a]of Object.entries(s))(QEe.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((i,r)=>{r.states.forEach(n=>{let s=n;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function tMe(t){t.scene.publish.withBackground=!0}function iMe(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function rMe(t){t.scene.objects.traverse((e,i)=>{let r=i.cloner;r&&(r.radial.scale=r.radial.scale.map(n=>n+1),r.linear.scale=r.linear.scale.map(n=>n+1))})}function nMe(t){t.scene.objects.traverse((e,i)=>{let r=i.geometry;r&&(r.type==="DodecahedronGeometry"||r.type==="IcosahedronGeometry")&&(r.detail=Math.round(r.detail))})}function sMe(t){t.scene.objects.traverse((e,i)=>{let r=t.scene.objects.unproxy().parent(e);if(r){let n=An(t.scene.objects.data(r));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=An(i).booleanExclude!==!0)}})}function oMe(t){t.scene.objects.traverse((e,i)=>{if(i.type==="Mesh"){let r=i;i.geometry.type==="NonParametricGeometry"?r.material!==void 0&&delete r.material:r.materials!==void 0&&delete r.materials}})}function aMe(t){function e(r){Object.setPrototypeOf(r,Vn.prototype),r.texture&&Object.setPrototypeOf(r.texture,Vn.prototype)}function i(r){Object.setPrototypeOf(r,Vn.prototype);for(let n in r)e(r[n])}t.scene.objects.traverse((r,n)=>{n.states.forEach(s=>{let o=s;if(o.material){let a=An(o.material).layers;i(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],u=An(l).layers;i(u),l.layers=u}})})}function D8(t){t.layers===void 0&&Object.assign(t,fo.defaultTwoLayerData("lambert"))}function MD(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let i=[...e.colors];i.push(e.colors[9]);let r=[...e.steps];r.push(e.steps[9]);let n={...An(e),colors:i,steps:r};Object.assign(e,n)}})}function lMe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function I8(t){t.scene.objects.traverse((e,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&MD(r)}):"material"in i&&typeof i.material!="string"&&MD(i.material)}),Object.values(t.shared.materials).forEach(e=>MD(e))}function uMe(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function hMe(t){t.shared.audios=Oh({},ui.prototype)}function cMe(t){t.shared.videos=Oh({},ui.prototype)}function dMe(t){let e=t.shared.materials;Object.entries(e).forEach(([i,r])=>{if(!r.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[i]:n})}})}function pMe(t){Object.entries(An(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(An(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function fMe(t){t.scene.publish.settings.web.preload=!1}function L8(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function B8(t){t.layers&&t.layers.forEach(e=>{JEe(e)&&e.isMask===void 0&&(e.isMask=!1),(e.type==="texture"||e.type==="video")&&e.blending===void 0&&(e.blending=0),(e.type==="noise"||e.type==="displace"&&e.displacementType==="noise")&&(e.voronoiStyle===void 0&&(e.voronoiStyle=0),e.highCut===void 0&&(e.highCut=1),e.lowCut===void 0&&(e.lowCut=0),e.smoothness===void 0&&(e.smoothness=.3),e.seed===void 0&&(e.seed=0),e.quality===void 0&&(e.quality=1))})}function mMe(t){t.shared.fonts=Oh({},ui.prototype)}function gMe(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function yMe(t){let e=[];t.scene.objects.traverse((i,r)=>{let n=r;if(n.type==="TextFrame"){let s=fo.defaultTwoLayerData("phong"),o=typeof n.color=="string"?t.shared.colors[n.color]:n.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=n.alpha;let a=gMe(n.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:n.name,...js.defaultData,...Cv.defaultData,flatShading:!1,wireframe:!1,geometry:{...Mv.defaultData("TextGeometry"),width:n.width,height:n.height,font:a,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:An(n.states),events:An(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},u=An(t.scene.objects).parent(i);t.scene.objects.insertAfter(u??null,i,[{id:i+"new",data:l,children:[]}]),e.push(i)}}),e.forEach(i=>{t.scene.objects.delete(i)})}function vMe(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((i,r)=>{r.events.forEach(n=>{if(e[Number(n.type)])if(Object.assign(n,{type:e[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new qt,move:new qt,jump:new qt}});else{let s=new qt;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:kt.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((o,a,l)=>{let u={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},c={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(c,qc(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(c,{control1:{...o.control1},control2:{...o.control2}});let h={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...h,...c},p={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new qt({fi:0,id:kt.generateUUID(),data:u},{fi:1,id:kt.generateUUID(),data:d})};s.push({fi:l,id:a,data:p})}),delete n.targets)}})})}function bMe(t){t.scene.objects.traverse((e,i)=>{function r(n,s){var l;let o=new qt,a=[];if(i.events.forEach((u,c,h)=>{if(u.type==="Audio"&&u.trigger===s){let d;a.push(c),u.interaction==="play"?d={...qc(u,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in u?u.after:void 0,toggle:"after"in u?u.toggle:void 0,type:"Audio"}:(u.interaction==="pause"||u.interaction==="stop")&&(d={...qc(u,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:h,id:c,data:d})}}),a.forEach(u=>i.events.delete(u)),o.length){let u=(l=i.events.find(c=>c.type===n))==null?void 0:l.data;u?"actions"in u&&u.actions.insertBefore(null,o):i.events.insertBefore(null,[{id:kt.generateUUID(),data:{type:n,actions:o}}])}}r("Start","start"),r("MouseDown","mouseDown"),r("MouseUp","mouseUp"),r("KeyDown","keyDown"),r("KeyUp","keyUp")})}function O8(t){var i;let e=(i=t.layers.find(r=>r.type==="light"))==null?void 0:i.data;if((e==null?void 0:e.category)==="basic"){let r=ys.defaultData("light","phong"),n=e;Object.assign(n,r),n.visible=!1}}function U8(t){$d(t,O8),ep(t,O8)}function xMe(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function wMe(t){t.scene.objects.traverse((e,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function _Me(t){t.scene.objects.traverse((e,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=fo.defaultTwoLayerData("phong"))})}function SMe(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function AMe(t){t.scene.objects.traverse((e,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function EMe(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function MMe(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function CMe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.resetYPosition=Math.abs(r.resetYPosition-i.position[1]))})})}function PMe(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((i,r)=>{e&&r.physics===null?r.collision=!1:r.collision="visibility"})}function TMe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.navmesh=A2.defaultDataThirdPerson.navmesh)})})}function RMe(t){t.scene.styles||(t.scene.styles=Qf.defaultData())}function N8(t){t.layers.forEach(e=>{e.type==="light"&&e.category!=="toon"&&e.occlusion===void 0&&(e.occlusion=!0)})}function kMe(t){t.scene.environment.ambientLight.occlusion===void 0&&(t.scene.environment.ambientLight.occlusion=!1),t.scene.environment.ambientLight.aoFullRes===void 0&&(t.scene.environment.ambientLight.aoFullRes=!1),t.scene.environment.ambientLight.radius===void 0&&(t.scene.environment.ambientLight.radius=256),t.scene.environment.ambientLight.bias===void 0&&(t.scene.environment.ambientLight.bias=.5),t.scene.environment.ambientLight.aoColor===void 0&&(t.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),ep(t,N8),$d(t,N8)}function DMe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&Object.assign(r.gameActions,{run:new qt})})})}function IMe(t){t.scene.objects.traverse((e,i)=>{i.events.forEach(r=>{r.type==="GameControl"&&(r.keyAssignments=[...r.keyAssignments,["run",""],["none","Ctrl"]])})})}function F8(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.bumpMapIntensity===void 0&&(e.bumpMapIntensity=5)})}function LMe(t,e){if(e<1&&(ep(t,k8),$d(t,k8),t.schema=1),e<2&&(ZEe(t),t.schema=2),e<3&&(eMe(t),t.schema=3),e<4&&(tMe(t),t.schema=4),e<5&&(iMe(t),t.schema=5),e<6&&(rMe(t),t.schema=6),e<7&&(nMe(t),t.schema=7),e<8&&(t.schema=8),e<9&&(I8(t),t.schema=9),e<10&&(lMe(t),t.schema=10),e<11&&(uMe(t),t.schema=11),e<12&&(I8(t),t.schema=12),e<13&&(hMe(t),t.schema=13),e<14&&(dMe(t),t.schema=14),e<15&&(pMe(t),t.schema=15),e<16&&(fMe(t),t.schema=16),e<17&&(ep(t,L8),$d(t,L8),t.schema=17),e<18&&(ep(t,D8),$d(t,D8),t.schema=18),e<19&&($Ee(t),t.schema=19),e<20&&(mMe(t),yMe(t),t.schema=20),e<21&&(vMe(t),bMe(t),t.schema=21),e<22&&(U8(t),t.schema=22),e<23&&(xMe(t),t.schema=23),e<24&&(wMe(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(cMe(t),e<25&&(t.schema=25)),e<26&&(sMe(t),t.schema=26),e<27&&(oMe(t),t.schema=27),e<28&&(U8(t),t.schema=28),e<29&&(aMe(t),t.schema=29),e<30&&(_Me(t),t.schema=30),e<31&&(SMe(t),t.schema=31),e<33&&(AMe(t),t.schema=33),e<34&&(EMe(t),t.schema=34),e<35&&(MMe(t),t.schema=35),e<36&&(CMe(t),t.schema=36),e<37&&(PMe(t),t.schema=37),e<38&&(ep(t,B8),$d(t,B8),t.schema=38),e<39&&(TMe(t),t.schema=39),e<40&&(RMe(t),t.schema=40),e<41&&(kMe(t),t.schema=41),e<42&&(DMe(t),t.schema=42),e<43&&(IMe(t),t.schema=43),e<99){ep(t,F8),$d(t,F8),t.scene.publish.playCamera===null&&(t.scene.publish.playCamera=X0);let i=An(t.scene.objects),r=t.scene.objects;t.scene.publish.playPage=hw,r.insertBefore(null,null,[{id:hw,data:{...h0.defaultData,backgroundColor:t.scene.backgroundColor,fog:t.scene.fog,postprocessing:t.scene.postprocessing,ao:qc(t.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:t.scene.publish.playCamera,gameControlObject:t.scene.publish.gameControlObject},shadow:qc(t.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...l0.defaultData,...qc(t.scene.environment,"usePhysics","gravity")},camera:An(t.scene.ownerCamera)??h0.defaultData.camera,name:"Scene"},children:[]}]);for(let o of i)o.id!==Zf.TRASH_CAN_ID&&r.move(hw,o.fi,o.id);let n=0,s=0;t.shared.penumbraSize&&t.scene.objects.traverse((o,a)=>{a.type==="DirectionalLight"?(a.penumbraSize=t.shared.penumbraSize[Math.min(n,2)],n+=1):a.type==="SpotLight"&&(a.penumbraSize=t.shared.penumbraSize[3+Math.min(s,1)],s+=1),(a.physics===void 0||a.physics===null)&&a.type!=="Instance"&&(a.physics={},Object.assign(a.physics,a0.defaultData)),a.physics!==void 0&&a.physics!==null&&(a.physics.enabled=a.collision??"visibility",delete a.collision)}),t.schema=99}}function z8(t){t.layers&&t.layers.forEach(e=>{e.type==="light"&&e.alphaOverride===void 0&&(e.alphaOverride=1)})}function BMe(t){t.scene.objects.traverse((e,i)=>{let r=i.geometry;r&&r.type==="PathGeometry"&&(r.extrusion.capType="flat",r.extrusion.bevel=50,r.extrusion.bevelSides=6,r.extrusion.shape.type==="Custom"&&(r.extrusion.shape.shapeQuality="low"))})}function OMe(t){var e;Array.isArray(An(t.events))&&((e=t.events)==null||e.forEach(i=>{"disabled"in i||(i.disabled=!1),(i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress")&&(i.mode=i.mode||"Object")}))}var Fy=180/Math.PI;function H8(t){t.rotation=t.rotation.slice(0,3).map(e=>e*Fy)}function A$(t){var i,r;H8(t),t.type==="Page"&&H8(t.camera),(i=t.states)==null||i.forEach(n=>{n.rotation===void 0||n.rotation===null||(n.rotation=n.rotation.slice(0,3).map(s=>s*Fy))});let e=t.geometry;e&&e.type==="SphereGeometry"&&(e.thetaLength=(e.thetaLength??180)*Fy),e&&e.type==="TorusGeometry"&&(e.arc=e.arc*Fy),e&&e.type==="PathGeometry"&&(e.extrusion.angle*=Fy,e.extrusion.twist*=Fy),t.type==="Mesh"&&t.geometry.type==="TextGeometry"&&(t.geometry.text={textValue:t.geometry.text}),Array.isArray(An(t.events))&&((r=t.events)==null||r.forEach(n=>{(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"||n.type==="Collision"||n.type==="Trigger")&&(n.runMode=n.toggle?"Toggle":"Repeat")}))}function UMe(t){t.shared.variables=Oh({},ui.prototype)}function NMe(t){let e=An(t.shared.variables);t.shared.variables=Oh(Object.entries(e??{}).map(([i,r],n)=>({fi:n,id:i,data:r})),qt.prototype)}var Cc=111;function E$(t,e){e(t.data);for(let i of t.children)E$(i,e)}function FMe(t){let e=t.schema??104;e!==Cc&&e<105&&(E$(t.asset,A$),t.schema=105)}function zMe(t){t.shared.particles=Oh({},ui.prototype),t.shared.lib&&(t.shared.lib.particles=Um.defaultData().particles)}function HMe(t){t.scene.objects.traverse((e,i)=>{i.type==="Particle"&&typeof i.renderMaterial.size=="number"&&Object.assign(i.renderMaterial,{size:[i.renderMaterial.size,i.renderMaterial.size]})})}function M$(t){let e=t.schema??0;if(e!==Cc){console.warn("updating from ",e,"to ",Cc),LMe(t,e),e<100&&(t.scene.publish.joystickSizeAndXYOffset===void 0&&(t.scene.publish.joystickSizeAndXYOffset=pp.defaultData.joystickSizeAndXYOffset),t.schema=100),e<101&&(ep(t,z8),$d(t,z8),t.schema=101),e<102&&(BMe(t),t.schema=102),e<104&&(t.shared.catelogs=new ui,t.shared.lib=Um.defaultData(),t.schema=104),e<105&&(UMe(t),t.scene.objects.traverse((i,r)=>{A$(r)}),t.schema=105);for(let i of Object.values(t.shared.lib.components))FMe(i);e<106&&(NMe(t),t.schema=106),e<107&&(t.shared.lib.variables=Um.defaultData().variables,t.schema=107),e<109&&(zMe(t),t.schema=109),e<110&&(HMe(t),t.schema=110),e<111&&(t.scene.objects.traverse((i,r)=>{OMe(r)}),t.schema=111)}}var E2;(t=>{t.defaultData={schema:Cc,scene:Zf.defaultData,frames:new ui().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",cw.defaultData),shared:{...wl.emptyData(),colors:wl.defaultColors()}},t.emptyDataForImports=function(n){let s=Zf.emptyDataWithPage(n);return{schema:Cc,scene:s,frames:new ui().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",cw.defaultData),shared:{...wl.emptyData(),colors:wl.defaultColors(),images:wl.defaultImages(n)}}},t.emptyData=function(){return{schema:Cc,scene:Zf.emptyDataWithPage(),frames:new ui().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",cw.defaultData),shared:wl.emptyData()}},t.clipboard2dData=function(){return{schema:Cc,scene:Zf.emptyData(),frames:new ui,shared:wl.emptyData()}},t.collabHelper={...cB,updateSchema(n){return(n.schema??0)<Cc?t1(n,M$):(n.schema??0)-Cc}};function e(n){let s=t.collabHelper.updateSchema(n);return typeof s=="number"?s===0?n:null:s.data}t.updateSchemaDirectly=e;function i(n){return{...n,shared:{...n.shared,lib:Um.defaultData()}}}t.withoutLib=i;function r(n,s){let o=n.scene.objects.get(s);if(o&&o.data.type==="Component")return o;{let a=n.shared.lib.components[s];if(a)return a.asset}}t.getComponentData=r})(E2||(E2={}));var G8;(t=>{function e(i){return!0}t.is=e})(G8||(G8={}));var M2;(t=>{t.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function e(r,n){return{position:(n==null?void 0:n.position)??r.position,rotation:(n==null?void 0:n.rotation)??r.rotation,scale:(n==null?void 0:n.scale)??r.scale,shear:(n==null?void 0:n.shear)??r.shear}}t.merge=e;function i(r,n){return zZ({position:Fc.isEqual(r.position,n.position)?void 0:n.position,rotation:r.rotation===n.rotation?void 0:n.rotation,scale:Fc.isEqual(r.scale,n.scale)?void 0:n.scale,shear:r.shear&&n.shear&&Fc.isEqual(r.shear,n.shear)?void 0:n.shear})}t.diff=i})(M2||(M2={}));var jB;(t=>t.defaultData={horizontalConstraint:0,verticalConstraint:0})(jB||(jB={}));var C2;(t=>t.defaultData={opacity:1,fill:{color:hr.fromHexAndA(Ka,1),enabled:!0},stroke:{color:hr.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:hr.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:hr.from0to1([0,0,0,1]),enabled:!1,spread:0}})(C2||(C2={}));var $f;(t=>{function e(o,a){return{name:a}}t.newEmpty=e;function i(o,a){if(a===void 0)return o;let l={...o},u=["width","height","cornerRadius"];for(let c of u)c in l&&c in a&&a[c]!==void 0&&Object.assign(l,{[c]:a[c]});return l}function r(o,a){if(a===void 0)return o;let l={...o};return"fill"in l&&"fill"in a&&a.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...a.fill}}),"stroke"in l&&"stroke"in a&&a.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...a.stroke}}),"layerBlur"in l&&"layerBlur"in a&&a.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...a.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in a&&a.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...a.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in a&&a.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...a.dropShadow}}),"innerShadow"in l&&"innerShadow"in a&&a.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...a.innerShadow}}),l}function n(o,a){if(a===void 0)return o;let l={...o};return Object.assign(l,M2.merge(l,a)),l=i(l,a),l=r(l,a),l}t.patch=n;function s(o,a){let l,u=[];for(let[c,h]of Object.entries(a))c!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},u.push(l)),l.props[c]=h);return u}t.toOps=s})($f||($f={}));var n1;(t=>t.defaultData={...M2.defaultData,...jB.defaultData,states:new qt,events:new qt,visible:!0,raycastLock:!1})(n1||(n1={}));var c0;(t=>t.defaultData={...n1.defaultData,...C2.defaultData})(c0||(c0={}));var P2;(t=>t.defaultData={cornerRadius:[0,0,0,0]})(P2||(P2={}));var WB;(t=>t.defaultData={...c0.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(WB||(WB={}));var s1;(t=>t.defaultData={...c0.defaultData,...P2.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(s1||(s1={}));var qB;(t=>t.defaultData={...c0.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(qB||(qB={}));var XB;(t=>t.defaultData={...c0.defaultData,type:"path2d",path:"",name:"Path"})(XB||(XB={}));var V8;(t=>{function e(i){return i.type==="ellipse2d"||i.type==="rectangle2d"||i.type==="text2d"||i.type==="vector2d"||i.type==="path2d"}t.is=e})(V8||(V8={}));var T2;(t=>t.defaultData={...n1.defaultData,name:"Group",type:"group2d"})(T2||(T2={}));var YB;(t=>t.defaultData={...n1.defaultData,...P2.defaultData,...C2.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:hr.fromHexAndA(4737101,1),enabled:!0},stroke:{color:hr.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}})(YB||(YB={}));var gm;(t=>{function e(s){switch(s){case"rectangle2d":return{...s1.defaultData};case"ellipse2d":return{...WB.defaultData};case"text2d":return{...qB.defaultData};case"vector2d":return{...s1.defaultData};case"path2d":return{...XB.defaultData};case"frame2d":return{...YB.defaultData};case"group2d":return{...T2.defaultData}}}t.defaultData=e;function i(s){return"width"in s&&"height"in s?[typeof s.width=="number"?s.width*.5:0,typeof s.height=="number"?s.height*.5:0]:[0,0]}t.getPivot=i;function r(s){return s.type==="rectangle2d"||s.type==="ellipse2d"||s.type==="text2d"||s.type==="frame2d"}t.isResizeable=r;function n(s){return s.type==="rectangle2d"||s.type==="frame2d"}t.hasCorners=n})(gm||(gm={}));var KB;(t=>(t.defaultData={name:"UI",type:"scene2d",objects:new Gs},t.emptyData=function(){return{type:"scene2d",objects:new Gs}}))(KB||(KB={}));function em(t,e=!1){let i=t[0].index!==null,r=new Set(Object.keys(t[0].attributes)),n=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Ht,u=0;for(let c=0;c<t.length;++c){let h=t[c],d=0;if(i!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!r.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;o[p]===void 0&&(o[p]=[]),o[p].push(h.morphAttributes[p])}if(e){let p;if(i)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,p,c),u+=p}}if(i){let c=0,h=[];for(let d=0;d<t.length;++d){let p=t[d].index;for(let f=0;f<p.count;++f)h.push(p.getX(f)+c);c+=t[d].attributes.position.count}l.setIndex(h)}for(let c in s){let h=j8(s[c]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,h)}for(let c in o){let h=o[c][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<h;++d){let p=[];for(let m=0;m<o[c].length;++m)p.push(o[c][m][d]);let f=j8(p);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(f)}}return l}function j8(t){let e,i,r,n=0;for(let a=0;a<t.length;++a){let l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=l.normalized),r!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new e(n),o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new ei(s,i,r)}var GMe=Math.pow(2,-24),wA=class{constructor(){}};function vh(t,e,i){return i.min.x=e[t],i.min.y=e[t+1],i.min.z=e[t+2],i.max.x=e[t+3],i.max.y=e[t+4],i.max.z=e[t+5],i}function W8(t){let e=-1,i=-1/0;for(let r=0;r<3;r++){let n=t[r+3]-t[r];n>i&&(i=n,e=r)}return e}function q8(t,e){e.set(t)}function X8(t,e,i){let r,n;for(let s=0;s<3;s++){let o=s+3;r=t[s],n=e[s],i[s]=r<n?r:n,r=t[o],n=e[o],i[o]=r>n?r:n}}function _A(t,e,i){for(let r=0;r<3;r++){let n=e[t+2*r],s=e[t+2*r+1],o=n-s,a=n+s;o<i[r]&&(i[r]=o),a>i[r+3]&&(i[r+3]=a)}}function Jb(t){let e=t[3]-t[0],i=t[4]-t[1],r=t[5]-t[2];return 2*(e*i+i*r+r*e)}function VMe(t,e){if(!t.index){let i=t.attributes.position.count,r=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;i>65535?n=new Uint32Array(new r(4*i)):n=new Uint16Array(new r(2*i)),t.setIndex(new ei(n,1));for(let s=0;s<i;s++)n[s]=s}}function jMe(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];let e=[],i=new Set;for(let n of t.groups)i.add(n.start),i.add(n.start+n.count);let r=Array.from(i.values()).sort((n,s)=>n-s);for(let n=0;n<r.length-1;n++){let s=r[n],o=r[n+1];e.push({offset:s/3,count:(o-s)/3})}return e}function CD(t,e,i,r,n=null){let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,c=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0,y=n!==null;for(let v=e*6,b=(e+i)*6;v<b;v+=6){let _=t[v+0],A=t[v+1],S=_-A,E=_+A;S<s&&(s=S),E>l&&(l=E),y&&_<h&&(h=_),y&&_>f&&(f=_);let M=t[v+2],R=t[v+3],C=M-R,T=M+R;C<o&&(o=C),T>u&&(u=T),y&&M<d&&(d=M),y&&M>m&&(m=M);let L=t[v+4],I=t[v+5],D=L-I,F=L+I;D<a&&(a=D),F>c&&(c=F),y&&L<p&&(p=L),y&&L>g&&(g=L)}r[0]=s,r[1]=o,r[2]=a,r[3]=l,r[4]=u,r[5]=c,y&&(n[0]=h,n[1]=d,n[2]=p,n[3]=f,n[4]=m,n[5]=g)}function WMe(t,e,i,r){let n=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,u=-1/0;for(let c=e*6,h=(e+i)*6;c<h;c+=6){let d=t[c+0];d<n&&(n=d),d>a&&(a=d);let p=t[c+2];p<s&&(s=p),p>l&&(l=p);let f=t[c+4];f<o&&(o=f),f>u&&(u=f)}r[0]=n,r[1]=s,r[2]=o,r[3]=a,r[4]=l,r[5]=u}function qMe(t,e,i,r,n){let s=i,o=i+r-1,a=n.pos,l=n.axis*2;for(;;){for(;s<=o&&e[s*6+l]<a;)s++;for(;s<=o&&e[o*6+l]>=a;)o--;if(s<o){for(let u=0;u<3;u++){let c=t[s*3+u];t[s*3+u]=t[o*3+u],t[o*3+u]=c;let h=e[s*6+u*2+0];e[s*6+u*2+0]=e[o*6+u*2+0],e[o*6+u*2+0]=h;let d=e[s*6+u*2+1];e[s*6+u*2+1]=e[o*6+u*2+1],e[o*6+u*2+1]=d}s++,o--}else return s}}var xc=32,XMe=(t,e)=>t.candidate-e.candidate,Ed=new Array(xc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),SA=new Float32Array(6);function YMe(t,e,i,r,n,s){let o=-1,a=0;if(s===0)o=W8(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===1)o=W8(t),o!==-1&&(a=KMe(i,r,n,o));else if(s===2){let l=Jb(t),u=1.25*n,c=r*6,h=(r+n)*6;for(let d=0;d<3;d++){let p=e[d],f=(e[d+3]-p)/xc;if(n<xc/4){let m=[...Ed];m.length=n;let g=0;for(let v=c;v<h;v+=6,g++){let b=m[g];b.candidate=i[v+2*d],b.count=0;let{bounds:_,leftCacheBounds:A,rightCacheBounds:S}=b;for(let E=0;E<3;E++)S[E]=1/0,S[E+3]=-1/0,A[E]=1/0,A[E+3]=-1/0,_[E]=1/0,_[E+3]=-1/0;_A(v,i,_)}m.sort(XMe);let y=n;for(let v=0;v<y;v++){let b=m[v];for(;v+1<y&&m[v+1].candidate===b.candidate;)m.splice(v+1,1),y--}for(let v=c;v<h;v+=6){let b=i[v+2*d];for(let _=0;_<y;_++){let A=m[_];b>=A.candidate?_A(v,i,A.rightCacheBounds):(_A(v,i,A.leftCacheBounds),A.count++)}}for(let v=0;v<y;v++){let b=m[v],_=b.count,A=n-b.count,S=b.leftCacheBounds,E=b.rightCacheBounds,M=0;_!==0&&(M=Jb(S)/l);let R=0;A!==0&&(R=Jb(E)/l);let C=1+1.25*(M*_+R*A);C<u&&(o=d,u=C,a=b.candidate)}}else{for(let y=0;y<xc;y++){let v=Ed[y];v.count=0,v.candidate=p+f+y*f;let b=v.bounds;for(let _=0;_<3;_++)b[_]=1/0,b[_+3]=-1/0}for(let y=c;y<h;y+=6){let v=~~((i[y+2*d]-p)/f);v>=xc&&(v=xc-1);let b=Ed[v];b.count++,_A(y,i,b.bounds)}let m=Ed[xc-1];q8(m.bounds,m.rightCacheBounds);for(let y=xc-2;y>=0;y--){let v=Ed[y],b=Ed[y+1];X8(v.bounds,b.rightCacheBounds,v.rightCacheBounds)}let g=0;for(let y=0;y<xc-1;y++){let v=Ed[y],b=v.count,_=v.bounds,A=Ed[y+1].rightCacheBounds;b!==0&&(g===0?q8(_,SA):X8(_,SA,SA)),g+=b;let S=0,E=0;g!==0&&(S=Jb(SA)/l);let M=n-g;M!==0&&(E=Jb(A)/l);let R=1+1.25*(S*g+E*M);R<u&&(o=d,u=R,a=v.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function KMe(t,e,i,r){let n=0;for(let s=e,o=e+i;s<o;s++)n+=t[s*6+r*2];return n/i}function JMe(t,e){let i=t.attributes.position,r=t.index.array,n=r.length/3,s=new Float32Array(n*6),o=i.normalized,a=i.array,l=i.offset||0,u=3;i.isInterleavedBufferAttribute&&(u=i.data.stride);let c=["getX","getY","getZ"];for(let h=0;h<n;h++){let d=h*3,p=h*6,f,m,g;o?(f=r[d+0],m=r[d+1],g=r[d+2]):(f=r[d+0]*u+l,m=r[d+1]*u+l,g=r[d+2]*u+l);for(let y=0;y<3;y++){let v,b,_;o?(v=i[c[y]](f),b=i[c[y]](m),_=i[c[y]](g)):(v=a[f+y],b=a[m+y],_=a[g+y]);let A=v;b<A&&(A=b),_<A&&(A=_);let S=v;b>S&&(S=b),_>S&&(S=_);let E=(S-A)/2,M=y*2;s[p+M+0]=A+E,s[p+M+1]=E+(Math.abs(A)+E)*GMe,A<e[y]&&(e[y]=A),S>e[y+3]&&(e[y+3]=S)}}return s}function QMe(t,e){function i(y){d&&d(y/p)}function r(y,v,b,_=null,A=0){if(!f&&A>=l&&(f=!0,u&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),b<=c||A>=l)return i(v+b),y.offset=v,y.count=b,y;let S=YMe(y.boundingData,_,o,v,b,h);if(S.axis===-1)return i(v+b),y.offset=v,y.count=b,y;let E=qMe(a,o,v,b,S);if(E===v||E===v+b)i(v+b),y.offset=v,y.count=b;else{y.splitAxis=S.axis;let M=new wA,R=v,C=E-v;y.left=M,M.boundingData=new Float32Array(6),CD(o,R,C,M.boundingData,s),r(M,R,C,s,A+1);let T=new wA,L=E,I=b-C;y.right=T,T.boundingData=new Float32Array(6),CD(o,L,I,T.boundingData,s),r(T,L,I,s,A+1)}return y}VMe(t,e);let n=new Float32Array(6),s=new Float32Array(6),o=JMe(t,n),a=t.index.array,l=e.maxDepth,u=e.verbose,c=e.maxLeafTris,h=e.strategy,d=e.onProgress,p=t.index.count/3,f=!1,m=[],g=jMe(t);if(g.length===1){let y=g[0],v=new wA;v.boundingData=n,WMe(o,y.offset,y.count,s),r(v,y.offset,y.count,s),m.push(v)}else for(let y of g){let v=new wA;v.boundingData=new Float32Array(6),CD(o,y.offset,y.count,v.boundingData,s),r(v,y.offset,y.count,s),m.push(v)}return m}function ZMe(t,e){let i=QMe(t,e),r,n,s,o=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let c=0;c<i.length;c++){let h=i[c],d=l(h),p=new a(32*d);r=new Float32Array(p),n=new Uint32Array(p),s=new Uint16Array(p),u(0,h),o.push(p)}return o;function l(c){return c.count?1:1+l(c.left)+l(c.right)}function u(c,h){let d=c/4,p=c/2,f=!!h.count,m=h.boundingData;for(let g=0;g<6;g++)r[d+g]=m[g];if(f){let g=h.offset,y=h.count;return n[d+6]=g,s[p+14]=y,s[p+15]=65535,c+32}else{let g=h.left,y=h.right,v=h.splitAxis,b;if(b=u(c+32,g),b/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[d+6]=b/4,b=u(b,y),n[d+7]=v,b}}}var td=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,r=-1/0;for(let n=0,s=t.length;n<s;n++){let o=t[n][e];i=o<i?o:i,r=o>r?o:r}this.min=i,this.max=r}setFromPoints(t,e){let i=1/0,r=-1/0;for(let n=0,s=e.length;n<s;n++){let o=e[n],a=t.dot(o);i=a<i?a:i,r=a>r?a:r}this.min=i,this.max=r}isSeparated(t){return this.min>t.max||t.min>this.max}};td.prototype.setFromBox=function(){let t=new N;return function(e,i){let r=i.min,n=i.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){t.x=r.x*a+n.x*(1-a),t.y=r.y*l+n.y*(1-l),t.z=r.z*u+n.z*(1-u);let c=e.dot(t);s=Math.min(c,s),o=Math.max(c,o)}this.min=s,this.max=o}}();var $Me=function(){let t=new N,e=new N,i=new N;return function(r,n,s){let o=r.start,a=t,l=n.start,u=e;i.subVectors(o,l),t.subVectors(r.end,r.start),e.subVectors(n.end,n.start);let c=i.dot(u),h=u.dot(a),d=u.dot(u),p=i.dot(a),f=a.dot(a)*d-h*h,m,g;f!==0?m=(c*h-p*d)/f:m=0,g=(c+m*h)/d,s.x=m,s.y=g}}(),cz=function(){let t=new me,e=new N,i=new N;return function(r,n,s,o){$Me(r,n,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1){r.at(a,s),n.at(l,o);return}else if(a>=0&&a<=1){l<0?n.at(0,o):n.at(1,o),r.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?r.at(0,s):r.at(1,s),n.closestPointToPoint(s,!0,o);return}else{let u;a<0?u=r.start:u=r.end;let c;l<0?c=n.start:c=n.end;let h=e,d=i;if(r.closestPointToPoint(c,!0,e),n.closestPointToPoint(u,!0,i),h.distanceToSquared(c)<=d.distanceToSquared(u)){s.copy(h),o.copy(c);return}else{s.copy(u),o.copy(d);return}}}}(),eCe=function(){let t=new N,e=new N,i=new Ba,r=new Ol;return function(n,s){let{radius:o,center:a}=n,{a:l,b:u,c}=s;if(r.start=l,r.end=u,r.closestPointToPoint(a,!0,t).distanceTo(a)<=o||(r.start=l,r.end=c,r.closestPointToPoint(a,!0,t).distanceTo(a)<=o)||(r.start=u,r.end=c,r.closestPointToPoint(a,!0,t).distanceTo(a)<=o))return!0;let h=s.getPlane(i);if(Math.abs(h.distanceToPoint(a))<=o){let d=h.projectPoint(a,e);if(s.containsPoint(d))return!0}return!1}}(),tCe=1e-15;function Hg(t){return Math.abs(t)<tCe}var id=class extends Fs{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new N),this.satBounds=new Array(4).fill().map(()=>new td),this.points=[this.a,this.b,this.c],this.sphere=new xa,this.plane=new Ba,this.needsUpdate=!0}intersectsSphere(t){return eCe(t,this)}update(){let t=this.a,e=this.b,i=this.c,r=this.points,n=this.satAxes,s=this.satBounds,o=n[0],a=s[0];this.getNormal(o),a.setFromPoints(o,r);let l=n[1],u=s[1];l.subVectors(t,e),u.setFromPoints(l,r);let c=n[2],h=s[2];c.subVectors(e,i),h.setFromPoints(c,r);let d=n[3],p=s[3];d.subVectors(i,t),p.setFromPoints(d,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,t),this.needsUpdate=!1}};id.prototype.closestPointToSegment=function(){let t=new N,e=new N,i=new Ol;return function(r,n=null,s=null){let{start:o,end:a}=r,l=this.points,u,c=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;i.start.copy(l[h]),i.end.copy(l[d]),cz(i,r,t,e),u=t.distanceToSquared(e),u<c&&(c=u,n&&n.copy(t),s&&s.copy(e))}return this.closestPointToPoint(o,t),u=o.distanceToSquared(t),u<c&&(c=u,n&&n.copy(t),s&&s.copy(o)),this.closestPointToPoint(a,t),u=a.distanceToSquared(t),u<c&&(c=u,n&&n.copy(t),s&&s.copy(a)),Math.sqrt(c)}}();id.prototype.intersectsTriangle=function(){let t=new id,e=new Array(3),i=new Array(3),r=new td,n=new td,s=new N,o=new N,a=new N,l=new N,u=new Ol,c=new Ol,h=new Ol;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);let m=this.plane,g=d.plane;if(Math.abs(m.normal.dot(g.normal))>1-1e-10){let y=this.satBounds,v=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let A=0;A<4;A++){let S=y[A],E=v[A];if(r.setFromPoints(E,i),S.isSeparated(r))return!1}let b=d.satBounds,_=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let A=0;A<4;A++){let S=b[A],E=_[A];if(r.setFromPoints(E,e),S.isSeparated(r))return!1}for(let A=0;A<4;A++){let S=v[A];for(let E=0;E<4;E++){let M=_[E];if(s.crossVectors(S,M),r.setFromPoints(s,e),n.setFromPoints(s,i),r.isSeparated(n))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let y=this.points,v=!1,b=0;for(let I=0;I<3;I++){let D=y[I],F=y[(I+1)%3];u.start.copy(D),u.end.copy(F),u.delta(o);let H=v?c.start:c.end,z=Hg(g.distanceToPoint(D));if(Hg(g.normal.dot(o))&&z){c.copy(u),b=2;break}if((g.intersectLine(u,H)||z)&&!Hg(H.distanceTo(F))){if(b++,v)break;v=!0}}if(b===1&&d.containsPoint(c.end))return p&&(p.start.copy(c.end),p.end.copy(c.end)),!0;if(b!==2)return!1;let _=d.points,A=!1,S=0;for(let I=0;I<3;I++){let D=_[I],F=_[(I+1)%3];u.start.copy(D),u.end.copy(F),u.delta(a);let H=A?h.start:h.end,z=Hg(m.distanceToPoint(D));if(Hg(m.normal.dot(a))&&z){h.copy(u),S=2;break}if((m.intersectLine(u,H)||z)&&!Hg(H.distanceTo(F))){if(S++,A)break;A=!0}}if(S===1&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(S!==2)return!1;if(c.delta(o),h.delta(a),o.dot(a)<0){let I=h.start;h.start=h.end,h.end=I}let E=c.start.dot(o),M=c.end.dot(o),R=h.start.dot(o),C=h.end.dot(o),T=M<R,L=E<C;return E!==C&&R!==M&&T===L?!1:(p&&(l.subVectors(c.start,h.start),l.dot(o)>0?p.start.copy(c.start):p.start.copy(h.start),l.subVectors(c.end,h.end),l.dot(o)<0?p.end.copy(c.end):p.end.copy(h.end)),!0)}}}();id.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();id.prototype.distanceToTriangle=function(){let t=new N,e=new N,i=["a","b","c"],r=new Ol,n=new Ol;return function(s,o=null,a=null){let l=o||a?r:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let u=1/0;for(let c=0;c<3;c++){let h,d=i[c],p=s[d];this.closestPointToPoint(p,t),h=p.distanceToSquared(t),h<u&&(u=h,o&&o.copy(t),a&&a.copy(p));let f=this[d];s.closestPointToPoint(f,t),h=f.distanceToSquared(t),h<u&&(u=h,o&&o.copy(f),a&&a.copy(t))}for(let c=0;c<3;c++){let h=i[c],d=i[(c+1)%3];r.set(this[h],this[d]);for(let p=0;p<3;p++){let f=i[p],m=i[(p+1)%3];n.set(s[f],s[m]),cz(r,n,t,e);let g=t.distanceToSquared(e);g<u&&(u=g,o&&o.copy(t),a&&a.copy(e))}}return Math.sqrt(u)}}();var Uh=class{constructor(t,e,i){this.isOrientedBox=!0,this.min=new N,this.max=new N,this.matrix=new lt,this.invMatrix=new lt,this.points=new Array(8).fill().map(()=>new N),this.satAxes=new Array(3).fill().map(()=>new N),this.satBounds=new Array(3).fill().map(()=>new td),this.alignedSatBounds=new Array(3).fill().map(()=>new td),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}};Uh.prototype.update=function(){return function(){let t=this.matrix,e=this.min,i=this.max,r=this.points;for(let l=0;l<=1;l++)for(let u=0;u<=1;u++)for(let c=0;c<=1;c++){let h=1*l|2*u|4*c,d=r[h];d.x=l?i.x:e.x,d.y=u?i.y:e.y,d.z=c?i.z:e.z,d.applyMatrix4(t)}let n=this.satBounds,s=this.satAxes,o=r[0];for(let l=0;l<3;l++){let u=s[l],c=n[l],h=1<<l,d=r[h];u.subVectors(o,d),c.setFromPoints(u,r)}let a=this.alignedSatBounds;a[0].setFromPointsField(r,"x"),a[1].setFromPointsField(r,"y"),a[2].setFromPointsField(r,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Uh.prototype.intersectsBox=function(){let t=new td;return function(e){this.needsUpdate&&this.update();let i=e.min,r=e.max,n=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(t.min=i.x,t.max=r.x,o[0].isSeparated(t)||(t.min=i.y,t.max=r.y,o[1].isSeparated(t))||(t.min=i.z,t.max=r.z,o[2].isSeparated(t)))return!1;for(let a=0;a<3;a++){let l=s[a],u=n[a];if(t.setFromBox(l,e),u.isSeparated(t))return!1}return!0}}();Uh.prototype.intersectsTriangle=function(){let t=new id,e=new Array(3),i=new td,r=new td,n=new N;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(t.copy(s),t.update(),s=t);let o=this.satBounds,a=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let h=0;h<3;h++){let d=o[h],p=a[h];if(i.setFromPoints(p,e),d.isSeparated(i))return!1}let l=s.satBounds,u=s.satAxes,c=this.points;for(let h=0;h<3;h++){let d=l[h],p=u[h];if(i.setFromPoints(p,c),d.isSeparated(i))return!1}for(let h=0;h<3;h++){let d=a[h];for(let p=0;p<4;p++){let f=u[p];if(n.crossVectors(d,f),i.setFromPoints(n,e),r.setFromPoints(n,c),i.isSeparated(r))return!1}}return!0}}();Uh.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Uh.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();Uh.prototype.distanceToBox=function(){let t=["x","y","z"],e=new Array(12).fill().map(()=>new Ol),i=new Array(12).fill().map(()=>new Ol),r=new N,n=new N;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(n),this.closestPointToPoint(n,r),s.closestPointToPoint(r,n),a&&a.copy(r),l&&l.copy(n)),0;let u=o*o,c=s.min,h=s.max,d=this.points,p=1/0;for(let m=0;m<8;m++){let g=d[m];n.copy(g).clamp(c,h);let y=g.distanceToSquared(n);if(y<p&&(p=y,a&&a.copy(g),l&&l.copy(n),y<u))return Math.sqrt(y)}let f=0;for(let m=0;m<3;m++)for(let g=0;g<=1;g++)for(let y=0;y<=1;y++){let v=(m+1)%3,b=(m+2)%3,_=g<<v|y<<b,A=1<<m|g<<v|y<<b,S=d[_],E=d[A];e[f].set(S,E);let M=t[m],R=t[v],C=t[b],T=i[f],L=T.start,I=T.end;L[M]=c[M],L[R]=g?c[R]:h[R],L[C]=y?c[C]:h[R],I[M]=h[M],I[R]=g?c[R]:h[R],I[C]=y?c[C]:h[R],f++}for(let m=0;m<=1;m++)for(let g=0;g<=1;g++)for(let y=0;y<=1;y++){n.x=m?h.x:c.x,n.y=g?h.y:c.y,n.z=y?h.z:c.z,this.closestPointToPoint(n,r);let v=n.distanceToSquared(r);if(v<p&&(p=v,a&&a.copy(r),l&&l.copy(n),v<u))return Math.sqrt(v)}for(let m=0;m<12;m++){let g=e[m];for(let y=0;y<12;y++){let v=i[y];cz(g,v,r,n);let b=r.distanceToSquared(n);if(b<p&&(p=b,a&&a.copy(r),l&&l.copy(n),b<u))return Math.sqrt(b)}}return Math.sqrt(p)}}();var Gg=new N,Vg=new N,jg=new N,AA=new me,EA=new me,MA=new me,Y8=new N,K8=new N,J8=new N,CA=new N;function iCe(t,e,i,r,n,s){let o;return s===As?o=t.intersectTriangle(r,i,e,!0,n):o=t.intersectTriangle(e,i,r,s!==fa,n),o===null?null:{distance:t.origin.distanceTo(n),point:n.clone()}}function rCe(t,e,i,r,n,s,o,a,l){Gg.fromBufferAttribute(e,s),Vg.fromBufferAttribute(e,o),jg.fromBufferAttribute(e,a);let u=iCe(t,Gg,Vg,jg,CA,l);if(u){r&&(AA.fromBufferAttribute(r,s),EA.fromBufferAttribute(r,o),MA.fromBufferAttribute(r,a),u.uv=Fs.getInterpolation(CA,Gg,Vg,jg,AA,EA,MA,new me)),n&&(AA.fromBufferAttribute(n,s),EA.fromBufferAttribute(n,o),MA.fromBufferAttribute(n,a),u.uv1=Fs.getInterpolation(CA,Gg,Vg,jg,AA,EA,MA,new me)),i&&(Y8.fromBufferAttribute(i,s),K8.fromBufferAttribute(i,o),J8.fromBufferAttribute(i,a),u.normal=Fs.getInterpolation(CA,Gg,Vg,jg,Y8,K8,J8,new N),u.normal.dot(t.direction)>0&&u.normal.multiplyScalar(-1));let c={a:s,b:o,c:a,normal:new N,materialIndex:0};Fs.getNormal(Gg,Vg,jg,c.normal),u.face=c,u.faceIndex=s}return u}function C$(t,e,i,r,n){let s=r*3,o=t.index.getX(s),a=t.index.getX(s+1),l=t.index.getX(s+2),{position:u,normal:c,uv:h,uv1:d}=t.attributes,p=rCe(i,u,c,h,d,o,a,l,e);return p?(p.faceIndex=r,n&&n.push(p),p):null}function nCe(t,e,i,r,n,s){for(let o=r,a=r+n;o<a;o++)C$(t,e,i,o,s)}function sCe(t,e,i,r,n){let s=1/0,o=null;for(let a=r,l=r+n;a<l;a++){let u=C$(t,e,i,a);u&&u.distance<s&&(o=u,s=u.distance)}return o}function dh(t,e,i,r){let n=t.a,s=t.b,o=t.c,a=e,l=e+1,u=e+2;i&&(a=i.getX(e),l=i.getX(e+1),u=i.getX(e+2)),n.x=r.getX(a),n.y=r.getY(a),n.z=r.getZ(a),s.x=r.getX(l),s.y=r.getY(l),s.z=r.getZ(l),o.x=r.getX(u),o.y=r.getY(u),o.z=r.getZ(u)}function Q8(t,e,i,r,n,s,o){let a=i.index,l=i.attributes.position;for(let u=t,c=e+t;u<c;u++)if(dh(o,u*3,a,l),o.needsUpdate=!0,r(o,u,n,s))return!0;return!1}var P$=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){let t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}};function tp(t,e){return e[t+15]===65535}function Pv(t,e){return e[t+6]}function o1(t,e){return e[t+14]}function a1(t){return t+8}function l1(t,e){return e[t+6]}function oCe(t,e){return e[t+7]}var lv=new Mn,R2=new N,aCe=["x","y","z"];function JB(t,e,i,r,n){let s=t*2,o=Y0,a=Tp,l=Rp;if(tp(s,a)){let u=Pv(t,l),c=o1(s,a);nCe(e,i,r,u,c,n)}else{let u=a1(t);k2(u,o,r,R2)&&JB(u,e,i,r,n);let c=l1(t,l);k2(c,o,r,R2)&&JB(c,e,i,r,n)}}function QB(t,e,i,r){let n=t*2,s=Y0,o=Tp,a=Rp;if(tp(n,o)){let l=Pv(t,a),u=o1(n,o);return sCe(e,i,r,l,u)}else{let l=oCe(t,a),u=aCe[l],c=r.direction[u]>=0,h,d;c?(h=a1(t),d=l1(t,a)):(h=l1(t,a),d=a1(t));let p=k2(h,s,r,R2)?QB(h,e,i,r):null;if(p){let m=p.point[u];if(c?m<=s[d+l]:m>=s[d+l+3])return p}let f=k2(d,s,r,R2)?QB(d,e,i,r):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var lCe=function(){let t,e,i=[],r=new P$(()=>new Mn);return function(...s){t=r.getPrimitive(),e=r.getPrimitive(),i.push(t,e);let o=n(...s);r.releasePrimitive(t),r.releasePrimitive(e),i.pop(),i.pop();let a=i.length;return a>0&&(e=i[a-1],t=i[a-2]),o};function n(s,o,a,l,u=null,c=0,h=0){function d(v){let b=v*2,_=Tp,A=Rp;for(;!tp(b,_);)v=a1(v),b=v*2;return Pv(v,A)}function p(v){let b=v*2,_=Tp,A=Rp;for(;!tp(b,_);)v=l1(v,A),b=v*2;return Pv(v,A)+o1(b,_)}let f=s*2,m=Y0,g=Tp,y=Rp;if(tp(f,g)){let v=Pv(s,y),b=o1(f,g);return vh(s,m,t),l(v,b,!1,h,c+s,t)}else{let v=a1(s),b=l1(s,y),_=v,A=b,S,E,M,R;if(u&&(M=t,R=e,vh(_,m,M),vh(A,m,R),S=u(M),E=u(R),E<S)){_=b,A=v;let H=S;S=E,E=H,M=R}M||(M=t,vh(_,m,M));let C=tp(_*2,g),T=a(M,C,S,h+1,c+_),L;if(T===2){let H=d(_),z=p(_)-H;L=l(H,z,!0,h+1,c+_,M)}else L=T&&n(_,o,a,l,u,c,h+1);if(L)return!0;R=e,vh(A,m,R);let I=tp(A*2,g),D=a(R,I,E,h+1,c+A),F;if(D===2){let H=d(A),z=p(A)-H;F=l(H,z,!0,h+1,c+A,R)}else F=D&&n(A,o,a,l,u,c,h+1);return!!F}}}(),uCe=function(){let t=new id,e=new id,i=new lt,r=new Uh,n=new Uh;return function s(o,a,l,u,c=null){let h=o*2,d=Y0,p=Tp,f=Rp;if(c===null&&(l.boundingBox||l.computeBoundingBox(),r.set(l.boundingBox.min,l.boundingBox.max,u),c=r),tp(h,p)){let m=a,g=m.index,y=m.attributes.position,v=l.index,b=l.attributes.position,_=Pv(o,f),A=o1(h,p);if(i.copy(u).invert(),l.boundsTree)return vh(o,d,n),n.matrix.copy(i),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:S=>n.intersectsBox(S),intersectsTriangle:S=>{S.a.applyMatrix4(u),S.b.applyMatrix4(u),S.c.applyMatrix4(u),S.needsUpdate=!0;for(let E=_*3,M=(A+_)*3;E<M;E+=3)if(dh(e,E,g,y),e.needsUpdate=!0,S.intersectsTriangle(e))return!0;return!1}});for(let S=_*3,E=A+_*3;S<E;S+=3){dh(t,S,g,y),t.a.applyMatrix4(i),t.b.applyMatrix4(i),t.c.applyMatrix4(i),t.needsUpdate=!0;for(let M=0,R=v.count;M<R;M+=3)if(dh(e,M,v,b),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}else{let m=o+8,g=f[o+6];return vh(m,d,lv),!!(c.intersectsBox(lv)&&s(m,a,l,u,c)||(vh(g,d,lv),c.intersectsBox(lv)&&s(g,a,l,u,c)))}}}();function k2(t,e,i,r){return vh(t,e,lv),i.intersectBox(lv,r)}var ZB=[],DM,Y0,Tp,Rp;function zx(t){DM&&ZB.push(DM),DM=t,Y0=new Float32Array(t),Tp=new Uint16Array(t),Rp=new Uint32Array(t)}function PA(){DM=null,Y0=null,Tp=null,Rp=null,ZB.length&&zx(ZB.pop())}var PD=Symbol("skip tree generation"),TD=new Mn,RD=new Mn,Wg=new lt,ff=new Uh,Qb=new Uh,Zb=new N,TA=new N,hCe=new N,cCe=new N,dCe=new N,Z8=new Mn,Yu=new P$(()=>new id),dw=class{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),dw.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e={cloneBuffers:!0,...e};let i=t.geometry,r=t._roots,n=i.getIndex(),s;return e.cloneBuffers?s={roots:r.map(o=>o.slice()),index:n.array.slice()}:s={roots:r,index:n.array},s}static deserialize(t,e,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),dw.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:r,roots:n}=t,s=new dw(e,{...i,[PD]:!0});if(s._roots=n,i.setIndex){let o=e.getIndex();if(o===null){let a=new ei(t.index,1,!1);e.setIndex(a)}else o.array!==r&&(o.array.set(r),o.needsUpdate=!0)}return s}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[PD]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[PD]||(this._roots=ZMe(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Mn))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));let e=this.geometry,i=e.index.array,r=e.attributes.position,n,s,o,a,l=0,u=this._roots;for(let h=0,d=u.length;h<d;h++)n=u[h],s=new Uint32Array(n),o=new Uint16Array(n),a=new Float32Array(n),c(0,l),l+=n.byteLength;function c(h,d,p=!1){let f=h*2;if(o[f+15]===65535){let m=s[h+6],g=o[f+14],y=1/0,v=1/0,b=1/0,_=-1/0,A=-1/0,S=-1/0;for(let E=3*m,M=3*(m+g);E<M;E++){let R=i[E],C=r.getX(R),T=r.getY(R),L=r.getZ(R);C<y&&(y=C),C>_&&(_=C),T<v&&(v=T),T>A&&(A=T),L<b&&(b=L),L>S&&(S=L)}return a[h+0]!==y||a[h+1]!==v||a[h+2]!==b||a[h+3]!==_||a[h+4]!==A||a[h+5]!==S?(a[h+0]=y,a[h+1]=v,a[h+2]=b,a[h+3]=_,a[h+4]=A,a[h+5]=S,!0):!1}else{let m=h+8,g=s[h+6],y=m+d,v=g+d,b=p,_=!1,A=!1;t?b||(_=t.has(y),A=t.has(v),b=!_&&!A):(_=!0,A=!0);let S=b||_,E=b||A,M=!1;S&&(M=c(m,d,b));let R=!1;E&&(R=c(g,d,b));let C=M||R;if(C)for(let T=0;T<3;T++){let L=m+T,I=g+T,D=a[L],F=a[L+3],H=a[I],z=a[I+3];a[h+T]=D<H?D:H,a[h+T+3]=F>z?F:z}return C}}}traverse(t,e=0){let i=this._roots[e],r=new Uint32Array(i),n=new Uint16Array(i);s(0);function s(o,a=0){let l=o*2,u=n[l+15]===65535;if(u){let c=r[o+6],h=n[l+14];t(a,u,new Float32Array(i,o*4,6),c,h)}else{let c=o+8,h=r[o+6],d=r[o+7];t(a,u,new Float32Array(i,o*4,6),d)||(s(c,a+1),s(h,a+1))}}}raycast(t,e=Eu){let i=this._roots,r=this.geometry,n=[],s=e.isMaterial,o=Array.isArray(e),a=r.groups,l=s?e.side:e;for(let u=0,c=i.length;u<c;u++){let h=o?e[a[u].materialIndex].side:l,d=n.length;if(zx(i[u]),JB(0,r,h,t,n),PA(),o){let p=a[u].materialIndex;for(let f=d,m=n.length;f<m;f++)n[f].face.materialIndex=p}}return n}raycastFirst(t,e=Eu){let i=this._roots,r=this.geometry,n=e.isMaterial,s=Array.isArray(e),o=null,a=r.groups,l=n?e.side:e;for(let u=0,c=i.length;u<c;u++){let h=s?e[a[u].materialIndex].side:l;zx(i[u]);let d=QB(0,r,h,t);PA(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[u].materialIndex))}return o}intersectsGeometry(t,e){let i=this.geometry,r=!1;for(let n of this._roots)if(zx(n),r=uCe(0,i,t,e),PA(),r)break;return r}shapecast(t,e,i){let r=this.geometry;if(t instanceof Function){if(e){let h=e;e=(d,p,f,m)=>{let g=p*3;return h(d,g,g+1,g+2,f,m)}}t={boundsTraverseOrder:i,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=Yu.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){let h=a;a=(d,p,f,m,g)=>h(d,p,f,m,g)?!0:Q8(d,p,r,l,f,m,n)}else a||(l?a=(h,d,p,f)=>Q8(h,d,r,l,p,f,n):a=(h,d,p)=>p);let u=!1,c=0;for(let h of this._roots){if(zx(h),u=lCe(0,r,o,a,s,c),PA(),u)break;c+=h.byteLength}return Yu.releasePrimitive(n),u}bvhcast(t,e,i){let{intersectsRanges:r,intersectsTriangles:n}=i,s=this.geometry.index,o=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;Wg.copy(e).invert();let u=Yu.getPrimitive(),c=Yu.getPrimitive();if(n){let d=function(p,f,m,g,y,v,b,_){for(let A=m,S=m+g;A<S;A++){dh(c,A*3,a,l),c.a.applyMatrix4(e),c.b.applyMatrix4(e),c.c.applyMatrix4(e),c.needsUpdate=!0;for(let E=p,M=p+f;E<M;E++)if(dh(u,E*3,s,o),u.needsUpdate=!0,n(u,c,E,A,y,v,b,_))return!0}return!1};if(r){let p=r;r=function(f,m,g,y,v,b,_,A){return p(f,m,g,y,v,b,_,A)?!0:d(f,m,g,y,v,b,_,A)}}else r=d}t.getBoundingBox(RD),RD.applyMatrix4(e);let h=this.shapecast({intersectsBounds:d=>RD.intersectsBox(d),intersectsRange:(d,p,f,m,g,y)=>(TD.copy(y),TD.applyMatrix4(Wg),t.shapecast({intersectsBounds:v=>TD.intersectsBox(v),intersectsRange:(v,b,_,A,S)=>r(d,p,v,b,m,g,A,S)}))});return Yu.releasePrimitive(u),Yu.releasePrimitive(c),h}intersectsBox(t,e){return ff.set(t.min,t.max,e),ff.needsUpdate=!0,this.shapecast({intersectsBounds:i=>ff.intersectsBox(i),intersectsTriangle:i=>ff.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},r={},n=0,s=1/0){t.boundingBox||t.computeBoundingBox(),ff.set(t.boundingBox.min,t.boundingBox.max,e),ff.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,u=t.attributes.position,c=t.index,h=Yu.getPrimitive(),d=Yu.getPrimitive(),p=TA,f=hCe,m=null,g=null;r&&(m=cCe,g=dCe);let y=1/0,v=null,b=null;return Wg.copy(e).invert(),Qb.matrix.copy(Wg),this.shapecast({boundsTraverseOrder:_=>ff.distanceToBox(_),intersectsBounds:(_,A,S)=>S<y&&S<s?(A&&(Qb.min.copy(_.min),Qb.max.copy(_.max),Qb.needsUpdate=!0),!0):!1,intersectsRange:(_,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:S=>Qb.distanceToBox(S),intersectsBounds:(S,E,M)=>M<y&&M<s,intersectsRange:(S,E)=>{for(let M=S*3,R=(S+E)*3;M<R;M+=3){dh(d,M,c,u),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let C=_*3,T=(_+A)*3;C<T;C+=3){dh(h,C,l,a),h.needsUpdate=!0;let L=h.distanceToTriangle(d,p,m);if(L<y&&(f.copy(p),g&&g.copy(m),y=L,v=C/3,b=M/3),L<n)return!0}}}});{let S=c?c.count:u.count;for(let E=0,M=S;E<M;E+=3){dh(d,E,c,u),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let R=_*3,C=(_+A)*3;R<C;R+=3){dh(h,R,l,a),h.needsUpdate=!0;let T=h.distanceToTriangle(d,p,m);if(T<y&&(f.copy(p),g&&g.copy(m),y=T,v=R/3,b=E/3),T<n)return!0}}}}}),Yu.releasePrimitive(h),Yu.releasePrimitive(d),y===1/0?null:(i.point?i.point.copy(f):i.point=f.clone(),i.distance=y,i.faceIndex=v,r&&(r.point?r.point.copy(g):r.point=g.clone(),r.point.applyMatrix4(Wg),f.applyMatrix4(Wg),r.distance=f.sub(r.point).length(),r.faceIndex=b),i)}closestPointToPoint(t,e={},i=0,r=1/0){let n=i*i,s=r*r,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:u=>(Zb.copy(t).clamp(u.min,u.max),Zb.distanceToSquared(t)),intersectsBounds:(u,c,h)=>h<o&&h<s,intersectsTriangle:(u,c)=>{u.closestPointToPoint(t,Zb);let h=t.distanceToSquared(Zb);return h<o&&(TA.copy(Zb),o=h,a=c),h<n}}),o===1/0)return null;let l=Math.sqrt(o);return e.point?e.point.copy(TA):e.point=TA.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{vh(0,new Float32Array(e),Z8),t.union(Z8)}),t}},$b=qn(hce()),pCe=.5*(Math.sqrt(3)-1),ex=(3-Math.sqrt(3))/6,fCe=1/3,Ku=1/6,pw=t=>Math.floor(t)|0,$8=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),kD=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function DD(t=Math.random){let e=T$(t),i=new Float64Array(e).map(n=>$8[n%12*2]),r=new Float64Array(e).map(n=>$8[n%12*2+1]);return function(n,s){let o=0,a=0,l=0,u=(n+s)*pCe,c=pw(n+u),h=pw(s+u),d=(c+h)*ex,p=c-d,f=h-d,m=n-p,g=s-f,y,v;m>g?(y=1,v=0):(y=0,v=1);let b=m-y+ex,_=g-v+ex,A=m-1+2*ex,S=g-1+2*ex,E=c&255,M=h&255,R=.5-m*m-g*g;if(R>=0){let L=E+e[M],I=i[L],D=r[L];R*=R,o=R*R*(I*m+D*g)}let C=.5-b*b-_*_;if(C>=0){let L=E+y+e[M+v],I=i[L],D=r[L];C*=C,a=C*C*(I*b+D*_)}let T=.5-A*A-S*S;if(T>=0){let L=E+1+e[M+1],I=i[L],D=r[L];T*=T,l=T*T*(I*A+D*S)}return 70*(o+a+l)}}function mCe(t=Math.random){let e=T$(t),i=new Float64Array(e).map(s=>kD[s%12*3]),r=new Float64Array(e).map(s=>kD[s%12*3+1]),n=new Float64Array(e).map(s=>kD[s%12*3+2]);return function(s,o,a){let l,u,c,h,d=(s+o+a)*fCe,p=pw(s+d),f=pw(o+d),m=pw(a+d),g=(p+f+m)*Ku,y=p-g,v=f-g,b=m-g,_=s-y,A=o-v,S=a-b,E,M,R,C,T,L;_>=A?A>=S?(E=1,M=0,R=0,C=1,T=1,L=0):_>=S?(E=1,M=0,R=0,C=1,T=0,L=1):(E=0,M=0,R=1,C=1,T=0,L=1):A<S?(E=0,M=0,R=1,C=0,T=1,L=1):_<S?(E=0,M=1,R=0,C=0,T=1,L=1):(E=0,M=1,R=0,C=1,T=1,L=0);let I=_-E+Ku,D=A-M+Ku,F=S-R+Ku,H=_-C+2*Ku,z=A-T+2*Ku,B=S-L+2*Ku,j=_-1+3*Ku,V=A-1+3*Ku,q=S-1+3*Ku,K=p&255,le=f&255,Z=m&255,oe=.6-_*_-A*A-S*S;if(oe<0)l=0;else{let pe=K+e[le+e[Z]];oe*=oe,l=oe*oe*(i[pe]*_+r[pe]*A+n[pe]*S)}let ae=.6-I*I-D*D-F*F;if(ae<0)u=0;else{let pe=K+E+e[le+M+e[Z+R]];ae*=ae,u=ae*ae*(i[pe]*I+r[pe]*D+n[pe]*F)}let ve=.6-H*H-z*z-B*B;if(ve<0)c=0;else{let pe=K+C+e[le+T+e[Z+L]];ve*=ve,c=ve*ve*(i[pe]*H+r[pe]*z+n[pe]*B)}let ye=.6-j*j-V*V-q*q;if(ye<0)h=0;else{let pe=K+1+e[le+1+e[Z+1]];ye*=ye,h=ye*ye*(i[pe]*j+r[pe]*V+n[pe]*q)}return 32*(l+u+c+h)}}function T$(t){let e=new Uint8Array(512);for(let i=0;i<512/2;i++)e[i]=i;for(let i=0;i<512/2-1;i++){let r=i+~~(t()*(256-i)),n=e[i];e[i]=e[r],e[r]=n}for(let i=256;i<512;i++)e[i]=e[i-256];return e}var Ql=new Fs,gCe=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let r=0;r<t.count;r+=3){let n=1;Ql.a.fromBufferAttribute(t,r),Ql.b.fromBufferAttribute(t,r+1),Ql.c.fromBufferAttribute(t,r+2),n*=Ql.getArea(),e[r/3]=n}this.distribution=new Float32Array(t.count/3);let i=0;for(let r=0;r<e.length;r++)i+=e[r],this.distribution[r]=i;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let i=this.distribution[this.distribution.length-1],r=this.binarySearch(this.randomFunction()*i);return this.sampleFace(r,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,i=0,r=e.length-1,n=-1;for(;i<=r;){let s=Math.ceil((i+r)/2);if(s===0||e[s-1]<=t&&e[s]>t){n=s;break}else t<e[s]?r=s-1:i=s+1}return n}sampleFace(t,e,i){let r=this.randomFunction(),n=this.randomFunction();return r+n>1&&(r=1-r,n=1-n),Ql.a.fromBufferAttribute(this.positionAttribute,t*3),Ql.b.fromBufferAttribute(this.positionAttribute,t*3+1),Ql.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(Ql.a,r).addScaledVector(Ql.b,n).addScaledVector(Ql.c,1-(r+n)),Ql.getNormal(i),this}},yCe=qn(hQ()),vCe=new lt,bCe=new lt,xCe=new lt,u1;(t=>{function e(i){return i&&i.__isSPEObject}t.is=e})(u1||(u1={}));var dz=t=>class extends t{constructor(){super(...arguments),this.previousModelViewMatrix=new lt,this.copyPreviousMatrix=!0,this.hiddenMatrix=new lt,this.matrixWorldRigid=new lt,this.shearScale=new lt,this.shearScaleInv=new lt}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof ir&&(e=e.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===e)return!0;i=i.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let i of this.children)i.updateMatrixWorld(e)}updateWorldMatrix(e,i){let r=this.parent;if(e&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(e,i=0){for(let r of this.children)u1.is(r)&&r.traverseObject(e,i+1)}traverseObject(e,i=0){if(e(this,i)!==!0)for(let r of this.children)u1.is(r)&&r.traverseObject(e,i+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,i=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:r,v:n,q:s}=(0,yCe.SVD)(i),o=vCe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),a=bCe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=xCe.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(u=>Math.abs(s[0]-u)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,i){this.updateWorldMatrix(!0,!1);let r=new lt().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),r.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof lt?e.hiddenMatrix.premultiply(r):e.applyMatrix4(r),e.updateWorldMatrix(!1,!1),this.add(e),i!==void 0&&(this.children.pop(),this.children.splice(i,0,e)),this}copy(e,i=!1){return super.copy(e,i),this.hasNonUniformScale=e.hasNonUniformScale,this}onAfterRender(e,i,r,n,s,o){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},wCe=class extends dz(ir){},_Ce=t=>t.type==="Mesh",co=class extends wCe{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1,this.hasNonUniformScale=t.hasNonUniformScale}raycast(t,e){}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let i=this.children[t];(i==null?void 0:i.object)!==e&&(i&&this.remove(i),i=new co(e),this.add(i),this.children.splice(t,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=e.matrix,i.hiddenMatrix=e.hiddenMatrix),i.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return _Ce(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Ff=new N,zf=new N,Tv=new lt,R$=[new N(-1,1,1),new N(-1,-1,1),new N(1,-1,1),new N(1,1,1),new N(-1,1,-1),new N(-1,-1,-1),new N(1,-1,-1),new N(1,1,-1)],SCe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],ACe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],e9=(t,e,i)=>{t.updateEntityBoxSize(Ff,zf),Tv.copy(e).multiply(t.matrixWorld),zf.x===0&&zf.y===0&&zf.z===0?i.push(new N(Ff.x,Ff.y,Ff.z).applyMatrix4(Tv)):R$.forEach(r=>{i.push(r.clone().multiply(zf).add(Ff).applyMatrix4(Tv))})},t9=class extends Mn{constructor(){super(...arguments),this.matrix=new lt,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let i=new lt().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,i,e)}expandByObjectSize(t,e,i=!1){let r=[];return i===!0?t.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){r.push(new N);return}e9(n,e,r)}}):e9(t,e,r),this.setFromPoints(r)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(Tv.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(zf).multiplyScalar(.5),this.getCenter(Ff),Tv.copy(this.matrix).setPosition(Ff),this.vertices=R$.map(t=>t.clone().multiply(zf).applyMatrix4(Tv))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=SCe.map(([t,e])=>new Ol(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new N))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=ACe.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},fp={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},ECe=class extends FQ{constructor(){super()}getPoints(t=12){let e=[],i,r=this.getCurveLengths(),n=r[r.length-1]/r.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?r[s]:r[s]-r[s-1],u=Math.ceil(t*l/n),c=a.getPoints(u);for(let h=0;h<c.length;h++){let d=c[h];i&&i.equals(d)||(e.push(d),i=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},$B=.001;function eO(t,e,i){return e.clone().sub(t).cross(e.clone().sub(i)).length()<=$B}function ID(t,e){let i=new N(...t.position),r=new N(...t.controlNext.position),n=new N(...e.controlPrevious.position),s=new N(...e.position);return eO(i,r,s)&&eO(i,n,s)}function k$(t){let e=t.points.map(c=>new N(...c.data.position)),i=[t.points[0]],r=new N(...i[0].data.position);for(let c=0;c<t.points.length-1;c++)eO(r,e[c],e[c+1])||(i.push(t.points[c]),r=e[c]);i.push(t.points[t.points.length-1]);let n=t.isClosed,s=i.length-(n?0:1),o=i.length,a=[];for(let c=0;c<o;c++){let h=i[c].data,d=new N(...h.position),p=new N(...h.controlPrevious.position),f=new N(...h.controlNext.position),m={position:d,baseRoundness:h.roundness,controlPrevious:p,controlNext:f};if(h.roundness===0||!t.isClosed&&(c===0||c===o-1)){a[c]={...m,removedLength:0};continue}let g=n&&c==0?o-1:c-1,y=n&&c==o-1?0:c+1,v=i[g].data,b=i[y].data,_=new N(...v.position),A=new N(...b.position),S=_.clone().sub(d).normalize(),E=A.clone().sub(d).normalize();Object.assign(m,{prevDir:S,nextDir:E});let M=ID(v,h),R=ID(h,b);if(!M||!R)a[c]={...m,removedLength:0};else{let C=S.clone().add(E).normalize(),T=C.clone().cross(S).length()/S.dot(C);a[c]={...m,tan:T,removedLength:h.roundness/T}}}for(let c=0;c<s;c++){let h=c,d=n&&c===o-1?0:c+1,p=a[h],f=a[d];if(p.removedLength!==0||f.removedLength!==0){let m=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,m/2),f.removedLength=Math.min(f.removedLength,m/2)}}let l=[];for(let c=0;c<s;c++){let h=c,d=n&&c===o-1?0:c+1,p=a[h],f=a[d],m=null;if(!ID(i[h].data,i[d].data))p.position.distanceTo(f.position)>$B&&(m=new CM(p.position,p.controlNext,f.controlPrevious,f.position));else{let g=p.position.clone(),y=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&g.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&y.add(f.prevDir.clone().setLength(f.removedLength))),g.distanceTo(y)>$B&&(m=new CM(g,g.clone().lerp(y,.3),y.clone().lerp(g,.3),y))}l[2*c+1]=m}for(let c=0;c<o;c++){let h=a[c];if(h.removedLength===0){l[2*c]=null;continue}let d=h.position,p=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),f=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),m=h.tan*h.removedLength,g=h.prevDir.clone().add(h.nextDir).normalize(),y=p.clone().lerp(f,.5),v=p.distanceTo(f)/2,b=g.clone().multiplyScalar(Math.sqrt(Math.pow(m,2)-Math.pow(v,2))).add(y),_=g.clone().multiplyScalar(-m).add(b),A=d.distanceTo(_)/d.distanceTo(y),S=h.prevDir.clone().multiplyScalar(A*d.distanceTo(p)).add(d),E=S.clone().lerp(_,2),M=p.clone().lerp(S,4/3),R=f.clone().lerp(E,4/3);l[2*c]=new CM(p,M,R,f)}let u=new ECe;return l.forEach(c=>{c&&u.add(c)}),u}var Ti;(t=>{function e(i){return i&&i.__isEntity}t.is=e})(Ti||(Ti={}));var Pc=t=>Ti.is(t),MCe={type:"completeState",isfromEntity:!0},CCe=["x","y","z"],LD=new N,PCe=new N().set(0,1,0),pz=t=>class extends dz(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new t9,this._recursiveBBox=new t9,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let i=this.children[e];if(Ti.is(i))return i}entityChildrenCount(){let e=this.children.length;for(;e--;)if(Ti.is(this.children[e]))return e+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let i=e.parent;if(Ti.is(i))e=i;else return}return e}forInstancesRec(e){this.instances.forEach(i=>{i.disposed||e(i),i.forInstancesRec(e)})}super_Entity(e,i){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,i,r=!1){if(!(this.data.states.length===0&&!r)){for(let n of this.data.states)Jf.toOps(this.data,n.data).forEach(s=>{let o=u2.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,i)});if(e!==null){let n=this.data.states.data(e);n&&(this.dataPatched=Jf.patch(this.data,n),Jf.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}r&&this.updateTransformState(this.dataPatched,i),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,i){e.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{Pc(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let i;return this.traverseEntity(r=>{r.uuid===e&&(i=r)}),i}traverseSortNextHelper(){let e=this.parent;if(e){let i=e.children,r=i.indexOf(this)+1;if(Ti.is(i[r]))return i[r];if(Ti.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&Ti.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let i=this;for(;e>0&&i!==null;)i=i.parent,e-=1;return i}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let i=this.parent;for(;i;){if(e===i)return!0;i=i.parent}return!1}countToAccestor(e){let i=0,r=this;for(;r!==e;){if(r===null)return-1;r=r.parent,i+=1}return i}forEachEntity(e){for(let i of this.children)Pc(i)&&e(i)}traverseEntityAncestors(e){this.traverseAncestors(i=>{Ti.is(i)&&e(i)})}traverseConcreteEntity(e,i=0){if(e(this,i)!==!0)for(let r of this.children)Pc(r)&&r.isConcreteEntity&&r.traverseEntity(e,i+1)}traverseEntity(e,i=0){if(e(this,i)!==!0)for(let r of this.children)Pc(r)&&r.traverseEntity(e,i+1)}traverseVisibleEntity(e){e(this);for(let i of this.children)Pc(i)&&i.visible&&i.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(e){super.updateMatrixWorld(e),this.dispatchEvent({type:"updateMatrixWorld"})}copy(e,i=!1){return super.copy(e,i),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>Pc(e))}isAncestorOf(e){if(this.uuid===e)return!1;let i=!1;return this.traverseEntity(r=>{r.uuid===e&&(i=!0)}),i}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x*kt.RAD2DEG,this.rotation.y*kt.RAD2DEG,this.rotation.z*kt.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return hB(i,e)}getTransformValues(e,i,r){return i[e].map((n,s)=>(r==null?void 0:r.shared.getVariable(n,[this.uuid,e,CCe[s]]))??n)}updateTransformState(e,i){let r=!1;return e.position&&(this.position.fromArray(this.getTransformValues("position",e,i)),r=!0),e.rotation&&(LD.fromArray(this.getTransformValues("rotation",e,i)).multiplyScalar(kt.DEG2RAD),this.rotation.setFromVector3(LD),r=!0),e.scale&&(this.scale.fromArray(this.getTransformValues("scale",e,i)),r=!0),e.hiddenMatrix!==void 0&&(r=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??s0.identity)),r&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),r}onVariableUpdate(e=!1){if(e){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)Ti.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{Ti.is(e)&&e.disposeRecursively()})}toState(e=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return hB(i,e)}updateByObjUpdateOp(e,i){e!==void 0&&this.updateByOp({type:0,props:e,path:[]},{...this.data,...e},i,!1)}updateByOp(e,i,r,n){let s=this.data;this.data=i;let o=e,a=gr(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let u={...e.props};if(delete u.name,Object.values(e.props).some(c=>c===void 0)){let c=this.data;if(c!==void 0){let h=zs.zoom(c,e.path.slice(2));if(h)for(let d in e.props)e.props[d]===void 0&&d in h&&(u[d]=h[d])}}o={...e,props:u,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:c,...h}=l;l=h}if(e.props.material!==void 0&&"material"in l){let{material:c,...h}=l;l=h}let u=zs.removeOverridden(e.path,e.props,l);o={...e,props:u}}}if(this.updateByPatchedOpBase(o,Jf.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r),gr(e.path,["overrides"])){let l=[],u=[...e.path];for(l.push(u[1]),u.splice(0,2);u.length>0&&u[0]==="descendants";)l.push(u[1]),u.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let c of Object.keys(e.props)){l[l.length-1]=c;let h=r.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=e.props[c],h.updateState(Cp.apply(h.component.data,h.overrideData),r))}}else{let c=r.scene.findInstance([this.uuid,...l]);if(c){let h=zs.zoom(c.component.data,u);if(e={...e,path:u},e.type===0){let d=e.props;if(h)for(let[p,f]of Object.entries(e.props))f===void 0&&(d===e.props&&(d={...e.props}),d[p]=h[p]);e={...e,props:d}}c.overrideData=x2.resolve(i.overrides,l),c.updateByOp(e,Ss.applySimple(c.data,e),r,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let u;for(let c of dp.rootOverrideProps)c in e.props&&(u===void 0&&(u={}),u[c]=e.props[c]);u&&(l={...e,props:u})}else for(let u of dp.rootOverrideProps)if(gr(e.path,[u])){l=e;break}l!==void 0&&this.instances.forEach(u=>{if(u.isInstanceRoot){let c=Cp.filterOp(u.overrideData,l);c&&u.updateByOp(c,Ss.applySimple(u.data,c),r,!0)}}),this.instances.forEach(u=>{if(!u.isInstanceRoot){let c=Cp.filterOp(u.overrideData,e);if(c){let h;s===u.data&&e===c?h=i:h=Ss.applySimple(u.data,c),u.updateByOp(c,h,r,!0)}}})}}updateByPatchedOpBase(e,i,r){if(this.dataPatched=i,e.path.length===0&&e.type===0)e.props.type!==void 0&&!Om.is(e.props.type)&&fp.changeEntityProptotype(this,i,r);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){fp.changeEntityProptotype(this,i,r);for(let n of this.children)Ti.is(n)&&n.updateVisible(r.scene)}this.updateByPatchedOp(e,i,r)}updateByPatchedOp(e,i,r){if(e.path.length===0&&e.type===0&&this.updateState(e.props,r),gr(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),gr(e.path,["cloner"])!==null){let n=Ss.drop(e,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,r):this.cloner?this.cloner.updateState(i.cloner,r.scene):(this.setFromClonerState(i.cloner,r),this.expandCloner(r.scene)),this.updateVisible(r.scene)}}updatePathSnapping(e=this.dataPatched.pathSnapping){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var f,m,g,y,v;let i=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,r=((m=this._updatedPathSnapping)==null?void 0:m.slide)??this.dataPatched.pathSnapping.slide??0,n=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset??0,s=((y=this._updatedPathSnapping)==null?void 0:y.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let o=e.find(i);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data;if(a.geometry.path.points.length<=1)return;let l=k$(a.geometry.path),u=(r+n)%1;r+n===1&&u===0&&(u=1);let c=l.getPointAt(u);if(c===null)return;let h=this.parent?(v=this.parent)==null?void 0:v.matrixWorld:new lt;o.updateMatrixWorld();let d=new lt().multiplyMatrices(h.clone().invert(),o.matrixWorld);c.applyMatrix4(d);let p={position:c.toArray(),rotation:a.rotation};if(s==="tangential"){let b=new lt().extractRotation(o.matrixWorld),_=l.getTangentAt(u).applyMatrix4(b).add(c),A=new lt().lookAt(c,_,PCe),S=LD.setFromEuler(new ts().setFromRotationMatrix(A)).multiplyScalar(kt.RAD2DEG);p={...p,rotation:S.toArray()}}this.updateTransformState(p),this.traverseEntity(b=>{b._cameraType&&b.dispatchEvent(MCe)})}updateVisible(e){var r;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((r=this.dataPatched.cloner)==null?void 0:r.hideBase)!==!0),!e)return;let i=!1;this.traverseEntity(n=>{if(n.data.type==="Splat")return i=!0,!0}),i&&e.reloadSplats()}updateState_Entity(e,i){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(i==null?void 0:i.scene),this.resetBBoxNeedsUpdate()),i&&"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,i),this.updateVisible(i.scene)),this.updateTransformState(e,i)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof fp.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,i){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new fp.Cloner(this,e),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,i.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}requestRender(){this.dispatchEvent({type:"requestRender"})}},D$=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters);i.thetaLength=kt.clamp(i.thetaLength,0,360);let r=i.width/2,n=i.radiusTop??r,s=i.radiusBottom??r;return n===s?(n=r,s=r):n>s?(n=r,s=s*r/n):(n=n*r/s,s=r),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:n,radiusBottom:s})}}static build(t){let{width:e,depth:i,height:r,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:u,radiusBottom:c,cornerRadius:h,cornerSegments:d,hollow:p}=t.parameters,f;return l===0?(f=new Ht,f.setAttribute("position",new _t([],3))):h||p?f=new I$(u,c,r,n,s,o,a,l*Math.PI/180,h,h,d,p):f=new kF(u,c,r,n,s,o,a,l*Math.PI/180),f.scale(1,1,i/e),Object.assign(f,{userData:{...t,type:"CylinderGeometry"}})}};function Md(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function i9(t){return new me(t.y,-t.x)}var I$=class extends Ht{constructor(t,e,i,r,n,s,o,a,l,u,c,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,i=i||1,r=Math.floor(r)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,u=0);let p=[],f=[],m=[],g=[],y=0,v=i/2,b=new N,_=new N;d&&t==0&&(t=l),d&&e==0&&(e=u);let A=new me(t,v),S=new me(e,-v),E=null,M=null,R=null,C=null,T=A.clone().sub(S),L=0,I=0,D=0;h>0&&(L=Math.min(t,e)*(1-h),I=t-L,D=e-L);let F=A.clone();F.x-=L;let H=Math.PI-T.angle(),z=T.angle(),B=Math.tan(z/2),j=Math.tan(H/2),V=B+j,q=h?V:j,K=h?V:B;if(l=Math.min(l,(t-I)/q,T.length()/V),u=Math.min(u,(e-D)/K,T.length()/V),l>0){let ye=l/B;E=A.clone().sub(new me(ye,l)),h&&(R=E.clone(),R.x-=L-V*l),A.sub(T.clone().setLength(ye))}if(u>0){let ye=u/j;M=S.clone().sub(new me(ye,-u)),S.add(T.clone().setLength(ye)),h&&(C=M.clone(),C.x-=L-V*u,F.sub(T.clone().setLength(ye)))}T=A.clone().sub(S);let le=T.length()<.5,Z=[];for(let ye=0;ye<=r;ye++){let pe=[],Se=ye/r,be=Se*a+o,ee=new me(Math.sin(be),Math.cos(be));C&&M?(oe(pe,Se,ee,H,u,C,-1,!0),oe(pe,Se,ee,z,u,M,-1,!1)):M?(ae(pe,ee,M.x,0,-1),oe(pe,Se,ee,z,u,M,-1,!1)):s||ae(pe,ee,e,D,-1);let _e=i9(T).normalize();if(Md(_e,ee,b),!le)for(let Me=0;Me<=n;Me++){let Ce=Me/n,Re=T.clone().multiplyScalar(Ce).add(S);Md(Re,ee,_),f.push(_.x,_.y,_.z),m.push(b.x,b.y,b.z),g.push(Se,.5+_.y/i),pe.push(y++)}if(R&&E?(oe(pe,Se,ee,H,l,E,1,!1),oe(pe,Se,ee,z,l,R,1,!0)):E?(oe(pe,Se,ee,H,l,E,1,!1),ae(pe,ee,E.x,0,1)):s||ae(pe,ee,t,I,1),h&&!le){let Me=i9(T).multiplyScalar(-1).normalize();Md(Me,ee,b);for(let Ce=0;Ce<=n;Ce++){let Re=Ce/n,Xe=T.clone().multiplyScalar(-Re).add(F);Md(Xe,ee,_),f.push(_.x,_.y,_.z),m.push(b.x,b.y,b.z),g.push(Se,.5+_.y/i),pe.push(y++)}}h&&!s&&pe.push(pe[0]),Z.push(pe)}for(let ye=0;ye<Z.length-1;ye++)for(let pe=0;pe<Z[0].length-1;pe++){if(s&&h&&pe==n)continue;let Se=Z[ye][pe],be=Z[ye+1][pe],ee=Z[ye+1][pe+1],_e=Z[ye][pe+1],Me=f[ee*3+0],Ce=f[ee*3+2];p.push(Se,be,_e),(Me!=0||Ce!=0)&&p.push(be,ee,_e)}a<Math.PI*2&&(ve(-1,Z[0],o),ve(1,Z[Z.length-1],o+a)),this.setIndex(p),this.setAttribute("position",new _t(f,3)),this.setAttribute("normal",new _t(m,3)),this.setAttribute("uv",new _t(g,2));function oe(ye,pe,Se,be,ee,_e,Me,Ce){for(let Re=0;Re<c+1;Re++){let Xe=Re/c,Oe=Me<0?Xe:1-Xe;Ce&&(Oe-=1),Oe*=be;let $=new me(Math.sin(Oe),Math.cos(Oe)*Me),J=$.clone().multiplyScalar(ee).add(_e);Md(J,Se,_),f.push(_.x,_.y,_.z),Md($,Se,b),m.push(b.x,b.y,b.z),g.push(pe,.5+_.y/i),ye.push(y++)}}function ae(ye,pe,Se,be,ee){let _e=new N,Me=new me,Ce=[Se,be];ee<0&&Ce.reverse();for(let Re of Ce)Me.set(Re,v*ee),Md(Me,pe,_e),f.push(_e.x,_e.y,_e.z),m.push(0,ee,0),g.push(.5,.5),ye.push(y++)}function ve(ye,pe,Se){let be=new me(Math.sin(Se),Math.cos(Se)),ee=new me(-Math.cos(Se),Math.sin(Se)),_e=new N,Me=ye<0?(Xe,Oe,$)=>p.push(Xe,Oe,$):(Xe,Oe,$)=>p.push(Xe,$,Oe),Ce=new me((t+e+I+D)/4,0);Md(Ce,be,_e),f.push(_e.x,_e.y,_e.z),m.push(ee.x,0,ee.y),g.push(.5,.5);let Re=y++;for(let Xe of pe){let Oe=f.slice(Xe*3,Xe*3+3);f.push(...Oe),m.push(ee.x,0,ee.y);let $=g.slice(Xe*2,Xe*2+2);g.push(...$),y++}for(let Xe=Re+1;Xe<y-1;Xe++)Me(Re,Xe,Xe+1);Me(Re,y-1,Re+1)}}},TCe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return i.thetaLength=kt.clamp(i.thetaLength,0,360),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,depth:i,height:r,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:u,cornerRadiusBottom:c,cornerSegments:h}=t.parameters,d;return l===0?(d=new Ht,d.setAttribute("position",new _t([],3))):u>0||c>0||l<360?d=new I$(0,e/2,r,n,s,o,a,l*Math.PI/180,u,c,h,0,!0):d=new DF(e/2,r,n,s,o),d.scale(1,1,i/e),Object.assign(d,{userData:{...t,type:"ConeGeometry"}})}},RCe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:r,widthSegments:n,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,u;return a==0?u=new Cu(e,i,r,n,s,o):u=new kCe(e,i,r,n,s,o,a,l),Object.assign(u,{userData:{...t,type:"CubeGeometry"}})}},BD=Math.PI/2,kCe=class extends Ht{constructor(t=1,e=1,i=1,r=1,n=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;r=Math.floor(r),n=Math.floor(n),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,i/2);let u=[],c=[],h=[],d=[],p=0,f=0;m("z","y","x",-1,-1,i,e,t,s,n,0),m("z","y","x",1,-1,i,e,-t,s,n,1),m("x","z","y",1,1,t,i,e,r,s,2),m("x","z","y",1,-1,t,i,-e,r,s,3),m("x","y","z",1,-1,t,e,i,r,n,4),m("x","y","z",-1,-1,t,e,-i,r,n,5),o>0&&(g("z","y","x",-1,-1,1,i,e,t,s,0),g("z","y","x",1,-1,-1,i,e,t,s,1),g("z","y","x",-1,1,-1,i,e,t,s,1),g("z","y","x",1,1,1,i,e,t,s,0),g("x","y","z",-1,-1,-1,t,e,i,r,0),g("x","y","z",1,-1,1,t,e,i,r,1),g("x","y","z",-1,1,1,t,e,i,r,0),g("x","y","z",1,1,-1,t,e,i,r,1),g("y","x","z",-1,-1,1,e,t,i,n,0),g("y","x","z",1,-1,-1,e,t,i,n,1),g("y","x","z",1,1,1,e,t,i,n,1),g("y","x","z",-1,1,-1,e,t,i,n,0),y(1,1,1),y(-1,1,1),y(1,-1,1),y(-1,-1,1),y(1,1,-1),y(-1,1,-1),y(1,-1,-1),y(-1,-1,-1)),this.setIndex(u),this.setAttribute("position",new _t(c,3)),this.setAttribute("normal",new _t(h,3)),this.setAttribute("uv",new _t(d,2));function m(v,b,_,A,S,E,M,R,C,T,L){let I=(E-2*o)/C,D=(M-2*o)/T,F=E/2-o,H=M/2-o,z=R/2,B=C+1,j=T+1,V=0,q=0,K=new N;for(let le=0;le<j;le++){let Z=le*D-H;for(let oe=0;oe<B;oe++){let ae=oe*I-F;K[v]=ae*A,K[b]=Z*S,K[_]=z,c.push(K.x,K.y,K.z),K[v]=0,K[b]=0,K[_]=R>0?1:-1,h.push(K.x,K.y,K.z),d.push(oe/C),d.push(1-le/T),V+=1}}for(let le=0;le<T;le++)for(let Z=0;Z<C;Z++){let oe=p+Z+B*le,ae=p+Z+B*(le+1),ve=p+(Z+1)+B*(le+1),ye=p+(Z+1)+B*le;u.push(oe,ae,ye),u.push(ae,ve,ye),q+=6}l.addGroup(f,q,L),f+=q,p+=V}function g(v,b,_,A,S,E,M,R,C,T,L){let I=(M-2*o)/T,D=M/2-o,F=R/2-o,H=C/2,z=T+1,B=0,j=0,V=new N,q=new N;for(let K=0;K<a+1;K++){let le=K/a*BD,Z=Math.sin(le)*o,oe=(1-Math.cos(le))*o,ae=Math.sin(le),ve=Math.cos(le);V[b]=(F+Z)*S,V[_]=(H-oe)*E,q[v]=0,q[b]=ae*Math.sign(V[b]),q[_]=ve*Math.sign(V[_]);for(let ye=0;ye<z;ye++){let pe=ye*I-D;V[v]=pe*A,c.push(V.x,V.y,V.z),h.push(q.x,q.y,q.z),d.push(ye/T),d.push(0),B+=1}}for(let K=0;K<a;K++)for(let le=0;le<T;le++){let Z=p+le+z*K,oe=p+le+z*(K+1),ae=p+(le+1)+z*(K+1),ve=p+(le+1)+z*K;u.push(Z,oe,ve),u.push(oe,ae,ve),j+=6}l.addGroup(f,j,L),f+=j,p+=B}function y(v,b,_){let A=new N,S=new N(t/2,e/2,i/2);S.subScalar(o);let E=[],M=v*b*_>0?(C,T,L)=>u.push(C,T,L):(C,T,L)=>u.push(C,L,T);for(let C=0;C<=a;C++){let T=[],L=BD*(1-C/a),I=Math.cos(L),D=Math.sin(L),F=0;for(let H=0;H<=C;H++){let z=Math.cos(F),B=Math.sin(F);A.x=I*z,A.y=D,A.z=I*B;let j=S.clone().addScaledVector(A,o);c.push(v*j.x,b*j.y,_*j.z),h.push(v*A.x,b*A.y,_*A.z),d.push(0,0),T.push(p++),F+=BD/C}E.push(T)}let R=E.length-1;for(let C=0;C<R;C++){let T=E[C],L=E[C+1],I=T.length-1;M(T[0],L[1],L[0]);for(let D=1;D<=I;D++)M(T[D-1],T[D],L[D]),M(T[D],L[D+1],L[D])}}}},fz=class extends Ht{constructor(t=[],e=[],i="",r=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];u(),c(),this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(l,3)),this.setAttribute("uv",new _t(a,2));return;function u(){var z;n=Math.min(1-1e-5,n),n==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new N,p=d.clone(),f=new Fs,m=n*r,g=r-m,y=s+1,v=new N,b=(B,j)=>v.subVectors(B,j).normalize(),_=(B,j)=>Array(B).fill(void 0).map(j),A=_(t.length/3,(B,j)=>new N().fromArray(t,j*3).setLength(r)),S=[],E=1e6;for(let B=0;B<A.length;B++){let j=A[B],V=[],q,K,le,Z=1e10,oe=-1;for(;(oe=e.indexOf(B,oe+1))!=-1;){let pe=oe-oe%3;q=e[pe+(oe+1)%3],K=e[pe+(oe+2)%3],le=j.distanceToSquared(A[q]),Z=Math.min(Z,le),V.push([q,K,le])}Z+=1e-6;let ae=[],ve=0,ye=V.length;for(let pe=0;pe<ye;pe++){[q,K,le]=V[ve];let Se=((z=S[q])==null?void 0:z.includes(B))==!0;le<=Z&&ae.push(q+ +Se*E),ve=V.findIndex(be=>be[0]==K)}S.push(ae)}let M=[];{let B=0,j=0,V,q,K=h==3;for(let le=0;le<=s;le++){V=le*(le+1)/2,q=(le+1)*(le+2)/2;for(let Z=0;Z<s-le;Z++)[B,j]=[V+Z+le+2,q+Z+le+3],M.push(V,q,...K?[j,V]:[B,q],j,B),[V,q]=[B,j];M.push(V,q,V+s+2)}}let R=d.clone(),C=d.clone(),T=d.clone(),L=d.clone(),I=d.clone(),D=[],F=_(A.length,()=>_(h,()=>d.clone()));for(let B=0;B<A.length;B++){d.copy(A[B]).normalize(),R.copy(d).multiplyScalar(g);let j=S[B];for(let ae=0;ae<j.length;ae++){let ve=j[ae],ye=j[(ae+1)%h];f.setFromPointsAndIndices(A,B,ve%E,ye%E),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(R,F[B][ae])}let V=[],q=[],K=[],le=new N;s==0&&[...F[B]].reduce((ae,ve)=>ae.add(ve),le).multiplyScalar(1/h);for(let ae=0;ae<h;ae++){let ve=[],ye=(ae-1+h)%h,pe=F[B][ye],Se=F[B][ae];d.copy(pe).sub(R),p.copy(Se).sub(R);let be=R.angleTo(d),ee=d.angleTo(p),_e=Math.cos(be)*m;s==0?C.copy(le):C.copy(R).setLength(g+_e),q.push(_e);let Me=[C,pe,Se];for(let Ce=0;Ce<2;Ce++){let Re=Me[Ce],Xe=Me[Ce+1];L.subVectors(Re,R),I.subVectors(Xe,R),T.crossVectors(L,I).normalize();for(let Oe=0;Oe<y;Oe++){let $=[be,ee][Ce]*Oe/y;d.copy(L).applyAxisAngle(T,$).add(R),V.push(d.clone()),Ce&&(b(d,R),ve.push([Oe==0?Re:d.clone(),v.clone()]))}Ce&&(b(Xe,R),ve.push([Xe,v.clone()]))}K.push(ve)}D.push(K);let Z=2*y,oe=2;for(let ae=0;ae<h;ae++){let ve=Z*ae,ye=Z*((ae+1)%h),pe=[V[ve]];for(let be=1;be<y;be++){L=V[ve+be],I=V[ye+be],pe.push(L);for(let ee=1,_e=be-oe+1;ee<=_e;ee++)d.lerpVectors(L,I,ee/(_e+1)),d.sub(R).setLength(q[ae]).add(R),pe.push(d.clone());pe.push(I)}for(let be=0;be<y;be++)pe.push(V[be+y+ve]);pe.push(V[ye+y]);let Se=M.map(be=>pe[be]);o.push(...Se.map(be=>[be.x,be.y,be.z]).flat()),l.push(...Se.map(be=>(b(be,R),[v.x,v.y,v.z])).flat())}}let H=[];for(let B=0;B<S.length;B++)for(let j=0;j<h;j++){let V=S[B][j];if(V<E){let q=S[V].findIndex(Z=>Z%E==B),K=D[B][j],le=D[V][q];for(let Z=0;Z<y;Z++){let oe=K[Z],ae=le[y-Z],ve=K[Z+1],ye=le[y-(Z+1)];[oe,ae,ve,ve,ae,ye].forEach(pe=>{o.push(pe[0].x,pe[0].y,pe[0].z),l.push(pe[1].x,pe[1].y,pe[1].z)})}H.push(K[0][0],le[y][0],K[y][0],le[0][0])}}for(;H.length;){let B,j,V,q;[B,j]=H.splice(0,2);let K=[B];for(;B!=j;)K.push(j),V=H.indexOf(j),q=V%2,j=H.splice(V-q,2)[1-q];v.subVectors(K[0],K[1]).cross(d.subVectors(K[0],K[2])).normalize();let le=v.dot(K[0])<0;le&&v.negate();for(let Z=1;Z<=K.length-2;Z++)[K[Z+ +le],K[Z+1-+le],K[0]].forEach(oe=>{o.push(oe.x,oe.y,oe.z),l.push(v.x,v.y,v.z)})}}function c(){let h=new N;for(let S=0;S<o.length;S+=3){h.x=o[S+0],h.y=o[S+1],h.z=o[S+2];let E=_(h)/2/Math.PI+.5,M=A(h)/Math.PI+.5;a.push(E,1-M)}let d=new N,p=new N,f=new N,m=new N,g=new me,y=new me,v=new me,b=(S,E,M,R)=>{R<0&&S.x===1&&(a[E]=S.x-1),M.x===0&&M.z===0&&(a[E]=R/2/Math.PI+.5)};for(let S=0,E=0;S<o.length;S+=9,E+=6){d.set(o[S+0],o[S+1],o[S+2]),p.set(o[S+3],o[S+4],o[S+5]),f.set(o[S+6],o[S+7],o[S+8]),g.set(a[E+0],a[E+1]),y.set(a[E+2],a[E+3]),v.set(a[E+4],a[E+5]),m.copy(d).add(p).add(f).divideScalar(3);let M=_(m);b(g,E+0,d,M),b(y,E+2,p,M),b(v,E+4,f,M)}for(let S=0;S<a.length;S+=6){let E=a[S+0],M=a[S+2],R=a[S+4],C=Math.max(E,M,R),T=Math.min(E,M,R);C>.9&&T<.1&&(E<.2&&(a[S+0]+=1),M<.2&&(a[S+2]+=1),R<.2&&(a[S+4]+=1))}function _(S){return Math.atan2(S.z,-S.x)}function A(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}}static fromJSON(t){return new fz(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},DCe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:r,detail:n,corner:s,cornerSides:o}=t.parameters,a=n===0&&s!==0?new L$(e*.5,s,o):new HQ(e*.5,n);return a.scale(1,i/e,r/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},L$=class extends fz{constructor(t=1,e=.2,i=4){let r=(1+Math.sqrt(5))/2,n=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,i),this.type=a}static fromJSON(t){return new L$(t.radius,t.corner,t.cornerSides)}},tx=1e-12,mz=class{constructor(t){this.position=new me,this.startPosition=new me,this.uuid=kt.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new mz(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},tO=class extends mz{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new tO(this.parent).copy(this)}},Rv=class extends mz{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new tO(this),new tO(this))}static create(t,e){let i=new Rv(t,new me(...e.position));return i.controls[0].position.set(...e.controlPrevious.position),i.controls[1].position.set(...e.controlNext.position),i.roundness=e.roundness,i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,i}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let i=0,r=this.controls.length;i<r;i++){let n=this.controls[i];this.position.distanceTo(n.position)<=e?n.position.copy(this.position):n.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new Rv(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,r;let t=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),e=(r=this.curveAfter)==null?void 0:r.getTangentAt(0);return[t,e]}computeNormals(t=new me,e=new me){let[i,r]=this.computeTangents();return i&&r&&(r9(i,t),r9(r,e)),[t,e]}computeTangent(t=new me){let[e,i]=this.computeTangents();return e&&i&&t.copy(e).add(i).normalize(),t}computeNormal(t=new me){let[e,i]=this.computeNormals();return t.copy(e).add(i).normalize(),t}};function r9(t,e=new me){let i=t.length();return e.set(-t.y/i,t.x/i)}var gz=t=>t,K0=new me,GP=new me,ICe=new me,LCe=new me,BCe=new me,OCe=new me,B$=new N,O$=new N;function UCe(t){let e=new me;e.addVectors(t.v0,K0.subVectors(t.v1,t.v0).multiplyScalar(2/3));let i=new me;return i.addVectors(t.v2,GP.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new gu(t.v0,e,i,t.v2)}function Hx(t,e,i=Number.EPSILON){return Math.abs(t-e)<i}function NCe(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function FCe(t,e,i=Number.EPSILON){return t.distanceTo(e)<i}function U$(t,e,i){let r=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),n=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2));return Math.acos((n*n+r*r-s*s)/(2*n*r))}function zCe(t,e,i){return s9(t,e)&&s9(e,i)&&iO(t.position,e.position,i.position)}function iO(t,e,i){return K0.copy(e).sub(t).cross(GP.copy(i).sub(t))===0}function HCe(t,e,i,r,n){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.y-e.y)/s,u=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return r.set(a+l,o+u),n.set(a-l,o-u),[r,n]}function GCe(t,e,i){let r=t.distanceTo(i),n=e.distanceTo(i);return r<n?e:t}function VCe(t,e,i,r,n,s){let o=e.x-t.x,a=e.y-t.y,l=i.x-t.x,u=i.y-t.y,c=Math.sqrt((o+l)*(o+l)+(a+u)*(a+u)),h;return U$(e,t,i)>Math.PI&&(c*=-1),Hx(u,a)?h=(a+u)*(r/c-.5)*8/3/(o-l):h=(o+l)*(r/c-.5)*8/3/(u-a),n.set(e.x-h*a,e.y+h*o),s.set(i.x+h*u,i.y-h*l),[n,s]}function n9(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function s9(t,e){return iO(t.position,t.controls[1].position,e.position)&&iO(t.position,e.controls[0].position,e.position)}function jCe(t,e,i,r,n=.5){let s=K0.subVectors(e,t).multiplyScalar(n).add(t),o=GP.subVectors(i,e).multiplyScalar(n).add(e),a=ICe.subVectors(r,i).multiplyScalar(n).add(i),l=s,u=LCe.subVectors(o,s).multiplyScalar(n).add(s),c=BCe.subVectors(a,o).multiplyScalar(n).add(o),h=a,d=OCe.subVectors(c,u).multiplyScalar(n).add(u);return[t.x,t.y,l.x,l.y,u.x,u.y,d.x,d.y,c.x,c.y,h.x,h.y,r.x,r.y]}function WCe(t,e,i=12,r=!0){let n=O$.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=gz(e[a]),u=K0,c=ym(l,i);for(let h=0;h<=c;h++)if(l instanceof gu||l instanceof Up||l instanceof _u){if(l.getPoint(h/c,u),n.set(u.x,u.y,0),s!==void 0&&FCe(s,n))continue;s===void 0&&(s=B$),s.copy(n),t.setXYZ(o,n.x,n.y,n.z),o++}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function qCe(t,e,i,r=12,n=!0){let s=O$.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(i[l]===!1)continue;let u,c=gz(e[l]),h=K0,d=ym(c,r);a.push(d);for(let p=0;p<=d;p++)if(c instanceof gu||c instanceof Up||c instanceof _u){if(c.getPoint(p/d,h),s.set(h.x,h.y,0),u==null?void 0:u.equals(s))continue;u===void 0?u=B$:(t.setXYZ(o,u.x,u.y,u.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),u.copy(s)}}return n&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function o9(t,e=12,i=!1){let r=[];for(let n=0,s=t.length;n<s;n++){let o=t[n],a=0;if(i&&o.roundedCurveCorner!==void 0){let l=ym(o.roundedCurveCorner,e)*.5;n>0&&(r[n-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=ym(o.curveAfter,e)),r.push(a)}return t.length>0&&i&&t[0].roundedCurveCorner!==void 0&&(r[t.length-1]+=ym(t[0].roundedCurveCorner,e)*.5),r}function ym(t,e=12){return t&&t instanceof MP?e*2:t&&(t instanceof _u||t instanceof NQ)?1:t&&t instanceof RF?e*t.points.length:e}function XCe(t,e,i=12,r=!0){let n,s=0;for(let o=0;o<e.length;o++){let a=gz(e[o]),l=ym(a,i),u=K0;for(let c=0;c<=l;c++)if(a instanceof gu||a instanceof Up||a instanceof _u){if(a.getPoint(c/l,u),n!==void 0&&NCe(n,u,tx))continue;n===void 0&&(n=GP),n.copy(u),t.push(u.x,u.y),s++}}return Hx(t[0],t[t.length-2],tx)&&Hx(t[1],t[t.length-1],tx)&&(t.pop(),t.pop()),r&&s>1&&!(Hx(t[s-1],t[1],tx)&&Hx(t[s-2],t[0],tx))&&(t.push(t[0],t[1]),s++),t}var OD=new me,YCe=new me,KCe=new me,JCe=new me,QCe=new me,ZCe=new me,hn=class extends YC{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Ba(new N(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=kt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,i){let r=new hn;return r.isClosed=t.isClosed,r.points=t.points.map(n=>Rv.create(n.id,n.data)),typeof t.roundness=="number"&&(r.roundness=t.roundness),r.shapeHoles=t.shapeHoles.map(n=>hn.createFromState(n)),e!==void 0&&i!==void 0&&r.applySize(e,i),r.update(),r}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,i=this.points.length;e<i;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,i=this.points.findIndex(r=>r.uuid===t);if(i<0){let r=e;for(let n=0,s=this.shapeHoles.length;n<s;n++){let o=this.shapeHoles[n],a=o.points.length,l=o.getPointIndexById(t);if(l<0)r+=a;else return l+r}}return i}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let i=0,r=this.shapeHoles.length;i<r;i++){let n=this.shapeHoles[i],s=t-e;if(s<=n.points.length-1)return n.points[s];e+=n.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let i=0,r=this.shapeHoles.length;i<r;i++){let n=this.shapeHoles[i],s=n.points.indexOf(t);if(s>=0)return e+s;e+=n.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let i=OD.set(t,e);for(let r=0,n=this.points.length;r<n;r++){let s=this.points[r];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let r=0,n=this.shapeHoles.length;r<n;r++)this.shapeHoles[r].applyScale(t,e);this._update()}createPoint(t,e=0,i=kt.generateUUID()){let r;t instanceof me?r=t:r=new me(t,e);let n=new Rv(i,r);return n.roundness=this.roundness,n}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,i=this.points.length;e<i;e++){let r=this.points[e];if(r.uuid===t)return r}for(let e=0,i=this.shapeHoles.length;e<i;e++){let r=this.shapeHoles[e].getPointByUuid(t);if(r)return r}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(i=>i.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,i=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let r=i?this.roundedCurveDivisions:this.curveDivisions;return WCe(t,i?this.roundedCurves:this.curves,e,this.autoClose),r.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=o9(this.points,t,!1),this.roundedCurveDivisions=o9(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,i=12){return qCe(t,this.curves,e,i,this.autoClose).reduce((r,n)=>r+n,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),XCe(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let r=e?this.roundedCurveDivisions:this.curveDivisions,n=0;e&&this.points[0].roundedCurveCorner!==void 0&&(n=ym(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-n;s<0&&(s+=r.reduce((o,a)=>o+a,0));for(let o=0,a=r.length;o<a;o++){let l=r[o];if(s<i+l)return[o,(s-i+1)/l];i+=l}return[0,1]}getCurveT(t,e,i){let r=this.points[t],n=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(n9(r,n)){let l=r.position.distanceTo(n.position);return r.position.distanceTo(OD.set(i.x,i.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){n9(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let i=this.curves[this.curves.length-1];t.curveBefore=i,e.curveAfter=i;let r=i.clone();t.roundedCurveBefore=r,e.roundedCurveAfter=r,t.roundedCurveCorner=void 0,this.roundedCurves.push(r)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,i=this.points.length;e<i;e++){let r=this.points[e];if(e===0)this.moveTo(r.position.x,r.position.y);else{let n=this.points[e-1];this._applyCurveForPoint(r,n)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(e,i)}if(this.points.length>2){let e=0;for(let i=0,r=this.points.length;i<r;i++){let n=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],o=this.points[i+1]??this.points[0],a=n.roundness,l=s&&o&&zCe(s,n,o);if(!n.controlsMoved()&&a>0&&!l){let u=n.curveBefore,c=n.curveAfter;if(u===void 0||c===void 0)continue;let h=n.roundedCurveBefore,d=n.roundedCurveAfter,p=u.getLength(),f=c.getLength(),m=Math.min(a,p*.499),g=Math.min(a,f*.499),y=Math.min(m,g),v=1-y/p,b=y/f,_=u.getPointAt(v,OD),A=c.getPointAt(b,YCe);this._subSplitCurve(u,h,v,_,void 0),this._subSplitCurve(c,d,b,void 0,A);let S;if(this.useCubicForRoundedCorners){let E=U$(_,n.position,A)/2,M=Math.tan(E)*_.distanceTo(n.position),[R,C]=HCe(_,A,M,KCe,JCe),T=GCe(R,C,n.position),[L,I]=VCe(T,_,A,M,QCe,ZCe);S=new gu(_.clone(),L.clone(),I.clone(),A.clone())}else S=new Up(_.clone(),n.position.clone(),A.clone());n.roundedCurveCorner=S,this.roundedCurves.splice(i+e,0,S),e++}}}}_subSplitCurve(t,e,i,r,n){if(t instanceof _u)r!==void 0&&e.v2.copy(r),n!==void 0&&e.v1.copy(n);else{let s=t,o=e,a=s.getUtoTmapping(i,0),l=jCe(s.v0,s.v1,s.v2,s.v3,a);return r!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),n!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new hn(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var i;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let r=0;r<e;r++){let n=r*7,s=t.points[n+0],o=t.points[n+1],a=t.points[n+2],l=t.points[n+3],u=t.points[n+4],c=t.points[n+5],h=t.points[n+6],d=new Rv(kt.generateUUID(),new me(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(u,c),d.roundness=h,this.points.push(d)}return this.shapeHoles=(i=t.shapeHoles)!=null&&i.length?t.shapeHoles.map(r=>{let n=new hn;return n.fromJSON(r),n}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t,e=!1){this.isText=e;let i=(n,s)=>{s instanceof gu&&s.v3.equals(n.position)&&n.controls[0].position.copy(s.v2)},r=n=>{let s=[],o,a;for(o=0,a=n.length;o<a;o++)n[o]instanceof Up&&(n[o]=UCe(n[o]));for(o=0,a=n.length;o<a;o++){let c=n[o],h=o>0?n[o-1]:null,d;c instanceof gu?(d=this.createPoint(c.v0),d.controls[1].position.copy(c.v1)):c instanceof _u&&(d=this.createPoint(c.v1)),d!==void 0&&(h!==null&&i(d,h),s.push(d))}let l=n[n.length-1],u=!1;return l instanceof gu?l.v3.equals(s[0].position)&&(s[0].controls[0].position.copy(l.v2),u=!0):l instanceof _u&&l.v2.equals(s[0].position)&&(u=!0),this.isClosed=u,s};return this.points=r(t.curves),t instanceof YC&&(this.shapeHoles=t.holes.map(n=>{let s=new hn;return s.fromShape(n),s})),this.update(),this}updatePoint(t,e){let i=this.getPointByUuid(t);i&&(e.position!==void 0&&i.position.fromArray(e.position),e.roundness!==void 0&&(i.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var r;let i=(r=this.getPointByUuid(t))==null?void 0:r.controls[0];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var r;let i=(r=this.getPointByUuid(t))==null?void 0:r.controls[1];i&&(e.position&&i.position.fromArray(e.position),this.needsUpdate=!0)}},rO=Math.PI*2;function UD({x:t,y:e},i,r,n,s){return{x:t*i+n,y:e*r+s}}function $Ce(t,e){let i=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=Math.cos(t),n=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:r-n*i,y:n+r*i},{x:s+o*i,y:o-s*i},{x:s,y:o}]}function a9(t,e,i,r){let n=t*r-e*i<0?-1:1,s=Math.min(1,Math.max(-1,t*i+e*r));return n*Math.acos(s)}function e2e(t,e,i,r,n,s,o,a,l,u){let c=Math.pow(n,2),h=Math.pow(s,2),d=Math.pow(o,2),p=Math.pow(a,2),f=c*h-c*p-h*d;f<0&&(f=0),f/=c*p+h*d,f=Math.sqrt(f)*(l===u?-1:1);let m=f*n/s*a,g=f*-s/n*o,y=m+(t+i)/2,v=g+(e+r)/2,b=(o-m)/n,_=(a-g)/s,A=(-o-m)/n,S=(-a-g)/s,E=a9(1,0,b,_),M=a9(b,_,A,S);return!u&&M>0&&(M-=rO),u&&M<0&&(M+=rO),{centerx:y,centery:v,ang1:E,ang2:M}}function t2e({px:t,py:e,cx:i,cy:r,rx:n,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(n===0||s===0)return[];let u=(t-i)/2,c=(e-r)/2;if(u===0&&c===0)return[];n=Math.abs(n),s=Math.abs(s);let h=Math.pow(u,2)/Math.pow(n,2)+Math.pow(c,2)/Math.pow(s,2);h>1&&(n*=Math.sqrt(h),s*=Math.sqrt(h));let d=e2e(t,e,i,r,n,s,u,c,o,a),{ang1:p,ang2:f}=d,{centerx:m,centery:g}=d,y=Math.abs(f)/(rO/4);Math.abs(1-y)<1e-7&&(y=1);let v=Math.max(Math.ceil(y),1);f/=v;for(let b=0;b<v;b++)l.push($Ce(p,f)),p+=f;return l.map(b=>{let{x:_,y:A}=UD(b[0],n,s,m,g),{x:S,y:E}=UD(b[1],n,s,m,g),{x:M,y:R}=UD(b[2],n,s,m,g);return{x1:_,y1:A,x2:S,y2:E,x:M,y:R}})}var ur;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(ur||(ur={}));var Nn;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Nn||(Nn={}));function Zt(t,e){if(!t)throw e||"Assertion Failed!"}var Wt=function(){function t(){}return t.vertEq=function(e,i){return e.s===i.s&&e.t===i.t},t.vertLeq=function(e,i){return e.s<i.s||e.s===i.s&&e.t<=i.t},t.transLeq=function(e,i){return e.t<i.t||e.t===i.t&&e.s<=i.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,i){return Math.abs(e.s-i.s)+Math.abs(e.t-i.t)},t.edgeEval=function(e,i,r){Zt(t.vertLeq(e,i)&&t.vertLeq(i,r));var n=i.s-e.s,s=r.s-i.s;return n+s>0?n<s?i.t-e.t+(e.t-r.t)*(n/(n+s)):i.t-r.t+(r.t-e.t)*(s/(n+s)):0},t.edgeSign=function(e,i,r){Zt(t.vertLeq(e,i)&&t.vertLeq(i,r));var n=i.s-e.s,s=r.s-i.s;return n+s>0?(i.t-r.t)*n+(i.t-e.t)*s:0},t.transEval=function(e,i,r){Zt(t.transLeq(e,i)&&t.transLeq(i,r));var n=i.t-e.t,s=r.t-i.t;return n+s>0?n<s?i.s-e.s+(e.s-r.s)*(n/(n+s)):i.s-r.s+(r.s-e.s)*(s/(n+s)):0},t.transSign=function(e,i,r){Zt(t.transLeq(e,i)&&t.transLeq(i,r));var n=i.t-e.t,s=r.t-i.t;return n+s>0?(i.s-r.s)*n+(i.s-e.s)*s:0},t.vertCCW=function(e,i,r){return e.s*(i.t-r.t)+i.s*(r.t-e.t)+r.s*(e.t-i.t)>=0},t.interpolate=function(e,i,r,n){return e=e<0?0:e,r=r<0?0:r,e<=r?r===0?(i+n)/2:i+(n-i)*(e/(e+r)):n+(i-n)*(r/(e+r))},t.intersect=function(e,i,r,n,s){var o,a,l;t.vertLeq(e,i)||(l=e,e=i,i=l),t.vertLeq(r,n)||(l=r,r=n,n=l),t.vertLeq(e,r)||(l=e,e=r,r=l,l=i,i=n,n=l),t.vertLeq(r,i)?t.vertLeq(i,n)?(o=t.edgeEval(e,r,i),a=t.edgeEval(r,i,n),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,r.s,a,i.s)):(o=t.edgeSign(e,r,i),a=-t.edgeSign(e,n,i),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,r.s,a,n.s)):s.s=(r.s+i.s)/2,t.transLeq(e,i)||(l=e,e=i,i=l),t.transLeq(r,n)||(l=r,r=n,n=l),t.transLeq(e,r)||(l=e,e=r,r=l,l=i,i=n,n=l),t.transLeq(r,i)?t.transLeq(i,n)?(o=t.transEval(e,r,i),a=t.transEval(r,i,n),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,r.t,a,i.t)):(o=t.transSign(e,r,i),a=-t.transSign(e,n,i),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,r.t,a,n.t)):s.t=(r.t+i.t)/2},t}(),ix=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),RA=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),zy=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),l9=function(){function t(){var e=new zy,i=new ix,r=new RA(0),n=new RA(1);e.next=e.prev=e,e.anEdge=null,i.next=i.prev=i,r.next=r,r.Sym=n,n.next=n,n.Sym=r,this.vHead=e,this.fHead=i,this.eHead=r,this.eHeadSym=n}return t.prototype.makeEdge_=function(e){var i=new RA(0),r=new RA(1);e.Sym.side<e.side&&(e=e.Sym);var n=e.Sym.next;return r.next=n,n.Sym.next=i,i.next=e,e.Sym.next=r,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i},t.prototype.splice_=function(e,i){var r=e.Onext,n=i.Onext;r.Sym.Lnext=i,n.Sym.Lnext=e,e.Onext=n,i.Onext=r},t.prototype.makeVertex_=function(e,i,r){var n=e;Zt(n,"Vertex can't be null!");var s=r.prev;n.prev=s,s.next=n,n.next=r,r.prev=n,n.anEdge=i;var o=i;do o.Org=n,o=o.Onext;while(o!==i)},t.prototype.makeFace_=function(e,i,r){var n=e;Zt(n,"Face can't be null");var s=r.prev;n.prev=s,s.next=n,n.next=r,r.prev=n,n.anEdge=i,n.trail=null,n.marked=!1,n.inside=r.inside;var o=i;do o.Lface=n,o=o.Lnext;while(o!==i)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var i=e.next,r=e.Sym.next;i.Sym.next=r,r.Sym.next=i},t.prototype.killVertex_=function(e,i){var r=e.anEdge,n=r;do n.Org=i,n=n.Onext;while(n!==r);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,i){var r=e.anEdge,n=r;do n.Lface=i,n=n.Lnext;while(n!==r);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new zy,i=new zy,r=new ix,n=this.makeEdge_(this.eHead);return this.makeVertex_(e,n,this.vHead),this.makeVertex_(i,n.Sym,this.vHead),this.makeFace_(r,n,this.fHead),n},t.prototype.splice=function(e,i){var r=!1,n=!1;if(e!==i){if(i.Org!==e.Org&&(n=!0,this.killVertex_(i.Org,e.Org)),i.Lface!==e.Lface&&(r=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(i,e),!n){var s=new zy;this.makeVertex_(s,i,e.Org),e.Org.anEdge=e}if(!r){var o=new ix;this.makeFace_(o,i,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var i=e.Sym,r=!1;if(e.Lface!==e.Rface&&(r=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!r){var n=new ix;this.makeFace_(n,e,e.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(e.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var i=this.makeEdge_(e),r=i.Sym;this.splice_(i,e.Lnext),i.Org=e.Dst;var n=new zy;return this.makeVertex_(n,r,i.Org),i.Lface=r.Lface=e.Lface,i},t.prototype.splitEdge=function(e){var i=this.addEdgeVertex(e),r=i.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,r),e.Dst=r.Org,r.Dst.anEdge=r.Sym,r.Rface=e.Rface,r.winding=e.winding,r.Sym.winding=e.Sym.winding,r.idx=e.idx,r.Sym.idx=e.Sym.idx,r},t.prototype.connect=function(e,i){var r=!1,n=this.makeEdge_(e),s=n.Sym;if(i.Lface!==e.Lface&&(r=!0,this.killFace_(i.Lface,e.Lface)),this.splice_(n,e.Lnext),this.splice_(s,i),n.Org=e.Dst,s.Org=i.Org,n.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!r){var o=new ix;this.makeFace_(o,n,e.Lface)}return n},t.prototype.zapFace=function(e){var i=e.anEdge,r,n,s,o,a;n=i.Lnext;do r=n,n=r.Lnext,r.Lface=null,r.Rface===null&&(r.Onext===r?this.killVertex_(r.Org,null):(r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),s=r.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(r));while(r!=i);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var i=e.anEdge,r=0;do r++,i=i.Lnext;while(i!==e.anEdge);return r},t.prototype.mergeConvexFaces=function(e){var i,r,n,s,o,a,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(r=i.anEdge,o=r.Org;n=r.Lnext,s=r.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&Wt.vertCCW(r.Lprev.Org,r.Org,s.Lnext.Lnext.Org)&&Wt.vertCCW(s.Lprev.Org,s.Org,r.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),r=null,s=null)),!(r&&r.Lnext.Org===o);)r=n;return!0},t.prototype.check=function(){var e=this.fHead,i=this.vHead,r=this.eHead,n,s,o,a,l,u;for(s=e,s=e;(n=s.next)!==e;s=n){Zt(n.prev===s),l=n.anEdge;do Zt(l.Sym!==l),Zt(l.Sym.Sym===l),Zt(l.Lnext.Onext.Sym===l),Zt(l.Onext.Sym.Lnext===l),Zt(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(Zt(n.prev===s&&n.anEdge===null),a=i,a=i;(o=a.next)!==i;a=o){Zt(o.prev===a),l=o.anEdge;do Zt(l.Sym!==l),Zt(l.Sym.Sym===l),Zt(l.Lnext.Onext.Sym===l),Zt(l.Onext.Sym.Lnext===l),Zt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Zt(o.prev===a&&o.anEdge===null),u=r,u=r;(l=u.next)!==r;u=l)Zt(l.Sym.next===u.Sym),Zt(l.Sym!==l),Zt(l.Sym.Sym===l),Zt(l.Org!==null),Zt(l.Dst!==null),Zt(l.Lnext.Onext.Sym===l),Zt(l.Onext.Sym.Lnext===l);Zt(l.Sym.next===u.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),u9=function(){function t(){this.handle=null}return t}(),h9=function(){function t(){this.key=null,this.node=0}return t}(),i2e=function(){function t(e,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var r=0;r<e+1;r++)this.nodes[r]=new u9,this.handles[r]=new h9;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var i=this.nodes,r=this.handles,n,s,o;for(n=i[e].handle;;){if(o=e<<1,o<this.size&&this.leq(r[i[o+1].handle].key,r[i[o].handle].key)&&++o,Zt(o<=this.max),s=i[o].handle,o>this.size||this.leq(r[n].key,r[s].key)){i[e].handle=n,r[n].node=e;break}i[e].handle=s,r[s].node=e,e=o}},t.prototype.floatUp_=function(e){var i=this.nodes,r=this.handles,n,s,o;for(n=i[e].handle;;){if(o=e>>1,s=i[o].handle,o===0||this.leq(r[s].key,r[n].key)){i[e].handle=n,r[n].node=e;break}i[e].handle=s,r[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var i,r;if(i=++this.size,i*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new u9;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new h9}return this.freeList===0?r=i:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[i].handle=r,this.handles[r].node=i,this.handles[r].key=e,this.initialized&&this.floatUp_(i),r},t.prototype.extractMin=function(){var e=this.nodes,i=this.handles,r=e[1].handle,n=i[r].key;return this.size>0&&(e[1].handle=e[this.size].handle,i[e[1].handle].node=1,i[r].key=null,i[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),n},t.prototype.delete=function(e){var i=this.nodes,r=this.handles,n;Zt(e>=1&&e<=this.max&&r[e].key!==null),n=r[e].node,i[n].handle=i[this.size].handle,r[i[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(r[i[n>>1].handle].key,r[i[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),r[e].key=null,r[e].node=this.freeList,this.freeList=e},t}(),ND=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),c9=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),r2e=function(){function t(e,i){this.frame=e,this.leq=i,this.head=new c9,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,e,i.key));return i},t.prototype.insertBefore=function(e,i){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,i));var r=new c9;return r.key=i,r.next=e.next,e.next.prev=r,r.prev=e,e.next=r,r},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),n2e=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.edgeLeq=function(e,i,r){var n=e.event,s=i.eUp,o=r.eUp;if(s.Dst===n)return o.Dst===n?Wt.vertLeq(s.Org,o.Org)?Wt.edgeSign(o.Dst,s.Org,o.Org)<=0:Wt.edgeSign(s.Dst,o.Org,s.Org)>=0:Wt.edgeSign(o.Dst,n,o.Org)<=0;if(o.Dst===n)return Wt.edgeSign(s.Dst,n,s.Org)>=0;var a=Wt.edgeEval(s.Dst,n,s.Org),l=Wt.edgeEval(o.Dst,n,o.Org);return a>=l},t.deleteRegion=function(e,i){i.fixUpperEdge&&Zt(i.eUp.winding===0),i.eUp.activeRegion=null,e.dict.delete(i.nodeUp)},t.fixUpperEdge=function(e,i,r){Zt(i.fixUpperEdge),e.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=r,r.activeRegion=i},t.topLeftRegion=function(e,i){var r=i.eUp.Org,n;do i=t.regionAbove(i);while(i.eUp.Org===r);if(i.fixUpperEdge){if(n=e.mesh.connect(t.regionBelow(i).eUp.Sym,i.eUp.Lnext),n===null)return null;t.fixUpperEdge(e,i,n),i=t.regionAbove(i)}return i},t.topRightRegion=function(e){var i=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===i);return e},t.addRegionBelow=function(e,i,r){var n=new ND;return n.eUp=r,n.nodeUp=e.dict.insertBefore(i.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,r.activeRegion=n,n},t.isWindingInside=function(e,i){switch(e.windingRule){case ur.ODD:return(i&1)!==0;case ur.NONZERO:return i!==0;case ur.POSITIVE:return i>0;case ur.NEGATIVE:return i<0;case ur.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,i){i.windingNumber=t.regionAbove(i).windingNumber+i.eUp.winding,i.inside=t.isWindingInside(e,i.windingNumber)},t.finishRegion=function(e,i){var r=i.eUp,n=r.Lface;n.inside=i.inside,n.anEdge=r,t.deleteRegion(e,i)},t.finishLeftRegions=function(e,i,r){for(var n,s=null,o=i,a=i.eUp;o!==r;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),n=s.eUp,n.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}n=e.mesh.connect(a.Lprev,n.Sym),t.fixUpperEdge(e,s,n)}a.Onext!==n&&(e.mesh.splice(n.Oprev,n),e.mesh.splice(a,n)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,i,r,n,s,o){var a,l,u,c,h=!0;u=r;do Zt(Wt.vertLeq(u.Org,u.Dst)),t.addRegionBelow(e,i,u.Sym),u=u.Onext;while(u!==n);for(s===null&&(s=t.regionBelow(i).eUp.Rprev),l=i,c=s;a=t.regionBelow(l),u=a.eUp.Sym,u.Org===c.Org;)u.Onext!==c&&(e.mesh.splice(u.Oprev,u),e.mesh.splice(c.Oprev,u)),a.windingNumber=l.windingNumber-u.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!h&&t.checkForRightSplice(e,l)&&(t.addWinding(u,c),t.deleteRegion(e,l),e.mesh.delete(c)),h=!1,l=a,c=u;l.dirty=!0,Zt(l.windingNumber-u.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,i,r){e.mesh.splice(i,r)},t.vertexWeights=function(e,i,r){var n=Wt.vertL1dist(i,e),s=Wt.vertL1dist(r,e),o=.5*s/(n+s),a=.5*n/(n+s);e.coords[0]+=o*i.coords[0]+a*r.coords[0],e.coords[1]+=o*i.coords[1]+a*r.coords[1],e.coords[2]+=o*i.coords[2]+a*r.coords[2]},t.getIntersectData=function(e,i,r,n,s,o){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,t.vertexWeights(i,r,n),t.vertexWeights(i,s,o)},t.checkForRightSplice=function(e,i){var r=t.regionBelow(i),n=i.eUp,s=r.eUp;if(Wt.vertLeq(n.Org,s.Org)){if(Wt.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;Wt.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(e.pq.delete(n.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,n)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(n,s.Oprev),i.dirty=r.dirty=!0)}else{if(Wt.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(n.Sym),e.mesh.splice(s.Oprev,n)}return!0},t.checkForLeftSplice=function(e,i){var r=t.regionBelow(i),n=i.eUp,s=r.eUp,o;if(Zt(!Wt.vertEq(n.Dst,s.Dst)),Wt.vertLeq(n.Dst,s.Dst)){if(Wt.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;t.regionAbove(i).dirty=i.dirty=!0,o=e.mesh.splitEdge(n),e.mesh.splice(s.Sym,o),o.Lface.inside=i.inside}else{if(Wt.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;i.dirty=r.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(n.Lnext,s.Sym),o.Rface.inside=i.inside}return!0},t.checkForIntersect=function(e,i){var r=t.regionBelow(i),n=i.eUp,s=r.eUp,o=n.Org,a=s.Org,l=n.Dst,u=s.Dst,c,h,d=new zy,p,f;if(Zt(!Wt.vertEq(u,l)),Zt(Wt.edgeSign(l,e.event,o)<=0),Zt(Wt.edgeSign(u,e.event,a)>=0),Zt(o!==e.event&&a!==e.event),Zt(!i.fixUpperEdge&&!r.fixUpperEdge),o===a||(c=Math.min(o.t,l.t),h=Math.max(a.t,u.t),c>h))return!1;if(Wt.vertLeq(o,a)){if(Wt.edgeSign(u,o,a)>0)return!1}else if(Wt.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),Wt.intersect(l,o,u,a,d),Zt(Math.min(o.t,l.t)<=d.t),Zt(d.t<=Math.max(a.t,u.t)),Zt(Math.min(u.s,l.s)<=d.s),Zt(d.s<=Math.max(a.s,o.s)),Wt.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),p=Wt.vertLeq(o,a)?o:a,Wt.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),Wt.vertEq(d,o)||Wt.vertEq(d,a)?(t.checkForRightSplice(e,i),!1):!Wt.vertEq(l,e.event)&&Wt.edgeSign(l,e.event,d)>=0||!Wt.vertEq(u,e.event)&&Wt.edgeSign(u,e.event,d)<=0?u===e.event?(e.mesh.splitEdge(n.Sym),e.mesh.splice(s.Sym,n),i=t.topLeftRegion(e,i),n=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),r),t.addRightEdges(e,i,n.Oprev,n,n,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(n.Lnext,s.Oprev),r=i,i=t.topRightRegion(i),f=t.regionBelow(i).eUp.Rprev,r.eUp=s.Oprev,s=t.finishLeftRegions(e,r,null),t.addRightEdges(e,i,s.Onext,n.Rprev,f,!0),!0):(Wt.edgeSign(l,e.event,d)>=0&&(t.regionAbove(i).dirty=i.dirty=!0,e.mesh.splitEdge(n.Sym),n.Org.s=e.event.s,n.Org.t=e.event.t),Wt.edgeSign(u,e.event,d)<=0&&(i.dirty=r.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(n.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=e.pq.insert(n.Org),t.getIntersectData(e,n.Org,o,l,a,u),t.regionAbove(i).dirty=i.dirty=r.dirty=!0,!1)},t.walkDirtyRegions=function(e,i){for(var r=t.regionBelow(i),n,s;;){for(;r.dirty;)i=r,r=t.regionBelow(r);if(!i.dirty&&(r=i,i=t.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,n=i.eUp,s=r.eUp,n.Dst!==s.Dst&&t.checkForLeftSplice(e,i)&&(r.fixUpperEdge?(t.deleteRegion(e,r),e.mesh.delete(s),r=t.regionBelow(i),s=r.eUp):i.fixUpperEdge&&(t.deleteRegion(e,i),e.mesh.delete(n),i=t.regionAbove(r),n=i.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!i.fixUpperEdge&&!r.fixUpperEdge&&(n.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,i))return}else t.checkForRightSplice(e,i);n.Org===s.Org&&n.Dst===s.Dst&&(t.addWinding(s,n),t.deleteRegion(e,i),e.mesh.delete(n),i=t.regionAbove(r))}},t.connectRightVertex=function(e,i,r){var n,s=r.Onext,o=t.regionBelow(i),a=i.eUp,l=o.eUp,u=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,i),Wt.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),i=t.topLeftRegion(e,i),s=t.regionBelow(i).eUp,t.finishLeftRegions(e,t.regionBelow(i),o),u=!0),Wt.vertEq(l.Org,e.event)&&(e.mesh.splice(r,l.Oprev),r=t.finishLeftRegions(e,o,null),u=!0),u){t.addRightEdges(e,i,r.Onext,s,s,!0);return}Wt.vertLeq(l.Org,a.Org)?n=l.Oprev:n=a,n=e.mesh.connect(r.Lprev,n),t.addRightEdges(e,i,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,i)},t.connectLeftDegenerate=function(e,i,r){var n,s,o,a,l;if(n=i.eUp,Wt.vertEq(n.Org,r)){Zt(!1),t.spliceMergeVertices(e,n,r.anEdge);return}if(!Wt.vertEq(n.Dst,r)){e.mesh.splitEdge(n.Sym),i.fixUpperEdge&&(e.mesh.delete(n.Onext),i.fixUpperEdge=!1),e.mesh.splice(r.anEdge,n),t.sweepEvent(e,r);return}Zt(!1),i=t.topRightRegion(i),l=t.regionBelow(i),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Zt(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(r.anEdge,o),Wt.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,i,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,i){var r,n,s,o,a,l,u=new ND;if(u.eUp=i.anEdge.Sym,r=e.dict.search(u).key,n=t.regionBelow(r),!!n){if(o=r.eUp,a=n.eUp,Wt.edgeSign(o.Dst,i,o.Org)===0){t.connectLeftDegenerate(e,r,i);return}if(s=Wt.vertLeq(a.Dst,o.Dst)?r:n,r.inside||s.fixUpperEdge){if(s===r)l=e.mesh.connect(i.anEdge.Sym,o.Lnext);else{var c=e.mesh.connect(a.Dnext,i.anEdge);l=c.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,r,l)),t.sweepEvent(e,i)}else t.addRightEdges(e,r,i.anEdge,i.anEdge,null,!0)}},t.sweepEvent=function(e,i){e.event=i,t.debugEvent(e);for(var r=i.anEdge;r.activeRegion===null;)if(r=r.Onext,r===i.anEdge){t.connectLeftVertex(e,i);return}var n=t.topLeftRegion(e,r.activeRegion);Zt(n!==null);var s=t.regionBelow(n),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,n,a):t.addRightEdges(e,n,a.Onext,o,o,!0)},t.addSentinel=function(e,i,r,n){var s=new ND,o=e.mesh.makeEdge();o.Org.s=r,o.Org.t=n,o.Dst.s=i,o.Dst.t=n,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new r2e(e,t.edgeLeq);var i=e.bmax[0]-e.bmin[0],r=e.bmax[1]-e.bmin[1],n=e.bmin[0]-i,s=e.bmax[0]+i,o=e.bmin[1]-r,a=e.bmax[1]+r;t.addSentinel(e,n,s,o),t.addSentinel(e,n,s,a)},t.doneEdgeDict=function(e){for(var i,r=0;(i=e.dict.min().key)!==null;)i.sentinel||(Zt(i.fixUpperEdge),Zt(++r===1)),Zt(i.windingNumber===0),t.deleteRegion(e,i)},t.removeDegenerateEdges=function(e){var i,r,n,s=e.mesh.eHead;for(i=s.next;i!==s;i=r)r=i.next,n=i.Lnext,Wt.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(t.spliceMergeVertices(e,n,i),e.mesh.delete(i),i=n,n=i.Lnext),n.Lnext===i&&(n!==i&&((n===r||n===r.Sym)&&(r=r.next),e.mesh.delete(n)),(i===r||i===r.Sym)&&(r=r.next),e.mesh.delete(i))},t.initPriorityQ=function(e){var i,r,n,s=0;for(n=e.mesh.vHead,r=n.next;r!==n;r=r.next)s++;for(s+=8,i=e.pq=new i2e(s,Wt.vertLeq),n=e.mesh.vHead,r=n.next;r!==n;r=r.next)r.pqHandle=i.insert(r);return r!==n?!1:(i.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,i){var r,n,s;for(r=i.fHead.next;r!==i.fHead;r=n)n=r.next,s=r.anEdge,Zt(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,i){i===void 0&&(i=!0);var r,n;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(r=e.pq.extractMin())!==null;){for(;n=e.pq.min(),!(n===null||!Wt.vertEq(n,r));)n=e.pq.extractMin(),t.spliceMergeVertices(e,r.anEdge,n.anEdge);t.sweepEvent(e,r)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(i&&e.mesh.check(),!0):!1},t}(),s2e=function(){function t(){this.mesh=new l9,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=ur.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,i){return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]},t.prototype.normalize_=function(e){var i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),e[0]/=i,e[1]/=i,e[2]/=i},t.prototype.longAxis_=function(e){var i=0;return Math.abs(e[1])>Math.abs(e[0])&&(i=1),Math.abs(e[2])>Math.abs(e[i])&&(i=2),i},t.prototype.computeNormal_=function(e){var i,r,n,s,o,a,l=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],f=[null,null,null],m=this.mesh.vHead;i=m.next;for(var g=0;g<3;++g)s=i.coords[g],u[g]=s,f[g]=i,l[g]=s,p[g]=i;for(i=m.next;i!==m;i=i.next)for(var y=0;y<3;++y)s=i.coords[y],s<u[y]&&(u[y]=s,f[y]=i),s>l[y]&&(l[y]=s,p[y]=i);var v=0;if(l[1]-u[1]>l[0]-u[0]&&(v=1),l[2]-u[2]>l[v]-u[v]&&(v=2),u[v]>=l[v]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,r=f[v],n=p[v],c[0]=r.coords[0]-n.coords[0],c[1]=r.coords[1]-n.coords[1],c[2]=r.coords[2]-n.coords[2],i=m.next;i!==m;i=i.next)h[0]=i.coords[0]-n.coords[0],h[1]=i.coords[1]-n.coords[1],h[2]=i.coords[2]-n.coords[2],d[0]=c[1]*h[2]-c[2]*h[1],d[1]=c[2]*h[0]-c[0]*h[2],d[2]=c[0]*h[1]-c[1]*h[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,e[0]=d[0],e[1]=d[1],e[2]=d[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(c)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,i,r=this.mesh.vHead,n,s=0,o=e.next;o!==e;o=o.next)if(n=o.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==o.anEdge);if(s<0){for(i=r.next;i!==r;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,i=[0,0,0],r,n,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),r=this.sUnit,n=this.tUnit;var o=this.longAxis_(i);r[o]=0,r[(o+1)%3]=1,r[(o+2)%3]=0,n[o]=0,n[(o+1)%3]=0,n[(o+2)%3]=i[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,r),a.t=this.dot_(a.coords,n);s&&this.checkOrientation_();for(var l=!0,u=e.next;u!==e;u=u.next)l?(this.bmin[0]=this.bmax[0]=u.s,this.bmin[1]=this.bmax[1]=u.t,l=!1):(u.s<this.bmin[0]&&(this.bmin[0]=u.s),u.s>this.bmax[0]&&(this.bmax[0]=u.s),u.t<this.bmin[1]&&(this.bmin[1]=u.t),u.t>this.bmax[1]&&(this.bmax[1]=u.t))},t.prototype.addWinding_=function(e,i){e.winding+=i.winding,e.Sym.winding+=i.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,i){var r,n;if(r=i.anEdge,!(r.Lnext!==r&&r.Lnext.Lnext!==r))throw"Mono region invalid";for(;Wt.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;Wt.vertLeq(r.Org,r.Dst);r=r.Lnext);n=r.Lprev;for(var s=void 0;r.Lnext!==n;)if(Wt.vertLeq(r.Dst,n.Org)){for(;n.Lnext!==r&&(Wt.edgeGoesLeft(n.Lnext)||Wt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=e.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==r&&(Wt.edgeGoesRight(r.Lprev)||Wt.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)s=e.connect(r,r.Lprev),r=s.Sym;r=r.Lnext}if(n.Lnext===r)throw"Mono region invalid";for(;n.Lnext.Lnext!==r;)s=e.connect(n.Lnext,n),n=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var i,r=e.fHead.next;r!==e.fHead;r=i)if(i=r.next,r.inside&&!this.tessellateMonoRegion_(e,r))return!1;return!0},t.prototype.discardExterior_=function(e){for(var i,r=e.fHead.next;r!==e.fHead;r=i)i=r.next,r.inside||e.zapFace(r)},t.prototype.setWindingNumber_=function(e,i,r){for(var n,s=e.eHead.next;s!==e.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:r?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,i,r,n){var s,o=0,a=0,l;r>3&&e.mergeConvexFaces(r);for(var u=e.vHead.next;u!==e.vHead;u=u.next)u.n=-1;for(var c=e.fHead.next;c!==e.fHead;c=c.next)if(c.n=-1,!!c.inside){s=c.anEdge,l=0;do{var u=s.Org;u.n===-1&&(u.n=a,a++),l++,s=s.Lnext}while(s!==c.anEdge);if(l>r)throw"Face vertex greater that support polygon";c.n=o,++o}this.elementCount=o,i===Nn.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*r,this.vertexCount=a,this.vertices=[],this.vertices.length=a*n,this.vertexIndices=[],this.vertexIndices.length=a;for(var u=e.vHead.next;u!==e.vHead;u=u.next)if(u.n!==-1){var h=u.n*n;this.vertices[h+0]=u.coords[0],this.vertices[h+1]=u.coords[1],n>2&&(this.vertices[h+2]=u.coords[2]),this.vertexIndices[u.n]=u.idx}for(var d=0,c=e.fHead.next;c!==e.fHead;c=c.next)if(c.inside){s=c.anEdge,l=0;do{var u=s.Org;this.elements[d++]=u.n,l++,s=s.Lnext}while(s!==c.anEdge);for(var p=l;p<r;++p)this.elements[d++]=-1;if(i===Nn.CONNECTED_POLYGONS){s=c.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==c.anEdge);for(var f=l;f<r;++f)this.elements[d++]=-1}}},t.prototype.outputContours_=function(e,i){var r,n,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){n=r=a.anEdge;do this.vertexCount++,r=r.Lnext;while(r!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,u=0,c=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,n=r=a.anEdge;do this.vertices[l++]=r.Org.coords[0],this.vertices[l++]=r.Org.coords[1],i>2&&(this.vertices[l++]=r.Org.coords[2]),this.vertexIndices[u++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,o++,r=r.Lnext;while(r!==n);this.elements[c++]=s,this.elements[c++]=o,s+=o}},t.prototype.addContour=function(e,i){this.mesh===null&&(this.mesh=new l9),e<2&&(e=2),e>3&&(e=3);for(var r=null,n=0;n<i.length;n+=e)r===null?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=i[n+0],r.Org.coords[1]=i[n+1],e>2?r.Org.coords[2]=i[n+2]:r.Org.coords[2]=0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},t.prototype.tesselate=function(e,i,r,n,s,o){if(e===void 0&&(e=ur.ODD),i===void 0&&(i=Nn.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),n2e.computeInterior(this,o);var a=this.mesh;return i===Nn.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),i===Nn.BOUNDARY_CONTOURS?this.outputContours_(a,n):this.outputPolymesh_(a,i,r,n),!0},t}();function mp(t){var e=t.windingRule,i=e===void 0?ur.ODD:e,r=t.elementType,n=r===void 0?Nn.POLYGONS:r,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,u=t.normal,c=u===void 0?[0,0,1]:u,h=t.contours,d=h===void 0?[]:h,p=t.strict,f=p===void 0?!0:p,m=t.debug,g=m===void 0?!1:m;if(!d&&f)throw new Error("Contours can't be empty");if(d){var y=new s2e;t.edgeCreateCallback&&(y.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(y.vertexIdCallback=t.vertexIdCallback);for(var v=0;v<d.length;v++)y.addContour(l||2,d[v]);return y.tesselate(i,n,o,l,c,f),{vertices:y.vertices,vertexIndices:y.vertexIndices,vertexCount:y.vertexCount,elements:y.elements,elementCount:y.elementCount,mesh:g?y.mesh:void 0}}}ur.ODD;ur.NONZERO;ur.POSITIVE;ur.NEGATIVE;ur.ABS_GEQ_TWO;Nn.POLYGONS;Nn.CONNECTED_POLYGONS;Nn.BOUNDARY_CONTOURS;var nO=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let i=t*nO.eSize;this.buffer=new ArrayBuffer(i);let r=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*r,3*t),n+=3*t,this.normals=new Float32Array(this.buffer,n*r,3*t),n+=3*t,this.uvs=new Float32Array(this.buffer,n*r,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let i=t*nO.eSize,r=new ArrayBuffer(i),n=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(r,s*n,3*t);s+=3*t;let a=new Float32Array(r,s*n,3*t);s+=3*t;let l=new Float32Array(r,s*n,2*t);e?(o.set(this.positions.subarray(0,this.size*3)),a.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(o.set(this.positions),a.set(this.normals),l.set(this.uvs)),this.buffer=r,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let r=this.capacity;for(;e>r;)r*=2;this.realloc(r)}let i=this.size;return this.size=e,i}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},N$=nO;N$.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var o2e=qn(dce()),yz={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},F$={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},z$={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},FD=(t,e)=>([i,r])=>(r<i&&(r+=e),(t>=i?t:t+e)<=r),vz=class extends Ht{constructor(t,e,i=0,r=12,n=3,s=ur.ODD,o=!1){super(),this.forPathBevel=o,this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._curveSegments=r,this._bevelSegmentsInput=n;let a=this._shape.extractShapePointsToFlatArray([],r),l=this._shape.shapeHoles.map(R=>{let C=R.extractShapePointsToFlatArray([],r),T=[];for(let L=C.length-1;L>=1;L-=2){let I=C[L-1],D=C[L-0];T.push(I,D)}return T}),u=[],c=[];for(let R=0;R<a.length;R+=2)c.push([a[R],a[R+1]]);u.push(c);for(let R=0;R<l.length;R++){let C=l[R],T=[];for(let L=0;L<C.length;L+=2)T.push([C[L],C[L+1]]);u.push(T)}let h;t.isText?h=new rZ().setFromPoints(t.points.map(R=>R.position)).getSize(new me).length()*.1:u[0].length===0?h=i:h=(0,o2e.default)(u).distance,i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,h,e/2),this._bevelSegments=Math.floor(n));let d;try{d=mp({windingRule:s,elementType:Nn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[a]})}catch{d=yz}let p;try{p=mp({windingRule:ur.ODD,elementType:Nn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=F$}if(!d)throw new Error("error generating geometry");let f=d.elementCount;if(p){d.elementCount+=p.elementCount;for(let R=0;R<p.elements.length;R++){let C=p.elements[R],T=R%2===0?d.vertexCount:0;d.elements.push(C+T)}for(let R=0;R<p.vertexIndices.length;R++){let C=p.vertexIndices[R],T=d.vertexCount;d.vertexIndices.push(C+T)}for(let R=0;R<p.vertices.length;R++){let C=p.vertices[R];d.vertices.push(C)}}let m=1/0,g=-1/0,y=1/0,v=-1/0;for(let R=0,C=d.vertexCount;R<C;R++){let T=R*2,L=d.vertices[T+0],I=d.vertices[T+1];L<m&&(m=L),L>g&&(g=L),I<y&&(y=I),I>v&&(v=I)}this._minX=m,this._minY=y,this._width=g-m,this._height=v-y,this._buffer=new N$(this._computeBufferEstimatedSize(d));let b=[],_=[];for(let R=d.elementCount-1;R>=0;R--){let C=R>=f,T=R*2,L=d.elements[T+0],I=d.elements[T+1],D=L+I,F={start:L,count:I,normals:[],continuous:[],concave:[]},H=L,z=D-1,B=L+1,j=this._shape.roundedCurves.length;do{let Z=H-L,oe=d.vertices[z*2+0],ae=d.vertices[z*2+1],ve=d.vertices[H*2+0],ye=d.vertices[H*2+1],pe=d.vertices[B*2+0],Se=d.vertices[B*2+1],be=ve-oe,ee=ye-ae,_e=Math.sqrt(be*be+ee*ee);be/=_e,ee/=_e;let Me=ve-pe,Ce=ye-Se,Re=Math.sqrt(Me*Me+Ce*Ce);Me/=Re,Ce/=Re,F.normals[Z*2+0]=-Ce,F.normals[Z*2+1]=Me,F.concave[Z]=be*Ce-ee*Me>0;let Xe=d.vertexIndices[H];if(Array.isArray(Xe))F.continuous[Z]=!1;else{let[Oe,$]=this._shape.getCurveIndexFromVertexId(Xe-1,!0);if($>0&&$<1)F.continuous[Z]=!0;else{let J=$===1?Oe+1:Oe-1;J=(J+j)%j;let we=$===1?0:1,te=this._shape.roundedCurves[Oe].getTangent($),Y=this._shape.roundedCurves[J].getTangent(we);F.continuous[Z]=te.dot(Y)>.95}}C&&(F.normals[Z*2+0]*=-1,F.normals[Z*2+1]*=-1),[z,H,B]=[H,B,B+1],B>=D&&(B-=I)}while(B!==L+1);let V=[];V.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(L*2,D*2),vertexCount:I,vertexIndices:new Array(I).fill(!0).map((Z,oe)=>[oe,oe]),elements:[0,I],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(L*2,D*2)});let q=0;for(let Z=1;Z<=this._bevelSegments;Z++){let oe=Z/this._bevelSegments*Math.PI/2,ae=(1-Math.cos(oe))*this._bevel,ve=[],ye=[],pe=0;for(let be=0;be<I;be++){let ee=be*2,_e=(be-1+I)%I*2,Me=d.vertices[F.start*2+ee+0],Ce=d.vertices[F.start*2+ee+1],Re=-F.normals[_e+0]*ae,Xe=-F.normals[_e+1]*ae,Oe=-F.normals[ee+0]*ae,$=-F.normals[ee+1]*ae;if(F.concave[be]||!F.concave[be]&&C){let J=Math.atan2(Xe,Re),we=Math.atan2($,Oe);we>J&&(we-=Math.PI*2);let te=we-J;if(F.continuous[be]||C){let Y=J+te/2,ce=Math.cos(Y)*ae,Le=Math.sin(Y)*ae;ve[2*pe+0]=Me+ce*(C?-1:1),ve[2*pe+1]=Ce+Le*(C?-1:1),ye[pe]=be,pe++}else{let Y=Math.max(1,Math.floor(r/4*Math.abs(te)/Math.PI));for(let ce=0;ce<=Y;ce++){let Le=J+te*(ce/Y),X=Math.cos(Le)*ae,Ue=Math.sin(Le)*ae;ve[2*pe+0]=Me+X,ve[2*pe+1]=Ce+Ue,ye[pe]=be,pe++}}}else ve[2*pe+0]=Me+Re,ve[2*pe+1]=Ce+Xe,ye[pe]=be,pe++,ve[2*pe+0]=Me,ve[2*pe+1]=Ce,ye[pe]=be,pe++,ve[2*pe+0]=Me+Oe,ve[2*pe+1]=Ce+$,ye[pe]=be,pe++}let Se=mp({windingRule:ur.POSITIVE,elementType:Nn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ve],edgeCreateCallback:be=>{let ee=be.Org.idx,_e=ye[ee],Me=ye[(ee+1)%ye.length];be.idx=[_e,Me],be.Sym.idx=[Me,_e]},vertexIdCallback:be=>{let ee=be.Lprev.idx;return[ee?ee[1]:0,be.idx?be.idx[0]:0]}});if(!Se)throw console.log("Error"),new Error(`error generating bevel geometry for ${Z}'th loop`);if(!Se.vertexCount){let be=(Z-1)/this._bevelSegments*Math.PI/2;q=(1-Math.sin(be))*this._bevel;break}for(let be=0;be<Se.vertexIndices.length;be++){let[ee,_e]=Se.vertexIndices[be];if(ee===_e)continue;let Me=_e;_e<ee&&(Me+=I);for(let Ce=ee;Ce<Me;Ce++){let Re=Ce%I,Xe=(Ce+1)%I;if(!F.continuous[Re]||!F.continuous[Xe]){Se.vertexIndices[be]=[ee,Re],Se.vertexIndices.splice(be+1,0,[Xe,_e]),Se.vertices.splice((be+1)*2,0,Se.vertices[be*2],Se.vertices[be*2+1]);break}}}V.push({bevelI:Z,angle:oe,size:ae,boundary:Se,reverseMap:ye,insetPoints:ve})}let K=(Z,oe,ae)=>{let ve=0,ye=Z.boundary.vertexIndices.length;for(;ve<ye&&ae(Z.boundary.vertexIndices[oe]);)oe=(oe+1)%ye,ve++;return ve},le=b.length;for(let Z=1;Z<V.length;Z++){let oe=V[Z-1],ae=V[Z],ve=oe.boundary.vertexIndices.length,ye=ae.boundary.vertexIndices.length;if(!ve||!ye)break;let pe=F.concave.length,Se=0,be=FD(Se,I);for(;!oe.boundary.vertexIndices.filter(be).length||!ae.boundary.vertexIndices.filter(be).length;)Se++,be=FD(Se,I);let ee=oe.boundary.vertexIndices.findIndex(be),_e=ae.boundary.vertexIndices.findIndex(be);do ee=(ee+1)%ve;while(be(oe.boundary.vertexIndices[ee]));do _e=(_e+1)%ye;while(be(ae.boundary.vertexIndices[_e]));Se=(Se+1)%I;let Me=Se,Ce=0,Re=this._buildBevelVert(F,oe,(ee-1+ve)%ve,void 0,Ce),Xe=this._buildBevelVert(F,ae,(_e-1+ye)%ye,void 0,Ce),Oe=Re,$=Xe,J,we,te=!1;do{Ce=(Se||pe)/pe,be=FD(Se,I);let Y=K(oe,ee,be),ce=K(ae,_e,be),Le=te;if(te=!1,Y&&!ce){for(let X=0;X<Y;X++)J=this._buildBevelVert(F,oe,(ee+X)%ve,X/(Y-1),Ce),b.push(Oe.topN,J.topP,$.topN),o===!1&&b.push(J.bottomP,Oe.bottomN,$.bottomN),Oe=J;te=!0}else if(!Y&&ce)for(let X=0;X<ce;X++)we=this._buildBevelVert(F,ae,(_e+X)%ye,X/(ce-1),Ce),b.push($.topN,Oe.topP,we.topP),o===!1&&b.push(Oe.bottomP,$.bottomN,we.bottomP),$=we;else if(Y&&ce)if(J=this._buildBevelVert(F,oe,ee,0,Ce),we=this._buildBevelVert(F,ae,_e,0,Ce),Le?(b.push(Oe.topN,we.topP,$.topN),b.push(Oe.topN,J.topP,we.topP),o===!1&&(b.push(we.bottomP,Oe.bottomN,$.bottomN),b.push(we.bottomP,J.bottomP,Oe.bottomN))):(b.push($.topN,Oe.topN,J.topP),b.push($.topN,J.topP,we.topP),o===!1&&(b.push(J.bottomP,Oe.bottomN,$.bottomN),b.push(J.bottomP,$.bottomN,we.bottomP))),Oe=J,$=we,Y===ce)for(let X=1;X<Y;X++)J=this._buildBevelVert(F,oe,(ee+X)%ve,X/(Y-1),Ce),we=this._buildBevelVert(F,ae,(_e+X)%ye,X/(ce-1),Ce),b.push(Oe.topN,J.topP,$.topN),b.push($.topN,J.topP,we.topP),o===!1&&(b.push(J.bottomP,Oe.bottomN,$.bottomN),b.push(J.bottomP,$.bottomN,we.bottomP)),Oe=J,$=we;else if(Y>ce){let X=Y/ce,Ue=0;for(let et=1;et<Y;et++)J=this._buildBevelVert(F,oe,(ee+et)%ve,et/(Y-1),Ce),b.push(Oe.topN,J.topP,$.topN),o===!1&&b.push(J.bottomP,Oe.bottomN,$.bottomN),Oe=J,et>(Ue+1)*X&&(Ue++,we=this._buildBevelVert(F,ae,(_e+Ue)%ye,Ue/(ce-1),Ce),b.push($.topN,J.topP,we.topP),o===!1&&b.push(J.bottomP,$.bottomN,we.bottomP),$=we)}else{let X=ce/Y,Ue=0;for(let et=1;et<ce;et++)we=this._buildBevelVert(F,ae,(_e+et)%ye,et/(ce-1),Ce),b.push($.topN,J.topP,we.topP),o===!1&&b.push(J.bottomP,$.bottomN,we.bottomP),$=we,et>(Ue+1)*X&&(Ue++,J=this._buildBevelVert(F,oe,(ee+Ue)%ve,Ue/(Y-1),Ce),b.push(Oe.topN,J.topP,$.topN),o===!1&&b.push(J.bottomP,Oe.bottomN,$.bottomN),Oe=J)}ee=(ee+Y)%ve,_e=(_e+ce)%ye,Se=(Se+1)%pe}while(Se!==Me)}if(o===!1&&this._depth>this._bevel*2&&this._buildWall(V,F,b),C){let Z=[];for(let oe=b.length-1;oe>=le+2;oe-=3){let ae=b[oe-2],ve=b[oe-1],ye=b[oe-0];Z.push(ye,ve,ae)}b.splice(le,b.length-le,...Z)}if(C){let Z=[];for(let oe=V[V.length-1].boundary.vertices.length-1;oe>=1;oe-=2){let ae=V[V.length-1].boundary.vertices[oe-1],ve=V[V.length-1].boundary.vertices[oe-0];Z.push(ae,ve)}_.push(Z)}if(!C){let Z=V[V.length-1],oe;try{oe=mp({windingRule:V.length>1?ur.POSITIVE:ur.ODD,elementType:Nn.POLYGONS,vertexSize:2,strict:!0,contours:[Z.insetPoints,..._]})}catch{oe=z$}if(!oe)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ae=0;ae<oe.elementCount*3;ae+=3){let ve=this._buildSurfaceVert(oe,oe.elements[ae+0],q),ye=this._buildSurfaceVert(oe,oe.elements[ae+1],q),pe=this._buildSurfaceVert(oe,oe.elements[ae+2],q);b.push(ve.top,ye.top,pe.top),o===!1&&b.push(pe.bottom,ye.bottom,ve.bottom)}}this.vertexCache={}}this._buffer.shrink();let A=new ei(Uint32Array.from(b),1),S=new ei(this._buffer.positions,3),E=new ei(this._buffer.normals,3),M=new ei(this._buffer.uvs,2);S.needsUpdate=!0,E.needsUpdate=!0,M.needsUpdate=!0,A.needsUpdate=!0,this.setAttribute("position",S),this.setAttribute("normal",E),this.setAttribute("uv",M),this.setIndex(A)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let r=t[0];for(let n=0,s=r.boundary.vertexCount;n<s;n++){let o=this._buildBevelVert(e,r,n),a=this._buildBevelVert(e,r,(n+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e,i){let r=e.toString();if(r in this.vertexCache)return this.vertexCache[r];let n=t.vertices[e*2+0],s=t.vertices[e*2+1],o=(n-this._minX)/this._width,a=(s-this._minY)/this._height;this.forPathBevel&&(a=1);let l=this._buffer.get(this.forPathBevel?1:2),u=l*3,c=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[u+0]=n,this._buffer.positions[u+1]=s,this._buffer.positions[u+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[u+0]=0,this._buffer.normals[u+1]=0,this._buffer.normals[u+2]=1,this._buffer.uvs[c+0]=o,this._buffer.uvs[c+1]=a,this.forPathBevel===!1&&(this._buffer.positions[u+3]=n,this._buffer.positions[u+4]=s,this._buffer.positions[u+5]=i,this._buffer.normals[u+3]=0,this._buffer.normals[u+4]=0,this._buffer.normals[u+5]=-1,this._buffer.uvs[c+2]=o,this._buffer.uvs[c+3]=a),this.vertexCache[r]=h,h}_buildBevelVert(t,e,i,r=1,n){let s=`${e.bevelI}:${i}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[o,a]=e.boundary.vertexIndices[i],l,u,c,h;o!==a?(u=o,l=a,h=!1,c=t.continuous[u]&&t.continuous[l]):(l=o,u=(l-1+t.count)%t.count,h=t.concave[l]&&e.bevelI>0,c=t.continuous[l]||h);let d=Math.cos(e.angle),p=Math.sin(e.angle),f=i*2,m=l*2,g=u*2,y=e.boundary.vertices[f+0],v=e.boundary.vertices[f+1],b=(1-p)*this._bevel,_=(y-this._minX)/this._width,A=(v-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(_=n),A=1);let S=t.normals[m+0],E=t.normals[m+1],M=t.normals[g+0],R=t.normals[g+1];if(h){let D=M-S,F=R-E;S=S+D*(1-r),E=E+F*(1-r);let H=Math.sqrt(S*S+E*E);S/=H,E/=H}let C=this.forPathBevel?this._buffer.get(c?1:2):this._buffer.get(c?2:4),T=C*3,L=C*2,I={i,fi:l,topP:C+0,topN:C+0,bottomP:C+1,bottomN:C+1,pathBevelUCoord:n};return this._buffer.positions[T+0]=y,this._buffer.positions[T+1]=v,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[T+0]=S*d,this._buffer.normals[T+1]=E*d,this._buffer.normals[T+2]=p,this._buffer.uvs[L+0]=_,this._buffer.uvs[L+1]=A,this.forPathBevel===!1&&(this._buffer.positions[T+3]=y,this._buffer.positions[T+4]=v,this._buffer.positions[T+5]=b,this._buffer.normals[T+3]=S*d,this._buffer.normals[T+4]=E*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[L+2]=A,this._buffer.uvs[L+3]=_),c||(this.forPathBevel?(C+=1,T+=3,L+=2):(C+=2,T+=6,L+=4),I.topP=C+0,I.bottomP=C+1,this._buffer.positions[T+0]=y,this._buffer.positions[T+1]=v,this._buffer.positions[T+2]=(this.forPathBevel?this._bevel:this._depth)-b,this._buffer.normals[T+0]=M*d,this._buffer.normals[T+1]=R*d,this._buffer.normals[T+2]=p,this._buffer.uvs[L+0]=_,this._buffer.uvs[L+1]=A,this.forPathBevel===!1&&(this._buffer.positions[T+3]=y,this._buffer.positions[T+4]=v,this._buffer.positions[T+5]=b,this._buffer.normals[T+3]=M*d,this._buffer.normals[T+4]=R*d,this._buffer.normals[T+5]=-p,this._buffer.uvs[L+2]=A,this._buffer.uvs[L+3]=_)),this.vertexCache[s]=I,I}clone(){let t=new vz(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=BP(this.userData),t}},H$=class extends Ht{constructor(t,e=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=ur.ODD,this.elementType=Nn.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:ur.ODD,elementType:Nn.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let r=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,u;for(let d=0,p=r.length/2;d<p;d++){let f=d*2,m=r[f+0],g=r[f+1];if(l!==void 0&&m!==l&&(o=!1),u!==void 0&&g!==u&&(a=!1),l=m,u=g,!o&&!a)break}if(!o&&!a)try{s=mp({contours:[r,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=yz}let c=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new ei(new Float32Array(c*3),3),this._normalAttribute=new ei(new Float32Array(c*3),3),this._uvAttribute=new ei(new Float32Array(c*2),2),this._indexAttribute=new ei(new Uint32Array(h*3),1),s){let d=1/0,p=-1/0,f=1/0,m=-1/0;for(let v=0,b=c;v<b;v++){let _=v*2,A=s.vertices[_+0],S=s.vertices[_+1];A<d&&(d=A),A>p&&(p=A),S<f&&(f=S),S>m&&(m=S)}let g=p-d,y=m-f;for(let v=0,b=c;v<b;v++){let _=v*2,A=s.vertices[_+0],S=s.vertices[_+1],E=(A-d)/g,M=(S-f)/y;this._positionAttribute.setXYZ(v,A,S,0),this._normalAttribute.setXYZ(v,0,0,1),this._uvAttribute.setXY(v,E,M)}for(let v=0,b=h;v<b;v++){let _=v*3,A=s.elements[_+0],S=s.elements[_+1],E=s.elements[_+2];this._indexAttribute.setX(_+0,A),this._indexAttribute.setX(_+1,S),this._indexAttribute.setX(_+2,E)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new H$(this._shape,this._curveSegments);return t.userData=BP(this.userData),t}},G$=class extends vz{constructor(t,e,i=0,r=12,n=3,s=ur.ODD){super(t,e,i,r,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,i){let r=t[0];for(let n=0,s=r.boundary.vertexCount;n<s;n++){let o=this._buildBevelVert(e,r,n),a=this._buildBevelVert(e,r,(n+1)%s);i.push(a.topP,o.topN,o.bottomN),i.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new G$(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=BP(this.userData),t}},tg=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var u,c;let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:ur.ODD},t.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??i.roundness;o!==void 0&&(o instanceof hn?(o.width!==r||o.height!==n)&&o.applySize(r,n):o=new hn(r,n).fromJSON(o),((u=t.parameters)==null?void 0:u.roundness)!==void 0&&((c=t.parameters)==null?void 0:c.roundness)>0&&o.update());let l=o??new hn(r,n);return{parameters:Object.assign(i,{width:r,height:n,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:i,extrudeBevelSegments:r,subdivisions:n,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new H$(t.shape,n,{windingRule:o}):a=new G$(t.shape,e,i,n,r,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},V$=Math.PI*2,bz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return i.angle=kt.clamp(i.angle,0,360),{shape:t.shape&&t.shape instanceof hn?t.shape:new hn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:r,angle:n,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u=t.shape,c=e*.5,h=i*.5,d=a2e(u,c,h,n*Math.PI/180,r,s);u.isClosed=!0,u.update();let p;return n===0?(p=new Ht,p.setAttribute("position",new _t([],3))):p=tg.create({shape:u,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}}),Object.assign(p,{userData:{...t,type:"EllipseGeometry"}})}};function a2e(t,e,i,r,n,s){if(r>=V$)return n>30||n%4===0?(u2e(t,e,i,s),Math.round(n/4)):d9(t,r,n,e,i,s);r=Math.max(r,.001);let o={x:0,y:i},a=r+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*i},u=t2e({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:i,largeArcFlag:r>Math.PI,sweepFlag:!0});return n>30||n%u.length===0?l2e(t,o.x,o.y,u,n,e,i,s):d9(t,r,n,e,i,s)}function l2e(t,e,i,r,n,s,o,a){let l=Math.round(n/r.length);t.addPoint(kv(e,i));for(let u=0,c=r.length;u<c;u++){let h=r[u],d=t.points[u],p=kv(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),p.controls[0].position.set(h.x2,h.y2),t.addPoint(p)}return a>0?j$(t,s,o,a):t.addPoint(kv(0,0)),l}function d9(t,e,i,r,n,s){let o=-e/i;for(let a=0;a<=i;a++){let l=o*a,u=Math.sin(l)*r,c=Math.cos(l)*n;t.addPoint(kv(u,c))}return e<V$?s>0?j$(t,r,n,s):t.addPoint(kv(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&W$(t,r,n,s)),1}function u2e(t,e,i,r=0,n=0,s=0){let o=.5522847498,a=e*o,l=i*o;t.addPoint(kA(n-e,s,n-e,s-l,n-e,s+l)),t.addPoint(kA(n,s+i,n-a,s+i,n+a,s+i)),t.addPoint(kA(n+e,s,n+e,s+l,n+e,s-l)),t.addPoint(kA(n,s-i,n+a,s-i,n-a,s-i)),r>0&&W$(t,e,i,r)}function kv(t,e){return new Rv(kt.generateUUID(),new me(t,e))}function kA(t,e,i,r,n,s){let o=kv(t,e);return o.controls[0].position.set(i,r),o.controls[1].position.set(n,s),o}function j$(t,e,i,r){q$(t,e,i,r).forEach(n=>t.addPoint(n))}function W$(t,e,i,r){let n=q$(t,e,i,r),s=new hn;n.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function q$(t,e,i,r){let n=r*e/100,s=n*(Math.abs(i)/Math.abs(e)),o=new me(n/e,s/i),a=t.points.map(l=>{let u=l.clone();return u.uuid=kt.generateUUID(),u}).reverse();return a.forEach(l=>{l.position.multiply(o);let u=l.controls[0].position.clone().multiply(o),c=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(c),l.controls[1].position.copy(u)}),a}var h2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),r=Math.abs(i.width),n=Math.abs(i.height??r),s=Math.abs(i.depth??r),o=Math.abs(Math.min(r,s))/2;return{parameters:Object.assign(i,{width:r,height:n,depth:s,radius:o,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(t){let{width:e,height:i,depth:r,radius:n,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:u,cornerRadius:c,cornerSegments:h}=t.parameters,d=new X$(!1,e,i,r,n,s,o,a,l,u,c,h);return Object.assign(d,{userData:{...t,type:"HelixGeometry"}})}},zD=new Sv([0,0,0],1),X$=class extends Ht{constructor(t=!0,e=1,i=1,r=1,n=1,s=1,o=1,a=1,l=1,u=1,c=1,h=1){if(super(),s===0)return;let d=t&&s===1;d&&(h=0),c>100&&(c=100),c===0&&(h=0);let p=()=>new N,f=new N,m=p(),g=p(),y=p(),v,b,_,A,S,E,M,R,C=p(),T=p(),L=p(),I=p(),D=p(),F=p(),H=p(),z=p(),B=i-2*a+.001,j=B/s,V=Math.ceil(o*s),q=V+1,K=B/V,le=-B/2,Z=u+1,oe=2*Math.PI/u,ae=Math.PI/2/h,ve=.01,ye=Math.min((1-c/100)*a,a-ve),pe=a-ye,Se=0,be=2,ee=h*be+be,_e=Z*ee/be,Me=_e+Z*q,Ce=Math.max(0,Z*(q+ee)),[Re,Xe,Oe]=[3,3,2].map(ge=>Array(Ce*ge).fill(0)),$=[],J=n-a;function we(ge,ct){let rt=Math.PI/2;E=ct*K,R=2*Math.PI*(E%j)/j+rt,E+=le,M=Math.sin(R)*J,S=Math.cos(R)*J,t?ge.set(S,M,E):ge.set(S,E,M)}we(f,-1e-10),we(m,0),C.copy(f),we(f,1);let te=f.distanceTo(m),Y=d?0:pe+ye,ce=te*V+2*Y,Le=ye,X=ce-Y;for(let ge=0;ge<=V;ge++){we(g,ge),z.subVectors(g,C).normalize(),C.copy(g),F.copy(g).setComponent(+t+1,0).normalize(),H.crossVectors(z,F).normalize();let ct=ge===0,rt=ge===V,ut=ct?3*Math.PI/2:ae,ht=ct?Le:X,tt=ct?Z:Me,pt=ct?0:Ce-Z,Nt=z.clone().multiplyScalar(ct?-pe:pe).add(g),ti=z.clone().multiplyScalar(ct?-1:1).normalize();for(let xe=0;xe<Z;xe++){let Ge=xe*oe;if(T.addVectors(f.copy(F).multiplyScalar(a*Math.cos(Ge)),m.copy(H).multiplyScalar(a*Math.sin(Ge))),L.copy(T).normalize(),ct||rt){d||(Se=pt+xe,[0,1,2].forEach(ie=>{Re[Se*3+ie]=Nt.getComponent(ie),Xe[Se*3+ie]=ti.getComponent(ie)}),Oe[Se*2]=+rt,Oe[Se*2+1]=xe/u),m.copy(L).multiplyScalar(ye),y.addVectors(g,m);for(let ie=0;ie<h;ie++){let He=ie*ae+ut;I.addVectors(f.copy(z).multiplyScalar(pe*Math.sin(He)),m.copy(L).multiplyScalar(pe*Math.cos(He))),D.copy(I).normalize(),m.addVectors(y,I),I.normalize(),Se=tt+ie*Z+xe,[0,1,2].forEach(dt=>{Re[Se*3+dt]=m.getComponent(dt),Xe[Se*3+dt]=D.getComponent(dt)});let Ye=+ct+Math.sin(He);Oe[Se*2]=(ht+pe*Ye)/ce,Oe[Se*2+1]=xe/u}}m.addVectors(g,T),Se=_e+ge*Z+xe,[0,1,2].forEach(ie=>{Re[Se*3+ie]=m.getComponent(ie),Xe[Se*3+ie]=L.getComponent(ie)}),Oe[Se*2]=(Y+ge*te)/ce,Oe[Se*2+1]=xe/u}}let Ue=q+2*h+be,[et,ze]=[+d,Ue-1];for(let ge=et;ge<=ze-1;ge++){let ct=d&&ge===ze-1;for(let rt=0;rt<Z-1;rt++)v=ge*Z+rt,b=v+1,_=(ct?rt:v)+Z,A=(ct?rt+1:b)+Z,ge===0?$.push(b,A,_):ge===Ue-2?$.push(v,b,_):$.push(v,b,_,b,A,_)}this.setIndex($),this.setAttribute("position",new _t(Re,3)),this.setAttribute("normal",new _t(Xe,3)),this.setAttribute("uv",new _t(Oe,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let t=this.userData.parameters,e=Math.ceil(t.tubularSegments),i=t.radialSegments+1,r=Array.from(this.getIndex().array),n,s,o,a,l=6*(e-1)*t.radialSegments,u=e,c=u===e;for(let h=0;h<t.radialSegments;h++)n=u*i+h,s=n+1,o=(c?h:n)+i,a=(c?h+1:s)+i,r[l++]=n,r[l++]=s,r[l++]=o,r[l++]=s,r[l++]=a,r[l++]=o;return r.length=l,zD.array=r,zD.count=r.length,zD}},c2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:r,detail:n,corner:s,cornerSides:o}=t.parameters,a=n===0&&s!==0?new Y$(e*.5,s,o):new qQ(e*.5,n);return a.scale(1,i/e,r/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},Y$=class extends fz{constructor(t=1,e=.2,i=4){let r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(n,s,o,t,e,i),this.type=o}static fromJSON(t){return new Y$(t.radius,t.corner,t.cornerSides)}},d2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var r;(((r=t.parameters)==null?void 0:r.points)??[]).forEach(n=>{Array.isArray(n)&&(n.x=n[0],n.y=n[1])});let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{points:e,segments:i,verticalSegments:r}=t.parameters,n=new YC;n.moveTo(e[0].x,e[0].y),n.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new zQ(n.extractPoints(r).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},Ju=new lt,HD=new ir,DA=new N,D2=class extends Ys{constructor(){super(),this.uuid=kt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new wn().getNormalMatrix(t);for(let i=0,r=this.vertices.length;i<r;i++)this.vertices[i].applyMatrix4(t);for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i];n.normal.applyMatrix3(e).normalize();for(let s=0,o=n.vertexNormals.length;s<o;s++)n.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return Ju.makeRotationX(t),this.applyMatrix4(Ju),this}rotateY(t){return Ju.makeRotationY(t),this.applyMatrix4(Ju),this}rotateZ(t){return Ju.makeRotationZ(t),this.applyMatrix4(Ju),this}translate(t,e,i){return Ju.makeTranslation(t,e,i),this.applyMatrix4(Ju),this}scale(t,e,i){return Ju.makeScale(t,e,i),this.applyMatrix4(Ju),this}lookAt(t){return HD.lookAt(t),HD.updateMatrix(),this.applyMatrix4(HD.matrix),this}fromBufferGeometry(t){let e=this,i=t.index!==null?t.index:void 0,r=t.attributes;if(r.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=r.position,s=r.normal,o=r.color,a=r.uv,l=r.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<n.count;h++)e.vertices.push(new N().fromBufferAttribute(n,h)),o!==void 0&&e.colors.push(new Xt().fromBufferAttribute(o,h));function u(h,d,p,f){let m=o===void 0?[]:[e.colors[h].clone(),e.colors[d].clone(),e.colors[p].clone()],g=s===void 0?[]:[new N().fromBufferAttribute(s,h),new N().fromBufferAttribute(s,d),new N().fromBufferAttribute(s,p)],y=new sO(h,d,p,g,m,f);e.faces.push(y),a!==void 0&&e.faceVertexUvs[0].push([new me().fromBufferAttribute(a,h),new me().fromBufferAttribute(a,d),new me().fromBufferAttribute(a,p)]),l!==void 0&&e.faceVertexUvs[1].push([new me().fromBufferAttribute(l,h),new me().fromBufferAttribute(l,d),new me().fromBufferAttribute(l,p)])}let c=t.groups;if(c.length>0)for(let h=0;h<c.length;h++){let d=c[h],p=d.start,f=d.count;for(let m=p,g=p+f;m<g;m+=3)i!==void 0?u(i.getX(m),i.getX(m+1),i.getX(m+2),d.materialIndex):u(m,m+1,m+2,d.materialIndex)}else if(i!==void 0)for(let h=0;h<i.count;h+=3)u(i.getX(h),i.getX(h+1),i.getX(h+2));else for(let h=0;h<n.count;h+=3)u(h,h+1,h+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(DA).negate(),this.translate(DA.x,DA.y,DA.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,i=e===0?1:1/e,r=new lt;return r.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix4(r),this}computeFaceNormals(){let t=new N,e=new N;for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i],s=this.vertices[n.a],o=this.vertices[n.b],a=this.vertices[n.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),n.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let i=0,r=this.vertices.length;i<r;i++)e[i]=new N;if(t){let i=new N,r=new N;for(let n=0,s=this.faces.length;n<s;n++){let o=this.faces[n],a=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c];i.subVectors(u,l),r.subVectors(a,l),i.cross(r),e[o.a].add(i),e[o.b].add(i),e[o.c].add(i)}}else{this.computeFaceNormals();for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i];e[n.a].add(n.normal),e[n.b].add(n.normal),e[n.c].add(n.normal)}}for(let i=0,r=this.vertices.length;i<r;i++)e[i].normalize();for(let i=0,r=this.faces.length;i<r;i++){let n=this.faces[i],s=n.vertexNormals;s.length===3?(s[0].copy(e[n.a]),s[1].copy(e[n.b]),s[2].copy(e[n.c])):(s[0]=e[n.a].clone(),s[1]=e[n.b].clone(),s[2]=e[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let i=this.faces[t],r=i.vertexNormals;r.length===3?(r[0].copy(i.normal),r[1].copy(i.normal),r[2].copy(i.normal)):(r[0]=i.normal.clone(),r[1]=i.normal.clone(),r[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,i=this.faces.length;e<i;e++){let r=this.faces[e];r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]);for(let n=0,s=r.vertexNormals.length;n<s;n++)r.__originalVertexNormals[n]?r.__originalVertexNormals[n].copy(r.vertexNormals[n]):r.__originalVertexNormals[n]=r.vertexNormals[n].clone()}let t=new D2;t.faces=this.faces;for(let e=0,i=this.morphTargets.length;e<i;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let n=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new N,u={a:new N,b:new N,c:new N};n.push(l),s.push(u)}}let r=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let o=this.faces[n],a=r.faceNormals[n],l=r.vertexNormals[n];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,i=this.faces.length;e<i;e++){let r=this.faces[e];r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Mn),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xa),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,i=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let r,n=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,u=this.colors,c=t.colors;e!==void 0&&(r=new wn().getNormalMatrix(e));for(let h=0,d=o.length;h<d;h++){let p=o[h].clone();e!==void 0&&p.applyMatrix4(e),s.push(p)}for(let h=0,d=c.length;h<d;h++)u.push(c[h].clone());for(let h=0,d=l.length;h<d;h++){let p=l[h],f,m,g=p.vertexNormals,y=p.vertexColors,v=new sO(p.a+n,p.b+n,p.c+n);v.normal.copy(p.normal),r!==void 0&&v.normal.applyMatrix3(r).normalize();for(let b=0,_=g.length;b<_;b++)f=g[b].clone(),r!==void 0&&f.applyMatrix3(r).normalize(),v.vertexNormals.push(f);v.color.copy(p.color);for(let b=0,_=y.length;b<_;b++)m=y[b],v.vertexColors.push(m.clone());v.materialIndex=p.materialIndex+i,a.push(v)}for(let h=0,d=t.faceVertexUvs.length;h<d;h++){let p=t.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],y=[];for(let v=0,b=g.length;v<b;v++)y.push(g[v].clone());this.faceVertexUvs[h].push(y)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},i=[],r=[],n=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let u=this.vertices[a],c=Math.round(u.x*n)+"_"+Math.round(u.y*n)+"_"+Math.round(u.z*n);e[c]===void 0?(e[c]=a,i.push(this.vertices[a]),r[a]=i.length-1):r[a]=r[e[c]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let u=this.faces[a];u.a=r[u.a],u.b=r[u.b],u.c=r[u.c];let c=[u.a,u.b,u.c];for(let h=0;h<3;h++)if(c[h]===c[(h+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let u=0,c=this.faceVertexUvs.length;u<c;u++)this.faceVertexUvs[u].splice(l,1)}let o=this.vertices.length-i.length;return this.vertices=i,o}setFromPoints(t){this.vertices=[];for(let e=0,i=t.length;e<i;e++){let r=t[e];this.vertices.push(new N(r.x,r.y,r.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function i(a,l){return a.materialIndex-l.materialIndex}t.sort(i);let r=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,o;r&&r.length===e&&(s=[]),n&&n.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(r[l]),o&&o.push(n[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(t[f]=p[f]);return t}let e=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];e.push(f.x,f.y,f.z)}let i=[],r=[],n={},s=[],o={},a=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],m=!0,g=!1,y=this.faceVertexUvs[0][p]!==void 0,v=f.normal.length()>0,b=f.vertexNormals.length>0,_=f.color.r!==1||f.color.g!==1||f.color.b!==1,A=f.vertexColors.length>0,S=0;if(S=u(S,0,0),S=u(S,1,m),S=u(S,2,g),S=u(S,3,y),S=u(S,4,v),S=u(S,5,b),S=u(S,6,_),S=u(S,7,A),i.push(S),i.push(f.a,f.b,f.c),i.push(f.materialIndex),y){let E=this.faceVertexUvs[0][p];i.push(d(E[0]),d(E[1]),d(E[2]))}if(v&&i.push(c(f.normal)),b){let E=f.vertexNormals;i.push(c(E[0]),c(E[1]),c(E[2]))}if(_&&i.push(h(f.color)),A){let E=f.vertexColors;i.push(h(E[0]),h(E[1]),h(E[2]))}}function u(p,f,m){return m?p|1<<f:p&~(1<<f)}function c(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return n[f]!==void 0||(n[f]=r.length/3,r.push(p.x,p.y,p.z)),n[f]}function h(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return o[f]!==void 0||(o[f]=s.length,s.push(p.getHex())),o[f]}function d(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=a.length/2,a.push(p.x,p.y)),l[f]}return t.data={},t.data.vertices=e,t.data.normals=r,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=i,t}clone(){return new D2().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let h=0,d=e.length;h<d;h++)this.vertices.push(e[h].clone());let i=t.colors;for(let h=0,d=i.length;h<d;h++)this.colors.push(i[h].clone());let r=t.faces;for(let h=0,d=r.length;h<d;h++)this.faces.push(r[h].clone());for(let h=0,d=t.faceVertexUvs.length;h<d;h++){let p=t.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,m=p.length;f<m;f++){let g=p[f],y=[];for(let v=0,b=g.length;v<b;v++){let _=g[v];y.push(_.clone())}this.faceVertexUvs[h].push(y)}}let n=t.morphTargets;for(let h=0,d=n.length;h<d;h++){let p={};if(p.name=n[h].name,n[h].vertices!==void 0){p.vertices=[];for(let f=0,m=n[h].vertices.length;f<m;f++)p.vertices.push(n[h].vertices[f].clone())}if(n[h].normals!==void 0){p.normals=[];for(let f=0,m=n[h].normals.length;f<m;f++)p.normals.push(n[h].normals[f].clone())}this.morphTargets.push(p)}let s=t.morphNormals;for(let h=0,d=s.length;h<d;h++){let p={};if(s[h].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,m=s[h].vertexNormals.length;f<m;f++){let g=s[h].vertexNormals[f],y={};y.a=g.a.clone(),y.b=g.b.clone(),y.c=g.c.clone(),p.vertexNormals.push(y)}}if(s[h].faceNormals!==void 0){p.faceNormals=[];for(let f=0,m=s[h].faceNormals.length;f<m;f++)p.faceNormals.push(s[h].faceNormals[f].clone())}this.morphNormals.push(p)}let o=t.skinWeights;for(let h=0,d=o.length;h<d;h++)this.skinWeights.push(o[h].clone());let a=t.skinIndices;for(let h=0,d=a.length;h<d;h++)this.skinIndices.push(a[h].clone());let l=t.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());let c=t.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new p2e().fromGeometry(this),e=new Ht,i=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",IA.call(new ei(i,3),t.vertices)),t.normals.length>0){let r=new Float32Array(t.normals.length*3);e.setAttribute("normal",IA.call(new ei(r,3),t.normals))}if(t.colors.length>0){let r=new Float32Array(t.colors.length*3);e.setAttribute("color",p9.call(new ei(r,3),t.colors))}if(t.uvs.length>0){let r=new Float32Array(t.uvs.length*2);e.setAttribute("uv",f9.call(new ei(r,2),t.uvs))}if(t.uvs2.length>0){let r=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",f9.call(new ei(r,2),t.uvs2))}e.groups=t.groups;for(let r in t.morphTargets){let n=[],s=t.morphTargets[r];for(let o=0,a=s.length;o<a;o++){let l=s[o],u=new _t(l.data.length*3,3);u.name=l.name,n.push(IA.call(u,l.data))}e.morphAttributes[r]=n}if(t.skinIndices.length>0){let r=new _t(t.skinIndices.length*4,4);e.setAttribute("skinIndex",m9.call(r,t.skinIndices))}if(t.skinWeights.length>0){let r=new _t(t.skinWeights.length*4,4);e.setAttribute("skinWeight",m9.call(r,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Ht,i=t.geometry;if(t.isPoints||t.isLine){let r=new _t(i.vertices.length*3,3),n=new _t(i.colors.length*3,3);if(e.setAttribute("position",IA.call(r,i.vertices)),e.setAttribute("color",p9.call(n,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new _t(i.lineDistances.length,1);e.setAttribute("lineDistance",f2e.call(s,i.lineDistances))}i.boundingSphere!==null&&(e.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(e.boundingBox=i.boundingBox.clone())}else t.isMesh&&(e=i.toBufferGeometry());return e}};D2.prototype.isGeometry=!0;var p2e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],i,r,n,s=t.faces;for(r=0;r<s.length;r++){let o=s[r];o.materialIndex!==n&&(n=o.materialIndex,i!==void 0&&(i.count=r*3-i.start,e.push(i)),i={start:r*3,materialIndex:n})}i!==void 0&&(i.count=r*3-i.start,e.push(i)),this.groups=e}fromGeometry(t){let e=t.faces,i=t.vertices,r=t.faceVertexUvs,n=r[0]&&r[0].length>0,s=r[1]&&r[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let g=0;g<a;g++)l[g]={name:o[g].name,data:[]};this.morphTargets.position=l}let u=t.morphNormals,c=u.length,h;if(c>0){h=[];for(let g=0;g<c;g++)h[g]={name:u[g].name,data:[]};this.morphTargets.normal=h}let d=t.skinIndices,p=t.skinWeights,f=d.length===i.length,m=p.length===i.length;i.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<e.length;g++){let y=e[g];this.vertices.push(i[y.a],i[y.b],i[y.c]);let v=y.vertexNormals;if(v.length===3)this.normals.push(v[0],v[1],v[2]);else{let _=y.normal;this.normals.push(_,_,_)}let b=y.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let _=y.color;this.colors.push(_,_,_)}if(n===!0){let _=r[0][g];_!==void 0?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new me,new me,new me))}if(s===!0){let _=r[1][g];_!==void 0?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new me,new me,new me))}for(let _=0;_<a;_++){let A=o[_].vertices;l[_].data.push(A[y.a],A[y.b],A[y.c])}for(let _=0;_<c;_++){let A=u[_].vertexNormals[g];h[_].data.push(A.a,A.b,A.c)}f&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),m&&this.skinWeights.push(p[y.a],p[y.b],p[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},sO=class{constructor(t,e,i,r,n,s=0){this.a=t,this.b=e,this.c=i,this.normal=r&&r.isVector3?r:new N,this.vertexNormals=Array.isArray(r)?r:[],this.color=n&&n.isColor?n:new Xt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function f2e(t){return this.array.set(t),this}function p9(t){let e=this.array,i=0;for(let r=0,n=t.length;r<n;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new Xt),e[i++]=s.r,e[i++]=s.g,e[i++]=s.b}return this}function f9(t){let e=this.array,i=0;for(let r=0,n=t.length;r<n;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new me),e[i++]=s.x,e[i++]=s.y}return this}function IA(t){let e=this.array,i=0;for(let r=0,n=t.length;r<n;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new N),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z}return this}function m9(t){let e=this.array,i=0;for(let r=0,n=t.length;r<n;r++){let s=t[r];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new si),e[i++]=s.x,e[i++]=s.y,e[i++]=s.z,e[i++]=s.w}return this}var m2e=["a","b","c"];function g2e(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function GD(t,e,i){let r=Math.min(t,e),n=Math.max(t,e),s=r+"_"+n;return i.get(s)}function VD(t,e,i,r,n,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,u;if(r.has(l))u=r.get(l);else{let c=i[o],h=i[a];u={a:c,b:h,newEdge:null,faces:[]},r.set(l,u)}u.faces.push(n),s[t].edges.push(u),s[e].edges.push(u)}function y2e(t,e,i,r){let n,s,o;for(n=0,s=t.length;n<s;n++)i[n]={edges:[]};for(n=0,s=e.length;n<s;n++)o=e[n],VD(o.a,o.b,t,r,o,i),VD(o.b,o.c,t,r,o,i),VD(o.c,o.a,t,r,o,i)}function LA(t,e,i,r,n){t.push(new sO(e,i,r,void 0,void 0,n))}function qg(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function BA(t,e,i,r){t.push([e.clone(),i.clone(),r.clone()])}var v2e=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Ht?t=new D2().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new N,i,r,n,s,o,a=t.vertices,l=t.faces,u=t.faceVertexUvs[0],c=u!==void 0&&u.length>0,h=[],d=new Map;y2e(a,l,h,d);let p=[],f,m,g,y,v,b,_;for(let ve of Array.from(d.keys())){for(m=d.get(ve),g=new N,v=3/8,b=1/8,_=m.faces.length,_!=2&&(v=.5,b=0,_!=1),g.addVectors(m.a,m.b).multiplyScalar(v),e.set(0,0,0),s=0;s<_;s++){for(y=m.faces[s],o=0;o<3&&(f=a[g2e(y,m2e[o])],!(f!==m.a&&f!==m.b));o++);f&&e.add(f)}e.multiplyScalar(b),g.add(e),m.newEdge=p.length,p.push(g)}let A,S,E,M,R,C,T,L=[];for(r=0,n=a.length;r<n;r++){for(C=a[r],R=h[r].edges,i=R.length,i==3?A=3/16:i>3&&(A=3/(8*i)),S=1-i*Number(A),E=A,i<=2&&(i==2?(S=3/4,E=1/8):i==1||i==0),T=C.clone().multiplyScalar(S),e.set(0,0,0),s=0;s<i;s++)M=R[s],f=M.a!==C?M.a:M.b,e.add(f);e.multiplyScalar(Number(E)),T.add(e),L.push(T)}let I=L.concat(p),D=L.length,F,H,z,B=[],j=[],V,q,K,le,Z=new me,oe=new me,ae=new me;for(r=0,n=l.length;r<n;r++)y=l[r],F=Number(GD(y.a,y.b,d).newEdge)+D,H=Number(GD(y.b,y.c,d).newEdge)+D,z=Number(GD(y.c,y.a,d).newEdge)+D,LA(B,F,H,z,y.materialIndex),LA(B,y.a,F,z,y.materialIndex),LA(B,y.b,H,F,y.materialIndex),LA(B,y.c,z,H,y.materialIndex),c&&(V=u[r],q=V[0],K=V[1],le=V[2],Z.set(qg(q.x,K.x),qg(q.y,K.y)),oe.set(qg(K.x,le.x),qg(K.y,le.y)),ae.set(qg(q.x,le.x),qg(q.y,le.y)),BA(j,Z,oe,ae),BA(j,q,Z,ae),BA(j,K,oe,Z),BA(j,le,ae,oe));t.vertices=I,t.faces=B,c&&(t.faceVertexUvs[0]=j)}},Kn=new N,b2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=t.geometry??(e==null?void 0:e.geometry)??new Ht().copy(new Cu(100,100,100)),r;e===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(Kn),r={width:Kn.x,height:Kn.y,depth:Kn.z,subdivisions:0}):r=e.parameters;let n={...r,...t.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:i}}static build(t){let{width:e,height:i,depth:r,subdivisions:n}=t.parameters,s=t.geometry??new Ht().copy(new Cu(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Kn)):Kn.set(o.width,o.height,o.depth),(e!==Kn.x||i!==Kn.y||r!==Kn.z)&&s.scale(Kn.x===0?1:e/Kn.x,Kn.y===0?1:i/Kn.y,Kn.z===0?1:r/Kn.z);let a=s.originalGeometry;try{n>0?(a===void 0||(o==null?void 0:o.subdivisions)!==n)&&(a===void 0&&(a=s),s=new v2e(n).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,i){new tZ(i).load(t,r=>{let n=this.normalizeInputs({geometry:r});r.boundingBox.getSize(Kn);let s=100/Kn.x;Object.assign(n.parameters,{width:100,height:Kn.y*s,depth:Kn.z*s}),e(this.build(n))})}},K$=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof hn?t.shape:new hn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,spikes:r,cornerRadius:n,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,u=e*.5,c=i*.5,h=0,d=0,p=2*Math.PI/r;for(let m=0;m<r;m++){let g=p*m,y=h+Math.sin(g)*u,v=d+Math.cos(g)*c;l.addPoint(l.createPoint(y,v))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let f=tg.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(f,{userData:{...t,type:"PolygonGeometry"}})}},x2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:r,radialSegments:n,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=new _2e(e*.5,i,n,s,o,a,l);return u.scale(1,1,r/e),Object.assign(u,{userData:{...t,type:"PyramidGeometry"}})}};function rx(t,e,i){i.x=t.x*e.x,i.y=t.y,i.z=t.x*e.y}function jD(t,e,i,r,n,s){let o=e.clone().sub(t),a=i.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),r===n){let u=o.add(a).normalize();s.copy(t).addScaledVector(u,r/Math.sin(l/2))}else{let u=o.angleTo(a);s.copy(t),s.addScaledVector(o,n/Math.sin(u)),s.addScaledVector(a,r/Math.sin(u))}}function w2e(t,e,i){let r=t.clone().sub(e),n=i.clone().sub(e);return r.projectOnVector(n),r.add(e)}var _2e=class extends Ht{constructor(t=.5,e=1,i=4,r=1,n=!1,s=0,o=4){super(),i=Math.floor(Math.max(3,i)),r=Math.floor(r),o=Math.floor(o);let a=[],l=[],u=[],c=[],h=0,d=e/2,p=Math.PI/i,f=t*Math.cos(Math.PI/i),m=2*Math.PI/i,g=(i-2)*Math.PI/i,y=Math.PI-g,v=new N(0,-d,0),b=new N(0,d,0),_=new me(t,-d),A=new me(f,-d),S=new me(0,b.y).sub(A),E=new me(0,b.y).sub(_),M=new me(S.y,-S.x).normalize(),R=new me(E.y,-E.x).normalize(),C=t*Math.cos(Math.PI/i)*Math.tan((Math.PI-S.angle())/2)-1e-8;s=Math.min(s,C);let T;{let z=new N(M.x,M.y,0),B=new N(Math.cos(m)*z.x,z.y,Math.sin(m)*z.x);T=z.angleTo(B)}let L=s/Math.tan((Math.PI-S.angle())/2),I=s/Math.tan((Math.PI-T)/2),D=new N;if(!n){l.push(v.x,v.y,v.z),u.push(0,-1,0),c.push(0,0);let z=h++,B=[],j=_.clone(),V=L/Math.cos(Math.PI/i);j.x-=V;for(let q=0;q<i;q++){let K=q/i*Math.PI*2+p,le=new me(Math.sin(K),Math.cos(K));rx(j,le,D),l.push(D.x,D.y,D.z),u.push(0,-1,0),c.push(0,0),B.push(h++)}for(let q=0;q<B.length;q++)a.push(B[q],z,B[(q+1)%B.length])}{let z=new N,B=new N,j=new N,V=new N,q=new N,K=new N;for(let le=0;le<i;le++){let Z=le/i*Math.PI*2+p,oe=(le+.5)/i*Math.PI*2+p,ae=(le+1)/i*Math.PI*2+p,ve=new me(Math.sin(Z),Math.cos(Z)),ye=new me(Math.sin(oe),Math.cos(oe)),pe=new me(Math.sin(ae),Math.cos(ae));rx(_,ve,B),rx(_,pe,j),rx(M,ye,z),jD(b,B,j,I,I,V),l.push(V.x,V.y,V.z),jD(B,b,j,I,L,q),l.push(q.x,q.y,q.z),jD(j,B,b,L,I,K),l.push(K.x,K.y,K.z),u.push(z.x,z.y,z.z),u.push(z.x,z.y,z.z),u.push(z.x,z.y,z.z),c.push(0,0),c.push(0,0),c.push(0,0);let Se=h++,be=h++,ee=h++;if(a.push(Se,be,ee),s>0){{let Ce=B.clone().add(j).multiplyScalar(.5),Re=b.clone().sub(Ce).normalize(),Xe=v.clone().sub(Ce).normalize().add(Re).normalize().multiplyScalar(-1),Oe=K.clone().sub(q);F(Ce,Oe,Xe,S.angle())}let _e,Me;{let Ce=new N;rx(R,pe,Ce);let Re=K.clone().add(V).multiplyScalar(.5);Re=w2e(Re,j,b);let Xe=K.clone().sub(V);[_e,Me]=F(Re,Xe,Ce,T,V.y)}{let Ce=_e,Re=Ce.clone().setY(0).normalize(),Xe=new N(0,-1,0),Oe=Re.clone().cross(Xe);H(Ce,Re,Xe,Oe)}{let Ce=S.angle(),Re=Math.PI-Ce,Xe=b.clone();Xe.y-=s/Math.sin(Ce-Math.PI/2);let Oe=new N,$=[];for(let we=0;we<o;we++){let te=[],Y=Math.PI/2-Re*we/o,ce=Math.cos(Y),Le=Math.sin(Y),X=oe;for(let Ue=0;Ue<=we;Ue++){let et=Math.cos(X),ze=Math.sin(X);z.x=ce*ze,z.y=Le,z.z=ce*et,Oe.copy(Xe).addScaledVector(z,s),l.push(Oe.x,Oe.y,Oe.z),u.push(z.x,z.y,z.z),c.push(0,0),te.push(h++),X+=Math.PI*2/we/i}$.push(te)}Me.reverse(),$.push(Me);let J=$.length-1;for(let we=0;we<J;we++){let te=$[we],Y=$[we+1],ce=te.length-1;a.push(Y[1],te[0],Y[0]);for(let Le=1;Le<=ce;Le++)a.push(te[Le],te[Le-1],Y[Le]),a.push(Y[Le+1],te[Le],Y[Le])}}}}}this.setIndex(a),this.setAttribute("position",new _t(l,3)),this.setAttribute("normal",new _t(u,3)),this.setAttribute("uv",new _t(c,2));function F(z,B,j,V,q){let K=-V/2,le=(Math.PI-V)/2,Z=B.clone().normalize().cross(j);z.addScaledVector(j,-s/Math.sin(le));let oe=new N,ae=new N,ve=1,ye=h,pe=[];for(let Se=0;Se<=o;Se++){let be=K+Se/o*V;ae.set(0,0,0),ae.addScaledVector(Z,Math.sin(be)),ae.addScaledVector(j,Math.cos(be));for(let ee=0;ee<=ve;ee++){let _e=ee/ve-.5;if(oe.copy(z),oe.addScaledVector(B,_e),oe.addScaledVector(ae,s),q!=null){let Me=Math.max(0,oe.y-q);oe.addScaledVector(B,-Me/B.y)}l.push(oe.x,oe.y,oe.z),u.push(ae.x,ae.y,ae.z),c.push(0,0),ee===0&&pe.push(h),h++}}for(let Se=0;Se<o;Se++)for(let be=0;be<ve;be++){let ee=ye+be+(ve+1)*Se,_e=ee+(ve+1),Me=_e+1,Ce=ee+1;a.push(ee,_e,Ce),a.push(_e,Me,Ce)}return[z.clone().addScaledVector(B,.5),pe]}function H(z,B,j,V){let q=Math.PI/2,K=E.angle()-q,le=[],Z=new N,oe=new N;for(let ve=0;ve<=o;ve++){let ye=[],pe=ve/o;for(let Se=0;Se<=ve;Se++){let be=((ve?Se/ve:0)-.5)*y,ee=Math.cos(be),_e=Math.sin(be),Me=Math.atan(Math.tan(K)*ee),Ce=(q+Me)*pe,Re=Math.cos(Ce),Xe=Math.sin(Ce);Z.set(0,0,0),Z.addScaledVector(B,Xe*ee),Z.addScaledVector(j,Re),Z.addScaledVector(V,Xe*_e),oe.copy(z).addScaledVector(Z,s),l.push(oe.x,oe.y,oe.z),u.push(Z.x,Z.y,Z.z),c.push(0,0),ye.push(h++)}le.push(ye)}let ae=le.length-1;for(let ve=0;ve<ae;ve++){let ye=le[ve],pe=le[ve+1],Se=ye.length-1;a.push(ye[0],pe[1],pe[0]);for(let be=1;be<=Se;be++)a.push(ye[be-1],ye[be],pe[be]),a.push(ye[be],pe[be+1],pe[be])}}}},xz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),r=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof hn?t.shape:new hn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:r}}static build(t){let e=t.shape,{width:i,height:r,cornerRadius:n,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u={x:i*.5,y:r*.5},c={x:-u.x,y:-u.y},h={x:u.x,y:u.y};function d(_,A,S){return A>i&&S>r?Math.min(_*i/A,_*r/S):A>i?_*i/A:S>r?_*r/S:_}let p=[];p[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),p[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),p[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),p[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let f=c.x,m=h.x,g=h.y,y=c.y;e.addPoint(e.createPoint(f,g)),e.addPoint(e.createPoint(m,g)),e.addPoint(e.createPoint(m,y)),e.addPoint(e.createPoint(f,y)),e.isClosed=!0;let v=!0;for(let _=0,A=e.points.length;_<A;_++)e.points[_].roundness=p[_],_>0&&p[_]!==p[_-1]&&(v=!1);v&&(e.roundness=p[0]),e.useCubicForRoundedCorners=s!==1,e.update();let b=tg.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(b,{userData:{...t,type:"RectangleGeometry"}})}},S2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},t.parameters);return i.thetaLength=kt.clamp(i.thetaLength,0,180),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e=100,height:i=e,depth:r=e,widthSegments:n=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:u}=t.parameters,c;return u===0?(c=new Ht,c.setAttribute("position",new _t([],3))):c=new Av(.5*e,n,s,o,a,l,u*kt.DEG2RAD),c.scale(1,i/e,r/e),Object.assign(c,{userData:{...t,type:"SphereGeometry"}})}},A2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(t){let{width:e=100,height:i=e,widthSegments:r=8,heightSegments:n=8}=t.parameters,s=new Qm(e,i,r,n);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},E2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(t){let{width:e,height:i,depth:r,angle:n,cornerRadius:s,cornerSegments:o}=t.parameters,a=new M2e(e,i,r,n,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},M2e=class extends Ht{constructor(t=1,e=1,i=1,r=90,n=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],u=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),r=Math.min(180-u,r),r*=Math.PI/180;let c=[],h=Math.PI/2,d=(ve=0,ye=0,pe=0)=>new N(ve,ye,pe),p=d(),f=d(),[m,g,y]=[e/2,t/2,i/2],v=-g,b=+g,[_,A,S]=[d(v,-m,+y),d(v,-m,-y),d(v,+m,-y)],E=(ve,ye=!1)=>Math.sin(ve-Math.PI/(1+ +ye)),M=(ve,ye=!1)=>Math.cos(ve-Math.PI/(1+ +ye));S.y=Math.sin(r)*e-m;let R=Math.cos(r)*e-y,C=_.z-u;r<=h?(S.z=Math.min(R,C),S.z==C&&(S.y-=(R-C)/Math.tan(h-r))):A.z=Math.min(A.z-R-y,_.z-u),p.subVectors(_,A),f.subVectors(S,A);let T=Math.min(p.length(),f.length())*n/100,L=T*Math.tan(r/2),I=T/Math.cos(r/2),D=p.clone().normalize().add(f.normalize()).setLength(I).add(A);p.set(0,E(r,!0),M(r,!0)),c.push([S,p.clone()]);let F=(Math.PI-r)/s;for(let ve=0;ve<=s;ve++){let ye=h+r+ve*F;p.set(0,Math.sin(ye)*L,Math.cos(ye)*L),p.add(D),f.set(0,E(ye),M(ye)),c.push([p.clone(),f.clone()])}c.push([_,d(0,1,0)]);let H=Math.sin(F/2)*L*2,z=c.length-1,B=c[0][0].distanceTo(c[1][0]),j=c[z-1][0].distanceTo(c[z][0]),V=B+H*s+j;c[0].push(1);for(let ve=0;ve<=s;ve++)c[ve+1].push(1-(B+ve*H)/V);c[z].push(0);let[q,K,le]=c[0],Z,oe,ae;for(let ve=1;ve<c.length;ve++)[Z,oe,ae]=c[ve],o.push(v,q.y,q.z,v,Z.y,Z.z,b,q.y,q.z,b,q.y,q.z,v,Z.y,Z.z,b,Z.y,Z.z),a.push(0,K.y,K.z,0,oe.y,oe.z,0,K.y,K.z,0,K.y,K.z,0,oe.y,oe.z,0,oe.y,oe.z),l.push(0,le,0,ae,1,le,1,le,0,ae,1,ae),[q,K,le]=[Z,oe,ae];this.setAttribute("position",new _t(o,3)),this.setAttribute("normal",new _t(a,3)),this.setAttribute("uv",new _t(l,2))}},J$=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof hn?t.shape:new hn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i,innerRadiusPercent:r,spikes:n,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}=t.parameters,c=t.shape,h=e*.5,d=i*.5,p=0,f=0,m=o*Math.PI/360/n,g=Math.PI/2*3*-1,y=h*r/100,v=d*r/100;if(n===3&&r===50){m=2*Math.PI/n;for(let _=0;_<n;_++){let A=m*_,S=p+Math.sin(A)*h,E=f+Math.cos(A)*d;c.addPoint(c.createPoint(S,E))}}else for(let _=0;_<n;_++){let A=p+Math.cos(g)*h,S=f+Math.sin(g)*d;c.addPoint(c.createPoint(A,S)),g+=m,A=p+Math.cos(g)*y,S=f+Math.sin(g)*v,c.addPoint(c.createPoint(A,S)),g+=m}c.isClosed=!0;for(let _=0,A=c.points.length;_<A;_++)c.points[_].roundness=s;c.roundness=s,c.update();let b=tg.create({shape:c,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}});return Object.assign(b,{userData:{...t,type:"StarGeometry"}})}},C2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e,height:i}=t.parameters,r=new Qm(e,i);return Object.assign(r,{userData:{...t,type:"TextFrameGeometry"}})}},P2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},t.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width),s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:r,height:n,depth:s})}}static build(t){let{width:e,height:i,depth:r,radialSegments:n,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=T2e(e,i,r,e*.5,o,s,0,0,n,a,l);return u.scale(1,i/e,1),Object.assign(u,{userData:{...t,type:"TorusGeometry"}})}};function T2e(t,e,i,r,n,s,o,a,l,u,c){[e,i]=[i,e],o=e/2;let h=kt.clamp(n/360,0,1);if(h===0){let d=new Ht;return d.setAttribute("position",new _t([],3)),d}return h===1&&(u=0),new X$(!0,t,e,i,r,h,s,o,a,l,u,c)}var R2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(t){let{width:e,tube:i,tubularSegments:r,radialSegments:n,p:s,q:o}=t.parameters,a=e*.5;a!==i&&(a-=i);let l=new YQ(a,i,r,n,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},k2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof hn?t.shape:new hn,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(t){let{width:e=100,height:i,cornerRadius:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,u=e*.5,c=i*.5;a?(l.addPoint(l.createPoint(-u,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))):(l.addPoint(l.createPoint(0,c)),l.addPoint(l.createPoint(u,-c)),l.addPoint(l.createPoint(-u,-c))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=r;l.roundness=r,l.update();let h=tg.create({shape:l,parameters:{roundness:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(h,{userData:{...t,type:"TriangleGeometry"}})}};function D2e(t,e){let i=2*Math.PI;return(t%i+i)%i===(e%i+i)%i}var I2e=class{add(t,e,i){if(typeof arguments[0]!="string")for(let r in arguments[0])this.add(r,arguments[0][r],arguments[1]);else(Array.isArray(t)?t:[t]).forEach(function(r){this[r]=this[r]||[],e&&this[r][i?"unshift":"push"](e)},this)}run(t,e){this[t]=this[t]||[],this[t].forEach(function(i){i.call(e&&e.context?e.context:e,e)})}},L2e=class{constructor(t){this.jsep=t,this.registered={}}register(...t){t.forEach(e=>{if(typeof e!="object"||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)})}},Je=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+Je.version}static addUnaryOp(e){return Je.max_unop_len=Math.max(e.length,Je.max_unop_len),Je.unary_ops[e]=1,Je}static addBinaryOp(e,i,r){return Je.max_binop_len=Math.max(e.length,Je.max_binop_len),Je.binary_ops[e]=i,r?Je.right_associative.add(e):Je.right_associative.delete(e),Je}static addIdentifierChar(e){return Je.additional_identifier_chars.add(e),Je}static addLiteral(e,i){return Je.literals[e]=i,Je}static removeUnaryOp(e){return delete Je.unary_ops[e],e.length===Je.max_unop_len&&(Je.max_unop_len=Je.getMaxKeyLen(Je.unary_ops)),Je}static removeAllUnaryOps(){return Je.unary_ops={},Je.max_unop_len=0,Je}static removeIdentifierChar(e){return Je.additional_identifier_chars.delete(e),Je}static removeBinaryOp(e){return delete Je.binary_ops[e],e.length===Je.max_binop_len&&(Je.max_binop_len=Je.getMaxKeyLen(Je.binary_ops)),Je.right_associative.delete(e),Je}static removeAllBinaryOps(){return Je.binary_ops={},Je.max_binop_len=0,Je}static removeLiteral(e){return delete Je.literals[e],Je}static removeAllLiterals(){return Je.literals={},Je}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new Je(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(i=>i.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return Je.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!Je.binary_ops[String.fromCharCode(e)]||Je.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return Je.isIdentifierStart(e)||Je.isDecimalDigit(e)}throwError(e){let i=new Error(e+" at character "+this.index);throw i.index=this.index,i.description=e,i}runHook(e,i){if(Je.hooks[e]){let r={context:this,node:i};return Je.hooks.run(e,r),r.node}return i}searchHook(e){if(Je.hooks[e]){let i={context:this};return Je.hooks[e].find(function(r){return r.call(i.context,i),i.node}),i.node}}gobbleSpaces(){let e=this.code;for(;e===Je.SPACE_CODE||e===Je.TAB_CODE||e===Je.LF_CODE||e===Je.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let e=this.gobbleExpressions(),i=e.length===1?e[0]:{type:Je.COMPOUND,body:e};return this.runHook("after-all",i)}gobbleExpressions(e){let i=[],r,n;for(;this.index<this.expr.length;)if(r=this.code,r===Je.SEMCOL_CODE||r===Je.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())i.push(n);else if(this.index<this.expr.length){if(r===e)break;this.throwError('Unexpected "'+this.char+'"')}return i}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,Je.max_binop_len),i=e.length;for(;i>0;){if(Je.binary_ops.hasOwnProperty(e)&&(!Je.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!Je.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=i,e;e=e.substr(0,--i)}return!1}gobbleBinaryExpression(){let e,i,r,n,s,o,a,l,u;if(o=this.gobbleToken(),!o||(i=this.gobbleBinaryOp(),!i))return o;for(s={value:i,prec:Je.binaryPrecedence(i),right_a:Je.right_associative.has(i)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+i),n=[o,s,a];i=this.gobbleBinaryOp();){if(r=Je.binaryPrecedence(i),r===0){this.index-=i.length;break}s={value:i,prec:r,right_a:Je.right_associative.has(i)},u=i;let c=h=>s.right_a&&h.right_a?r>h.prec:r<=h.prec;for(;n.length>2&&c(n[n.length-2]);)a=n.pop(),i=n.pop().value,o=n.pop(),e={type:Je.BINARY_EXP,operator:i,left:o,right:a},n.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+u),n.push(s,e)}for(l=n.length-1,e=n[l];l>1;)e={type:Je.BINARY_EXP,operator:n[l-1].value,left:n[l-2],right:e},l-=2;return e}gobbleToken(){let e,i,r,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(e=this.code,Je.isDecimalDigit(e)||e===Je.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===Je.SQUOTE_CODE||e===Je.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(e===Je.OBRACK_CODE)n=this.gobbleArray();else{for(i=this.expr.substr(this.index,Je.max_unop_len),r=i.length;r>0;){if(Je.unary_ops.hasOwnProperty(i)&&(!Je.isIdentifierStart(this.code)||this.index+i.length<this.expr.length&&!Je.isIdentifierPart(this.expr.charCodeAt(this.index+i.length)))){this.index+=r;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:Je.UNARY_EXP,operator:i,argument:s,prefix:!0})}i=i.substr(0,--r)}Je.isIdentifierStart(e)?(n=this.gobbleIdentifier(),Je.literals.hasOwnProperty(n.name)?n={type:Je.LITERAL,value:Je.literals[n.name],raw:n.name}:n.name===Je.this_str&&(n={type:Je.THIS_EXP})):e===Je.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let i=this.code;for(;i===Je.PERIOD_CODE||i===Je.OBRACK_CODE||i===Je.OPAREN_CODE||i===Je.QUMARK_CODE;){let r;if(i===Je.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==Je.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),i=this.code}this.index++,i===Je.OBRACK_CODE?(e={type:Je.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},this.gobbleSpaces(),i=this.code,i!==Je.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):i===Je.OPAREN_CODE?e={type:Je.CALL_EXP,arguments:this.gobbleArguments(Je.CPAREN_CODE),callee:e}:(i===Je.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),e={type:Je.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),r&&(e.optional=!0),this.gobbleSpaces(),i=this.code}return e}gobbleNumericLiteral(){let e="",i,r;for(;Je.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===Je.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);Je.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(i=this.char,i==="e"||i==="E"){for(e+=this.expr.charAt(this.index++),i=this.char,(i==="+"||i==="-")&&(e+=this.expr.charAt(this.index++));Je.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);Je.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return r=this.code,Je.isIdentifierStart(r)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(r===Je.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===Je.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:Je.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="",i=this.index,r=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===r){n=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=s}else e+=s}return n||this.throwError('Unclosed quote after "'+e+'"'),{type:Je.LITERAL,value:e,raw:this.expr.substring(i,this.index)}}gobbleIdentifier(){let e=this.code,i=this.index;for(Je.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,Je.isIdentifierPart(e));)this.index++;return{type:Je.IDENTIFIER,name:this.expr.slice(i,this.index)}}gobbleArguments(e){let i=[],r=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===e){r=!0,this.index++,e===Je.CPAREN_CODE&&n&&n>=i.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(s===Je.COMMA_CODE){if(this.index++,n++,n!==i.length){if(e===Je.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===Je.CBRACK_CODE)for(let o=i.length;o<n;o++)i.push(null)}}else if(i.length!==n&&n!==0)this.throwError("Expected comma");else{let o=this.gobbleExpression();(!o||o.type===Je.COMPOUND)&&this.throwError("Expected comma"),i.push(o)}}return r||this.throwError("Expected "+String.fromCharCode(e)),i}gobbleGroup(){this.index++;let e=this.gobbleExpressions(Je.CPAREN_CODE);if(this.code===Je.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:Je.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:Je.ARRAY_EXP,elements:this.gobbleArguments(Je.CBRACK_CODE)}}},B2e=new I2e;Object.assign(Je,{hooks:B2e,plugins:new L2e(Je),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});Je.max_unop_len=Je.getMaxKeyLen(Je.unary_ops);Je.max_binop_len=Je.getMaxKeyLen(Je.binary_ops);var d0=t=>new Je(t).parse(),O2e=Object.getOwnPropertyNames(Je);O2e.forEach(t=>{d0[t]===void 0&&t!=="prototype"&&(d0[t]=Je[t])});d0.Jsep=Je;var U2e="ConditionalExpression",N2e={name:"ternary",init(t){t.hooks.add("after-expression",function(e){if(e.node&&this.code===t.QUMARK_CODE){this.index++;let i=e.node,r=this.gobbleExpression();if(r||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===t.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),e.node={type:U2e,test:i,consequent:r,alternate:n},i.operator&&t.binary_ops[i.operator]<=.9){let s=i;for(;s.right.operator&&t.binary_ops[s.right.operator]<=.9;)s=s.right;e.node.test=s.right,s.right=e.node,e.node=i}}else this.throwError("Expected :")}})}};d0.plugins.register(N2e);var F2e=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],z2e=["0","1","2","3","4","5","6","7","8","9","."],H2e=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function G2e(t){return typeof t!="string"?!1:!isNaN(t)&&!isNaN(parseFloat(t))}d0.addBinaryOp("^",11,!0);function Q$(t,e,i="number"){let r="";for(let o=0;o<t.length;o++){let a=t[o];if("id"in a){let l=t[o-1];if(o>0&&"id"in l){console.error("Two variables in a row",t);return}let u=e.getVariable(a.id),c=Ha.getDisplayedValue(u);i==="number"&&Ha.isTextValue(u)&&Array.isArray(u.textValue)&&u.textValue.length===1?c=parseFloat(c).toString():i==="boolean"&&Ha.isBoolean(u)?c=u?"true":"false":i==="boolean"&&Ha.isTextValue(u)&&!Array.isArray(u.textValue)&&(c='"'+c+'"'),r+=c;continue}else if(i==="string"){a.name!=='"'&&a.name!=="+"&&(r+=a.name),a.name==="+"&&r[r.length-1]==="\\"&&(r=r.slice(0,-1)+a.name);continue}if(a.name==="and"){r+="&&";continue}if(a.name==="or"){r+="||";continue}if(a.name==="True"){r+="true";continue}if(a.name==="False"){r+="false";continue}if(i==="boolean"&&!G2e(a.name)&&!z2e.includes(a.name)&&!F2e.includes(a.name)&&!H2e.includes(a.name.replace(/\($/g,""))){r+='"'+a.name+'"';continue}r+=a.name}if(i==="string")return r;if(t.length===0){if(i==="number")return 0;if(i==="boolean")return!1}let n;try{n=d0(r)}catch(o){console.error(r,o);return}let s;try{s=Fi(n)}catch(o){console.error(r,n,o)}return s}function Fi(t){switch(t.type){case"BinaryExpression":switch(t.operator){case"==":return+(Fi(t.left)===Fi(t.right));case"!=":return+(Fi(t.left)!==Fi(t.right));case">":return+(Fi(t.left)>Fi(t.right));case">=":return+(Fi(t.left)>=Fi(t.right));case"<":return+(Fi(t.left)<Fi(t.right));case"<=":return+(Fi(t.left)<=Fi(t.right));case"+":return Fi(t.left)+Fi(t.right);case"-":return Fi(t.left)-Fi(t.right);case"*":return Fi(t.left)*Fi(t.right);case"/":return Fi(t.left)/Fi(t.right);case"%":return Fi(t.left)%Fi(t.right);case"&&":return Fi(t.left)&&Fi(t.right);case"||":return Fi(t.left)||Fi(t.right);case"^":return Math.pow(Fi(t.left),Fi(t.right));default:throw new Error("Unknown operator: "+t.operator)}case"UnaryExpression":switch(t.operator){case"-":return-Fi(t.argument);case"!":return+!Fi(t.argument);default:throw new Error("Unknown operator: "+t.operator)}case"Identifier":throw new Error("Unknown identifier: "+t.name);case"Literal":return t.value;case"CallExpression":if(t.callee.type==="Identifier"){if(t.callee.name==="random"){let e=0,i=1;if(t.arguments.length>=1)try{e=Fi(t.arguments[0])}catch(r){console.warn(r)}if(t.arguments.length>=2)try{i=Fi(t.arguments[1])}catch(r){console.warn(r)}return e=Math.min(i,e),i=Math.max(i,e),e+Math.random()*(i-e)}return Math[t.callee.name].apply(null,t.arguments.map(Fi))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+t.type)}}var V2e=new lt,j2e=new lt;function W2e(t,e,i){let r=[new N,new N,new N],n=[new N,new N,new N];return t.extractBasis(r[0],r[1],r[2]),e.extractBasis(n[0],n[1],n[2]),r.forEach((s,o)=>{let a=n[o],l=kt.lerp(s.length(),a.length(),i);s.lerp(a,i).setLength(l)}),new lt().makeBasis(r[0],r[1],r[2])}var q2e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let i=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),r=Math.abs(i.width),n=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),o=(e==null?void 0:e.shapeData)??bz.create({parameters:w$}).userData.shape;return{path:t.path??y2.defaultData(),parameters:Object.assign(i,{width:r,height:n,depth:s,extrusion:{..._$,...i.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new X2e(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Ht,{userData:{...t,type:"PathGeometry"}})}},X2e=class extends Ht{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!D2e(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:i,offset:r}=this.inputs.parameters.extrusion;i=Math.max(0,Math.min(i,1)),r=Math.max(0,Math.min(r,1));let n=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(r*n),o=this.inputs.path.isClosed?Math.ceil((i+r)*n):Math.ceil(Math.min(1,i+r)*n),a=Math.min(Math.max(2,o-s+1),n+2),l=[],u=[];for(let z=0;z<a;z++){let B=this.inputs.path.isClosed?(z+s)%t.length:Math.min(z+s,t.length-1);l.push(t[B].clone()),u.push(e[B].clone())}let c=(z,B,j)=>{l[z]=l[z].clone().lerp(l[B],j),u[z]=W2e(u[z],u[B],j)},h=0,d=r*n%1;(!this.inputs.path.isClosed||i<=1)&&(d||r===0)&&(h=d,c(0,1,h));let p=0,f=(r+i)*n%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&r+i<1)&&f&&(p=f,c(l.length-1,l.length-2,1-p)),i===0){let z=l.length-1;l[z].copy(l[0]),u[z].copy(u[0])}this._applyPathModifiers(u,h,p);let{bevel:m,bevelSides:g}=this.inputs.parameters.extrusion,y=m>0?this.inputs.parameters.extrusion.capType:"flat",v=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(v=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:b,infos:_,vertices:A}=this._computeShapePoints(v),S=0,E;y==="round"&&(E=new vz(this.inputs.shapeData,2*m,m,v,g,void 0,!0),S=E.getAttribute("position").count);let M=0,R=0;_.sort((z,B)=>z.start-B.start),_.forEach(z=>{z.verticesStart=M,z.verticesCount=z.continuous.reduce((B,j,V)=>B+(V===0||!j?2:1),0),R+=z.verticesCount,M=R});let C=R*a,T,L=0;if(this._isOpenEnded()&&y==="flat"){try{T=mp({windingRule:ur.ODD,elementType:Nn.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:b})}catch{T=z$}L=T.vertexCount}let I=C+2*L+S*2,D=C+2*L,F={positions:new Float32Array(I*3),normals:new Float32Array(I*3),uvs:new Float32Array(I*2)},H=[];if(_.forEach(z=>{this._extrudeRegion(z,A,u,l,F,H,this._isGeometryClosed()&&!this._isOpenEnded())}),T&&(this._closeEnd(T,C,H,F,u[0],l[0],!1),this._closeEnd(T,C+L,H,F,u[u.length-1],l[l.length-1],!0)),E){F.positions.set(E.getAttribute("position").array,D*3),F.normals.set(E.getAttribute("normal").array,D*3),F.uvs.set(E.getAttribute("uv").array,D*2);let z=H.length;H.push(...E.getIndex().array.map(V=>V+D)),D+=S,F.positions.set(E.getAttribute("position").array,D*3),F.normals.set(E.getAttribute("normal").array,D*3),F.uvs.set(E.getAttribute("uv").array,D*2);let B=H.length;H.push(...E.getIndex().array.map(V=>V+D)),this.setAttribute("position",new ei(F.positions,3)),this.setAttribute("normal",new ei(F.normals,3)),this.setAttribute("uv",new ei(F.uvs,2)),this.setIndex(H);let j=V2e;j.copy(u[u.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(j,D,I),j.copy(u[0]).setPosition(l[0]).multiply(j2e.makeScale(1,1,-1)),this.applyMatrix4OnRange(j,D-S,D),this.reverseIndicesOnRange(z,B)}else this.setAttribute("position",new ei(F.positions,3)),this.setAttribute("normal",new ei(F.normals,3)),this.setAttribute("uv",new ei(F.uvs,2)),this.setIndex(H)}_extractPathPoints(){let t=k$(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(i=>{e[e.length-1].distanceToSquared(i)>.001&&e.push(i)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],i=t.length,r=this.inputs.path.isClosed,n=new N,s=new N,o=new N,a=new N,l=new N(0,1,0);for(let f=0;f<i;f++){let m=t[f],g;f===0?g=r?t[t.length-2]:m.clone().multiplyScalar(2).sub(t[1]):g=t[f-1];let y;f===i-1?y=r?t[1]:m.clone().multiplyScalar(2).sub(t[f-1]):y=t[f+1];let v=m.clone().sub(g).normalize(),b=y.clone().sub(m).normalize(),_=v.clone().add(b).normalize();o.copy(_),f===0&&(_.equals(l)||_.clone().negate().equals(l))&&l.set(0,0,1);let A=l.clone().cross(_).normalize(),S=_.clone().cross(A).normalize();l.copy(S),a.copy(A),f===0&&(n.copy(S),s.copy(_));let E=new lt().makeBasis(A,S,_);e.push(E)}let u=r?s:o,c=r?n:new N(0,1,0),h=u.clone().cross(a).normalize(),d=Math.acos(c.dot(h));if(isNaN(d))return e;let p=c.clone().cross(h);u.dot(p)>0&&(d*=-1);for(let f=1;f<e.length;f++){let m=new lt().makeRotationZ(d*f/e.length);e[f].multiply(m)}return e}_applyPathModifiers(t,e,i){let r=t.length,{angle:n,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new lt,u=new lt;return t.forEach((c,h)=>{let d=h===0?0:h===r-1?1:(h-e)/(r-(i===0?0:1)-(e+(1-i)));l.makeRotationZ(kt.lerp(n,n+s,d)*kt.DEG2RAD);let p=kt.lerp(o,a,d);u.makeScale(p,p,p),c.multiply(l).multiply(u)}),t}_computeShapePoints(t=12,e=ur.ODD){let i=this.inputs.shapeData,r=i.extractShapePointsToFlatArray([],t),n=i.shapeHoles.map(u=>{let c=u.extractShapePointsToFlatArray([],t),h=[];for(let d=c.length-1;d>=1;d-=2){let p=c[d-1],f=c[d-0];h.push(p,f)}return h}),s;try{s=mp({windingRule:e,elementType:Nn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[r]})}catch{s=yz}let o;try{o=mp({windingRule:ur.ODD,elementType:Nn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{o=F$}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let u=0;u<o.elements.length;u++){let c=o.elements[u],h=u%2===0?s.vertexCount:0;s.elements.push(c+h)}for(let u=0;u<o.vertexIndices.length;u++){let c=o.vertexIndices[u],h=s.vertexCount;s.vertexIndices.push(c+h)}for(let u=0;u<o.vertices.length;u++){let c=o.vertices[u];s.vertices.push(c)}}for(let u=0,c=s.vertexCount;u<c;u++){let h=u*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let u=s.elementCount-1;u>=0;u--){let c=u>=a,h=u*2,d=s.elements[h+0],p=s.elements[h+1],f=d+p,m={start:d,count:p,normals:[],isHole:c,continuous:[],verticesStart:0,verticesCount:0};l.push(m);let g=d,y=f-1,v=d+1,b=i.roundedCurves.length;do{let _=g-d;s.vertices[y*2+0],s.vertices[y*2+1];let A=s.vertices[g*2+0],S=s.vertices[g*2+1],E=s.vertices[v*2+0],M=s.vertices[v*2+1],R=A-E,C=S-M,T=Math.sqrt(R*R+C*C);R/=T,C/=T,m.normals[_*2+0]=-C,m.normals[_*2+1]=R;let L=s.vertexIndices[g];if(Array.isArray(L))m.continuous[_]=!1;else{let[I,D]=i.getCurveIndexFromVertexId(L-1,!0);if(D>0&&D<1)m.continuous[_]=!0;else{let F=D===1?I+1:I-1;F=(F+b)%b;let H=D===1?0:1,z=i.roundedCurves[I].getTangent(D),B=i.roundedCurves[F].getTangent(H);m.continuous[_]=z.dot(B)>.95}}c&&(m.normals[_*2+0]*=-1,m.normals[_*2+1]*=-1),[y,g,v]=[g,v,v+1],v>=f&&(v-=p)}while(v!==d+1)}return{regions:[r,...n],infos:l,vertices:s.vertices}}_insertVertex(t,e,i,r,n){let s=e*2,o=e*3;t.positions[o+0]=i.x,t.positions[o+1]=i.y,t.positions[o+2]=i.z,t.normals[o+0]=r.x,t.normals[o+1]=r.y,t.normals[o+2]=r.z,t.uvs[s+0]=n.x,t.uvs[s+1]=n.y}_extrudeRegion(t,e,i,r,n,s,o){let a=new N,l=new N,u=new N,c=new N,h=new me;i.forEach((p,f)=>{let m=r[f],g=t.verticesStart*i.length+t.verticesCount*f;for(let y=0;y<t.count;y++){let v=(t.start+y)*2;if(a.set(e[v+0],e[v+1],0),u.copy(a).applyMatrix4(p).add(m),t.continuous[y])c.set(t.normals[y*2+0],t.normals[y*2+1],0);else{let b=y===0?(t.start+t.count-1)*2:v-2;l.set(e[b+0],e[b+1],0),c.copy(a).sub(l),c.set(-c.y,c.x,0),t.isHole||c.negate()}if(c.applyMatrix4(p).normalize(),h.set(y===0?1:y/t.count,f/(i.length-1)),this._insertVertex(n,g,u,c,h),g++,!t.continuous[y]||y===0){if(y===0)c.set(t.normals[y*2+0],t.normals[y*2+1],0),h.set(0,f/(i.length-1));else{let b=y===t.count-1?t.start*2:v+2;l.set(e[b+0],e[b+1],0),c.copy(l).sub(a),c.set(-c.y,c.x,0),t.isHole||c.negate()}c.applyMatrix4(p).normalize(),this._insertVertex(n,g,u,c,h),g++}}});let d=i.length-1;for(let p=0;p<d;p++){let f=t.verticesStart*i.length+t.verticesCount*p,m=t.verticesStart*i.length+t.verticesCount*(p+1),g=0;for(let y=0;y<t.count;y++){(!t.continuous[y]||y===0)&&g++;let v=y===t.count-1?0:g+1,b=f+g,_=f+v,A=m+v,S=m+g;t.isHole?s.push(b,A,_,b,S,A):s.push(b,_,A,b,A,S),g++}}}_closeEnd(t,e,i,r,n,s,o){let a=t.vertexCount,l=new N(0,0,o?-1:1).applyMatrix4(n),u=new N,c=new me;for(let d=0;d<a;d++){let p=2*d;u.set(t.vertices[p+0],t.vertices[p+1],0).applyMatrix4(n).add(s),this._insertVertex(r,e+d,u,l,c)}let h=t.elements;for(let d=0;d<t.elementCount;d++){let p=3*d,f=h[p+0]+e,m=h[p+(o?1:2)]+e,g=h[p+(o?2:1)]+e;i.push(f,m,g)}}applyMatrix4OnRange(t,e,i){let r=t.elements,n=new wn().getNormalMatrix(t).elements,s,o,a,l,u=this.attributes.position,c=this.attributes.normal;if(!u||!c)return;let h=u.array,d=c.array,p=u.itemSize;for(let f=e*p,m=i*p;f<m;f+=p){if(f===e)debugger;s=h[f+0],o=h[f+1],a=h[f+2],l=1/(r[3]*s+r[7]*o+r[11]*a+r[15]),h[f+0]=(r[0]*s+r[4]*o+r[8]*a+r[12])*l,h[f+1]=(r[1]*s+r[5]*o+r[9]*a+r[13])*l,h[f+2]=(r[2]*s+r[6]*o+r[10]*a+r[14])*l,s=d[f+0],o=d[f+1],a=d[f+2],d[f+0]=n[0]*s+n[3]*o+n[6]*a,d[f+1]=n[1]*s+n[4]*o+n[7]*a,d[f+2]=n[2]*s+n[5]*o+n[8]*a}u.needsUpdate=!0,c.needsUpdate=!0}reverseIndicesOnRange(t,e){let i=this.index;if(i){for(let r=t;r<e;r+=3){let n=i.getX(r),s=i.getX(r+1),o=i.getX(r+2);i.setXYZ(r,o,s,n)}i.needsUpdate=!0}}};function Z$(){let t=new Ht;return t.setAttribute("position",new ei(new Float32Array([]),3)),t.setIndex(new ei(new Uint16Array([]),1)),t}var Y2e=Z$().attributes,K2e=12,J2e=1,$$=class extends Ht{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Y2e),this.userData={parameters:t,type:"TextGeometry"};let i=e.getFont(t.font);i!=null&&i.isLoaded?(this.font=i,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let i=e.getFont(t);i&&(this.font=i,await i.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:r,depth:n,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,u=Ha.getDisplayedValue(a),c=l===2?u.toUpperCase():l===3?u.toLowerCase():u,h=Q2e(t,e,c),{shapes:d,charWidths:p,charCoords:f}=e.generateShapes(h,t),m=(typeof i=="number"?i:1)*.5,g=(typeof r=="number"?r:1)*.5,y=d.map(_=>new hn().fromShape(_,!0));this.vectorShapes=y;let v=y.map(_=>tg.create({shape:_,parameters:{depth:n,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:n<=0?ur.NONZERO:ur.ODD,subdivisions:this.isLowResolution&&n>0?J2e:K2e}})),b=v.length?em(v):Z$();b.translate(-m,g,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=p,this.deleteAttribute("extrudeNormal"),Object.entries(b.attributes).forEach(([_,A])=>{this.setAttribute(_,A)}),this.setIndex(b.index),this.computeBoundingSphere()}clone(){let t=Oh(new Ht,$$.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,i])=>{this.setAttribute(e,i)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function Q2e(t,e,i){let r=[""],n="";for(let s of i)n+=s,s===" "||s===`
`?(r[r.length-1]+=n,n="",s===`
`&&r.push("")):e.getTextWidth(r[r.length-1]+n,t)>t.width&&(r[r.length-1].length&&r.push(""),e.getTextWidth(r[r.length-1]+n,t)>t.width&&(n.length===1?(r[r.length-1]+=n,n=""):(r[r.length-1]+=n.slice(0,-1),n=n[n.length-1],r.push(""))));return r[r.length-1]+=n,r}var eee,tee=new Promise(t=>{eee=t}),g9=!1,OA;function Z2e(){if(g9)return;if(OA)return OA;async function t(){let e="https://unpkg.com/@splinetool/modelling-wasm@1.0.53/build",i=L0(()=>import("./process-0cd968c5.js"),[]),[r,n]=await Promise.all([i,fetch(`${e}/process.wasm`).then(a=>a.arrayBuffer())]),s=r.default,o=await s({wasmBinary:n});eee(o),g9=!0}return OA=t(),OA}var $2e=["font"];function h1(t,e,i,r){var u;let n,s,o;t.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(t)),o=[[],["extrusion"]]):(s={...t},o=[[]]);for(let c of o){let h=s;for(let d of c)h=h[d];for(n in h){let d=h[n];x8(d)&&!$2e.includes(n)&&(h[n]=e.getVariable(d,[r.uuid,"geometry",...c,n]),x8(h[n])&&(h[n]=1))}}let a={parameters:s,type:s.type};if(s.type==="PathGeometry")a.path=s.path;else if(s.type==="VectorGeometry"){let c=hn.createFromState(s.shape,s.width,s.height);a.shape=c}else if(s.type==="NonParametricGeometry")s.data.groups&&((u=s.data.groups)==null||u.forEach(c=>c.materialIndex=Math.max(c.materialIndex??0,0))),a.geometry=new tZ().parse(s);else if(s.type==="SubdivGeometry"){let c=new Bo(s,i);return c.data=t,c}else{if(s.type==="TextGeometry")return new $$(s,e);if(s.type==="UIGeometry")return xz.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}let l;try{l=w9(a)}catch(c){console.error(c)}if(!l){let c=hn.createFromState(g2.defaultData(),100,100);a.shape=c,l=w9(a)}return l}var ePe=new lt;function oO(t,e,i,r){let n=t.position.array,s=t.normal.array,o=ePe.makeScale(e,i,r).invert().elements,a,l,u;for(var c=0,h=n.length;c<h;c+=3)n[c]*=e,n[c+1]*=i,n[c+2]*=r,a=s[c],l=s[c+1],u=s[c+2],s[c]=o[0]*a+o[4]*l+o[8]*u,s[c+1]=o[1]*a+o[5]*l+o[9]*u,s[c+2]=o[2]*a+o[6]*l+o[10]*u;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var UA=new Mn,Xg=new N,Yt;tee.then(t=>{Yt=t});var y9=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),v9=new Uint32Array([0,1,2,3]),b9=new Uint8Array([4]),Bo=class extends Ht{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let i=this.data.scaleBaked,r=mm.div(e,i);this.subdividedGeometry&&oO(this.subdividedGeometry.attributes,...r),this.originalGeometry&&oO(this.originalGeometry.attributes,...r),this.data=t;let n=this.userData.parameters;this.userData.parameters={width:n.width*r[0],height:n.height*r[1],depth:n.depth*r[2]},this.originalGeometry.boundingSphere.center.multiply(Xg.fromArray(r));let s=Xg.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,i;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:i}=Bo.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new Cu(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let r=this.subdividedGeometry??this.originalGeometry;Object.assign(this,r),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Bo.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new xa,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;UA.setFromBufferAttribute(e),UA.getCenter(i),t.boundingSphere.radius=i.distanceTo(UA.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),UA.getSize(Xg);let r={width:Xg.x,height:Xg.y,depth:Xg.z};return this.userData.parameters=r,r}static build(t,e,i,r){let n,s,o,a=(t==null?void 0:t.phongAngle)??35;i===!1&&(a=-1),e&&(Yt.free_bvh(e),Yt.free_subdivision_surface(e));try{n=Bo.allocate(t,r)}catch(l){console.error(l,t),n=Bo.allocate({positionWASM:y9,indexWASM:v9,verticesPerFaceWASM:b9},r)}if(Yt.set_destination_refinement_level(n,0),s=Bo.buildLevel(n,!0,a),t.subdivisions>0)try{Yt.set_destination_refinement_level(n,t.subdivisions),o=Bo.buildLevel(n,!1,a)}catch{try{Yt.set_destination_refinement_level(n,t.subdivisions-1),o=Bo.buildLevel(n,!1,a)}catch{o=null}}else o=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,i){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let r=t.shape!==void 0||t.path!==void 0?e.geometry:h1(t,i,!1),n;t.type==="TorusGeometry"&&t.arc===Math.PI*2?n=r.getClosedTorusIndicesForBooleanOrSubdiv():n=r.getIndex();let s,o,a,l;({positions:s,triIndices:l}=VP(r.getAttribute("position"),n));let u;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let c=t.radialSegments*t.heightSegments*3*2,h=c+t.radialSegments*3;u=[c,h]}return{indices:o,verticesPerFace:a}=iee(s,l,r,u),{positions:s,indices:o,verticesPerFace:a}}static allocate(t,e){var b;let i,r,n,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(i=t.positionWASM,r=t.indexWASM,n=t.verticesPerFaceWASM):(i=y9,r=v9,n=b9);let a=i.length,l=r.length,u=n.length,c=i.length+s.length+o.length,h=r.length+n.length,d=c*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,p=c*Float32Array.BYTES_PER_ELEMENT,f=Yt._malloc(d),m=new Float32Array(Yt.HEAPF32.buffer,f,c),g=new Uint32Array(Yt.HEAPU32.buffer,f+p,h);m.set(i,0),m.set(s,i.length),m.set(o,i.length+s.length),g.set(r,0),g.set(n,r.length);let y;(b=t==null?void 0:t.scaleBaked)!=null&&b.some(_=>_!==1)&&(y=new lt().makeScale(...t.scaleBaked)),e&&(y?y.premultiply(e):y=e);let v=y?Yt.alloc_subdivision_surface2(f,a,f+p,l,f+p+r.length*Uint32Array.BYTES_PER_ELEMENT,u,y.elements):Yt.alloc_subdivision_surface(f,a,f+p,l,f+p+r.length*Uint32Array.BYTES_PER_ELEMENT,u);return Yt._free(f),v}static buildLevel(t,e,i,r,n){let s=n?Yt.get_mesh_data2(t,e?Yt.Level.CONTROL:Yt.Level.REFINED,i,n.elements):Yt.get_mesh_data(t,e?Yt.Level.CONTROL:Yt.Level.REFINED,i),o=8,a=Yt.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),u=0,c=Yt.HEAPU32[a[u]>>2],h=Yt.HEAPF32.subarray(c>>2,(c>>2)+l[u]);u++;let d=Yt.HEAPU32[a[u]>>2],p=Yt.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let f=Yt.HEAPU32[a[u]>>2],m=Yt.HEAPU32.subarray(f>>2,(f>>2)+l[u]);u++;let g=Yt.HEAPU32[a[u]>>2],y=Yt.HEAPU32.subarray(g>>2,(g>>2)+l[u]);if(u++,r===void 0){let v=new Ht;if(v.setIndex(new Sv(y,1)),v.setAttribute("position",new _t(h,3)),v.setAttribute("normal",new _t(p,3)),e){v.setAttribute("faceMap",new Sv(m,1));let b=new Float32Array(p.length/3*4).fill(0);v.setAttribute("color",new ei(b,4))}return Yt.free_mesh_data(s),v.userData.type="SubdivGeometry",v}r.getAttribute("position").copyArray(h),r.getAttribute("normal").copyArray(p),r.attributes.position.needsUpdate=!0,r.attributes.normal.needsUpdate=!0,Yt.free_mesh_data(s)}static freeSubdivPointer(t){Yt.free_bvh(t),Yt.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,i){let r=Yt.get_wireframe_data_for_base_level(t),n=4,s=Yt.HEAPU32.subarray(r>>2,(r>>2)+n),o=s.subarray(2,2+2),a=0,l=Yt.HEAPU32[s[a]>>2],u=Yt.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let c=Yt.HEAPU32[s[a]>>2],h=Yt.HEAPU32.subarray(c>>2,(c>>2)+o[a]);if(e===void 0){let d=new Ht;d.setAttribute("position",new _t(u,3));let p=new Float32Array(u.length);for(let f=0,m=u.length;f<m;)p[f++]=i.r,p[f++]=i.g,p[f++]=i.b;return d.setAttribute("color",new ei(p,3)),d.setIndex(new Sv(h,1)),Yt.free_wireframe_data_for_base_level(r),d}e.getAttribute("position").copyArray(u),e.attributes.position.needsUpdate=!0,Yt.free_wireframe_data_for_base_level(r)}static updateCollabMesh(t,e,i){let r=e===0;r||Yt.set_destination_refinement_level(t,e);let n=i?Yt.get_topological_data2(t,r?Yt.Level.CONTROL:Yt.Level.REFINED,i.elements):Yt.get_topological_data(t,r?Yt.Level.CONTROL:Yt.Level.REFINED),s=6,o=Yt.HEAPU32.subarray(n>>2,(n>>2)+s),a=o.subarray(3,3+3),l=0,u=Yt.HEAPU32[o[l]>>2],c=new Float32Array(Yt.HEAPF32.subarray(u>>2,(u>>2)+a[l]));l++;let h=Yt.HEAPU32[o[l]>>2],d=new Uint32Array(Yt.HEAPU32.subarray(h>>2,(h>>2)+a[l]));l++;let p=Yt.HEAPU32[o[l]>>2],f=new Uint8Array(Yt.HEAPU32.subarray(p>>2,(p>>2)+a[l]));return Yt.free_topological_data(n),{positions:c,indices:d,verticesPerFace:f}}},x9=["getX","getY","getZ"];function VP(t,e){let i={},r=e?e.count:t.count,n=0,s=[],o=[],a=1e4;for(let u=0;u<r;u++){let c=e?e.getX(u):u,h="";for(let d=0;d<3;d++)h+=`${~~(t[x9[d]](c)*a)},`;if(h in i)s.push(i[h]);else{for(let d=0;d<3;d++)o.push(t[x9[d]](c));i[h]=n,s.push(n),n++}}let l=[];for(let u=0;u<s.length;u+=3)s[u]===s[u+1]||s[u]===s[u+2]||s[u+1]===s[u+2]||l.push(s[u],s[u+1],s[u+2]);return{positions:o,triIndices:l}}var NA=new N,WD=new N,qD=new N,XD=new N;function iee(t,e,i,r){let n=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let l=i.userData.shape.extractShapePointsToFlatArray([]),u=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&u<=24&&u%4===0&&i.userData.parameters.angle>=360){let d=l.length/2/u;l=l.filter((p,f)=>Math.floor(f/2)%d===0)}let c=0;for(let d=0;d<l.length;d+=2)c+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);t.length=0;let h=0;if(c<0)for(let d=0;d<l.length;d+=2)t.push(l[d],l[d+1],0),n.push(h++);else for(let d=l.length-2;d>=0;d-=2)t.push(l[d],l[d+1],0),n.push(h++);return s.push(h),{indices:n,verticesPerFace:s}}let o=new Float32Array([i.userData.parameters.depth])[0],a=0;for(;a<e.length;){if(i.useNgonForTopBottomFaceDuringBake){let l=0;if((t[e[a]*3+2]===o||t[e[a]*3+2]===0)&&l++,(t[e[a+1]*3+2]===o||t[e[a+1]*3+2]===0)&&l++,(t[e[a+2]*3+2]===o||t[e[a+2]*3+2]===0)&&l++,l===3)break}if(e[a+1]===e[a+3]&&e[a+2]===e[a+5]||e[a+0]===e[a+3]&&e[a+2]===e[a+4]){NA.set(t[e[a]*3],t[e[a]*3+1],t[e[a]*3+2]),WD.set(t[e[a+1]*3],t[e[a+1]*3+1],t[e[a+1]*3+2]),qD.set(t[e[a+4]*3],t[e[a+4]*3+1],t[e[a+4]*3+2]),XD.set(t[e[a+5]*3],t[e[a+5]*3+1],t[e[a+5]*3+2]),WD.sub(NA).normalize(),qD.sub(NA).normalize(),XD.sub(NA).normalize();let l=WD.cross(qD).dot(XD);Math.abs(l)>.005||r&&r.some((u,c)=>c%2===1?!1:a>=r[c]&&a<r[c+1])?(n.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3):(n.push(e[a],e[a+1],e[a+4],e[a+5]),s.push(4),a+=6)}else n.push(e[a],e[a+1],e[a+2]),s.push(3),a+=3}if(i.useNgonForTopBottomFaceDuringBake){let l=[],u=[],c=0;for(let h=0,d=0;h<t.length;h+=3,d++)t[h+2]===0&&(l.push(d),c++),t[h+2]===o&&u.push(d);if(i.userData.parameters.extrudeBevelSize===0){let h=u[0];u[0]=u[1],u[1]=h}l.reverse(),n.push(...l,...u),s.push(c,c)}return{indices:n,verticesPerFace:s}}var Ac={};lce(Ac,{calcBoolean:()=>sPe,calcBooleanTopological:()=>nPe,freeMeshSet:()=>uPe,getMeshSet:()=>oPe,hasOpenEdges:()=>aPe,transformMeshSet:()=>lPe});var ree,tPe=new Promise(t=>{ree=t}),FA;function iPe(){if(FA)return FA;async function t(){let e="https://unpkg.com/@splinetool/boolean-wasm@1.0.53/build",i=L0(()=>import("./boolean-f0a11cc6.js"),[]),[r,n]=await Promise.all([i,fetch(`${e}/boolean.wasm`).then(a=>a.arrayBuffer())]),s=r.default,o=await s({wasmBinary:n});ree(o)}return FA=t(),FA}var Mi,Dv;tPe.then(t=>Mi=t);function rPe(t,e,i){let r,n;t.userData.parameters.type==="TorusGeometry"&&t.userData.parameters.arc===Math.PI*2?n=t.getClosedTorusIndicesForBooleanOrSubdiv():n=t.getIndex();let{positions:s,triIndices:o}=VP(t.getAttribute("position"),n),a;if(e&&i){let{indices:l,verticesPerFace:u}=iee(s,o,t);a=u.length,r=[];for(let c=0,h=0;c<a;c++){r.push(u[c]);for(let d=0;d<u[c];d++)r.push(l[h++])}}else{let l=o.length;r=Array(l+l/3),a=0;for(let u=0,c=0;c<r.length;)r[c++]=3,a++,r[c++]=o[u++],r[c++]=o[u++],r[c++]=o[u++]}return{positions:s,faceIndices:r,nFaces:a}}function nee(t){let e=t.length,i=e*Uint32Array.BYTES_PER_ELEMENT,r=e*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(t[0])?i:r,s=Mi._malloc(n);return(Number.isInteger(t[0])?new Uint32Array(Mi.HEAPU32.buffer,s,e):new Float32Array(Mi.HEAPF32.buffer,s,e)).set(t,0),s}function see(t){switch(t){case 0:return Mi.OP.UNION;case 1:return Mi.OP.INTERSECTION;case 2:return Mi.OP.A_MINUS_B;case 3:return Mi.OP.B_MINUS_A;case 4:return Mi.OP.SYMMETRIC_DIFFERENCE;case 5:return Mi.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function nPe(t,e){Dv===void 0&&(Dv=Mi.init_csg());let i=nee(t),r=Mi.csg_calc_topological(Dv,i,t.length,see(e));Mi._free(i);let n=6,s=Mi.HEAPU32.subarray(r>>2,(r>>2)+n),o=s.subarray(3,3+3),a=0,l=Mi.HEAPU32[s[a]>>2],u=new Float32Array(Mi.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let c=Mi.HEAPU32[s[a]>>2],h=new Uint32Array(Mi.HEAPU32.subarray(c>>2,(c>>2)+o[a]));a++;let d=Mi.HEAPU32[s[a]>>2],p=new Uint8Array(Mi.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return Mi.free_mesh_data(r),{positions:u,indices:h,verticesPerFace:p}}function sPe(t,e,i,r){Dv===void 0&&(Dv=Mi.init_csg());let n=nee(t),s=Mi.csg_calc(Dv,n,t.length,r,see(e));Mi._free(n);let o=5,a=Mi.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),u=0,c=Mi.HEAPU32[a[u]>>2],h=Mi.HEAPF32.subarray(c>>2,(c>>2)+l[u]);u++;let d=Mi.HEAPU32[a[u]>>2],p=Mi.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let f=l[u];i.setAttribute("position",new _t(h,3)),i.setAttribute("normal",new _t(p,3));let m=Mi.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new xa),i.boundingSphere.center.set(m[0],m[1],m[2]),i.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,i.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},Mi.free_mesh_data(s),f}function oPe(t,e,i){if(Mi===void 0)return-1;let r,n,s;if(e&&t.userData.positions!==void 0){let g=t.userData;s=g.verticesPerFace.length,r=g.positions,n=Array(g.verticesPerFace.reduce((y,v)=>y+v,0)+s);for(let y=0,v=0,b=0;y<g.verticesPerFace.length;y++){n[b++]=g.verticesPerFace[y];for(let _=0;_<g.verticesPerFace[y];_++)n[b++]=g.indices[v++]}}else({positions:r,faceIndices:n,nFaces:s}=rPe(t,e,i));let o=r.length,a=n.length,l=r.length,u=n.length,c=l*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=Mi._malloc(c),p=new Float32Array(Mi.HEAPF32.buffer,d,l),f=new Uint32Array(Mi.HEAPU32.buffer,d+h,u);p.set(r,0),f.set(n,0);let m=Mi.get_csg_mesh(d,o,d+h,a,s);return Mi._free(d),m}function aPe(t){return Mi.has_open_edges(t)}function lPe(t,e){Mi.transform_csg_mesh(t,e.elements)}function uPe(t){Mi.free_csg_mesh(t)}var hPe={ConeGeometry:TCe,CubeGeometry:RCe,CylinderGeometry:D$,DodecahedronGeometry:DCe,EllipseGeometry:bz,HelixGeometry:h2e,IcosahedronGeometry:c2e,LatheGeometry:d2e,NonParametricGeometry:b2e,PolygonGeometry:K$,PyramidGeometry:x2e,RectangleGeometry:xz,SphereGeometry:S2e,PlaneGeometry:A2e,BackdropGeometry:E2e,StarGeometry:J$,TextFrameGeometry:C2e,TorusGeometry:P2e,TorusKnotGeometry:R2e,TriangleGeometry:k2e,PathGeometry:q2e,VectorGeometry:tg},w9=t=>hPe[t.type].create(t);function Yg(t){return t!==null&&"booleanOp"in t}var oee=class extends pz(zn){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new lt}updateVisible(t){super.updateVisible(t),this.visible=!Yg(this.parent)&&this.visible,Yg(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ac.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Yg(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof oee&&(t.freeBooleanPointer(),Yg(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t,e){let i=super.updateTransformState(t,e);return i&&Yg(this.parent)&&this.invalidateDownstreamBooleanData(!0),i}onVariableUpdate(t=!1){super.onVariableUpdate(t),Yg(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},zA=new Mn;function wz(t,e=0,i=t.count,r,n){let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,c=-1/0;for(let h=e;h<i;h++){let d=t.getX(h),p=t.getY(h),f=t.getZ(h);d<s&&(s=d),p<o&&(o=p),f<a&&(a=f),d>l&&(l=d),p>u&&(u=p),f>c&&(c=f)}zA.min.set(s,o,a),zA.max.set(l,u,c),zA.getCenter(r),zA.getSize(n).multiplyScalar(.5)}var cPe=new Ht,dPe=new Km,qo=class extends oee{constructor(t,e){super(cPe,dPe),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?wz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},_9=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},Yp=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=kt.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,i){return i=i??{},this.analyze(t,i),this.flow(t,e,i)}flow(t,e,i){i=i??{},t.addFlow(i.slot,i.cache,i.context);let r={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),r}build(t,e,i){e=e??this.getType(t,e);let r=t.getNodeData(i??this);return t.analyzing&&this.appendDepsNode(t,r,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,i)}updateFrame(t){}generateReadonly(t,e,i,r,n,s){return""}generate(t,e,i,r,n){return""}parse(t,e,i,r){}appendDepsNode(t,e,i){e.deps=(e.deps||0)+1;let r=t.getTypeLength(i);(r>(e.outputMax||0)||this.getType(t,i))&&(e.outputMax=r,e.output=i)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,i;for(e in this)i=this[e],i instanceof Yp&&(t+='"'+e+'":'+i.getHash()+",");if(this.hashProperties)for(let r=0;r<this.hashProperties.length;r++)e=this.hashProperties[r],i=this[e],t+='"'+e+'":"'+String(i)+'",';return t+='"id":"'+this.uuid+'"}',t}},pPe=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,i){i=i!==void 0?i:!0,this.keywords[t]={callback:e,cache:i}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},ca=new pPe,dr=class extends Yp{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=e.shared!==void 0?e.shared:!0,this.unique=e.unique!==void 0?e.unique:!1}build(t,e,i,r){if(e=e??this.getType(t),this.getShared(t,e)){let n=this.getUnique(t,e);n&&this.uuid===void 0&&(this.uuid=kt.generateUUID()),i=t.getUUID(i??this.getUUID(),!n);let s=t.getNodeData(i),o=s.output||this.getType(t);if(t.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,s,e),this.generate(t,e,i)):super.build(t,e,i);if(n)return s.name=s.name||super.build(t,e,i),s.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||s.deps===1))return super.build(t,e,i);i=this.getUUID(!1);let a=this.getTemp(t,i);if(a)return t.format(a,o,e);{a=super.generate(t,e,i,s.output,r);let l=this.generate(t,o,i);return t.addNodeCode(a+" = "+l+";"),t.format(a,o,e)}}return super.build(t,e,i)}getShared(t,e){return e!=="sampler2D"&&e!=="samplerCube"&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return typeof this.scope=="string"&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let i=t.getVars()[e];return i?i.name:void 0}generate(t,e,i,r,n){return this.getShared(t,e)||console.error("TempNode is not shared"),i=i??this.uuid,t.getTempVar(i,r??this.getType(t),n,this.getLabel()).name}},_a=class extends dr{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,i,r,n,s){i=t.getUUID(i??this.getUUID()),r=r??this.getType(t);let o=t.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,i,r,n,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(r,this,n,s,this.getLabel())),t.format(o.vertex.name,r,e)):(o.fragment||(o.fragment=t.createFragmentUniform(r,this,n,s,this.getLabel())),t.format(o.fragment.name,r,e))}},Os=class extends _a{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof me?t:new me(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,i,r,n,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",r,e)}},yl=class extends _a{constructor(t=0,e,i){super("v3"),this.nodeType="Vector3",this.value=t instanceof N?t:new N(t,e,i)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,i,r,n,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,e)}},Ws=class extends Xt{constructor(e,i,r,n){super(e,i,r),this.isColorA=!0,this.a=n}setRGBA(e,i,r,n){super.setRGB(e,i,r),this.a=n}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,i="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let n,s=r[1],o=r[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.a=s==="rgba"?parseFloat(n[4]):1,super.setStyle(e,i);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.a=s==="hsla"?parseFloat(n[4]):1,super.setStyle(e,i);break}}return super.setStyle(e,i)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Ec=class extends _a{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof Ws?t:new Ws(t.r,t.g,t.b,t.a)}generateReadonly(t,e,i,r,n,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",r,e)}},fPe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,S9=/[a-z_0-9]+/gi,xt=class extends dr{constructor(t,e,i,r,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(t,e,i,r)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,i,r,n){let s,o=0,a=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)t.include(this.includes[u],this);for(let u in this.extensions)t.extensions[u]=!0;let l=[];for(;s=S9.exec(this.src);)l.push(s);for(let u=0;u<l.length;u++){let c=l[u],h=c[0],d=this.isMethod?!this.getInputByName(h):!0,p=h;if(this.keywords[h]||this.useKeywords&&d&&ca.containsKeyword(h)){let f=this.keywords[h];if(!f){let m=ca.getKeywordData(h);m.cache&&(f=t.keywords[h]),f=f||ca.getKeyword(h,t),m.cache&&(t.keywords[h]=f)}p=f.build(t)}h!==p&&a[c.index+o-1]!=="."&&(a=a.substring(0,c.index+o)+p+a.substring(c.index+h.length+o),o+=p.length-h.length),this.getIncludeByName(p)===void 0&&ca.contains(p)&&t.include(ca.get(p))}return e==="source"?a:this.isMethod?(this.isInterface||t.include(this,void 0,a),this.name):t.format("( "+a+" )",this.getType(t),e)}parse(t,e,i,r){if(this.src=t||"",this.includes=e??[],this.extensions=i??{},this.keywords=r??{},this.isMethod){let n=fPe.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(S9);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let u=s[o++];this.inputs.push({name:u,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},mPe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,aee=class extends dr{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||aee.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,i,r,n){this.src=t||"";let s,o,a="",l=mPe.exec(t);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,i,r,n){return t.format(this.name,this.getType(t),e)}},sr=aee;sr.PI="PI",sr.PI2="PI2",sr.RECIPROCAL_PI="RECIPROCAL_PI",sr.RECIPROCAL_PI2="RECIPROCAL_PI2",sr.LOG2="LOG2",sr.EPSILON="EPSILON";var gPe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),yPe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),lee=class extends dr{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,i,r,n){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=gPe.exec(t);if(e){let i=e[2],r;for(;r=yPe.exec(i);)this.inputs.push({type:r[1],name:r[2]});this.name=e[1]}else this.name="";this.type=this.name}},_z=class extends dr{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",r=t.isShader("vertex")?"uv"+i:"vUv"+i;return t.format(r,this.getType(t),e)}};ca.addKeyword("uv",function(){return new _z});ca.addKeyword("uv2",function(){return new _z(1)});var Hy=class extends dr{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??Hy.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case Mu:return["Linear"];case pi:return["sRGB"];default:return[]}}generate(t,e){var o;let i=this.input.build(t,"v4"),r=this.getType(t),n=Hy.Nodes[this.method],s=t.include(n);if(s===Hy.LINEAR_TO_LINEAR)return t.format(i,r,e);if(((o=n.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+i+", "+a+" )",r,e)}else return t.format(s+"( "+i+" )",r,e)}fromEncoding(t){let e=Hy.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=Hy.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},bh=Hy;bh.Nodes={LinearToLinear:new xt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new xt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new xt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},bh.LINEAR_TO_LINEAR="LinearToLinear",bh.SRGB_TO_LINEAR="sRGBToLinear",bh.LINEAR_TO_SRGB="LinearTosRGB";var Sr=class extends xt{constructor(t="",e,i,r,n){super(t,n,r,i,e),this.nodeType="Expression"}},Dc=class extends _a{constructor(t=new Wr,e,i,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new _z,this.bias=i,this.project=r!==void 0?r:!1}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if(e==="sampler2D")return this.getTexture(t,e);let i=this.getTexture(t,e),r=this.uv.build(t,this.project?"v4":"v2"),n=this.bias?this.bias.build(t,"f"):void 0;n===void 0&&t.context.bias&&(n=t.context.bias.setTexture(this).build(t,"f"));let s,o;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?o=s+"( "+i+", "+r+", "+n+" )":o=s+"( "+i+", "+r+" )";let a={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace??new bh(new Sr("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(t,l),t.removeContext(),t.format(o,l,e)}},Pt=class extends _a{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,i,r,n,s){return t.format(this.value+(this.value%1?"":".0"),r,e)}},A9=class extends dr{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,i,r,n){r=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let u=s.inputs[l],c=this.inputs[l]||this.inputs[u.name];a.push(c.build(t,t.getTypeByFormat(u.type)))}o+=a.join(", ")+" )"}return t.format(o,r,e)}},uee=class extends dr{constructor(t,e,i=uee.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=i}getType(t){let e=this.a.getType(t),i=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(i)>t.getTypeLength(e)?i:e}generate(t,e){let i=this.getType(t);this.type=i;let r=this.a.build(t,i),n=this.b.build(t,i);return t.format("( "+r+" "+this.op+" "+n+" )",i,e)}},aa=uee;aa.ADD="+",aa.SUB="-",aa.MUL="*",aa.DIV="/";var nr=class extends dr{constructor(t,e=nr.ABS,i,r){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:r=e,typeof i!="string"?this.c=i:r=i,this.method=r,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case nr.MIX:case nr.CLAMP:case nr.REFRACT:case nr.SMOOTHSTEP:case nr.FACEFORWARD:return 3;case nr.MIN:case nr.MAX:case nr.MOD:case nr.STEP:case nr.REFLECT:case nr.DISTANCE:case nr.DOT:case nr.CROSS:case nr.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),i=this.b?t.getTypeLength(this.b.getType(t)):0,r=this.c?t.getTypeLength(this.c.getType(t)):0;return e>i&&e>r?this.a.getType(t):i>r?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case nr.LENGTH:case nr.DISTANCE:case nr.DOT:return"f";case nr.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let i,r,n,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),u=this.getType(t);switch(this.type=u,this.method){case nr.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case nr.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case nr.CROSS:i=this.a.build(t,"v3"),r=this.b.build(t,"v3");break;case nr.STEP:i=this.a.build(t,s===1?"f":l),r=this.b.build(t,l);break;case nr.MIN:case nr.MAX:case nr.MOD:i=this.a.build(t,l),r=this.b.build(t,o===1?"f":l);break;case nr.REFRACT:i=this.a.build(t,l),r=this.b.build(t,l),n=this.c.build(t,"f");break;case nr.MIX:i=this.a.build(t,l),r=this.b.build(t,l),n=this.c.build(t,a===1?"f":l);break;default:i=this.a.build(t,l),this.b&&(r=this.b.build(t,l)),this.c&&(n=this.c.build(t,l));break}let c=[];c.push(i),r&&c.push(r),n&&c.push(n);let h=this.getNumInputs(t);if(c.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${c.length}.`);return t.format(this.method+"( "+c.join(", ")+" )",u,e)}},ci=nr;ci.RAD="radians",ci.DEG="degrees",ci.EXP="exp",ci.EXP2="exp2",ci.LOG="log",ci.LOG2="log2",ci.SQRT="sqrt",ci.INV_SQRT="inversesqrt",ci.FLOOR="floor",ci.CEIL="ceil",ci.NORMALIZE="normalize",ci.FRACT="fract",ci.SATURATE="saturate",ci.SIN="sin",ci.COS="cos",ci.TAN="tan",ci.ASIN="asin",ci.ACOS="acos",ci.ARCTAN="atan",ci.ABS="abs",ci.SIGN="sign",ci.LENGTH="length",ci.NEGATE="negate",ci.INVERT="invert",ci.MIN="min",ci.MAX="max",ci.MOD="mod",ci.STEP="step",ci.REFLECT="reflect",ci.DISTANCE="distance",ci.DOT="dot",ci.CROSS="cross",ci.POW="pow",ci.MIX="mix",ci.CLAMP="clamp",ci.REFRACT="refract",ci.SMOOTHSTEP="smoothstep",ci.FACEFORWARD="faceforward";var Gx=class extends dr{constructor(t,e,i){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=i}bilinearCubeUV(t,e,i,r){let n=new A9(Gx.Nodes.bilinearCubeUV,[e,i,r]);this.colorSpaceTL=this.colorSpaceTL??new bh(new Sr("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new bh(new Sr("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new bh(new Sr("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new bh(new Sr("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new Sr(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new Sr(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new Sr(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new Sr(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new Sr("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=n,o}generate(t,e){if(t.isShader("fragment")){let i=this.uv,r=this.bias||t.context.roughness,n=new A9(Gx.Nodes.roughnessToMip,[r]),s=new ci(n,Gx.Nodes.m0,Gx.Nodes.cubeUV_maxMipLevel,ci.CLAMP),o=new ci(s,ci.FLOOR),a=new ci(s,ci.FRACT),l=this.bilinearCubeUV(t,this.value,i,o),u=this.bilinearCubeUV(t,this.value,i,new aa(o,new Pt(1).setReadonly(!0),aa.ADD)),c=new ci(l,u,a,ci.MIX);return t.format(c.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},aO=Gx;aO.Nodes=function(){let t=new lee(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new sr("float cubeUV_maxMipLevel 8.0",!0),i=new sr("float cubeUV_minMipLevel 4.0",!0),r=new sr("float cubeUV_maxTileSize 256.0",!0),n=new sr("float cubeUV_minTileSize 16.0",!0),s=new xt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new xt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new xt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,i,r,n]);a.useKeywords=!1;let l=new sr("float r0 1.0",!0),u=new sr("float v0 0.339",!0),c=new sr("float m0 -2.0",!0),h=new sr("float r1 0.8",!0),d=new sr("float v1 0.276",!0),p=new sr("float m1 -1.0",!0),f=new sr("float r4 0.4",!0),m=new sr("float v4 0.046",!0),g=new sr("float m4 2.0",!0),y=new sr("float r5 0.305",!0),v=new sr("float v5 0.016",!0),b=new sr("float m5 3.0",!0),_=new sr("float r6 0.21",!0),A=new sr("float v6 0.0038",!0),S=new sr("float m6 4.0",!0),E=[l,u,c,h,d,p,f,m,g,y,v,b,_,A,S],M=new xt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,E);return{bilinearCubeUV:a,roughnessToMip:M,m0:c,cubeUV_maxMipLevel:e}}();var Gy=class extends dr{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Gy.VIEW}getShared(){return this.scope===Gy.WORLD}build(t,e,i,r){let n=t.context[this.scope+"Normal"];return n?n.build(t,e,i,r):super.build(t,e,i)}generate(t,e,i,r,n){let s;switch(this.scope){case Gy.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Gy.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case Gy.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},ma=Gy;ma.LOCAL="local",ma.WORLD="world",ma.VIEW="view",ma.NORMAL="normal";ca.addKeyword("viewNormal",function(){return new ma(ma.VIEW)});ca.addKeyword("localNormal",function(){return new ma(ma.NORMAL)});ca.addKeyword("worldNormal",function(){return new ma(ma.WORLD)});var wc=class extends dr{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??wc.LOCAL}getType(){switch(this.scope){case wc.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case wc.LOCAL:case wc.WORLD:return!1}return!0}generate(t,e,i,r,n){let s;switch(this.scope){case wc.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case wc.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case wc.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case wc.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},yu=wc;yu.LOCAL="local",yu.WORLD="world",yu.VIEW="view",yu.PROJECTION="projection";ca.addKeyword("position",function(){return new yu});ca.addKeyword("worldPosition",function(){return new yu(yu.WORLD)});ca.addKeyword("viewPosition",function(){return new yu(yu.VIEW)});var oh=class extends dr{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??oh.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case oh.SPHERE:return"v2"}return this.type}generate(t,e){let i=this.getUnique(t);if(t.isShader("fragment")){let r;switch(this.scope){case oh.VECTOR:{let n=new ma(ma.VIEW),s=t.context.roughness,o=n.build(t,"v3"),a=new yu(yu.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,u=`reflect( -normalize( ${a} ), ${o} )`;l&&(u=`normalize( mix( ${u}, ${o}, ${l} * ${l} ) )`);let c=`inverseTransformDirection( ${u}, viewMatrix )`;i?(t.addNodeCode(`vec3 reflectVec = ${c};`),r="reflectVec"):r=c;break}case oh.CUBE:{let n=new oh(oh.VECTOR).build(t,"v3"),s="vec3( -"+n+".x, "+n+".yz )";i?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),r="reflectCubeVec"):r=s;break}case oh.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new oh(oh.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(t.addNodeCode(`vec2 reflectSphereVec = ${n};`),r="reflectSphereVec"):r=n;break}}return t.format(r,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},Iv=oh;Iv.CUBE="cube",Iv.SPHERE="sphere",Iv.VECTOR="vector";var vPe=class extends dr{constructor(t=new Dc,e,i){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new aO(this.value,e??new Iv(Iv.VECTOR),i),this.irradianceNode=new aO(this.value,new ma(ma.WORLD),new Pt(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},bPe=class extends _a{constructor(t=new AF,e,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new Iv,this.bias=i}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let i=this.getTexture(t,e),r=(l=this.uv)==null?void 0:l.build(t,"v3"),n=this.bias?this.bias.build(t,"f"):void 0;n===void 0&&t.context.bias&&(n=t.context.bias.setTexture(this).build(t,"f"));let s;n?s="texCubeBias( "+i+", "+r+", "+n+" )":s="texCube( "+i+", "+r+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new bh(new Sr("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},xPe=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,wPe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,_Pe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,SPe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,APe=`
layout(location = 1) out vec4 gVelocity;
`,EPe=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,E9=["x","y","z","w"],MPe=["float","vec2","vec3","vec4"],CPe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},PPe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},hee=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function t(e,i){return e.deps.length-i.deps.length}return function(e,i){let r=this.getIncludes(e,i);if(!r)return"";let n="";r=r.sort(t);for(let s=0;s<r.length;s++)r[s].src&&(n+=r[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.addVertexParsCode(xPe),this.addFragmentParsCode(wPe),this.buildShader("vertex",t),this.buildShader("fragment",e);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let r=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+r+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+r+";"),this.addVertexFinalCode("vUv"+r+" = uv"+r+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(_Pe),this.addFragmentFinalCode(SPe)),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,i){return this.addSlot(t).addCache(e).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,i,r="varying",n="V",s=""){let o=this.getVars(r),a=o[t];if(!a){let l=o.length;a={name:i||"node"+n+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,i,r){return this.getVar(t,e,i,this.shader,"T",r)}getAttribute(t,e){if(!this.attributes[t]){let i=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(i.name+" = "+t+";"),this.attributes[t]={varying:i,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let i="";for(let r=0,n=t.length;r<n;++r){let s=t[r],o=s.type,a=s.name,l=s.size,u=this.getFormatByType(o);if(u===void 0)throw new Error("Node pars "+u+" not found.");u.includes("[]")?i+=e+" "+u.substring(0,u.length-2)+" "+a+`[${l}];
`:i+=e+" "+u+" "+a+`;
`}return i}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof Yp?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,i,r,n,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new _9({type:e,size:i.size,name:r||"nodeUA"+a+(s?"_"+s:""),node:i,needsUpdate:n});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new _9({type:e,name:r||"nodeU"+a+(s?"_"+s:""),node:i,needsUpdate:n});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,i,r,n){return this.createUniform("vertex",t,e,i,r,n)}createFragmentUniform(t,e,i,r,n){return this.createUniform("fragment",t,e,i,r,n)}include(t,e,i){var s;let r;if(t=typeof t=="string"?ca.get(t):t,this.context.include===!1)return t.name;t instanceof xt?r=this.includes.functions:t instanceof sr?r=this.includes.consts:t instanceof lee&&(r=this.includes.structs);let n=r[this.shader]=r[this.shader]||[];if(t){let o=n[t.name];if(o||(o=n[t.name]={node:t,deps:[]},n.push(o),o.src=t.build(this,"source")),t instanceof xt&&e&&n[e.name]&&n[e.name].deps.indexOf(t)===-1&&(n[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return i&&(o.src=i),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return MPe[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!=null&&i.isNode)return i}}resolve(...t){for(let e=0;e<arguments.length;e++){let i=t[e];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case km:case Dm:return new bPe(i);case X1:return new vPe(new Dc(i));default:return new Dc(i)}else{if(i.isVector2)return new Os(i);if(i.isVector3)return new yl(i);if(i.isVector4)return new Ec(i)}}}}format(t,e,i){switch(this.colorToVector(i+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return CPe[t]||t}getFormatByType(t){return PPe[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return E9[t]}getIndexByElement(t){return E9.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=Mu,e===Mu&&this.context.gamma&&(e=pi),e}},cn=class extends _a{constructor(t=0,e,i,r){super("c"),this.nodeType="Color",this.value=t instanceof Ws?t:new Ws(t||0,e,i,r)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,i,r,n,s){i=t.getUUID(i??this.getUUID()),r=r??this.getType(t);let o=t.getNodeData(i),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,i,r,n,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(r,this,n,s,this.getLabel())),t.format(o.vertex.name,r,e)):(o.fragment||(o.fragment=t.createFragmentUniform(r,this,n,s,this.getLabel())),t.format(o.fragment.name,r,e))}generateReadonly(t,e,i,r,n,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",r,e)}},mr=class extends _a{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,i,r,n,s){return t.format(this.value.toString(),r,e)}},Uo=class extends _a{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,i,r){return t.format(this.value?"true":"false",r,e)}},Df=class extends _a{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},Sz=class extends _a{},TPe=class extends Sz{constructor(t){super("v3"),this.image=t,this._value=new N}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},lO=class extends Sz{constructor(t,e,i=1008){super("t"),this.image=t,this.wrap=e,this.minFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter)}},cee=class extends _a{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new wn}generateReadonly(t,e,i,r,n,s){return t.format("mat3("+this.value.elements.join(", ")+")",r,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},Nh=class extends _a{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new lt}generateReadonly(t,e,i,r,n,s){return t.format("mat4("+this.value.elements.join(", ")+")",r,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function M9(t,e,i){t.setUvTransform(i[0],i[1],e[0],e[1],0,0,0)}var RPe=class extends cee{constructor(t,e){super(new wn),this.repeat=t,this.offset=e,M9(this.value,t,e)}updateMatrix(){M9(this.value,this.repeat,this.offset)}},If=class extends _a{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof si?new Array(t).fill(e):new Array(t).fill(new si(0))}},C9=class extends dr{constructor(t,e,i,r){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=i,this.mode=r}generate(t,e){if(t.isShader("fragment")){let i=[];return i.push(this.a.build(t,"c")),i.push(this.b.build(t,"c")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),t.format("spe_blend("+i.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},dee=class extends dr{constructor(t,e){super("v3"),this.nodeType="CustomColor",this.color=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(dee.Nodes.customColor);t.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.color.build(t,"v3")),r.push(this.mask?`luminance(${this.mask.build(t,"v3")})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("CustomColorNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},uO=dee;uO.Nodes=function(){return{customColor:new xt(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var pee=class extends dr{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){let i=t.include(pee.Nodes.customNormal);t.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.cnormal.build(t,"v3")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},fee=pee;fee.Nodes=function(){return{customNormal:new xt(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Vx=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c,h){super("v3"),this.nodeType="CustomTexture",this.texture=t,this.textureSize=e,this.crop=i,this.projection=r,this.axis=n,this.side=s,this.size=o,this.blending=a,this.mat=l,this.isMask=h,this.alpha=u,this.mode=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,r;switch(this.projection.value){case 3:r=t.include(Vx.Nodes.cylindrical);break;case 2:r=t.include(Vx.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=["zy","xz","xy"][this.axis.value],a=new xt(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${o})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);r=t.include(a);break;case 4:r=t.include(Vx.Nodes.triplanar);break;default:r=t.include(Vx.Nodes.uv);break}t.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(t,"t")),n.push(this.textureSize.build(t,"v2")),n.push(this.crop.build(t,"f")),n.push(this.mat.build(t,"mat3")),n.push(this.size.build(t,"v2")),n.push(this.blending.build(t,"f")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),n.push(this.calpha),this.projection.value===4){let s=`${i}_writeUvs`,o=s+"0",a=s+"1",l=s+"2",u=`${i}_triplanarWeights`;t.addFragmentVariable(o,"vec2"),t.addFragmentVariable(a,"vec2"),t.addFragmentVariable(l,"vec2"),t.addFragmentVariable(u,"vec3"),n.push(o),n.push(a),n.push(l),n.push(u)}else{let s=`${i}_writeUvs`;t.addFragmentVariable(s,"vec2"),n.push(s)}return t.format(r+"("+n.join(",")+")",this.getType(t),e)}},Az=Vx;Az.Nodes=function(){let t=new xt(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),e=new xt(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new xt(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),r=new xt(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:t,spherical:e,uv:i,triplanar:r}}();var jx=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c,h){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=i,this.far=r,this.isVector=n,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=u,this.isMask=h,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`,r=new xt(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[jx.Nodes.vectorLinearWorldSpaceDepth,jx.Nodes.vectorLinearObjectSpaceDepth,jx.Nodes.vectorSphericalObjectSpaceDepth,jx.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${i}_SMOOTH`),this.isVector.value>.5&&t.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${i}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let n=t.include(r),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.isMask.build(t,"b")),s.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(n+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},mee=jx;mee.Nodes=function(){let t=new xt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new xt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new xt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),r=new xt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:r}}();var kPe=class extends dr{constructor(t,e,i,r,n,s,o,a){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=i,this.intensity=r,this.factor=n,this.isMask=a,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=new xt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),r=t.include(i),n=[];return n.push(this.color.build(t,"c")),n.push(this.bias.build(t,"f")),n.push(this.scale.build(t,"f")),n.push(this.intensity.build(t,"f")),n.push(this.factor.build(t,"f")),n.push(this.isMask.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),n.push(this.calpha),t.format(r+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},gee=class extends dr{constructor(t,e,i,r,n,s,o,a,l){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=i,this.steps=r,this.offset=n,this.morph=s,this.angle=o,this.isMask=l,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(gee.Nodes.gradient),r=[];return r.push(this.gradientType.build(t,"i")),r.push(this.smooth.build(t,"b")),r.push(this.colors.build(t,"v4[]")),r.push(this.steps.build(t,"f[]")),r.push(this.offset.build(t,"v2")),r.push(this.morph.build(t,"v2")),r.push(this.angle.build(t,"f")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},yee=gee;yee.Nodes=function(){return{gradient:new xt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var vee=class extends dr{constructor(t,e,i,r){super("v3"),this.nodeType="Matcap",this.texture=t,this.isMask=r,this.alpha=e,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let i=t.include(vee.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let r=[];return r.push(this.texture.generate(t,"t")),r.push("normal"),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},bee=vee;bee.Nodes=function(){return{matcap:new xt(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var Ez=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t.VORONOI="voronoi",t))(Ez||{}),ua=function(){let t=new xt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new xt(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new sr("float F3 0.3333333"),e.keywords.G3=new sr("float G3 0.1666667");let i=new xt(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),r=new xt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new xt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new xt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[r,n]),o=new xt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new xt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new xt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),u=new xt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);u.keywords.NUM_OCTAVES=new sr("int NUM_OCTAVES 5");let c=new xt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new xt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[r,n,c]),d=new xt(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new xt(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new xt(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),m=new xt(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),g=new xt(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),y=new xt(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),v=new xt(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,p,f,m,g,y]);return{simplex:e,simplexFractal:i,simplexAshima:s,fbm:u,perlin:h,voronoi:v}}(),xee=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g,y,v){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=i,this.fA=r,this.fB=n,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=u,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=m,this.smoothness=g,this.seed=y,this.quality=v,this.isMask=d,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,i,r,n){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(Ez)[this.noiseType.value],o=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,a=new xt(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${o}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[ua.simplex,ua.simplexFractal,ua.simplexAshima,ua.fbm,ua.perlin,ua.voronoi]),l=t.include(a),u=[];return u.push(this.scale.build(t,"f")),u.push(this.size.build(t,"v3")),u.push(this.move.build(t,"f")),u.push(this.fA.build(t,"v2")),u.push(this.fB.build(t,"v2")),u.push(this.distortion.build(t,"v2")),u.push(this.colorA.build(t,"v4")),u.push(this.colorB.build(t,"v4")),u.push(this.colorC.build(t,"v4")),u.push(this.colorD.build(t,"v4")),u.push(this.voronoiStyle.build(t,"i")),u.push(this.highCut.build(t,"f")),u.push(this.lowCut.build(t,"f")),u.push(this.smoothness.build(t,"f")),u.push(this.seed.build(t,"f")),u.push(this.quality.build(t,"i")),u.push(this.isMask.build(t,"b")),u.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),u.push(this.alpha.build(t,"f")),u.push(this.calpha),t.format(l+"("+u.join(",")+")",this.getType(t),e)}};xee.numOctaves=5;var wee=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c,h,d,p,f,m){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=i,this.contourWidth=r,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=u,this.compensation=c,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.compensation.value&&t.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let r=this.outlineWidth.build(t,"f"),n=this.resolution.build(t,"v2"),s=this.compensation.build(t,"b"),o=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(r,"uniform float"),t.addVertexParsVariable(n,"uniform vec2"),t.addVertexParsVariable(s,"uniform bool"),t.addVertexParsVariable(o,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float"),t.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${n} * (${r} / 2.0) * ${i}_clipPosition.w * 2.0 * ${o};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let r=t.include(wee.Nodes.outline),n=[];return n.push(this.outlineColor.build(t,"c")),n.push(this.contourColor.build(t,"c")),n.push(this.outlineWidth.build(t,"f")),n.push(this.contourWidth.build(t,"f")),n.push(this.contourThreshold.build(t,"f")),n.push(this.outlineThreshold.build(t,"f")),n.push(this.contourFrequency.build(t,"f")),n.push(this.outlineSmoothing.build(t,"f")),n.push(this.contourDirection.build(t,"v3")),n.push(this.positionalLines.build(t,"b")),n.push(this.resolution.build(t,"v2")),n.push(this.normalMap.getTexture(t,"t")),n.push(this.depthMap.getTexture(t,"t")),n.push(this.pixelRatio.build(t,"f")),n.push(this.compensation.build(t,"b")),n.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),n.push(this.alpha.build(t,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,t.format(r+"("+n.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},_ee=wee;_ee.Nodes=function(){let t=new xt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new xt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[t])}}();var _c=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g,y){super("v3"),this.nodeType="Pattern",this.style=t,this.projection=e,this.axis=i,this.blending=r,this.offset=n,this.colorA=s,this.colorB=o,this.frequency=a,this.size=l,this.variation=u,this.smoothness=c,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=m,this.isMask=y,this.alpha=g,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.require("position"),t.require("uv"),t.requires.uv=[!0],t.require("normal"),t.requires.normal=!0,t.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let r=`g${this.uuid.toString().replace(/-/g,"")}`,n=new xt(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new xt(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),o="";if(this.projection.value===4){let c=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;o=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${c};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let c=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}o=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${c};
				`}let a=new xt(`vec3 ${r}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${o}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,_c.DrawFunctions.circle,_c.DrawFunctions.ring,_c.DrawFunctions.polygon,_c.DrawFunctions.cross,_c.DrawFunctions.diamond,_c.DrawFunctions.checkerboard,_c.DrawFunctions.line,_c.DrawFunctions.wave]),l=t.include(a),u=[];return u.push("normal"),u.push(this.blending.build(t,"f")),u.push(this.style.build(t,"i")),u.push(this.offset.build(t,"v2")),u.push(this.colorA.build(t,"v4")),u.push(this.colorB.build(t,"v4")),u.push(this.frequency.build(t,"v2")),u.push(this.size.build(t,"f")),u.push(this.variation.build(t,"f")),u.push(this.smoothness.build(t,"f")),u.push(this.zigzag.build(t,"f")),u.push(this.rotation.build(t,"f")),u.push(this.vertical.build(t,"v2")),u.push(this.horizontal.build(t,"v2")),u.push(this.sides.build(t,"i")),u.push(this.isMask.build(t,"b")),u.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),u.push(this.alpha.build(t,"f")),u.push(this.calpha),t.format(l+"("+u.join(",")+")",this.getType(t),e)}else return console.warn("PatterNode is not compatible with "+t.shader+" shader."),t.format("vec3(0.0)",this.getType(t),e)}},See=_c;See.DrawFunctions=function(){let t=new xt(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),e=new xt(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[t]),i=new xt(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[e]),r=new xt(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[e]),n=new xt(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[e]),s=new xt(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[e]),o=new xt(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[e]),a=new xt(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new xt(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[e]),u=new xt(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:e,circle:i,ring:r,polygon:n,cross:s,diamond:o,checkerboard:a,line:l,wave:u}}();var Aee=class extends dr{constructor(t,e,i,r,n,s,o,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=i,this.noiseStrength=r,this.noiseScale=n,this.offset=s,this.isMask=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let i=t.include(Aee.Nodes.rainbow),r=[];return r.push(this.filmThickness.build(t,"f")),r.push(this.movement.build(t,"f")),r.push(this.wavelengths.build(t,"v3")),r.push(this.noiseStrength.build(t,"f")),r.push(this.noiseScale.build(t,"f")),r.push(this.offset.build(t,"v3")),r.push(this.isMask.build(t,"b")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Eee=Aee;Eee.Nodes=function(){let t=new xt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[ua.simplex]);return{rainbow:new xt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[t])}}();var Mee=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=i,this.source=r,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let i=t.include(Mee.Nodes.toon),r=[];return r.push(this.positioning.build(t,"i")),r.push(this.colors.build(t,"v4[]")),r.push(this.steps.build(t,"f[]")),r.push(this.source.build(t,"v3")),r.push(this.isWorldSpace.build(t,"b")),r.push(this.noiseStrength.build(t,"f")),r.push(this.noiseScale.build(t,"f")),r.push(this.shadowColor.build(t,"v4")),r.push(this.offset.build(t,"v3")),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Cee=Mee;Cee.Nodes=function(){let t=new xt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new xt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new xt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),r=new xt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new xt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[r]);return{toon:new xt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[ua.simplex,t,i,n])}}();var DPe=function(){return{textureBicubic:new xt(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function IPe(t,e){return t>=e?new me(e/t,1):new me(1,t/e)}var Pee=class extends dr{constructor(t,e,i,r,n,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=i,this.transmissionSamplerSize=r,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",6),t.define("BLUR_SLOD",Math.pow(2,Kt.transmissionLod.value)),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let i=t.include(Pee.Nodes.transmission),r=[];return r.push(this.thickness.build(t,"f")),r.push(this.ior.build(t,"f")),r.push(this.roughness.build(t,"f")),r.push(this.transmissionSamplerSize.build(t,"v2")),r.push(this.transmissionSamplerMap.getTexture(t,"t")),r.push(this.transmissionDepthMap.getTexture(t,"t")),r.push(this.aspectRatio.build(t,"v2")),r.push("normal"),r.push(this.mask?`luminance(${this.mask.flow(t,"v3").result})`:"1.0"),r.push(this.alpha.build(t,"f")),r.push(this.calpha),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},Tee=Pee;Tee.Nodes=function(){let t=new xt(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),e=new xt(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new xt(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),r=new xt(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[DPe.textureBicubic,i,t]),n=new xt(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[r,e]);return{transmission:new xt(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var hO=(t=>(t.NOISE="noise",t.MAP="map",t))(hO||{}),Ree=class extends dr{constructor(t,e,i,r,n,s,o,a,l,u,c){super("v3"),this.displacementTypeIndex=new mr(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(hO)[this.displacementTypeIndex.value]==="map"&&(this.mat=new cee(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=u,this.noiseFunctionIndex=c,this.voronoiStyle=r,this.smoothness=n,this.seed=s,this.highCut=o,this.lowCut=a,this.quality=l}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let i,r=[];switch(r.push("displaced_position"),r.push("displaced_normal"),Object.values(hO)[this.displacementTypeIndex.value]){case"map":{i=t.include(Ree.Nodes.map),r.push(this.movementOrTexture.getTexture(t,"t")),r.push("uv"),r.push(this.cropOrOffset.build(t,"f")),this.mat&&r.push(this.mat.build(t,"mat3"));break}case"noise":{let n=Object.values(Ez)[this.noiseFunctionIndex.value],s=new xt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,a=new xt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${o}
						}`,[ua.simplex,ua.simplexFractal,ua.simplexAshima,ua.fbm,ua.perlin,ua.voronoi]),l=new xt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);i=t.include(l),r.push(this.scale.build(t,"f")),r.push(this.cropOrOffset.build(t,"v3")),r.push(this.movementOrTexture.build(t,"f")),r.push(this.voronoiStyle.build(t,"i")),r.push(this.smoothness.build(t,"f")),r.push(this.seed.build(t,"f")),r.push(this.highCut.build(t,"f")),r.push(this.lowCut.build(t,"f")),r.push(this.quality.build(t,"i"));break}}return r.push(this.intensity.build(t,"f")),r.push("displaced_normal"),t.format(i+"("+r.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},kee=Ree;kee.Nodes=function(){let t=new xt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new xt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new xt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var Kt={normalRenderTarget:new Dc,normalRenderTargetDepth:new Dc,transmissionRenderTarget:new Dc,aspectRatio:new Os,transmissionSize:new Os(2048,2048),transmissionRenderTargetDepth:new Dc,aoRenderTarget:new Dc,aoEnabled:new Uo,pixelRatioNode:new Pt(1),resolution:new Os,penumbraSize:new Df(5,.5),frameIndex:new mr(0),transmissionLod:new mr(2)};for(let t of Object.values(Kt))t.isRenderGlobal=!0;var Dee={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.0.53/build/ui.wasm"},Mz=class extends Yp{constructor(){super("basic"),this.nodeType="Basic",this.color=new cn(Ka),this.shadingAlpha=new Pt(1),this.shadingBlend=new mr(0),this.previousModelViewMatrix=new Nh,this.previouseProjectionMatrix=new Nh}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({resolution:Kt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(U0.merge([vt.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=r.join(`
`)}else{this.color===void 0&&(this.color=new cn(Ka)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let i=this.color.flow(t,"c",{slot:"color"}),r=this.alpha?this.alpha.flow(t,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,s=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=r!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let o=["#include <normal_fragment_begin>",i.code];r&&o.push(r.code,"#ifdef ALPHATEST"," if ( "+r.result+" <= ALPHATEST ) discard;","#endif"),s?o.push(s.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):o.push(`vec3 finalColor = ${i.result};`);let a="1.0";this.mask&&(this.mask.analyze(t),a=`luminance(${this.mask.flow(t,"v3").result})`),r?o.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${r.result} * ${a} );`):o.push("gl_FragColor = vec4("+i.result+", 1.0 );"),n&&o.push(`gl_FragColor.a *= ${n.result};`),o.push("#include <fog_fragment>","#include <dithering_fragment>"),e=o.join(`
`)}return e}},LPe=class extends Yp{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new cn(Ka),this.emissive=new cn(0),this.emissiveIntensity=new Pt(1),this.previousModelViewMatrix=new Nh,this.previouseProjectionMatrix=new Nh,this.shadingAlpha=new Pt(1),this.shadingBlend=new mr(0),this.occlusion=new Uo(!0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({resolution:Kt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(U0.merge([vt.fog,vt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),r.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=r.join(`
`)}else{t.mergeUniform({penumbraSize:Kt.penumbraSize}),t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({aoMap:Kt.aoRenderTarget}),t.mergeUniform({aoEnabled:Kt.aoEnabled}),this.color===void 0&&(this.color=new cn(Ka)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),r=this.emissive.flow(t,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.occlusion.flow(t,"b",{slot:"occlusion"}),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=u!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),r&&h.push(r.code,"reflectedLight.directDiffuse += "+r.result+" * "+n.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=h.join(`
`)}return e}},p0=function(){let t=new xt(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),e=new xt(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:t,perturbNormalArb:e}}(),BPe=class extends Yp{constructor(){super("phong"),this.nodeType="Phong",this.color=new cn(Ka),this.specular=new cn(1118481),this.shininess=new Pt(30),this.previousModelViewMatrix=new Nh,this.previouseProjectionMatrix=new Nh,this.shadingAlpha=new Pt(1),this.shadingBlend=new mr(0),this.occlusion=new Uo(!0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({resolution:Kt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(U0.merge([vt.fog,vt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=r.join(`
`)}else{t.mergeUniform({penumbraSize:Kt.penumbraSize}),t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({aoMap:Kt.aoRenderTarget}),t.mergeUniform({aoEnabled:Kt.aoEnabled}),this.color===void 0&&(this.color=new cn(Ka)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t);let i=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let r=this.color.flow(t,"c",{slot:"color"}),n=this.specular.flow(t,"c"),s=this.shininess.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(t,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=u!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){t.include(p0.dHdxy),t.include(p0.perturbNormalArb);let p=this.bumpMap.texture.flow(t,"t"),f=this.bumpMap.flow(t,"v3"),m=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",g="";this.bumpMap.projection.value===4?g=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${m});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${m});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${m});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:g=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${m});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${g}
					`)}h.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),u&&h.push(u.code,"#ifdef ALPHATEST","if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(t),d=`luminance(${this.mask.flow(t,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${d}, ${a.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&h.push(`gl_FragColor.a *= ${c.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=h.join(`
`)}return e}},OPe=class extends Yp{constructor(){super("standard"),this.nodeType="Standard",this.color=new cn(Ka),this.roughness=new Pt(.3),this.metalness=new Pt(0),this.reflectivity=new Pt(.5),this.previousModelViewMatrix=new Nh,this.previouseProjectionMatrix=new Nh,this.shadingAlpha=new Pt(1),this.shadingBlend=new mr(0),this.occlusion=new Uo(!0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({resolution:Kt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(U0.merge([vt.fog,vt.lights])),vt.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=r.join(`
`)}else{t.mergeUniform({penumbraSize:Kt.penumbraSize}),t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({aoMap:Kt.aoRenderTarget}),t.mergeUniform({aoEnabled:Kt.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new cn(Ka)),this.color.analyze(t,{slot:"color",context:i}),this.roughness.analyze(t),this.metalness.analyze(t);let r=this.occlusion.flow(t,"b",{slot:"occlusion"});this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let n=this.color.flow(t,"c",{slot:"color",context:i}),s=this.roughness.flow(t,"f"),o=this.metalness.flow(t,"f"),a=this.shadingAlpha.flow(t,"f"),l=this.shadingBlend.flow(t,"i"),u=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){t.include(p0.dHdxy),t.include(p0.perturbNormalArb);let m=this.bumpMap.texture.flow(t,"t"),g=this.bumpMap.flow(t,"v3"),y=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",v="";this.bumpMap.projection.value===4?v=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${y});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${y});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${y});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:v=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${y});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};
					${v}
					`)}if(p.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",o.code,"	float metalnessFactor = "+o.result+";"),this.roughnessMap){let m=this.roughnessMap.texture.flow(t,"t"),g=this.roughnessMap.flow(t,"v3"),y="";this.roughnessMap.projection.value===4?y=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${m.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${m.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${m.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:y=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${m.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${g.result};

					const float roughnessScale = 1.0;

					${y}
				`)}else p.push(s.code,"	float roughnessFactor = "+s.result+";");c&&p.push(c.code,"#ifdef ALPHATEST","	if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(t),f=`luminance(${this.mask.flow(t,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),u&&p.push(u.code,`outgoingLight = spe_blend(outgoingLight, ${u.result}, 1.0, SPE_BLENDING_NORMAL);`),c?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push(`gl_FragColor.a *= ${h.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=p.join(`
`)}return e}},UPe=class extends Yp{constructor(){super("toon"),this.nodeType="Toon",this.color=new cn(Ka),this.specular=new cn(1118481),this.shininess=new Pt(30),this.previousModelViewMatrix=new Nh,this.previouseProjectionMatrix=new Nh,this.shadingAlpha=new Pt(1),this.shadingBlend=new mr(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({resolution:Kt.resolution}),t.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),t.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),t.mergeUniform(U0.merge([vt.fog,vt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let r=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&r.push(i.code,i.result?"displaced_position = "+i.result+";":""),r.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),r.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),r.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=r.join(`
`)}else{t.mergeUniform({penumbraSize:Kt.penumbraSize}),t.mergeUniform({frameIndex:Kt.frameIndex}),t.mergeUniform({aoMap:Kt.aoRenderTarget}),t.mergeUniform({aoEnabled:Kt.aoEnabled}),this.color===void 0&&(this.color=new cn(Ka)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let i=this.color.flow(t,"c",{slot:"color"}),r=this.specular.flow(t,"c"),n=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){t.include(p0.dHdxy),t.include(p0.perturbNormalArb);let d=this.bumpMap.texture.flow(t,"t"),p=this.bumpMap.flow(t,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(t,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,c.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${m}
					`)}c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	vec3 specular = "+r.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(t),h=`luminance(${this.mask.flow(t,"v3").result})`),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&c.push(`gl_FragColor.a *= ${u.result};`),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},NPe=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),i=this.cache.get(t);return i===void 0?(i={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,i)):(i.time=e,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},FPe=class extends NPe{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},YD;function zPe(t){return typeof t=="string"?t:(YD||(YD=new FPe),YD.load(t))}var HPe=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},GPe=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},Iee=class extends HPe{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isCanvas=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=t.type==="video",this.isCanvas=t.nodeName==="CANVAS",this.updateSrc(this.isCanvas?t:t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;for(let r of Object.values(this._cache))for(let n of Object.values(r))n&&(n.image=this.img,n.needsUpdate=!0);this.shared.requestRender()};if(this.isCanvas)this.img=t,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var i=new FileReader;i.readAsDataURL(new Blob([t],{type:"video/mp4"}));let r;await new Promise(n=>{i.onloadend=s=>{var o;r=(o=s.target)==null?void 0:o.result,n(null)}}),this.img.src=r}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=zPe(t),this.img.onload=e}getTexture(t,e=1008){var r;let i=(r=this._cache[t])==null?void 0:r[e];if(i)return i;{let n;return this.isCanvas&&(n=new Lye(this.img,void 0,t,t,void 0,e)),this.isVideo?n=new Iye(this.img,void 0,t,t):n=new Wr(this.img,void 0,t,t,void 0,e),this.loaded&&(n.needsUpdate=!0),this._cache[t]===void 0&&(this._cache[t]={}),this._cache[t][e]=n,n}}setNeedsUpdate(t){for(let e of Object.values(this._cache))for(let i of Object.values(e))i&&(i.needsUpdate=t)}disposeTextures(){for(let[t,e]of Object.entries(this._cache))for(let[i,r]of Object.entries(e))r==null||r.dispose(),this._cache[t][i]=void 0}dispose(){super.dispose(),this.disposeTextures()}},ip=class extends Iee{};function VPe(t,e){var i=XPe(e);return i.formatToParts?WPe(i,t):qPe(i,t)}var jPe={year:0,month:1,day:2,hour:3,minute:4,second:5};function WPe(t,e){try{for(var i=t.formatToParts(e),r=[],n=0;n<i.length;n++){var s=jPe[i[n].type];s>=0&&(r[s]=parseInt(i[n].value,10))}return r}catch(o){if(o instanceof RangeError)return[NaN];throw o}}function qPe(t,e){var i=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(i);return[r[3],r[1],r[2],r[4],r[5],r[6]]}var KD={};function XPe(t){if(!KD[t]){var e=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),i=e==="06/25/2014, 00:00:00"||e==="06/25/2014 00:00:00";KD[t]=i?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return KD[t]}function Lee(t,e,i,r,n,s,o){var a=new Date(0);return a.setUTCFullYear(t,e,i),a.setUTCHours(r,n,s,o),a}var P9=36e5,YPe=6e4,JD={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function Bee(t,e,i){var r,n;if(!t||(r=JD.timezoneZ.exec(t),r))return 0;var s;if(r=JD.timezoneHH.exec(t),r)return s=parseInt(r[1],10),T9(s)?-(s*P9):NaN;if(r=JD.timezoneHHMM.exec(t),r){s=parseInt(r[1],10);var o=parseInt(r[2],10);return T9(s,o)?(n=Math.abs(s)*P9+o*YPe,s>0?-n:n):NaN}if(QPe(t)){e=new Date(e||Date.now());var a=i?e:KPe(e),l=cO(a,t),u=i?l:JPe(e,l,t);return-u}return NaN}function KPe(t){return Lee(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function cO(t,e){var i=VPe(t,e),r=Lee(i[0],i[1]-1,i[2],i[3]%24,i[4],i[5],0).getTime(),n=t.getTime(),s=n%1e3;return n-=s>=0?s:1e3+s,r-n}function JPe(t,e,i){var r=t.getTime(),n=r-e,s=cO(new Date(n),i);if(e===s)return e;n-=s-e;var o=cO(new Date(n),i);return s===o?s:Math.max(s,o)}function T9(t,e){return-23<=t&&t<=23&&(e==null||0<=e&&e<=59)}var R9={};function QPe(t){if(R9[t])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:t}),R9[t]=!0,!0}catch{return!1}}var ZPe=qn(pce(),1),k9=qn(fce(),1),$Pe=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,eTe=$Pe,QD=36e5,D9=6e4,tTe=2,No={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:eTe};function iTe(t,e){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(t===null)return new Date(NaN);var i=e||{},r=i.additionalDigits==null?tTe:(0,ZPe.default)(i.additionalDigits);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]")return new Date(t.getTime());if(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")return new Date(t);if(!(typeof t=="string"||Object.prototype.toString.call(t)==="[object String]"))return new Date(NaN);var n=rTe(t),s=nTe(n.date,r),o=s.year,a=s.restDateString,l=sTe(a,o);if(isNaN(l))return new Date(NaN);if(l){var u=l.getTime(),c=0,h;if(n.time&&(c=oTe(n.time),isNaN(c)))return new Date(NaN);if(n.timeZone||i.timeZone){if(h=Bee(n.timeZone||i.timeZone,new Date(u+c)),isNaN(h))return new Date(NaN)}else h=(0,k9.default)(new Date(u+c)),h=(0,k9.default)(new Date(u+c+h));return new Date(u+c+h)}else return new Date(NaN)}function rTe(t){var e={},i=No.dateTimePattern.exec(t),r;if(i?(e.date=i[1],r=i[3]):(i=No.datePattern.exec(t),i?(e.date=i[1],r=i[2]):(e.date=null,r=t)),r){var n=No.timeZone.exec(r);n?(e.time=r.replace(n[1],""),e.timeZone=n[1].trim()):e.time=r}return e}function nTe(t,e){var i=No.YYY[e],r=No.YYYYY[e],n;if(n=No.YYYY.exec(t)||r.exec(t),n){var s=n[1];return{year:parseInt(s,10),restDateString:t.slice(s.length)}}if(n=No.YY.exec(t)||i.exec(t),n){var o=n[1];return{year:parseInt(o,10)*100,restDateString:t.slice(o.length)}}return{year:null}}function sTe(t,e){if(e===null)return null;var i,r,n,s;if(t.length===0)return r=new Date(0),r.setUTCFullYear(e),r;if(i=No.MM.exec(t),i)return r=new Date(0),n=parseInt(i[1],10)-1,L9(e,n)?(r.setUTCFullYear(e,n),r):new Date(NaN);if(i=No.DDD.exec(t),i){r=new Date(0);var o=parseInt(i[1],10);return uTe(e,o)?(r.setUTCFullYear(e,0,o),r):new Date(NaN)}if(i=No.MMDD.exec(t),i){r=new Date(0),n=parseInt(i[1],10)-1;var a=parseInt(i[2],10);return L9(e,n,a)?(r.setUTCFullYear(e,n,a),r):new Date(NaN)}if(i=No.Www.exec(t),i)return s=parseInt(i[1],10)-1,B9(e,s)?I9(e,s):new Date(NaN);if(i=No.WwwD.exec(t),i){s=parseInt(i[1],10)-1;var l=parseInt(i[2],10)-1;return B9(e,s,l)?I9(e,s,l):new Date(NaN)}return null}function oTe(t){var e,i,r;if(e=No.HH.exec(t),e)return i=parseFloat(e[1].replace(",",".")),ZD(i)?i%24*QD:NaN;if(e=No.HHMM.exec(t),e)return i=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),ZD(i,r)?i%24*QD+r*D9:NaN;if(e=No.HHMMSS.exec(t),e){i=parseInt(e[1],10),r=parseInt(e[2],10);var n=parseFloat(e[3].replace(",","."));return ZD(i,r,n)?i%24*QD+r*D9+n*1e3:NaN}return null}function I9(t,e,i){e=e||0,i=i||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var n=r.getUTCDay()||7,s=e*7+i+1-n;return r.setUTCDate(r.getUTCDate()+s),r}var aTe=[31,28,31,30,31,30,31,31,30,31,30,31],lTe=[31,29,31,30,31,30,31,31,30,31,30,31];function Oee(t){return t%400===0||t%4===0&&t%100!==0}function L9(t,e,i){if(e<0||e>11)return!1;if(i!=null){if(i<1)return!1;var r=Oee(t);if(r&&i>lTe[e]||!r&&i>aTe[e])return!1}return!0}function uTe(t,e){if(e<1)return!1;var i=Oee(t);return!(i&&e>366||!i&&e>365)}function B9(t,e,i){return!(e<0||e>52||i!=null&&(i<0||i>6))}function ZD(t,e,i){return!(t!=null&&(t<0||t>=25)||e!=null&&(e<0||e>=60)||i!=null&&(i<0||i>=60))}function hTe(t,e,i){var r=iTe(t,i),n=Bee(e,r,!0),s=new Date(r.getTime()-n),o=new Date(0);return o.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),o.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),o}function Go(t,e){return e.color(t)}function O9(t=new Date,e){let i=e.format,r=t.getSeconds(),n=t;e&&e.timeZone!==null&&(n=hTe(new Date,e.timeZone));let s=n.getHours(),o=n.getMinutes(),a;e.format12h24h==="12ampm"&&(a=s>=12?"PM":"AM");let l=s;e.format12h24h!=="24"&&(l=s%12,l===0&&(l=12));let u,c;switch(i){case"HH:mm:ss":u=[l,o,r];break;case"HH:mm":u=[l,o];break;case"HH":u=[l],a=void 0;break;case"mm":u=[o],a=void 0;break;case"ss":u=[r],a=void 0;break;case"year":c=n.getFullYear();break;case"month":c=n.getMonth()+1;break;case"dayOfYear":c=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":c=n.getDate();break;case"secondOfDay":c=s*60*60+o*60+r;break;default:console.error("Unknown time format",i),c=0;break}return u!==void 0?{textValue:u,suffix:a}:c}function cTe(t,e){switch(t.type){case"fresnel":return fTe(t,e);case"gradient":return mTe(t,e);case"depth":return gTe(t,e);case"normal":return yTe(t,e);case"noise":return vTe(t,e);case"rainbow":return bTe(t,e);case"toon":return xTe(t,e);case"outline":return wTe(t,e);case"transmission":return _Te(t,e);case"color":return pTe(t,e);case"pattern":return STe(t,e)}}function dTe(t){return{type:t.type}}function Iu(t,e){let{alpha:i,mode:r,isMask:n}=t,s=typeof i=="string"?(Number(e.getVariable(i))??100)/100:i;return{...dTe(t),alpha:s,mode:r,isMask:n}}function pTe(t,e){return{...Iu(t,e),color:Go(t.color,e)}}function fTe(t,e){let{bias:i,scale:r,intensity:n,factor:s,color:o}=t;return{...Iu(t,e),color:Go(o,e),bias:i,scale:r,intensity:n,factor:s}}function mTe(t,e){let{gradientType:i,smooth:r,colors:n,steps:s,angle:o,offset:a,morph:l}=t;return{...Iu(t,e),gradientType:i,smooth:r,colors:n.map(u=>new si(u[0],u[1],u[2],u[3])),num:n.length,steps:s,offset:new me(...a),morph:new me(...l),angle:o}}function gTe(t,e){let{gradientType:i,near:r,far:n,isVector:s,isWorldSpace:o,origin:a,direction:l,colors:u,steps:c,smooth:h}=t;return{...Iu(t,e),gradientType:i,near:r,far:n,isVector:s,isWorldSpace:o,origin:new N(...a),direction:l?new N(...l):new N(1,0,0),colors:u.map(d=>d!==void 0?new si(d[0],d[1],d[2],d[3]):new si(0,0,0,0)),steps:c.slice(0,u.length),smooth:h}}function yTe(t,e){let{cnormal:i}=t;return{...Iu(t,e),cnormal:new N(i[0],i[1],i[2])}}function vTe(t,e){return{...Iu(t,e),scale:t.scale,move:t.move,fA:new me(...t.fA),fB:new me(...t.fB),size:new N(...t.size),distortion:new me(...t.distortion),colorA:Go(t.colorA,e),colorB:Go(t.colorB,e),colorC:Go(t.colorC,e),colorD:Go(t.colorD,e),noiseType:t.noiseType,voronoiStyle:t.voronoiStyle,highCut:t.highCut,lowCut:t.lowCut,smoothness:t.smoothness,seed:t.seed,quality:t.quality}}function bTe(t,e){return{...Iu(t,e),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new N(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new N(...t.offset)}}function xTe(t,e){return{...Iu(t,e),positioning:t.positioning,colors:t.colors.map(i=>new si(i[0],i[1],i[2],i[3])),num:t.colors.length,steps:t.steps,source:new N(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:Go(t.shadowColor,e),offset:new N(...t.offset)}}function wTe(t,e){return{...Iu(t,e),outlineColor:Go(t.outlineColor,e),contourColor:Go(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new N(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function _Te(t,e){return{...Iu(t,e),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}function STe(t,e){return{...Iu(t,e),style:t.style,projection:t.projection,axis:t.axis,blending:t.blending,offset:new me(...t.offset),colorA:Go(t.colorA,e),colorB:Go(t.colorB,e),frequency:new me(...t.frequency),size:t.size,variation:t.variation,smoothness:t.smoothness,zigzag:t.zigzag,rotation:t.rotation,vertical:new me(...t.vertical),horizontal:new me(...t.horizontal),sides:t.sides}}var I2=class extends Ws{},Uee={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},Nee={depth:["colors"]};function ATe(t,e,i){var s,o;if(e==="isMask")return!0;let r=Uee[t.type],n=Nee[t.type];if(n!==void 0){let a=t.color;if(n.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==i.length)return!0}}return r!==void 0?r.includes(e):!1}function Fee(t,e,i){let r=i.uniforms[`f${i.id}_texture`];if(!r)return!1;let n=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=r;l.image instanceof ip||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=r;l.image instanceof ip||l.image.deref(),l.image=a}if("wrapping"in s){let o=r;o.wrap=s.wrapping}if("minFilter"in s){let o=r;o.minFilter=s.minFilter}if("repeat"in s||"offset"in s){let o="mat",a=i.uniforms[`f${i.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return n}function ETe(t,e,i,r){let n=!1;for(let[s,o]of Object.entries(t)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||o===void 0)continue;if(Hee(s,i,r,e)){s==="visible"&&i.type==="light"&&(n=!0);continue}i.visible=r.visible;let a=i.uniforms[`f${i.id}_${s}`];if(a&&!(a instanceof Sz))switch(n=n||ATe(i,s,o),a.constructor){case cn:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof I2?a.value=new Ws(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Ec:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof I2?a.value=new Ws(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case Os:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case yl:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case Dc:{Fee(o,e,i);break}case If:{a.value=o.map(l=>new si(...l));break}default:{a.value=o;break}}}return n}var Nm=(t,e,i)=>Math.max(0,Math.min(1,Number(e.getVariable(typeof t=="number"?t*100:t,i)??100)/100))??1,vm=class{constructor(t,e,i,r,n){this.id=t,this.uuid=e,this.data=i,this.uniforms={};for(let s in r)this.uniforms[`f${this.id}_${s}`]=r[s];for(let s in i)Hee(s,this,i,n)}get type(){return this.data.type}static create(t,e,i,r){if(i.type==="light")return uh.createLigherLayer(t,e,i,r);if(i.type==="texture"||i.type==="video"){let n=i.type==="texture"?r.canvas(i.texture.image)??r.image(i.texture.image):r.video(i.texture.video),s=new lO(n,i.texture.wrapping,i.texture.minFilter??1008),o=new TPe(n),a=new RPe(i.texture.repeat,i.texture.offset),l=new Pt(i.crop?1:0),u=new mr(i.projection??0),c=new mr(["x","y","z"].indexOf(i.axis)??0),h=new mr(i.side??0),d=new Os(i.size?new me(i.size[0],i.size[1]):new me(100,100)),p=new Pt(i.blending??0),f=new Pt(Nm(i.alpha,r)),m=new mr(i.mode??0),g=new Uo(i.isMask??!1),y=new Az(s,o,l,u,c,h,d,p,a,f,m,g),v=new Sr(y.calpha,"f");return new nn(t,e,i,{texture:s,textureSize:o,crop:l,projection:u,axis:c,side:h,size:d,blending:p,mat:a,alpha:f,mode:m,isMask:g},y,m,v,g,r)}else if(i.type==="matcap"){let n=r.image(i.texture.image),s=new lO(n,i.texture.wrapping,i.texture.minFilter??1008),o=new Pt(Nm(i.alpha,r)),a=new mr(i.mode??0),l=new Uo(i.isMask??!1),u=new bee(s,o,a,l),c=new Sr(u.calpha,"f");return new nn(t,e,i,{texture:s,alpha:o,mode:a,isMask:l},u,a,c,l,r)}else if(i.type==="displace")if(i.displacementType==="noise"){let n=new yl(new N(...i.offset)),s=new Pt(i.scale??10),o=new Pt(i.intensity??8),a=new Pt(i.movement??1),l=new mr(i.noiseType??0),u=new mr(i.voronoiStyle??0),c=new Pt(i.smoothness??.5),h=new Pt(i.seed??0),d=new Pt(i.highCut??1),p=new Pt(i.lowCut??0),f=new mr(i.quality??1),m=new kee(o,a,n,u,c,h,d,p,f,s,l);return new zee(t,e,i,{offset:n,scale:s,intensity:o,movement:a,noiseType:l,voronoiStyle:u,smoothness:c,seed:h,highCut:d,lowCut:p,quality:f},m,r)}else throw new Error;else return PTe(t,e,i,r)}updateByOp(t,e,i){let r=t;if(r.path[0]===void 0){if(r.type===0)return"type"in r.props||"category"in r.props||"visible"in r.props?(i.scene.markNeedsUpdateRendererDirty(),!0):ETe(r.props,i.shared,this,e)}else if(r.path[0]==="texture")return"texture"in e||"video"in e?Fee(r.props,i.shared,this):!0;return!1}dispose(){if(MTe(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof ip||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let i=`f${this.id}_${t}`;this.hasValueByKey(i)&&e!==void 0&&(this.uniforms[i].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let i=this.getName(e);i&&t.push(i)}return t}},nn=class extends vm{constructor(e,i,r,n,s,o,a,l,u){super(e,i,r,n,u),this.params=n,this.color=s,this.mode=o,this.alpha=a,this.isMask=l}},zee=class extends vm{constructor(t,e,i,r,n,s){super(t,e,i,r,s),this.position=n}},uh=class extends vm{constructor(t,e,i,r,n,s){super(t,e,i,n,s),this.node=r}static createLigherLayer(t,e,i,r){let n,s=new Pt(Nm(i.alpha,r)),o=new mr(i.mode),a=new Pt(i.bumpMapIntensity),l=new Pt(Nm(i.alphaOverride,r)),u;if(!i.visible)n=new Mz,u={};else if(i.category==="lambert"){n=new LPe;let c=new cn(r.color(i.emissive)??0),h=new Uo(i.occlusion??!0);u={emissive:c,occlusion:h},n.emissive=c,n.occlusion=h}else if(i.category==="toon"){n=new UPe;let c=new Pt(i.shininess??30),h=new cn(r.color(i.specular)??1118481);u={shininess:c,specular:h},n.shininess=c,n.specular=h}else if(i.category==="physical"){n=new OPe;let c=new Pt(i.roughness??.3),h=new Pt(i.metalness??0),d=new Pt(i.reflectivity??.5),p=new Uo(i.occlusion??!0);u={roughness:c,metalness:h,reflectivity:d,occlusion:p},n.roughness=c,n.metalness=h,n.reflectivity=d,n.occlusion=p}else{n=new BPe;let c=new Pt(i.shininess??30),h=new cn(i.specular!==void 0?r.color(i.specular)??1118481:1118481),d=new Uo(i.occlusion??!0);u={shininess:c,specular:h,occlusion:d},n.shininess=c,n.specular=h,n.occlusion=d}return n.alpha=new Pt(1),n.shadingAlpha=s,n.shadingBlend=o,n.bumpMapIntensity=a,n.alphaOverride=l,u.alpha=n.shadingAlpha,u.mode=n.shadingBlend,u.bumpMapIntensity=n.bumpMapIntensity,u.alphaOverride=n.alphaOverride,new uh(t,e,i,n,u,r)}get category(){return this.node.category}};function MTe(t){let e=t instanceof vm?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function hl(t){return{alpha:new Pt(t.alpha??1),mode:new mr(t.mode??0),isMask:new Uo(t.isMask??!1)}}function CTe(t,e,i,r,n){switch(t.type){case"color":{let s=new cn(r.color??Ka),o=hl(r),a=new uO(s,o.alpha),l=new Sr(a.calpha,"f");return new nn(e,i,t,{color:s,...o},a,o.mode,l,o.isMask,n)}case"fresnel":{let s=new cn(r.color??16777215),o=new Pt(r.bias??.1),a=new Pt(r.scale??1),l=new Pt(r.intensity??2),u=new Pt(r.factor??1),c=hl(r),h=new kPe(s,o,a,l,u,c.alpha,c.mode,c.isMask),d=new Sr(h.calpha,"f");return new nn(e,i,t,{color:s,bias:o,scale:a,intensity:l,factor:u,...c},h,c.mode,d,c.isMask,n)}case"rainbow":{let s=new Pt(r.filmThickness??30),o=new Pt(r.movement??0),a=new yl(r.wavelengths??new N(0,0,0)),l=new Pt(r.noiseStrength??0),u=new Pt(r.noiseScale??1),c=new yl(r.offset??new N(0,0,0)),h=hl(r),d=new Eee(s,o,a,l,u,c,h.alpha,h.isMask),p=new Sr(d.calpha,"f");return new nn(e,i,t,{filmThickness:s,movement:o,wavelengths:a,noiseStrength:l,noiseScale:u,offset:c,...h},d,h.mode,p,h.isMask,n)}case"transmission":{let s=new Pt(r.thickness??10),o=new Pt(r.ior??1.5),a=new Pt(r.roughness??.5),l=Kt.transmissionSize,u=Kt.transmissionRenderTarget,c=Kt.transmissionRenderTargetDepth,h=window.innerWidth,d=window.innerHeight,p=h>=d?new Os(d/h,1):new Os(1,h/d),f=hl(r),m=new Tee(s,o,a,l,u,c,p,f.alpha),g=new Sr(m.calpha,"f");return new nn(e,i,t,{thickness:s,ior:o,roughness:a,aspectRatio:p,...f},m,f.mode,g,f.isMask,n)}case"toon":{let s=new mr(r.positioning??0),o;r.colors?o=new If(r.colors.length,r.colors):(o=new If(10,new si(0,0,0,1)),o.value[1]=new si(1,1,1,1));let a;r.steps?a=new Df(r.steps.length,r.steps):(a=new Df(10,1),a.value[0]=0);let l=new yl(r.source??new N(0,0,0)),u=new Uo(r.isWorldSpace??!0),c=new Pt(r.noiseStrength??0),h=new Pt(r.noiseScale??1),d=new Ec(r.shadowColor),p=new yl(r.offset??new N(0,0,0)),f=hl(r),m=new Cee(s,o,a,l,u,c,h,d,p,f.alpha),g=new Sr(m.calpha,"f");return new nn(e,i,t,{positioning:s,colors:o,steps:a,source:l,isWorldSpace:u,noiseStrength:c,noiseScale:h,shadowColor:d,offset:p,...f},m,f.mode,g,f.isMask,n)}case"outline":{let s=new cn(r.outlineColor??16777215),o=new cn(r.contourColor??16777215),a=new Pt(r.outlineWidth??.1),l=new Pt(r.contourWidth??.1),u=new Pt(r.outlineThreshold??.1),c=new Pt(r.contourThreshold??.1),h=new Pt(r.outlineSmoothing??.1),d=new Pt(r.contourFrequency??.1),p=new yl(r.contourDirection??new N(0,1,0)),f=new Uo(r.positionalLines??!1),m=new Uo(r.compensation??!0),g=Kt.normalRenderTarget,y=Kt.normalRenderTargetDepth,v=Kt.pixelRatioNode,b=Kt.resolution,_=hl(r),A=new _ee(s,o,a,l,u,c,h,d,p,f,m,b,g,y,v,_.alpha),S=new Sr(A.calpha,"f");return new nn(e,i,t,{outlineColor:s,contourColor:o,outlineWidth:a,contourWidth:l,outlineThreshold:u,contourThreshold:c,outlineSmoothing:h,contourFrequency:d,contourDirection:p,positionalLines:f,compensation:m,..._},A,_.mode,S,_.isMask,n)}case"depth":{let s=new mr(r.gradientType??0),o=new Uo(r.smooth??!1),a=new Pt(r.near??50),l=new Pt(r.far??200),u=new Pt(r.isVector??1),c=new Pt(r.isWorldSpace??0),h=new yl(r.origin??new N),d=new yl(r.direction??new N),p;r.colors?p=new If(r.colors.length,r.colors):(p=new If(2,new si(0,0,0,1)),p.value[1]=new si(1,1,1,1));let f;r.steps?f=new Df(r.steps.length,r.steps):(f=new Df(2,1),f.value[0]=0);let m=hl(r),g=new mee(s,o,a,l,u,c,h,d,p,f,m.alpha,m.isMask),y=new Sr(g.calpha,"f");return new nn(e,i,t,{gradientType:s,smooth:o,near:a,far:l,isVector:u,isWorldSpace:c,origin:h,direction:d,colors:p,steps:f,...m},g,m.mode,y,m.isMask,n)}case"noise":{let s=new Pt(r.scale??1),o=new yl(r.size??new N(100,100,100)),a=new Pt(r.move??1),l=new Os(r.fA??new me(1.7,9.2)),u=new Os(r.fB??new me(8.3,2.8)),c=new Os(r.distortion??new me(1,1)),h=new Ec(r.colorA),d=new Ec(r.colorB),p=new Ec(r.colorC),f=new Ec(r.colorD),m=new mr(r.noiseType??0),g=new mr(r.voronoiStyle??0),y=new Pt(r.highCut??1),v=new Pt(r.lowCut??0),b=new Pt(r.smoothness??.5),_=new Pt(r.seed??.5),A=new mr(r.quality??1),S=hl(r),E=new xee(s,o,a,l,u,c,h,d,p,f,S.alpha,m,S.isMask,g,y,v,b,_,A),M=new Sr(E.calpha,"f");return new nn(e,i,t,{scale:s,size:o,move:a,fA:l,fB:u,distortion:c,colorA:h,colorB:d,colorC:p,colorD:f,noiseType:m,...S,voronoiStyle:g,highCut:y,lowCut:v,smoothness:b,seed:_,quality:A},E,S.mode,M,S.isMask,n)}case"normal":{let s=new yl(r.cnormal??new N(1,1,1)),o=hl(r),a=new fee(s,o.alpha),l=new Sr(a.calpha,"f");return new nn(e,i,t,{cnormal:s,...o},a,o.mode,l,o.isMask,n)}case"gradient":{let s=new mr(r.gradientType??0),o=new Uo(r.smooth??!1),a;r.colors?a=new If(r.colors.length,r.colors):(a=new If(10,new si(0,0,0,1)),a.value[1]=new si(1,1,1,1));let l;r.steps?l=new Df(r.steps.length,r.steps):(l=new Df(10,1),l.value[0]=0);let u=new Os(r.offset??new me(0,0)),c=new Os(r.morph??new me(0,0)),h=new Pt(r.angle??0),d=hl(r),p=new yee(s,o,a,l,u,c,h,d.alpha,d.isMask),f=new Sr(p.calpha,"f");return new nn(e,i,t,{gradientType:s,smooth:o,colors:a,steps:l,offset:u,morph:c,angle:h,...d},p,d.mode,f,d.isMask,n)}case"pattern":{let s=new mr(r.style??0),o=new mr(r.projection??0),a=new mr(["x","y","z"].indexOf(r.axis)??0),l=new Pt(r.blending??0),u=new Os(r.offset??new me(0,0)),c=new Ec(r.colorA),h=new Ec(r.colorB),d=new Os(r.frequency??new me(10,10)),p=new Pt(r.size??.5),f=new Pt(r.variation??0),m=new Pt(r.smoothness??.5),g=new Pt(r.zigzag??0),y=new Pt(r.rotation??0),v=new Os(r.vertical??new me(0,1)),b=new Os(r.horizontal??new me(0,1)),_=new mr(r.sides??6),A=hl(r),S=new See(s,o,a,l,u,c,h,d,p,f,m,g,y,v,b,_,A.alpha,A.isMask),E=new Sr(S.calpha,"f");return new nn(e,i,t,{style:s,projection:o,axis:a,blending:l,offset:u,colorA:c,colorB:h,frequency:d,size:p,variation:f,smoothness:m,zigzag:g,rotation:y,vertical:v,horizontal:b,sides:_,...A},S,A.mode,E,A.isMask,n)}default:{let s=new cn(1,0,0,1),o=hl(r),a=new uO(s,o.alpha),l=new Sr(a.calpha,"f");return new nn(e,i,t,{color:s,...o},a,o.mode,l,o.isMask,n)}}}function PTe(t,e,i,r){let n=cTe(i,r);return CTe(i,t,e,n,r)}function Hee(t,e,i,r){if(i.type==="displace"&&(t==="intensity"||t==="visible")){let n=e.uniforms[`f${e.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(t==="alpha"||t==="visible")){let n=e.uniforms[`f${e.id}_alpha`];if(!n)return;if(n.value=Nm(i.alpha,r)*(i.visible?1:0),i.type==="outline"&&t==="visible"){let s=e.uniforms[`f${e.id}_compensation`];s&&(s.value=i.compensation&&i.visible)}return n}}function uv(t,e){let i=0,r=t.layers.find(n=>n.data.type==="light");if(r){let n=r.data,s=Number(e.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?s/100:n.alphaOverride)<1)return!0}for(let n of t.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(e.getVariable(s)??100)/100))),s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let o of n.data.colors)if(o[3]<1){s=o[3];break}}else if(s===1&&n.data.type==="noise"){let o=e.color(n.data.colorA).a,a=e.color(n.data.colorB).a,l=e.color(n.data.colorC).a,u=e.color(n.data.colorD).a,c=Math.min(o,Math.min(a,Math.min(l,u)));c<1&&(s=c)}i+=(1-i)*s}}return i<1}var Fp=class extends er{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},TTe=class extends Fp{constructor(t,e,i,r){super(),this.flatShading=t,this.side=e,this.wireframe=i,this.root=r}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(t,e,i){return this.root.getFlavor(t,e,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,i){this.root.updateByOp(t,e,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Cz=class extends Fp{constructor(t,e,i=!0){super(),this.data=t,this.allowVariableSaves=i,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,i){let r=i?6:(t?3:0)+e;if(r===0)return this;this.flavors===void 0&&(this.flavors=[]),r-=1;let n=this.flavors[r];return n===void 0&&(n=new TTe(t,e,i,this),this.flavors[r]=n,n.flatShading=t,n.side=e,n.updateAfterBuild()),n}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var t;return((t=this.lightLayer.getNode("occlusion"))==null?void 0:t.value)??!1}reset(t,e,i=!1){(this.data!==t||i)&&this.reset0(t,e)}reset0(t,e){this.data=t;let i=t.layers??fo.defaultTwoLayerData("phong").layers;try{this.layers=i.map(r=>vm.create(this.layerIdGen++,r.id,r.data,e.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(e.shared),this.transparent=uv(t,e.shared),this.saveVariableLocations(e)}onVariableUpdate(t,e,i){if(t[0]==="alphaOverride")this.transparent=uv(this.data,i.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(e)/100,1)));else if(t[0]==="layer"){let r=t[1],n=t[2];if(r&&n){let s=this.layers.find(o=>o.uuid===r);s!=null&&s.hasValue(n)&&(n==="alpha"?(this.transparent=uv(this.data,i.shared),s.setValue(n,Math.max(0,Math.min(Number(e)/100,1)))):s.setValue(n,e))}}}saveVariableLocations(t){if(!this.allowVariableSaves)return;let e=this.data.layers.find(i=>i.data.type==="light");e&&t.shared.getVariable(e.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(i=>{"alpha"in i.data&&typeof i.data.alpha=="string"&&t.shared.getVariable(i.data.alpha,["material",this.uuid,"layer",i.id,"alpha"])})}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(t){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof uh),this.lightLayer===void 0&&(this.lightLayer=new uh(0,"",{...ys.defaultData("light","phong"),visible:!1},new Mz,{},t)),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let t=this.layers.find(n=>n instanceof uh);if(!t)return;let e=t.data,i=e.bumpMap,r=e.roughnessMap;t.node.bumpMap=void 0,t.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof nn&&s.color instanceof Az&&(s.uuid===i&&(t.node.bumpMap=s.color),s.uuid===r&&(t.node.roughnessMap=s.color))}}updateByOp(t,e,i){if(e!==void 0?this.data=e:e=this.data,this.transparent=uv(e,i.shared),t.path[0]==="layers"){this.data=e;let r=i.shared,n=t.path[1];if(n===void 0){if(this.layers.reverse(),t.type===4){let s=vm.create(this.layerIdGen++,t.id,t.data,i.shared);this.layers.splice(t.localIndex,0,s),i.scene.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),i.scene.markNeedsUpdateRendererDirty();else if(t.type===6){let s=this.layers.findIndex(a=>a.uuid===t.id),o=this.layers[s];this.layers.splice(s,1),this.layers.splice(t.localIndex,0,o),i.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate(i.shared)}else{t.type===0&&t.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(o=>o.uuid===n);if(s){let o=e.layers.data(n),a;if(t.type===0&&("alpha"in t.props||"alphaOverride"in t.props)&&("alpha"in t.props?a={...t.props,alpha:Nm(t.props.alpha,r,["material",this.uuid,"layer",n,"alpha"])}:a={...t.props,alphaOverride:Nm(t.props.alphaOverride,r,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...t,...a?{props:a}:{},path:t.path.slice(2)},o,i)){let l=vm.create(this.layerIdGen++,n,o,r);this.layers.splice(this.layers.findIndex(u=>u.uuid===n),1,l),this.onUpdate(i.shared)}}}}else this.reset(e,i)}applyMasks(){for(let t=0;t<this.layers.length;++t){let e=this.layers[t];e instanceof nn?e.color.mask=void 0:e instanceof uh&&(e.node.mask=void 0)}for(let t=0;t<this.layers.length;++t){let e=this.layers[t];if(e instanceof nn&&e.isMask.value&&e.data.visible&&t>0){let i=t-1,r=this.layers[i];r instanceof uh?r.node.mask=new aa(e.color,e.alpha,aa.MUL):r instanceof nn&&(r.isMask.value||(r.color.mask=new aa(e.color,e.alpha,aa.MUL)))}}}blendColors(){let t=this.layers.findIndex(i=>i instanceof nn),e=this.layers.findIndex(i=>i instanceof uh);if(t!==-1&&t<e){let i=this.layers[t].color;for(let r=t+1;r<e;++r){let n=this.layers[r];if(n instanceof nn){if(n.isMask.value)continue;i=new C9(i,n.color,n.alpha,n.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let t=new Sr("outgoingLight","f"),e=this.layers.findIndex(i=>i instanceof uh);if(this.layers.length>e+1){for(let i=e+1;i<this.layers.length;++i){let r=this.layers[i];if(r instanceof nn){if(r.isMask.value)continue;t=new C9(t,r.color,r.alpha,r.mode)}}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof zee);if(t.length>0){let e=t[0].position;for(let i=1;i<t.length;++i)t[i]&&(e=new aa(e,t[i].position,aa.ADD),e=new aa(e,new Pt(.5).setReadonly(!0),aa.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let i=(r,n,s)=>Math.min(Math.max(r,n),s);for(let r of this.layers)if(r.type==="displace"){let n=i(r.uniforms[`f${r.id}_intensity`].value,t,e);r.uniforms[`f${r.id}_intensity`].value=n}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let i=(Uee[e.type]??[]).map(a=>e[a]),r=(Nee[e.type]??[]).map(a=>{var l;return((l=e[a])==null?void 0:l.length)??0}),n=[...i,...r],s="isMask"in e&&e.isMask,o=`"${e.type}-${e.visible}-${s}"`;n.length?t+=`[${o}, "${n.join('","')}"],`:t+=o}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new hee;t.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof nn){let e=t.params.texture;if(e instanceof lO&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(Fp.prototype,{properties:{get:function(){return this.fragment.properties}}});var dO=class extends Cz{constructor(t,e,i){super(t,e,!1),this.uuid=i,this.allowVariableSaves=!0,this.saveVariableLocations(e)}},RTe=qn(mce()),U9=new Map;function kTe(t){if(typeof t=="string")return t;let e=U9.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},U9.set(t,e)),e.url}var Wx=class{constructor({src:t,volume:e,delay:i,loop:r}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof t=="string"?n={src:t}:n={src:kTe(t),format:"wav"},this.sound=new RTe.Howl(n),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),i!==void 0&&(this.delay=i),r!==void 0&&(this.loop=r)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,i){this.sound.on(t,e,i)}off(t,e,i){this.sound.off(t,e,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},DTe=class{constructor(){this.type="ShapePath",this.color=new Xt,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new XC,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var i;return(i=this.currentPath)==null||i.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){var n;return(n=this.currentPath)==null||n.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,n,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,i,r,n,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function i(p,f,m,g){let y=p.x,v=f.x,b=m.x,_=g.x,A=p.y,S=f.y,E=m.y,M=g.y,R=(_-b)*(A-E)-(M-E)*(y-b),C=(v-y)*(A-E)-(S-A)*(y-b),T=(M-E)*(v-y)-(_-b)*(S-A),L=R/T,I=C/T;if(T===0&&R!==0||L<=0||L>=1||I<0||I>1)return null;if(R===0&&T===0){for(let D=0;D<2;D++)if(r(D===0?m:g,p,f),e.loc===t.ORIGIN){let F=D===0?m:g;return{x:F.x,y:F.y,t:e.t}}else if(e.loc===t.BETWEEN){let F=+(y+e.t*(v-y)).toPrecision(10),H=+(A+e.t*(S-A)).toPrecision(10);return{x:F,y:H,t:e.t}}return null}else{for(let H=0;H<2;H++)if(r(H===0?m:g,p,f),e.loc===t.ORIGIN){let z=H===0?m:g;return{x:z.x,y:z.y,t:e.t}}let D=+(y+L*(v-y)).toPrecision(10),F=+(A+L*(S-A)).toPrecision(10);return{x:D,y:F,t:L}}}function r(p,f,m){let g=m.x-f.x,y=m.y-f.y,v=p.x-f.x,b=p.y-f.y,_=g*b-v*y;if(p.x===f.x&&p.y===f.y){e.loc=t.ORIGIN,e.t=0;return}if(p.x===m.x&&p.y===m.y){e.loc=t.DESTINATION,e.t=1;return}if(_<-Number.EPSILON){e.loc=t.LEFT;return}if(_>Number.EPSILON){e.loc=t.RIGHT;return}if(g*v<0||y*b<0){e.loc=t.BEHIND;return}if(Math.sqrt(g*g+y*y)<Math.sqrt(v*v+b*b)){e.loc=t.BEYOND;return}let A;g!==0?A=v/g:A=b/y,e.loc=t.BETWEEN,e.t=A}function n(p,f){let m=[],g=[];for(let y=1;y<p.length;y++){let v=p[y-1],b=p[y];for(let _=1;_<f.length;_++){let A=f[_-1],S=f[_],E=i(v,b,A,S);E!==null&&m.find(M=>M.t<=E.t+Number.EPSILON&&M.t>=E.t-Number.EPSILON)===void 0&&(m.push(E),g.push(new me(E.x,E.y)))}}return g}function s(p,f,m){let g=new me;f.getCenter(g);let y=[];return m.forEach(v=>{v.boundingBox.containsPoint(g)&&n(p,v.points).forEach(b=>{y.push({identifier:v.identifier,isCW:v.isCW,point:b})})}),y.sort((v,b)=>v.point.x-b.point.x),y}function o(p,f,m,g,y){(y==null||y==="")&&(y="nonzero");let v=new me;p.boundingBox.getCenter(v);let b=[new me(m,v.y),new me(g,v.y)],_=s(b,p.boundingBox,f);_.sort((C,T)=>C.point.x-T.point.x);let A=[],S=[];_.forEach(C=>{C.identifier===p.identifier?A.push(C):S.push(C)});let E=A[0].point.x,M=[],R=0;for(;R<S.length&&S[R].point.x<E;)M.length>0&&M[M.length-1]===S[R].identifier?M.pop():M.push(S[R].identifier),R++;if(M.push(p.identifier),y==="evenodd"){let C=M.length%2===0,T=M[M.length-2];return{identifier:p.identifier,isHole:C,for:T}}else if(y==="nonzero"){let C=!0,T=null,L=null;for(let I=0;I<M.length;I++){let D=M[I];f[D]&&(C?(L=f[D].isCW,C=!1,T=D):L!==f[D].isCW&&(L=f[D].isCW,C=!0))}return{identifier:p.identifier,isHole:C,for:T}}else console.warn('fill-rule: "'+y+'" is currently not implemented.')}let a=0,l=999999999,u=-999999999,c=[];this.subPaths.forEach(p=>{let f=p.getPoints(),m=-999999999,g=999999999,y=-999999999,v=999999999;for(let b=0;b<f.length;b++){let _=f[b];_.y>m&&(m=_.y),_.y<g&&(g=_.y),_.x>y&&(y=_.x),_.x<v&&(v=_.x)}u<=y&&(u=y+1),l>=v&&(l=v-1),f.length&&c.push({curves:p.curves,points:f,isCW:WQ.isClockWise(f),identifier:a++,boundingBox:new rZ(new me(v,g),new me(y,m))})});let h=c.map(p=>{var f;return o(p,c,l,u,(f=this.userData)==null?void 0:f.style.fillRule)}),d=[];return c.forEach(p=>{let f=h[p.identifier];if(f&&!f.isHole){let m=new YC;m.curves=p.curves,h.filter(g=>(g==null?void 0:g.isHole)&&g.for===p.identifier).forEach(g=>{if(g){let y=c[g.identifier],v=new XC;v.curves=y.curves,m.holes.push(v)}}),d.push(m)}}),d}},Gee=!1,Vee,N9=new Promise(t=>{Vee=t}),F9=!1,HA;function ITe(){if(Gee=!0,F9)return;if(HA)return HA;async function t(){let e=await L0(()=>import("./opentype-fc28cde9.js"),[]);Vee(e),F9=!0}return HA=t(),HA}var LTe=class{async load(t,e,i=()=>{}){let{load:r}=await N9;r(t,(n,s)=>{n||!s?i(n??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:i}=await N9;try{let r=e(t),n=new i,s=o=>r.charToGlyphIndex(o.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(r,r.defaultRenderOptions.features),{font:r,bidi:n}}catch(r){console.error(r)}}};async function BTe(t){return await(await fetch(t)).arrayBuffer()}var OTe=new LTe;async function z9(t){let e,i,r=!1;if(t.url?(e=await BTe(t.url),i=t.url,r=t.url.startsWith("/")):t.data&&(e=t.data.buffer.slice(t.data.byteOffset,t.data.byteOffset+t.data.byteLength)),e)if(Gee){let n=await OTe.parse(e);if(n)return{font:n.font,url:i,intercepted:r,arr:e,bidi:n.bidi}}else return{font:void 0,url:i,intercepted:r,arr:e,bidi:null}}function UTe(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var NTe=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=z9(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=z9(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,i){if(!this._bidi)return[];let r=this._bidi;r.getTextGlyphs(e);let n=r.tokenizer.tokens,s=[],o=0,a=i.length===n.length;for(let l=0;l<i.length;l++){let u=i[l].index,c=String.fromCharCode(i[l].unicode),h=n[o];if(UTe(u,h)||a)s.push({char:c,index:u,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),o++;else{let d=h.char,p="",f=[h.state.glyphIndex],m=[],g=!1;for(;!g;)o++,p=e.charAt(o),d+=p,f.push(t.charToGlyphIndex(p)),m=t.stringToGlyphs(d),m.length===1&&m[0].index===u&&(g=!0),o>e.length&&(g=!0);s.push({char:c,index:u,replacements:f,replacementChars:Array.from(d)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let i=this.font,r=e.fontSize/this.unitsPerEm,n=e.fontSize*e.lineHeight,s=t.map(y=>this.getTextWidth(y,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,u=this.computeSpaceWidthForLine(t,0,e),c=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),h=this.getLineInitialOffsetY(n,t.length,e.height,r,e.verticalAlign),d=[],p=t.map(y=>[]),f=t.map(y=>[]),m;for(let y=0;y<t.length;y++){let v=t[y],b={features:{liga:!0}},_=[];try{_=i.stringToGlyphs(v,b)}catch(S){console.warn(S)}c=this.getLineInitialOffsetX(s[y],o,e.horizontalAlign,v,a);let A=[];try{A=this.reverseLigaturesTable(i,v,_)}catch(S){console.warn(S)}u=this.computeSpaceWidthForLine(t,y,e);for(let S=0;S<_.length;S++){let E=_[S],M=E.index===0?`
`:E.unicode?String.fromCharCode(E.unicode):void 0,R=A[S],C=0,T=0;S===0&&e.horizontalAlign===2&&E.leftSideBearing!==void 0&&(T=-E.leftSideBearing*r),m&&(C=i.getKerningValue(E,m)*r),c+=T+C;let L=0;if(M===`
`)L=l;else if(M===" ")L=u;else{let I=this.createPath(E,r,c,h,e);I&&(L=I.offsetX-(C+T),d.push(I.path))}if(R.replacements.length===1)f[y].push([c,h]),p[y].push(L);else{let I=R.replacements.map(z=>(i.glyphs.get(z).advanceWidth??0)*r),D=I.reduce((z,B)=>z+=B,0),F=I.map(z=>z/D),H=c;for(let z=0;z<F.length;z++){let B=L*F[z];f[y].push([H,h]),p[y].push(B),H+=B}}c+=L,m=E}h-=n}let g=[];for(let y=0,v=d.length;y<v;y++)g.push(...d[y].toShapes());return{shapes:g,charWidths:p,lineWidths:s,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,i,r,n){return(i===3||i===2)&&r.indexOf(`
`)>=0&&(t-=n),i===3?e*.5-t*.5:i===2?e-t:0}getLineInitialOffsetY(t,e,i,r,n){let s=e*t,o=Math.abs(this.ascender-this.descender)*r,a=t-o,l=-this.ascender*r-a/2;return n===3?-(i-s-l):n===2?-(i*.5-s*.5-l):l}createPath(t,e,i,r,n){var l;let s=t.getPath(i,-r,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new DTe,a=(t.advanceWidth??1)*e;if(t)for(let u of s.commands){let c=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(c&&u.type!=="Z"&&c.x===u.x&&-c.y===u.y))switch(u.type){case"M":o.moveTo(u.x,-u.y);break;case"L":o.lineTo(u.x,-u.y);break;case"Q":o.quadraticCurveTo(u.x1,-u.y1,u.x,-u.y);break;case"C":o.bezierCurveTo(u.x1,-u.y1,u.x2,-u.y2,u.x,-u.y);break}}return o.subPaths.forEach(u=>{let c=FTe(u.curves);c!==void 0&&u.currentPoint.distanceTo(c)>0&&u.lineTo(c.x,c.y)}),{offsetX:a+n.fontSize*n.letterSpacing,path:o}}getCharWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,i){let r=this.getCharWidth(" ",i),n=t[e];if(n){let s=this.countSpaces(n.trimEnd());if(i.horizontalAlign===4&&e<t.length-1&&s){let o=i.width,a=this.getTextWidth(n,i);return(o-(a-s*r))/s}}return r}countSpaces(t){return(t.match(/ /g)||[]).length}};function FTe(t){if(t.length){let e=t[0];if(e instanceof _u)return e.v1;if(e instanceof gu||e instanceof Up)return e.v0}}var zTe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e,i){let r=this.objects.get(t);return r===void 0?(r=this.createObject(t,e,i),this.objects.set(t,r)):r.isShared=!0,r}forceDelete(t){let e=this.objects.get(t);e&&(this.disposeObject(e),this.objects.delete(t))}mutateIfUnique(t,e){let i=this.objects.get(t);if(i&&i.isShared!==!0)return this.objects.delete(t),this.objects.set(e,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let i=this.objects.get(t);e===i&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},H9=class extends zTe{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e,i){let r=h1(t,e,this.flatShading,i);return r.computeBoundingSphere(),r}},HTe={markNeedsUpdateRendererDirty:()=>{}},GTe=class extends GPe{constructor(t){super(),this.shared=t}create(t){return new Iee(t,this.shared)}},Pz=class{constructor(t,e={}){if(this.data=t,this.geometryCache=new H9(!0),this.geometryCache2=new H9(!1),this.imageHolderCache=new GTe(this),this.thisContext={scene:HTe,shared:this},this.deletedMaterial=new dO(fo.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new ip(_2.emptyImage,this),this.deletedVideo=new ip(m2.defaultVideo,this),this.materials={},this.images={},this.canvases={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[i,r]of Object.entries(e.images))this.addImage(i,r);if(e.videos)for(let[i,r]of Object.entries(e.videos))this.addVideo(i,r);if(e.audios)for(let[i,r]of Object.entries(e.audios))this.addAudio(i,r);if(e.particles)for(let[i,r]of Object.entries(e.particles))this.addParticle(i,r);this.reset(t)}setRequestRender(t){this._requestRender=t}setEntityOpContext(t){this.entityOpContext=t}reset(t,e=!1){this.resetLib(t.lib);for(let{id:i,data:r}of t.variables)this.addVariableHolder(i,r),e&&this.updateVariableHolder(i,r);for(let[i,r]of Object.entries(t.images))this.addImage(i,r);for(let[i,r]of Object.entries(t.videos))this.addVideo(i,r);for(let[i,r]of Object.entries(t.colors))this.addColor(i,r);for(let[i,r]of Object.entries(t.materials))this.addMaterial(i,r);for(let[i,r]of Object.entries(t.audios))this.addAudio(i,r);for(let[i,r]of Object.entries(t.particles))this.addParticle(i,r);for(let[i,r]of Object.entries(t.fonts))this.addFont(i,r)}addMaterial(t,e){if(this.materials[t]){let i=this.materials[t];i.reset(e,this.thisContext),i.dispose()}else{let i=new dO(e,this.thisContext,t);this.materials[t]=i}}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):t==null?(console.error("material is undefined or null"),this.deletedMaterial):new Cz(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new ip(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addCanvas(t,e){return this.canvases[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.canvases[t].updateSrc(e),!0):(this.canvases[t]=new ip(e,this),!1)}canvas(t){return this.canvases[t]}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new ip(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new I2(e.r,e.g,e.b,e.a):this.colors[t]=new I2(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[t];return this.colors[t].r=e.r??i.r,this.colors[t].g=e.g??i.g,this.colors[t].b=e.b??i.b,this.colors[t].a=e.a??i.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let i=this.getColor(t);i?e=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new Ws(0,0,0,0))}else return"a"in t?new Ws(t.r,t.g,t.b,t.a):new Ws(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof Wx)return e;{let i=new Wx({src:e.data});return this.audios[t]=i,i}}addParticle(t,e){this.particles[t]=e}getParticle(t){return this.particles[t]}deleteParticle(t){this.particles[t]&&delete this.particles[t]}deleteAudio(t){let e=this.audios[t];e&&(e instanceof Wx&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new NTe(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof Wx&&t.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(t,e){return this.variables[t]===void 0?(this.variables[t]={value:e.value,locations:[]},"dynamicVariableType"in e&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0),!0):(this.variables[t].value=e.value,!1)}resetDynamicVariablePlayState(){for(let t in this.variables)this.variables[t].dynamicVariablePlayState!==void 0&&(this.variables[t].dynamicVariablePlayState="Playing",this.variables[t].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(t,e){this.updateVariable(t,e.value)}updateVariable(t,e){if(this.variables[t]===void 0)return!1;this.variables[t].value=e;let i=e;for(;typeof i=="string";)i=this.variables[i].value;let r=this.entityOpContext.scene;for(let n=this.variables[t].locations.length-1;n>=0;n--){let s=this.variables[t].locations[n];if(s[0]==="material"){let o=s[1],a=i,l={scene:r,shared:this},u=s.slice(2);r.traverseMaterial(h=>{let d=h.root??h;d.uuid===o&&d.onVariableUpdate(u,a,l)});let c=this.materials[o];c&&c.onVariableUpdate(u,a,l)}else{let o=r.find(s[0]);if(o===void 0){this.variables[t].locations.splice(n,1);continue}if(s[1]!=="geometry"&&s[1]!=="particles"){for(let a=1;a<s.length-1;a++)o=o[s[a]];s[1]==="rotation"?o[s[s.length-1]]=i*kt.DEG2RAD:o[s[s.length-1]]=i}if(o=r.find(s[0]),o.type==="ParticleEmitter"&&o.updateVariableState(i,s),Ti.is(o)){if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")o.onVariableUpdate();else if(s[1]==="geometry"){let a=o;o.component&&(a=o.component);let l=a.dataPatched;a.chooseGeoemtryCache(this).forceDelete(l.geometry),a.createGeometryDelayed(this.entityOpContext),a.onVariableUpdate(!0),a.instances.forEach(u=>{let c=u.dataPatched;u.chooseGeoemtryCache(this).forceDelete(c.geometry),u.createGeometryDelayed(this.entityOpContext),u.onVariableUpdate(!0)})}}}}return this.requestRender(),!0}deleteVariable(t){this.variables[t]&&delete this.variables[t]}getVariable(t,e){var i,r,n;if(Array.isArray(t)){if(t[0]==="mouse")return((i=this.mouseProperty)==null?void 0:i[t[1]])??0;if(t[0]==="raycast")return((r=this.raycastProperty)==null?void 0:r[t[1]])??0;let s=this.entityOpContext.scene.find(t[0]);if(t[1]==="width"||t[1]==="height"||t[1]==="depth")return s.geometry.userData.parameters[t[1]];for(let o=1;o<t.length;o++)s=s[t[o]];return t[1]==="rotation"&&(s*=kt.RAD2DEG),s}for(let s in this.variables){if(e===void 0)break;let o=this.variables[s],a=(n=o.locations)==null?void 0:n.findIndex(l=>zs.equal(l,e));a!==void 0&&a!==-1&&o.locations.splice(a,1)}if(typeof t=="string"){let s=t,o=t;do{if(o=s,this.variables[s]===void 0)break;s=this.variables[s].value}while(typeof s=="string");return e&&this.variables[o]!==void 0&&this.variables[o].locations.push(e),s}else return t}getVariables(){return this.variables}getDynamicVariablePlayState(t){var e;return(e=this.variables[t])==null?void 0:e.dynamicVariablePlayState}setDynamicVariablePlayState(t,e){this.variables[t]!==void 0&&(this.variables[t].dynamicVariablePlayState=e)}getDynamicVariableToggleIsForward(t){var e;return(e=this.variables[t])==null?void 0:e.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(t,e){this.variables[t]!==void 0&&(this.variables[t].dynamicVariableToggleIsForward=e)}resetLib(t){for(let[e,i]of Object.entries(t.images))this.addImage(e,i.asset);for(let[e,i]of Object.entries(t.audios))this.addAudio(e,i.asset);for(let[e,i]of Object.entries(t.particles))this.addParticle(e,i.asset);for(let[e,i]of Object.entries(t.colors))this.addColor(e,i.asset);for(let[e,i]of Object.entries(t.fonts))this.addFont(e,i.asset);for(let[e,i]of Object.entries(t.materials))this.addMaterial(e,i.asset);for(let[e,i]of Object.entries(t.videos))this.addVideo(e,i.asset);for(let[e,i]of Object.entries(t.variables))this.addVariableHolder(e,i.asset)}updateLibByOp(t,e){t.path[0]==="images"?t.path.length===1&&t.type===1?this.addImage(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteImage(t.id):t.path[0]==="videos"?t.path.length===1&&t.type===1?this.addVideo(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteVideo(t.id):t.path[0]==="audios"?t.path.length===1&&t.type===1?this.addAudio(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteAudio(t.id):t.path[0]==="particles"?t.path.length===1&&t.type===1?this.addParticle(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteParticle(t.id):t.path[0]==="colors"?t.path.length===1&&t.type===1?this.addColor(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteColor(t.id):t.path[0]==="materials"?t.path.length===1&&t.type===1?this.addMaterial(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteMaterial(t.id):t.path[0]==="fonts"?t.path.length===1&&t.type===1?this.addFont(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteFont(t.id):t.path[0]==="variables"?t.path.length===1&&t.type===1?this.addVariableHolder(t.id,t.data.asset):t.path.length===1&&t.type===2&&this.deleteVariable(t.id):t.path[0]==="components"&&e.updateByLibOp(t,this)}updateByOp(t,e,i){this.data=e,t.path[0]==="images"?t.path.length===2&&t.type===0?t.props.data&&this.getImage(t.path[1]).updateSrc(t.props.data):t.path.length===1&&t.type===1?this.addImage(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteImage(t.id):t.path[0]==="videos"?t.path.length===2&&t.type===0?t.props.data&&this.getVideo(t.path[1]).updateSrc(t.props.data):t.path.length===1&&t.type===1?this.addVideo(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteVideo(t.id):t.path[0]==="audios"?t.path.length===2&&t.type===0?t.props.data&&this.addAudio(t.path[1],e.audios[t.path[1]]):t.path.length===1&&t.type===1?this.addAudio(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteAudio(t.id):t.path[0]==="particles"?t.path.length===2&&t.type===0?t.props.data&&this.addParticle(t.path[1],e.particles[t.path[1]]):t.path.length===1&&t.type===1?this.addParticle(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteParticle(t.id):t.path[0]==="colors"?t.path.length===2&&t.type===0?this.updateColor(t.path[1],t.props):t.path.length===1&&t.type===1?this.addColor(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteColor(t.id):t.path[0]==="materials"?t.path.length===1&&t.type===1?this.addMaterial(t.id,t.data):t.path.length===1&&t.type===2?this.deleteMaterial(t.id):t.path.length>1&&this.getMaterial(t.path[1]).updateByOp(Ss.drop(t,2),e.materials[t.path[1]],{shared:this,scene:i}):t.path[0]==="fonts"?t.path.length===2&&t.type===0?this.updateFont(t.path[1],t,i):t.path.length===1&&t.type===1?this.addFont(t.id,t.data):t.path.length===1&&t.type===2&&this.deleteFont(t.id):t.path[0]==="variables"?t.path.length===2&&t.type===0&&"value"in t.props?this.updateVariable(t.path[1],t.props.value):t.path.length===1&&t.type===4?this.addVariableHolder(t.id,t.data):t.path.length===1&&t.type===5&&this.deleteVariable(t.id):t.path[0]==="lib"&&this.updateLibByOp(Ss.drop(t,1),i)}updateFont(t,e,i){if(e.props.url){let r=this.getFont(t),n={...this.data.fonts[t],url:e.props.url};r.update(n),r.loadingPromise.then(()=>this.requestRender()),i.updateFont(t,this)}}};new Pz(wl.emptyData());var J0=class extends qo{updateByPatchedOp(t,e,i){if(super.updateByPatchedOp(t,e,i),OEe(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[r,n]of Object.entries(t.props)){let s=i.shared.material(n);this.material[Number(r)]=s}else if(gr(t.path,["material"])&&this.material instanceof Fp)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(Ss.drop(t,1),e.material,i);else if(gr(t.path,["materials","*"])&&Array.isArray(this.material)){let r=t.path[1];if("materials"in e&&r<this.material.length){let n=e.materials[r];typeof n!="string"&&this.material[r].updateByOp(Ss.drop(t,2),n,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(t,e){var r,n;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let i=this.dataPatched;if(((r=t.geometry)==null?void 0:r.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe),e.scene.markNeedsUpdateRendererDirty()),(((n=t.geometry)==null?void 0:n.type)==="NonParametricGeometry"||"materials"in t)&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(s=>e.shared.material(s).getFlavor(i.flatShading,i.side,i.wireframe)),e.scene.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(i.flatShading,i.side,i.wireframe)],e.scene.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&HZ(this.material).forEach(t=>{t instanceof Fp&&(t instanceof dO||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},G9=new N,V9=new si,j9=new si,VTe=new N,W9=new lt,po=class extends J0{constructor(t,e,i){super(t,e),this.data=e,this.isSkinnedMesh=!1,this.localGeometry=void 0,e.bindMode&&e.bindMatrix&&(this.bindMode=e.bindMode,this.bindMatrix=new lt().fromArray(e.bindMatrix),this.bindMatrixInverse=new lt)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Ht&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof Pz){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t,this)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return v2.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return v2.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),gr(t.path,["geometry"])&&this.updateByPatchedOpGeometry(Ss.drop(t,1),e.geometry,i)}removeInteractionGeometry(t){var e;(e=this.localGeometry)==null||e.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var r;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let n=t;if(this.localGeometry===void 0){let u={...this.data.geometry,...n};this.localGeometry=h1(u,e,this.data.flatShading,this)}let s,o,a;n.scaleBaked?[s,o,a]=n.scaleBaked:{width:s,height:o,depth:a}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&oO(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let n={...this.data.geometry,...t};(r=this.localGeometry)==null||r.dispose(),this.localGeometry=h1(n,e,this.data.flatShading,this)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,i){var n;let r=!1;t.type===0&&t.path.length===0&&Object.keys(t.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof Bo&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(r=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),r||((n=i.scene)==null||n.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;this.is2DType?t.set(0,0,i.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,e){this.skeleton=t,this.isSkinnedMesh=!0,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let e=new si,i=this.geometry.attributes.skinWeight;for(let r=0,n=i.count;r<n;r++){e.fromBufferAttribute(i,r);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(r,e.x,e.y,e.z,e.w)}}boneTransform(t,e){let i=this.skeleton;if(i===void 0)return;let r=this.geometry;V9.fromBufferAttribute(r.attributes.skinIndex,t),j9.fromBufferAttribute(r.attributes.skinWeight,t),G9.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let n=0;n<4;n++){let s=j9.getComponent(n);if(s!==0){let o=V9.getComponent(n);W9.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),e.addScaledVector(VTe.copy(G9).applyMatrix4(W9),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};function jTe(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,i=t.geometry.attributes,r=i.position.array,n=i.normal.array,s=new Float32Array(r.length);for(let l=0;l<r.length;l+=3){let u=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=new N(n[l],n[l+1],n[l+2]);e.has(u)?(o=e.get(u))==null||o.normals.push(c):e.set(u,{normals:[c],result:new N})}e.forEach((l,u)=>{for(let c of l.normals)l.result.add(c);l.result.divideScalar(l.normals.length)});for(let l=0;l<r.length;l+=3){let u=`${r[l]}_${r[l+1]}_${r[l+2]}`,c=(a=e.get(u))==null?void 0:a.result;c&&(s[l]=c.x,s[l+1]=c.y,s[l+2]=c.z)}t.geometry.setAttribute("extrudeNormal",new _t(s,3))}function WTe(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),r=new N;for(let n=0;n<e.length;n+=3)r.set(e[n],e[n+1],e[n+2]).normalize(),i[n]=r.x,i[n+1]=r.y,i[n+2]=r.z;t.geometry.setAttribute("extrudeNormal",new _t(i,3))}function Tz(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof Fp)||t.material.getLayersOfType("outline").length===0)return;t instanceof po&&t.is2DAndNoDepth?WTe(t):jTe(t)}function Rz(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,i=new Float32Array(e.length),r=parseInt(t.uuid.replace(/\D/g,"")),n=[kt.seededRandom(r),kt.seededRandom(r+1e4),kt.seededRandom(r+2e4)];for(let s=0;s<e.length;s++)i[s]=n[s%3];t.geometry.setAttribute("randomColor",new ei(i,3))}var Qu=new Mn,nx=new N;function qTe(t){let e=!1;return t.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var c1=class extends po{constructor(t,e,i){super(t,e,i),this.data=e,this.hiddenMatrixOld=new lt,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let i=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:r,subdivPointer:n}=Bo.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,i!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=i),r!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=r??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,Tz(this),Rz(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let i=this.material;this.material=Array.isArray(i)?i.map(r=>r.getFlavor(!1,r.side,r.wireframe)):i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){Bo.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Bo.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Bo.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Bo.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,qo.prototype.raycast.call(this,t,e),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new xa,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,i=t.boundingSphere.center;Qu.setFromBufferAttribute(e),Qu.getCenter(i),t.boundingSphere.radius=i.distanceTo(Qu.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Qu.getSize(nx),this.hasNonUniformScale&&nx.divide(this.scale);let r={width:nx.x,height:nx.y,depth:nx.z};return this.geometry.userData.parameters=r,r}updateBoundingSphere(t){let e=this.originalGeometry;Qu.min.set(t[0],t[2],t[4]),Qu.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(Qu.min.applyMatrix4(this.shearScaleInv),Qu.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new xa);let i=e.boundingSphere.center;Qu.getCenter(i),e.boundingSphere.radius=i.distanceTo(Qu.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(Bo.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,i){super.updateByPatchedOpGeometry(t,e,i),this.localGeometry&&this.createGeometryByControls(e)}},q9=-1,XTe=1,YTe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},KTe={polygon_center:0,edge:1,vertex:2},GA=(t,e)=>(i,r)=>!e||i===0||t===0?0:t*r/100,di=(t,e)=>{let i=Math.abs(e),r=i*-1;return(t-q9)*(i-r)/(XTe-q9)+r};function JTe(t){let e=[],i={};for(var r=0,n=t.length;r<n;r++){var s=JSON.stringify(t[r].pos.map(o=>Math.round(o*1e4)/1e4));i[s]||(e.push(t[r]),i[s]=!0)}return e}var QTe=new N,VA=new N,ZTe=new N,$Te=new N;function Lv(t,e){let i=ZTe.fromArray(t),r=$Te.fromArray(e);VA.copy(r).sub(i);let n=VA.length();return VA.normalize().multiplyScalar(n*.5),QTe.copy(i).add(VA).toArray()}var El=new Fs,jA=new N,L2=new N,Hf=new N;function eRe(t){let e=[];for(let i=0;i<=t.index.count;i++)if(jA.fromArray(t.index.array,i*3),El.setFromAttributeAndIndices(t.attributes.position,jA.x,jA.y,jA.z),El.getNormal(L2),El.getMidpoint(Hf),!(isNaN(Hf.x)||isNaN(Hf.y)||isNaN(Hf.z))){let{a:r,b:n,c:s}=El,o=r.toArray(),a=n.toArray(),l=s.toArray(),u=r.distanceTo(n),c=n.distanceTo(s),h=s.distanceTo(r),d=Lv(o,a),p=Lv(a,l),f=Lv(l,o),m=[u,c,h],g=Math.max(...m),y=m.filter(_=>Math.round(_)===Math.round(g)).length>1,v=[],b=El.getMidpoint(Hf).toArray();g===u&&!y&&(v=[p,f,f],b=d),g===c&&!y&&(v=[d,f,f],b=p),g===h&&!y&&(v=[d,p,p],b=f),y&&(v=[d,p,f]),e.push({vertices:[o,a,l],faceCenters:v,midpoint:b,norm:El.getNormal(L2).toArray()})}return e}function tRe(t){let e=[],{position:i}=t.attributes;for(let r=0;r<i.count;r++){El.setFromAttributeAndIndices(i,r*3,r*3+1,r*3+2),El.getNormal(L2),El.getMidpoint(Hf);let n=El.a.toArray(),s=El.b.toArray(),o=El.c.toArray();e.push({vertices:[n,s,o],faceCenters:[Lv(n,s),Lv(s,o),Lv(o,n)],midpoint:Hf.toArray(),norm:L2.toArray()})}return e}var iRe=4,rRe=.5,$D=t=>.5*(1-Math.cos(t*Math.PI)),nRe=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,i=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),i<0&&(i=-i);let r=Math.floor(t),n=Math.floor(e),s=Math.floor(i),o=t-r,a=e-n,l=i-s,u,c,h=0,d=.5,p,f,m;for(let g=0;g<iRe;g++){let y=r+(n<<4)+(s<<8);u=$D(o),c=$D(a),p=this.perlin[y&4095],p+=u*(this.perlin[y+1&4095]-p),f=this.perlin[y+16&4095],f+=u*(this.perlin[y+16+1&4095]-f),p+=c*(f-p),y+=256,f=this.perlin[y&4095],f+=u*(this.perlin[y+1&4095]-f),m=this.perlin[y+16&4095],m+=u*(this.perlin[y+16+1&4095]-m),f+=c*(m-f),p+=$D(l)*(f-p),h+=p*d,d*=rRe,r<<=1,o*=2,n<<=1,a*=2,s<<=1,l*=2,o>=1&&(r++,o--),a>=1&&(n++,a--),l>=1&&(s++,l--)}return h}noiseSeed(t){let e=(()=>{let i,r;return{setSeed(n){r=i=(n??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return r=(1664525*r+1013904223)%4294967296,r/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let i=0;i<4095+1;i++)this.perlin[i]=e.rand()}},sRe=nRe,X9=new N,Y9=new lt,K9=new O0;function J9(t){let e=!1;return t.scene.objects.traverse((i,r)=>{r.type==="Mesh"&&r.geometry.type==="TextGeometry"&&(e=!0)}),e}var jee=class extends po{constructor(t,e,i){super(t,e,i),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:i}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(Y9.copy(i).invert(),K9.copy(t.ray).applyMatrix4(Y9),K9.intersectBox(this.singleBBox,X9))){let r=X9.applyMatrix4(i),n=t.ray.origin.distanceTo(r);e.push({distance:n,point:r.clone(),object:this})}}},Co=1e-4,Zu,Wee,qee,Xee,Q9=new N,Z9=new N;tee.then(t=>{Zu=t,Wee=[Zu.get_face_center,Zu.get_edge_midpoint,Zu.get_vertex_position],qee=[Zu.get_face_normal,Zu.get_edge_normal,Zu.get_vertex_normal],Xee=[Zu.face_count,Zu.edge_count,Zu.vertex_count]});var oRe=new lt,aRe=new lt,Cd=new N,WA=new N,sx=new N,e3=new N,lRe=new N,uRe=new N,lc=new sRe,vu=class extends dz(ir){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof co&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof co&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let r=0,n=this.children.length;r<n;++r)this.remove(this.children[0]);let i=this.children;if(i.length===e)return;if(i.length<e)for(let r=0,n=e-i.length;r<n;++r){let s=new co(this.object);s.expand(),this.add(s)}else for(let r=0,n=i.length-e;r<n;++r)this.remove(i[r])}else{if(this.children.length===e)return;if(this.children.length<e)for(let i=0,r=e-this.children.length;i<r;++i){let n=new co(this.object);n.expand(),this.add(n)}else for(let i=0,r=this.children.length-e;i<r;++i)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,i=e.start*kt.DEG2RAD,r=e.end*kt.DEG2RAD,n=i-r,s=new ts(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new N(0,0,1);break;case"y":o=new N(0,1,0);break;default:case"x":o=new N(1,0,0);break}let a=t.randomnessObject??cp.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";lc.noiseSeed(a.seed);let u=DD((0,$b.default)(a.seed)),c=GA(a.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(a.freqScale/10)+a.movement,f=l?lc.noise(p):u(p,p),m=h+1;d.scale.x=e.scale[0]+c(m,di(f,a.scale[0]))||Co,d.scale.y=e.scale[1]+c(m,di(f,a.scale[1]))||Co,d.scale.z=e.scale[2]+c(m,di(f,a.scale[2]))||Co,d.position.setScalar(0);let g=n/t.count*h-i;switch(e.axis){case"x":d.rotation.set(0,g,0);break;case"y":d.rotation.set(0,0,g);break;case"z":d.rotation.set(g,0,0);break}d.translateOnAxis(o,e.radius),d.position.x+=e.position[0]+c(m,di(f,a.position[0])),d.position.y+=e.position[1]+c(m,di(f,a.position[1])),d.position.z+=e.position[2]+c(m,di(f,a.position[2]));let y=c(m,di(f,a.rotation[0])),v=c(m,di(f,a.rotation[1])),b=c(m,di(f,a.rotation[2]));e.alignment===!0?(d.rotation.x+=s.x+y,d.rotation.y+=s.y+v,d.rotation.z+=s.z+b):d.rotation.set(s.x+y,s.y+v,s.z+b)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,i=new ts(e.rotation[0],e.rotation[1],e.rotation[2]),r=t.randomnessObject??cp.defaultData([1,1,1]).randomnessObject,n=r.noiseType==="perlin";lc.noiseSeed(r.seed);let s=DD((0,$b.default)(r.seed)),o=GA(r.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let u=a*(r.freqScale/10)+r.movement,c=n?lc.noise(u):s(u,u),h=a+1,d=o(h,di(c,r.rotation[0])),p=o(h,di(c,r.rotation[1])),f=o(h,di(c,r.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(h,di(c,r.scale[0]))||Co,l.scale.y=1+(e.scale[1]-1)*a+o(h,di(c,r.scale[1]))||Co,l.scale.z=1+(e.scale[2]-1)*a+o(h,di(c,r.scale[2]))||Co,l.rotation.x=i.x*a+d,l.rotation.y=i.y*a+p,l.rotation.z=i.z*a+f,l.position.x=e.position[0]*a+o(h,di(c,r.position[0])),l.position.y=e.position[1]*a+o(h,di(c,r.position[1])),l.position.z=e.position[2]*a+o(h,di(c,r.position[2]))}}_updateGrid(t){let e=0,i=t.grid,r=t.randomnessObject??cp.defaultData([1,1,1]).randomnessObject,n=GA(r.strength,this.parameters.randomness),s=r.noiseType==="perlin";lc.noiseSeed(r.seed);let o=mCe((0,$b.default)(r.seed));if(i.useCenter===!0){let a={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},l=new N(i.size[0]*(i.count[0]-a.x)*.5,i.size[1]*(i.count[1]-a.y)*.5,i.size[2]*(i.count[2]-a.z)*.5);for(let u=0;u<i.count[0];u++)for(let c=0;c<i.count[1];c++)for(let h=0;h<i.count[2];h++){let d=[(u+1)*(r.freqScale/10)+r.movement,(c+1)*(r.freqScale/10)+r.movement,(h+1)*(r.freqScale/10)+r.movement],p=s?lc.noise(...d):o(...d),f=this.children[e++];f.scale.x=1+n(e,di(p,r.scale[0]))||Co,f.scale.y=1+n(e,di(p,r.scale[1]))||Co,f.scale.z=1+n(e,di(p,r.scale[2]))||Co;let m=n(e,di(p,r.rotation[0])),g=n(e,di(p,r.rotation[1])),y=n(e,di(p,r.rotation[2]));f.rotation.set(m,g,y),f.position.x=i.size[0]*u-l.x+n(e,di(p,r.position[0])),f.position.y=i.size[1]*c-l.y+n(e,di(p,r.position[1])),f.position.z=i.size[2]*h-l.z+n(e,di(p,r.position[2]))}}else for(let a=0;a<i.count[0];a++)for(let l=0;l<i.count[1];l++)for(let u=0;u<i.count[2];u++){let c=[(a+1)*(r.freqScale/10)+r.movement,(l+1)*(r.freqScale/10)+r.movement,(u+1)*(r.freqScale/10)+r.movement],h=s?lc.noise(...c):o(...c),d=this.children[e++];d.scale.x=1+n(e,di(h,r.scale[0]))||Co,d.scale.y=1+n(e,di(h,r.scale[1]))||Co,d.scale.z=1+n(e,di(h,r.scale[2]))||Co;let p=n(e,di(h,r.rotation[0])),f=n(e,di(h,r.rotation[1])),m=n(e,di(h,r.rotation[2]));d.rotation.set(p,f,m),d.position.x=i.size[0]*a+n(e,di(h,r.position[0])),d.position.y=-i.size[1]*l+n(e,di(h,r.position[1])),d.position.z=-i.size[2]*u+n(e,di(h,r.position[2]))}}_updateToObject(t){var m;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,i=new ts(e.rotation[0],e.rotation[1],e.rotation[2]),r=t.randomnessObject??cp.defaultData([1,1,1]).randomnessObject,n=r.noiseType==="perlin";lc.noiseSeed(r.seed);let s=DD((0,$b.default)(r.seed)),o=GA(r.strength,this.parameters.randomness);if(!e.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof jee)if(!((m=this.objectForSample.font)!=null&&m.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],u=g=>{let y=g.length,v=g.map(A=>A[0]).reduce((A,S)=>A+S,0),b=g.map(A=>A[1]).reduce((A,S)=>A+S,0),_=g.map(A=>A[2]).reduce((A,S)=>A+S,0);return[v/y,b/y,_/y]},c=g=>Math.round(g*1e6)/1e6;a.forEach(g=>{let y=a.filter(v=>c(g.pos[0])===c(v.pos[0])&&c(g.pos[1])===c(v.pos[1])&&c(g.pos[2])===c(v.pos[2]));y.length>1?l.push({pos:g.pos,norm:u(y.map(v=>v.norm))}):l.push(g)});let h=JTe(l);if(h.length>0){let g=Math.round(h.length*e.count/100);this._updateCount(g)}else{let g=this.objectForSample.geometry.getAttribute("position");if(!g||isNaN(g.count)||g.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let d=new gCe(this.objectForSample).build(),p=YTe[e.axis],f=this.children;d.setRandomGenerator((0,$b.default)(this.object.uuid+e.seed));for(let[g,y]of f.entries()){let v=g*(r.freqScale/10)+r.movement,b=n?lc.noise(v):s(v,v),_=g+1,A=o(_,di(b,r.rotation[0])),S=o(_,di(b,r.rotation[1])),E=o(_,di(b,r.rotation[2]));e.spreadType==="random"?d.sample(sx,e3):(h.length&&(sx.fromArray(h[g].pos),e3.fromArray(h[g].norm)),this.objectForSample instanceof c1&&sx.applyMatrix4(oRe.copy(this.objectForSample.matrixWorld).invert())),sx.applyMatrix4(this.object.hiddenMatrix.clone().invert()),y.position.copy(sx),Cd.fromArray(p);let M=e.align==="normal"?e3:this.object.getWorldDirection(uRe),R=WA.fromArray(e.position);WA.x+=o(_,di(b,r.position[0])),WA.y+=o(_,di(b,r.position[1])),WA.z+=o(_,di(b,r.position[2]));let C=Math.acos(M.dot(Cd)),T=lRe.crossVectors(Cd,M).normalize(),L=aRe.makeRotationAxis(T,C),I=M.clone().cross(this.object.up).normalize(),D=I.clone().cross(M).normalize(),F=new lt().makeBasis(I,M,D),H=new N(Cd.y,Cd.z,Cd.x).normalize(),z=H.clone().cross(Cd).normalize(),B=new lt().makeBasis(H,Cd,z).invert(),j=new lt().multiplyMatrices(F,B);y.rotation.setFromRotationMatrix(j),R.applyMatrix4(L),y.position.add(R),y.rotation.x=y.rotation.x+i.x+A,y.rotation.y=y.rotation.y+i.y+S,y.rotation.z=y.rotation.z+i.z+E,y.scale.setScalar(1),y.scale.x=y.scale.x+e.scale[0]+o(_,di(b,r.scale[0]))||Co,y.scale.y=y.scale.y+e.scale[1]+o(_,di(b,r.scale[1]))||Co,y.scale.z=y.scale.z+e.scale[2]+o(_,di(b,r.scale[2]))||Co,y.scale.multiply(this.object.scale),y.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof c1){let e=this.objectForSample,i=KTe[t],r=Xee[i],n=Wee[i],s=qee[i],o=[],a=r(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let u=n(e.subdivPointerNew,l),c=s(e.subdivPointerNew,l);Q9.fromArray(u).applyMatrix4(e.matrixWorld),Z9.fromArray(c),o.push({pos:Q9.toArray(),norm:Z9.toArray()})}return o}else return(this.objectForSample.geometry.index?eRe(this.objectForSample.geometry):tRe(this.objectForSample.geometry)).map((e,i)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var i;if(this.parameters=BP(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(i=this.object.parent)==null||i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=e.find(this.parameters.toObject.object);r instanceof qo?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new lt,this.hiddenMatrix=new lt,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},t_=t=>{var e;return e=class extends t{},e.geometryHelper=new Cu(30,30,30),e},qA=new O0,t3=new xa,$9=new lt,i_=(t,e,i,r,n=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),t3.copy(s.boundingSphere),t3.applyMatrix4(o),i.ray.intersectsSphere(t3)===!1||($9.copy(o).invert(),qA.copy(i.ray).applyMatrix4($9),s.boundingBox!==null&&qA.intersectsBox(s.boundingBox)===!1))return;let a,l,u,c,h=s.index,d=s.attributes.position,p=s.drawRange,f,m;if(n===!1){let y=Math.max(0,p.start),v=Math.min(h.count,p.start+p.count);for(f=y,m=v;f<m;f+=3)if(l=h.getX(f),u=h.getX(f+1),c=h.getX(f+2),a=g(t,i,qA,d,l,u,c),a){a.faceIndex=Math.floor(f/3),r.push(a);return}}else{let y=s.attributes.position,v=new N,b=new N,_=new N,A=new N,S=2,E=1/((t.scale.x+t.scale.y+t.scale.z)/3),M=E*E,R=Math.max(0,p.start),C=Math.min(y.count,p.start+p.count);for(let T=R,L=C-1;T<L;T+=S){if(v.fromBufferAttribute(y,T),b.fromBufferAttribute(y,T+1),qA.distanceSqToSegment(v,b,A,_)>M)continue;A.applyMatrix4(t.matrixWorld);let I=i.ray.origin.distanceTo(A);I<i.near||I>i.far||r.push({distance:I,point:_.clone().applyMatrix4(t.matrixWorld),object:t})}}function g(y,v,b,_,A,S,E){let M=new N,R=new N,C=new N,T=new N,L=new N;if(M.fromBufferAttribute(_,A),R.fromBufferAttribute(_,S),C.fromBufferAttribute(_,E),b.intersectTriangle(M,R,C,!1,T)===null)return null;L.copy(T),L.applyMatrix4(y.matrixWorld);let I=v.ray.origin.distanceTo(L);return I<v.near||I>v.far?null:{faceIndex:1,distance:I,point:L.clone(),object:y}}},XA=new N,cl=new Jm,hRe=class extends K1{constructor(t){let e=new Ht,i=new Xp({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],n=[],s={},o=new Xt(15711266),a=new Xt(15711266),l=new Xt(2857471);u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",a),u("p","n2",a),u("p","n3",a),u("p","n4",a),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l);function u(h,d,p){c(h,p),c(d,p)}function c(h,d){r.push(0,0,0),n.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(r.length/3-1)}e.setAttribute("position",new _t(r,3)),e.setAttribute("color",new _t(n,3)),super(e,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;cl.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,r=1,n=.8;Zl("n1",e,t,cl,-i,-r,n),Zl("n2",e,t,cl,i,-r,n),Zl("n3",e,t,cl,-i,r,n),Zl("n4",e,t,cl,i,r,n);let s=n;Zl("f1",e,t,cl,-i,-r,s),Zl("f2",e,t,cl,i,-r,s),Zl("f3",e,t,cl,-i,r,s),Zl("f4",e,t,cl,i,r,s);let o=s,a=.5;Zl("u1",e,t,cl,i*.7*a,r*1.1,o),Zl("u2",e,t,cl,-i*.7*a,r*1.1,o),Zl("u3",e,t,cl,0,r*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Zl(t,e,i,r,n,s,o){XA.set(n,s,o).unproject(r);let a=e[t];if(a!==void 0){let l=i.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],XA.x,XA.y,XA.z)}}var cRe=class extends t_(hRe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){i_(this.object,this.geometry,t,e,!0)}},pO;(t=>t.is=e=>"objectHelper"in e)(pO||(pO={}));var Q0=(t,e)=>class extends pz(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(i,r){this.objectHelper.raycast(i,r)}showGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof $C&&(r.visible=!0)}}updateEntityBoxSize(i,r){this.objectHelper.visible&&this.geometryHelper instanceof Cu?(i.setScalar(0),r.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,r)}hideGizmos(){for(let i in this.gizmos){let r=this.gizmos[i];r instanceof $C&&(r.visible=!1)}}},YA=790,Kg=new N,i3=new N,r3=new ni,n3=new N,ox=new N,s3=new N,mo=class extends Q0(Jm,cRe){constructor(e="",i={...i1.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=o0.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,i),this.previousProjectionMatrix=new lt,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,n=this.height;this.orthoCamera=new MF(r*-.5,r*.5,n*.5,n*-.5,-5e4,1e4),this.perspCamera=new uo(45,r/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,i){e==="PerspectiveCamera"?this.perspCamera.near=i:this.orthoCamera.near=i}setZoom(e,i){i>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=i:this.orthoCamera.zoom=i)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,i,r){typeof e=="number"&&(e=new N(e,i,r)),super.lookAt(e),this.getWorldPosition(Kg),this.targetOffset=Kg.distanceTo(e)}getTarget(e=new N){return this.getWorldDirection(i3),this.getWorldPosition(Kg),i3.multiplyScalar(this.targetOffset),e.copy(Kg).add(i3),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Kg),Kg.distanceTo(e)}updateUp(){this.getWorldQuaternion(r3),n3.set(0,0,1).applyQuaternion(r3),ox.copy(ir.DEFAULT_UP),this.isUpVectorFlipped&&ox.negate(),ox.applyQuaternion(r3),s3.copy(ir.DEFAULT_UP).projectOnPlane(n3),this.angleOffsetFromUp=s3.angleTo(ox),this.angleOffsetFromUp*=s3.cross(ox).dot(n3)>=0?1:-1}updateTransformState(e,i){let r=super.updateTransformState(e,i);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let i=e.getWorldPosition(new N),r=e.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:i.clone().add(r),target:i}}getViewToTarget(e){let i=this.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:e.clone().sub(i),target:e}}getViewToObject(e){let i=new N;return e.getWorldPosition(i),this.getViewToTarget(i)}setViewplaneSize(e,i,r=!1){if(this.aspect=e/i,r){let n=e>i?this.aspect:1,s=e>i?1:this.aspect;this.left=-YA*.5*n,this.right=YA*.5*n,this.top=YA*.5*(1/s),this.bottom=-YA*.5*(1/s)}else this.left=-e*.5,this.right=e*.5,this.top=i*.5,this.bottom=-i*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,i,r,n,s,o){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,i,r,n,s,o):this.orthoCamera.setViewOffset(e,i,r,n,s,o)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,i){return super.copy(e,i),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let i={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return hB(i,e)}updateCameraSubtype(e,i){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";i.zoom!==void 0&&this.setZoom(r,i.zoom),i.near!==void 0&&this.setNear(r,i.near),i.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=i.fov)}updateState(e,i){this.updateCameraState(e,i)}updateCameraState(e,i){this.updateState_Entity(e,i),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,i,r){super.updateByPatchedOp(e,i,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},Jg=new lt,dRe=new lt;function eW(t){let e=!1;return t.scene.objects.traverse((i,r)=>{var n;((n=r.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(e=!0)}),e}var Fm=class extends J0{constructor(t,e,i){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ht,this.onAfterRender=(r,n,s,o,a,l)=>{super.onAfterRender(r,n,s,o,a,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var r;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let n=0;n<this.children.length;n++){let s=this.children[n];s instanceof Fm&&s.dataPatched.visible===!0&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let n=0;n<this.children.length;n++){let s=this.children[n];if(s instanceof qo&&s.dataPatched.visible===!0&&((r=s.geometry.attributes.position)==null?void 0:r.count)>0&&s.geometry.drawRange.count>0&&s.booleanMeshSetAddress!==0){Jg.multiplyMatrices(s.hiddenMatrix,s.matrix);try{if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ac.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;Ac.transformMeshSet(s.booleanMeshSetAddress,Jg),s.booleanMatrixInvOld.copy(Jg).invert(),s.booleanWasTransformed=!1}else s instanceof Fm&&s.needsTransformForDownstream===!0?(Ac.transformMeshSet(s.booleanMeshSetAddress,Jg),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Ac.transformMeshSet(s.booleanMeshSetAddress,dRe.multiplyMatrices(Jg,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(Jg).invert(),s.booleanWasTransformed=!1)}catch(o){console.error(o),s.booleanMeshSetAddress=0,s.geometry.userData.booleanOperationDidFail=!0;continue}Ac.hasOpenEdges(s.booleanMeshSetAddress)===!1||n===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.booleanOperationDidFail=!1):s.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new _t([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return Ac.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new Ht,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=Ac.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(n){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(n)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Tz(this),Rz(this)}dispose(){super.dispose(),this.geometry.dispose()}},fO;(t=>{function e(i){return Ti.is(i)&&i instanceof Z1}t.is=e})(fO||(fO={}));var kz=(t,e)=>class extends Q0(t,e){updateState_Light(i,r){this.updateState_Entity(i,r),i.color!==void 0&&(this.color=r.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},fu=t=>t instanceof qo,zc=t=>t!==null&&t instanceof Fm,pRe=t=>t instanceof mo,fRe=t=>fO.is(t),mO=t=>pO.is(t),r_=class extends t_(Vve){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(t,e){i_(this.object,r_.geometryHelper,t,e)}update(){}},Bv=class extends Q0(Yf,r_){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e),"buffer"in t&&Object.keys(t).length===1&&e.scene.reloadSplats()}},IM=class extends Q0(Yf,r_){constructor(t,e,i){super(),this.super_Entity(t,e),this.context=i,this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},Yee={RED:0,GREEN:1,BLUE:2,ALPHA:3},n_="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",mRe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,KA=class extends er{constructor(t=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:t?"2":"1"},uniforms:{kernel64:new st(null),kernel16:new st(null),inputBuffer:new st(null),cocBuffer:new st(null),texelSize:new st(new me),scale:new st(1)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:mRe,vertexShader:n_}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set cocBuffer(t){this.uniforms.cocBuffer.value=t}setCoCBuffer(t){this.uniforms.cocBuffer.value=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(t){return this.uniforms.scale.value=t}setScale(t){this.uniforms.scale.value=t}generateKernel(){let t=2.39996323,e=new Float32Array(128),i=new Float32Array(32),r=0,n=0;for(let a=0;a<80;++a){let l=a*t,u=Math.sqrt(a)/Math.sqrt(80),c=u*Math.cos(l),h=u*Math.sin(l);a%5===0?(i[n++]=c,i[n++]=h):(e[r++]=c,e[r++]=h)}let s=[],o=[];for(let a=0;a<128;)s.push(new si(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)o.push(new si(i[a++],i[a++],i[a++],i[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}};function tW(t,e,i){return t*(e-i)-e}function gO(t,e,i){return Math.min(Math.max((t+e)/(e-i),0),1)}var gRe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,yRe=class extends er{constructor(t){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new st(null),focusDistance:new st(0),focusRange:new st(0),cameraNear:new st(.3),cameraFar:new st(1e3)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:gRe,vertexShader:n_}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(t)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=ld){this.depthBuffer=t,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(t){this.uniforms.focusDistance.value=t}get worldFocusDistance(){return-tW(this.focusDistance,this.near,this.far)}set worldFocusDistance(t){this.focusDistance=gO(-t,this.near,this.far)}getFocusDistance(t){this.uniforms.focusDistance.value=t}setFocusDistance(t){this.uniforms.focusDistance.value=t}get focalLength(){return this.focusRange}set focalLength(t){this.focusRange=t}get focusRange(){return this.uniforms.focusRange.value}set focusRange(t){this.uniforms.focusRange.value=t}get worldFocusRange(){return-tW(this.focusRange,this.near,this.far)}set worldFocusRange(t){this.focusRange=gO(-t,this.near,this.far)}getFocalLength(t){return this.focusRange}setFocalLength(t){this.focusRange=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof uo?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},vRe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,bRe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",iW=class extends er{constructor(t=new me){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new st(null),texelSize:new st(new me),halfTexelSize:new st(new me),kernel:new st(0),scale:new st(1)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:vRe,vertexShader:bRe}),this.toneMapped=!1,this.setTexelSize(t.x,t.y)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},xRe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,wRe=class extends er{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new st(null),opacity:new st(1)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:xRe,vertexShader:n_}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},_Re=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,SRe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,jP={DEPTH:0,LUMA:1,COLOR:2},ARe={DISABLED:0,DEPTH:1,CUSTOM:2},ERe=class extends er{constructor(t=new me,e=jP.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:B0.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new st(null),depthBuffer:new st(null),predicationBuffer:new st(null),texelSize:new st(t)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:_Re,vertexShader:SRe}),this.toneMapped=!1,this.edgeDetectionMode=e}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=ld){this.depthBuffer=t,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(t){this.defines.EDGE_DETECTION_MODE=t.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(t){this.edgeDetectionMode=t}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(t){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=t.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(t){this.localContrastAdaptationFactor=t}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("6"),this.defines.DEPTH_THRESHOLD=(t*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(t){this.edgeDetectionThreshold=t}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(t){this.defines.PREDICATION_MODE=t.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(t){this.predicationMode=t}set predicationBuffer(t){this.uniforms.predicationBuffer.value=t}setPredicationBuffer(t){this.uniforms.predicationBuffer.value=t}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(t){this.defines.PREDICATION_THRESHOLD=t.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(t){this.predicationThreshold=t}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(t){this.defines.PREDICATION_SCALE=t.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(t){this.predicationScale=t}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(t){this.defines.PREDICATION_STRENGTH=t.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(t){this.predicationStrength=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},MRe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,CRe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",$l={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},yO=class extends er{constructor(t,e,i,r,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:B0.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new st(null),depthBuffer:new st(null),resolution:new st(new me),texelSize:new st(new me),cameraNear:new st(.3),cameraFar:new st(1e3),aspect:new st(1),time:new st(0)},blending:Gn,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,t&&this.setShaderParts(t),e&&this.setDefines(e),i&&this.setUniforms(i),this.adoptCameraSettings(r)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=ld){this.depthBuffer=t,this.depthPacking=e}setShaderParts(t){return this.fragmentShader=MRe.replace($l.FRAGMENT_HEAD,t.get($l.FRAGMENT_HEAD)).replace($l.FRAGMENT_MAIN_UV,t.get($l.FRAGMENT_MAIN_UV)).replace($l.FRAGMENT_MAIN_IMAGE,t.get($l.FRAGMENT_MAIN_IMAGE)),this.vertexShader=CRe.replace($l.VERTEX_HEAD,t.get($l.VERTEX_HEAD)).replace($l.VERTEX_MAIN_SUPPORT,t.get($l.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(let e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(let e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(let e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof uo?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){let i=this.uniforms;i.resolution.value.set(t,e),i.texelSize.value.set(1/t,1/e),i.aspect.value=t/e}static get Section(){return $l}},PRe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,TRe=class extends er{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:B0.replace(/\D+/g,"")},uniforms:{inputBuffer:new st(null),threshold:new st(0),smoothing:new st(1),range:new st(null)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:PRe,vertexShader:n_}),this.toneMapped=!1,this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},RRe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Kee={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},kRe=class extends er{constructor(t=null){super({name:"MaskMaterial",uniforms:{maskTexture:new st(t),inputBuffer:new st(null),strength:new st(1)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:RRe,vertexShader:n_}),this.toneMapped=!1,this.setColorChannel(Yee.RED),this.setMaskFunction(Kee.DISCARD)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set maskTexture(t){this.uniforms.maskTexture.value=t,delete this.defines.MASK_PRECISION_HIGH,t.type!==bo&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(t){this.maskTexture=t}set colorChannel(t){this.defines.COLOR_CHANNEL=t.toFixed(0),this.needsUpdate=!0}setColorChannel(t){this.colorChannel=t}set maskFunction(t){this.defines.MASK_FUNCTION=t.toFixed(0),this.needsUpdate=!0}setMaskFunction(t){this.maskFunction=t}get inverted(){return this.defines.INVERTED!==void 0}set inverted(t){this.inverted&&!t?delete this.defines.INVERTED:t&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(t){this.inverted=t}get strength(){return this.uniforms.strength.value}set strength(t){this.uniforms.strength.value=t}getStrength(){return this.strength}setStrength(t){this.strength=t}},DRe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,IRe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",LRe=class extends er{constructor(t=new me,e=new me){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new st(null),searchTexture:new st(null),areaTexture:new st(null),resolution:new st(e),texelSize:new st(t)},blending:Gn,depthWrite:!1,depthTest:!1,fragmentShader:DRe,vertexShader:IRe}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(t){this.uniforms.searchTexture.value=t}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(t){this.uniforms.areaTexture.value=t}setLookupTextures(t,e){this.searchTexture=t,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(t){let e=Math.min(Math.max(t,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(t){this.orthogonalSearchSteps=t}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(t){let e=Math.min(Math.max(t,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(t){this.diagonalSearchSteps=t}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(t){t?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(t){this.diagonalDetection=t}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(t){let e=Math.min(Math.max(t,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(t){this.cornerRounding=t}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(t){t?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(t){this.cornerDetection=t}setSize(t,e){let i=this.uniforms;i.texelSize.value.set(1/t,1/e),i.resolution.value.set(t,e)}},BRe=new Jm,Pd=null;function ORe(){if(Pd===null){let t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);Pd=new Ht,Pd.setAttribute!==void 0?(Pd.setAttribute("position",new ei(t,3)),Pd.setAttribute("uv",new ei(e,2))):(Pd.addAttribute("position",new ei(t,3)),Pd.addAttribute("uv",new ei(e,2)))}return Pd}var Zo=class{constructor(t="Pass",e=new Wc,i=BRe){this.name=t,this.renderer=null,this.scene=e,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){let e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!t}}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let e=this.screen;e!==null?e.material=t:(e=new zn(ORe(),t),e.frustumCulled=!1,this.scene===null&&(this.scene=new Wc),this.scene.add(e),this.screen=e)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,e=ld){}render(t,e,i,r,n){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof Wc||e===this.renderer)continue;this[t].dispose()}}}},vO=class extends Zo{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new wRe,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new $i(1,1,{minFilter:mi,magFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,i,r,n){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==bo?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t.outputEncoding===pi&&(this.renderTarget.texture.encoding=pi))}},URe=class extends Zo{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,i,r,n){let s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},o3=new Xt,Dz=class extends Zo{constructor(t=!0,e=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,i){this.color=t,this.depth=e,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,i,r,n){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,u=o>=0;l?(o3.copy(t.getClearColor(o3)),t.setClearColor(s,u?o:a)):u&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(o3,a):u&&t.setClearAlpha(a)}},Td=-1,ga=class extends Ys{constructor(t,e=Td,i=Td,r=1){super(),this.resizable=t,this.base=new me(1,1),this.preferred=new me(e,i),this.target=this.preferred,this.s=r}get width(){let{base:t,preferred:e,scale:i}=this,r;return e.width!==Td?r=e.width:e.height!==Td?r=Math.round(e.height*(t.width/Math.max(t.height,1))):r=Math.round(t.width*i),r}set width(t){this.preferredWidth=t}get height(){let{base:t,preferred:e,scale:i}=this,r;return e.height!==Td?r=e.height:e.width!==Td?r=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):r=Math.round(t.height*i),r}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferred.setScalar(Td),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.base.width}set baseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(t){this.base.width!==t&&(this.base.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(t){this.base.height!==t&&(this.base.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.base.width!==t||this.base.height!==e)&&(this.base.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(t){this.preferred.width!==t&&(this.preferred.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferred.height}set preferredHeight(t){this.preferred.height!==t&&(this.preferred.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferred.width!==t||this.preferred.height!==e)&&(this.preferred.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(t){this.base.set(t.getBaseWidth(),t.getBaseHeight()),this.preferred.set(t.getPreferredWidth(),t.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Td}},a3=!1,rW=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let i;if(e.material.flatShading)switch(e.material.side){case fa:i=this.materialsFlatShadedDoubleSide;break;case As:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(e.material.side){case fa:i=this.materialsDoubleSide;break;case As:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=i[2]:e.isInstancedMesh?e.material=i[1]:e.material=i[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){let e=this.materials=[t.clone(),t.clone(),t.clone()];for(let i of e)i.uniforms=Object.assign({},t.uniforms),i.side=Eu;e[2].skinning=!0,this.materialsBackSide=e.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},t.uniforms),r.side=As,r}),this.materialsDoubleSide=e.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},t.uniforms),r.side=fa,r}),this.materialsFlatShaded=e.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r.side=As,r}),this.materialsFlatShadedDoubleSide=e.map(i=>{let r=i.clone();return r.uniforms=Object.assign({},t.uniforms),r.flatShading=!0,r.side=fa,r})}}render(t,e,i){let r=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,a3){let n=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,i);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,i),e.overrideMaterial=n}t.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){let t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return a3}static set workaroundEnabled(t){a3=t}},NRe=class extends Zo{constructor(t,e,i=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new Dz,this.overrideMaterialManager=i===null?null:new rW(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){let t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){let e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new rW(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,i,r,n){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,u=s.background,c=t.shadowMap.autoUpdate,h=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=u,t.shadowMap.autoUpdate=c}},nW=class extends Zo{constructor(t,e,{resolutionScale:i=1,width:r=ga.AUTO_SIZE,height:n=ga.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new NRe(t,e,new LQ({depthPacking:xQ}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new Xt(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new $i(1,1,{minFilter:Zi,magFilter:Zi,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new ga(this,r,n,i);l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,r,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}},Li={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},FRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",zRe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",HRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",GRe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",VRe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",jRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",WRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",qRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",XRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",YRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",KRe="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",JRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",QRe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",ZRe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",$Re="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",eke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",tke="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",ike="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",rke=new Map([[Li.SKIP,null],[Li.ADD,FRe],[Li.ALPHA,zRe],[Li.AVERAGE,HRe],[Li.COLOR_BURN,GRe],[Li.COLOR_DODGE,VRe],[Li.DARKEN,jRe],[Li.DIFFERENCE,WRe],[Li.EXCLUSION,qRe],[Li.LIGHTEN,XRe],[Li.MULTIPLY,YRe],[Li.DIVIDE,KRe],[Li.NEGATION,JRe],[Li.NORMAL,QRe],[Li.OVERLAY,ZRe],[Li.REFLECT,$Re],[Li.SCREEN,eke],[Li.SOFT_LIGHT,tke],[Li.SUBTRACT,ike]]),nke=class extends Ys{constructor(t,e=1){super(),this.f=t,this.opacity=new st(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this.f}set blendFunction(t){this.f=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return rke.get(this.blendFunction)}},Ch={NONE:0,DEPTH:1,CONVOLUTION:2},jh=class extends Ys{constructor(t,e,{attributes:i=Ch.NONE,blendFunction:r=Li.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=i,this.fragmentShader=e,this.vertexShader=a,this.defines=n,this.uniforms=s,this.extensions=o,this.blendMode=new nke(r),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=ld){}update(t,e,i){}setSize(t,e){}initialize(t,e,i){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof Wc||e===this.renderer)continue;this[t].dispose()}}}};function sW(t,e,i){for(let r of e){let n="$1"+t+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(let o of i.entries())o[1]!==null&&i.set(o[0],o[1].replace(s,n))}}function ske(t,e,i,r,n,s,o){let a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),u=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),c=[],h=[],d=!1,p=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(u&&o&Ch.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!u)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=yO.Section;if(u){let y=`	${t}MainUv(UV);
`;i.set(m.FRAGMENT_MAIN_UV,i.get(m.FRAGMENT_MAIN_UV)+y),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let y=`	${t}MainSupport(`;y+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,i.set(m.VERTEX_MAIN_SUPPORT,i.get(m.VERTEX_MAIN_SUPPORT)+y),c=c.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(v=>v[1])),h=h.concat(c).concat([...a.get("vertex").matchAll(f)].map(v=>v[1]))}h=h.concat([...a.get("fragment").matchAll(f)].map(y=>y[1])),h=h.concat([...e.defines.keys()].map(y=>y.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...e.uniforms.keys()]),e.uniforms.forEach((y,v)=>s.set(t+v.charAt(0).toUpperCase()+v.slice(1),y)),e.defines.forEach((y,v)=>n.set(t+v.charAt(0).toUpperCase()+v.slice(1),y)),sW(t,h,n),sW(t,h,a);let g=e.blendMode;if(r.set(g.blendFunction,g),l){let y=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,v=`${t}MainImage(color0, UV, `;o&Ch.DEPTH&&y.test(a.get("fragment"))&&(v+="depth, ",p=!0),v+=`color1);
	`;let b=t+"BlendOpacity";s.set(b,g.opacity),v+=`color0 = blend${g.blendFunction}(color0, color1, ${b});

	`,i.set(m.FRAGMENT_MAIN_IMAGE,i.get(m.FRAGMENT_MAIN_IMAGE)+v),v=`uniform float ${b};

`,i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+v)}i.set(m.FRAGMENT_HEAD,i.get(m.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&i.set(m.VERTEX_HEAD,i.get(m.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:c,transformedUv:d,readDepth:p}}var B2=class extends Zo{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new yO(null,null,null,t),this.effects=e.sort((i,r)=>r.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){let e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}verifyResources(){let t=this.renderer.capabilities,e=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniformCount>e&&console.warn("The current rendering context doesn't support more than "+e+" uniforms, but "+this.uniformCount+" were defined"),e=t.maxVaryings,this.varyingCount>e&&console.warn("The current rendering context doesn't support more than "+e+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let t=yO.Section,e=new Map([[t.FRAGMENT_HEAD,""],[t.FRAGMENT_MAIN_UV,""],[t.FRAGMENT_MAIN_IMAGE,""],[t.VERTEX_HEAD,""],[t.VERTEX_MAIN_SUPPORT,""]]),i=new Map,r=new Map,n=new Map,s=new Set,o=0,a=0,l=0,u=!1,c=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Li.SKIP)l|=d.getAttributes()&Ch.DEPTH;else if(l&d.getAttributes()&Ch.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let p="e"+o++,f=ske(p,d,e,i,r,n,l);if(a+=f.varyings.length,u=u||f.transformedUv,c=c||f.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let h=/\bblend\b/g;for(let d of i.values()){let p=d.getShaderCode().replace(h,`blend${d.blendFunction}`);e.set(t.FRAGMENT_HEAD,e.get(t.FRAGMENT_HEAD)+p+`
`)}if(l&Ch.DEPTH){if(c){let d=`float depth = readDepth(UV);

	`;e.set(t.FRAGMENT_MAIN_IMAGE,d+e.get(t.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(u){let d=`vec2 transformedUv = vUv;
`;e.set(t.FRAGMENT_MAIN_UV,d+e.get(t.FRAGMENT_MAIN_UV)),r.set("UV","transformedUv")}else r.set("UV","vUv");e.forEach((d,p,f)=>f.set(p,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(e).setExtensions(s).setUniforms(n).setDefines(r)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=ld){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(let i of this.effects)i.setDepthTexture(t,e)}render(t,e,i,r,n){for(let s of this.effects)s.update(t,e,r);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r,t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(let i of this.effects)i.setSize(t,e)}initialize(t,e,i){this.renderer=t;for(let r of this.effects)r.initialize(t,e,i),r.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==bo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},oke=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Iz=class extends Zo{constructor({resolutionScale:t=.5,width:e=ga.AUTO_SIZE,height:i=ga.AUTO_SIZE,kernelSize:r=WP.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new $i(1,1,{minFilter:mi,magFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new ga(this,e,i,t);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new iW,this.ditheredBlurMaterial=new iW,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=r}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,i,r,n){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,u=oke[this.kernelSize],c=this.blurMaterial,h=e,d,p;for(this.fullscreenMaterial=c,d=0,p=u.length-1;d<p;++d){let f=d&1?l:a;c.kernel=u[d],c.inputBuffer=h.texture,t.setRenderTarget(f),t.render(s,o),h=f}this.dithering&&(c=this.ditheredBlurMaterial,this.fullscreenMaterial=c),c.kernel=u[d],c.inputBuffer=h.texture,t.setRenderTarget(this.renderToScreen?null:i),t.render(s,o)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let r=i.width,n=i.height;this.renderTargetA.setSize(r,n),this.renderTargetB.setSize(r,n),this.blurMaterial.setSize(r,n),this.ditheredBlurMaterial.setSize(r,n)}initialize(t,e,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==bo?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t.outputEncoding===pi&&(this.renderTargetA.texture.encoding=pi,this.renderTargetB.texture.encoding=pi))}static get AUTO_SIZE(){return ga.AUTO_SIZE}},ake=class extends Zo{constructor({width:t=ga.AUTO_SIZE,height:e=ga.AUTO_SIZE,renderTarget:i,luminanceRange:r,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new TRe(n,r),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new $i(1,1,{minFilter:mi,magFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new ga(this,t,e);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,i,r,n){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height)}initialize(t,e,i){i!==void 0&&i!==bo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},lke=class extends Zo{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new Dz(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,i,r,n){let s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,u=this.clearPass,c=this.inverted?0:1,h=1-c;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,c,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(t,null):(u.render(t,e),u.render(t,i))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(i),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},du=class extends Zo{constructor(t,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=t,this.inputBufferUniform=null,this.setInput(e)}setInput(t){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let e=this.fullscreenMaterial.uniforms;e!==void 0&&e[t]!==void 0&&(this.inputBufferUniform=e[t])}}render(t,e,i,r,n){this.inputBufferUniform!==null&&e!==null&&(this.inputBufferUniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:i),t.render(this.scene,this.camera)}initialize(t,e,i){i!==void 0&&i!==bo&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},l3=1/1e3,uke=1e3,hke=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(t){return this.fixedDeltaEnabled=t,this}isAutoResetEnabled(t){return this.autoReset}setAutoResetEnabled(t){return typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=t),this}getDelta(){return this.delta*l3}getFixedDelta(){return this.fixedDelta*l3}setFixedDelta(t){return this.fixedDelta=t*uke,this}getElapsed(){return this.elapsed*l3}getTimescale(){return this.timescale}setTimescale(t){return this.timescale=t,this}update(t){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=t!==void 0?t:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(t){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},WP={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},cke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,dke=class extends jh{constructor({blendFunction:t=Li.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:i=.025,resolutionScale:r=.5,intensity:n=1,width:s=ga.AUTO_SIZE,height:o=ga.AUTO_SIZE,kernelSize:a=WP.LARGE}={}){super("BloomEffect",cke,{blendFunction:t,uniforms:new Map([["map",new st(null)],["intensity",new st(n)]])}),this.renderTarget=new $i(1,1,{minFilter:mi,magFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new ake({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new Iz({resolutionScale:r,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",u=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,i){let r=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,r),this.blurPass.render(t,r,r)):this.blurPass.render(t,e,r)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(t,e,i){this.blurPass.initialize(t,e,i),i!==void 0&&(this.renderTarget.texture.type=i,t.outputEncoding===pi&&(this.renderTarget.texture.encoding=pi))}},pke="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",fke=class extends jh{constructor({blendFunction:t=Li.NORMAL,brightness:e=0,contrast:i=0}={}){super("BrightnessContrastEffect",pke,{blendFunction:t,uniforms:new Map([["brightness",new st(e)],["contrast",new st(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(t){this.uniforms.get("brightness").value=t}getBrightness(t){return this.brightness}setBrightness(t){this.brightness=t}get contrast(){return this.uniforms.get("contrast").value}set contrast(t){this.uniforms.get("contrast").value=t}getContrast(t){return this.contrast}setContrast(t){this.contrast=t}},mke="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",gke=class extends jh{constructor(t=Li.NORMAL){super("ColorAverageEffect",mke,{blendFunction:t})}},yke="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",vke="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",bke=class extends jh{constructor({blendFunction:t=Li.NORMAL,offset:e=new me(.001,5e-4)}={}){super("ChromaticAberrationEffect",yke,{vertexShader:vke,blendFunction:t,attributes:Ch.CONVOLUTION,uniforms:new Map([["offset",new st(e)]])})}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},xke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,wke=class extends jh{constructor(t,{blendFunction:e=Li.NORMAL,worldFocusDistance:i,worldFocusRange:r,focusDistance:n=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=ga.AUTO_SIZE,height:u=ga.AUTO_SIZE}={}){super("DepthOfFieldEffect",xke,{blendFunction:e,attributes:Ch.DEPTH,uniforms:new Map([["nearColorBuffer",new st(null)],["farColorBuffer",new st(null)],["nearCoCBuffer",new st(null)],["scale",new st(1)]])}),this.camera=t,this.renderTarget=new $i(1,1,{minFilter:mi,magFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new du(new yRe(t));let c=this.cocMaterial;c.focusDistance=n,c.focusRange=o,i!==void 0&&(c.worldFocusDistance=i),r!==void 0&&(c.worldFocusRange=r),this.blurPass=new Iz({kernelSize:WP.MEDIUM,width:l,height:u});let h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new du(new kRe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=Kee.MULTIPLY,d.colorChannel=Yee.GREEN,this.bokehNearBasePass=new du(new KA(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new du(new KA(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new du(new KA(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new du(new KA(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(t){let e=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of e)i.fullscreenMaterial.setScale(t);this.maskPass.fullscreenMaterial.setStrength(t),this.uniforms.get("scale").value=t}getBokehScale(){return this.bokehScale}setBokehScale(t){this.bokehScale=t}getTarget(){return this.target}setTarget(t){this.target=t}calculateFocusDistance(t){let e=this.camera,i=e.position.distanceTo(t);return gO(-i,e.near,e.far)}setDepthTexture(t,e=ld){this.circleOfConfusionMaterial.depthBuffer=t,this.circleOfConfusionMaterial.depthPacking=e}update(t,e,i){let r=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(t,null,n),this.blurPass.render(t,n,s),this.maskPass.render(t,e,o),this.bokehFarBasePass.render(t,o,r),this.bokehFarFillPass.render(t,r,this.renderTargetFar),this.bokehNearBasePass.render(t,e,r),this.bokehNearFillPass.render(t,r,this.renderTargetNear)}setSize(t,e){let i=this.resolution;i.setBaseSize(t,e);let r=i.width,n=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(t,e)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(r,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(r,n))}initialize(t,e,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(r=>r.initialize(t,e,i)),this.blurPass.initialize(t,e,bo),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,t.outputEncoding===pi&&(this.renderTarget.texture.encoding=pi,this.renderTargetNear.texture.encoding=pi,this.renderTargetFar.texture.encoding=pi,this.renderTargetMasked.texture.encoding=pi))}};new N;new lt;var _ke="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",Ske=class extends jh{constructor({blendFunction:t=Li.NORMAL,hue:e=0,saturation:i=0}={}){super("HueSaturationEffect",_ke,{blendFunction:t,uniforms:new Map([["hue",new st(new N)],["saturation",new st(i)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(t){this.uniforms.get("saturation").value=t}getSaturation(){return this.saturation}setSaturation(t){this.saturation=t}get hue(){let t=this.uniforms.get("hue").value;return Math.acos((t.x*3-1)/2)}set hue(t){let e=Math.sin(t),i=Math.cos(t);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3)}getHue(){return this.hue}setHue(t){this.hue=t}};new Xt;var Ake=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Eke=class extends jh{constructor({blendFunction:t=Li.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",Ake,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},Mke="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",Cke=class extends jh{constructor(t=30){super("PixelationEffect",Mke,{uniforms:new Map([["active",new st(!1)],["d",new st(new me)]])}),this.resolution=new me,this.d=0,this.granularity=t}get granularity(){return this.d}set granularity(t){let e=Math.floor(t);e%2>0&&(e+=1),this.d=e,this.uniforms.get("active").value=e>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(t){this.granularity=t}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new N;new N;var oW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",aW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",Pke="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",Tke="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Gf={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Jee=class extends jh{constructor({preset:t=Gf.MEDIUM,edgeDetectionMode:e=jP.COLOR,predicationMode:i=ARe.DISABLED}={}){super("SMAAEffect",Pke,{vertexShader:Tke,blendFunction:Li.NORMAL,attributes:Ch.CONVOLUTION|Ch.DEPTH,uniforms:new Map([["weightMap",new st(null)]])});let r,n;arguments.length>1&&(r=arguments[0],n=arguments[1],arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])),this.renderTargetEdges=new $i(1,1,{minFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Dz(!0,!1,!1),this.clearPass.overrideClearColor=new Xt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new du(new ERe),this.edgeDetectionMaterial.edgeDetectionMode=e,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new du(new LRe);let s=new $Q;s.onLoad=()=>{let o=new Wr(r);o.name="SMAA.Search",o.magFilter=Zi,o.minFilter=Zi,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new Wr(n);a.name="SMAA.Area",a.magFilter=mi,a.minFilter=mi,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),r!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(r=new Image,n=new Image,r.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),r.src=oW,n.src=aW),this.applyPreset(t)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(t){this.edgeDetectionMaterial.edgeDetectionThreshold=t}setOrthogonalSearchSteps(t){this.weightsMaterial.orthogonalSearchSteps=t}applyPreset(t){let e=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(t){case Gf.LOW:e.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case Gf.MEDIUM:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case Gf.HIGH:e.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case Gf.ULTRA:e.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(t,e=ld){this.edgeDetectionMaterial.depthBuffer=t,this.edgeDetectionMaterial.depthPacking=e}update(t,e,i){this.clearPass.render(t,this.renderTargetEdges),this.edgeDetectionPass.render(t,e,this.renderTargetEdges),this.weightsPass.render(t,this.renderTargetEdges,this.renderTargetWeights)}setSize(t,e){this.edgeDetectionMaterial.setSize(t,e),this.weightsMaterial.setSize(t,e),this.renderTargetEdges.setSize(t,e),this.renderTargetWeights.setSize(t,e)}dispose(){let{searchTexture:t,areaTexture:e}=this.weightsMaterial;t!==null&&e!==null&&(t.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return oW}static get areaImageDataURL(){return aW}},Rke=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,JA={DEFAULT:0,ESKIL:1},kke=class extends jh{constructor({blendFunction:t=Li.NORMAL,technique:e=JA.DEFAULT,eskil:i=!1,offset:r=.5,darkness:n=.5}={}){super("VignetteEffect",Rke,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new st(r)],["darkness",new st(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===JA.ESKIL}set eskil(t){this.technique=t?JA.ESKIL:JA.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}},ud=class{constructor(t,e){this.enabled=!1,this.effect=new t(e),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Li.NORMAL}},Dke=class extends ud{constructor(){super(dke),this.blendFunction=Li.SCREEN}set intensity(t){this.effect.intensity=t}get intensity(){return this.effect.intensity}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(t){this.effect.luminanceMaterial.smoothing=t}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(t){this.effect.blurPass.scale=t}get blurScale(){return this.effect.blurPass.scale}set kernelSize(t){this.effect.blurPass.kernelSize=t}get kernelSize(){return this.effect.blurPass.kernelSize}},Ike=class extends ud{constructor(){super(fke)}set contrast(t){this.effect.uniforms.get("contrast").value=t}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(t){this.effect.uniforms.get("brightness").value=t}get brightness(){return this.effect.uniforms.get("brightness").value}},Lke=class extends ud{constructor(){super(bke),this.effect.offset=new me(.01,.01)}set offset(t){this.effect.offset.set(t[0]/1e3,t[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},Bke=class extends ud{constructor(){super(gke)}},Oke=class extends ud{constructor(){super(Ske),this._hue=0}set hue(t){this._hue=t,this.effect.setHue(t)}get hue(){return this._hue}set saturation(t){this.effect.uniforms.get("saturation").value=t}get saturation(){return this.effect.uniforms.get("saturation").value}},Uke=class extends ud{constructor(){super(Eke),this.blendFunction=Li.OVERLAY}},Nke=class extends ud{constructor(){super(kke)}get eskil(){return this.effect.eskil}set eskil(t){this.effect.eskil=t}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(t){this.effect.uniforms.get("darkness").value=t}get offset(){return this.effect.uniforms.get("offset").value}set offset(t){this.effect.uniforms.get("offset").value=t}},Fke=class extends ud{constructor(t){super(wke,t)}set focalLength(t){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=t}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(t){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=t}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}},zke=class extends ud{constructor(){super(Cke)}get granularity(){return this.effect.getGranularity()}set granularity(t){this.effect.setGranularity(t)}},Hke=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,Gke=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,Vke=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,jke=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,bO=class extends er{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new st(null)},blending:Gn,depthWrite:!1,depthTest:!1,vertexShader:Vke,fragmentShader:jke})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}},Wke=class extends Zo{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new bO,this.resolutionVector=new me,this.resolveMaterial=new er({name:"TAAResolveMaterial",uniforms:{inputBuffer:new st(null),historyBuffer:new st(null),velocityBuffer:new st(null),depthBuffer:new st(null),resolution:new st(new me)},blending:Gn,depthWrite:!1,depthTest:!1,vertexShader:Hke,fragmentShader:Gke}),this.historyRenderTarget=new $i(1024,1024,{minFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new $i(1024,1024,{minFilter:mi,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(t,e){this.historyRenderTarget.setSize(t,e),this.resultRenderTarget.setSize(t,e)}render(t,e){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=e.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=e.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=e.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(e.width,e.height),t.setRenderTarget(this.resultRenderTarget),t.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(this.historyRenderTarget),t.render(this.scene,this.camera);let i=this.renderToScreen?null:e;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,t.setRenderTarget(i),t.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},qke=class extends Zo{constructor(t,e,i){super("TransmissionPass",void 0,e),this.MRTCompatible=!0,this.depthPass=new nW(t,e,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new bO,this.splineScene=t,this.needsSwap=!1}updatePasses(t){this.passThroughMaterial=new bO,this.depthPass=new nW(this.splineScene,this.camera,{renderTarget:t.transmissionDepthTarget})}setCamera(t){this.camera=t}setScene(t){this.splineScene=t}render(t,e,i){let r=this.camera.layers.mask,n=t;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=e.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(t,e,i),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:e;this.camera.layers.set(3),t.setRenderTarget(s),t.render(this.splineScene,this.camera),this.camera.layers.mask=r}},lW=new Wc,Xke=new er({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),xO=class extends Zo{constructor(t,e,i){super("OpaquePass",e??lW,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=t}set splatViewer(t){this._splatViewer=t}get splatViewer(){return this._splatViewer}setCamera(t){this.camera=t}setScene(t){this.scene=t??lW}getScene(){return this.scene}render(t,e){var r;this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof qo&&(this.originalMaterials.set(n.id,n.material),n.material=Xke)}),t.shadowMap.needsUpdate=!0,t.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:e;if(t.setRenderTarget(i),this.clearColorOnly&&t.clear(!0,!1,!0),this.clear&&t.clear(),((r=this._splatViewer)==null?void 0:r.splatRenderingInitialized)===!0){let n=t.autoClear;t.autoClear=!1,t.render(this.scene,this.camera),this._splatViewer.update(),t.render(this._splatViewer.splatMesh,this.camera),t.autoClear=n}else t.render(this.scene,this.camera);this.clearDepth&&t.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,s)=>{let o=this.scene.getObjectById(s);o&&(o.material=n)})}},Yke=class{constructor(t,{depthBuffer:e=!0,stencilBuffer:i=!1,multisampling:r=0,frameBufferType:n=0}={}){this.renderer=t,this.helperStartIndex=0,this.copyPass=new vO,this.depthTexture=null,this.timer=new hke,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(e,i,n,r,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(e,i,n,r,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(e,i,n,r,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){let e=this.inputBuffer,i=this.multisampling;i>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){var e;if(this.renderer=t,t!==null){let i=t.getSize(new me),r=((e=t.getContext().getContextAttributes())==null?void 0:e.alpha)??!1,n=this.inputBuffer.texture[0].type;n===bo&&t.outputEncoding===pi&&(this.inputBuffer.texture[0].encoding=pi,this.outputBuffer.texture[0].encoding=pi,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),t.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(t,r,n)}}replaceRenderer(t,e=!0){let i=this.renderer,r=i.domElement.parentNode;return this.setRenderer(t),e&&r!==null&&(r.removeChild(i.domElement),r.appendChild(t.domElement)),i}createDepthTexture(){let t=this.depthTexture=new t0(this._width,this._height);return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Lm,t.type=dm):t.type=Uc,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,i,r,n,s){let o=this.renderer,a=o===null?new me:o.getDrawingBufferSize(new me),l={minFilter:mi,magFilter:mi,wrapS:kr,wrapT:kr,stencilBuffer:e,depthBuffer:t},u;return r>0?(u=new $i(a.width,a.height,l),u.samples=r):(n?(u=new Lde(a.width,a.height,2,l),u.texture[1].type=Im):u=new $i(a.width,a.height,l),u.depthTexture=new t0(2048,2048),u.depthTexture.type=Fn),i===bo&&o!==null&&o.outputEncoding===pi&&(Array.isArray(u.texture)?u.texture.forEach(c=>c.encoding=pi):u.texture.encoding=pi),Array.isArray(u.texture)?u.texture.forEach((c,h)=>{c.name=`EffectComposer.Buffer ${n} ${h}`,c.generateMipmaps=!1}):(u.texture.name=`EffectComposer.Buffer ${n}`,u.texture.generateMipmaps=!1),u.name=s,u}addPass(t,e){var a;let i=this.passes,r=this.renderer,n=r.getDrawingBufferSize(new me),s=((a=r.getContext().getContextAttributes())==null?void 0:a.alpha)??!1,o;if(t.MRTCompatible&&(o=this.inputBuffer.texture[0].type),t.MRTCompatible||(o=this.inputBuffer.texture.type),t.setRenderer(r),t.setSize(n.width,n.height),t.initialize(r,s,o),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?i.splice(e,0,t):i.push(t),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(t of i)t.setDepthTexture(l)}else t.setDepthTexture(this.depthTexture)}setHelperStartIndex(t){this.helperStartIndex=t}removePass(t){let e=this.passes,i=e.indexOf(t);if(i!==-1&&e.splice(i,1).length>0){if(this.depthTexture!==null){let r=(n,s)=>n||s.needsDepthTexture;e.reduce(r,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){let t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){let e=this.renderer,i=this.copyPass,r=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,o=this.outputBufferSingle,a=!1,l,u,c,h;t===void 0&&(t=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(e,r,n,t,a):d.render(e,s,o,t,a),d.needsSwap&&(a&&(i.renderToScreen=d.renderToScreen,l=e.getContext(),u=e.state.buffers.stencil,u.setFunc(l.NOTEQUAL,1,4294967295),i.render(e,r,n,t,a),u.setFunc(l.EQUAL,1,4294967295)),c=r,h=s,r=n,s=o,n=c,o=h),d instanceof lke?a=!0:d instanceof URe&&(a=!1))}setSize(t,e,i){let r=this.renderer;if(this._width=t,this._height=e,t===void 0||e===void 0){let s=r.getSize(new me);t=s.width,e=s.height}r.setSize(t,e,i);let n=r.getDrawingBufferSize(new me);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let t=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(t)}dispose(){for(let t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Kke=new er({name:"CombineMaterial",uniforms:{inputBufferA:new st(null),inputBufferB:new st(null)},blending:Gn,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),Jke=class extends Zo{constructor(t){super("HelperPass",void 0,t),this.MRTCompatible=!1,this.fullscreenMaterial=Kke,this.helperPass=new xO(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new xO(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let e=new Jee({preset:Gf.LOW,edgeDetectionMode:jP.COLOR});this.effectPass=new B2(this.camera,e),this.rt=new $i(10,10,{minFilter:mi,magFilter:mi,wrapS:kr,wrapT:kr,depthBuffer:!0})}setSize(t,e){this.rt.setSize(t,e),this.effectPass.setSize(t,e)}set sceneHelpers(t){this.helperPass.setScene(t)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(t){this.helperPassOnTop.setScene(t)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(t){this.helperPass.setCamera(t),this.helperPassOnTop.setCamera(t)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(t,e,i){this.rt.depthTexture=e.depthTexture;let r=t.getClearAlpha();t.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(t,this.rt),this.helperPassOnTop.render(t,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=e.texture,t.setClearAlpha(r),t.setRenderTarget(null),t.clear(),t.render(this.scene,this.camera)}},Qke=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Zke=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,$ke=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,eDe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,tDe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,iDe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,ax=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],rDe=new er({vertexShader:Qke,fragmentShader:Zke}),QA=new er({vertexShader:tDe,fragmentShader:iDe,uniforms:{texture_ao_lrez:new st(null),texture_depth_lrez:new st(null),texture_depth_hrez:new st(null),near:new st(null),far:new st(null)}}),nDe=class extends Zo{constructor(t,e){super("AmbientOcclusionPass",void 0,e),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,r=1024;this.gBuffer=new $i(i,r,{type:Fn,depthTexture:new t0(i,r),minFilter:mi,magFilter:mi}),this.depthBufferHighRes=new $i(i,r,{depthTexture:new t0(i,r)}),this.aoBuffer=new $i(i,r,{minFilter:mi,magFilter:mi}),this.splineScene=t,this.splineCamera=e;let n=new Float32Array(ax.length*2);for(let o=0;o<ax.length;o++){let a=o*2;n[a+0]=ax[o][0],n[a+1]=ax[o][1]}this.blueNoiseInDiskTexture=new Dl(n,ax.length,1,zC,Fn),this.blueNoiseInDiskTexture.wrapS=Oc,this.blueNoiseInDiskTexture.wrapT=Oc,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new er({vertexShader:$ke,fragmentShader:eDe,uniforms:{near:new st(null),far:new st(null),fov:new st(null),proj_info:new st(new si),is_ortho:new st(!1),resolution:new st(new me),radius_of_influence:new st(8),radius_in_screen_space:new st(1),exponent:new st(1),ao_color:new st(new N),bias:new st(.5),texture_depth:new st(null),texture_normals:new st(null),texture_blue_noise:new st(null),texture_blue_noise_in_disk:new st(this.blueNoiseInDiskTexture),frame_index:new st(0),fog_enabled:new st(!1),fog_near:new st(1),fog_far:new st(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new $i(i,r,{minFilter:mi,magFilter:mi,wrapS:kr,wrapT:kr,depthBuffer:!1,type:Fn});let s=new Jee({preset:Gf.ULTRA,edgeDetectionMode:jP.COLOR});this.effectPass=new B2(this.camera,s)}initialize(t,e,i){super.initialize(t,e,i),this.effectPass.initialize(t,e,i)}setBlueNoiseTexture(t){this.hbaoMaterial.uniforms.texture_blue_noise.value=t}setSize(t,e){this._width=t,this._height=e,this.depthBufferHighRes.setSize(t,e);let i=this._runHalfRes?.5:1,r=t*i,n=e*i;this.gBuffer.setSize(r,n),this.aoBuffer.setSize(r,n),this.hbaoMaterial.uniforms.resolution.value.set(r,n),this.aaBuffer.setSize(r,n),this.effectPass.setSize(r,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(t){this._runHalfRes=t,this.setSize(this._width,this._height)}setCamera(t){this.splineCamera=t}setScene(t){this.splineScene=t}render(t,e,i){this.splineScene.overrideMaterial=rDe;let r=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),t.setRenderTarget(this.gBuffer),t.clear(),t.render(this.splineScene,this.splineCamera),t.setRenderTarget(this.depthBufferHighRes),t.clear(),t.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=r,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],o=2/n[5],a=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let u=this.splineCamera.perspCamera.fov*(Math.PI/180),c=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(u*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],o=2/n[5],a=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,o,a,l);let u=.5*(this.hbaoMaterial.uniforms.resolution.value.y/o),c=this.hbaoMaterial.uniforms.radius_of_influence.value*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=c,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aoBuffer),t.clear(),t.render(this.scene,this.camera),this.fullscreenMaterial=QA,QA.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,QA.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,QA.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,t.setRenderTarget(t.aoRenderTarget),t.clear(),t.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,t.setRenderTarget(this.aaBuffer),t.clear(),t.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(t,this.aaBuffer,t.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},sDe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oDe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,aDe=class extends du{constructor(){super(new er({vertexShader:sDe,fragmentShader:oDe,uniforms:{tInput:new st(null),tMap:new st(null),uResolution:new st(new me),uSize:new st(new me),uCoords:new st(new me),uScale:new st(1),uSceneColor:new st(new Xt(16711680)),uDPR:new st(1),uCurrent:new st(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(t){this.uniforms.tMap.value=t}},lDe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,uDe=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,hDe=[],cDe=class extends du{constructor(){super(new er({vertexShader:lDe,fragmentShader:uDe,uniforms:{toScene:new st(null),fromScene:new st(null),uResolution:new st(new me),uDPR:new st(1),mixRatio:new st(0),threshold:new st(.1),useTexture:new st(0),tMixTexture:{value:hDe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(t){this.uniforms.fromScene.value=t}},dDe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,pDe=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
	gl_FragColor.a = 1.0;
}
`,fDe=class extends du{constructor(){super(new er({vertexShader:dDe,fragmentShader:pDe,uniforms:{inputBuffer:new st(null),blurredInputBuffer:new st(null),overlay:new st(null),uResolution:new st(new me),uDPR:new st(1),blurIntensity:new st(0)}})),this._blurEnabled=!1,this.blurTarget=new $i(1,1,{minFilter:mi,magFilter:mi,wrapS:kr,wrapT:kr}),this.blurPass=new Iz({width:window.innerWidth,height:window.innerHeight,kernelSize:WP.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(t){this.uniforms.overlay.value=t}setResolution(t,e,i=1){this.uniforms.uResolution.value.set(t,e).divideScalar(i),this.uniforms.uDPR.value=i,this.blurPass.setSize(t,e),this.blurTarget.setSize(t,e),this.blurPass.setSize(t,e)}get uiCanvas(){return this._uiCanvas}set uiCanvas(t){this._uiCanvas=t,t.texture&&(this.uniforms.overlay.value=t.texture);let e=t.frame;if(e){let i=e.data.backgroundBlur,r=i.radius;this._blurEnabled=i.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=r/3}}render(t,e,i,r,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(t,e,this.blurTarget,r,n)),super.render(t,e,i,r,n)}};function uW(t,e){return e&&e.enabled&&t.push(e.effect),t}var mDe=t=>Object.values(Li).includes(t)?t:Li.NORMAL,gDe=class extends Ys{constructor(t){super(),this.postprocessingState=b2.defaultData,this._scene=new Wc,this._camera=new mo,this.effects=new Map,this.blueNoiseTexture=new Dl,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new Mve,this.renderer=t,this.debug=!1,this.effects.set("bloom",new Dke),this.effects.set("chromaticAberration",new Lke),this.effects.set("vignette",new Nke),this.effects.set("noise",new Uke),this.effects.set("colorAverage",new Bke),this.effects.set("hueSaturation",new Oke),this.effects.set("brightnessContrast",new Ike),this.effects.set("depthOfField",new Fke),this.effects.set("pixelation",new zke),this.effectComposer=new Yke(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new xO(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new qke(this.scene,this.camera,this.renderer),this.aoPass=new nDe(this.scene,this.camera),this.taaPass=new Wke,this.taaPass.renderToScreen=!1,this.helperPass=new Jke(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new aDe,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new fDe,this.uiOverlayPass.enabled=!1,this.sceneTransitionPass=new cDe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(t){t!==void 0?(this.stylesOverlayPass.texture=t,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(t){this.helperPass.sceneHelpers=t}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(t){this.helperPass.sceneHelpersOnTop=t}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(t){this._scene=t,this.opaquePass.setScene(t),this.transmissionPass.setScene(t),this.aoPass.setScene(t)}get camera(){return this._camera}set camera(t){this._camera=t,this.opaquePass.setCamera(t),this.transmissionPass.setCamera(t),this.aoPass.setCamera(t),this.helperPass.setCamera(t)}updateRenderToScreen(){let t=!1;for(let e=this.effectComposer.passes.length-1;e>=0;e--){let i=this.effectComposer.passes[e];if(i.enabled===!0&&!t&&this._renderToScreen){i.renderToScreen=!0,t=!0;continue}i.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(t){this.blueNoiseTexture=new Dl(t,128,128),this.blueNoiseTexture.wrapS=Oc,this.blueNoiseTexture.wrapT=Oc,this.blueNoiseTexture.minFilter=Zi,this.blueNoiseTexture.magFilter=Zi,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(t,e,i,r,n,s,o,a){this.aoPass.enabled=t,this.aoPass.radius=e,this.aoPass.bias=i,this.aoPass.aoColor=r,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=o,this.aoPass.runHalfRes!==!a&&(this.aoPass.runHalfRes=!a)}setTransmissionPassEnabled(t){this.transmissionPass.enabled=t,this.opaquePass.hasTransmissionPass=t}_initPasses(){var t,e;if((t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce(uW,[]);i.length>0&&(this.uvEffectPass=new B2(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let r=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(uW,[]);r.length>0&&(this.effectPass=new B2(this.camera,...r),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let t=new me;this.renderer.getDrawingBufferSize(t),this._rt=new $i(t.x,t.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Oc,wrapT:Oc}),this._rt.samples=0,this._savePass=new vO(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(t){this._rt=t,this._savePass=new vO(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(t){if(this._renderToScreen===t)return;let e=this.effectComposer;!e||(t===!0?e.removePass(this._savePass):e.addPass(this._savePass),this._renderToScreen=t,this.updateRenderToScreen())}set sceneTransitionFromTexture(t){t!==this.sceneTransitionPass.texture&&(t!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=t)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(t){let{enabled:e,...i}=t,r=!1;e!==this.postprocessingState.enabled&&(r=!0);for(let n of Object.entries(i)){let s=n[1],o=this.effects.get(n[0]);if(o){o.enabled!==s.enabled&&(r=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=mDe(l):o[a]=l}}this.postprocessingState=t,r&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(t,e,i,r){t instanceof si?(this.effectComposer.inputBuffer.scissor.set(t.x,t.y,t.z,t.w),this.effectComposer.outputBuffer.scissor.set(t.x,t.y,t.z,t.w)):(this.effectComposer.inputBuffer.scissor.set(t,e,i,r),this.effectComposer.outputBuffer.scissor.set(t,e,i,r));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(t,e,i,r)}setScissorTest(t){this.effectComposer.inputBuffer.scissorTest=t,this.effectComposer.outputBuffer.scissorTest=t,this.renderer.setScissorTest(t)}setViewport(t,e,i,r){t instanceof si?(this.effectComposer.inputBuffer.viewport.copy(t),this.effectComposer.outputBuffer.viewport.copy(t)):(this.effectComposer.inputBuffer.viewport.set(t,e,i,r),this.effectComposer.outputBuffer.viewport.set(t,e,i,r))}resize(t,e,i){if(this.effectComposer.setSize(t,e,i),this._rt){let r=this.renderer.getPixelRatio();this._rt.setSize(t*r,e*r)}}dispose(){var t,e;(t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.dispose()}},yDe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,vDe=fi.lights_fragment_begin,bDe=fi.shadowmask_pars_fragment,hW=null,xDe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},wDe=(t="medium")=>{if(hW===t)return!1;hW=t;let e=xDe(t);fi.shadowmap_pars_fragment=yDe(e);let i=vDe.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),fi.lights_fragment_begin=i;let r=bDe.slice();return r=r.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),fi.shadowmask_pars_fragment=r,!0},_De=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,SDe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,u3=new er({vertexShader:_De,fragmentShader:SDe,uniforms:{depthContrast:{value:1}}}),cW=new Wr,ADe=class extends BQ{constructor(t){super(t),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new me,this.pipeline=new gDe(this),this.dummyCamera=new mo,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,o=!0)=>{let a=this.getContext(),l=0;n&&(l|=a.COLOR_BUFFER_BIT),s&&(l|=a.DEPTH_BUFFER_BIT),o&&(l|=a.STENCIL_BUFFER_BIT),a.clear(l),a.clearBufferfv(a.COLOR,1,[0,0,0,1])},this.autoClear=!1;let e=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=bF,this.dummyCamera.matrixAutoUpdate=!1;let r=this.getContext();if(r&&"drawingBufferColorSpace"in r)try{r.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,e(n))},this.setSize=(n,s,o=!0)=>{var a,l;(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,i(n,s,o),(a=this.normalRenderTarget)==null||a.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),(l=this.transmissionDepthTarget)==null||l.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new $i(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:mi,magFilter:mi,wrapS:kr,wrapT:kr,depthBuffer:!1}))}_resizeTransmission(t,e){var i,r;(i=this.transmissionRenderTarget)==null||i.setSize(t*this._pixelRatio/(this.hdTransmission?1:2),e*this._pixelRatio/(this.hdTransmission?1:2)),(r=this.aoRenderTarget)==null||r.setSize(t*this._pixelRatio/1,e*this._pixelRatio/1)}get hdTransmission(){return Kt.transmissionLod.value===1}set hdTransmission(t){Kt.transmissionLod.value=t===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new $i(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:$v,magFilter:mi,wrapS:kr,wrapT:kr,depthBuffer:!1}),this.transmissionDepthTarget=new $i(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:Zi,magFilter:Zi,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new $i(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Zi,magFilter:Zi,type:Fn,depthTexture:new t0(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(t,e,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),e.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof mo?u3.uniforms.depthContrast.value=(i.far-i.near)/1e4:u3.uniforms.depthContrast.value=1,e.overrideMaterial=u3,this.render(e,i),this.setClearColor(e.bgColor,e.bgColor.a),this.setRenderTarget(null),e.overrideMaterial=t.wireframeState?TO:null,i.layers.enable(0),i.layers.enable(3),e.traverseEntity(r=>{r.layers.isEnabled(8)&&(r.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(t,e,i=1){this.dummyCamera.updateCameraState(e.dataPatched),this.dummyCamera.matrix.copy(e.matrixWorld);let r=e.height,n=e.width,s=this.viewportWidth/this.viewportHeight;n<r?n=r*s:r=n/s,this.dummyCamera.setViewplaneSize(n,r);for(let o=0;o<i;o++)this.renderSplineScene(t,this.dummyCamera)}renderSplineScene(t,e,{sceneHelpers:i=void 0,sceneHelpersOnTop:r=void 0,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){var d;let o=t instanceof zz?t.activePage:t,a=o.visible;o.visible=!0;let l=o.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(e)),this.setClearColor(o.bgColor,o.bgColor.a),o.penumbraSizeArray.forEach((p,f)=>{Kt.penumbraSize.value[f]=p}),Kt.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?Kt.resolution.value.set(this.resolution.x,this.resolution.y):Kt.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(Kt.normalRenderTarget.value=s,Kt.normalRenderTargetDepth.value=cW):l.needsNormal()&&(this.createNormalRenderTarget(),Kt.normalRenderTarget.value=this.normalRenderTarget.texture,Kt.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,o,e));let u=o.data.ao,c=u.occlusion;c&&(this.createAORenderTarget(),Kt.aoRenderTarget.value=this.aoRenderTarget.texture),Kt.aoEnabled.value=c,this.pipeline.setAmbientOcclusionParams(u.occlusion,u.radius,u.bias,o.aoColor,o.fog!==null,o.backupFog.near,o.backupFog.far,u.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&((d=o.uiCanvas)!=null&&d.enabled)&&o.uiCanvas.texture&&o.uiCanvas.texture.image.width>0?((o.uiCanvas.width!==this.viewportWidth||o.uiCanvas.height!==this.viewportHeight)&&o.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight}),o.uiCanvas.render(),this.pipeline.uiOverlayPass.uiCanvas=o.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(this.domElement.width,this.domElement.height,window.devicePixelRatio),this.pipeline.updateRenderToScreen()):(this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen());let h=!1;if(n!==void 0)Kt.transmissionRenderTarget.value=n,Kt.transmissionRenderTargetDepth.value=cW,this.pipeline.setTransmissionPassEnabled(!1);else{let p=l.needsTransmission();p&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),Kt.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,Kt.aspectRatio.value=IPe(this.viewportWidth,this.viewportHeight),Kt.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(p)}e.layers.enable(3),e.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=o,this.pipeline.camera=e,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==o.postprocessing&&(this.pipeline.updatePostprocessing(o.postprocessing),!i&&!r&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),o.overrideMaterial=l.wireframeState?TO:null,this.pipeline.render(),Kt.frameIndex.value=(Kt.frameIndex.value+1)%16,e instanceof mo&&e.copyHistory(),o.visible=a}renderFromSceneForSceneTransitionPass(t,e,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(t,e),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let r=this.pipeline.sceneTransitionPass.uniforms;r.uDPR.value=window.devicePixelRatio,r.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var t,e,i,r,n,s;this._superDispose(),this.pipeline.dispose(),(t=this.aoRenderTarget)==null||t.dispose(),(e=this.transmissionRenderTarget)==null||e.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(r=this.normalRenderTarget)==null||r.dispose(),(s=(n=this.normalRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose()}},Qee=class extends t_(Gve){constructor(t,e=15,i=10066329){super(t,e,i),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){i_(this.object,Qee.geometryHelper,t,e)}},Zee=class extends t_(Hve){constructor(t,e=15,i=6710886){super(t,e,i),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){i_(this.object,Zee.geometryHelper,t,e)}},wO=class extends t_(zve){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){i_(this.object,wO.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=wO._vector,e=this.object.distance?this.object.distance:1e3,i=e*Math.tan(this.object.angle);this.cone.scale.set(i,i,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let r=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(r);else this.cone.material.color.set(r)}}},$ee=wO;$ee._vector=new N;function EDe(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var ete=class extends kz(Eve,Qee){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.top=1250,r.bottom=-1250,r.right=1250,r.left=-1250,r.near=-1e4,r.far=2500;let n=new ZC(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof ZC&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let i=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&EDe(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),i&&this.update()}},dW=new N,pW=new N,fW=new ni,tte=class extends kz(wve,$ee){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=kt.RAD2DEG*2*this.angle,r.aspect=1,r.near=100,r.far=2500;let n=new ZC(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof ZC&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),pW.setFromMatrixPosition(this.matrixWorld),fW.setFromRotationMatrix(this.matrixWorld),dW.copy(this.up).applyQuaternion(fW).negate().multiplyScalar(this.distance),this.target.position.copy(pW).add(dW),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.penumbraSize!==void 0&&e.scene.markPenumbraSizeDirty(),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function MDe(t){let e=(t[0][0]+t[1][1])/2,i=(t[0][0]-t[1][1])/2,r=(t[1][0]+t[0][1])/2,n=(t[1][0]-t[0][1])/2,s=Math.sqrt(e*e+n*n),o=Math.sqrt(i*i+r*r),a=s+o,l=s-o,u=Math.atan2(r,i),c=Math.atan2(n,e),h=(c-u)/2,d=(c+u)/2,p=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]],f=[[a,0],[0,l]],m=[[Math.cos(h),Math.sin(h)],[-Math.sin(h),Math.cos(h)]];return p[0][0]*=-1,p[0][1]*=-1,m[0][0]*=-1,m[1][0]*=-1,[p,f,m]}function LM(t,e){return[[t[0][0]*e[0][0]+t[0][1]*e[1][0],t[0][0]*e[0][1]+t[0][1]*e[1][1]],[t[1][0]*e[0][0]+t[1][1]*e[1][0],t[1][0]*e[0][1]+t[1][1]*e[1][1]]]}function mW(t){return[[t[0][0],t[1][0]],[t[0][1],t[1][1]]]}function CDe(t){let[e,i,r]=MDe(t),n=LM(e,mW(r)),s=LM(LM(r,i),mW(r)),o=Math.atan2(n[1][0],n[0][0]),a=[s[0][0],s[1][1]],l=[s[0][1]/s[1][1],s[1][0]/s[0][0]];return{rotation:o,scale:a,shear:l}}function PDe({rotation:t,scale:e,shear:i}){let r=Math.cos(t),n=Math.sin(t),s=[[r,-n],[n,r]],o=[[e[0],i[0]*e[1]],[i[1]*e[0],e[1]]],a=LM(s,o);return[a[0][0],a[1][0],a[0][1],a[1][1]]}var ar;(t=>{function e(){return[1,0,0,0,1,0,0,0,1]}t.identity=e;function i(S,E=t.identity()){for(let M=0,R=S.length;M<R;M++)E[M]=S[M];return E}t.copy=i;function r(S,E,M,R,C,T){return t.setAbcdef(t.identity(),S,E,M,R,C,T)}t.create=r;function n(S,E,M,R,C,T,L){return S[0]=E,S[1]=R,S[2]=T,S[3]=M,S[4]=C,S[5]=L,S}t.setAbcdef=n;function s(S,E){let[M,R,C,T,L,I]=a(S),[D,F,H,z,B,j]=a(E),V=D*M+F*C,q=D*R+F*T,K=H*M+z*C,le=H*R+z*T,Z=B*M+j*C+L,oe=B*R+j*T+I;return t.create(V,q,K,le,Z,oe)}t.append=s;function o(S,E){let[M,R,C,T,L,I]=a(S),[D,F,H,z,B,j]=a(E),V=M,q=R,K=C,le=T;(D!==1||F!==0||H!==0||z!==1)&&(V=M*D+R*H,q=M*F+R*z,K=C*D+T*H,le=C*F+T*z);let Z=L*D+I*H+B,oe=L*F+I*z+j;return t.create(V,q,K,le,Z,oe)}t.prepend=o;function a(S){return[S[0],S[3],S[1],S[4],S[2],S[5]]}t.getAbcdef=a;function l(S){let[E,M,R,C,T,L]=t.getAbcdef(S),I=E*C-M*R,D=C/I,F=-M/I,H=-R/I,z=E/I,B=(R*L-C*T)/I,j=-(E*L-M*T)/I;return t.create(D,F,H,z,B,j)}t.invert=l;function u([S,E],M){let[R,C,T,L,I,D]=t.getAbcdef(M);return[R*S+T*E+I,C*S+L*E+D]}t.apply=u;function c(S,E){let[M,R,C,T,L,I]=t.getAbcdef(E),D=1/(M*T+C*-R),[F,H]=S;return[T*D*F+-C*D*H+(I*C-L*T)*D,M*D*H+-R*D*F+(-I*M+L*R)*D]}t.applyInverse=c;function h(S,E,M=E){let[R,C,T,L,I,D]=t.getAbcdef(S);return t.setAbcdef(S,R*E,C*M,T*E,L*M,I*E,D*M),S}t.scale=h;function d(S,E){let M=Math.cos(E),R=Math.sin(E),[C,T,L,I,D,F]=t.getAbcdef(S);return t.setAbcdef(S,C*M-T*R,C*R+T*M,L*M-I*R,L*R+I*M,D*M-F*R,D*R+F*M),S}t.rotate=d;function p(S,E,M){let[R,C]=M,T=t.translate(S,-R,-C);return T=t.rotate(T,E),T=t.translate(T,R,C),T}t.rotateAround=p;function f(S,E,M){let[R,C,T,L,I,D]=t.getAbcdef(S);return t.setAbcdef(S,R,C,T,L,I+E,D+M),S}t.translate=f;function m(S,E,M){let[R,C,T,L]=t.getAbcdef(S);return t.setAbcdef(S,R,C,T,L,E,M),S}t.setTranslate=m;function g(S,E,M){let[R,C,T,L]=t.getAbcdef(S);return t.setAbcdef(S,R,C,T,L,E,M),S}t.setPosition=g;function y(S){let[E,M,R,C]=t.getAbcdef(S),T=Math.sqrt(E*E+M*M),L=Math.sqrt(R*R+C*C);return[T,L]}t.getScale=y;function v(S){let[,,,,E,M]=t.getAbcdef(S);return[E,M]}t.getPosition=v;function b(S,E){return t.decompose(S,E).rotation}t.getRotation=b;function _(S,E){let[M,R,C,T,L,I]=t.getAbcdef(S),{rotation:D,scale:F,shear:H}=CDe([[M,C],[R,T]]);return{position:[L+(E[0]*M+E[1]*C)-E[0],I+(E[0]*R+E[1]*T)-E[1]],scale:F,rotation:D,shear:H,pivot:E}}t.decompose=_;function A(S,E,M,R,C=[0,0]){let[T,L]=S,[I,D]=R,[F,H,z,B]=PDe({rotation:M,scale:E,shear:C}),j=T-(I*F+D*z)+I,V=L-(I*H+D*B)+D;return t.create(F,H,z,B,j,V)}t.compose=A})(ar||(ar={}));var TDe=Math.PI/180;function RDe(t,e,i,r,n,s){let o=t-i,a=e-r;return o*o/(n*n)+a*a/(s*s)<=1}function kDe(t){return t*TDe}function DDe(t){return{all:t=t||new Map,on:function(e,i){var r=t.get(e);r?r.push(i):t.set(e,[i])},off:function(e,i){var r=t.get(e);r&&(i?r.splice(r.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var r=t.get(e);r&&r.slice().map(function(n){n(i)}),(r=t.get("*"))&&r.slice().map(function(n){n(e,i)})}}}var Cs=class{constructor(t,e,i){this.uuid=t,this.data=e,this.localMatrix=ar.identity(),this.worldMatrix=ar.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new _O,this._recursiveBBox=new _O,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=DDe(),this.dpr=i.dpr??1,this.dataPatched=e}project(t,e){let i=this.worldMatrix;return e&&(i=ar.append(e.worldMatrix,i)),ar.applyInverse(t,i)}intersects(t,e,i,r=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([t,e],i),r)}intersectsInLocalSpace(t,e,i=!1){let{min:r,max:n}=i?this.recursiveBBox:this.singleBBox;return t>=r[0]&&t<=n[0]&&e>=r[1]&&e<=n[1]}applyTransforms(t){t.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=ar.compose(this.position,this.scale,kDe(this.rotation),gm.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(t,e,i){let r=this.parent;e&&r!==null&&r!==void 0&&r.updateWorldMatrix(t,!0,!1),t&&this.updateLocalMatrix(),this.parent?this.worldMatrix=ar.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=ar.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return gm.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{t.resetBBoxNeedsUpdateSelf()})}updateTransformState(t){let e=!1;t.position!==void 0&&(e=!0,this.position=t.position),t.rotation!==void 0&&(e=!0,this.rotation=t.rotation),t.scale!==void 0&&(e=!0,this.scale=t.scale),t.shear!==void 0&&(e=!0,this.shear=t.shear),e&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(t,e,i){t.type===0&&t.props.visible!==void 0&&(this.visible=t.props.visible),this.data=e,this.data=e;let r=t,n=gr(t.path,["states","*"]);if(n!==null){if(t.type===0){let[s]=n;if((this==null?void 0:this.stateSelection)===s){let o={...t.props};if(delete o.name,Object.values(t.props).some(a=>a===void 0)){let a=this.data;if(a!==void 0){let l=zs.zoom(a,t.path.slice(2));if(l)for(let u in t.props)t.props[u]===void 0&&u in l&&(o[u]=l[u])}}r={...t,props:o,path:t.path.slice(2)}}}}else if(t.type===0){let s=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(s!==void 0){if(t.props.name!==void 0&&s.name){let{name:a,...l}=s;s=l}let o=zs.removeOverridden(t.path,t.props,s);r={...t,props:o}}}this.updateByPatchedOpBase(r,$f.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i)}changeSelectedState(t,e,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)$f.toOps(this.data,r.data).forEach(n=>{let s=u2.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(s,this.data,e)});if(t!==null){let r=this.data.states.data(t);r&&(this.dataPatched=$f.patch(this.data,r),$f.toOps(this.data,r).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,e)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=t}}updateState(t,e){t.name!==void 0&&(this.name=t.name),t.visible!==void 0&&(this.visible=t.visible),this.updateTransformState(t)}updateByPatchedOpBase(t,e,i){this.dataPatched=e,this.updateByPatchedOp(t,e,i)}updateByPatchedOp(t,e,i){t.path.length===0&&t.type===0&&this.updateState(t.props,i),this.requestRender()}traverseFrameAncestors(t){this.traverseAncestors(e=>{e.data.type==="frame2d"&&t(e)})}traverseAncestors(t){let e=this.parent;for(;e;)t(e),e=e.parent}requestRender(){this.traverseFrameAncestors(t=>{t.requestRender()})}clone(t){let e=new Cs(this.uuid,this.data,t);return e.parent=void 0,e}addEventListener(t,e){this.emitter.on(t,e)}removeEventListener(t,e){this.emitter.off(t,e)}dispatchEvent(t){this.emitter.emit(t.type,{...t,target:t.target??this})}traverseSortNextHelper(){let t=this.parent;if(t){let e=t.children;if(e){let i=e.indexOf(this)+1;return e[i]?e[i]:t.traverseSortNextHelper()}}}sortNext(){let t=this.children;return t&&t.length>0&&t[0]?t[0]:this.traverseSortNextHelper()}isDescendantOf(t){t instanceof Cs&&(t=t.uuid);let e=this;for(;e.parent;){if(e.parent.uuid===t)return!0;e=e.parent}return!1}},xh=class extends Cs{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this.context=i,this.children=[]}add(t){t.parent&&t.parent instanceof xh&&t.parent.remove(t),this.children.push(t),t.parent=this}remove(t){let e=this.children.indexOf(t);e>=0&&(this.children.splice(e,1),t.parent=void 0)}traverse(t){let e=t(this);if(e!==!0)for(let i of this.children)i instanceof xh?i.traverse(t):e=t(i)}intersectsChildren(t,e,i,r=!1,n=[],s=!1){for(let o of this.children){let a=o instanceof rd;if(o instanceof xh&&!a&&s&&o.intersectsChildren(t,e,i,r,n,!1),o.intersects(t,e,i,a)&&(n.push(o),r))break}return n}updateWorldMatrix(t,e,i){if(super.updateWorldMatrix(t,e,i),i&&this.children)for(let r of this.children)r.updateWorldMatrix(t,!1,!0)}find(t){let e;return this.traverse(i=>{i.uuid===t&&(e=i)}),e}innerDrawChildren(t){for(let e=this.children.length-1;e>=0;e--)this.children[e].draw(t)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(t=>{t.resetBBoxNeedsUpdateSelf()})}clone(t){let e=new xh(this.uuid,this.data,t);e.parent=void 0;for(let i of this.children)e.add(i.clone(t));return e}},rd=class extends xh{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this.updateState(e,i)}draw(t){!this.visible||(t.save(),this.applyTransforms(t),this.innerDrawChildren(t),t.restore())}clone(t){let e=new rd(this.uuid,this.data,t);e.parent=void 0;for(let i of this.children)e.add(i.clone(t));return e}};function IDe(t,e){let[[i,r],[n,s]]=t,[[o,a],[l,u]]=e,c=(i-n)*(a-u)-(r-s)*(o-l);if(c===0)return!1;let h=((i-o)*(a-u)-(r-a)*(o-l))/c,d=-((i-n)*(r-a)-(r-s)*(i-o))/c;return h>=0&&h<=1&&d>=0&&d<=1}var ite=[[-1,1],[-1,-1],[1,-1],[1,1]],gW=(t,e,i)=>{let r=t.getCenter(),n=t.getHalfSize(),s=ar.append(e,t.worldMatrix);n[0]===0&&n[1]===0?i.push(ar.apply(r,s)):ite.forEach(o=>{let a=[o[0]*n[0]+r[0],o[1]*n[1]+r[1]];i.push(ar.apply(a,s))})},_O=class{constructor(){this.matrix=ar.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(t,e=!1){t.updateWorldMatrix(),this.makeEmpty(),ar.copy(t.worldMatrix,this.matrix);let i=ar.invert(t.worldMatrix);this.expandByObjectSize(t,i,e)}expandByObjectSize(t,e,i=!1){let r=[];i===!0&&t instanceof xh?t.traverse(n=>{n.visible&&gW(n,e,r)}):gW(t,e,r),this.setFromPoints(r)}getCenter(){let[t,e]=this.min,[i,r]=this.getHalfSize();return ar.apply([t+i,e+r],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(t){this.makeEmpty();for(let e of t)this.expandByPoint(e)}expandByPoint(t){this.min=[Math.min(this.min[0],t[0]),Math.min(this.min[1],t[1])],this.max=[Math.max(this.max[0],t[0]),Math.max(this.max[1],t[1])]}computeVertices(){let[t,e]=this.getHalfSize(),i=this.getCenter(),[r,n,s,o]=ar.getAbcdef(this.matrix),a=ar.create(r,n,s,o,i[0],i[1]);this.vertices=ite.map(([l,u])=>ar.apply([l*t,u*e],a))}computeEdges(){this.edges=[];for(let t=0,e=this.vertices.length;t<e;++t)this.edges.push([this.vertices[t],this.vertices[(t+1)%e]])}project(t,e){let i=this.matrix;return e&&(i=ar.append(e.worldMatrix,i)),ar.applyInverse(t,i)}intersects(t,e,i){return this.intersectsInLocalSpace(...this.project([t,e],i))}intersectsInLocalSpace(t,e){let{min:i,max:r}=this;return t>=i[0]&&t<=r[0]&&e>=i[1]&&e<=r[1]}containsPoint(t){let[e,i]=t,[r,n]=this.min,[s,o]=this.max;return e>=r&&e<=s&&i>=n&&i<=o}intersectsBBox2D(t){for(let e=0,i=this.edges.length;e<i;e++){let r=this.edges[e];for(let n=0,s=t.edges.length;n<s;n++){let o=t.edges[n];if(IDe(r,o))return!0}}for(let e=0,i=t.vertices.length;e<i;e++){let r=t.vertices[e];if(this.containsPoint(r))return!0}return!1}ensureMinMax(){let t=this.min,e=this.max;this.min=[Math.min(t[0],e[0]),Math.min(t[1],e[1])],this.max=[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}copy(t){this.min=[...t.min],this.max=[...t.max],ar.copy(t.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let t=new _O;return t.copy(this),t}},rte,LDe=new Promise(t=>{rte=t}),yW=!1,ZA;function BDe(){if(yW)return;if(ZA)return ZA;async function t(){let e=await L0(()=>import("./ui-dad2f740.js"),[]);rte(e.default??e),yW=!0}return ZA=t(),ZA}function vW(t){let e=!1;return t.scene.objects.traverse((i,r)=>{(r.type==="Mesh"&&r.geometry.type==="UIGeometry"||r.type==="Page"&&r.uiFrame!==void 0)&&(e=!0)}),e}var ai,h3;async function ODe(t){let e=await LDe;ai||(h3||(h3=e({locateFile:()=>t})),ai=await h3)}var bW=ar.identity(),xW=class{constructor(t,e=1){this.canvas=t,this.dpr=e,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=hr.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=hr.transparent,this._fonts=new Map;try{let i=t.getBoundingClientRect();t.width=i.width*e,t.height=i.height*e}catch{console.log(t.width,e)}this._currentM3Transform=bW,this._currentTransform=new Float32Array(bW)}async init(){var t,e;if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await ODe(this.wasmURL),this._surface=ai.MakeWebGLCanvasSurface(this.canvas),this.ctx=(t=this._surface)==null?void 0:t.getCanvas(),this._paint=new ai.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(ai.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(ai.PaintStyle.Stroke),(e=this.ctx)==null||e.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(t){this._currentM3Transform=t,this._currentTransform.set(t)}async loadFont(t,e){let i=await(await fetch(t)).arrayBuffer();this.registerFont(i,e)}registerFont(t,e){if(this._fonts.has(e))return;let i=ai.FontMgr.FromData(t);if(i)this._fonts.set(e,i);else throw new Error("Invalid font data for "+e)}get width(){return this._width}get height(){return this._height}set strokeColor(t){this._paintStroke&&this._paintStroke.setColor($A(t),ai.ColorSpace.DISPLAY_P3)}set fillColor(t){this._paintFill&&this._paintFill.setColor($A(t),ai.ColorSpace.DISPLAY_P3)}set lineWidth(t){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?t:t*2)}set strokeMode(t){this._strokeMode=t}set dropShadowBlur(t){this._dropShadowBlur=t}set dropShadowColor(t){this._dropShadowColor=t}set dropShadowOffsetX(t){this._dropShadowOffsetX=t}set dropShadowOffsetY(t){this._dropShadowOffsetY=t}set innerShadowBlur(t){this._innerShadowBlur=t}set innerShadowColor(t){this._innerShadowColor=t}set innerShadowOffsetX(t){this._innerShadowOffsetX=t}set innerShadowOffsetY(t){this._innerShadowOffsetY=t}set innerShadowSpread(t){this._innerShadowSpread=t}set layerBlur(t){this._layerBlur=t}set backgroundBlur(t){this._backgroundBlur=t}clear(){var t;(t=this.ctx)==null||t.clear(ai.TRANSPARENT)}save(){var t;(t=this.ctx)==null||t.save()}restore(){var t;(t=this.ctx)==null||t.restore()}beginPath(){var t;(t=this._currentPath)==null||t.delete(),this._currentPath=new ai.Path}closePath(){let t=this._currentPath;if(t){if(t.isEmpty())return;let e=t.getBounds();(e[3]-e[1]||e[2]-e[0])&&t.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(t,e,i,r,n=0,s=0,o=0,a=0){var u,c;let l=ai.XYWHRect(t,e,i,r);if(n===0&&s===0&&a===0&&o===0)(u=this.ctx)==null||u.clipRect(l,ai.ClipOp.Intersect,!0);else{let h=ai.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=o,h[10]=h[11]=a,(c=this.ctx)==null||c.clipRRect(h,ai.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let t=ar.invert(this.currentTransform);this.ctx.concat(t);let e=ar.translate(ar.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(e),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(t,e,i=!0){var r,n,s,o;if(this.ctx&&this._currentPath){let a,l=!1;if(i&&this._hasDropShadow()){let u=t.copy();u.setColor($A(this._dropShadowColor));let c;this._dropShadowBlur>0&&(c=ai.MaskFilter.MakeBlur(ai.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(((r=this.camera)==null?void 0:r.scale)??1),!1),u.setMaskFilter(c)),this.ctx.save(),this.ctx.clipPath(this._currentPath,ai.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),e(u),this.ctx.restore(),u.delete(),c==null||c.delete()}if(this._backgroundBlur>0&&i){this.ctx.save(),this.ctx.clipPath(this._currentPath,ai.ClipOp.Intersect,!0);let u=ai.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,ai.TileMode.Clamp,null),c=t.copy();c.setImageFilter(u),c.setAlphaf(1);let h=this._currentPath.computeTightBounds();this.ctx.saveLayer(c,h,null,ai.SaveLayerInitWithPrevious),this.ctx.drawColor(t.getColor()),this.ctx.restore(),this.ctx.restore(),c.delete(),u.delete(),l=!0}if(this._layerBlur>0){let u=t.copy();a=ai.MaskFilter.MakeBlur(ai.BlurStyle.Normal,this._layerBlur*this.dpr*(((n=this.camera)==null?void 0:n.scale)??1),!1),u.setMaskFilter(a),e(u),u.delete(),a.delete(),l=!0}if(l||e(t),i&&this._hasInnerShadow()){let u=new ai.Paint;u.setAntiAlias(!0),u.setStyle(ai.PaintStyle.Fill),u.setColor($A(this._innerShadowColor));let c;this._innerShadowBlur>0&&(c=ai.MaskFilter.MakeBlur(ai.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(((s=this.camera)==null?void 0:s.scale)??1),!1),u.setMaskFilter(c));let h=this._currentPath.computeTightBounds(),[d,p,f,m]=h,g=f-d,y=m-p;this.ctx.save(),this.ctx.clipPath(this._currentPath,ai.ClipOp.Intersect,!0),this.ctx.saveLayer(u,h,null,ai.SaveLayerInitWithPrevious),(o=this.ctx)==null||o.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(ai.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+g+Math.abs(this._innerShadowOffsetX*2),2e3+y+Math.abs(this._innerShadowOffsetY*2)),u),u.setBlendMode(ai.BlendMode.Clear),this.ctx.drawPath(this._currentPath,u),this.ctx.restore(),this.ctx.restore(),u.delete(),c==null||c.delete()}}}_paintInner(t,e=!0){if(this.ctx&&this._currentPath&&t){let i=this.ctx,r=this._currentPath;this._applyEffectsToPaint(t,n=>{let s=!1;!e&&this._strokeMode!=="center"&&(i.save(),i.clipPath(r,this._strokeMode==="outside"?ai.ClipOp.Difference:ai.ClipOp.Intersect,!0),s=!0),i.drawPath(r,n),s&&i.restore()},e)}}_hasDropShadow(){var t;return((t=this._dropShadowColor)==null?void 0:t.a)>0}_hasInnerShadow(){var t;return((t=this._innerShadowColor)==null?void 0:t.a)>0}path(t){var e;(e=this._currentPath)==null||e.addPath(ai.Path.MakeFromSVGString(t))}ellipse(t,e,i,r,n,s,o,a){var u;if(!wW([t,e,i,r])||!this._currentPath)return;if(i<0||r<0)throw Error("radii cannot be negative");let l=ai.XYWHRect(t-i,e-r,i*2,r*2);(u=this._currentPath)==null||u.addOval(l)}rect(t,e,i,r,n=0,s=0,o=0,a=0){var u,c;let l=ai.XYWHRect(t,e,i,r);if(wW(l))if(n===0&&s===0&&a===0&&o===0)(u=this._currentPath)==null||u.addRect(l);else{let h=ai.RRectXY(l,n,n);h[4]=h[5]=n,h[6]=h[7]=s,h[8]=h[9]=o,h[10]=h[11]=a,(c=this._currentPath)==null||c.addRRect(h)}}getHorizontalAlign(t){switch(t){case 2:return ai.TextAlign.Right;case 3:return ai.TextAlign.Center;case 4:return ai.TextAlign.Justify;case 1:default:return ai.TextAlign.Left}}drawTextInner(t,e,i,[r,n,s,o],a,l,u=!0){let c=0,{ctx:h}=this;if(!h)return c;let d=l.copy(),p=l.copy();return p.setAlphaf(0),this._applyEffectsToPaint(d,f=>{e.pushPaintStyle(i,f,p),e.addText(t);let m=e.build();m.layout(s);let g=n;a===2?g+=(o-m.getHeight())/2:a===3&&(g+=o-m.getHeight()),h.drawParagraph(m,r,g),c=m.getHeight(),e.reset(),m.delete()},u),d.delete(),p.delete(),c}drawText(t,e){let i=0,r=this._fonts.get(e.font),{ctx:n,_paintFill:s,_paintStroke:o}=this;if(r&&n){let a=new ai.TextStyle({fontFamilies:[e.font],fontSize:e.fontSize,heightMultiplier:e.lineHeight,letterSpacing:e.letterSpacing}),l=new ai.ParagraphStyle({textStyle:a,textAlign:this.getHorizontalAlign(e.horizontalAlign)}),u=ai.XYWHRect(e.x,e.y,e.width,e.height),c=ai.ParagraphBuilder.Make(l,r);s&&(i=this.drawTextInner(t,c,a,u,e.verticalAlign,s,!0)),o&&(i=this.drawTextInner(t,c,a,u,e.verticalAlign,o,!1)),c.delete()}return{height:i}}render(){var t;(t=this._surface)==null||t.flush()}moveTo(t,e){var i;(i=this._currentPath)==null||i.moveTo(t,e)}lineTo(t,e){var i;(i=this._currentPath)==null||i.lineTo(t,e)}bezierCurveTo(t,e,i,r,n,s){var o;(o=this._currentPath)==null||o.cubicTo(t,e,i,r,n,s)}quadraticCurveTo(t,e,i,r){var n;(n=this._currentPath)==null||n.quadTo(t,e,i,r)}setTransform(t,e=!1){var n,s,o,a,l;if(!this.ctx)return;let i=this.ctx.getTotalMatrix(),r=ar.invert(i);if(r&&this.ctx.concat(r),(n=this.ctx)==null||n.scale(this.dpr,this.dpr),((s=this.camera)==null?void 0:s.enabled)&&((o=this.ctx)==null||o.concat(this.camera.worldMatrix),e)){let u=ar.getScale(this.camera.worldMatrix);(a=this.ctx)==null||a.scale(1/u[0],1/u[1])}(l=this.ctx)==null||l.concat(t),this.currentTransform=t}transform(t){var e;(e=this.ctx)==null||e.concat(t)}setSize(t,e){var i;t===this._width&&e===this._height||(this._width=t,this._height=e,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.canvas.width=t*this.dpr,this.canvas.height=e*this.dpr,this._surface&&(this._surface=ai.MakeWebGLCanvasSurface(this.canvas),this.ctx=(i=this._surface)==null?void 0:i.getCanvas()))}};function wW(t){for(let e=0;e<t.length;e++)if(t[e]!==void 0&&!Number.isFinite(t[e]))return!1;return!0}function $A({r:t,g:e,b:i,a:r}){return ai.Color4f(t,e,i,r)}var _W=class{constructor(t,e,i){this.uuid=t,this.data=e,this.enabled=!1,this.color=hr.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(e)}update(t){t.color!==void 0&&(this.color=t.color),t.enabled!==void 0&&(this.enabled=t.enabled),t.blurRadius!==void 0&&(this.blurRadius=t.blurRadius),t.offset!==void 0&&(this.offset=t.offset),t.spread!==void 0&&(this.spread=t.spread)}},SW=class{constructor(t,e,i){this.uuid=t,this.data=e,this.enabled=!1,this.radius=0,this.update(e)}update(t){t.enabled!==void 0&&(this.enabled=t.enabled),t.radius!==void 0&&(this.radius=t.radius)}},UDe=class{constructor(t,e,i){this.uuid=t,this.data=e,this.enabled=!1,this.color=hr.transparent,this.update(e)}update(t){t.enabled!==void 0&&(this.enabled=t.enabled),t.color!==void 0&&(this.color=t.color)}},NDe=class{constructor(t,e,i){this.uuid=t,this.data=e,this.enabled=!1,this.color=hr.transparent,this.thickness=0,this.mode="inside",this.update(e)}update(t){t.enabled!==void 0&&(this.enabled=t.enabled),t.color!==void 0&&(this.color=t.color),t.thickness!==void 0&&(this.thickness=t.thickness),t.mode!==void 0&&(this.mode=t.mode)}},ws=class extends Cs{constructor(e,i,r){super(e,i,r),this.uuid=e,this.data=i,this.autoClose=!0,this.fill=new UDe(e+"-fill",i.fill,r),this.stroke=new NDe(e+"-stroke",i.stroke,r),this.dropShadow=new _W(e+"-dropShadow",i.dropShadow,r),this.innerShadow=new _W(e+"-innerShadow",i.innerShadow,r),this.backgroundBlur=new SW(e+"-backgroundBlur",i.backgroundBlur,r),this.layerBlur=new SW(e+"-layerBlur",i.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:hr.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:hr.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=hr.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=hr.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,i,r){super.updateByPatchedOp(e,i,r),e.type===0&&(gr(e.path,["fill"])?this.fill.update(e.props):gr(e.path,["stroke"])?this.stroke.update(e.props):gr(e.path,["dropShadow"])?this.dropShadow.update(e.props):gr(e.path,["innerShadow"])?this.innerShadow.update(e.props):gr(e.path,["layerBlur"])?this.layerBlur.update(e.props):gr(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,i){super.updateState(e,i),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let i=new ws(this.uuid,this.data,e);return i.parent=void 0,i}},Lz=class extends ws{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this.width=0,this.height=0,this.updateState(e,i)}innerDraw(t){t.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(t,e){return RDe(t,e,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(t){let e=!1;t.width!==void 0&&(this.width=typeof t.width=="number"?t.width:this.width,e=!0),t.height!==void 0&&(this.height=typeof t.height=="number"?t.height:this.height,e=!0),e&&this.updateWorldMatrix(!0,!1,!0)}updateState(t,e){super.updateState(t,e),this.updateSizeState(t)}clone(t){let e=new Lz(this.uuid,this.data,t);return e.parent=void 0,e}},s_=class extends ws{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(e,i)}innerDraw(t){t.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(t){t.cornerRadius!==void 0&&(this.cornerRadius=t.cornerRadius)}updateSizeState(t){let e=!1;t.width!==void 0&&(this.width=typeof t.width=="number"?t.width:this.width,e=!0),t.height!==void 0&&(this.height=typeof t.height=="number"?t.height:this.height,e=!0),e&&this.updateWorldMatrix(!0,!1,!0)}updateState(t,e){super.updateState(t,e),this.updateSizeState(t),this.updateCornerState(t)}clone(t){let e=new s_(this.uuid,this.data,t);return e.parent=void 0,e}},Bz=class extends ws{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(e,i)}get textHeight(){return this._textHeight}applyFillStroke(t){t.fillColor=this.fill.enabled?this.fill.color:hr.transparent,t.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:hr.transparent,t.strokeMode="center",t.lineWidth=this.stroke.thickness}innerDraw(t){var s;(s=this._fontHolder)!=null&&s.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&t.registerFont(this._fontHolder.arrayBuffer,this.data.font);let e=this.data.textTransform,i=this.data.text.textValue.toString(),r=e===2?i.toUpperCase():e===3?i.toLowerCase():i,{height:n}=t.drawText(r,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(t){let e=!1;t.width!==void 0&&(this.width=typeof t.width=="number"?t.width:this.width,e=!0),t.height!==void 0&&(this.height=typeof t.height=="number"?t.height:this.height,e=!0),e&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(t,{shared:e}){t.font!==void 0&&(this._fontHolder=e.getFont(t.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(t,e){super.updateState(t,e),this.updateSizeState(t),this.updateFontState(t,e)}clone(t){let e=new Bz(this.uuid,this.data,t);return e.parent=void 0,e}},nte=class extends ws{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(e,i)}computeExtremas(){this.curves.length===0&&this.computeCurves();let t=this.curves.map(r=>O2.extremas(r)),e=[1/0,1/0],i=[-1/0,-1/0];for(let r=0,n=t.length;r<n;r++){let s=t[r];s[0][0]<e[0]&&(e[0]=s[0][0]),s[0][1]<e[1]&&(e[1]=s[0][1]),s[1][0]>i[0]&&(i[0]=s[1][0]),s[1][1]>i[1]&&(i[1]=s[1][1])}return this.extremasBBox.min=[e[0],e[1]],this.extremasBBox.max=[i[0],i[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let i=1,r=this.data.points.length;i<r;i++){let n=this.data.points[i].data,s=this.data.points[i-1].data,o={start:s.position,cp1:s.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(o)}let t=this.data.points[0].data,e=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let i={start:e.position,cp1:e.controlNext.position,cp2:t.controlPrevious.position,end:t.position};this.curves.push(i)}}getCenter(){let[t,e]=this.extremasBBox.min,[i,r]=this.getHalfSize();return[t+i,e+r]}getHalfSize(){let{min:t,max:e}=this.extremasBBox;return[(e[0]-t[0])*.5,(e[1]-t[1])*.5]}innerDraw(t){for(let r=0,n=this.data.points.length;r<n;r++){let s=this.data.points[r].data;if(r===0){let[o,a]=s.position;t.moveTo(o,a)}else{let o=this.data.points[r-1].data,[a,l]=o.controlNext.position,[u,c]=s.controlPrevious.position,[h,d]=s.position,p={start:o.position,cp1:o.controlNext.position,cp2:s.controlPrevious.position,end:s.position};O2.derive(p),t.bezierCurveTo(a,l,u,c,h,d)}}let e=this.data.points[0].data,i=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[r,n]=i.controlNext.position,[s,o]=e.controlPrevious.position,[a,l]=e.position;t.bezierCurveTo(r,n,s,o,a,l)}}updateState(t,e){super.updateState(t,e),this.computeExtremas()}clone(t){let e=new nte(this.uuid,this.data,t);return e.parent=void 0,e}},O2;(t=>{function e(o){let a=o.start,l=o.cp1,u=o.cp2,c=o.end,h=[3*(l[0]-a[0]),3*(l[1]-a[1])],d=[3*(u[0]-l[0]),3*(u[1]-l[1])],p=[3*(c[0]-u[0]),3*(c[1]-u[1])],f={start:h,cp:d,end:p};return o.derivative=f,f.derivative=SO.derive(f),f}t.derive=e;function i(o,a,l,u=!1){let c=o-2*a+l;if(c!==0){let h=-Math.sqrt(Math.abs(a*a-o*l)),d=-o+a,p=-(h+d)/c,f=-(-h+d)/c;return[p,f]}else if(a!==l&&c===0)return[(2*a-l)/(2*(a-l))];return[]}function r(o){let a=o.derivative??t.derive(o),l=a.start,u=a.cp,c=a.end;return[i(l[0],u[0],c[0]),i(l[1],u[1],c[1])]}t.droot=r;function n(o){let[a,l]=t.droot(o),u=[o.start[0],o.end[0]],c=[o.start[1],o.end[1]];for(let h of a)u.push(t.compute(o,Math.min(1,Math.max(0,h)))[0]);for(let h of l)c.push(t.compute(o,Math.min(1,Math.max(0,h)))[1]);return u.sort((h,d)=>h-d),c.sort((h,d)=>h-d),[[u[0],c[0]],[u[u.length-1],c[c.length-1]]]}t.extremas=n;function s(o,a){if(a===0)return[...o.start];if(a===1)return[...o.end];let l=1-a,u=l*l,c=a*a,h=u*l,d=u*a*3,p=l*c*3,f=a*c;return[h*o.start[0]+d*o.cp1[0]+p*o.cp2[0]+f*o.end[0],h*o.start[1]+d*o.cp1[1]+p*o.cp2[1]+f*o.end[1]]}t.compute=s})(O2||(O2={}));var SO;(t=>{function e(n){let s=n.start,o=n.cp,a=n.end,l=[2*(o[0]-s[0]),2*(o[1]-s[1])],u=[2*(a[0]-o[0]),2*(a[1]-o[1])],c={start:l,end:u};return c.derivative=AO.derive(c),n.derivative=c,c}t.derive=e;function i(n){let s=n.derivative??t.derive(n),o=s.start,a=s.end;return[o[0]!==a[0]?o[0]/(o[0]-a[0]):0,o[1]!==a[1]?o[1]/(o[1]-a[1]):0]}t.droot=i;function r(n,s){if(s===0)return[...n.start];if(s===1)return[...n.end];let o=1-s,a=o*o,l=s*s,u=a,c=o*s*2,h=l;return[u*n.start[0]+c*n.cp[0]+h*n.end[0],u*n.start[1]+c*n.cp[1]+h*n.end[1]]}t.compute=r})(SO||(SO={}));var AO;(t=>{function e(r){let n=r.start,s=r.end,o=[s[0]-n[0],s[1]-n[1]];return r.derivative=o,r.derivative}t.derive=e;function i(r,n){if(n===0)return[...r.start];if(n===1)return[...r.end];let s=r.start,o=r.end;return[s[0]+(o[0]-s[0])*n,s[1]+(o[1]-s[1])*n]}t.compute=i})(AO||(AO={}));var Ph=class extends xh{constructor(t,e,i){super(t,e,i),this.uuid=t,this.width=0,this.height=0,this.clipped=!0,this.background=new s_(t+"-background",s1.defaultData,i),this.background.parent=this,this.updateState(e,i)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(t){this.background.cornerRadius=t}updateLocalMatrix(){var t;super.updateLocalMatrix(),(t=this.background)==null||t.updateLocalMatrix()}updateWorldMatrix(t,e,i){var r;super.updateWorldMatrix(t,e,i),(r=this.background)==null||r.updateWorldMatrix(t,e,i)}draw(t){if(!this.visible)return;t.save();let e=this.width,i=this.height;this.applyTransforms(t),this.background.width=e,this.background.height=i,this.background.draw(t),this.clipped&&t.clipRect(0,0,e,i,...this.cornerRadius),this.innerDrawChildren(t),t.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(t){t.cornerRadius!==void 0&&(this.cornerRadius=t.cornerRadius)}updateSizeState(t){let e=!1;t.width!==void 0&&(this.width=typeof t.width=="number"?t.width:this.width,e=!0),t.height!==void 0&&(this.height=typeof t.height=="number"?t.height:this.height,e=!0),e&&this.updateWorldMatrix(!0,!1,!0)}updateState(t,e){super.updateState(t,e),this.updateSizeState(t),this.updateCornerState(t),t.fill!==void 0&&this.fill.update(t.fill),t.stroke!==void 0&&this.stroke.update(t.stroke),t.dropShadow!==void 0&&this.dropShadow.update(t.dropShadow),t.innerShadow!==void 0&&this.innerShadow.update(t.innerShadow),t.layerBlur!==void 0&&this.layerBlur.update(t.layerBlur),t.backgroundBlur!==void 0&&this.backgroundBlur.update(t.backgroundBlur),t.clipped!==void 0&&(this.clipped=t.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),t.type===0&&(gr(t.path,["fill"])?this.fill.update(t.props):gr(t.path,["stroke"])?this.stroke.update(t.props):gr(t.path,["dropShadow"])?this.dropShadow.update(t.props):gr(t.path,["innerShadow"])?this.innerShadow.update(t.props):gr(t.path,["layerBlur"])?this.layerBlur.update(t.props):gr(t.path,["backgroundBlur"])?this.backgroundBlur.update(t.props):this.resetBBoxNeedsUpdate())}clone(t){let e=new Ph(this.uuid,this.data,t);e.parent=void 0;for(let i of this.children)e.add(i.clone(t));return e}},FDe=qn(cQ(),1),qP=class extends ws{constructor(t,e,i){super(t,e,i),this.uuid=t,this.data=e,this._pathBBox=new DOMRect,this.path="",this.updateState(e,i),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(t),e.setAttribute("d",this.path),t.appendChild(e),this._pathBBox=e.getBBox(),t.remove()}innerDraw(t){t.path(this.path)}intersectsInLocalSpace(t,e){return t>=this._pathBBox.x&&t<=this._pathBBox.x+this._pathBBox.width&&e>=this._pathBBox.y&&e<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(t,e){super.updateState(t,e),t.path!==void 0&&(this.path=t.path,this.computeSVGBBox())}clone(t){let e=new qP(this.uuid,this.data,t);return e.parent=void 0,e}};function zDe(t,e=1,i=1){if(e<=0||i<=0)return t;let r=(0,FDe.parseSVG)(t).map(n=>{let s={...n};return"x"in s&&(s.x=s.x*e),"y"in s&&(s.y=s.y*i),"x1"in s&&(s.x1=s.x1*e),"x2"in s&&(s.x2=s.x2*e),"y1"in s&&(s.y1=s.y1*i),"y2"in s&&(s.y2=s.y2*i),"rx"in s&&(s.rx=s.rx*e),"ry"in s&&(s.ry=s.ry*i),s});return HDe(r)}function HDe(t){let e=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],i;return t.map(r=>{let n=[];e.forEach(o=>{if(o in r){let a=r[o]*1;n.length&&a>=0&&n.push(","),n.push(a)}});let s=(i===r.code?n[0]<0?"":",":r.code)+n.join("");return i=r.code,s}).join("")}function GDe(t,e,i){switch(e.type){case"ellipse2d":return new Lz(t,e,i);case"rectangle2d":return new s_(t,e,i);case"text2d":return new Bz(t,e,i);case"vector2d":return new nte(t,e,i);case"path2d":return new qP(t,e,i);case"frame2d":return new Ph(t,e,i);case"group2d":default:return new rd(t,e,i)}}var ste=class{constructor(t,e,i){this.uuid=t,this.data=e,this.group=new rd(ste.GROUP_ID,{...T2.defaultData},i),this.createChildrenObjects(e.objects,this.group,i)}createObject(t,e,i,r,n,s){let o=GDe(t,e,s);o&&(r.add(o),r.children.splice(n,0,r.children.pop()),o.updateWorldMatrix(),i.length>0&&(o instanceof rd||o instanceof Ph)&&this.createChildrenObjects(i,o,s))}createChildrenObjects(t,e,i){let r=0;for(let n of t)this.createObject(n.id,n.data,n.children,e,r,i),r+=1}draw(t){this.group.draw(t)}updateEntityByOp(t,e,i,r){let n=this.find(t);if(n)try{n.updateByOp(e,i,{shared:r})}catch(s){console.error(s)}}updateTreeByOp(t,e){if(t.path.length===0&&t.type===7){let i=t.parent===null?this.group:this.find(t.parent);i!==void 0&&i instanceof xh&&(this.createObject(t.id,t.data,t.children,i,t.localIndex,e),i.requestRender())}else if(t.path.length===0&&t.type===8){let i=this.find(t.id);if(i!==void 0&&i.parent!==void 0&&i.parent instanceof xh){let r=i.parent;i.resetBBoxNeedsUpdate(),r==null||r.remove(i),r==null||r.requestRender()}}else if(t.path.length===0&&t.type===9){let i=this.find(t.id);if(i!==void 0){let r=i.parent,n=t.parent===null?this:this.find(t.parent);if(n instanceof xh||n===this){n.add(i);let s=t.localIndex;n.children.splice(s,0,n.children.pop()),i.updateWorldMatrix(!0,!1,!0),r==null||r.requestRender(),i.requestRender()}i.resetBBoxNeedsUpdate()}}}add(t){this.group.add(t)}remove(t){this.group.remove(t)}traverse(t){this.group.traverse(e=>{e!==this.group&&t(e)})}intersectsChildren(t,e,i,r=!1,n=[]){return this.group.intersectsChildren(t,e,i,r,n,!0)}find(t){return this.group.find(t)}get children(){return this.group.children}project(t,e){return this.group.project(t,e)}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let i=[],r=e;for(;r!==this.group;){let n=r;r=r.parent;let s=r.children.indexOf(n);i.splice(0,0,s)}return{entity:e,sortKey:i}}getAllSorted(t){let e=[];for(let i of t){let r=this.getWithSortKey(i.id);r!==void 0&&e.push(r)}return e.sort((i,r)=>GZ(i.sortKey,r.sortKey)),e.map(i=>i.entity)}},Oz=ste;Oz.GROUP_ID="scene2d";function ote({constraints:t,newParentWidth:e,newParentHeight:i,initialParentWidth:r,initialParentHeight:n,objectInitialWidth:s,objectInitialHeight:o,objectInitialPosition:a}){let{horizontalConstraint:l,verticalConstraint:u}=t,c=e-r,h=i-n,d=s,p=o,f=a[0],m=a[1];if(l!==0){if(l===1)f+=c;else if(l===3)f+=c/2;else if(l===2)d=Math.max(1,d+c);else if(l===4){let g=e/r;d*=g,f*=g}}if(u!==0){if(u===1)m+=h;else if(u===3)m+=h/2;else if(u===2)p=Math.max(1,p+h);else if(u===4){let g=i/n;p*=g,m*=g}}return{width:d,height:p,position:[f,m]}}qn(cQ(),1);var VDe=ar.identity(),ate=class{constructor(t,e,i,r){this.uuid=t,this.width=e,this.height=i,this.context=r,this.enabled=!0,this.isScreenSpace=!1,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this.onFrameOverrideObjectEvent=n=>{var s,o;if(((s=n.target)==null?void 0:s.uuid)!==void 0){let a=(o=this.frameRoot)==null?void 0:o.find(n.target.uuid);a&&a.dispatchEvent({...n,target:a})}},this.scene2d=new Oz(kt.generateUUID(),KB.defaultData,{dpr:window.devicePixelRatio,shared:r.shared}),this.canvas=document.createElement("canvas"),this.renderer=new xW(this.canvas),r.shared.addCanvas(this.uuid,this.canvas),this.textureHolder=r.shared.canvas(this.uuid),this.promise=this.init()}async init(){this.renderer instanceof xW&&(this.renderer.wasmURL=Dee.skiaWasmUrl),await this.renderer.init()}render(){var t,e;this.isFrameDirty&&(this.renderer.clear(),(t=this.frameOverride)==null||t.draw(this.renderer),this.renderer.render(),(e=this.textureHolder)==null||e.setNeedsUpdate(!0),this.isFrameDirty=!1)}updateEntity2DByOp(t,e,i,r){this.scene2d.updateEntityByOp(t,e,i,r),this.applySize()}updateTreeByOp(t,e){this.scene2d.updateTreeByOp(t,e),this.applySize()}applyOverrides(t){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let e=(t==null?void 0:t.width)??this.width,i=(t==null?void 0:t.height)??this.height;this.frameOverride.width=e,this.frameOverride.height=i,this.frameOverride.localMatrix=VDe,this.isScreenSpace&&(this.frameOverride.fill.color=hr.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:e,height:i},lte({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(t){var r,n;let e=(t==null?void 0:t.width)??this.width,i=(t==null?void 0:t.height)??this.height;this.width=e,this.height=i,this.renderer.dpr=this.isScreenSpace?window.devicePixelRatio:Math.floor(2048/Math.max(e,i)),this.renderer.setSize(e,i),(r=this.textureHolder)==null||r.dispose(),this.applyOverrides(t),(n=this.frameOverride)==null||n.requestRender()}applyFrame(t){var i,r,n;let e=this.context.scene.find2D(t);if(!(!e||!(e instanceof Ph)))return this.disposeFrameOverride(),this.frameRoot=e,this.frameOverride=e.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),(i=this.textureHolder)==null||i.dispose(),(r=this.frame)==null||r.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(s=>{s.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(s=>{s.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),(n=this.frame)==null||n.requestRender(),e}get frame(){return this.frameOverride}get frameId(){var t;return(t=this.frame)==null?void 0:t.uuid}find(t){return this.scene2d.find(t)}get texture(){var t;return(t=this.textureHolder)==null?void 0:t.getTexture(1001)}disposeFrameOverride(){var t,e,i;(t=this.frameOverride)==null||t.removeEventListener("render",this.onRenderRequestedDownstream),(e=this.frameOverride)==null||e.traverse(r=>{r.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),(i=this.frameOverride)==null||i.traverse(r=>{r.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function lte({objectOverride:t,objectRoot:e,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s}){if(t instanceof Ph&&e instanceof Ph||t instanceof rd&&e instanceof rd)for(let o=0,a=t.children.length;o<a;o++){let l=t.children[o],u=e.children[o];l&&u&&l.uuid===u.uuid&&WDe({objectOverride:l,objectRoot:u,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s})}}function jDe(t){if(EO(t))return[t.width,t.height];if(t instanceof qP){let[e,i]=t.getHalfSize();return[e*2,i*2]}else if(t instanceof rd){let[e,i]=t.recursiveBBox.getHalfSize();return[e*2,i*2]}return[0,0]}function WDe({objectOverride:t,objectRoot:e,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s}){let[o,a]=jDe(e),{width:l,height:u,position:c}=ote({constraints:t.data,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s,objectInitialWidth:o,objectInitialHeight:a,objectInitialPosition:e.position});if(t.position=c,t.data={...t.data,position:c},t.states)for(let h in t.states)qDe({stateId:h,objectOverride:t,objectRoot:e,newParentWidth:i,newParentHeight:r,initialParentWidth:n,initialParentHeight:s});if(EO(t)||t instanceof rd)EO(t)&&(t.width=l,t.height=u,t.data={...t.data,width:l,height:u}),lte({objectOverride:t,objectRoot:e,newParentWidth:l,newParentHeight:u,initialParentWidth:o,initialParentHeight:a});else if(t instanceof qP){let h=e,d=o!==0?l/o:1,p=a!==0?u/a:1;t.path=zDe(h.path,d,p),t.data={...t.data,path:t.path}}}function qDe({stateId:t,objectOverride:e,objectRoot:i,newParentWidth:r,newParentHeight:n,initialParentWidth:s,initialParentHeight:o}){var u,c;let a=(u=e.states)==null?void 0:u[t],l=(c=i.states)==null?void 0:c[t];if(a&&l){let{width:h,height:d,position:p}=ote({constraints:e.data,newParentWidth:r,newParentHeight:n,initialParentWidth:s,initialParentHeight:o,objectInitialWidth:gm.isResizeable(l)?l.width:0,objectInitialHeight:gm.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(e.states[t],{position:p}),gm.isResizeable(a)&&Object.assign(e.states[t],{width:h,height:d})}}function EO(t){return t instanceof s_||t instanceof Ph||t instanceof Lz||t instanceof Bz}var bs=class extends pz(Wc){constructor(e,i,r){super(),this.data=i,this.bgColor=new Ws(1,1,1,1),this.fog=null,this.backupFog=new OQ(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Xt,this.penumbraSizeArrayCache=null,this.super_Entity(e,i),this.personalCamera=new mo(X0,{...i1.defaultData,...i.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new bve(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),i.uiScene?this.uiScene=new Oz((Array.isArray(e)?e[0]:e)+"-ui",i.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):i.uiFrame&&this.createUICanvas(i.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){var e;return(e=this.uiCanvas)==null?void 0:e.frame}createUICanvas(e,i){this.uiCanvas=new ate(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,i),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{var r,n;(r=this.uiCanvas)==null||r.applyFrame(e),(n=this.uiCanvas)==null||n.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,i){e.color!==void 0&&(this.ambientLight.color=Go(e.color,i)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(i=>{i instanceof Fm&&i.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof J0)if(Array.isArray(e.material))for(let i of e.material)i.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&wDe(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,i){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Go(e.color,i),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,i){e.aoColor!==void 0&&(this.aoColor=Go(e.aoColor,i))}updateByOp(e,i,r,n){let s=this.data.uiFrame;super.updateByOp(e,i,r,n);let o=i;gr(e.path,["fog"])?this.updateFog(o.fog,r.shared):gr(e.path,["ao"])?this.updateAo(o.ao,r.shared):gr(e.path,["ambient"])?this.updateAmbientLight(o.ambient,r.shared):gr(e.path,["shadow"])?this.updateShadow(o.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||s!==o.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,i){e?(this.uiCanvas||this.createUICanvas(e,i),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,i){this.updateState_Entity(e,i),e.backgroundColor!==void 0&&this.setBackgroundColor(Go(e.backgroundColor,i.shared)),e.fog!==void 0&&this.updateFog(e.fog,i.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,i.shared),e.ao!==void 0&&this.updateAo(e.ao,i.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,i){}raycast(e,i){super.raycast(e,i)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,i=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof ete&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize,e+=1),r instanceof tte&&r.visible&&e<5-3&&(this.penumbraSizeArrayCache[3+i]=r.data.penumbraSize,i+=1)})}raycastWithClones(e){let i=[],r=n=>{for(let s of n.children){let o=s.cloner;Ti.is(s)&&(s.visible||o!=null&&o.object.data.visible)&&((fu(s)||mO(s)&&this.scene.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,i),MO(s,e,i,!0)),r(s))}};return r(this),i}updateEntity2DByOp(e,i,r,n){var s;(s=this.uiCanvas)==null||s.updateEntity2DByOp(e,i,r,n)}},XDe=class extends kz(Sve,Zee){constructor(t,e,i){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let r=this.shadow.camera;r.fov=90,r.aspect=1,r.near=100,r.far=2500;let n=new N(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),s=new N(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z),o=new Mn(n,s),a=new $C(o,new Xt(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof $C){let i=this.shadow.camera,r=new N(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),n=new N(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);e.box.set(r,n),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},YDe=class extends po{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?wz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},Uz=class extends po{constructor(t,e,i){super(t,e,i),this._shapeId=null,this._context=i}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var r;let t={...this.data.geometry.extrusion.shape};for(let n in t)typeof t[n]=="string"&&(t[n]=this._context.shared.getVariable(t[n],[this.uuid,"geometry","extrusion","shape",n]));let e;if(t.type==="Custom"){let n=t.shapeId;if(n!==this._shapeId&&this.detachShape(),n){this._shapeId=n;let s=this._context.scene.find(n);s!=null&&s.data&&(s.attachedPaths.add(this),e=(r=s.geometry.userData)==null?void 0:r.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let n;switch(t.type){case"Rectangle":n=xz;break;case"Ellipse":n=bz;break;case"Polygon":n=K$;break;case"Star":n=J$;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=n.create({parameters:t}).userData.shape}let i=this.geometry;e&&i.inputs&&(i.inputs.shapeData=e,i.build(),this.attachedSurfaceCloners.forEach(n=>n.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t,e){return super.updateTransformState(t,e)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let i=this.geometry.getAttribute("position");i!==void 0?wz(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,t,e):super.updateEntityBoxSize(t,e)}},Ov=class extends Q0(Yf,r_){constructor(t,e,i){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,i)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let i=E2.getComponentData({scene:e.scene.data,shared:e.shared.data},t.component);if(i){let r,n;for(let s of dp.rootOverrideProps)t[s]===void 0?(r===void 0&&(r={...t}),r[s]=i.data[s]):(n===void 0&&(n={}),n[s]=t[s],r===void 0&&(r={...t}),r[s]=Cp.apply(i.data[s],t[s]));return this.overrideData=n,r}else return{...js.defaultData,...t,...qc(js.defaultData,dp.rootOverrideProps)}}updateByOp(t,e,i,r){let n;if(this.isInstanceRoot&&!r){if(e=this.transformAssignData(e,i),t.type===0&&t.path.length===0&&this.component)for(let s of dp.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(n===void 0&&(n={...t,props:{...t.props}}),n.props[s]=this.component.data[s]);else if(t.type===0&&t.path.length>0&&dp.rootOverrideProps.includes(t.path[0])){let s=t.path[0];n===void 0&&(n={...t,path:[],props:{[s]:e[s]}})}}super.updateByOp(n??t,e,i,r)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){let i=t.scene.find(e.component)??null,r=!1;if(i!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(Ti.is(s))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),Nz(s),n+=1;else break;this.children.splice(0,n)}r=!0}if(i){let n={};ute(t,[this.uuid],e.overrides,this,i,i,0,r,n);for(let s of this.children)if(Ti.is(s)){let o=s.data;o.type==="Empty"&&o.animations&&s.traverseEntity(a=>{if(a instanceof po&&a.isSkinnedMesh){let l=a.dataPatched;if(l.bones&&l.boneInverses){let u=l.bones.map(d=>t.scene.find(n[d])),c=l.boneInverses.map(d=>new lt().fromArray(d)),h=new PF(u,c);a.bind(h,a.bindMatrix)}}else a.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function Nz(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let i of t.children)Ti.is(i)&&Nz(i)}}function AW(t,e,i,r){return t.component===e&&FZ(t.identity,r)?t.overrideData===i?2:1:0}function ute(t,e,i,r,n,s,o,a,l){if(o>50)return!1;if(r.component!==n){if(r.component){let c=r.component.instances.indexOf(r);c>=0&&r.component.instances.splice(c,1)}n.instances.find(c=>c===r)||n.instances.push(r),r.component=n}n instanceof Ov&&n.isInstanceRoot&&n.expandInstanceChildren(t);let u=0;for(let c of n.children)if(Ti.is(c)){let h=[...e,...typeof c.identity=="string"?[c.identity]:c.identity],d=x2.resolve(i,h,1);d!=null&&!(d instanceof Vn)&&(Object.setPrototypeOf(d,Vn.prototype),console.error("wrong prototype"));let p=null,f;if(!a){let m=r.children[u];if(p=Ti.is(m)?m:null,p!==null){let g=AW(p,c,d,h);f=g>=1?p.stateSelection:void 0,g!==2&&(p=null)}if(p===null&&(p=t.scene.findInstance(h)??null,p!==null)){let g=AW(p,c,d,h);if(f=g>=1?p.stateSelection:void 0,g!==2)p=null;else{let y=p.parent.children.indexOf(p);p.parent.children.splice(y,1),r.children.splice(u,0,p),p.parent===r?y<=u&&console.error("not possible"):(p.parent=r,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),t.pendingDeletes.delete(p))}}}if(p===null){let m=d?Cp.apply(c.data,d):c.data;Om.is(m.type)&&(m={...m,type:"Empty"}),p=fp.createEntity(h,m,t),p.overrideData=d,r.add(p),r.children.splice(r.children.length-1,1),r.children.splice(u,0,p),p.updateState(p.data,t),f&&p.changeSelectedState(f,t),t.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let m=p.identity[p.identity.length-1];l[m]=p.uuid}u+=1,ute(t,e,i,p,c,s,o+1,a,l)}if(!a){let c=u;for(;;){let h=r.children[u];if(Ti.is(h))t.pendingDeletes.add(h);else break;u+=1}r.children.splice(c,u-c)}return!0}var KDe=class extends Q0(UQ,r_){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(t,e){this.updateState_Entity(t,e)}},ho=class extends po{constructor(e,i,r){super(e,i,r),this.onBeforeRender=()=>{this.uiCanvas.render()},this.uiCanvas=new ate(e+"-canvas",i.geometry.width,i.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(e,i,r){super.updateByPatchedOpGeometry(e,i,r),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,r.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,r.shared))}applySize(e,i){let r=(e==null?void 0:e.width)??this.dataPatched.geometry.width,n=(e==null?void 0:e.height)??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:n}),this.applyGeometryParametersFromFrame(i)}applyFrame(e,i){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(i),this.applyMaterialParametersFromFrame({shared:i})}applyGeometryParametersFromFrame(e){var r;let i=this.frame;i&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:i.cornerRadius,cornerType:0})}),(r=this.localGeometry)==null||r.dispose(),this.localGeometry=h1(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let i=this.frame;if(i){let r=i.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,i,r,n){this.uiCanvas.updateEntity2DByOp(e,i,r,n),e===this.frameId&&i.type===0&&(i.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(n):gr(i.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:n}))}get frame(){return this.uiCanvas.frame}get frameId(){var e;return(e=this.frame)==null?void 0:e.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,i){super.updateGeometryInteractions(e,i),this.applySize({width:e.width,height:e.height},i)}},JDe=class{constructor(t,e,i){this.variables=[],this.currentTextureIndex=0;let r=Fn,n=new Wc,s=new Jm;s.position.z=1;let o={passThruTexture:{value:null}},a=c(d(),o),l=new zn(new Qm(2,2),a);n.add(l),this.setDataType=function(p){return r=p,this},this.addVariable=function(p,f,m){let g=this.createShaderMaterial(f),y={name:p,initialValueTexture:m,material:g,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:Zi,magFilter:Zi};return this.variables.push(y),y},this.setVariableDependencies=function(p,f){p.dependencies=f},this.init=function(){if(i.capabilities.isWebGL2===!1&&i.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(i.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let p=0;p<this.variables.length;p++){let f=this.variables[p];f.renderTargets[0]=this.createRenderTarget(t,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),f.renderTargets[1]=this.createRenderTarget(t,e,f.wrapS,f.wrapT,f.minFilter,f.magFilter),this.renderTexture(f.initialValueTexture,f.renderTargets[0]),this.renderTexture(f.initialValueTexture,f.renderTargets[1]);let m=f.material,g=m.uniforms;if(f.dependencies!==null)for(let y=0;y<f.dependencies.length;y++){let v=f.dependencies[y];if(v.name!==f.name){let b=!1;for(let _=0;_<this.variables.length;_++)if(v.name===this.variables[_].name){b=!0;break}if(!b)return"Variable dependency not found. Variable="+f.name+", dependency="+v.name}g[v.name]={value:null},m.fragmentShader=`
uniform sampler2D `+v.name+`;
`+m.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let p=this.currentTextureIndex,f=this.currentTextureIndex===0?1:0;for(let m=0,g=this.variables.length;m<g;m++){let y=this.variables[m];if(y.dependencies!==null){let v=y.material.uniforms;for(let b=0,_=y.dependencies.length;b<_;b++){let A=y.dependencies[b];v[A.name].value=A.renderTargets[p].texture}}this.doRenderTarget(y.material,y.renderTargets[f])}this.currentTextureIndex=f},this.getCurrentRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(p){return p.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let p=this.variables;for(let f=0;f<p.length;f++){let m=p[f];m.initialValueTexture&&m.initialValueTexture.dispose();let g=m.renderTargets;for(let y=0;y<g.length;y++)g[y].dispose()}};function u(p){p.defines.resolution="vec2( "+t.toFixed(1)+", "+e.toFixed(1)+" )"}this.addResolutionDefine=u;function c(p,f){f=f||{};let m=new er({uniforms:f,vertexShader:h(),fragmentShader:p});return u(m),m}this.createShaderMaterial=c,this.createRenderTarget=function(p,f,m,g,y,v){return p=p||t,f=f||e,m=m||kr,g=g||kr,y=y||Zi,v=v||Zi,new $i(p,f,{wrapS:m,wrapT:g,minFilter:y,magFilter:v,format:_s,type:r,depthBuffer:!1})},this.createTexture=function(){let p=new Float32Array(t*e*4),f=new Dl(p,t,e,_s,Fn);return f.needsUpdate=!0,f},this.renderTexture=function(p,f){o.passThruTexture.value=p,this.doRenderTarget(a,f),o.passThruTexture.value=null},this.doRenderTarget=function(p,f){let m=i.getRenderTarget(),g=i.xr.enabled,y=i.shadowMap.autoUpdate,v=i.outputEncoding,b=i.toneMapping;i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.outputEncoding=Mu,i.toneMapping=Mh,l.material=p,i.setRenderTarget(f),i.render(n,s),l.material=a,i.xr.enabled=g,i.shadowMap.autoUpdate=y,i.outputEncoding=v,i.toneMapping=b,i.setRenderTarget(m)};function h(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function d(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},Is=new Fs,eE=new N,QDe=class{constructor(t){let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(t){return this.weightAttribute=t?this.geometry.getAttribute(t):null,this}build(){let t=this.positionAttribute,e=this.weightAttribute,i=new Float32Array(t.count/3);for(let n=0;n<t.count;n+=3){let s=1;e&&(s=e.getX(n)+e.getX(n+1)+e.getX(n+2)),Is.a.fromBufferAttribute(t,n),Is.b.fromBufferAttribute(t,n+1),Is.c.fromBufferAttribute(t,n+2),s*=Is.getArea(),i[n/3]=s}this.distribution=new Float32Array(t.count/3);let r=0;for(let n=0;n<i.length;n++)r+=i[n],this.distribution[n]=r;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e,i){let r=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*r);return this.sampleFace(n,t,e,i)}binarySearch(t){let e=this.distribution,i=0,r=e.length-1,n=-1;for(;i<=r;){let s=Math.ceil((i+r)/2);if(s===0||e[s-1]<=t&&e[s]>t){n=s;break}else t<e[s]?r=s-1:i=s+1}return n}sampleFace(t,e,i,r){let n=this.randomFunction(),s=this.randomFunction();return n+s>1&&(n=1-n,s=1-s),Is.a.fromBufferAttribute(this.positionAttribute,t*3),Is.b.fromBufferAttribute(this.positionAttribute,t*3+1),Is.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(Is.a,n).addScaledVector(Is.b,s).addScaledVector(Is.c,1-(n+s)),i!==void 0&&Is.getNormal(i),r!==void 0&&this.colorAttribute!==void 0&&(Is.a.fromBufferAttribute(this.colorAttribute,t*3),Is.b.fromBufferAttribute(this.colorAttribute,t*3+1),Is.c.fromBufferAttribute(this.colorAttribute,t*3+2),eE.set(0,0,0).addScaledVector(Is.a,n).addScaledVector(Is.b,s).addScaledVector(Is.c,1-(n+s)),r.r=eE.x,r.g=eE.y,r.b=eE.z),this}};function ZDe(t){let e=new Float32Array(t*t*2);for(let i=0;i<t;i++)for(let r=0;r<t;r++){let n=i*t+r;e[n*2+0]=i/(t-1),e[n*2+1]=r/(t-1)}return e}function $De(t){let e=Math.ceil(Math.sqrt(t));return Math.max(e,1)}function e3e(t,e){let i=new zn(t.geometry,t.material),r=[],n=[],s=new N,o=new N;i.geometry.index!==null&&(i.geometry=i.geometry.toNonIndexed());let a=new QDe(i).build();for(let c=0;c<e;c++)a.sample(s,o),r.push(s.x,s.y,s.z),n.push(o.x,o.y,o.z);let l=new Float32Array(r),u=new Float32Array(n);return{positions:l,normals:u}}function EW(t,e){let i=t,r=new Float32Array(4*e*e);for(let s=0;s<e*e;s++)r[4*s]=i[3*s],r[4*s+1]=i[3*s+1],r[4*s+2]=i[3*s+2],r[4*s+3]=0;let n=new Dl(r,e,e,_s,Fn);return n.needsUpdate=!0,n}function t3e({size:t}){let e=new Float32Array(4*t*t);for(let r=0;r<t*t;r++)e[4*r]=r,e[4*r+1]=0,e[4*r+2]=0,e[4*r+3]=0;let i=new Dl(e,t,t,_s,Fn);return i.needsUpdate=!0,i}function i3e(t){let e=new Float32Array(4*t*t);for(let r=0;r<t*t;r++)e[4*r]=0,e[4*r+1]=0,e[4*r+2]=0,e[4*r+3]=0;let i=new Dl(e,t,t,_s,Fn);return i.needsUpdate=!0,i}var r3e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,n3e=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,s3e=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,o3e=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,a3e=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,l3e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+n3e+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          float offset = 0.0;
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), offset);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          float offset = 0.0;
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${s3e}
      // ATTRACTION
      ${o3e}  
      // VORTEX
      ${a3e}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,hte=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,u3e=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,h3e=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,c3e=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${u3e}
  ${hte}
`,d3e=({easeSize:t="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${t}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,p3e=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+hte+`  
  ${h3e}

`,f3e=({easeOpacity:t="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${t}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,m3e=class extends er{constructor(t,e){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(t,e),this.context=e}reset(){}init(t,e){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=t.ease,this.easeSize=t.easeSize,this.layers=[],this.lightLayer=new uh(0,"",{...ys.defaultData("light","phong"),visible:!1},new Mz,{},e.shared),this.build()}updateState(t){t.coloring!==void 0&&(this.isColoringRandom=t.coloring==="random"),t.color!==void 0&&(t.color instanceof Array?this.uniforms.uColor.value=t.color:this.uniforms.uColor.value=this.context.shared.color(t.color)),t.color2!==void 0&&(t.color2 instanceof Array?this.uniforms.uColor2.value=t.color2:this.uniforms.uColor2.value=this.context.shared.color(t.color2)),t.size!==void 0&&(this.uniforms.uSize.value=t.size[0],this.uniforms.uSizeEnd.value=t.size[1],t.size[0]!==t.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),t.ease!==void 0&&(this.easeOpacity=t.ease,this.build()),t.easeSize!==void 0&&(this.easeSize=t.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader}build(){let t=new hee;return t.needsJitter=this.needsJitter,t.addFragmentParsCode(APe),t.buildShader("vertex",this.fragment),t.buildShader("fragment",this.fragment),t.addFragmentFinalCode(EPe),this.isColoringRandom&&t.define("USE_RANDOM_COLORING"),this.useSizeEnd&&t.define("USE_SIZE_END"),t.addVertexParsCode(c3e),t.addFragmentParsCode(p3e),t.addVertexFinalCode(d3e({easeSize:this.easeSize})),t.addFragmentFinalCode(f3e({easeOpacity:this.easeOpacity})),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms={...t.uniforms,...this.uniforms},this.extensions=t.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose()}},c3=class{constructor(t,e,i,r){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=t,this.type=i,this.textureSize=$De(e);let n=1;this.targetMesh=(r==null?void 0:r.type)==="Mesh"&&r?r:this.getMesh(i,n);let{positions:s,dataTexture:o,dataTextureNormals:a}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(i,n));this.positionsTexture=o,this.positionsAttribute=s,this.directionsTexture=a}createPositions(t,e){let{positions:i,normals:r}=e3e(e,t*t),n=EW(i,t),s=EW(r,t);return{dataTexture:n,positions:i,dataTextureNormals:s}}getMesh(t,e){let i=null;switch(t){case"SphereEmitterShape":{i=new Av(e*.5,32,32);break}case"TorusEmitterShape":{i=new XQ(e*.5,.3,15,40);break}case"ConeEmitterShape":{i=new DF(e,e,15);break}case"BoxEmitterShape":{i=new Cu(e,e,e);break}case"PlaneEmitterShape":{i=new Qm(e,e),i.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{i=new Av(e,32,32);break}default:{i=new Av(e,32,32);break}}return new zn(i,new Km({color:16711680}))}applyToShader(t,e){this.size=new N().fromArray(e.size),t.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function qx(t){let e={...t},i=f2.defaultData;e.forceFieldObjectId&&(e.colliderEntityId=e.forceFieldObjectId);let r={...i.shape,...e.shape},n={...i.renderMaterial,...e.renderMaterial};return{...i,...e,shape:r,renderMaterial:n}}var g3e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,d3=10,y3e=class extends ir{constructor(t,e){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new vve,this.currentWorldPosition=new N,this.systemQuaternion=new ni,this.worldGravity=new N(0,0,0),this.directionAxis=new N(0,0,0),this.colliderV3=new N(0,0,0),this.colliderQuaternion=new ni(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=t,this.system=e,this.shared=e.context.shared;let i=e.data;this.material=new m3e(i.renderMaterial,e.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:i.renderMaterial.color},uColor2:{value:i.renderMaterial.color2},uPosition:{value:new N(0,0,0)},uEmissionData:{value:new N(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new N(0,0,0)},uWorldQuaternion:{value:new si(0,0,0,1)},uRandScaleFactor:{value:i.randomScale??0},uRandRotationFactor:{value:i.randomRotation??0},uRotation:{value:i.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:i.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,i.renderMaterial.texture),this.init(i)}setTexture(t,e){let i=e.data;if(typeof e=="string"){let r=this.shared.image(e),n=new Wr(r.img);n.needsUpdate=!0,t.uTexture.value=n;return}if(typeof i!="string"){let r=new Image;r.onload=()=>{let o=new Wr(r);o.needsUpdate=!0,t.uTexture.value=o};let n=new Blob([i],{type:"image/*"}),s=URL.createObjectURL(n);r.src=s}}updateGeometryAttributes(t,e){var r;let i=ZDe(e);!((r=this.emitterShape)!=null&&r.positionsAttribute)||t.geometry.setAttribute("ref",new qw(i,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let t=this.system;t.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),t.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(t,e){var o;if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=t,this.positionSimRT.material.uniforms.uTime.value=t,this.emissionRateSimRT.material.uniforms.uTime.value=t;let i=1e3/e,r=this.targetFPS/i,n=this.previousRatio+(r-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let s=this.isEmitting?this.GoEmitSomeParticles(t,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=(o=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT))==null?void 0:o.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let t=this.system.colliderEntities[0];if(!t)return;t.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let e=t.data.size;this.colliderV3.fromArray(e),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),t.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(t){!this.velocitySimRT||!this.positionSimRT||(t.renderMaterial&&this.updateMaterialState(t.renderMaterial),this.updateParticleState(t))}updateVariableState(t,e){if(!this.velocitySimRT||!this.positionSimRT)return;e[2]==="size"&&this.material.updateState({size:[t,this.material.uniforms.uSizeEnd.value]}),e[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,t]});let i=(r,n)=>{let s=[...this.system.data.shape.size];s[r]=n,this.updateParticleState({shape:{...this.system.data.shape,size:s}})};e[2]==="shape_size_0"&&i(0,t),e[2]==="shape_size_1"&&i(1,t),e[2]==="shape_size_2"&&i(2,t),e[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=t/d3),e[2]==="gravity"&&this.worldGravity.set(0,t/100,0),e[2]==="noiseStrength"&&(this.noiseStrength=t,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e[2]==="noiseScale"&&(this.noiseScale=t,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(t),this.system.data.direction[1],this.system.data.direction[2]])),e[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(t),this.system.data.direction[2]])),e[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(t)]))}updateMaterialState(t){this.material.updateState({...t,size:t.size?[Number(this.shared.getVariable(t.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(t.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),t.texture&&(this.setTexture(this.material.uniforms,t.texture),this.material.needsUpdate=!0)}updateParticleState(t){var e,i,r;if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(t)&&this.init(qx(this.system.data)),t.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=t.life),t.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(t.speed,[this.uuid,"particles","speed"]))/d3),t.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=t.collisionBounce),t.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(t.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(t.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=t.noiseSeed),t.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=t.randomMass),((e=t.renderMaterial)==null?void 0:e.size)!==void 0){let n=this.shared.getVariable(t.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(n)}if(((i=t.renderMaterial)==null?void 0:i.spriteRotation)!==void 0&&(this.material.uniforms.uRotation.value=t.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=t.renderMaterial.spriteRotation[1]),t.shape!==void 0){let n=t.shape.size??this.system.data.shape.size,s=[Number(this.shared.getVariable(n[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(n[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(n[2],[this.uuid,"particles","shape_size_2"]))],o={...qx(this.system.data).shape,size:s};(r=this.emitterShape)==null||r.applyToShader(this.positionSimRT.material.uniforms,o)}if(t.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),t.direction!==void 0){let n=this.getDirectionFromVariable(t.direction);this.directionAxis=this.getDirectionAxis(n),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}t.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=t.randomRotation),t.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=t.randomScale)}}updateForceFieldParameters(t){!this.velocitySimRT||(t.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=t.forceIntensity),t.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=t.forceDambing))}getDirectionAxis(t){let e=[Number(t[0])*kt.DEG2RAD,Number(t[1])*kt.DEG2RAD,Number(t[2])*kt.DEG2RAD],i=new ts(e[0],e[1],e[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(i).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(t){let{birthRatePerSec:e,rootObjectType:i,colliderEntityId:r,shape:n,emitTimeDuration:s,emitTimeCycle:o,life:a,directionMode:l,noiseType:u}=t;return e!==void 0||i!==void 0||r||r===null||o!==void 0||n!==void 0||a!==void 0||s!==void 0||l!==void 0||u!==void 0}init(t){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:t.birthRatePerSec,particleMaxLifeTime:t.life,loopDuration:t.emitTimeCycle==="infinity"?0:t.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(t.shape,this.particlesAmount);let e=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(t);return}else clearInterval(e)},100);if(!this.emitterShape)return;let i=new JDe(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),r=this.updateSimulationDefinition(t),n=i.addVariable("uCurrentPosition",r+r3e,this.emitterShape.positionsTexture),s=i.addVariable("uCurrentVelocity",r+l3e,this.emitterShape.directionsTexture),o=i.addVariable("uCurrentEmissionRate",g3e,i3e(this.emitterShape.textureSize));i.setVariableDependencies(n,[n,s,o]),i.setVariableDependencies(s,[n,s,o]),i.setVariableDependencies(o,[n,s,o]);let a=t3e({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new N(0,0,0)},uWorldQuaternion:{value:new si(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:t.life},uEmitterSize:{value:new N(Number(this.shared.getVariable(t.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let u=this.getDirectionFromVariable(t.direction);this.directionAxis=this.getDirectionAxis(u),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(t.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(t.noiseScale,[this.uuid,"particles","noiseScale"]));let c=t.colliderEntityId&&this.system.getColliderData(t.colliderEntityId),h={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new si(0,0,0,1)},uColliderPos:{value:new N(0,0,0)},uColliderSize:{value:new N(0,0,0)},uForceIntensity:{value:c?c.forceIntensity:0},uForceDamping:{value:c?c.forceDambing:0},uColliderQuaternion:{value:new si(0,0,0,1)},uColliderQuaternionInvert:{value:new si(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:t.noiseSeed},uRandomMassFactor:{value:t.randomMass},uBounce:{value:t.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(t.speed,[this.uuid,"particles","speed"]))/d3}};s.material.uniforms=h;let d={uIndex:{value:a},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};o.material.uniforms=d;let p=[Number(this.shared.getVariable(t.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t.shape.size[2],[this.uuid,"particles","shape_size_2"]))],f={...qx(this.system.data).shape,size:p};this.emitterShape.applyToShader(n.material.uniforms,f),i.init(),this.gpuCompute=i,this.positionSimRT=n,this.velocitySimRT=s,this.emissionRateSimRT=o,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(t){let e=Number(this.shared.getVariable(t[0],[this.uuid,"particles","direction_x"])),i=Number(this.shared.getVariable(t[1],[this.uuid,"particles","direction_y"])),r=Number(this.shared.getVariable(t[2],[this.uuid,"particles","direction_z"]));return[e,i,r]}updateSimulationDefinition(t){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,t.colliderEntityId&&this.system.colliderEntities.length>0){let i=this.system.getColliderData(t.colliderEntityId);switch(i==null?void 0:i.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let r=i==null?void 0:i.colliderType;r==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),r==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),(i==null?void 0:i.forceRange)==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}t.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),t.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),t.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),t.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let e="";for(let[i,r]of Object.entries(this.simFeaturesDefinition))r&&(e+=`#define ${i}
`);return e}createShape(t,e){this.emitterShape&&this.emitterShape.dispose();let i=new N(Number(this.shared.getVariable(t.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t.size[2],[this.uuid,"particles","shape_size_2"])));if(t.type==="MeshEmitterShape"){let r=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===t.fromMeshId&&(r=n)}),r?new c3(i,e,t.type,r):new c3(i,e,"SphereEmitterShape")}else return new c3(i,e,t.type)}createPrimaryEmitter(t){let e,i=t*t;return e=new Dye(new Qm(1,1,1),this.material,i),this.updateGeometryAttributes(e,t),this.material.needsUpdate=!0,e.onBeforeRender=()=>{this.applyWorldSpace()},e}getMaxParticlesAmount({birthRatePerSecond:t,particleMaxLifeTime:e,loopDuration:i=0}){return Math.ceil(t*(e+i))}dispose(){var t,e,i;!this.gpuCompute||((e=(t=this.rootObject)==null?void 0:t.parent)==null||e.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),(i=this.emitterShape)==null||i.dispose())}GoEmitSomeParticles(t,e){let i=t-this.lastEmitTime,r=1/e;if(i>=r){let n=Math.max(1,Math.floor(i/r));return this.lastEmitTime=t,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(qx(this.system.data))}startEmitting(t){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=t}stopEmitting(){this.isEmitting=!1}},BM=class extends qo{constructor(t,e,i){super(t,e),this.type="ParticleSystem",this.geometry=new Ht,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=r=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(r))},this.context=i,this.data={...e,...qx(e)},this.geometry.setAttribute("position",new _t([],3)),this.material=new Km({colorWrite:!1}),this.frustumCulled=!1}init(t){this.renderer=t,this.emitter=new y3e(t,this),this.add(this.emitter),this.updateParticleState(this.data)}update(t){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=t,this.stopped||(this.currentLoopTime+=t);let e=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||e)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),e||this.start(this.data.emitTimeLoopDelayStart==="start"?0:this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let i=this.actualTime/1e3;this.emitter.update(i,t)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(t){return this.colliderEntities.some(e=>e.identity===t)}getColliderData(t){let e=this.colliderEntities.find(i=>i.identity===t);return e?e.data:null}updateByPatchedOp(t,e,i){super.updateByPatchedOp(t,e,i),gr(t.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Ss.drop(t,1).props}}),gr(t.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Ss.drop(t,1).props}})}updateState(t,e){super.updateState(t,e),this.updateParticleState(t)}updateParticleState(t){if(this.emitter){if(t.colliderEntityId!==void 0&&t.colliderEntityId!==null){let e=this.context.scene.find(t.colliderEntityId);this.colliderEntities=e?[e]:[]}t.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(t),t.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(t){!this.emitter||(this.emitter.updateForceFieldParameters(t),this.stop(),this.start())}start(t=0){var e;if(this.currentLoopTime=0,t){setTimeout(()=>{this.start(0)},t);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,(e=this.emitter)==null||e.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){var t;this.stopped=!0,this.currentLoopTime=0,(t=this.emitter)==null||t.stopEmitting()}reset(){var t;this.started=!1,this.stopped=!1,(t=this.emitter)==null||t.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function v3e(t,e,i){let r;return e.geometry.type==="TextGeometry"?new jee(t,e,i):(e.geometry.type==="SubdivGeometry"?r=new c1(t,e,i):e.geometry.type==="PathGeometry"?r=new Uz(t,e,i):e.geometry.type==="VectorGeometry"?r=new YDe(t,e,i):e.geometry.type==="BooleanGeometry"?r=new Fm(t,e,i):e.geometry.type==="UIGeometry"?r=new ho(t,e,i):r=new po(t,e,i),r)}function Fz(t,e,i){return console.assert(e.type!==void 0),e.type==="Mesh"?v3e(t,e,i):e.type==="Empty"?new Bv(t,e):e.type==="Particle"?new BM(t,e,i):e.type==="ParticleCollider"?new IM(t,e,i):e.type==="Splat"?new Bv(t,e):e.type==="Bone"?new KDe(t,e):e.type==="Page"?new bs(t,e,i):e.type==="PointLight"?new XDe(t,e,i):e.type==="SpotLight"?new tte(t,e,i):e.type==="DirectionalLight"?new ete(t,e,i):e.type==="Component"||e.type==="Instance"?new Ov(t,e,i):Om.is(e.type)?new mo(t,e):(console.error(e),new Bv(t,e))}fp.createEntity=Fz;function b3e(t,e,i){let r=Fz(t.identity,e,i),n=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,u=t.overrideData,c=t.uuid,h=t.stateSelection;t.dispose();for(let d of Object.keys(t))delete t[d];Object.setPrototypeOf(t,Object.getPrototypeOf(r));for(let d of Object.keys(r))t[d]=r[d];t.children=[...t.children,...n],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=c,t.overrideData=u,t.updateState(t.data,i),h&&t.changeSelectedState(h,i),t.resetBBoxNeedsUpdate()}fp.changeEntityProptotype=b3e;fp.Cloner=vu;function x3e(t,e,i,r){t.updateByOp(e,i,r,!1)}function MW(t,e){let i=!1,r=e.getLayersOfType("transmission"),n=e.getLayersOfType("outline");return n.length>0&&(t.layers.set(8),r.length>0&&t.layers.enable(3),i=!0,Rz(t),Tz(t)),r.length===0&&n.length===0&&t.layers.set(0),t instanceof J0&&t.needsAO&&t.layers.enable(5),i}function CW(t,e){if(!e.layers)return!1;let i=!1,r=e.getLayersOfType("transmission").filter(s=>s.data.visible),n=e.getLayersOfType("outline").filter(s=>s.data.visible);return r.length>0&&(t.layers.set(3),n.length>0&&t.layers.enable(8),i=!0),r.length===0&&n.length===0&&t.layers.set(0),t.needsAO&&t.layers.enable(5),i}function w3e(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof J0)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)MW(i,i.material[r])&&(e=!0);else MW(i,i.material)&&(e=!0)}),e}function _3e(t){let e=!1;return t.traverseEntity(i=>{if(i instanceof J0)if(Array.isArray(i.material))for(let r=0;r<i.material.length;r++)CW(i,i.material[r])&&(e=!0);else CW(i,i.material)&&(e=!0)}),e}var S3e=new iZ,A3e=new lt,E3e=new O0;function MO(t,e,i,r=!1){let n=t.cloner;if(n)for(let s of n.children){let o=A3e.copy(s.matrixWorld).invert(),a=E3e.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let u=S3e;u.set(a.origin,a.direction),u.near=e.near,u.far=e.far;let c=u.intersectObject(t,!1);c.length>0&&i.push({...c[0],object:r?s:t})}}var M3e=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((i,r)=>{let n=[r,i],s=i;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||n.push(s);for(let o=n.length-2;o>=0;o--)if(!e.has(n[o])){let a=t.find(n[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${n[o]}`),e.add(n[o])}})}findDependency(t,e){let i=t;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===e)return!0;return!1}},$u=qn(W1()),uc=qn(q1()),vn=qn(W1()),xi=qn(q1()),U2=class{constructor(t,e,i){this._dataNormalized=t,this._minD=e,this._maxD=i}static createFromUnnormalized(t){let e=xi.sup(t),i=xi.inf(t),r=(0,vn.default)(new Float32Array(t.size),t.shape),n=e-i;return n<1e-4?xi.assigns(r,0):(xi.subs(r,t,i),xi.divs(r,r,n)),new U2(r,i,e)}get data(){return this._dataNormalized}get minD(){return this._minD}get maxD(){return this._maxD}denormalize(){let t=(0,vn.default)(new Float32Array(this._dataNormalized.size),this._dataNormalized.shape);return xi.muls(t,this._dataNormalized,this._maxD-this._minD),xi.adds(t,t,this._minD),t}},zr=class{constructor(t,e){this._quantized=t,this._method=e}get quantized(){return this._quantized}static maxIntBits(t){return 2**t-1}static fromNormalized(t,e){let i=t.data,r;if(e==="norm8x"){let n=zr.maxIntBits(8),s=(0,vn.default)(new Float32Array(i.size),i.shape);xi.muls(s,i,n),xi.roundeq(s),r=(0,vn.default)(new Uint8Array(s.data),i.shape)}else if(e==="norm565"){let n=(0,vn.default)(new Float32Array(i.size),i.shape);xi.assign(n,i),xi.mulseq(n.pick(null,0),zr.maxIntBits(5)),xi.mulseq(n.pick(null,1),zr.maxIntBits(6)),xi.mulseq(n.pick(null,2),zr.maxIntBits(5)),xi.roundeq(n);let s=(0,vn.default)(new Uint16Array(n.data),i.shape),o=(0,vn.default)(new Uint16Array(i.shape[0]),[i.shape[0]]),a=(0,vn.default)(new Uint16Array(i.shape[0]),[i.shape[0]]);xi.lshifts(o,s.pick(null,0),11),xi.lshifts(a,s.pick(null,1),5),xi.boreq(o,a),xi.boreq(o,s.pick(null,2)),r=o}else{let n=(0,vn.default)(new Float32Array(i.size),i.shape);xi.assign(n,i),xi.mulseq(n.pick(null,0),zr.maxIntBits(11)),xi.mulseq(n.pick(null,1),zr.maxIntBits(10)),xi.mulseq(n.pick(null,2),zr.maxIntBits(11)),xi.roundeq(n);let s=(0,vn.default)(new Uint32Array(n.data),i.shape),o=(0,vn.default)(new Uint32Array(i.shape[0]),[i.shape[0]]),a=(0,vn.default)(new Uint32Array(i.shape[0]),[i.shape[0]]);xi.lshifts(o,s.pick(null,0),21),xi.lshifts(a,s.pick(null,1),11),xi.boreq(o,a),xi.boreq(o,s.pick(null,2)),r=o}return new zr(r,e)}dequantize(t,e){let i=this._method,r,n=this._quantized;if(i==="norm8x"){let s=zr.maxIntBits(8);r=(0,vn.default)(new Float32Array(n.size),n.shape),xi.muls(r,n,1/s)}else if(i==="norm565"){let s=(0,vn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]),o=(0,vn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]),a=(0,vn.default)(new Uint8Array(n.shape[0]),[n.shape[0]]);xi.rrshifts(s,n,11),xi.rrshifts(o,n,5),xi.bandseq(o,zr.maxIntBits(6)),xi.bands(a,n,zr.maxIntBits(5)),r=(0,vn.default)(new Float32Array(n.shape[0]*3),[n.shape[0],3]),xi.muls(r.pick(null,0),s,1/zr.maxIntBits(5)),xi.muls(r.pick(null,1),o,1/zr.maxIntBits(6)),xi.muls(r.pick(null,2),a,1/zr.maxIntBits(5))}else{let s=(0,vn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]),o=(0,vn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]),a=(0,vn.default)(new Uint16Array(n.shape[0]),[n.shape[0]]);xi.rrshifts(s,n,21),xi.rrshifts(o,n,11),xi.bandseq(o,zr.maxIntBits(10)),xi.bands(a,n,zr.maxIntBits(11)),r=(0,vn.default)(new Float32Array(n.shape[0]*3),[n.shape[0],3]),xi.muls(r.pick(null,0),s,1/zr.maxIntBits(11)),xi.muls(r.pick(null,1),o,1/zr.maxIntBits(10)),xi.muls(r.pick(null,2),a,1/zr.maxIntBits(11))}return new U2(r,t,e)}},tn=class{constructor(e,i,r,n,s,o=!1){this._quantized=e,this._minMaxMatrix=i,this._chunkSize=r,this._quantizationMethod=n,this._variableChunkSize=s,this._isDynamicChunks=o}get length(){return this._quantized.shape[0]}get nchunks(){return this._minMaxMatrix.shape[0]}get quantized(){return this._quantized}get method(){return this._quantizationMethod}get minmaxMatrix(){return this._minMaxMatrix}_createPrunedMinMax(e){let i=e.length,r=this.minmaxMatrix.shape[0]-i,n=(0,$u.default)(new Float32Array(r*2),[r,2]),s=0,o=r,a=0,l=this.minmaxMatrix.shape[0];for(let u=0;u<e.length;u++)l=e[u],o=l-a+s,o>s&&uc.assign(n.hi(o,2).lo(s,0),this.minmaxMatrix.hi(l,2).lo(a,0)),s=o,a=l+1;return s<r&&uc.assign(n.lo(s,0),this.minmaxMatrix.lo(a,0)),n}_createPrunedQuantized(e){let i=e.length,r=this.quantized.shape[0]-i,n=this._quantizationMethod,s,o;if(n==="norm8x"){o=this._quantized.shape[1];let h=o?r*o:r;s=(0,$u.default)(new Uint8Array(h),o?[r,o]:[r,1])}else n==="norm565"?s=(0,$u.default)(new Uint16Array(r),[r]):s=(0,$u.default)(new Uint32Array(r),[r]);let a=0,l=r,u=0,c=s.shape[0];for(let h=0;h<e.length;h++)c=e[h],l=c-u+a,l>a&&(o?uc.assign(s.hi(l,o).lo(a,0),this._quantized.hi(c,o).lo(u,0)):uc.assign(s.hi(l).lo(a),this._quantized.hi(c).lo(u))),a=l,u=c+1;return a<r&&(o?uc.assign(s.lo(a,0),this._quantized.lo(u,0)):uc.assign(s.lo(a),this._quantized.lo(u))),s}pruneFeature(e,i,r){let n=this._createPrunedQuantized(e),s=this._createPrunedMinMax(i);return new tn(n,s,this._chunkSize,this._quantizationMethod,r,!0)}static getRequiredNChunks(e,i){return Math.floor(e/i)}static fromArray(e,i,r){let n=e.shape[0],s=Math.floor(n/r),o=(0,$u.default)(new Float32Array(s*2),[s,2],[2,1]),a;i==="norm8x"?a=(0,$u.default)(new Uint8Array(e.size),e.shape):i==="norm565"?a=(0,$u.default)(new Uint16Array(e.shape[0]),[e.shape[0]]):a=(0,$u.default)(new Uint32Array(e.shape[0]),[e.shape[0]]);for(let l=0;l<s;l++){let u=l*r,c=l+1<s?(l+1)*r:n,h;e.shape.length>1?h=U2.createFromUnnormalized(e.hi(c,e.shape[1]).lo(u,0)):h=U2.createFromUnnormalized(e.hi(c).lo(u)),o.set(l,0,h.minD),o.set(l,1,h.maxD),a.shape.length>1?uc.assign(a.hi(c,a.shape[1]).lo(u,0),zr.fromNormalized(h,i).quantized):uc.assign(a.hi(c).lo(u),zr.fromNormalized(h,i).quantized)}return new tn(a,o,r,i)}denormDequant(){let e=this._minMaxMatrix.shape[0],i=this._quantized,r=i.shape[0],n=this._quantizationMethod,s=this._chunkSize,o;if(this._isDynamicChunks){if(!this._variableChunkSize)throw new Error("variable chunk must exists if chunkSize isDynamic");o=this._variableChunkSize}let a;n==="norm8x"?a=(0,$u.default)(new Float32Array(i.size),i.shape):a=(0,$u.default)(new Float32Array(r*3),[r,3]);let l=0,u=s;for(let c=0;c<e;c++){let[h,d]=[this._minMaxMatrix.get(c,0),this._minMaxMatrix.get(c,1)];this._isDynamicChunks&&(u=o[c]);let p=c+1<e?l+u:r,f;i.shape.length>1?f=new zr(i.hi(p,i.shape[1]).lo(l,0),n):f=new zr(i.hi(p).lo(l),n),uc.assign(a.hi(p,a.shape[1]).lo(l,0),f.dequantize(h,d).denormalize()),l=p}return a}static async fetchArrayBuffer(e){return await(await fetch(e,{mode:"cors"})).arrayBuffer()}},Rd=qn(W1()),ki=qn(q1()),C3e="http://127.0.0.1:8000",Uv=qn(W1()),Ln=qn(q1()),PW=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function TW(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function RW(t,e){if(t===e)return 0;if(~~t===t&&~~e===e){if(t===0||e===0)return t<e?-1:1;if(t<0||e<0){if(e>=0)return-1;if(t>=0)return 1;t=-t,e=-e}let n=TW(t),s=TW(e),o=0;return n<s?(t*=PW[s-n-1],e/=10,o=-1):n>s&&(e*=PW[n-s-1],t/=10,o=1),t===e?o:t<e?-1:1}let i=String(t),r=String(e);return i===r?0:i<r?-1:1}function P3e(t){let e=0;for(;t>=32;)e|=t&1,t>>=1;return t+e}function kW(t,e,i,r){let n=e+1;if(n===i)return 1;if(r(t[n++],t[e])<0){for(;n<i&&r(t[n],t[n-1])<0;)n++;T3e(t,e,n)}else for(;n<i&&r(t[n],t[n-1])>=0;)n++;return n-e}function T3e(t,e,i){for(i--;e<i;){let r=t[e];t[e++]=t[i],t[i--]=r}}function DW(t,e,i,r,n){for(r===e&&r++;r<i;r++){let s=t[r],o=e,a=r;for(;o<a;){let u=o+a>>>1;n(s,t[u])<0?a=u:o=u+1}let l=r-o;switch(l){case 3:t[o+3]=t[o+2];case 2:t[o+2]=t[o+1];case 1:t[o+1]=t[o];break;default:for(;l>0;)t[o+l]=t[o+l-1],l--}t[o]=s}}function p3(t,e,i,r,n,s){let o=0,a=0,l=1;if(s(t,e[i+n])>0){for(a=r-n;l<a&&s(t,e[i+n+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),o+=n,l+=n}else{for(a=n+1;l<a&&s(t,e[i+n-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);let u=o;o=n-l,l=n-u}for(o++;o<l;){let u=o+(l-o>>>1);s(t,e[i+u])>0?o=u+1:l=u}return l}function f3(t,e,i,r,n,s){let o=0,a=0,l=1;if(s(t,e[i+n])<0){for(a=n+1;l<a&&s(t,e[i+n-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);let u=o;o=n-l,l=n-u}else{for(a=r-n;l<a&&s(t,e[i+n+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),o+=n,l+=n}for(o++;o<l;){let u=o+(l-o>>>1);s(t,e[i+u])<0?l=u:o=u+1}return l}var R3e=class{constructor(t,e){Io(this,"array",null),Io(this,"compare",null),Io(this,"minGallop",7),Io(this,"length",0),Io(this,"tmpStorageLength",256),Io(this,"stackLength",0),Io(this,"runStart",null),Io(this,"runLength",null),Io(this,"stackSize",0),this.array=t,this.compare=e,this.length=t.length,this.length<2*256&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}pushRun(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1}mergeRuns(){for(;this.stackSize>1;){let t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}}forceMergeRuns(){for(;this.stackSize>1;){let t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}}mergeAt(t){let e=this.compare,i=this.array,r=this.runStart[t],n=this.runLength[t],s=this.runStart[t+1],o=this.runLength[t+1];this.runLength[t]=n+o,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;let a=f3(i[s],i,r,n,0,e);r+=a,n-=a,n!==0&&(o=p3(i[r+n-1],i,s,o,o-1,e),o!==0&&(n<=o?this.mergeLow(r,n,s,o):this.mergeHigh(r,n,s,o)))}mergeLow(t,e,i,r){let n=this.compare,s=this.array,o=this.tmp,a=0;for(a=0;a<e;a++)o[a]=s[t+a];let l=0,u=i,c=t;if(s[c++]=s[u++],--r===0){for(a=0;a<e;a++)s[c+a]=o[l+a];return}if(e===1){for(a=0;a<r;a++)s[c+a]=s[u+a];s[c+r]=o[l];return}let h=this.minGallop;for(;;){let d=0,p=0,f=!1;do if(n(s[u],o[l])<0){if(s[c++]=s[u++],p++,d=0,--r===0){f=!0;break}}else if(s[c++]=o[l++],d++,p=0,--e===1){f=!0;break}while((d|p)<h);if(f)break;do{if(d=f3(s[u],o,l,e,0,n),d!==0){for(a=0;a<d;a++)s[c+a]=o[l+a];if(c+=d,l+=d,e-=d,e<=1){f=!0;break}}if(s[c++]=s[u++],--r===0){f=!0;break}if(p=p3(o[l],s,u,r,0,n),p!==0){for(a=0;a<p;a++)s[c+a]=s[u+a];if(c+=p,u+=p,r-=p,r===0){f=!0;break}}if(s[c++]=o[l++],--e===1){f=!0;break}h--}while(d>=7||p>=7);if(f)break;h<0&&(h=0),h+=2}if(this.minGallop=h,h<1&&(this.minGallop=1),e===1){for(a=0;a<r;a++)s[c+a]=s[u+a];s[c+r]=o[l]}else{if(e===0)throw new Error("mergeLow preconditions were not respected");for(a=0;a<e;a++)s[c+a]=o[l+a]}}mergeHigh(t,e,i,r){let n=this.compare,s=this.array,o=this.tmp,a=0;for(a=0;a<r;a++)o[a]=s[i+a];let l=t+e-1,u=r-1,c=i+r-1,h=0,d=0;if(s[c--]=s[l--],--e===0){for(h=c-(r-1),a=0;a<r;a++)s[h+a]=o[a];return}if(r===1){for(c-=e,l-=e,d=c+1,h=l+1,a=e-1;a>=0;a--)s[d+a]=s[h+a];s[c]=o[u];return}let p=this.minGallop;for(;;){let f=0,m=0,g=!1;do if(n(o[u],s[l])<0){if(s[c--]=s[l--],f++,m=0,--e===0){g=!0;break}}else if(s[c--]=o[u--],m++,f=0,--r===1){g=!0;break}while((f|m)<p);if(g)break;do{if(f=e-f3(o[u],s,t,e,e-1,n),f!==0){for(c-=f,l-=f,e-=f,d=c+1,h=l+1,a=f-1;a>=0;a--)s[d+a]=s[h+a];if(e===0){g=!0;break}}if(s[c--]=o[u--],--r===1){g=!0;break}if(m=r-p3(s[l],o,0,r,r-1,n),m!==0){for(c-=m,u-=m,r-=m,d=c+1,h=u+1,a=0;a<m;a++)s[d+a]=o[h+a];if(r<=1){g=!0;break}}if(s[c--]=s[l--],--e===0){g=!0;break}p--}while(f>=7||m>=7);if(g)break;p<0&&(p=0),p+=2}if(this.minGallop=p,p<1&&(this.minGallop=1),r===1){for(c-=e,l-=e,d=c+1,h=l+1,a=e-1;a>=0;a--)s[d+a]=s[h+a];s[c]=o[u]}else{if(r===0)throw new Error("mergeHigh preconditions were not respected");for(h=c-(r-1),a=0;a<r;a++)s[h+a]=o[a]}}};function k3e(t,e,i,r){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");e?typeof e!="function"&&(r=i,i=e,e=RW):e=RW,i||(i=0),r||(r=t.length);let n=r-i;if(n<2)return;let s=0;if(n<32){s=kW(t,i,r,e),DW(t,i,r,i+s,e);return}let o=new R3e(t,e),a=P3e(n);do{if(s=kW(t,i,r,e),s<a){let l=n;l>a&&(l=a),DW(t,i,i+l,i+s,e),s=l}o.pushRun(i,s),o.mergeRuns(),n-=s,i+=s}while(n!==0);o.forceMergeRuns()}function m3(t){let e=(0,Uv.default)(new Int32Array(t.shape[0]),[t.shape[0]]),i=(0,Uv.default)(new Int32Array(t.shape[0]),[t.shape[0]]);return Ln.bands(e,t,1023),Ln.lshifts(i,e,16),Ln.bxoreq(e,i),Ln.bandseq(e,4278190335),Ln.lshifts(i,e,8),Ln.bxoreq(e,i),Ln.bandseq(e,50393103),Ln.lshifts(i,e,4),Ln.bxoreq(e,i),Ln.bandseq(e,51130563),Ln.lshifts(i,e,2),Ln.bxoreq(e,i),Ln.bandseq(e,153391689),e}function D3e(t){let e=m3(t.pick(null,0)),i=m3(t.pick(null,1));Ln.lshiftseq(i,1);let r=m3(t.pick(null,2));return Ln.lshiftseq(r,2),Ln.boreq(e,i),Ln.boreq(e,r),e}function Qg(t,e){if(t.shape[0]!==e.shape[0])throw new Error("wrong length");let i=(0,Uv.default)(new Float32Array(t.size),t.shape,t.stride,t.offset);for(let r=0;r<e.shape[0];r++){let n=e.get(r);if(t.shape.length>1)for(let s=0;s<t.shape[1];s++)i.set(r,s,t.get(n,s));else i.set(r,t.get(n))}return i}function I3e(t){let e=Ln.sup(t),i=Ln.inf(t),r=1e3/Math.min(1e3,e-i),n=(0,Uv.default)(new Float32Array(t.data),t.shape);Ln.mulseq(n,r);let s=(0,Uv.default)(new Int32Array(n.data),t.shape),o=D3e(s),a=Array.from(o.data).map((u,c)=>[u,c]);k3e(a,(u,c)=>u[0]-c[0]);let l=a.map(([u,c])=>c);return(0,Uv.default)(Uint32Array.from(l))}var Lf=class{constructor(t,e,i,r,n,s,o,a,l,u){this.propertyDescs=t,this.format=e,this.nsplats=i,this.xyz=r,this.colors=n,this.harmonics=s,this.opacity=o,this.scaling=a,this.rotation=l,this.maxSHDegree=u}getPlyBinary(){let t=Lf._generateHeaderString(this.propertyDescs,this.format,this.nsplats),e=new TextEncoder().encode(t),i=Object.keys(this.propertyDescs).length,r=(0,Rd.default)(new Float32Array(this.nsplats*i),[this.nsplats,i]);if(ki.assign(r.pick(null,this.propertyDescs.x.index),this.xyz.pick(null,0)),ki.assign(r.pick(null,this.propertyDescs.y.index),this.xyz.pick(null,1)),ki.assign(r.pick(null,this.propertyDescs.z.index),this.xyz.pick(null,2)),ki.assign(r.pick(null,this.propertyDescs.f_dc_0.index),this.colors.pick(null,0)),ki.assign(r.pick(null,this.propertyDescs.f_dc_1.index),this.colors.pick(null,1)),ki.assign(r.pick(null,this.propertyDescs.f_dc_2.index),this.colors.pick(null,2)),ki.assign(r.pick(null,this.propertyDescs.opacity.index),this.opacity.pick(null,0)),ki.assign(r.pick(null,this.propertyDescs.scale_0.index),this.scaling.pick(null,0)),ki.assign(r.pick(null,this.propertyDescs.scale_1.index),this.scaling.pick(null,1)),ki.assign(r.pick(null,this.propertyDescs.scale_2.index),this.scaling.pick(null,2)),ki.assign(r.pick(null,this.propertyDescs.rot_0.index),this.rotation.pick(null,0)),ki.assign(r.pick(null,this.propertyDescs.rot_1.index),this.rotation.pick(null,1)),ki.assign(r.pick(null,this.propertyDescs.rot_2.index),this.rotation.pick(null,2)),ki.assign(r.pick(null,this.propertyDescs.rot_3.index),this.rotation.pick(null,3)),this.harmonics&&this.harmonics.length>0)for(let o=0;o<this.harmonics.length;o++){let a=o*3;ki.assign(r.pick(null,this.propertyDescs[`f_rest_${a}`].index),this.harmonics[o].pick(null,0)),ki.assign(r.pick(null,this.propertyDescs[`f_rest_${a+1}`].index),this.harmonics[o].pick(null,1)),ki.assign(r.pick(null,this.propertyDescs[`f_rest_${a+2}`].index),this.harmonics[o].pick(null,2))}let n=new Uint8Array(r.data.buffer),s=new Uint8Array(n.length+e.length);return s.set(e),s.set(n,e.length),s.buffer}save(t,e){let i=this.getPlyBinary(),r=new Blob([i],{type:"application/octet-stream"}),n=new File([r],t),s=new FormData;s.append("file",n),s.append("filename",t),s.append("basedir",e),fetch(`${C3e}/push_file`,{method:"POST",body:s})}static async loadFile(t){return await(await fetch(t)).arrayBuffer()}mortonPositionSplatsSort(){let t=I3e(this.xyz),e=Qg(this.xyz,t),i=Qg(this.colors,t),r=Qg(this.opacity,t),n=Qg(this.scaling,t),s=Qg(this.rotation,t),o=[];for(let a=0;a<this.harmonics.length;a++)o.push(Qg(this.harmonics[a],t));return new Lf(this.propertyDescs,this.format,this.nsplats,e,i,o,r,n,s,this.maxSHDegree)}static _generateHeaderString(t,e,i){let r=`ply
format ${e.format} ${e.version}
element vertex ${i}`,n=Object.keys(t).length,s=Array(n);for(let o in t){let a=t[o];s[a.index]={name:o,dtype:a.dtype}}for(let o=0;o<s.length;o++)r=`${r}
property ${s[o].dtype} ${s[o].name}`;return`${r}
end_header
`}static fromArrayBuffer(t,e=3){let{splatCount:i,vertexData:r,propertiesDesc:n,format:s}=Lf.decodeHeader(t),o=r.buffer.slice(r.byteOffset),a=Object.keys(n).length,l=(0,Rd.default)(new Float32Array(o),[i,a]),u=0,c={},h={double:8,int:4,uint:4,float:4,short:2,ushort:2,uchar:1};for(let b in n)if(n.hasOwnProperty(b)){let _=n[b].dtype;c[b]=u,u+=h[_]}let d=(0,Rd.default)(new Float32Array(i*3),[i,3]);ki.assign(d.pick(null,0),l.pick(null,c.x/4)),ki.assign(d.pick(null,1),l.pick(null,c.y/4)),ki.assign(d.pick(null,2),l.pick(null,c.z/4));let p=(0,Rd.default)(new Float32Array(i*3),[i,3]);ki.assign(p.pick(null,0),l.pick(null,c.scale_0/4)),ki.assign(p.pick(null,1),l.pick(null,c.scale_1/4)),ki.assign(p.pick(null,2),l.pick(null,c.scale_2/4));let f=(0,Rd.default)(new Float32Array(i*3),[i,3]);ki.assign(f.pick(null,0),l.pick(null,c.f_dc_0/4)),ki.assign(f.pick(null,1),l.pick(null,c.f_dc_1/4)),ki.assign(f.pick(null,2),l.pick(null,c.f_dc_2/4));let m=(0,Rd.default)(new Float32Array(i*4),[i,4]);ki.assign(m.pick(null,0),l.pick(null,c.rot_1/4)),ki.assign(m.pick(null,1),l.pick(null,c.rot_2/4)),ki.assign(m.pick(null,2),l.pick(null,c.rot_3/4)),ki.assign(m.pick(null,3),l.pick(null,c.rot_0/4));for(let b=0;b<i;b++){let _=m.pick(b,null),A=Math.sqrt(_.get(0)**2+_.get(1)**2+_.get(2)**2+_.get(3)**2);ki.divseq(_,A)}let g=(0,Rd.default)(new Float32Array(i*1),[i,1]);ki.assign(g.pick(null,0),l.pick(null,c.opacity/4));let y=(Math.min(Math.max(e,0),3)+1)**2-1,v=[];for(let b=0;b<y;b++){let _=(0,Rd.default)(new Float32Array(i*3),[i,3]),A=b*3;ki.assign(_.pick(null,0),l.pick(null,c[`f_rest_${A}`]/4)),ki.assign(_.pick(null,1),l.pick(null,c[`f_rest_${A+1}`]/4)),ki.assign(_.pick(null,2),l.pick(null,c[`f_rest_${A+2}`]/4)),v.push(_)}return new Lf(n,s,i,d,f,v,g,p,m,e)}static async fromPLYFile(t,e=3){let i=await Lf.loadFile(t);return Lf.fromArrayBuffer(i,e)}static decodeHeader(t){let e=new TextDecoder,i=0,r="",n=100;for(;;){if(i+n>=t.byteLength)throw new Error("End of file reached while searching for end of header");let d=new Uint8Array(t,i,n);r+=e.decode(d),i+=n;let p=i-n*2,f=new Uint8Array(t,Math.max(0,p),p>0?n*2:n);if(e.decode(f).includes("end_header"))break}let s=r.split(`
`),o=0,a={},l=0,u;for(let d=0;d<s.length;d++){let p=s[d].trim();if(p.startsWith("element vertex")){let f=p.match(/\d+/);f&&(o=parseInt(f[0]))}else if(p.startsWith("property")){let f=p.match(/(\w+)\s+(\w+)\s+(\w+)/);if(f){let m=f[2],g=f[3];a[g]={dtype:m,index:l},l++}}else if(p.startsWith("format")){let f=p.match(/(\w+)\s+(\w+)\s+(\d+\.?\d*)/);f&&(u={format:f[2],version:f[3]})}else if(p==="end_header")break}let c=r.indexOf("end_header")+10+1,h=new DataView(t,c);return{splatCount:o,vertexData:h,headerOffset:i,propertiesDesc:a,format:u}}},CO=class{constructor(t,e,i,r,n,s,o,a){this.config=t,this.xyz=e,this.scaling=i,this.color=r,this.opacity=n,this.harmonics=o,this.quaternion=s,this.variableChunkSize=a}get isDynamicChunks(){return this.variableChunkSize&&this.variableChunkSize.length>0}get nchunks(){return this.xyz.nchunks}get nsplats(){return this.xyz.length}get chunkSize(){return this.config.chunkSize}static compressFromGaussianData(t,e){let i=tn.fromArray(t.xyz,e.xyz,e.chunkSize),r=tn.fromArray(t.scaling,e.scaling,e.chunkSize),n=tn.fromArray(t.colors,e.color,e.chunkSize),s=tn.fromArray(t.opacity,e.opacity,e.chunkSize),o=tn.fromArray(t.rotation,e.quaternion,e.chunkSize),a=t.harmonics,l=[];if(e.harmonics)for(let u=0;u<a.length;u++){let c=tn.fromArray(a[u],e.harmonics,e.chunkSize);l.push(c)}return new CO(e,i,r,n,s,o,l)}_countIndexesInChunks(t){let e=[],i=this.nchunks,r=this.chunkSize,n=this.nsplats,s=tn.getRequiredNChunks(n,r);if(i===s)for(let o=0;o<t.length;o++){let a=t[o],l=Math.floor(a/this.chunkSize);l in e?e[l].push(a):e[l]=[a]}else{let o=this.variableChunkSize,a={},l=0;for(let u=0;u<i;u++)a[u]=l,l+=o[u];for(let u=0;u<t.length;u++){let c=t[u],h=Math.min(Math.floor(c/r),i-1);for(;c>=a[h]+o[h];)h++;h in e?e[h].push(c):e[h]=[c]}}return e}pruneSplats(t){let e=this._countIndexesInChunks(t),i,r=[];return e.length>0&&(i=this.variableChunkSize?[...this.variableChunkSize]:Array(this.nchunks).fill(this.chunkSize),e.forEach((n,s)=>{i[s]-=n.length,i[s]<=0&&r.push(s)}),i=i.filter(n=>n>0)),new CO(this.config,this.xyz.pruneFeature(t,r,i),this.scaling.pruneFeature(t,r,i),this.color.pruneFeature(t,r,i),this.opacity.pruneFeature(t,r,i),this.quaternion.pruneFeature(t,r,i),this.harmonics?this.harmonics.map(n=>n.pruneFeature(t,r,this.variableChunkSize)):void 0,i)}static async loadConfig(t){return await(await fetch(t,{method:"GET",mode:"cors",headers:{Accept:"application/json"}})).json()}toGaussians(){var n;let t={format:"binary_little_endian",version:"1.0"},e={},i=0;if(e.x={dtype:"float",index:i},i++,e.y={dtype:"float",index:i},i++,e.z={dtype:"float",index:i},i++,e.f_dc_0={dtype:"float",index:i},i++,e.f_dc_1={dtype:"float",index:i},i++,e.f_dc_2={dtype:"float",index:i},i++,this.harmonics&&this.harmonics.length>0)for(let s=0;s<this.harmonics.length;s++)e[`f_rest_${s}`]={dtype:"float",index:i},i++,e[`f_rest_${s+1}`]={dtype:"float",index:i},i++,e[`f_rest_${s+2}`]={dtype:"float",index:i},i++;e.opacity={dtype:"float",index:i},i++,e.scale_0={dtype:"float",index:i},i++,e.scale_1={dtype:"float",index:i},i++,e.scale_2={dtype:"float",index:i},i++,e.rot_0={dtype:"float",index:i},i++,e.rot_1={dtype:"float",index:i},i++,e.rot_2={dtype:"float",index:i},i++,e.rot_3={dtype:"float",index:i},i++;let r=(n=this.harmonics)==null?void 0:n.map(s=>s.denormDequant());return new Lf(e,t,this.xyz.length,this.xyz.denormDequant(),this.color.denormDequant(),r||[],this.opacity.denormDequant(),this.scaling.denormDequant(),this.quaternion.denormDequant(),3)}},Zg=qn(W1()),dl=qn(q1()),IW={xyz:3,color:3,opacity:1,scaling:3,quaternion:4,harmonics:3},PO=class{constructor(t){this._buffer=t}get buffer(){return this._buffer}get decoded(){return this._decoded||(this._decoded=this.decodeBuffer()),this._decoded}get colorsA(){let t=.28209479177387814,e=this.decoded.color.denormDequant(),i=this.decoded.opacity.denormDequant(),r=(0,Zg.default)(new Float32Array(e.shape[0]*4),[e.shape[0],4]);return dl.mulseq(e,t),dl.addseq(e,.5),dl.mulseq(e,255),dl.maxseq(e,0),dl.minseq(e,255),dl.negeq(i),dl.expeq(i),dl.addseq(i,1),dl.recipeq(i),dl.mulseq(i,255),dl.assign(r.hi(e.shape[0],3).lo(0,0),e),dl.assign(r.hi(e.shape[0],4).lo(0,3),i),(0,Zg.default)(new Uint8Array(r.data),[e.shape[0],4]).data}get nsplats(){return this.decoded.nsplats}getSplatCount(){return this.decoded.nsplats}get precomputedCovarianceBufferData(){return this._precomputedCovarianceBufferData}decodeBuffer(){let{splatCount:t,chunkCount:e,chunkSize:i,typeChunks:r,vertexData:n,propertiesDesc:s}=this.decodeHeader(),o={xyz:s.xyz.compressionMethod,color:s.color.compressionMethod,opacity:s.opacity.compressionMethod,scaling:s.scaling.compressionMethod,quaternion:s.quaternion.compressionMethod,chunkSize:i};s.harmonics_0&&(o.harmonics=s.harmonics_0.compressionMethod);let a=n.byteOffset,l=Array(Object.keys(s).length);for(let g in s)l[s[g].index]={name:g,method:s[g].compressionMethod};let u=e*2*4,c=a,h=r==="dynamic"?e*2:0,d,p=!1;if(h>0){let g=new Uint16Array(n.buffer.slice(c,c+h));c+=h,d=Array.from(g),p=!0}let f={};for(let g of l){let y=0,v=!0;if(g.method==="norm8x")y=t*1*IW[g.name];else if(g.method==="norm11")y=t*4;else if(g.method==="norm565")y=t*2;else throw v=!1,new Error(`Not Implemented format: ${g.method}`);let b;if(v){let S=n.buffer.slice(c,c+u);b=(0,Zg.default)(new Float32Array(S),[e,2]),c+=u}else throw new Error("loading chunk byt hasnot minmax!");let _=n.buffer.slice(c,c+y);c+=y;let A;if(g.method==="norm8x")A=(0,Zg.default)(new Uint8Array(_),[t,IW[g.name]]);else if(g.method==="norm11")A=(0,Zg.default)(new Uint32Array(_));else if(g.method==="norm565")A=(0,Zg.default)(new Uint16Array(_));else throw new Error(`Not Implemented format: ${g.method}`);f[g.name]=new tn(A,b,i,g.method,d,p)}let m=[];for(let g=0;g<15;g++){let y=f[`harmonics_${g}`];y&&(m.push(y),delete f[`harmonics_${g}`])}return m.length>0&&(f.harmonics=m),new CO(o,f.xyz,f.scaling,f.color,f.opacity,f.quaternion,f.harmonics,d)}buildPreComputedBuffers(){let t=this.decoded,e=t.nsplats,i=new ArrayBuffer(24*e),r=new Float32Array(i),n=t.scaling.denormDequant(),s=t.quaternion.denormDequant(),o=new ni,a=new wn,l=new wn,u=new wn,c=new lt;for(let h=0;h<e;h++){c.makeScale(Math.exp(n.get(h,0)),Math.exp(n.get(h,1)),Math.exp(n.get(h,2))),l.setFromMatrix4(c),o.set(s.get(h,0),s.get(h,1),s.get(h,2),s.get(h,3)),c.makeRotationFromQuaternion(o),a.setFromMatrix4(c),u.copy(a).multiply(l);let d=u.elements;r[6*h]=d[0]*d[0]+d[3]*d[3]+d[6]*d[6],r[6*h+1]=d[0]*d[1]+d[3]*d[4]+d[6]*d[7],r[6*h+2]=d[0]*d[2]+d[3]*d[5]+d[6]*d[8],r[6*h+3]=d[1]*d[1]+d[4]*d[4]+d[7]*d[7],r[6*h+4]=d[1]*d[2]+d[4]*d[5]+d[7]*d[8],r[6*h+5]=d[2]*d[2]+d[5]*d[5]+d[8]*d[8]}this._precomputedCovarianceBufferData=i}decodeHeader(){let t=this._buffer,e=new TextDecoder,i=0,r="",n=100;for(;;){if(i+n>=t.byteLength)throw new Error("End of file reached while searching for end of header");let f=new Uint8Array(t,i,n);r+=e.decode(f),i+=n;let m=i-n*2,g=new Uint8Array(t,Math.max(0,m),m>=0?n*2:n);if(e.decode(g).includes("end_header"))break}let s=r.split(`
`),o=0,a=0,l=0,u=0,c="",h={};for(let f=0;f<s.length;f++){let m=s[f].trim();if(m.startsWith("element vertex")){let g=m.match(/\d+/);g&&(o=parseInt(g[0]))}else if(m.startsWith("property")){let g=m.match(/(\w+)\s+(\w+)\s+(\w+)/);if(g){let y=g[2],v=g[3];h[y]={compressionMethod:v,index:u},u++}}else if(m.startsWith("element chunks")){let g=m.match(/\d+/);g&&(a=parseInt(g[0]))}else if(m.startsWith("element chunkSize")){let g=m.match(/\d+/);g&&(l=parseInt(g[0]))}else if(m.startsWith("element typeChunks")){let g=m.match(/(\w+)\s+(\w+)\s+(\w+)/);g&&(c=g[3])}else if(m==="end_header")break}let d=r.indexOf("end_header")+10+1,p=new DataView(t,d);return{splatCount:o,chunkCount:a,chunkSize:l,typeChunks:c,vertexData:p,propertiesDesc:h}}pruneSplats(t){let e=this.decodeBuffer().pruneSplats(t);return PO.fromCompressedGaussianSplats(e)}static fromCompressedGaussianSplats(t){let e=t.xyz.length,i=t.xyz.nchunks,r=`gspline
element vertex ${e}
element chunks ${i}
element chunkSize ${t.chunkSize}
element typeChunks ${t.isDynamicChunks?"dynamic":"static"}
property xyz ${t.xyz.method}
property color ${t.color.method}
property opacity ${t.opacity.method}
property scaling ${t.scaling.method}
property quaternion ${t.quaternion.method}`;if(t.harmonics&&t.harmonics.length>0)for(let E=0;E<t.harmonics.length;E++)r=`${r}
property harmonics_${E} ${t.harmonics[E].method}`;r=`${r}
end_header
`;let n=new TextEncoder().encode(r),s=i*2*4,o=t.xyz.quantized.data.buffer.byteLength,a=t.xyz instanceof tn?s:0,l=t.color.quantized.data.buffer.byteLength,u=t.color instanceof tn?s:0,c=t.opacity.quantized.data.buffer.byteLength,h=t.opacity instanceof tn?s:0,d=t.scaling.quantized.data.buffer.byteLength,p=t.scaling instanceof tn?s:0,f=t.quaternion.quantized.data.buffer.byteLength,m=t.quaternion instanceof tn?s:0,g=t.variableChunkSize?Uint16Array.from(t.variableChunkSize):void 0,y=g?g.byteLength:0,v=n.byteLength+y+o+a+l+u+c+h+d+p+f+m,b=0,_=0;if(t.harmonics&&t.harmonics.length>0)for(let E=0;E<t.harmonics.length;E++)b+=t.harmonics[E].quantized.data.buffer.byteLength,_+=t.harmonics[E]instanceof tn?s:0;b=0,_=0,v+=b+_;let A=new Uint8Array(v),S=0;if(A.set(n,S),S+=n.byteLength,y>0&&(A.set(new Uint8Array(g.buffer),S),S+=y),t.xyz instanceof tn&&(A.set(new Uint8Array(t.xyz.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(t.xyz.quantized.data.buffer),S),S+=o,t.color instanceof tn&&(A.set(new Uint8Array(t.color.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(t.color.quantized.data.buffer),S),S+=l,t.opacity instanceof tn&&(A.set(new Uint8Array(t.opacity.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(t.opacity.quantized.data.buffer),S),S+=c,t.scaling instanceof tn&&(A.set(new Uint8Array(t.scaling.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(t.scaling.quantized.data.buffer),S),S+=d,t.quaternion instanceof tn&&(A.set(new Uint8Array(t.quaternion.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(t.quaternion.quantized.data.buffer),S),S+=f,b>0&&t.harmonics&&t.harmonics.length>0)for(let E=0;E<t.harmonics.length;E++){let M=t.harmonics[E];M instanceof tn&&(A.set(new Uint8Array(M.minmaxMatrix.data.buffer),S),S+=s),A.set(new Uint8Array(M.quantized.data.buffer),S),S+=M.quantized.data.byteLength}return new PO(A.buffer)}},L3e="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",gp=class{};Io(gp,"DepthMapRange",65536),Io(gp,"MemoryPageSize",65536),Io(gp,"BytesPerFloat",4),Io(gp,"BytesPerInt",4);function B3e(t){let e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g;function y(T){let L=new Float64Array(c,o,16);for(let D=0;D<16;D++)L[D]=T[D];let I;if(r>1){e.exports.sortIndexes(n,s,u,o,a,l,d.DepthMapRange,r);let D=new Uint32Array(r);I=D.buffer,D.set(new Uint32Array(c,l,r))}else if(r===1){let D=new Uint32Array(r);D[0]=new Uint32Array(c,n,i)[0],I=D.buffer}else I=new ArrayBuffer(0);t.postMessage({sortDone:!0,indexesBuffer:I},[I])}function v(T,L,I){let D=new Float32Array(c,s,i*3);r=0;let F=new Uint32Array(c,n,i);for(let H=0;H<I.length-1;H++){let z=L[H],B=T[H].elements,j=z.filter(q=>q.enabled&&q.mode==="Include").map(q=>q.type==="Box"?S(q):R(q)),V=z.filter(q=>q.enabled&&q.mode==="Exclude").map(q=>q.type==="Box"?S(q):R(q));for(let q=I[H];q<I[H+1];q++){let K=p[q*3],le=p[q*3+1],Z=p[q*3+2];if((j.length===0||_(K,le,Z,j))&&(V.length===0||!_(K,le,Z,V))){let oe=1/(B[3]*K+B[7]*le+B[11]*Z+B[15]);D[r*3]=(B[0]*K+B[4]*le+B[8]*Z+B[12])*oe,D[r*3+1]=(B[1]*K+B[5]*le+B[9]*Z+B[13])*oe,D[r*3+2]=(B[2]*K+B[6]*le+B[10]*Z+B[14])*oe,F[r]=q,r++}}}}function b(T,L){let I=[],D=L.filter(z=>z.enabled&&z.mode==="Include").map(z=>z.type==="Box"?S(z):R(z)),F=L.filter(z=>z.enabled&&z.mode==="Exclude").map(z=>z.type==="Box"?S(z):R(z)),H=T.length;for(let z=0;z<H;z+=3){let B=T[z],j=T[z+1],V=T[z+2];(D.length===0||_(B,j,V,D))&&(F.length===0||!_(B,j,V,F))||I.push(z/3)}return console.log(I),I}function _(T,L,I,D,F){return D[F==="Intersect"?"every":"some"](H=>{let z=A(T,L,I,H.invRotationMatrix,H.cropCenter);return Array.isArray(H)?M(z.x,z.y,z.z,H):C(z.x,z.y,z.z,H)})}function A(T,L,I,D,F){let H=T-F[0],z=L-F[1],B=I-F[2],j=1/(D[3]*H+D[7]*z+D[11]*B+D[15]);return{x:(D[0]*H+D[4]*z+D[8]*B+D[12])*j+F[0],y:(D[1]*H+D[5]*z+D[9]*B+D[13])*j+F[1],z:(D[2]*H+D[6]*z+D[10]*B+D[14])*j+F[2]}}function S(T){let L=T.cropSize[0]/2,I=T.cropSize[1]/2,D=T.cropSize[2]/2,F=[T.cropCenter[0]-L,T.cropCenter[1]-I,T.cropCenter[2]-D,T.cropCenter[0]+L,T.cropCenter[1]+I,T.cropCenter[2]+D],H=E(T.cropRotation);return Object.assign(F,{invRotationMatrix:H,cropCenter:T.cropCenter})}function E(T){let L=[],I=T[0]*Math.PI/180,D=T[1]*Math.PI/180,F=T[2]*Math.PI/180,H=Math.cos(I),z=Math.sin(I),B=Math.cos(D),j=Math.sin(D),V=Math.cos(F),q=Math.sin(F),K=H*V,le=H*q,Z=z*V,oe=z*q;return L[0]=B*V,L[1]=-B*q,L[2]=j,L[4]=le+Z*j,L[5]=K-oe*j,L[6]=-z*B,L[8]=oe-K*j,L[9]=Z+le*j,L[10]=H*B,L[12]=0,L[13]=0,L[14]=0,L[3]=0,L[7]=0,L[11]=0,L[15]=1,L}function M(T,L,I,D){return T>=D[0]&&T<=D[3]&&L>=D[1]&&L<=D[4]&&I>=D[2]&&I<=D[5]}function R(T){let L=2/T.cropSize[0],I=2/T.cropSize[1],D=2/T.cropSize[2],F=E(T.cropRotation);return{invRadiusX:L,invRadiusY:I,invRadiusZ:D,cropCenter:T.cropCenter,invRotationMatrix:F}}function C(T,L,I,D){let F=(T-D.cropCenter[0])*D.invRadiusX,H=(L-D.cropCenter[1])*D.invRadiusY,z=(I-D.cropCenter[2])*D.invRadiusZ;return F*F+H*H+z*z<=1}t.onmessage=T=>{if(T.data.getCroppedIndexes){let L=new Uint32Array(b(new Float32Array(T.data.positions),T.data.crops)).buffer;t.postMessage({outOfBoundsIndexes:L},[L])}else if(T.data.positions)h=T.data.positions,p=new Float32Array(h),m=T.data.meshMatrixWorlds,g=T.data.cropsArray,f=T.data.meshIndexIntervals,v(m,g,f),t.postMessage({sortSetupComplete:!0});else if(T.data.sort||T.data.newMatrixWorlds||T.data.newCropsArray)(T.data.newMatrixWorlds||T.data.newCropsArray)&&(g=T.data.newCropsArray||g,m=T.data.newMatrixWorlds||m,v(m,g,f)),y(T.data.sort.view,T.data.sort.cameraPosition);else if(T.data.init){d=T.data.init.Constants,i=T.data.init.splatCount;let L=d.BytesPerInt,I=d.BytesPerFloat*3,D=new Uint8Array(T.data.init.sorterWasmBytes),F=L+I,H=i*F,z=i*d.BytesPerInt*2+d.DepthMapRange*d.BytesPerInt*2,B=d.MemoryPageSize*32,j=H+z+B,V=Math.floor(j/d.MemoryPageSize)+1,q={module:{},env:{memory:new WebAssembly.Memory({initial:V*2,maximum:V*3,shared:!0})}};WebAssembly.compile(D).then(K=>WebAssembly.instantiate(K,q)).then(K=>{e=K,n=0,s=i*L,o=s+i*I,u=o+16*d.BytesPerFloat*2,a=u+i*d.BytesPerInt,l=a+d.DepthMapRange*d.BytesPerInt,c=q.env.memory.buffer,t.postMessage({sortSetupPhase1Complete:!0})})}}}function O3e(t){let e=new Worker(URL.createObjectURL(new Blob(["(",B3e.toString(),")(self)"],{type:"application/javascript"}))),i=atob(L3e),r=new Uint8Array(i.length);for(let n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return e.postMessage({init:{sorterWasmBytes:r.buffer,splatCount:t,Constants:{BytesPerFloat:gp.BytesPerFloat,BytesPerInt:gp.BytesPerInt,DepthMapRange:gp.DepthMapRange,MemoryPageSize:gp.MemoryPageSize}}}),e}var g3=function(){let t=new Float32Array(1),e=new Int32Array(t.buffer);return function(i){return t[0]=i,e[0]}}(),U3e=function(t,e,i,r){return t+(e<<8)+(i<<16)+(r<<24)},tE=new me,OM=class extends zn{constructor(t,e,i,r,n=!1,s=1,o,a){super(i,r),this.splatCount=e,this.meshIndexIntervals=o,this.meshMatrixWorlds=a,this.splatBuffers=t,this.geometry=i,this.material=r,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(t,e,i=!1,r=1,n,s){let o=OM.buildGeomtery(e),a=OM.buildMaterial(n);return new OM(t,e,o,a,i,r,n,s)}static buildMaterial(t){let e=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,i=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,r={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:t},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new me},viewport:{type:"v2",value:new me},basisViewport:{type:"v2",value:new me},debugColor:{type:"v3",value:new Xt},covariancesTextureSize:{type:"v2",value:new me(1024,1024)},centersColorsTextureSize:{type:"v2",value:new me(1024,1024)},orthoZoom:{type:"f",value:-1}};return new er({uniforms:r,vertexShader:e,fragmentShader:i,transparent:!0,alphaTest:1,blending:cm,depthTest:!0,depthWrite:!1,side:fa})}static buildGeomtery(t){let e=new Ht;e.setIndex([0,1,2,0,2,3]);let i=new Float32Array(4*3),r=new ei(i,3);e.setAttribute("position",r),r.setXYZ(0,-1,-1,0),r.setXYZ(1,-1,1,0),r.setXYZ(2,1,1,0),r.setXYZ(3,1,-1,0),r.needsUpdate=!0;let n=new eZ().copy(e),s=new Uint32Array(t),o=new qw(s,1,!1);return o.setUsage(yde),n.setAttribute("splatIndex",o),n.instanceCount=t,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(r=>r.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let t=0,e=0,i=0;for(let r of this.splatBuffers){let n=r.nsplats;this.colors.subarray(t,t+n*4).set(r.colorsA),t+=n*4,this.centers.subarray(e,e+n*3).set(r.decoded.xyz.denormDequant().data),e+=n*3,this.covariances.subarray(i,i+n*6).set(new Float32Array(r.precomputedCovarianceBufferData)),i+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let t=this.splatCount,e=new me(4096,1024);for(;e.x*e.y*2<t*6;)e.y*=2;let i=new me(4096,1024);for(;i.x*i.y*4<t*4;)i.y*=2;let r,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(e.x*e.y*2);for(let c=0;c<this.covariances.length;c++)n[c]=Xve.toHalfFloat(this.covariances[c]);r=new Dl(n,e.x,e.y,zC,Im)}else n=new Float32Array(e.x*e.y*2),n.set(this.covariances),r=new Dl(n,e.x,e.y,zC,Fn);r.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=r,this.material.uniforms.covariancesTextureSize.value.copy(e);let s=new Uint32Array(i.x*i.y*4);for(let c=0;c<t;c++){let h=c*4,d=c*3,p=c*4;s[p]=U3e(this.colors[h],this.colors[h+1],this.colors[h+2],this.colors[h+3]),s[p+1]=g3(this.centers[d]),s[p+2]=g3(this.centers[d+1]),s[p+3]=g3(this.centers[d+2])}let o=new Dl(s,i.x,i.y,yQ,Uc);o.internalFormat="RGBA32UI",o.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=o,this.material.uniforms.centersColorsTextureSize.value.copy(i);let a=256*4,l=new Float32Array(256*16);for(let c=0;c<this.meshMatrixWorlds.length;c++)l.set(this.meshMatrixWorlds[c].elements,c*16);let u=new Dl(l,a,1,_s,Fn);u.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=u,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:r,size:e},centerColors:{data:s,texture:o,size:i},meshMatrixWorlds:{data:l,texture:u}}}updateIndexes(t){let e=this.geometry;e.attributes.splatIndex.set(t),e.attributes.splatIndex.needsUpdate=!0,e.instanceCount=t.length}updateUniforms(t,e,i,r){this.splatCount>0&&(tE.set(t.x*this.devicePixelRatio,t.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(tE),this.material.uniforms.basisViewport.value.set(2/tE.x,2/tE.y),this.material.uniforms.focal.value.set(e,i),this.material.uniforms.orthoZoom.value=r,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose())}},N3e=class{constructor(t={}){Io(this,"updateSplatMeshUniforms",function(){let e=new me;return function(){this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(this.renderer.getSize(e),this.cameraFocalLengthX=this.camera.projectionMatrix.elements[0]*this.devicePixelRatio*e.x*.45,this.cameraFocalLengthY=this.camera.projectionMatrix.elements[5]*this.devicePixelRatio*e.y*.45,this.splatMesh.updateUniforms(e,this.cameraFocalLengthX,this.cameraFocalLengthY,this.camera.isPerspectiveCamera?-1:this.camera.zoom*this.devicePixelRatio))}}()),Io(this,"updateView",function(){let e=new lt,i=[],r=new N(0,0,-1),n=new N(0,0,-1),s=new N,o=new N;return function(a=!1){let l=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!a){n.set(0,0,-1).applyQuaternion(this.camera.quaternion);let h=!1,d=!1;if(n.dot(r)<=.95&&(h=!0),o.copy(this.camera.position).sub(s).length()>=1&&(d=!0),!h&&!d&&!l&&!u)return}s.copy(this.camera.position),r.copy(n),e.copy(this.camera.matrixWorld).invert(),e.premultiply(this.camera.perspCamera.projectionMatrix),i[0]=this.camera.position.x,i[1]=this.camera.position.y,i[2]=this.camera.position.z;let c={sort:{view:e.elements,cameraPosition:i,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...l?{newMatrixWorlds:this.meshMatrixWorlds}:{},...u?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=c:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(c))}}()),this.scene=t.scene,this.currentPage=null,this.renderer=t.renderer,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.splatRenderingInitialized=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null}get camera(){return this.scene.activeCamera}reloadSplats(){this.splatRenderingInitialized=!1;let t=this.loadSplat();this.renderer.pipeline.opaquePass.splatViewer=t?this:null}loadSplat(t={}){this.activePage=this.scene.activePage,t.position&&(t.position=new N().fromArray(t.position)),t.orientation&&(t.orientation=new ni().fromArray(t.orientation)),t.halfPrecisionCovariances=!!t.halfPrecisionCovariances;let e=[];if(this.splatEntries=e,this.activePage.traverseEntity(s=>{if(s.data.type==="Splat"){let o=s.visible;s.traverseAncestors(a=>{o&&(o=a.visible)}),o&&e.push(s)}}),this.splatMesh&&this.splatMesh.dispose(),e.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=e.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=e.map(s=>s.matrixWorld.clone()),this.cropsArray=e.map(s=>s.data.crops.map(o=>o.data));let i=e.map(s=>new PO(new Uint8Array(s.data.buffer).buffer)),r=0,n=[0];for(let s of i)r+=s.getSplatCount(),n.push(r);return this.setupSplatMesh(i,r,t.position,t.orientation,t.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(r),!0}updateMatrixWorldsInWorkerIfNeeded(){let t=this.splatDataTextures.meshMatrixWorlds.data;for(let e=0;e<this.meshMatrixWorlds.length;e++)t.set(this.meshMatrixWorlds[e].elements,e*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((e,i)=>e.equals(this.meshMatrixWorldsOld[i]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(e=>e.clone()),!0)}cropsChanged(){let t=!1;return this.splatEntries.forEach((e,i)=>{var r;e.data.crops.forEach((n,s)=>{this.cropsArray[i][s]===void 0?(t=!0,this.cropsArray[i][s]=n.data):Object.entries(n.data).forEach(([o,a])=>{var l;Array.isArray(a)&&a.some((u,c)=>u!==this.cropsArray[i][s][o][c])?(t=!0,this.cropsArray[i][s][o]=a):a!==((l=this.cropsArray[i][s])==null?void 0:l[o])&&(t=!0,this.cropsArray[i][s][o]=a)})}),e.data.crops.length!==((r=this.cropsArray[i])==null?void 0:r.length)&&(this.cropsArray[i].length=e.data.crops.length,t=!0)}),t}setupSplatMesh(t,e,i=new N,r=new ni,n=!1,s=1,o,a){this.splatMesh=OM.buildMesh(t,e,n,s,o,a),this.splatMesh.position.copy(i),this.splatMesh.quaternion.copy(r),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=10,this.updateSplatMeshUniforms(),this.splatRenderCount=e}setupSortWorker(t){this.sortWorker=O3e(t),this.sortWorker.onmessage=e=>{var i;e.data.sortDone?(this.sortRunning=!1,(i=this.splatMesh)==null||i.updateIndexes(new Uint32Array(e.data.indexesBuffer)),this.lastSortTime=e.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):e.data.sortCanceled?this.sortRunning=!1:e.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):e.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.updateView(!0,!0),this.splatRenderingInitialized=!0)}}update(){this.splatRenderingInitialized!==!1&&(this.updateSplatMeshUniforms(),this.updateView())}getSplatMesh(){return this.splatMesh}},TO=new Km;TO.wireframe=!0;var LW=new N,zz=class extends Wc{constructor(t,e){super(),this.data=t,this.sharedAssets=e,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new M3e,this.invisibleObjects=new Bv("jflkdsafjasdifjaslk",{...NB.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(t,e),this.matrixAutoUpdate=!1,this.errorPage=new bs("fdasfa",{...h0.defaultData,name:""},{shared:e,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=_3e(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=w3e(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),i=this.entityIdentityToEntity[e];i&&(t.uuid=i.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}markPenumbraSizeDirty(){for(let t of this.children)t instanceof bs&&(t.penumbraSizeArrayCache=null)}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let i=[],r=e;for(;r!==this;){let n=r;r=r.parent;let s=r.children.indexOf(n);i.splice(0,0,s)}return{entity:e,sortKey:i}}getAllSorted(t){let e=[];for(let i of t){let r=this.getWithSortKey(i.id);r!==void 0&&e.push(r)}return e.sort((i,r)=>GZ(i.sortKey,r.sortKey)),e.map(i=>i.entity)}nonExistOrDescendantOf(t,e){let i=this.find(t);if(i===void 0)return!0;for(;i;){if(i.uuid===e)return!0;i=i.parent}return!1}find(t){if(this.activePage&&this.activePage.personalCamera.parent){if(t==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(t===X0)return this.activePage.personalCamera}if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}find2D(t){for(let e of this.children)if(e instanceof bs&&e.uiScene){let i=e.uiScene.find(t);if(i)return i}}findScene2DfromObject2D(t){for(let e of this.children)if(e instanceof bs&&e.uiScene&&e.uiScene.find(t))return e.uiScene}find2DInUIObjects(t){let e;return this.traverseEntity(i=>{e===void 0&&i instanceof ho&&(e=i.uiCanvas.find(t))}),e}traverse2D(t){for(let e of this.children)e instanceof bs&&e.uiScene&&e.uiScene.traverse(t)}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateByLibOp(t,e){t.path.length===1&&t.path[0]==="components"&&t.type===1&&this.createChildrenObjects([{...t.data.asset,id:t.id}],this.invisibleObjects,e)}updateTreeByOp(t,e){var i;if(t.path.length===0&&t.type===7){let r=t.parent===null?this:this.find(t.parent);if(r===void 0)throw new Error("unexpected");let n=this.createObject(t.id,t.data,t.children,r,t.localIndex,e);n.updateVisible(this),n.resetBBoxNeedsUpdate(),fu(n)&&zc(n.parent)&&(n.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markToExpandCloner(n),this.markPenumbraSizeDirty(),n.updatePathSnapping()}else if(t.path.length===0&&t.type===8){let r=this.find(t.id);if(r===void 0)throw new Error("unexpected");this.markToExpandCloner(r),r.resetBBoxNeedsUpdate(),this.unregisterObject(r);let n=r.parent;this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markPenumbraSizeDirty(),r.parent.remove(r),zc(r.parent)&&(r.parent.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),fu(r)&&(r.freeBooleanPointer(),n instanceof Fm&&n.invalidateDownstreamBooleanData().recomputeBoolean()),r instanceof Uz&&r.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),this.pathConstraints.removeDependencies(r.uuid),r.updatePathSnapping()}else if(t.path.length===0&&t.type===9){let r=this.find(t.id);if(r===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(r);let n=r.parent;this.markNeedsRecomputeInstancesForAncessors(n),(i=r.cloner)==null||i.resetOnMove(),this.markToExpandCloner(r);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(r),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(r),r.invalidateClonerTransform(r),r.updateVisible(this),r.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),fu(r)&&(r.invalidateUpstreamBooleanData(),zc(r.parent)?r.parent.invalidateDownstreamBooleanData().recomputeBoolean():n instanceof Fm&&n.invalidateDownstreamBooleanData().recomputeBoolean()),r.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(t){var e;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let i of this.children)i instanceof bs&&(i.visible=i.uuid===t,i.visible&&(this.activePage=i,this.activePage.onActive(this)));this.activePage!==((e=this.splatViewer)==null?void 0:e.activePage)&&this.reloadSplats()}updateEntityByOp(t,e,i,r){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),"visible"in e.props&&this.markPenumbraSizeDirty(),e.path.includes("overrides")&&"states"in e.props){let{rest:s}=e.props;e={...e,props:s},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let n=this.find(t);if(n)try{x3e(n,e,i,{scene:this,shared:r}),n instanceof po&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}updateEntity2DByOp(t,e,i,r,n,s=[]){t.updateEntityByOp(e,i,r,n),this.traverseEntity(o=>{(o instanceof ho||o instanceof bs)&&(s.includes(o.frameId??"")||o.frameId===e)&&o.updateEntity2DByOp(e,i,r,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(t){this.activePage.switchActiveCamera(t)}isInvisibleObjects(t){return t===this.invisibleObjects||t.hasAnccestor(this.invisibleObjects)}init(t,e){let i=Object.entries(e.data.lib.components).map((r,n)=>({data:r[1].asset.data,children:r[1].asset.children,id:r[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:e}),this.add(this.invisibleObjects),this.createChildrenObjects(i,this.invisibleObjects,e),this.createChildrenObjects(t.objects,this,e),this.updatePage(t.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(e,!0),this.traverseEntity(r=>{r instanceof mo&&r.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){Ti.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{Ti.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,i,r,n,s,o){if(t){let a=r.find(t);a&&a!==r&&n.forInstancesRec(l=>{l.data=t1(l.data,u=>{let c=u.events.data(o.id),h=l.goUp(s);if(h){let d=[...HZ(h.identity),t].join("-"),p=this.entityIdentityToEntity[d];if(p){let f=p.uuid,m=zs.zoom(c,e);m[i]=f}else console.warn("cannot find instance")}}).data})}}rewriteActions(t,e,i,r,n,s){t.forEach(o=>{o.data.type==="Transition"?this.relativeizeInner(o.data.object,[...e,o.id],"object",i,r,n,s):o.data.type==="Animation"&&this.relativeizeInner(o.data.object,[...e,o.id],"object",i,r,n,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof Ov&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,i)=>{e.data.events.forEach(r=>{if(r.data.type==="GameControl"){let n=!1;if(e.forInstancesRec(s=>{s.data=t1(s.data,o=>{s.isInstanceRoot||(o.events.delete(r.id),n=!0)}).data}),n===!1)for(let s of S2.list)this.rewriteActions(r.data.gameActions[s],["gameActions",s],t,e,i,r)}else r.data.type==="Conditional"?(r.data.condition.type==="Distance"?(this.relativeizeInner(r.data.condition.fromObject,["condition"],"fromObject",t,e,i,r),this.relativeizeInner(r.data.condition.toObject,["condition"],"toObject",t,e,i,r)):r.data.condition.type==="State"?this.relativeizeInner(r.data.condition.object,["condition"],"object",t,e,i,r):r.data.condition.type==="Comparison"&&(r.data.condition.lOperand.type==="Property"&&this.relativeizeInner(r.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,i,r),r.data.condition.rOperand.type==="Property"&&this.relativeizeInner(r.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,i,r)),this.rewriteActions(r.data.inActions,["inActions"],t,e,i,r),this.rewriteActions(r.data.outActions,["outActions"],t,e,i,r)):"actions"in r.data&&this.rewriteActions(r.data.actions,["actions"],t,e,i,r)})}),!0})}expandInstances(t,e,i){let r=new Set;this.traverseEntity(n=>{if(n instanceof Ov&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:t,pendingDeletes:r}),e||n.resetBBoxNeedsUpdate(),i&&n.traverseEntity(s=>{i.addClip(s)}),!0});for(let n of r)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),Nz(n)}recomputeInstances(t,e){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof Ov&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(t,!1,e))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let i=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[i]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[i]),e.dispose()})}clearScene(){for(let t of this.children)Ti.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}raycast(t){return this.raycast1(t,!1)}raycast1(t,e){let i=[],r=n=>{for(let s of n.children){let o=s.cloner;if(Ti.is(s)&&!s.raycastLock&&(s.visible||o!=null&&o.object.data.visible))if(e===!0&&s.isInstanceRoot){let a=[];if(t.intersectObject(s,!0,a),a.length){let l=a[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let u=s.matrixWorld.clone().invert();l.point.applyMatrix4(u),i.push(l)}}else(fu(s)||mO(s)&&this.enableHelpers&&s.objectHelper.visible)&&(t.intersectObject(s,!1,i),MO(s,t,i)),r(s)}};return r(this.activePage),i}raycastWithClones(t){let e=[],i=r=>{for(let n of r.children){let s=n.cloner;Ti.is(n)&&(n.visible||s!=null&&s.object.data.visible)&&((fu(n)||mO(n)&&this.enableHelpers&&n.objectHelper.visible)&&(t.intersectObject(n,!1,e),MO(n,t,e,!0)),i(n))}};return i(this),e}forEachEntity(t){for(let e of this.children)Ti.is(e)&&t(e)}traverseConcreteEntity(t){for(let e of this.children)Ti.is(e)&&e.isConcreteEntity&&e.traverseEntity(t)}traverseEntity(t){for(let e of this.children)Ti.is(e)&&e.traverseEntity(t)}updateFont(t,e){this.traverseEntity(i=>{if(i instanceof po&&i.data.type==="Mesh"&&i.data.geometry.type==="TextGeometry"&&i.data.geometry.font===t){let r=i.geometry,n=i.data.geometry;r.updateFont(t,e).then(()=>{r.update(n);let s=i.invalidateDownstreamBooleanData();zc(s)&&s.recomputeBoolean()})}})}traverseObject(t){for(let e of this.children)u1.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)Ti.is(e)&&e.visible&&e.traverseVisibleEntity(t)}dispose(){this.clearScene()}createChildrenObjects(t,e,i){let r=0;for(let n of t)this.createObject(n.id,n.data,n.children,e,r,i),r+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,i,r,n,s){var l;let o={scene:this,shared:s},a=Fz(t,e,o);return a&&(this.entityByUuid[t]=a,r.add(a),r.children.splice(n,0,r.children.pop()),i.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,a,s)),a.updateState(e,o),a instanceof po&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(this),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),e.type==="Empty"&&e.animations&&a.traverseEntity(u=>{let c=u.dataPatched;if(u instanceof po&&c.bones&&c.boneInverses){let h=c.bones.map(f=>this.find(f)),d=c.boneInverses.map(f=>new lt().fromArray(f)),p=new PF(h,d);u.bind(p,u.bindMatrix)}else u.matrixAutoUpdate=!0}),a}getCenter(t){let e=[];for(let r=0,n=t.length;r<n;++r){let{id:s,recursive:o}=t[r],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let i=new Mn;return i.setFromPoints(e),i.getCenter(LW),LW}copyMatrixWorld(t,e){if(t===null){e.identity();return}let i=this.find(t);i?e.copy(i.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var r;if(t===null){e.identity();return}let i=(r=this.find(t))==null?void 0:r.parent;i?e.copy(i.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof qo)if(Array.isArray(e.material))for(let i=0;i<e.material.length;i++)e.material[i]instanceof Fp&&t(e.material[i]);else e.material instanceof Fp&&t(e.material)})}updateViewPlaneSize(t,e,i=!1){this.traverseConcreteEntity(r=>{r instanceof mo&&r.setViewplaneSize(t,e,i)})}initializeSplatViewer(t){this.splatViewer=new N3e({scene:this,renderer:t}),this.reloadSplats()}reloadSplats(){var t;(t=this.splatViewer)==null||t.reloadSplats()}},UM=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return Math.sqrt(i*i+r*r)},F3e=(t,e)=>{let i=e.x-t.x,r=e.y-t.y;return H3e(Math.atan2(r,i))},z3e=(t,e,i)=>{let r={x:0,y:0};return i=RO(i),r.x=t.x-e*Math.cos(i),r.y=t.y-e*Math.sin(i),r},RO=t=>t*(Math.PI/180),H3e=t=>t*(180/Math.PI),G3e=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,y3=new Map,BW=t=>{y3.has(t)&&clearTimeout(y3.get(t)),y3.set(t,setTimeout(t,100))},N2=(t,e,i)=>{let r=e.split(/[ ,]+/g),n;for(let s=0;s<r.length;s+=1)n=r[s],t.addEventListener?t.addEventListener(n,i,!1):t.attachEvent&&t.attachEvent(n,i)},OW=(t,e,i)=>{let r=e.split(/[ ,]+/g),n;for(let s=0;s<r.length;s+=1)n=r[s],t.removeEventListener?t.removeEventListener(n,i):t.detachEvent&&t.detachEvent(n,i)},cte=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),UW=()=>{if(typeof window>"u")return;let t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},kO=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},Hz=(t,e,i)=>{let r=dte(t);for(let n in r)if(r.hasOwnProperty(n))if(typeof e=="string")r[n]=e+" "+i;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+i+", ";r[n]=s.slice(0,-2)}return r},V3e=(t,e)=>{let i=dte(t);for(let r in i)i.hasOwnProperty(r)&&(i[r]=e);return i},dte=t=>{let e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},v3=(t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},j3e=(t,e)=>{let i={};for(let r in t)t.hasOwnProperty(r)&&e.hasOwnProperty(r)?i[r]=e[r]:t.hasOwnProperty(r)&&(i[r]=t[r]);return i},DO=(t,e)=>{if(t.length)for(let i=0,r=t.length;i<r;i+=1)e(t[i]);else e(t)},W3e=(t,e,i)=>({x:Math.min(Math.max(t.x,e.x-i),e.x+i),y:Math.min(Math.max(t.y,e.y-i),e.y+i)});typeof window<"u"&&(pte="ontouchstart"in window,fte=!!window.PointerEvent,mte=!!window.MSPointerEvent);var pte,fte,mte,lx={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},hv,d1={};fte?hv=lx.pointer:mte?hv=lx.MSPointer:pte?(hv=lx.touch,d1=lx.mouse):hv=lx.mouse;function ig(){}ig.prototype.on=function(t,e){var i=this,r=t.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]=i._handlers_[n]||[],i._handlers_[n].push(e);return i};ig.prototype.off=function(t,e){var i=this;return i._handlers_=i._handlers_||{},t===void 0?i._handlers_={}:e===void 0?i._handlers_[t]=null:i._handlers_[t]&&i._handlers_[t].indexOf(e)>=0&&i._handlers_[t].splice(i._handlers_[t].indexOf(e),1),i};ig.prototype.trigger=function(t,e){var i=this,r=t.split(/[ ,]+/g),n;i._handlers_=i._handlers_||{};for(var s=0;s<r.length;s+=1)n=r[s],i._handlers_[n]&&i._handlers_[n].length&&i._handlers_[n].forEach(function(o){o.call(i,{type:n,target:i},e)})};ig.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=j3e(e.options,t))};ig.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},N2(t,hv[e],i._domHandlers_[e]),d1[e]&&N2(t,d1[e],i._domHandlers_[e]),i};ig.prototype.unbindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},OW(t,hv[e],i._domHandlers_[e]),d1[e]&&OW(t,d1[e],i._domHandlers_[e]),delete i._domHandlers_[e],this};var Gz=ig;function os(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=os.id,os.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}os.prototype=new Gz;os.constructor=os;os.id=0;os.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};os.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=V3e("borderRadius","50%"),i=Hz("transition","opacity",t),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},v3(r.el,i),this.options.shape==="circle"&&v3(r.back,e),v3(r.front,e),this.applyStyles(r),this};os.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this};os.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};os.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};os.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};os.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};os.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var i=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=i,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){let i=e.options.restJoystick,r={};r.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,r.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,r)}return e};os.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var r=i.options.fadeTime+"ms",n={};n.front=Hz("transition",["top","left"],r);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(n),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i),i.restCallback()},i.options.fadeTime)};os.prototype.restCallback=function(){var t=this,e={};e.front=Hz("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};os.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};os.prototype.computeDirection=function(t){var e=t.angle.radian,i=Math.PI/4,r=Math.PI/2,n,s,o;if(e>i&&e<i*3&&!t.lockX?n="up":e>-i&&e<=i&&!t.lockY?n="left":e>-i*3&&e<=-i&&!t.lockX?n="down":t.lockY||(n="right"),t.lockY||(e>-r&&e<r?s="left":s="right"),t.lockX||(e>0?o="up":o="down"),t.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var u={};this.direction={x:s,y:o,angle:n},t.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(u[l]=!0);if(u.x&&u.y&&u.angle)return t;(!u.x||!u.y)&&this.trigger("plain",t),u.x||this.trigger("plain:"+s,t),u.y||this.trigger("plain:"+o,t),u.angle||this.trigger("dir dir:"+n,t)}else this.resetDirection();return t};var q3e=os;function Cn(t,e){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=t,i.id=Cn.id,Cn.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(e),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let r=getComputedStyle(i.options.zone.parentElement);return r&&r.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}Cn.prototype=new Gz;Cn.constructor=Cn;Cn.id=0;Cn.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(i){if(i===void 0)return e[0];for(var r=0,n=e.length;r<n;r+=1)if(e[r].identifier===i)return e[r];return!1}};Cn.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};Cn.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var i=t.createNipple(e.position,t.manager.getIdentifier());i.add(),t.idles.push(i)}};Cn.prototype.createNipple=function(t,e){var i=this,r=i.manager.scroll,n={},s=i.options,o={x:i.parentIsFlex?r.x:r.x+i.box.left,y:i.parentIsFlex?r.y:r.y+i.box.top};if(t.x&&t.y)n={x:t.x-o.x,y:t.y-o.y};else if(t.top||t.right||t.bottom||t.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=t.top,a.style.right=t.right,a.style.bottom=t.bottom,a.style.left=t.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),n=t,t={x:l.left+r.x,y:l.top+r.y}}var u=new q3e(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:t,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(kO(u.ui.el,n),kO(u.ui.front,u.frontPosition)),i.nipples.push(u),i.trigger("added "+u.identifier+":added",u),i.manager.trigger("added "+u.identifier+":added",u),i.bindNipple(u),u};Cn.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};Cn.prototype.bindNipple=function(t){var e=this,i,r=function(n,s){i=n.type+" "+s.id+":"+n.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",r),t.on("dir:up dir:right dir:down dir:left",r),t.on("plain:up plain:right plain:down plain:left",r)};Cn.prototype.pressureFn=function(t,e,i){var r=this,n=0;clearInterval(r.pressureIntervals[i]),r.pressureIntervals[i]=setInterval((function(){var s=t.force||t.pressure||t.webkitForce||0;s!==n&&(e.trigger("pressure",s),r.trigger("pressure "+e.identifier+":pressure",s),n=s)}).bind(r),100)};Cn.prototype.onstart=function(t){var e=this,i=e.options,r=t;t=cte(t),e.updateBox();var n=function(s){e.actives.length<i.maxNumberOfNipples?e.processOnStart(s):r.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(r.touches).findIndex(function(l){return l.identifier===o})<0){var a=[t[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(s))};return DO(t,n),e.manager.bindDocument(),!1};Cn.prototype.processOnStart=function(t){var e=this,i=e.options,r,n=e.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,o={x:t.pageX,y:t.pageY},a=e.getOrCreate(n,o);a.identifier!==n&&e.manager.removeIdentifier(a.identifier),a.identifier=n;var l=function(c){c.trigger("start",c),e.trigger("start "+c.id+":start",c),c.show(),s>0&&e.pressureFn(t,c,c.identifier),e.processOnMove(t)};if((r=e.idles.indexOf(a))>=0&&e.idles.splice(r,1),e.actives.push(a),e.ids.push(a.identifier),i.mode!=="semi")l(a);else{var u=UM(o,a.position);if(u<=i.catchDistance)l(a);else{a.destroy(),e.processOnStart(t);return}}return a};Cn.prototype.getOrCreate=function(t,e){var i=this,r=i.options,n;return/(semi|static)/.test(r.mode)?(n=i.idles[0],n?(i.idles.splice(0,1),n):r.mode==="semi"?i.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(n=i.createNipple(e,t),n)};Cn.prototype.processOnMove=function(t){var e=this,i=e.options,r=e.manager.getIdentifier(t),n=e.nipples.get(r),s=e.manager.scroll;if(!G3e(t)){this.processOnEnd(t);return}if(!n){console.error("Found zombie joystick with ID "+r),e.manager.removeIdentifier(r);return}if(i.dynamicPage){var o=n.el.getBoundingClientRect();n.position={x:s.x+o.left,y:s.y+o.top}}n.identifier=r;var a=n.options.size/2,l={x:t.pageX,y:t.pageY};i.lockX&&(l.y=n.position.y),i.lockY&&(l.x=n.position.x);var u=UM(l,n.position),c=F3e(l,n.position),h=RO(c),d=u/a,p={distance:u,position:l},f,m;if(n.options.shape==="circle"?(f=Math.min(u,a),m=z3e(n.position,f,c)):(m=W3e(l,n.position,a),f=UM(m,n.position)),i.follow){if(u>a){let b=l.x-m.x,_=l.y-m.y;n.position.x+=b,n.position.y+=_,n.el.style.top=n.position.y-(e.box.top+s.y)+"px",n.el.style.left=n.position.x-(e.box.left+s.x)+"px",u=UM(l,n.position)}}else l=m,u=f;var g=l.x-n.position.x,y=l.y-n.position.y;n.frontPosition={x:g,y},i.dataOnly||kO(n.ui.front,n.frontPosition);var v={identifier:n.identifier,position:l,force:d,pressure:t.force||t.pressure||t.webkitForce||0,distance:u,angle:{radian:h,degree:c},vector:{x:g/a,y:-y/a},raw:p,instance:n,lockX:i.lockX,lockY:i.lockY};v=n.computeDirection(v),v.angle={radian:RO(180-c),degree:180-c},n.trigger("move",v),e.trigger("move "+n.id+":move",v)};Cn.prototype.processOnEnd=function(t){var e=this,i=e.options,r=e.manager.getIdentifier(t),n=e.nipples.get(r),s=e.manager.removeIdentifier(n.identifier);!n||(i.dataOnly||n.hide(function(){i.mode==="dynamic"&&(n.trigger("removed",n),e.trigger("removed "+n.id+":removed",n),e.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(e.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),e.trigger("end "+n.id+":end",n),e.ids.indexOf(n.identifier)>=0&&e.ids.splice(e.ids.indexOf(n.identifier),1),e.actives.indexOf(n)>=0&&e.actives.splice(e.actives.indexOf(n),1),/(semi|static)/.test(i.mode)?e.idles.push(n):e.nipples.indexOf(n)>=0&&e.nipples.splice(e.nipples.indexOf(n),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[s.id]=s.identifier))};Cn.prototype.onDestroyed=function(t,e){var i=this;i.nipples.indexOf(e)>=0&&i.nipples.splice(i.nipples.indexOf(e),1),i.actives.indexOf(e)>=0&&i.actives.splice(i.actives.indexOf(e),1),i.idles.indexOf(e)>=0&&i.idles.splice(i.idles.indexOf(e),1),i.ids.indexOf(e.identifier)>=0&&i.ids.splice(i.ids.indexOf(e.identifier),1),i.manager.removeIdentifier(e.identifier),i.manager.unbindDocument()};Cn.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(i){i.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};var X3e=Cn;function Ps(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=UW(),e.config(t),e.prepareCollections();var i=function(){var n;e.collections.forEach(function(s){s.forEach(function(o){n=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+n.left,y:e.scroll.y+n.top}})})};if(typeof window>"u")return e.collections;N2(window,"resize",function(){BW(i)});var r=function(){e.scroll=UW()};return N2(window,"scroll",function(){BW(r)}),e.collections}Ps.prototype=new Gz;Ps.constructor=Ps;Ps.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(r){return i=r.get(e),!i}),i}};Ps.prototype.create=function(t){return this.createCollection(t)};Ps.prototype.createCollection=function(t){var e=this,i=new X3e(e,t);return e.bindCollection(i),e.collections.push(i),i};Ps.prototype.bindCollection=function(t){var e=this,i,r=function(n,s){i=n.type+" "+s.id+":"+n.type,e.trigger(i,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",r),t.on("dir:up dir:right dir:down dir:left",r),t.on("plain:up plain:right plain:down plain:left",r)};Ps.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};Ps.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Ps.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Ps.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e};Ps.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};Ps.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};Ps.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};Ps.prototype.onAny=function(t,e){var i=this,r,n="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=cte(e);var s=function(a,l,u){u.ids.indexOf(l)>=0&&(u[n](a),a._found_=!0)},o=function(a){r=i.getIdentifier(a),DO(i.collections,s.bind(null,a,r)),a._found_||i.removeIdentifier(r)};return DO(e,o),!1};Ps.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};Ps.prototype.onDestroyed=function(t,e){var i=this;if(i.collections.indexOf(e)<0)return!1;i.collections.splice(i.collections.indexOf(e),1)};var Y3e=Ps,NW=new Y3e,K3e={create:function(t){return NW.create(t)},factory:NW},gte=new Map,fw=new Map,tm=class{constructor(t,e,i,r){this.data=e;let{audio:n,volume:s,delay:o,loop:a}=e;if(!n)throw new Error("Missing property");let l=typeof n=="string"?r.getAudio(n).src:n.data;this.audioPlayer=new Wx({src:l,volume:s,delay:o,loop:a}),fw.has(i.uuid)?fw.get(i.uuid).push(this):fw.set(i.uuid,[this]),gte.set(t,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},IO=class{constructor(t){this.data=t}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(t){let e=gte.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):e.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(t){let e=fw.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let t=[...fw.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},yte=class{constructor(t,e,i,r,n){if(this.data=e,this.shared=r,this.condition=n,e.interaction==="play")this.interaction=new tm(t,e,i,r);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new IO(e);else throw new Error("Missing property")}dispatchBasic(){if(qr(this.shared,this.condition)===!1)return!1;this.interaction instanceof tm?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(qr(this.shared,this.condition)===!1)return!1;this.interaction instanceof tm?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(t){if(qr(this.shared,this.condition)===!1)return!1;this.interaction instanceof tm&&(t==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},vte=class{constructor(t,e,i,r){this.data=t,this.page=e,this.shared=i,this.condition=r,this.delay=0,this.emission=t.emission,t.delay!==void 0&&(this.delay=t.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop():this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze():this.unFreeze()}start(t=0){if(t){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},this.delay);return}this.particleSystem.start()}stop(){this.particleSystem.stop(),this.clearDelay()}freeze(){this.particleSystem.froze(),this.clearDelay()}unFreeze(){this.particleSystem.unFroze(),this.clearDelay()}reset(){this.particleSystem.reset(),this.clearDelay()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(qr(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze();break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop();break;case"reset":this.reset();break}}dispatchConditional(){if(qr(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.particleSystem.start();break;case"stop":this.particleSystem.stop();break;case"reset":this.particleSystem.reset();break}}dispatchGameControl(t){if(qr(this.shared,this.condition)===!1||!this.particleSystem)return!1;t==="start"?this.particleSystem.start():this.particleSystem.stop()}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},J3e="text/plain",Q3e="us-ascii",FW=(t,e)=>e.some(i=>i instanceof RegExp?i.test(t):i===t),Z3e=(t,{stripHash:e})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!i)throw new Error(`Invalid URL: ${t}`);let{type:r,data:n,hash:s}=i.groups,o=r.split(";");s=e?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),u=[...o.map(c=>{let[h,d=""]=c.split("=").map(p=>p.trim());return h==="charset"&&(d=d.toLowerCase(),d===Q3e)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return a&&u.push("base64"),(u.length>0||l&&l!==J3e)&&u.unshift(l),`data:${u.join(";")},${a?n.trim():n}${s?`#${s}`:""}`};function $3e(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return Z3e(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=t.startsWith("//");!i&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let r=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&r.protocol==="https:"&&(r.protocol="http:"),e.forceHttps&&r.protocol==="http:"&&(r.protocol="https:"),e.stripAuthentication&&(r.username="",r.password=""),e.stripHash?r.hash="":e.stripTextFragment&&(r.hash=r.hash.replace(/#?:~:text.*?$/i,"")),r.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let u=s.exec(r.pathname);if(!u)break;let c=u[0],h=u.index,d=r.pathname.slice(o,h);a+=d.replace(/\/{2,}/g,"/"),a+=c,o=h+c.length}let l=r.pathname.slice(o,r.pathname.length);a+=l.replace(/\/{2,}/g,"/"),r.pathname=a}if(r.pathname)try{r.pathname=decodeURI(r.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=r.pathname.split("/"),o=s[s.length-1];FW(o,e.removeDirectoryIndex)&&(s=s.slice(0,-1),r.pathname=s.slice(1).join("/")+"/")}if(r.hostname&&(r.hostname=r.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(r.hostname)&&(r.hostname=r.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...r.searchParams.keys()])FW(s,e.removeQueryParameters)&&r.searchParams.delete(s);if(e.removeQueryParameters===!0&&(r.search=""),e.sortQueryParameters){r.searchParams.sort();try{r.search=decodeURIComponent(r.search)}catch{}}e.removeTrailingSlash&&(r.pathname=r.pathname.replace(/\/$/,""));let n=t;return t=r.toString(),!e.removeSingleSlash&&r.pathname==="/"&&!n.endsWith("/")&&r.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||r.pathname==="/")&&r.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),i&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var eIe=class{constructor({url:t,context:e},i,r,n){if(this.controlsManager=i,this.shared=r,this.condition=n,!t)throw new Error("Missing property");this.url=t.startsWith("mailto:")?t:$3e(t,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=e??"tab"}dispatch(){var t;if(qr(this.shared,this.condition)===!1)return!1;ez?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(t=this.controlsManager.orbitControls)==null||t.onPointerUp(Qt[0]),vEe())}},bte=class{constructor(t,e,i,r,n){this.data=t,this.page=e,this.controlsManager=i,this.shared=r,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=s=>{var u,c;this.timeoutIdQueue.shift();let o=this.page.scene.find(s);if(o===void 0)return;let a=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=a?(u=o.dataPatched.physics)==null?void 0:u.fusedBody:!0;if(o.cloner){for(let h of o.cloner.children)l?(h.playModeVisible=!1,h.rigidBody&&((c=o.dataPatched.physics)==null?void 0:c.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),a.removeRigidBody(h.rigidBody),h.rigidBody=void 0),h.bvhGeometry&&(h.bvhGeometry=void 0)):this.clone===void 0||this.clone===h?(h.playModeVisible=!1,h.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(h.rigidBody.collider(0).handle),a.removeRigidBody(h.rigidBody),h.rigidBody=void 0)):h.playModeVisible===void 0&&(h.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(o.visible=!1,o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),a.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0))}else o.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(o.rigidBody.collider(0).handle),a.removeRigidBody(o.rigidBody),o.rigidBody=void 0),o.bvhGeometry&&(o.bvhGeometry=void 0),o.visible=!1;a===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(h=>h.rigidBody!==void 0),o.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...t.objects]}dispatch(t){if(qr(this.shared,this.condition)===!1)return!1;this.clone=t,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(qr(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t))}},xte=class{constructor(t,e,i,r,n){this.data=t,this.page=e,this.shared=i,this.eventManager=r,this.condition=n,this.shared=i}dispatch(){if(qr(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var t;this.shared.reset(this.shared.data,!0),$z(this.page,this.shared,!0),this.eventManager.reset(),(t=this.eventManager.controlsManager.gameControl)==null||t.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},wte={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Vz={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},tIe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],F2={CSS:{},springs:{}};function bu(t,e,i){return Math.min(Math.max(t,e),i)}function mw(t,e){return t.indexOf(e)>-1}function b3(t,e){return t.apply(null,e)}var $t={arr:function(t){return Array.isArray(t)},obj:function(t){return mw(Object.prototype.toString.call(t),"Object")},pth:function(t){return $t.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return!("isNode"in t)&&(t.nodeType||$t.svg(t))},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return $t.hex(t)||$t.rgb(t)||$t.hsl(t)},key:function(t){return!wte.hasOwnProperty(t)&&!Vz.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function _te(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(i){return parseFloat(i)}):[]}function Ste(t,e){var i=_te(t),r=bu($t.und(i[0])?1:i[0],.1,100),n=bu($t.und(i[1])?100:i[1],.1,100),s=bu($t.und(i[2])?10:i[2],.1,100),o=bu($t.und(i[3])?0:i[3],.1,100),a=Math.sqrt(n/r),l=s/(2*Math.sqrt(n*r)),u=l<1?a*Math.sqrt(1-l*l):0,c=1,h=l<1?(l*a+-o)/u:-o+a;function d(f){var m=e?e*f/1e3:f;return l<1?m=Math.exp(-m*l*a)*(c*Math.cos(u*m)+h*Math.sin(u*m)):m=(c+h*m)*Math.exp(-m*a),f===0||f===1?f:1-m}function p(){var f=F2.springs[t];if(f)return f;for(var m=1/6,g=0,y=0;;)if(g+=m,d(g)===1){if(y++,y>=16)break}else y=0;var v=g*m*1e3;return F2.springs[t]=v,v}return e?d:p}function iIe(t){return t===void 0&&(t=10),function(e){return Math.ceil(bu(e,1e-6,1)*t)*(1/t)}}var rIe=function(){var t=11,e=1/(t-1);function i(c,h){return 1-3*h+3*c}function r(c,h){return 3*h-6*c}function n(c){return 3*c}function s(c,h,d){return((i(h,d)*c+r(h,d))*c+n(h))*c}function o(c,h,d){return 3*i(h,d)*c*c+2*r(h,d)*c+n(h)}function a(c,h,d,p,f){var m,g,y=0;do g=h+(d-h)/2,m=s(g,p,f)-c,m>0?d=g:h=g;while(Math.abs(m)>1e-7&&++y<10);return g}function l(c,h,d,p){for(var f=0;f<4;++f){var m=o(h,d,p);if(m===0)return h;var g=s(h,d,p)-c;h-=g/m}return h}function u(c,h,d,p){if(!(0<=c&&c<=1&&0<=d&&d<=1))return;var f=new Float32Array(t);if(c!==h||d!==p)for(var m=0;m<t;++m)f[m]=s(m*e,c,d);function g(y){for(var v=0,b=1,_=t-1;b!==_&&f[b]<=y;++b)v+=e;--b;var A=(y-f[b])/(f[b+1]-f[b]),S=v+A*e,E=o(S,c,d);return E>=.001?l(y,S,c,d):E===0?S:a(y,v,v+e,c,d)}return function(y){return c===h&&d===p||y===0||y===1?y:s(g(y),h,p)}}return u}(),Ate=function(){var t={linear:function(){return function(r){return r}}},e={Sine:function(){return function(r){return 1-Math.cos(r*Math.PI/2)}},Circ:function(){return function(r){return 1-Math.sqrt(1-r*r)}},Back:function(){return function(r){return r*r*(3*r-2)}},Bounce:function(){return function(r){for(var n,s=4;r<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-r,2)}},Elastic:function(r,n){r===void 0&&(r=1),n===void 0&&(n=.5);var s=bu(r,1,10),o=bu(n,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(r,n){e[r]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(e).forEach(function(r){var n=e[r];t["easeIn"+r]=n,t["easeOut"+r]=function(s,o){return function(a){return 1-n(s,o)(1-a)}},t["easeInOut"+r]=function(s,o){return function(a){return a<.5?n(s,o)(a*2)/2:1-n(s,o)(a*-2+2)/2}}}),t}();function jz(t,e){if($t.fnc(t))return t;var i=t.split("(")[0],r=Ate[i],n=_te(t);switch(i){case"spring":return Ste(t,e);case"cubicBezier":return b3(rIe,n);case"steps":return b3(iIe,n);default:return b3(r,n)}}function Ete(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function XP(t,e){for(var i=t.length,r=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<i;s++)if(s in t){var o=t[s];e.call(r,o,s,t)&&n.push(o)}return n}function YP(t){return t.reduce(function(e,i){return e.concat($t.arr(i)?YP(i):i)},[])}function zW(t){return $t.arr(t)?t:($t.str(t)&&(t=Ete(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function Wz(t,e){return t.some(function(i){return i===e})}function qz(t){var e={};for(var i in t)e[i]=t[i];return e}function LO(t,e){var i=qz(t);for(var r in t)i[r]=e.hasOwnProperty(r)?e[r]:t[r];return i}function KP(t,e){var i=qz(t);for(var r in e)i[r]=$t.und(t[r])?e[r]:t[r];return i}function nIe(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function sIe(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=t.replace(e,function(a,l,u,c){return l+l+u+u+c+c}),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),n=parseInt(r[1],16),s=parseInt(r[2],16),o=parseInt(r[3],16);return"rgba("+n+","+s+","+o+",1)"}function oIe(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),i=parseInt(e[1],10)/360,r=parseInt(e[2],10)/100,n=parseInt(e[3],10)/100,s=e[4]||1;function o(d,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(p-d)*6*f:f<1/2?p:f<2/3?d+(p-d)*(2/3-f)*6:d}var a,l,u;if(r==0)a=l=u=n;else{var c=n<.5?n*(1+r):n+r-n*r,h=2*n-c;a=o(h,c,i+1/3),l=o(h,c,i),u=o(h,c,i-1/3)}return"rgba("+a*255+","+l*255+","+u*255+","+s+")"}function aIe(t){if($t.rgb(t))return nIe(t);if($t.hex(t))return sIe(t);if($t.hsl(t))return oIe(t)}function Yc(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function lIe(t){if(mw(t,"translate")||t==="perspective")return"px";if(mw(t,"rotate")||mw(t,"skew"))return"deg"}function BO(t,e){return $t.fnc(t)?t(e.target,e.id,e.total):t}function wh(t,e){return t.getAttribute(e)}function Xz(t,e,i){var r=Yc(e);if(Wz([i,"deg","rad","turn"],r))return e;var n=F2.CSS[e+i];if(!$t.und(n))return n;var s=100,o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+i;var l=s/o.offsetWidth;a.removeChild(o);var u=l*parseFloat(e);return F2.CSS[e+i]=u,u}function Mte(t,e,i){if(e in t.style){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=t.style[e]||getComputedStyle(t).getPropertyValue(r)||"0";return i?Xz(t,n,i):n}}function Yz(t,e){if($t.dom(t)&&!$t.inp(t)&&(wh(t,e)||$t.svg(t)&&t[e]))return"attribute";if($t.dom(t)&&Wz(tIe,e))return"transform";if($t.dom(t)&&e!=="transform"&&Mte(t,e))return"css";if(t[e]!=null)return"object"}function Cte(t){if($t.dom(t)){for(var e=t.style.transform||"",i=/(\w+)\(([^)]*)\)/g,r=new Map,n;n=i.exec(e);)r.set(n[1],n[2]);return r}}function uIe(t,e,i,r){var n=mw(e,"scale")?1:0+lIe(e),s=Cte(t).get(e)||n;return i&&(i.transforms.list.set(e,s),i.transforms.last=e),r?Xz(t,s,r):s}function Kz(t,e,i,r){switch(Yz(t,e)){case"transform":return uIe(t,e,r,i);case"css":return Mte(t,e,i);case"attribute":return wh(t,e);default:return t[e]||0}}function Jz(t,e){var i=/^(\*=|\+=|-=)/.exec(t);if(!i)return t;var r=Yc(t)||0,n=parseFloat(e),s=parseFloat(t.replace(i[0],""));switch(i[0][0]){case"+":return n+s+r;case"-":return n-s+r;case"*":return n*s+r}}function Pte(t,e){if($t.col(t))return aIe(t);if(/\s/g.test(t))return t;var i=Yc(t),r=i?t.substr(0,t.length-i.length):t;return e?r+e:r}function Qz(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function hIe(t){return Math.PI*2*wh(t,"r")}function cIe(t){return wh(t,"width")*2+wh(t,"height")*2}function dIe(t){return Qz({x:wh(t,"x1"),y:wh(t,"y1")},{x:wh(t,"x2"),y:wh(t,"y2")})}function Tte(t){for(var e=t.points,i=0,r,n=0;n<e.numberOfItems;n++){var s=e.getItem(n);n>0&&(i+=Qz(r,s)),r=s}return i}function pIe(t){var e=t.points;return Tte(t)+Qz(e.getItem(e.numberOfItems-1),e.getItem(0))}function Rte(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return hIe(t);case"rect":return cIe(t);case"line":return dIe(t);case"polyline":return Tte(t);case"polygon":return pIe(t)}}function fIe(t){var e=Rte(t);return t.setAttribute("stroke-dasharray",e),e}function mIe(t){for(var e=t.parentNode;$t.svg(e)&&$t.svg(e.parentNode);)e=e.parentNode;return e}function kte(t,e){var i=e||{},r=i.el||mIe(t),n=r.getBoundingClientRect(),s=wh(r,"viewBox"),o=n.width,a=n.height,l=i.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:r,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function gIe(t,e){var i=$t.str(t)?Ete(t)[0]:t,r=e||100;return function(n){return{property:n,el:i,svg:kte(i),totalLength:Rte(i)*(r/100)}}}function yIe(t,e){function i(a){a===void 0&&(a=0);var l=e+a>=1?e+a:0;return t.el.getPointAtLength(l)}var r=kte(t.el,t.svg),n=i(),s=i(-1),o=i(1);switch(t.property){case"x":return(n.x-r.x)*r.w;case"y":return(n.y-r.y)*r.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function HW(t,e){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=Pte($t.pth(t)?t.totalLength:t,e)+"";return{original:r,numbers:r.match(i)?r.match(i).map(Number):[0],strings:$t.str(t)||e?r.split(i):[]}}function Dte(t){var e=t?YP($t.arr(t)?t.map(zW):zW(t)):[];return XP(e,function(i,r,n){return n.indexOf(i)===r})}function Ite(t){var e=Dte(t);return e.map(function(i,r){return{target:i,id:r,total:e.length,transforms:{list:Cte(i)}}})}function vIe(t,e){var i=qz(e);if(/^spring/.test(i.easing)&&(i.duration=Ste(i.easing)),$t.arr(t)){var r=t.length,n=r===2&&!$t.obj(t[0]);n?t={value:t}:$t.fnc(e.duration)||(i.duration=e.duration/r)}var s=$t.arr(t)?t:[t];return s.map(function(o,a){var l=$t.obj(o)&&!$t.pth(o)?o:{value:o};return $t.und(l.delay)&&(l.delay=a?0:e.delay),$t.und(l.endDelay)&&(l.endDelay=a===s.length-1?e.endDelay:0),l}).map(function(o){return KP(o,i)})}function bIe(t){for(var e=XP(YP(t.map(function(s){return Object.keys(s)})),function(s){return $t.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),i={},r=function(s){var o=e[s];i[o]=t.map(function(a){var l={};for(var u in a)$t.key(u)?u==o&&(l.value=a[u]):l[u]=a[u];return l})},n=0;n<e.length;n++)r(n);return i}function xIe(t,e){var i=[],r=e.keyframes;r&&(e=KP(bIe(r),e));for(var n in e)$t.key(n)&&i.push({name:n,tweens:vIe(e[n],t)});return i}function wIe(t,e){var i={};for(var r in t){var n=BO(t[r],e);$t.arr(n)&&(n=n.map(function(s){return BO(s,e)}),n.length===1&&(n=n[0])),i[r]=n}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function _Ie(t,e){var i;return t.tweens.map(function(r){var n=wIe(r,e),s=n.value,o=$t.arr(s)?s[1]:s,a=Yc(o),l=Kz(e.target,t.name,a,e),u=i?i.to.original:l,c=$t.arr(s)?s[0]:u,h=Yc(c)||Yc(l),d=a||h;return $t.und(o)&&(o=u),n.from=HW(c,d),n.to=HW(Jz(o,c),d),n.start=i?i.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=jz(n.easing,n.duration),n.isPath=$t.pth(s),n.isColor=$t.col(n.from.original),n.isColor&&(n.round=1),i=n,n})}var Lte={css:function(t,e,i){return t.style[e]=i},attribute:function(t,e,i){return t.setAttribute(e,i)},object:function(t,e,i){return t[e]=i},transform:function(t,e,i,r,n){if(r.list.set(e,i),e===r.last||n){var s="";r.list.forEach(function(o,a){s+=a+"("+o+") "}),t.style.transform=s}}};function Bte(t,e){var i=Ite(t);i.forEach(function(r){for(var n in e){var s=BO(e[n],r),o=r.target,a=Yc(s),l=Kz(o,n,a,r),u=a||Yc(l),c=Jz(Pte(s,u),l),h=Yz(o,n);Lte[h](o,n,c,r.transforms,!0)}})}function SIe(t,e){var i=Yz(t.target,e.name);if(i){var r=_Ie(e,t),n=r[r.length-1];return{type:i,property:e.name,animatable:t,tweens:r,duration:n.end,delay:r[0].delay,endDelay:n.endDelay}}}function AIe(t,e){return XP(YP(t.map(function(i){return e.map(function(r){return SIe(i,r)})})),function(i){return!$t.und(i)})}function Ote(t,e){var i=t.length,r=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=i?Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return r(s)+o+a+l+s.duration*(s.loop??1)})):e.duration,n.delay=i?Math.min.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return r(s)+o+a+s.delay})):e.delay,n.endDelay=i?n.duration-Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return r(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):e.endDelay,n}var GW=0;function EIe(t){var e=LO(wte,t),i=LO(Vz,t),r=xIe(i,t),n=Ite(t.targets),s=AIe(n,r),o=Ote(s,i),a=GW;return GW++,KP(e,{id:a,children:[],animatables:n,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var Ul=[],VW=[],NM,MIe=function(){function t(){NM=requestAnimationFrame(e)}function e(i){var r=Ul.length;if(r){for(var n=0;n<r;){var s=Ul[n];s.paused?(Ul.splice(n,1),r-=1):(s.tick(i),n++)}t()}else NM=cancelAnimationFrame(NM)}return t}();function CIe(t){document.hidden?(Ul.forEach(function(e){return e.pause(t.timeStamp)}),VW=Ul.slice(0),En.running=Ul=[]):VW.forEach(function(e){return e.play(t.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",CIe);function En(t){t===void 0&&(t={});var e=0,i=0,r=0,n,s,o=0,a=null;function l(S){var E=window.Promise&&new Promise(function(M){return a=M});return S.finished=E,E}var u=EIe(t);l(u);function c(){var S=u.direction;S!=="alternate"&&(u.direction=S!=="normal"?"normal":"reverse"),u.reversed=!u.reversed,s.forEach(function(E){(E.loop===1||E.loop%2===0)&&(E.reversed=u.reversed)})}function h(){u.direction="normal",u.reversed=!1,s.forEach(function(S){return S.reversed=!1})}function d(S){return u.reversed?u.duration-S:S}function p(){e=0,i=d(u.currentTime)*(1/En.speed)}function f(S,E,M=!1){E&&(u.reversed?E.seek(E.duration*E.loop-(S-E.timelineOffset-E.pingPongDelayCorrection),M):E.seek(S-E.timelineOffset-E.startOnceDelay-E.pingPongDelayCorrection,M))}function m(S,E=!1){if(u.reversed)for(var M=o;M--;)f(S,s[M],E);else for(var R=0;R<o;R++)f(S,s[R],E)}function g(S){var ve,ye,pe,Se,be,ee,_e,Me,Ce,Re;var E=0,M=u.animations,R=M.length;for(u.direction!=="alternate"&&((ve=u.parent)==null?void 0:ve.direction)==="alternate"?((ye=u.parent)==null?void 0:ye.rewind)===!1&&u.reversePlayback===!0&&u.rewind===!1&&((pe=u.parent)!=null&&pe.reversed&&u.direction==="alternate"?S=u.duration-u.delay+u.endDelay-S:S=u.duration+u.delay-u.endDelay-S):_(!1,(Se=u.parent)==null?void 0:Se.rewind,u.rewind,(be=u.parent)==null?void 0:be.reversePlayback,u.reversePlayback)&&((ee=u.parent)!=null&&ee.reversed&&u.direction==="alternate"?S=u.duration-u.delay+u.endDelay-S:S=u.duration+u.delay-u.endDelay-S);E<R;){var C=M[E],T=C.animatable,L=C.tweens,I=L.length-1,D=L[I];I&&(D=XP(L,function(Oe){return S<Oe.end})[0]||D);let Xe;(_e=u.parent)!=null&&_e.reversed&&u.direction==="alternate"?Xe=bu(S-D.start-D.endDelay,0,D.duration)/D.duration:Xe=bu(S-D.start-D.delay,0,D.duration)/D.duration;for(var F=isNaN(Xe)?1:D.easing(Xe),H=D.to.strings,z=D.round,B=[],j=D.to.numbers.length,V=void 0,q=0;q<j;q++){var K=void 0;let Oe,$;u.direction!=="alternate"?((Me=u.parent)==null?void 0:Me.rewind)===!1&&u.reversePlayback===!0&&u.rewind===!1?(Oe=D.to.numbers[q],$=D.from.numbers[q]||0):($=D.to.numbers[q],Oe=D.from.numbers[q]||0):_(!0,(Ce=u.parent)==null?void 0:Ce.rewind,u.rewind,(Re=u.parent)==null?void 0:Re.reversePlayback,u.reversePlayback)?(Oe=D.to.numbers[q],$=D.from.numbers[q]||0):($=D.to.numbers[q],Oe=D.from.numbers[q]||0),D.isPath?K=yIe(D.value,F*$):K=Oe+F*($-Oe),z&&(D.isColor&&q>2||(K=Math.round(K*z)/z)),B.push(K)}var le=H.length;if(!le)V=B[0];else{V=H[0];for(var Z=0;Z<le;Z++){H[Z];var oe=H[Z+1],ae=B[Z];isNaN(ae)||(oe?V+=ae+oe:V+=ae+" ")}}Lte[C.type](T.target,C.property,V,T.transforms),C.currentValue=V,E++}}function y(S){u[S]&&!u.passThrough&&u[S](u)}function v(){u.remaining&&u.remaining!==!0&&u.remaining--}let b={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function _(S,E,M,R,C){return b[S<<4|E<<3|M<<2|R<<1|C]}function A(S,E=!1){var L;var M=u.duration;let R=u.delay,C=M-u.endDelay;(L=u.parent)!=null&&L.reversed&&u.direction==="alternate"&&(R=u.endDelay,C=M-u.delay);var T=d(S);if(u.progress=bu(T/M*100,0,100),E||(u.reversePlayback=T<u.currentTime),o&&m(T,E),!u.began&&u.currentTime>=0&&(u.began=!0,y("begin")),!u.loopBegan&&u.currentTime>0&&(u.loopBegan=!0,y("loopBegin")),(u.reversed||T>=0)&&T<=R&&u.currentTime!==0&&(g(0),y("change")),(T>=C&&u.currentTime!==M+u.pingPongDelayCorrection||!M)&&(g(M),y("change")),T>R&&T<C?(u.changeBegan||(u.changeBegan=!0,u.changeCompleted=!1,y("changeBegin")),g(T),y("change")):u.changeBegan?(u.changeCompleted=!0,u.changeBegan=!1,y("change"),o&&y("timelineChangeComplete")):u.began&&T>C&&y("changeComplete"),u.currentTime=bu(T,0,M+u.pingPongDelayCorrection),u.began&&y("update"),S>=M)if(v(),!u.remaining)u.paused=!0,u.completed||(u.completed=!0,y("loopComplete"),y("complete"),!u.passThrough&&"Promise"in window&&(a(),l(u)));else{o?e+=u.duration/En.speed:e+=u.duration;for(let I of s)I.setStartTime(0),I.remaining=I.loop;y("loopComplete"),u.loopBegan=!1,u.direction==="alternate"?c():o&&h()}}return u.reset=function(){var S=u.direction;u.passThrough=!1,u.currentTime=0,u.progress=0,u.paused=!0,u.began=!1,u.loopBegan=!1,u.changeBegan=!1,u.completed=!1,u.changeCompleted=!1,u.reversePlayback=!1,u.reversed=S==="reverse",u.remaining=u.loop,s=u.children,o=s.length;for(var E=o;E--;)u.children[E].reset();g(u.reversed?u.duration:0)},u.setStartTime=function(S){e=S},u.set=function(S,E){return Bte(S,E),u},u.tick=function(S){r=S,e||(e=r),A((r+(i-e))*En.speed)},u.seek=function(S,E=!1){A(S-e,E)},u.pause=function(S){u.paused=!0,o&&(n=S??performance.now())},u.play=function(S){!u.paused||(u.completed&&u.reset(),u.paused=!1,Ul.push(u),o&&n!==void 0&&(e+=(S??performance.now())-n),NM||MIe())},u.reverse=function(){c(),u.completed=!u.reversed,p()},u.restart=function(){u.reset(),u.play()},u.reset(),u.autoplay&&u.play(),u}function jW(t,e){for(var i=e.length;i--;)Wz(t,e[i].animatable.target)&&e.splice(i,1)}function PIe(t){for(var e=Dte(t),i=Ul.length;i--;){var r=Ul[i],n=r.animations,s=r.children;jW(e,n);for(var o=s.length;o--;){var a=s[o],l=a.animations;jW(e,l),!l.length&&!a.children.length&&s.splice(o,1)}!n.length&&!s.length&&r.pause()}}function TIe(t,e){e===void 0&&(e={});var i=e.direction||"normal",r=e.easing?jz(e.easing):null,n=e.grid,s=e.axis,o=e.from||0,a=o==="first",l=o==="center",u=o==="last",c=$t.arr(t),h=parseFloat(c?t[0]:t),d=c?parseFloat(t[1]):0,p=Yc(c?t[1]:t)||0,f=e.start||0+(c?h:0),m=[],g=0;return function(y,v,b){if(a&&(o=0),l&&(o=(b-1)/2),u&&(o=b-1),!m.length){for(var _=0;_<b;_++){if(!n)m.push(Math.abs(o-_));else{var A=l?(n[0]-1)/2:o%n[0],S=l?(n[1]-1)/2:Math.floor(o/n[0]),E=_%n[0],M=Math.floor(_/n[0]),R=A-E,C=S-M,T=Math.sqrt(R*R+C*C);s==="x"&&(T=-R),s==="y"&&(T=-C),m.push(T)}g=Math.max.apply(Math,m)}r&&(m=m.map(function(I){return r(I/g)*g})),i==="reverse"&&(m=m.map(function(I){return s?I<0?I*-1:-I:Math.abs(g-I)}))}var L=c?(d-h)/g:h;return f+L*(Math.round(m[v]*100)/100)+p}}function RIe(t){t===void 0&&(t={});var e=En(t);return e.duration=0,e.add=function(i,r){var n=Ul.indexOf(e),s=e.children;n>-1&&Ul.splice(n,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=KP(i,LO(Vz,t));l.targets=l.targets||t.targets;var u=e.duration;l.autoplay=!1,l.timelineOffset=$t.und(r)?u:Jz(r,u),o(e);var c=En(l);o(c),s.push(c),c.parent=e;var h=Ote(s,t);return e.delay=h.delay,e.endDelay=h.endDelay,e.duration=h.duration,c.loop===!0&&(e.duration=1/0),e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}En.version="3.2.0";En.speed=1;En.running=Ul;En.remove=PIe;En.get=Kz;En.set=Bte;En.convertPx=Xz;En.path=gIe;En.setDashoffset=fIe;En.stagger=TIe;En.timeline=RIe;En.easing=jz;En.penner=Ate;En.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var Ute=En,WW=new N,qW=new N,XW=new ni;function kIe(t,e,i,r){if(r===0)return i.copy(t);if(r===1)return i.copy(e);let n=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(n>=1)return i.copy(t);let s=1-n*n;if(s<=Number.EPSILON){let c=1-r;return i.w=c*t.w+r*e.w,i.x=c*t.x+r*e.x,i.y=c*t.y+r*e.y,i.z=c*t.z+r*e.z,i.normalize(),i}let o=Math.sqrt(s),a=Math.atan2(o,n),l=Math.sin((1-r)*a)/o,u=Math.sin(r*a)/o;return i.w=t.w*l+e.w*u,i.x=t.x*l+e.x*u,i.y=t.y*l+e.y*u,i.z=t.z*l+e.z*u,i}function Us(t,e,i,r,n,s){let o=i[t]?i[t]:void 0,a=r[t];if(a==null)return;let l=o!=null?typeof o=="string"?Number(n.getVariable(o)??0):o:e[t],u=typeof a=="string"?Number(n.getVariable(a)??0):a;if(l!==u)return{update:c=>{let h=kt.lerp(l,u,c);s?e[t]=Math.trunc(h):e[t]=h},start:()=>{e[t]=l},end:()=>{e[t]=u}}}function Zz(t,e,i,r,n,s){let o=i[t]?i[t]:void 0,a=r[t];if(!a)return;let l=e[t],u=[...o??l].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h),c=[...a].map(h=>typeof h=="string"?Number(n.getVariable(h)??0):h);if(!(u.length!==c.length||FZ(u,c)))return{update:h=>{u.forEach((d,p)=>{let f=kt.lerp(d,c[p],h);e[t][p]=s?Math.trunc(f):f})},start:()=>{Object.assign(e[t],u)},end:()=>{Object.assign(e[t],c)}}}function z2(t,e,i){return e.forEach((r,n)=>{t.setComponent(n,typeof r=="string"?Number(i.getVariable(r)??0):r)}),t}function YW(t,e,i,r,n){let s=i[t]?i[t]:void 0,o=r[t];if(!o)return;let a=e[t],l=s?z2(new N,s,n):a.clone(),u=z2(new N,o,n);if(!l.equals(u))return{update:c=>{a.lerpVectors(l,u,c)},start:()=>{a.copy(l)},end:()=>{a.copy(u)}}}function KW(t,e,i){return e.forEach((r,n)=>{t.setComponent(n,typeof r=="string"?Number(i.getVariable(r)??0):r)}),t}function H2(t,e,i,r,n){let s=i[t]?i[t]:void 0,o=r[t];if(!o)return;let a=e[t],l=!(a instanceof me),u=a instanceof me?a:new me().fromArray(a),c=s?KW(new me,s,n):u.clone(),h=KW(new me,o,n);if(!c.equals(h))return{update:d=>{u.lerpVectors(c,h,d),l&&(e[t]=u.toArray())},start:()=>{u.copy(c),l&&(e[t]=u.toArray())},end:()=>{u.copy(h),l&&(e[t]=u.toArray())}}}function DIe(t,e,i,r){let n=i[t]?i[t]:void 0,s=r[t];if(!s)return;let o=e[t],a=n?new lt().fromArray(n):o.clone(),l=new N,u=new ni,c=new N;a.decompose(l,u,c);let h=new lt().fromArray(s),d=new N,p=new ni,f=new N;if(h.decompose(d,p,f),!a.equals(h))return{update:m=>{XW.slerpQuaternions(u,p,m),WW.lerpVectors(l,d,m),qW.lerpVectors(c,f,m),o.compose(WW,XW,qW)},start:()=>{o.compose(l,u,c)},end:()=>{o.compose(d,p,f)}}}function IIe(t,e,i,r,n){let s=i[t]?i[t]:void 0,o=r[t];if(!o)return;let a=e[t],l=s?typeof s=="string"?n.getColor(s).clone():new Xt().setRGB(s.r,s.g,s.b):a.clone(),u=typeof o=="string"?n.getColor(o).clone():new Xt().setRGB(o.r,o.g,o.b);if(l.equals(u))return;let c=a.clone();return e[t]=c,{update:h=>{c.lerpColors(l,u,h)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function iE(t,e,i,r,n){let s=i[t]?i[t]:void 0,o=r[t];if(!o)return;let a=e[t],l=new Ws(a.r,a.g,a.b,a.a),u=s?typeof s=="string"?n.getColor(s).clone():new Ws(s.r,s.g,s.b,s.a):l.clone(),c=typeof o=="string"?n.getColor(o).clone():new Ws(o.r,o.g,o.b,o.a);if(!u.equals(c))return{update:h=>{l.lerpColors(u,c,h);let d=kt.lerp(u.a,c.a,h);l.a=d,e[t]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(u)},end:()=>{l.copy(c)}}}function Kp(t,e,i,r,n){if(typeof e[t]=="number")return Us(t,e,i??{},r,n);if(Array.isArray(e[t]))return Zz(t,e,i??{},r,n)}function LIe(t,e,i,r){var a,l,u,c;let n=[],s=t.cameraType==="OrthographicCamera"?(a=e.orthographic)==null?void 0:a.zoom:(l=e.perspective)==null?void 0:l.zoom,o=t.cameraType==="OrthographicCamera"?(u=i.orthographic)==null?void 0:u.zoom:(c=i.perspective)==null?void 0:c.zoom;if(o!==void 0){let h=s??t.zoom,d=o;h!==d&&n.push({update:p=>{t.zoom=kt.lerp(h,d,p),t.updateProjectionMatrix()},start:()=>{t.zoom=h,t.updateProjectionMatrix()},end:()=>{t.zoom=d,t.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let h=Us("targetOffset",t,e,i,r);h&&n.push(h)}return n}function BIe(t,e,i,r){if(i.scaleBaked===void 0)return;let n=(e.scaleBaked??t.data.geometry.scaleBaked).map(a=>typeof a=="string"?Number(r.getVariable(a)??0):a),s=i.scaleBaked.map(a=>typeof a=="string"?Number(r.getVariable(a)??0):a);if(mm.isEqual(n,s))return;let o=[];return o.push({update:a=>{t.updateGeometryInteractions({scaleBaked:[kt.lerp(n[0],s[0],a),kt.lerp(n[1],s[1],a),kt.lerp(n[2],s[2],a)]},r),t.invalidateDownstreamBooleanData()},start:()=>{t.updateGeometryInteractions({scaleBaked:n},r),t.invalidateDownstreamBooleanData()},end:()=>{t.updateGeometryInteractions({scaleBaked:s},r),t.invalidateDownstreamBooleanData()}}),o}function OIe(t,e,i,r){if(!i.extrusion)return;let n=t.extrusion,s=e.extrusion??{},o=i.extrusion,a=[];return S$.forEach(l=>{let u=Kp(l,n,s,o,r);u&&a.push(u)}),a}function UIe(t,e,i,r){let n=[];if(!("geometry"in i))return n;let s=t.geometry.userData.parameters,o="geometry"in e?e.geometry:{},a=i.geometry;if(t instanceof c1){let l=BIe(t,o,a,r);l&&n.push(...l)}else{let l={};if(Object.assign(l,qc(s,A8)),A8.forEach(u=>{let c=Kp(u,l,o,a,r);c&&n.push(c)}),t instanceof Uz){Object.assign(l,{extrusion:{...s.extrusion}});let u=OIe(l,o,a,r);u&&n.push(...u)}n.length&&n.push({update:u=>{t.updateGeometryInteractions(l,r),t.updateGeometryGroupsIfNeeded()},start:u=>{t.updateGeometryInteractions(l,r),t.updateGeometryGroupsIfNeeded()},end:u=>{t.updateGeometryInteractions(l,r),t.updateGeometryGroupsIfNeeded()}})}return n}function NIe(t,e,i,r){let n=[];if(i.intensity!==void 0){let s=Us("intensity",t,e,i,r);s&&n.push(s)}if(i.color!==void 0){let s=IIe("color",t,e,i,r);s&&n.push(s)}return n}function FIe(t,e,i,r){let n=[];if(Array.isArray(t.material)){if(!("materials"in i&&i.materials))return n;let s="materials"in e&&e.materials?e.materials:[],o=i.materials;t.material.forEach((a,l)=>{if(!o[l])return;let u=s[l]??{},c=o[l];typeof u=="string"||typeof c=="string"||n.push(...JW(a,u,c,r))})}else{if(!("material"in i&&i.material))return n;let s="material"in e&&e.material?e.material:{},o=i.material;if(typeof s=="string"||typeof o=="string")return n;n.push(...JW(t.material,s,o,r))}return n}function JW(t,e,i,r){var o;let n=[],s=uv(i,r)||!!e.layers&&uv(e,r);n.push(YIe(t,s));for(let a of t.layers){let l=(o=e.layers)==null?void 0:o.data(a.uuid),u=i.layers.data(a.uuid);if(!u||a.type!=="light"&&(!(a.visible??!0)||!(u.visible??!0)))continue;let c=a.getNames().filter(h=>!x$.some(d=>h.includes(d)));for(let h of c)try{let d=a.getValue(h),p;if(h==="colors")p=qIe(a,l,u,h);else if(Array.isArray(d))h==="steps"&&(p=WIe(a,l,u,h));else if(typeof d=="number")p=zIe(a,l,u,h,r);else{if(typeof d=="boolean")continue;d instanceof me?p=HIe(a,l,u,h):d instanceof N?p=GIe(a,l,u,h,r):d instanceof Ws?p=jIe(a,l,u,h,r):d instanceof Xt?p=VIe(a,l,u,h,r):"isTexture"in d&&(p=XIe(a,l,u,h))}p&&(Array.isArray(p)?n.push(...p):n.push(p))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return n}function zIe(t,e,i,r,n){if(!t.hasValue(r)||!(r in i))return;let s=e?e[r]:t.getValue(r),o=i[r],a=typeof s=="string"?Number(n.getVariable(s)??0):s,l=typeof o=="string"?Number(n.getVariable(o)??0):o;if(a!==l)return{update:u=>{t.setValue(r,kt.lerp(a,l,u))},start:()=>{t.setValue(r,a)},end:()=>{t.setValue(r,l)}}}function HIe(t,e,i,r){if(!t.hasValue(r)||!(r in i))return;let n=t.getValue(r),s=e?new me().fromArray(e[r]):n.clone(),o=new me().fromArray(i[r]);if(!s.equals(o))return{update:a=>{n.lerpVectors(s,o,a)},start:()=>{n.copy(s)},end:()=>{n.copy(o)}}}function GIe(t,e,i,r,n){if(!t.hasValue(r)||!(r in i))return;let s=t.getValue(r),o=e?e[r]:void 0,a=i[r],l=o?z2(new N,o,n):s.clone(),u=z2(new N,a,n);if(!l.equals(u))return{update:c=>{s.lerpVectors(l,u,c)},start:()=>{s.copy(l)},end:()=>{s.copy(u)}}}function VIe(t,e,i,r,n){if(!t.hasValue(r)||!(r in i))return;let s=e?e[r]:void 0,o=i[r],a=t.getValue(r),l=s?typeof s=="string"?n.getColor(s).clone():new Xt().setRGB(s.r,s.g,s.b):a.clone(),u=typeof o=="string"?n.getColor(o).clone():new Xt().setRGB(o.r,o.g,o.b);if(l.equals(u))return;let c=a.clone();return{update:h=>{t.getValue(r)!==c&&t.setValue(r,c),c.lerpColors(l,u,h)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function jIe(t,e,i,r,n){if(!t.hasValue(r)||!(r in i))return;let s=e?e[r]:void 0,o=i[r],a=t.getValue(r),l=s?typeof s=="string"?n.getColor(s).clone():new Xt().setRGB(s.r,s.g,s.b):a.clone(),u=typeof o=="string"?n.getColor(o).clone():new Ws(o.r,o.g,o.b,o.a);if(l.equals(u))return;let c=a.clone();return{update:h=>{t.getValue(r)!==c&&t.setValue(r,c),c.lerpColors(l,u,h)},start:()=>{c.copy(l)},end:()=>{c.copy(u)}}}function WIe(t,e,i,r="steps"){if(!t.hasValue(r)||!(r in i))return;let n=[],s=t.getValue(r),o=e?e[r]:s,a=i[r];for(let l=0;l<s.length;++l){let u=o[l],c=a[l];u!==c&&n.push({update:h=>{s[l]=kt.lerp(u,c,h)},start:()=>{s[l]=u},end:()=>{s[l]=c}})}return n.length?n:void 0}function qIe(t,e,i,r="colors"){if(!t.hasValue(r)||!(r in i))return;let n=[],s=t.getValue(r),o=e?e[r]:s.map(l=>l.toArray()),a=i[r];for(let l=0;l<s.length;++l){let u=[...o[l]],c=[...a[l]];p2.isEqual(u,c)||n.push({update:h=>{s[l].fromArray(p2.lerp(u,c,h))},start:()=>{s[l].fromArray(u)},end:()=>{s[l].fromArray(c)}})}return n.length?n:void 0}function XIe(t,e,i,r="texture"){if(!t.hasValue(r)||!(r in i))return;let n=t.getNode("mat");if(!n)return;let s=e?e[r]:n,o=i[r],a=[...s.repeat],l=[...s.offset],u=[...o.repeat],c=[...o.offset];if(!Fc.isEqual(a,u)||!Fc.isEqual(l,c))return{update:h=>{n.repeat=Fc.lerp(a,u,h),n.offset=Fc.lerp(l,c,h),n.updateMatrix()},start:()=>{n.repeat=[...a],n.offset=[...l],n.updateMatrix()},end:()=>{n.repeat=[...u],n.offset=[...c],n.updateMatrix()}}}function YIe(t,e){return{update:()=>{t.transparent=e}}}var x3=new N,QW=new ts;function KIe(t,e,i,r,n){var f,m,g,y,v,b;let s=[],o,a,l,u,c,h,d,p;if(t instanceof Cs?(o=H2("position",t,e,i,n),o&&s.push(o),l=Us("rotation",t,e,i,n),l&&s.push(l),u=H2("shear",t,e,i,n),u&&s.push(u)):(p={slide:((f=e.pathSnapping)==null?void 0:f.slide)??((m=t.updatedPathSnapping)==null?void 0:m.slide)??((g=t.dataPatched.pathSnapping)==null?void 0:g.slide)??0,offset:((y=e.pathSnapping)==null?void 0:y.offset)??((v=t.updatedPathSnapping)==null?void 0:v.offset)??((b=t.dataPatched.pathSnapping)==null?void 0:b.offset)??0},h=Us("slide",p,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping,n),h&&s.push(h),d=Us("offset",p,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,i.pathSnapping??t.dataPatched.pathSnapping,n),d&&s.push(d),!h&&!d&&(o=YW("position",t,e,i,n),o&&s.push(o),a=YW("scale",t,e,i,n),a&&s.push(a),l=JIe(t,e,i,r,n),l&&s.push(l),c=DIe("hiddenMatrix",t,e,i),c&&s.push(c))),o||a||l||c||h||d){let _=t instanceof Cs?()=>{t.updateWorldMatrix(!0)}:()=>{var A;t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),(A=t.parent)!=null&&A.matrixWorldFusedFalse&&(t.matrixWorld.multiplyMatrices(t.parent.matrixWorldFusedFalse,t.matrix),t.matrixWorldNeedsUpdate=!1),fu(t)&&zc(t.parent)&&t.invalidateDownstreamBooleanData(!0),t.updatePathSnapping(Object.assign({},e.pathSnapping,p))};s.push({update:_,start:_,end:_})}return s}function JIe(t,e,i,r,n){var c;let s=e!=null&&e.rotation?e.rotation.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*kt.DEG2RAD):void 0,o=(c=i.rotation)==null?void 0:c.map(h=>(typeof h=="string"?Number(n.getVariable(h)??0):h)*kt.DEG2RAD);if(!o)return;let a=s?new N().fromArray(s):new N().setFromEuler(t.rotation),l=new N().fromArray(o);if(a.equals(l))return;let u=x3.subVectors(l,a);if(r&&u.toArray().every(h=>Math.abs(h)<2*Math.PI)){let h=new ni().setFromEuler(QW.setFromVector3(a)),d=new ni().setFromEuler(QW.setFromVector3(l));return{update:p=>{kIe(h,d,t.quaternion,p)},start:()=>{t.rotation.setFromVector3(a)},end:()=>{t.rotation.setFromVector3(l)}}}else return{update:h=>{x3.lerpVectors(a,l,h),t.rotation.setFromVector3(x3)},start:()=>{t.rotation.setFromVector3(a)},end:()=>{t.rotation.setFromVector3(l)}}}function QIe(t,e,i,r){let n=[];if(!("cloner"in i)||!t.cloner)return n;let s=t.cloner,o="cloner"in e?e.cloner:{},a=i.cloner;f$.forEach(p=>{let f;p==="count"?f=Us("count",s.parameters,o,a,r,!0):f=Kp(p,s.parameters,o??{},a,r),f&&n.push(f)});let l=ZIe(s,o,a,r);l!=null&&l.length&&n.push(...l);let u=$Ie(s,o,a,r);u!=null&&u.length&&n.push(...u);let c=eLe(s,o,a,r);c!=null&&c.length&&n.push(...c);let h=tLe(s,o,a,r);h!=null&&h.length&&n.push(...h);let d=iLe(s,o,a,r);return d!=null&&d.length&&n.push(...d),n.length&&n.push({update:()=>{s.update()}}),n}function ZIe(t,e,i,r){if(t.parameters.type!=="radial")return;let n=e.radial,s=i.radial;if(!s)return;let o=t.parameters.radial,a=[];return m$.forEach(l=>{let u=Kp(l,o,n??{},s,r);u&&a.push(u)}),a}function $Ie(t,e,i,r){if(t.parameters.type!=="linear")return;let n=e.linear,s=i.linear;if(!s)return;let o=[],a=t.parameters.linear;return g$.forEach(l=>{let u=Kp(l,a,n??{},s,r);u&&o.push(u)}),o}function eLe(t,e,i,r){if(t.parameters.type!=="grid")return;let n=e.grid,s=i.grid;if(!s)return;let o=[],a=t.parameters.grid;return y$.forEach(l=>{let u;l==="count"?u=Zz(l,a,n??{},s,r,!0):u=Kp(l,a,n??{},s,r),u&&o.push(u)}),o}function tLe(t,e,i,r){if(t.parameters.type!=="toObject")return;let n=e.toObject,s=i.toObject;if(!s)return;let o=[],a=t.parameters.toObject;return v$.forEach(l=>{let u;l==="count"?u=Us(l,a,n??{},s,r,!0):u=Kp(l,a,n??{},s,r),u&&o.push(u)}),o}function iLe(t,e,i,r){if(!t.parameters.randomness)return;let n=e.randomnessObject,s=i.randomnessObject;if(!s)return;let o=[],a=t.parameters.randomnessObject;return b$.forEach(l=>{let u=Kp(l,a,n??{},s,r);u&&o.push(u)}),o}function rLe(t,e){return{update:()=>{t instanceof ws&&(t.fill.enabled=e)}}}function nLe(t,e){return{update:()=>{t instanceof ws&&(t.stroke.enabled=e)}}}function sLe(t,e){return{update:()=>{t instanceof ws&&(t.dropShadow.enabled=e)}}}function oLe(t,e){return{update:()=>{t instanceof ws&&(t.innerShadow.enabled=e)}}}function aLe(t,e){return{update:()=>{t instanceof ws&&(t.backgroundBlur.enabled=e)}}}function lLe(t,e){return{update:()=>{t instanceof ws&&(t.layerBlur.enabled=e)}}}function uLe(t,e,i,r,n){let s=[],o,a,l,u,c,h,d,p,f,m,g,y,v,b,_;if("width"in t&&(o=Us("width",t,e,i,n),o&&s.push(o)),"height"in t&&(a=Us("height",t,e,i,n),a&&s.push(a)),t instanceof ws||t instanceof Ph){let A={...e.fill},S={...i.fill};A.enabled!==void 0&&A.enabled!==S.enabled&&(s.push(rLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}})),l=iE("color",t.fill,A,S,n),l&&s.push(l)}if(t instanceof ws){let A={...e.stroke},S={...i.stroke};(A.enabled||S.enabled)&&(s.push(nLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}})),u=iE("color",t.stroke,A,S,n),u&&s.push(u),c=Us("thickness",t.stroke,A,S,n),c&&s.push(c)}if(t instanceof ws){let A={...e.dropShadow},S={...i.dropShadow};(A.enabled||S.enabled)&&(s.push(sLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}})),h=iE("color",t.dropShadow,A,S,n),h&&s.push(h),d=Us("blurRadius",t.dropShadow,A,S,n),d&&s.push(d),f=Us("spread",t.dropShadow,A,S,n),f&&s.push(f),p=H2("offset",t.dropShadow,A,S,n),p&&s.push(p)}if(t instanceof ws){let A={...e.innerShadow},S={...i.innerShadow};(A.enabled||S.enabled)&&(s.push(oLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,color:{...A.color,a:0}}),S.enabled||Object.assign(S,{enabled:!0,color:{...S.color,a:0}})),m=iE("color",t.innerShadow,A,S,n),m&&s.push(m),g=Us("blurRadius",t.innerShadow,A,S,n),g&&s.push(g),v=Us("spread",t.innerShadow,A,S,n),v&&s.push(v),y=H2("offset",t.innerShadow,A,S,n),y&&s.push(y)}if(t instanceof ws||t instanceof Ph){let A={...e.backgroundBlur},S={...i.backgroundBlur};(A.enabled||S.enabled)&&(s.push(aLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,radius:0}),S.enabled||Object.assign(S,{enabled:!0,radius:0})),b=Us("radius",t.backgroundBlur,A,S,n),b&&s.push(b)}if(t instanceof ws){let A={...e.layerBlur},S={...i.layerBlur};(A.enabled||S.enabled)&&(s.push(lLe(t,!0)),A.enabled||Object.assign(A,{enabled:!0,radius:0}),S.enabled||Object.assign(S,{enabled:!0,radius:0})),_=Us("radius",t.layerBlur,A,S,n),_&&s.push(_)}if(t instanceof Ph||t instanceof s_){let A=Zz("cornerRadius",t,e,i,n);A&&s.push(A)}return s}function ZW(t,e,i,r,n){let s=[];return t.data.visible&&s.push(...KIe(t,e,i,n,r)),t instanceof Cs?s.push(...uLe(t,e,i,n,r)):(t.data.visible&&s.push(...QIe(t,e,i,r)),fu(t)?(t instanceof po&&t.data.visible&&s.push(...UIe(t,e,i,r)),t.data.visible&&s.push(...FIe(t,e,i,r))):fRe(t)?t.data.visible&&s.push(...NIe(t,e,i,r)):pRe(t)&&s.push(...LIe(t,e,i,r))),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var $W=new N;function $z(t,e,i=!1){var s;let r=[],n=o=>{let a=o.data;delete o.states,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let l of a.states){let u={...l.data};o.states||(o.states={}),o.states[l.id]=$f.patch(a,u)}tq(t.scene,o,null,e,a.events.find(l=>l.data.type==="Follow"||l.data.type==="LookAt")!==void 0),eq(t)};t.scene.traverse2D(n),t.traverseChildren(o=>{var c,h,d,p,f,m;if(i&&((c=o.rigidBody)==null||c.setTranslation(o.position0,!0),(h=o.rigidBody)==null||h.setRotation(o.rotation0,!0),(d=o.rigidBody)==null||d.setLinvel($W,!0),(p=o.rigidBody)==null||p.setAngvel($W,!0)),!Ti.is(o))return;let a=o.uuid,l=o.data;if(delete o.states,o.uuid===X0)return;let u=!1;r.some(g=>{var y;return(y=t.scene.find(a))==null?void 0:y.isDescendantOf(g)})?u=!0:((f=l.physics)==null?void 0:f.fusedBody)===!0&&l.physics.rigidBody==="dynamic"&&r.push(a),o.data=l,o.currentState=null,o.reversibleToState=null,o.currentTransitionEvent=null;for(let g of l.states){let y={...g.data};t.data.globalPhysics.usePhysics===!0&&l.physics&&(l.physics.rigidBody==="dynamic"||u)&&(g.data.position!==void 0&&delete y.position,g.data.rotation!==void 0&&delete y.rotation,g.data.hiddenMatrix!==void 0&&delete y.hiddenMatrix),o.states||(o.states={}),o.states[g.id]=Jf.patch(l,y)}tq(t.scene,o,null,e,l.events.find(g=>g.data.type==="Follow"||g.data.type==="LookAt")!==void 0),eq(t),o instanceof ho&&o.frame&&(o.frame.traverse(g=>n(g)),(m=o.uiCanvas)==null||m.applySize())}),t.frame&&(t.frame.traverse(o=>n(o)),(s=t.uiCanvas)==null||s.applySize())}function eq(t){t.traverseEntity(e=>{for(let i of e.data.events){let r=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":r.push(...i.data.actions);break;case"GameControl":for(let n of Object.values(i.data.gameActions))r.push(...n);break;case"DragDrop":r.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":r.push(...i.data.inActions,...i.data.outActions);break}for(let n of r)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=t.scene.find(n.data.object);s&&(s.visible=!1)}}})}function tq(t,e,i,r,n=!1){if(e instanceof po&&e.removeInteractionGeometry(r),e instanceof Cs?e.changeSelectedState(i,{shared:r},n):e.changeSelectedState(i,{scene:t,shared:r},n),e instanceof po&&e.updateGeometryGroupsIfNeeded(),e instanceof mo&&e.updateCameraState(e.dataPatched,{scene:t,shared:r}),!(e instanceof Cs)){if(e.cloner)for(let s of e.cloner.children)s.playModeVisible=void 0;e.updateVisible(t)}}function Nte(t){let e;if(t.easing===5){let{control1:i,control2:r}=t;e=`cubicBezier(
			${i[0]}, ${i[1]}, ${r[0]}, ${r[1]}
		)`}else if(t.easing===6){let{mass:i,stiffness:r,damping:n,velocity:s}=t;e=`spring( ${i}, ${r}, ${n}, ${s} )`}else{let i;switch(t.easing){case 0:i=Xd.linear;break;case 1:i=Xd.ease;break;case 2:i=Xd.easeIn;break;case 3:i=Xd.easeOut;break;case 4:i=Xd.easeInOut;break;default:i=Xd.linear}let[r,n,s,o]=i;e=`cubicBezier( ${r}, ${n}, ${s}, ${o} )`}return{duration:Math.max(t.duration,1e-4),easing:e}}function OO(t){let e={delay:0,loop:t.repeat===-1?!0:t.repeat+1};if(t.repeat===0)e.direction="normal",e.rewind=!1;else switch(t.direction){case"pingpong":e.direction="alternate",e.rewind=!1;break;case"pingpong-rewind":e.direction="alternate",e.rewind=!0;break;default:e.direction="normal",e.rewind=!1;break}switch(e.delay=0,e.endDelay=0,e.startOnceDelay=0,e.pingPongDelayCorrection=0,e.pingPongEndDelayCorrection=0,t.delayDirection){case"start-once":e.startOnceDelay=t.delay;break;case"start":e.delay=t.delay;break;case"end":e.endDelay=t.delay;break;case"start-end":case void 0:e.delay=t.delay,e.endDelay=t.delay;break}return e.direction==="alternate"&&(e.delay/=2,e.endDelay/=2,t.delayDirection==="start"?(e.pingPongDelayCorrection=e.delay,typeof e.loop=="number"&&e.loop%2===0&&(e.pingPongEndDelayCorrection=e.delay)):t.delayDirection==="end"?typeof e.loop=="number"&&e.loop%2!==0&&(e.pingPongEndDelayCorrection=e.endDelay):t.delayDirection==="start-end"&&(e.pingPongDelayCorrection=e.delay,e.pingPongEndDelayCorrection=e.endDelay)),e}var hLe={type:"beginState"},cLe={type:"completeState",isfromEntity:!1},iq=class{constructor(t,e,i,r,n,s){if(this.object=t,this.data=r,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object instanceof Cs||this.object.traverseEntity(a=>{a!==this.object&&a instanceof mo&&a.dispatchEvent(hLe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object instanceof Cs||this.object.traverseEntity(a=>{a!==this.object&&a instanceof mo&&a.dispatchEvent(cLe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=ZW(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},e===void 0){let o=FM(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=FM(this.object,e);if(!o)throw new Error("Missing property");this.from=o}if(i===void 0)throw new Error("Missing property");{let o=FM(this.object,i);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=e===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...OO(r),...Nte(r),change:this.onChange},this.callback=ZW(this.object,e===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Fte=class extends Ys{constructor(t,e,i,r){var s;if(super(),this.data=t,this.page=e,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var o;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((o=this.timeline)==null||o.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let n=this.page.scene.find(t.object)??((s=this.page.uiCanvas)==null?void 0:s.find(t.object))??this.page.scene.find2DInUIObjects(t.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){var t;return((t=this.timeline)==null?void 0:t.paused)===!1}get changeBegan(){return this.tweens.some(t=>t.changeBegan)??!1}init(){this.initialCurrentState=FM(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:t=!0,needsRebuild:e=!1,isRebuild:i=!1}={}){var r,n,s,o;try{let a=OO(this.data.tweens[0].data);i&&typeof a.loop=="number"&&a.loop--,(r=this.timeline)==null||r.pause(),this.timeline=Ute.timeline({autoplay:!1,...a,...a.loop===!0||a.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(u=>u==null?void 0:u.changeBegan);if(e===!0&&(this.timelineNeedsRebuild=!0),t){let u=l===-1?0:l;for(let c=u;c<this.data.tweens.length-1;c++){let h=this.data.tweens[c],d=this.data.tweens[c+1],p;c===u&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.changeBegan)===!0)?(p=void 0,this.object instanceof mo&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new iq(this.object,p,d.data.state===void 0?this.currentState:d.data.state,d.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===u&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[c]=f,this.timeline.add(f.params,this.timeline.duration+(c===u?a.delay:0))}this.timeline.duration+=a.endDelay}else{let u=l===-1?this.data.tweens.length-1:l+1;for(let c=u;c>0;c--){let h=this.data.tweens[c],d=this.data.tweens[c-1],p;c===u&&(this.object.wasMovedByUser===!0||((s=this.object.previousAction)==null?void 0:s.changeBegan)===!0)?(p=void 0,this.object instanceof mo&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new iq(this.object,p,d.data.state===void 0?this.currentState:d.data.state,h.data,this.shared,this.data.allowSlerp??!1);l!==-1&&c===u&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[c-1]=f,this.timeline.add(f.params,this.timeline.duration+(c===u?a.endDelay:0))}this.timeline.duration+=a.delay}}catch(a){a instanceof Error&&console.error(a.message)}((o=this.object.previousAction)==null?void 0:o.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(qr(this.shared,this.condition)===!1||this.playing)return!1;clearTimeout(this.timeoutId);let t=OO(this.data.tweens[0].data).pingPongDelayCorrection;this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(e){e instanceof Error&&console.error(e.message)}},this.startOnceDelay+t)}pause(){var t;(t=this.timeline)==null||t.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let t=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Cs?this.object.changeSelectedState(t,{shared:this.shared}):this.object.changeSelectedState(t,{scene:this.page.scene,shared:this.shared}),this.object.currentState=t}seek(t){var e;this.timeline===void 0&&this.buildTimeline(),(e=this.timeline)==null||e.seek(t*this.timeline.duration,!0)}toggle(t){var e;if(qr(this.shared,this.condition)===!1)return!1;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.timeline)==null||e.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function FM(t,e){var n;let i,r;if(typeof e=="string"?(i=e,r=(n=t.states)==null?void 0:n[i]):e===null&&(i=null,r=t.data),!(i===void 0||r===void 0))return{id:i,data:r}}var dLe={type:"beginState"},rq={type:"completeState",isfromEntity:!1},nq={type:"requestRender"},zte=class extends Ys{constructor(t,e,i,r){super(),this.data=t,this.page=e,this.shared=i,this.condition=r,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new N,this.posEnd=new N,this.qStart=new ni,this.qEnd=new ni,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(t=!1){if(!this.data.animate)return;let e=this.page.scene.find(this.data.targetCamera);if(!e||!e.visible)throw new ReferenceError("Target camera not founded or not visible");let i={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Ute({targets:i,t:1,...Nte(this.data),update:()=>{i.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(e.position),this.qEnd.copy(e.quaternion),this.zoomEnd=e.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(e.uuid)),this.page.activeCamera.dispatchEvent(dLe));let r=this.page.activeCamera;r.position.lerpVectors(this.posStart,this.posEnd,i.t),r.quaternion.slerpQuaternions(this.qStart,this.qEnd,i.t),r.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*i.t,r.wasMovedBySwitchCameraAction=!0,r.updateMatrix(),r.updateMatrixWorld(),r.updateProjectionMatrix(),r.dispatchEvent(nq),i.t===1&&r.dispatchEvent(rq)}})}switchCamera(t){let e=this.page.activeCamera,i=this.page.scene.find(t);if(!i||!i.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(i),e.dispatchEvent({type:"cameraChange",camera:i})}play(){if(qr(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(t=this.animation)==null||t.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var t;(t=this.animation)==null||t.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(t){var e,i;if(qr(this.shared,this.condition)===!1)return!1;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward;try{this.playing?((e=this.animation)==null||e.pause(),this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var r,n;delete this.timeoutId,this.data.animate?((r=this.animation)==null||r.pause(),this.buildAnimation(),(n=this.animation)==null||n.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(rq),this.page.activeCamera.dispatchEvent(nq))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},Hte=class extends Ys{constructor(t,e,i,r,n){var u,c,h;super(),this.page=e,this.animationControls=i,this.shared=r,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let s=t.object,o=e.scene.find(t.object);o&&Array.isArray(o.identity)&&(s=o.identity[0]),this.data={...t,object:s};let a=this.animationControls.clipIdToAction[t.clipId+"/"+s];this.duration=((u=a==null?void 0:a.getClip())==null?void 0:u.duration)??1;let l=((h=(c=a==null?void 0:a.getClip())==null?void 0:c.tracks[0])==null?void 0:h.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/l*this.duration,this.rightFrameTime=this.data.crop[1]/l*this.duration,this.startOnceDelay=t.delay}get playing(){var t;return((t=this.threeAnimAction)==null?void 0:t.isRunning())??!1}play(t=!1){if(qr(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let e=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([r,n])=>{let s=r.split("/")[1];this.threeAnimAction!==n&&s===e&&n.isRunning()&&(t?n.fadeOut(.2):n.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var t;(t=this.threeAnimAction)==null||t.fadeOut(.2)}seek(t){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=kt.clamp(this.threeAnimAction.time+1/60*t,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(t,e=!1){if(qr(this.shared,this.condition)===!1)return!1;this.toggleIsForward=t??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let r=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([n,s])=>{let o=n.split("/")[1];this.threeAnimAction!==s&&o===r&&s.isRunning()&&(e?s.fadeOut(.2):s.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var e;let t=(e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:e.getClip();t&&(t.duration=this.duration),this.pause()}},Gte=class{constructor(t,e,i,r,n){this.data=t,this.page=e,this.eventManager=i,this.shared=r,this.condition=n,this.timeOutId=-1,this.scene=e.scene}dispatch(){if(qr(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(e=>e.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let t=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(e=>{e.type==="ParticleSystem"&&(e.sleep(),e.wakeUp(),e.data.autoPlay?e.start():e.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(t),$z(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},Vte=class{constructor(t,e,i,r){this.data=t,this.page=e,this.shared=i,this.condition=r,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=qr(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let t=this.shared.getVariable(this.data.variableId),e=Q$(this.data.expression,this.shared,Ha.typeOfVariable(t));e!==void 0&&this.shared.updateVariable(this.data.variableId,typeof e=="string"?{textValue:e}:e)}dispose(){}},jte=class{constructor(t,e,i,r){this.data=t,this.page=e,this.shared=i,this.condition=r,this.timeoutId=null}dispatchInner(){if(qr(this.shared,this.condition)===!1)return!1;let t=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,t==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&t!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&t!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&t!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let e=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);t==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,e===void 0?!1:!e):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!e),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let t=this.data.delay,e=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&e==="Playing"&&(t=this.data.pauseDelay),t!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},t)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function qr(t,e){if(e===void 0)return!0;if(e.expression.length===0)return!1;let i=Q$(e.expression,t,"boolean");return e.negate?!i:!!i}function Xo(t,e,i,r,n,s){let o={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[]},a=l=>({id:u,data:c})=>{try{c.type==="Audio"?ra[t.type].includes("Audio")&&o.Audio.push(new yte(u,c,s,r,l)):c.type==="Video"&&!(s instanceof Cs)?ra[t.type].includes("Video")&&o.Video.push(new qte(u,c,s,r,l)):c.type==="Particles"?ra[t.type].includes("Particles")&&o.Particles.push(new vte(c,i,r,l)):c.type==="Link"?ra[t.type].includes("Link")&&o.Link.push(new eIe(c,n.controlsManager,r,l)):c.type==="Create"?ra[t.type].includes("Create")&&o.Create.push(new Xte(c,i,n.controlsManager,r,l)):c.type==="Destroy"?ra[t.type].includes("Destroy")&&o.Destroy.push(new bte(c,i,n.controlsManager,r,l)):c.type==="Reset"?ra[t.type].includes("Reset")&&o.Reset.push(new xte(c,i,r,n,l)):c.type==="Transition"?ra[t.type].includes("Transition")&&o.Transition.push(new Fte(c,i,r,l)):c.type==="SwitchCamera"?ra[t.type].includes("SwitchCamera")&&o.SwitchCamera.push(new zte(c,i,r,l)):c.type==="SceneTransition"?ra[t.type].includes("SceneTransition")&&o.SceneTransition.push(new Gte(c,i,n,r,l)):c.type==="Animation"?ra[t.type].includes("Animation")&&o.Animation.push(new Hte(c,i,n.animationControls,r,l)):c.type==="SetVariable"?ra[t.type].includes("SetVariable")&&o.SetVariable.push(new Vte(c,i,r,l)):c.type==="DynamicVariablePlay"?ra[t.type].includes("DynamicVariablePlay")&&o.DynamicVariablePlay.push(new jte(c,i,r,l)):c.type==="Conditional"&&ra[t.type].includes("Conditional")&&(c.ifActions.forEach(a({expression:c.condition,negate:!1})),c.elseActions.forEach(a({expression:c.condition,negate:!0})))}catch{}};return e.forEach(a()),o}function Es(t){Object.values(t).forEach(e=>{e.forEach(i=>{(i instanceof yte||i instanceof qte||i instanceof vte||i instanceof Hte||i instanceof Fte||i instanceof Xte||i instanceof bte||i instanceof zte||i instanceof Gte||i instanceof xte||i instanceof Vte||i instanceof jte)&&i.dispose()})})}function pLe(t,e){let i;if("material"in t){let r=t.material;Array.isArray(r)?i=t.material[0].layers.find(n=>n.uuid===e):i=t.material.layers.find(n=>n.uuid===e)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var Wte=new Map,gw=new Map,Nv=class{constructor(t,e,i){this.data=e,this.delay=0,this.status="stopped";let{layerId:r,loop:n,volume:s,delay:o}=e;if(this.object=i,r===void 0)throw new Error("Missing property");let a=pLe(i,r);a&&(this.videoElement=a,this.videoElement.loop=n===1/0,ez&&(this.videoElement.autoplay=!0),s!==void 0&&(this.videoElement.volume=s)),o!==void 0&&(this.delay=o),gw.has(i.uuid)?gw.get(i.uuid).push(this):gw.set(i.uuid,[this]),Wte.set(t,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(t){if(!this.videoElement)return;let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t?(this.mute(),this.delay+=150):e?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(r=>{}).catch(r=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},UO=class{constructor(t){this.data=t}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(t){let e=Wte.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e[this.data.interaction](),this.disposeDelay()},this.data.delay)):e[this.data.interaction]())}pauseAllVideosFromObject(t){let e=gw.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let t=[...gw.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},qte=class{constructor(t,e,i,r,n){if(this.data=e,this.shared=r,this.condition=n,e.interaction==="play")this.interaction=new Nv(t,e,i);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new UO(e);else throw new Error("Missing property")}dispatchBasic(){if(qr(this.shared,this.condition)===!1)return!1;this.interaction instanceof Nv?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(qr(this.shared,this.condition)===!1)return!1;this.interaction instanceof Nv?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},sq=(()=>{let t,e,i,r;function n(a){!t&&!oq()&&(e==null?void 0:e.sharedGameControlGlobals.createdObjects.length)>0&&(t=requestAnimationFrame(s)),a&&(e=a,r=a.requestRender)}function s(a){let l=i?a-i:0,u=e.sharedGameControlGlobals.createdObjects,c=e.sharedGameControlGlobals.nCreatedPerAction,h=u.length,d=0;for(;d<h;){let p=u[d];p.userData.createdTime===void 0&&(p.userData.createdTime=a),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&a-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&c[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),r()),d++):(c[p.userData.actionId]>p.userData.quantity&&c[p.userData.actionId]--,u.splice(d,1),p.removeFromParent(),e.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(e.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),e.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,e.sharedGameControlGlobals.entitiesWithTransformAnim=e.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),h--,r())}t=d>0?requestAnimationFrame(s):void 0,i=d>0?a:void 0}function o(){oq()?t&&(cancelAnimationFrame(t),t=void 0,i=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),n})();function oq(){return!!document&&document.hidden}var aq=new ni,fLe=new N,mLe=new N,Xte=class{constructor(t,e,i,r,n){this.data=t,this.page=e,this.controlsManager=i,this.shared=r,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=kt.generateUUID(),this.dispatch=()=>{if(qr(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(qr(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=oEe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let o=new co(this.object);if(o.playModeVisible=!0,o.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,u=this.page.scene.find(l);u&&(u.updateMatrixWorldSVD(),o.hiddenMatrix.copy(u.matrixWorldRigid))}o.position.fromArray(this.data.position),o.rotation.fromArray(this.data.rotation),o.updateMatrix(),this.page.add(o);let a=this.controlsManager.sharedGameControlGlobals;a.createdObjects.push(o),a.nCreatedPerAction[this.uniqueId]===void 0?a.nCreatedPerAction[this.uniqueId]=1:a.nCreatedPerAction[this.uniqueId]++,o.updateWorldMatrix(!0,!0),o.traverseObject(this.traverseObjectCB),sq(),this.controlsManager.requestRender()},this.traverseObjectCB=o=>{var c,h,d,p;o.hasNonUniformScale&&o.updateMatrixWorldSVD();let a;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(o instanceof vu)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;a=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof co)a=o.object;else if(a=o,(c=a.dataPatched.cloner)==null?void 0:c.hideBase)return!0}else{if(o instanceof vu)return;o instanceof co?a=o.object:a=o}this.data.destroy==="Time"?o.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(o.userData.quantity=this.data.destroyAfterQuantity,o.userData.actionId=this.uniqueId);let l=new N().fromArray(this.data.velocity),u=a.dataPatched;if(!(u.physics.enabled==="visibility"?!u.visible:!u.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(o,a,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((h=o.rigidBody)==null||h.collider(0).setActiveEvents(1),o.userData.hasCollisionDestroy=!0),o.matrixWorld.decompose(fLe,aq,mLe),l.applyQuaternion(aq),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&((d=o.rigidBody)==null||d.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in o.object&&this.controlsManager.addBoundsTree(o),this.data.velocity.some(f=>f!==0)&&this.data.dynamic&&(o.userData.velocity=l)),((p=a.dataPatched.physics)==null?void 0:p.fusedBody)===!0))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");sq(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(t=>window.clearTimeout(t)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},Yte=200,w3=.02,_3=.3,gLe=65;new N;var lq=new N,uq=new N,yLe=new N,Po=new N,na=new N,kd=new N,S3=new lt,hq=new lt,vLe=new lt;new lt;var eu=new ni,hc=new ni,eh=new ts(0,0,0,"YXZ"),bLe=new N(1,0,0),tu=new N(0,1,0),xLe=new N(0,0,1),cq=new N(1,1,1);new xa;var wLe=1,_Le=.025,SLe=16e-6,dq=12,ALe=20,ps=new Ol,pl=new Mn,ELe={type:"requestRender"},MLe={type:"updateMatrix"},pq=Math.PI/6,NO=class extends Ys{constructor(t,e,i,r,n,s,o,a,l){var f;super(),this.object=t,this.domElement=e,this.data=i,this.gloabalPhysics=r,this.controlsManager=n,this.cameraFollow=s,this.camera=o,this.page=a,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new lt,this.target0=new N,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=Yte,this.euler0=new ts(0,0,0,"YXZ"),this.position0Cam=new N,this.quat0Cam=new ni,this.scale0Cam=new N,this.hiddenMatrix0Cam=new lt,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Ol(new N(0,-40,0),new N(0,40,0)),matrix:new lt,position:new N,rotation:new ni},this.euler=new ts(0,0,0,"YXZ"),this.eulerDelta=new N,this.lastPosition=new N,this.lastCameraQuaternion=new ni,this.lastCameraPosition=new N,this.PI_2=Math.PI/2,this.prevMouse=new me,this.velocityTarget=new N,this.velocity=new N,this.directionXZ=new N,this.rotVelocityStick=new N,this.rotVelocityTarget=new N,this.rotVelocity=new N,this.rotDirection=new N,this.nonColliderRotOffset=new lt,this.nonColliderPosOffset=new lt,this.firstPointerId=-1,this.rot=new N,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new lt,this.objectToTarget=new N,this.objectToTarget0=new N,this.objectToCamXZ=new N,this.objectToCamXZ0=new N,this.targetToCamera=new N,this.targetToCamera0=new N,this.cameraPolarAxis0=new N,this.targetPos=new N,this.targetQuat=new ni,this.lerpFactorPos=new N().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new ni,this.objXZQuatInv=new ni,this.objXZRotMat=new lt,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new N,this.pushedVelocity=new N,this.groundYRotation=0,this.objectRealQuat=new ni,this.colliderWorldQuat=new ni,this.groundNormal=new N,this.groundTilt=new ni,this.groundTiltInv=new ni,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new N,this.quaternion=new ni,this.scale=new N,this.initialAction=!0,this.onPointerDown=m=>{m.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=m.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!za&&(!Y6||K6>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(m.clientX,m.clientY))},this.onPointerUp=m=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),m.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=m=>{if(m.pointerId!==this.firstPointerId)return;let g=m.clientX-this.prevMouse.x,y=m.clientY-this.prevMouse.y;this.prevMouse.set(m.clientX,m.clientY),m.pointerType==="mouse"&&this.rotBy!=="keys"&&(Y6&&K6<15.5&&!za?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-y*this.mouseOrbitSensitivity):(this.eulerDelta.y=-m.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-m.movementY*this.mouseOrbitSensitivity)),m.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-y*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=m=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?NO.isLocked=!0:NO.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let m in this.movementState)this.movementState[m]=0},this.onKeyDown=m=>{!(m.target instanceof HTMLInputElement)&&(m.code==="ArrowLeft"||m.code==="ArrowUp"||m.code==="ArrowRight"||m.code==="ArrowDown"||m.code==="Space")&&m.preventDefault();for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]){this.movementState[g[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=m=>{for(let g of this.keyAssignments)if(m.key.toUpperCase()===g[1]||m.key===g[1]||m.code.slice(3,m.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(m,g)=>{for(let y=2;y<4;y++){let v=m.axes[y];g===0?y===2?this.movementState.movePosX=v:this.movementState.movePosZ=v:(m.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,y===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(v)>=.3&&(this.vrEulerYOffset+=v<0?1:-1),this.movementState.rotPosY=v):this.moveMode==="fly"&&(this.movementState.moveNegY=v))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,t===o&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let u=this.euler0.clone(),c=u.y;if(this.objectRealQuat.copy(this.quaternion),u.y=0,this.quaternion.setFromEuler(u),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),u.set(0,c,0),this.quaternion.setFromEuler(u),this.rot.setFromEuler(u),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let m=new N(0,0,-1).applyQuaternion(this.camera.quaternion),g=new N().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let y,v;Math.abs(m.y)<1e-6?(g.y=0,m.y=0,v=g.projectOnVector(m)):g.y/m.y>0?v=m.multiplyScalar(g.y/m.y):v=m.multiplyScalar(g.length()),this.targetToCamera0.copy(v).negate(),y=this.camera.position.clone().add(v),this.objectToTarget0.subVectors(y,this.position);let b=new ts().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-b.x,b.x=0,b.z=0,b.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(b)}if(this.object instanceof mo&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*wLe,this.speedOrbit=(i.speedRotate??100)*_Le,this.mouseOrbitSensitivity=(i.speedRotate??100)*SLe,this.keyAssignments=i.keyAssignments.map(m=>{let g=[m[0],m[1]];return g[1]===""?g[1]="ArrowUp":g[1]===""?g[1]="ArrowLeft":g[1]===""?g[1]="ArrowDown":g[1]===""?g[1]="ArrowRight":g[1]===""?g[1]="Shift":g[1]===""?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]===""?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),i.rotBy==="mouse"){let m;m=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),m!==-1&&(this.keyAssignments[m][1]=""),m=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),m!==-1&&(this.keyAssignments[m][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??l0.defaultData.gravity)*dq,this.usePhysics=this.gloabalPhysics.usePhysics??l0.defaultData.usePhysics,this.jumpPower=i.jumpPower*ALe,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??A2.defaultDataThirdPerson.orientWith,this.slopeThresh=gLe*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*w3/this.pixelsPerMeter,this.stepThresh=i.collider.height*_3/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*w3/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*_3/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*w3/this.pixelsPerMeter,this.stepThresh=i.collider.height*_3/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let h=new N().fromArray(i.collider.position),d=new ni().setFromEuler(new ts().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,cq),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=i.runMultiplier??2;let p=i.navmesh.destinationHelperRadius*2;if(p>0){let m=new qt;m.push({fi:0,data:{...ys.defaultData("light","phong"),alpha:0},id:"layer1"}),m.push({fi:0,data:{...ys.defaultData("color"),color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a},id:"layer2"});let g=new Cz({layers:m},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new zn(D$.create({parameters:{width:p,height:p/10,hollow:.7}}),g),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(t=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),t){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let e=new ts().setFromQuaternion(this.quaternion,"YXZ"),i=e.y;this.objectRealQuat.copy(this.quaternion),e.y=0,this.quaternion.setFromEuler(e),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),e.set(0,i,0),this.quaternion.setFromEuler(e),this.rot.setFromEuler(e),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof mo?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var t;this.deactivate(),(t=this.navMeshPathDest)!=null&&t.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let t=this.data,e=this.sharedAssets;t.gameActions!==void 0&&(this.actions={},S2.list.forEach(i=>{this.actions[i]=Xo({...t,disabled:!1,type:"GameControl"},t.gameActions[i],this.page,e,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Es(this.actions.idle),Es(this.actions.move),Es(this.actions.run),Es(this.actions.jump)}dispatchStartEvent(t){this.actions[t]!==void 0&&(this.actionState[t]||(this.actionState[t]=!0,this.actions[t].Transition.forEach(e=>{e.play()}),this.actions[t].Animation.forEach(e=>{e.play(this.initialAction===!1)}),this.actions[t].Create.forEach(e=>{e.dispatchStart()}),this.actions[t].Audio.forEach(e=>{e.dispatchGameControl("start")}),this.actions[t].Particles.forEach(e=>{e.dispatchGameControl("start")})))}dispatchStopEvent(t){this.actions[t]!==void 0&&(!this.actionState[t]||(this.actionState[t]=!1,this.actions[t].Transition.forEach(e=>{e.stop(),e.object.currentState!==null&&e.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[t].Create.forEach(e=>{e.dispatchStop()}),this.actions[t].Audio.forEach(e=>{e.dispatchGameControl("stop")}),this.actions[t].Particles.forEach(e=>{e.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Po.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(t,e,i){var a,l,u,c,h,d,p,f,m;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let r=(this.isFirstFrame?16.6:t)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=r*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let g=na.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*dq),1)*(this.gravity>0?1:-1):this.velocity.y)*r,0).divideScalar(this.pixelsPerMeter),y=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,g,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(y){this.onObject=!0,this.groundNormal.set(y.normal2.x,y.normal2.y,y.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=y.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let v=y.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===v&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(Po,hc,na),this.groundVelocity.subVectors(Po,b.prevT),this.object.getWorldPosition(na).add(this.collider.position).sub(Po),this.groundYRotation=eh.setFromQuaternion(hc).y-b.prevR.y,kd.copy(na).applyAxisAngle(tu,this.groundYRotation),this.groundVelocity.add(kd.sub(na)).divideScalar(r);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let g=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let y=Po.subVectors(this.path[1],this.position),v=na.subVectors(this.path[1],this.path[0]);y.dot(v)<0?this.path.shift():(this.directionXZ.x=v.x,this.directionXZ.z=v.z),g.opacity=g.userData.opacity0}else g.opacity-=.05*g.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let o=yLe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let g=na.copy(o);g.y=0,o.set(0,o.y,g.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let g=Po;this.camera.getWorldDirection(g);let y=kd.copy(tu).multiplyScalar(g.dot(tu));g.sub(y);let v=na.copy(this.directionXZ);v.x*=-1,this.rot.y=g.angleTo(v)*(g.cross(v).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(eh.setFromVector3(this.rot),this.moveMode==="walk"&&(eh.x=0),o.applyEuler(eh),s&&(hc.setFromUnitVectors(tu,this.groundNormal),o.applyQuaternion(hc)),i){let g=eh.set(0,this.vrEulerYOffset*pq,0);i.applyEuler(g),o.x+=i.x,o.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*r}if(this.usePhysics===!0){let g=na;this.pushedVelocity.set(0,0,0);for(let y of this.sharedGameControlGlobals.entitiesWithTransformAnim){let v=kd.setFromMatrixPosition(y.matrixWorld).sub(y.prevT).divideScalar(r).divideScalar(this.pixelsPerMeter),b=y.rigidBody.collider(0).castCollider(v,this.object.rigidBody.collider(0),Po.copy(o).divideScalar(this.pixelsPerMeter),r,!1);v.multiplyScalar(this.pixelsPerMeter);let _=Ti.is(y)?y:y.object;if(b!==null&&this.lastHitObj!==_){let A;y instanceof co&&(A=y);let S=this.sharedGameControlGlobals.entityToCollisionEvents[_.uuid];if(S)for(let E of S)E.data.target==="character"&&(E.dispatch(A),_.dispatchEvent(zO));this.lastHitObj=_}if(b!==null){this.pushedVelocity.copy(v),g.copy(b.normal1).applyQuaternion(y.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let y=g.dot(o);y<0&&o.addScaledVector(g,-y),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(r),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*r,this.euler.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*r),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(tu,this.euler.y-this.euler0.y);let g=na.copy(this.objectToCamXZ).normalize(),y=kd.copy(o).multiplyScalar(r);y.y=0;let v=y.sub(Po.copy(g).multiplyScalar(y.dot(g))).cross(g).y;this.euler.y-=Math.atan2(v,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*r+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=kt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=kt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=kt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(e?(eh.copy(e),eh.y=0):(eh.copy(this.euler),eh.y=0),this.nonColliderRotOffset.makeRotationFromEuler(eh)),e&&(this.moveMode==="walk"?(this.rot.y=e.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(e),this.rot.y+=this.vrEulerYOffset*pq),eu.setFromAxisAngle(bLe,this.rot.x),hc.setFromAxisAngle(tu,this.rot.y),hc.multiply(eu),eu.setFromAxisAngle(xLe,this.rot.z),hc.multiply(eu),this.quaternion.copy(hc),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let g=na.copy(o).multiplyScalar(r/this.pixelsPerMeter),y=null;this.didHit=!1;let v=new N;for(let b=0;b<5;b++){let _=g.length(),A=kd.copy(g).normalize();if(y=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(v),this.colliderWorldQuat,A,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,_,!1,24,void 0,void 0,this.object.rigidBody),y!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity.get(y.collider.handle);if(S!==this.lastHitObj&&b===0){this.lastHitObj=S;let C=this.sharedGameControlGlobals.entityToCollisionEvents[S==null?void 0:S.uuid];if(C){for(let T of C)if(T.data.target==="character"){let L=((c=this.sharedGameControlGlobals.rapierWorld)==null?void 0:c.getCollider(y.collider.handle))._parent,I;if(S.cloner){for(let D of S.cloner.children)if(D.rigidBody===L){I=D;break}}T.dispatch(I),S.dispatchEvent(zO)}}}let E=lq.set(y.normal2.x,y.normal2.y,y.normal2.z).applyQuaternion(this.colliderWorldQuat),M=uq.copy(A).multiplyScalar(y.toi).dot(E),R=y.toi;if(R===0&&(this.position.y+=this.offset*this.pixelsPerMeter),M>this.offset&&(R=y.toi*(M-this.offset)/M,v.addScaledVector(A,R)),g.copy(A).multiplyScalar(_-R),Math.acos(-E.y)>this.slopeThresh){let C=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(v),T=kd.copy(y.witness2).applyQuaternion(this.colliderWorldQuat);T.y=0;let L=C.add(T);L.y+=this.stepThresh;let I=this.sharedGameControlGlobals.rapierWorld.castShape(L,this.colliderWorldQuat,g,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);I!==null&&I.toi===0&&(E.y=0,E.normalize())}g.addScaledVector(E,-g.dot(E))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),v.add(g);break}}this.position.addScaledVector(v,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(Po.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(eu.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let g=this.onObject?1:5,y=o.multiplyScalar(r/g);for(let v=0;v<g;v++)this.position.add(y),this.collisionAdjustment(r/g)}else this.position.addScaledVector(o,r);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let g=this.objectToTarget.add(this.position),y=this.targetToCamera.add(g);S3.lookAt(y,g,tu).setPosition(y),S3.decompose(this.targetPos,this.targetQuat,Po),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=kt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=kt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(MLe),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*((m=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:m.userData.opacity0))?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(ELe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let t=eu.setFromAxisAngle(tu,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?kt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(t);let e;this.cameraXAxis==="Limit"?e=kt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):e=kt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=Po.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(t);let r=hc.setFromAxisAngle(i,e);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(t),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(r)}groundTiltAdjustment(t){tu.angleTo(t)*180/Math.PI<15||tu.angleTo(t)*180/Math.PI>85?eu.identity():eu.setFromUnitVectors(tu,t),this.groundTilt.slerp(eu,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(t){var n;let e=uq.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=S3.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Po,eu,na).compose(Po,eu,cq);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;pl.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=hq.copy(o).invert(),l=vLe.copy(hq).multiply(i);ps.copy(this.collider.segment),ps.start.applyMatrix4(l),ps.end.applyMatrix4(l);let u=lq.copy(this.position).applyMatrix4(a);pl.expandByPoint(ps.start),pl.expandByPoint(ps.end),pl.min.addScalar(-this.collider.radius),pl.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(c){return c.distanceToPoint(ps.end)},intersectsBounds:c=>c.intersectsBox(pl),intersectsTriangle:c=>{let h=Po,d=na,p=c.closestPointToSegment(ps,h,d);if(p<this.collider.radius){let f=this.collider.radius-p,m=d.sub(h).normalize(),g=kd.copy(u);g.addScaledVector(m,f);let y=g.applyMatrix4(o).sub(this.position);e.add(y),ps.start.addScaledVector(m,f),ps.end.addScaledVector(m,f)}}})}),pl.makeEmpty(),ps.copy(this.collider.segment),ps.start.applyMatrix4(i),ps.end.applyMatrix4(i),pl.expandByPoint(ps.start),pl.expandByPoint(ps.end),pl.min.addScalar(-this.collider.radius),pl.max.addScalar(this.collider.radius),(n=this.sharedGameControlGlobals.staticMeshBVH)==null||n.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(ps.end)},intersectsBounds:s=>s.intersectsBox(pl),intersectsTriangle:s=>{let o=Po,a=na,l=s.closestPointToSegment(ps,o,a);if(l<this.collider.radius){let u=this.collider.radius-l,c=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(c),e.addScaledVector(c,u),ps.start.addScaledVector(c,u),ps.end.addScaledVector(c,u)}}}),this.onObject=Math.abs(e.y)>Math.abs(t*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let r=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(r),this.position.add(e)}},Kte=NO;Kte.isLocked=!1;var CLe=qn(hQ());function Tc(t,e){let i=new Ht;if(!t.getAttribute("position"))return i.setAttribute("position",new _t([],3)),i.setIndex([]),i;let{positions:r,triIndices:n}=VP(t.getAttribute("position"),t.getIndex());return i.setAttribute("position",new _t(r,3)),i.setIndex(n),e&&i.applyMatrix4(e),i}var PLe=new lt,TLe=new lt,th=[[0,0,0],[0,0,0],[0,0,0]];function Jte(t){let e=t.elements;th[0][0]=e[0],th[0][1]=e[4],th[0][2]=e[8],th[1][0]=e[1],th[1][1]=e[5],th[1][2]=e[9],th[2][0]=e[2],th[2][1]=e[6],th[2][2]=e[10];let{u:i,v:r}=(0,CLe.SVD)(th),n=PLe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=TLe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var RLe=class extends iZ{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(t,e){e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):e.isPerspectiveCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(t,e=!0,i=[]){return t.forEach(r=>{r.visible&&this.intersectObject(r,e,i)}),i}createRaycastLineHelper(){let t=new Xp({color:65280,linewidth:10}),e=new N(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new N(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),r=this.camera.far-this.camera.near,n=new N().addVectors(e,i.multiplyScalar(r)),s=new Ht;return s.setFromPoints([e,n]),new qC(s,t)}},Qte=t=>t instanceof Bv||t instanceof Ov;function kLe(t,e){return t.distance-e.distance}function Zte(t,e,i){if(!(!Pc(e)||!e.visible)){fu(e)&&e.raycast(t,i);for(let r of e.children)Zte(t,r,i)}}function zM(t,e,i,r=!1){if(!r&&!i.some(s=>G2(t,s)!==void 0))return[];let n=[];return e.children.forEach(s=>Zte(t,s,n)),n.sort(kLe),n}function FO(t){let e=[];if(t.length){let i=t[0].object;Pc(i)&&e.push(i);let r=i.parent;for(;r;)Qte(r)&&e.push(r),r=r.parent}return e}function Rc(t,e,i,r){let n=t.frame;if(n){let s=e[0]*n.width,o=(1-e[1])*n.height;for(let a of i){let l=a===n.uuid?n:n.find(a);if(l!=null&&l.intersects(s,o))return r(l),!0}}return!1}function G2(t,e){if(fu(e)){if(e.visible){let i=[];return e.raycast(t,i),i.length?i[0]:void 0}}else if(Qte(e))return $te(t,e)}function $te(t,e){if(!(!Pc(e)||!e.visible)){if(fu(e)){let i=[];if(e.raycast(t,i),i.length)return i[0]}for(let i of e.children){let r=$te(t,i);if(r)return r}}}function DLe(t,e,i){return{x:(t-(i.left+window.scrollX))/i.width*2-1,y:-((e-(i.top+window.scrollY))/i.height)*2+1}}function ILe(t,e,i){return{x:(t-(i.left+window.scrollX))/i.width,y:1-(e-(i.top+window.scrollY))/i.height}}var LLe=class{constructor(t,e,i,r,n,s,o,a){this.renderer=t,this.publish=e,this.scene=i,this.getCamera=r,this.sharedAssets=n,this.requestRender=s,this.isExport=o,this.frame=a,this.raycaster=new RLe,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=e.mouseEventTarget==="window",this.domElement=t.domElement,this.eventElement=this._useWindowEvents?window:t.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(t){this._useWindowEvents=t,this.eventElement=t?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(t){this._domRect=t}get domRect(){return this._domRect}updateRaycaster(t){var r;let{pageX:e,pageY:i}=((r=t.touches)==null?void 0:r.length)>0?t.touches[0]:t;this.pointerWorld=DLe(e,i,this._domRect),this.pointerScreen=ILe(e,i,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},Lu=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},e4=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],eie=t=>{var e;return(e=e4.find(([i,r])=>r===t))==null?void 0:e[0]},o_=t=>{var e;return(e=e4.find(([i])=>i===t))==null?void 0:e[1]},BLe=(t,e)=>{let i=eie(t);if(i){let r=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(r,"target",{writable:!1,value:e}),r}},OLe=class extends Lu{constructor(t){super(t),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=i=>{var s;if(!i.eventName||!i.target||i.eventName==="Scroll")return;let r=(s=this.splineEvents[eie(i.eventName)])==null?void 0:s[i.target.uuid];if(!r)return;i.eventName==="Scroll"&&i.deltaY!==void 0&&Object.assign(r,{deltaY:i.deltaY});let{domElement:n}=this.eventContext;n.dispatchEvent(r)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var r,n;if((r=i.data)!=null&&r.events.length){for(let[s,o]of e4)if(i.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(n=this.objectsPerEvents.get(s))==null||n.push(i):this.objectsPerEvents.set(s,[i]);let a={id:i.uuid,name:i.name},l=BLe(o,a),u=this.splineEvents[s];u?u[i.uuid]=l:this.splineEvents[s]={[i.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},ULe=class{constructor(t,e,i,r,n,s){if(this.id=t,this.data=e,this.object=i,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=e.runMode==="Toggle",(e.type==="KeyDown"||e.type==="KeyUp"||e.type==="KeyPress")&&!e.key)throw new Error("Missing property");this.actions=Xo(e,e.actions,r,n,s,i)}disconnect(){Es(this.actions)}dispatchHeld(t){this.actions.Create.forEach(e=>{t&&e.dispatchThrottled.cancel(),e.dispatchThrottled()})}dispatch(t=!1){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this?(e.object.currentTransitionEvent=this,e.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(e)}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStart())):(this.actions.Transition.some(e=>e.playing)||this.actions.Transition.forEach(e=>{this.alreadyPlayedNonTogglingActions.has(e)===!1&&e.play()}),this.actions.SwitchCamera.some(e=>e.playing)||this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),t===!1&&this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStop()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}},NLe=class extends Lu{constructor(t,e,i){super(t),this.useForRaycastProperty=i,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=o=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(o);let{raycaster:a,page:l}=this.eventContext,u=zM(a,l,[],!0);this.sceneInterects=u,u.length&&(this.eventContext.sharedAssets.raycastProperty={x:u[0].point.x,y:u[0].point.y,z:u[0].point.z,objX:u[0].object.matrixWorld.elements[12],objY:u[0].object.matrixWorld.elements[13],objZ:u[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=o=>{(o.target===this.eventContext.domElement||o.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(a=>{(a.data.type==="MouseDown"||a.data.type==="MousePress")&&(this.onCanvasRaycast(o),a.dispatch())})},this.onCanvasMouseUp=o=>{(o.target===this.eventContext.domElement||o.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(a=>{a.data.type==="MouseUp"?(this.onCanvasRaycast(o),a.dispatch()):a.data.type==="MousePress"&&a.dispatchRelease()})},this.onMouseDown=o=>{Qt.length>1||(this.eventContext.updateRaycaster(o),this.handleMouseEvent("MouseDown"))},this.onMouseUp=o=>{Qt.length>1||(this.eventContext.updateRaycaster(o),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=o=>{Qt.length>1||(this.eventContext.updateRaycaster(o),this.handleMousePressEvent())},this.onMousePressRelease=o=>{Qt.length>1||(this.eventContext.updateRaycaster(o),this.handleMousePressEvent(!0))},this.onKeyDown=o=>{this.heldKeys[o.key]||(this.handleKeyEvent(o,"KeyDown"),this.handleKeyEventHeld(o,"KeyDown",!0)),this.heldKeys[o.key]=!0},this.onKeyUp=o=>{this.handleKeyEvent(o,"KeyUp"),this.handleKeyEventHeld(o,"KeyUp",!0)},this.onKeyPressDown=o=>{this.heldKeysPress[o.key]?this.handleKeyEventHeld(o,"KeyPress"):(this.handleKeyEvent(o,"KeyPress"),this.handleKeyEventHeld(o,"KeyPress",!0)),this.heldKeysPress[o.key]=!0},this.onKeyPressUp=o=>{this.handleKeyEvent(o,"KeyPress",!0)},this.releaseHeldKey=o=>{delete this.heldKeys[o.key]},this.releaseHeldKeyPress=o=>{delete this.heldKeysPress[o.key]},this._onUserEvent=({eventName:o,target:a,reverse:l})=>{var c,h,d,p;if(!o||!a)return;let u=o_(o);u&&(u==="MouseDown"||u==="MouseUp"||u==="MousePress"?(a.dispatchEvent({type:"beginEvent",eventName:u}),(h=(c=this.eventsPerObjects[u])==null?void 0:c[a.uuid])==null||h.forEach(f=>{f.dispatchUserEvent(l)})):(u==="KeyDown"||u==="KeyUp"||u==="KeyPress")&&(a.dispatchEvent({type:"beginEvent",eventName:u}),(p=(d=this.eventsPerObjects[u])==null?void 0:d[a.uuid])==null||p.forEach(f=>{f.dispatchUserEvent()})))};let{page:r,sharedAssets:n}=this.eventContext,s=(o,a)=>{var u,c;if(!((u=o.data)!=null&&u.events.length))return;let l=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let h of l){let d=this.eventsPerObjects[h];o.data.events.filter(({data:p})=>p.type===h&&p.disabled!==!0).forEach(({id:p,data:f})=>{try{let m=new ULe(p,f,o,r,n,e);m.actions.Video.length&&(this.hasVideoAction=!0),(f.type==="MouseDown"||f.type==="MouseUp"||f.type==="MousePress")&&(f.mode==="Canvas"||f.mode==="Window")?this.canvasMouseEvents.push(m):d[o.uuid]?d[o.uuid].some(g=>g.id===m.id)||d[o.uuid].push(m):d[o.uuid]=[m]}catch{}}),(c=d[o.uuid])!=null&&c.length&&this.objectsPerTypes[h].push(o instanceof Cs&&(h==="MouseDown"||h==="MouseUp"||h==="MousePress")?a:o)}};r.traverseEntity(o=>{var a;(o instanceof ho||o instanceof bs)&&((a=o.frame)==null||a.traverse(l=>{s(l,o)})),s(o)})}connect(){var e,i,r,n,s,o;let{domElement:t}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),t.addEventListener("pointerdown",this.onCanvasMouseDown),t.addEventListener("pointerup",this.onCanvasMouseUp),((e=this.objectsPerTypes.MouseDown)!=null&&e.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown)),(i=this.objectsPerTypes.MouseUp)!=null&&i.length&&(this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),(r=this.objectsPerTypes.MousePress)!=null&&r.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMousePressRelease)),(n=this.objectsPerTypes.KeyDown)!=null&&n.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(u=>{u.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},t.removeEventListener("pointerdown",this.onCanvasMouseDown),t.removeEventListener("pointerup",this.onCanvasMouseUp),t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerdown",this.onMousePressDown),t.removeEventListener("pointerup",this.onMouseUp),t.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(i=>{i.forEach(r=>{r.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([e,i])=>{i.forEach(r=>{r.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(t){var a,l,u,c;let{stopRaycast:e,raycaster:i,page:r,pointerScreen:n}=this.eventContext,s=this.objectsPerTypes[t],o=s.filter(h=>!(h instanceof Cs));if(!(!s.length&&!this.useForRaycastProperty)&&!(r.uiCanvas&&Rc(r,[n.x,n.y],Object.keys(this.eventsPerObjects[t]),h=>{this.handleObjectMouseEventDispatch(h,t)}))){if(e||this.useForRaycastProperty){let h;if(this.sceneInterects===null?h=zM(i,r,o,this.useForRaycastProperty):(h=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&h.length&&(this.eventContext.sharedAssets.raycastProperty={x:h[0].point.x,y:h[0].point.y,z:h[0].point.z,objX:h[0].object.matrixWorld.elements[12],objY:h[0].object.matrixWorld.elements[13],objZ:h[0].object.matrixWorld.elements[14]}),e){let d=[((l=(a=h[0])==null?void 0:a.uv)==null?void 0:l.x)??0,((c=(u=h[0])==null?void 0:u.uv)==null?void 0:c.y)??0];FO(h).forEach(p=>{p instanceof ho&&Rc(p,d,Object.keys(this.eventsPerObjects[t]),f=>{this.handleObjectMouseEventDispatch(f,t)}),this.eventsPerObjects[t][p.uuid]&&this.handleObjectMouseEventDispatch(p,t)})}}e||o.forEach(h=>{var p,f;let d=G2(i,h);d&&(this.handleObjectMouseEventDispatch(h,t),h instanceof ho&&Rc(h,[((p=d==null?void 0:d.uv)==null?void 0:p.x)??0,((f=d==null?void 0:d.uv)==null?void 0:f.y)??0],Object.keys(this.eventsPerObjects[t]),m=>{this.handleObjectMouseEventDispatch(m,t)}))})}}handleMousePressEvent(t=!1){let e="MousePress",i=this.objectsPerTypes[e],r=i.filter(s=>!(s instanceof Cs)),n=[];if(i.length){if(!t){let{stopRaycast:s,raycaster:o,page:a,pointerScreen:l}=this.eventContext,u=!1;if(a.uiCanvas&&(u=Rc(a,[l.x,l.y],Object.keys(this.eventsPerObjects[e]),c=>{n.push(c)})),s&&!u){let c=zM(o,a,r);n=FO(c),c.forEach(h=>{var d,p;h.object instanceof ho&&Rc(h.object,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[e]),f=>{n.push(f)})})}else r.forEach(c=>{var d,p;let h=G2(o,c);h&&(n.push(c),c instanceof ho&&Rc(c,[((d=h==null?void 0:h.uv)==null?void 0:d.x)??0,((p=h==null?void 0:h.uv)==null?void 0:p.y)??0],Object.keys(this.eventsPerObjects[e]),f=>{n.push(f)}))})}this._prevObjects.length&&this._prevObjects.forEach(s=>{n.includes(s)||this.handleObjectMouseEventDispatchRelease(s,e)}),n.length&&n.forEach(s=>{this.handleObjectMouseEventDispatch(s,e)}),this._prevObjects=n}}handleObjectMouseEventDispatch(t,e){var i,r;t.dispatchEvent({type:"beginEvent",eventName:e}),(r=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||r.forEach(n=>{n.dispatch()})}handleObjectMouseEventDispatchRelease(t,e){var i,r;t.dispatchEvent({type:"beginEvent",eventName:e}),(r=(i=this.eventsPerObjects[e])==null?void 0:i[t.uuid])==null||r.forEach(n=>{n.dispatchRelease()})}handleKeyEvent(t,e,i=!1){this.objectsPerTypes[e].forEach(r=>{let n=this.eventsPerObjects[e][r.uuid];n.some(({data:s})=>"key"in s&&s.key===t.key)&&r.dispatchEvent({type:"beginEvent",eventName:e}),n.forEach(s=>{"key"in s.data&&s.data.key===t.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(t,e,i=!1){this.objectsPerTypes[e].forEach(r=>{this.eventsPerObjects[e][r.uuid].forEach(n=>{"key"in n.data&&n.data.key===t.key&&n.dispatchHeld(i)})})}},FLe=new N,zLe=new N,tie=class{constructor(t,e,i,r,n){this.actionsIn=Xo(t,t.inActions,i,r,n,e),this.actionsOut=Xo(t,t.outActions,i,r,n,e)}disconnect(){Es(this.actionsIn),Es(this.actionsOut)}},HLe=class extends tie{constructor(t,e,i,r,n,s){super(e,i,r,n,s),this.id=t,this.data=e,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let d of this.objects)if(!d.visible)return;let u=FLe.setFromMatrixPosition(this.objects[0].matrixWorld),c=zLe.setFromMatrixPosition(this.objects[1].matrixWorld),h=u.distanceTo(c)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(p=>p.dispatchConditional()),d.Particles.forEach(p=>p.dispatchConditional()),d.Video.forEach(p=>p.dispatchConditional()),d.Link.forEach(p=>p.dispatch()),d.Create.forEach(p=>p.dispatch()),d.Destroy.forEach(p=>p.dispatch()),d.Reset.forEach(p=>p.dispatch()),d.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),d.Transition.forEach(p=>p.play()),d.Animation.forEach(p=>p.play()),d.SwitchCamera.forEach(p=>p.play()),d.SceneTransition.forEach(p=>p.dispatch()),d.SetVariable.forEach(p=>p.checkConditions()),d.SetVariable.forEach(p=>p.dispatch()),d.DynamicVariablePlay.forEach(p=>p.dispatch())}};let{distance:o,fromObject:a,toObject:l}=e.condition;this.distance=o;for(let u of[a,l]){if(!u)throw new Error("Missing property");let c=r.find(u);if(!c)throw new Error("Missing property");this.objects.push(c)}}connect(){window.setTimeout(()=>{this.objects.forEach(t=>{t.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(t=>{t.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},GLe=class extends tie{constructor(t,e,i,r,n,s){var l;super(e,i,r,n,s),this.id=t,this.data=e,this.object=i,this.onBegin=({target:u,state:c})=>{this.toState!==c&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Particles.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()),this.actionsOut.SetVariable.forEach(h=>h.checkConditions()),this.actionsOut.SetVariable.forEach(h=>h.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(h=>h.dispatch()))},this.onComplete=({target:u,state:c})=>{this.toState===c&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Particles.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()),this.actionsIn.SetVariable.forEach(h=>h.checkConditions()),this.actionsIn.SetVariable.forEach(h=>h.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(h=>h.dispatch()))};let{condition:o}=e;if(!o.object)throw new Error("Missing property");let a=r.find(o.object)??r.scene.find2D(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){Kf(this.actionsOut).forEach(t=>{var e;(e=this.actionsOut[t])!=null&&e.length&&this.toObject.addEventListener("beginState",this.onBegin)}),Kf(this.actionsIn).forEach(t=>{var e;(e=this.actionsIn[t])!=null&&e.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),Kf(this.actionsOut).forEach(t=>{var e;(e=this.actionsIn[t])!=null&&e.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),Kf(this.actionsIn).forEach(t=>{var e;(e=this.actionsIn[t])!=null&&e.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},VLe=class extends Lu{constructor(t,e){super(t),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:i,sharedAssets:r}=this.eventContext;i.traverseEntity(n=>{var s;if((s=n.data)!=null&&s.events.length){for(let{id:o,data:a}of n.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new HLe(o,a,n,i,r,e):a.condition.type==="State"&&(l=new GLe(o,a,n,i,r,e))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.disconnect()))}},ux=new N,Dd=new N,mf=new N,fq=new Ba,jLe=.01,Ki=new N,Qn=new N,mq=new N,im=new ni,A3=new ts,WLe=new lt,E3=new wn,$g=new N,ih=new N,ey=.2;function M3(t,e){!e||(e[0]<e[1]&&(t.x=Math.min(Math.max(t.x,e[0]),e[1])),e[2]<e[3]&&(t.y=Math.min(Math.max(t.y,e[2]),e[3])),e[4]<e[5]&&(t.z=Math.min(Math.max(t.z,e[4]),e[5])))}var qLe=function(){let t=new lt;return(e,i,r)=>{let n=e.obj;t.copy(n.hiddenMatrix),n.parent!==null&&t.premultiply(n.parent.matrixWorld),t.invert(),n.position.copy(i),e.reference==="global"&&M3(n.position,e.limits),n.position.applyMatrix4(t),e.reference==="parent"?M3(n.position,e.limits):e.reference==="local"&&(im.copy(e.quat0).invert(),n.position.sub(e.position0),n.position.applyQuaternion(im),M3(n.position,e.limits),im.invert(),n.position.applyQuaternion(im),n.position.add(e.position0)),t.multiply(r??n.matrixWorld).decompose(Ki,n.quaternion,Qn),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof qo&&zc(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),XLe=class{constructor(t,e,i,r,n,s){this.object=t,this.data=e,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Xo(e,e.dragDropActions.drag,i,r,n,this.object),this.actionsDrop=Xo(e,e.dragDropActions.drop,i,r,n,this.object);let o=[];this.data.objects.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(o.push(l),s[l.uuid]&&s[l.uuid].forEach(u=>{let c=i.find(u);!c||c.data.visible!==!1&&o.push(c)}))}),this.data.dropDestinations.forEach(a=>{let l=i.find(a);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(u=>{let c=i.find(u);!c||c.data.visible!==!1&&this.dropDestIds.push(c.uuid)}))}),this.dragItems=o.map(a=>(this.data.planeMode==="locked"&&(a.userData.lockedPlane=!0),a.userData.worldPosition0=new N().setFromMatrixPosition(a.matrixWorld),{obj:a,fromPosition:new N().setFromMatrixPosition(a.matrixWorld),pointStart:new N,pointEnd:new N,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new N().copy(a.position),quat0:new ni().copy(a.quaternion),snapped:!1,orientationMatrix:new lt,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Es(this.actionsDrag),Es(this.actionsDrop),this.dragItems.forEach(t=>{t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart),t.obj.recursiveBBoxNeedsUpdate=!0,t.obj.userData.lockedPlane=void 0,t.obj.position.copy(t.position0),t.obj.quaternion.copy(t.quat0),t.obj.updateMatrix()})}},YLe=class extends Lu{constructor(t,e){super(t),this.eventManager=e,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=r=>{var a;if(Qt.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:n,page:s}=this.eventContext,o=s.raycastWithClones(n);if(this.lastDropDestination=null,o.length===0){this.activeEvent=null;return}for(let l of this.events){let u=0;for(let{obj:c,pointEnd:h,pointStart:d}of l.dragItems){if(c===o[0].object||c===o[0].object.object||Ti.is(c)&&c.isAncestorOf(o[0].object.uuid)){if(l.activeIdx=u,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let p=l.activeDragItem.obj;c.hasNonUniformScale&&c.updateMatrixWorldSVD(),(p.hasNonUniformScale?p.matrixWorldRigid:p.matrixWorld).decompose(Ki,im,Qn),A3.setFromQuaternion(im),p.prevR===void 0?(p.prevR=A3.clone(),p.prevT=Ki.clone()):(p.prevR.copy(A3),p.prevT.copy(Ki)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(c,d,l.data.plane,l.data.referenceFrame),h.copy(d),(this.eventManager.controlsManager.usePhysics&&((a=c.data.physics)==null?void 0:a.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}u++}}this.activeEvent=null},this.onPointerMove=r=>{var a,l,u,c;if(Qt.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:n,page:s}=this.eventContext,o=s.raycastWithClones(n);if(Qt.length===0){let h=!1;for(let d of this.events){for(let{obj:p}of d.dragItems)if(p===((a=o[0])==null?void 0:a.object)||p===((u=(l=o[0])==null?void 0:l.object)==null?void 0:u.object)||Ti.is(p)&&p.isAncestorOf((c=o[0])==null?void 0:c.object.uuid)){switch(h=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=o.filter(p=>h.obj!==p.object&&!h.obj.isAncestorOf(p.object.uuid)&&!(p.object instanceof Bv)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===p.object.uuid||s.scene.find(f).isAncestorOf(p.object.uuid))))[0]),d){let p=mq.copy(d.face.normal).applyMatrix3(E3.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){Ki.copy(p).applyMatrix3(E3.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;Ki.x>ey?Qn.x=-f.recursiveBBox.min.x:Ki.x<-ey&&(Qn.x=-f.recursiveBBox.max.x),Ki.y>ey?Qn.y=-f.recursiveBBox.min.y:Ki.y<-ey&&(Qn.y=-f.recursiveBBox.max.y),Ki.z>ey?Qn.z=-f.recursiveBBox.min.z:Ki.z<-ey&&(Qn.z=-f.recursiveBBox.max.z),Qn.applyMatrix3(E3.invert())}else Qn.copy(p).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(Qn)}this.activeEvent.data.autoOrient&&(Ki.set(0,1,0).cross(p),Ki.length()<1e-4&&Ki.set(-1,0,0).cross(p),Qn.crossVectors(mq,Ki),h.orientationMatrix.makeBasis(Ki,Qn,p)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.stop()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(p=>{p.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(p=>{p.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(p=>p.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(p=>p.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(p=>p.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(p=>{p.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.stop()}))},500),this.updateDragItem(h),h.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=r=>{var n;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((n=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:n.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(o=>{o.stop(),o.object.currentState!==null&&o.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(o=>{o.stop()}),this.activeEvent.actionsDrag.Audio.forEach(o=>{o.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(o=>{o.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(o=>o.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(o=>o.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(o=>o.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let i={};t.page.traverseEntity(r=>{r.component&&(i[r.component.uuid]?i[r.component.uuid].push(r.uuid):i[r.component.uuid]=[r.uuid])}),t.page.traverseEntity(r=>{var n;(n=r.data)==null||n.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new XLe(r,s.data,t.page,t.sharedAssets,e,i))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let e of t.dragItems)e.paused||this.updateDragItem(e,!0)}calcPlaneIntersectPos(t,e,i,r){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(Dd),Dd.negate();let o=im.identity();switch(r==="parent"?WLe.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix).decompose(Ki,o,Qn):r==="local"&&t.matrixWorld.decompose(Ki,o,Qn),i){case"x":Ki.set(1,0,0).applyQuaternion(o),$g.copy(Dd).cross(Ki),ih.copy(Ki).cross($g);break;case"y":Ki.set(0,1,0).applyQuaternion(o),$g.copy(Dd).cross(Ki),ih.copy(Ki).cross($g);break;case"z":Ki.set(0,0,1).applyQuaternion(o),$g.copy(Dd).cross(Ki),ih.copy(Ki).cross($g);break;case"xy":ih.set(0,0,1).applyQuaternion(o);break;case"yz":ih.set(1,0,0).applyQuaternion(o);break;case"xz":ih.set(0,1,0).applyQuaternion(o);break;case"adaptive":Dd.angleTo(Qn.set(0,1,0))>Math.PI/6?(Ki.crossVectors(Qn.set(0,1,0),Dd),ih.crossVectors(Ki,Qn)):ih.set(0,1,0);break;default:ih.copy(Dd);break}mf.setFromMatrixPosition(t.matrixWorld);let a=t.userData.lockedPlane?t.userData.worldPosition0:mf;if(fq.setFromNormalAndCoplanarPoint(ih,a),!!s.ray.intersectPlane(fq,e)&&(i==="x"||i==="y"||i==="z")){let l=Qn.subVectors(e,a).dot(Ki);e.copy(a).addScaledVector(Ki,l)}}updateDragItem(t,e=!1){var i,r;mf.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?ux.subVectors(t.fromPosition,mf).divideScalar(t.currentDampingFactor):t.reset==="original"?(ux.subVectors(t.obj.userData.worldPosition0,mf).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):ux.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(mf).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?ux.length()<jLe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||e)&&qLe(t,ux.add(mf),(i=this.activeEvent)!=null&&i.data.drop&&((r=this.activeEvent)!=null&&r.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},ty=new N,C3=new N,cc=new N,dc=new N,gq=new Ba,KLe=.01,JLe={type:"requestRender"},QLe=function(){let t=new N,e=new N;return(i,r,n)=>n>0?(t.subVectors(i,r),t.length()<=n?i:e.copy(r).add(t.normalize().multiplyScalar(n))):r}(),yq=function(){let t=new lt;return(e,i)=>{e.position.copy(i),e.parent!==null&&(t.copy(e.parent.matrixWorld).invert(),e.position.applyMatrix4(t)),t.copy(e.hiddenMatrix).invert(),e.position.applyMatrix4(t),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof qo&&zc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),ZLe=class{constructor(t,e,i,r,n){this.data=t,this.object=e,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new N,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...vB.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Xo(t,t.actions,i,r,n,e)}},$Le=class extends Lu{constructor(t,e){super(t),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=r=>{if(!(Qt.length>1)){this.eventContext.updateRaycaster(r);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=r=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=r=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)};let{page:i}=this.eventContext;i.traverseEntity(r=>{var s,o;let n=(s=r.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);n&&(!i.data.globalPhysics.usePhysics||((o=r.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new ZLe(n.data,r,i,t.sharedAssets,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),za&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let r=i.target,n=this.onTargetChange(i);this.pairOfEventListeners.push([r,n]),r.addEventListener("requestRender",n)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),za&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let i of this.events)i.paused=!0,i.isReset=!1,Es(i.actions)}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t,!0)}updateSingleEvent(t,e=!1){var o;this.events.forEach(a=>{a.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:r,limitDistanceEnabled:n}=t.data;if(t.object.getWorldPosition(cc),t.isReset)dc.copy(t.worldPosition0);else if(t.target)t.target.getWorldPosition(dc);else{let{getCamera:a,raycaster:l}=this.eventContext;if(i==="custom"?(a().getWorldDirection(C3),C3.negate(),ty.copy(C3)):i==="xy"?ty.set(0,0,1):i==="xz"?ty.set(0,1,0):i==="yz"&&ty.set(1,0,0),gq.setFromNormalAndCoplanarPoint(ty,cc),!l.ray.intersectPlane(gq,dc))return}if(!t.isReset){if(dc.distanceTo(t.worldPosition0)>r&&n&&t.target)if(t.snapComplete=!1,t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)dc.copy(t.worldPosition0),t.currentDampingFactor=t.resetDampingFactor;else return;else if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return}t.data.enabledTranslation[0]===!1&&(dc.x=cc.x),t.data.enabledTranslation[1]===!1&&(dc.y=cc.y),t.data.enabledTranslation[2]===!1&&(dc.z=cc.z);let s=QLe(cc,dc,t.wasOutside?0:t.data.maxDelta);if(t.currentDampingFactor>1){let a=ty.subVectors(s,cc).divideScalar(t.currentDampingFactor);cc.add(a),e&&yq(t.object,cc),t.paused=a.length()<KLe}else yq(t.object,s),t.paused=!0;(o=t.object)==null||o.dispatchEvent({type:"beginEvent",eventName:"Follow"}),t.object.dispatchEvent(JLe)}},hx=new N,rE=new N,cx=new lt,iy=new ni,Id=new ni,dx=new N,px=new N,gf=new N,pc=new N,P3=new Ba,eBe=1e-6,tBe={type:"requestRender"},iBe={type:"changeRotation"},vq=function(){let t=new lt;return function(e,i){e.parent!==null?t.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix):t.copy(e.hiddenMatrix),i.premultiply(Jte(t).invert()),e.rotation.setFromRotationMatrix(i),e.updateMatrix(),e instanceof qo&&zc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),rBe=class{constructor(t,e,i){this.object=e,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new ni,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...bB.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(this.target=i.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},nBe=class extends Lu{constructor(t){super(t),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=i=>{if(!(Qt.length>1)){this._lastMouseEvent=i,this.eventContext.updateRaycaster(i);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=i=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=i=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onScroll=i=>{if(this._lastMouseEvent){let r=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(r)}},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)},this.createUserEventListener=i=>({eventName:r,target:n})=>{if(!r||!n)return;let s=o_(r);s&&s==="LookAt"&&this.updateSingleEvent(i)};let{page:e}=this.eventContext;e.traverseEntity(i=>{var n,s;let r=(n=i.data)==null?void 0:n.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);r&&(!e.data.globalPhysics.usePhysics||((s=i.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new rBe(r.data,i,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),za&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?e.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let s=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let r=this.createUserEventListener(i),n=i.object;this.pairOfUserEventListeners.push([n,r]),n.addEventListener("userEvent",r)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),za&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave),e.removeEventListener("scroll",this.onScroll);for(let[i,r]of this.pairOfEventListeners)i.removeEventListener("requestRender",r);for(let[i,r]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",r);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var d;let{tilt:e,axis:i,distance:r,plane:n,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=t.data,{getCamera:l,raycaster:u}=this.eventContext,{object:c,target:h}=t;if(c.getWorldPosition(dx),!t.isReset)if(t.target)t.target.getWorldPosition(px);else{if(n==="custom"?(l().getWorldDirection(rE),rE.negate(),P3.setFromNormalAndCoplanarPoint(rE,dx)):(n==="xy"?hx.set(0,0,1):n==="xz"?hx.set(0,1,0):n==="yz"&&hx.set(1,0,0),P3.setFromNormalAndCoplanarPoint(hx,dx)),!u.ray.intersectPlane(P3,px))return;r>0&&(n==="custom"||n===void 0)&&px.addScaledVector(rE,r)}if(t.isReset||(h?e==="target"?gf.copy(h.up).applyMatrix4(cx.extractRotation(h.matrixWorld)).normalize():o.some(p=>p===!1)?(i==="x"?(pc.set(0,0,1),o[2]===!1&&pc.set(0,1,0)):i==="y"?(pc.set(1,0,0),o[0]===!1&&pc.set(0,0,1)):(pc.set(0,1,0),o[1]===!1&&pc.set(1,0,0)),gf.copy(pc).applyQuaternion(t.worldQuaternion0).normalize()):gf.set(0,1,0):n==="custom"?gf.set(0,1,0):gf.copy(hx)),t.isReset)Id.copy(t.worldQuaternion0);else if(dx.distanceTo(px)>s&&a&&h)if(t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Id.copy(t.worldQuaternion0),t.currentDampingFactor=t.resetDampingFactor;else return;else{if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return;sBe(cx,px,dx,gf,i,pc),Id.setFromRotationMatrix(cx),iy.setFromUnitVectors(pc.applyQuaternion(Id),gf),o.some(p=>p===!1)&&e!=="target"&&Id.premultiply(iy).normalize()}t.currentDampingFactor>1?(c.updateWorldMatrix(!0,!1),iy.setFromRotationMatrix(Jte(c.matrixWorld)),iy.slerp(Id,1/t.currentDampingFactor),vq(c,cx.makeRotationFromQuaternion(iy)),t.paused=8*(1-iy.dot(Id))<eBe):(vq(c,cx.makeRotationFromQuaternion(Id)),t.paused=!0),(d=t.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),c.dispatchEvent(tBe),c.dispatchEvent(iBe)}},fl=new N,Jn=new N,gn=new N;function sBe(t,e,i,r,n,s){let o=t.elements;gn.subVectors(e,i),gn.lengthSq()===0&&(gn.z=1),gn.normalize(),Jn.crossVectors(r,gn),Jn.lengthSq()===0&&(Math.abs(r.z)===1?gn.x+=1e-4:gn.z+=1e-4,gn.normalize(),Jn.crossVectors(r,gn)),Jn.normalize(),fl.crossVectors(gn,Jn),n==="x"?s.z===1?[Jn,fl,gn]=[gn,Jn,fl]:(Jn.negate(),[Jn,gn]=[gn,Jn]):n==="y"?s.x===1?[Jn,fl,gn]=[fl,gn,Jn]:(Jn.negate(),[fl,gn]=[gn,fl]):s.x===1&&(Jn.negate(),[Jn,fl]=[fl,Jn]),o[0]=Jn.x,o[4]=fl.x,o[8]=gn.x,o[1]=Jn.y,o[5]=fl.y,o[9]=gn.y,o[2]=Jn.z,o[6]=fl.z,o[10]=gn.z}var oBe=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.entered=!1,this.actions=Xo(e,e.actions,r,n,s,i)}disconnect(){Es(this.actions)}dispatchEnter(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.play()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}},aBe=class extends Lu{constructor(t,e){super(t),this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=s=>{Qt.length>1||(this.eventContext.updateRaycaster(s),this.handleMouseHoverEvent())},this.onMouseUp=s=>{Qt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=s=>{Qt.length>1||(this.eventContext.updateRaycaster(s),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:s,target:o,reverse:a})=>{var u;if(!s||!o)return;let l=o_(s);l&&l==="MouseHover"&&(o.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(u=this.eventsPerObjects[o.uuid])==null||u.forEach(c=>c.dispatchUserEvent(a)))};let{page:i,sharedAssets:r}=this.eventContext,n=(s,o)=>{var a,l;if(!(!s.visible||!((a=s.data)!=null&&a.events.length))){for(let{id:u,data:c}of s.data.events)if(!c.disabled&&c.type==="MouseHover")try{let h=new oBe(u,c,s,i,r,e);this.eventsPerObjects[s.uuid]?this.eventsPerObjects[s.uuid].push(h):this.eventsPerObjects[s.uuid]=[h]}catch{}(l=this.eventsPerObjects[s.uuid])!=null&&l.length&&this.objects.push(s instanceof Cs?o:s)}};i.traverseEntity(s=>{var o;(s instanceof ho||s instanceof bs)&&((o=s.frame)==null||o.traverse(a=>{n(a,s)})),n(s)})}connect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),za&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),za&&(t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerup",this.onMouseUp)),t.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(i=>{i.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(t=!1){let e=[];if(!t){let{stopRaycast:i,raycaster:r,page:n,pointerScreen:s}=this.eventContext,o=!1;if(n.uiCanvas&&(o=Rc(n,[s.x,s.y],Object.keys(this.eventsPerObjects),a=>{e.push(a)})),i&&!o){let a=zM(r,n,this.objects);e=FO(a),a.forEach(l=>{var u,c;l.object instanceof ho&&Rc(l.object,[((u=l==null?void 0:l.uv)==null?void 0:u.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),h=>{e.push(h)})})}else this.objects.forEach(a=>{var u,c;let l=G2(r,a);l&&(e.push(a),a instanceof ho&&Rc(a,[((u=l==null?void 0:l.uv)==null?void 0:u.x)??0,((c=l==null?void 0:l.uv)==null?void 0:c.y)??0],Object.keys(this.eventsPerObjects),h=>{e.push(h)}))})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var r;e.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(n=>n.dispatchLeave()))}),e.length&&e.forEach(i=>{var r;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(r=this.eventsPerObjects[i.uuid])==null||r.forEach(n=>n.dispatchEnter())}),this._prevObjects=e}},lBe=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.scrollCounter=0,this.actions=Xo(e,e.actions,r,n,s,i)}connect(){this.scrollCounter=0}disconnect(){Es(this.actions)}dispatch(t){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let e=t>0?1:-1;this.scrollCounter+=e,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(r=>r.seek(i)),this.actions.Animation.forEach(r=>r.seek(e)),this.actions.Create.forEach(r=>r.dispatchThrottled()),this.actions.SetVariable.forEach(r=>r.checkConditions()),this.actions.SetVariable.forEach(r=>r.dispatch()),this.actions.DynamicVariablePlay.forEach(r=>r.dispatch())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}},uBe=class{constructor(t,e,i,r,n,s,o){this.id=t,this.data=e,this.object=i,this.domElement=s,this.eventManager=o,this.scrollStart=0,this.scrollEnd=0,this.actions=Xo(e,e.actions,r,n,o,i)}computeScrollBounds(){let t=this.domElement.getBoundingClientRect(),e=document.body,i=document.documentElement,r=window.pageYOffset||i.scrollTop||e.scrollTop,n=i.clientTop||e.clientTop||0,s=Math.round(t.top+r-n);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=t.height,l=this.data.enterAnchor,u=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-u}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=t,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Es(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:t,y:e}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let i=this.scrollEnd-this.scrollStart,r=Math.min(1,Math.max(0,(e-this.scrollStart)/i));this.actions.Transition.forEach(n=>n.seek(r)),this.actions.Animation.forEach(n=>n.seek(r)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch())}dispatch(t){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(t)}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Animation.forEach(e=>{e.playFromCurrent()})),this.actions.Create.forEach(e=>e.dispatchThrottled()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch())}},hBe=class extends Lu{constructor(t,e){super(t),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([a,l])=>{l.forEach(u=>u.handleResize())})},this.onScroll=a=>{if(!this.isInview)return;let l={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([u,c])=>{u.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:l}),c.forEach(h=>h.dispatch(l))})},this.onWheel=a=>{!this.isInview||a.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([l,u])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:a.deltaY}),u.forEach(c=>c.dispatch(a.deltaY))})},this.onUserEvent=({eventName:a,target:l,reverse:u})=>{var h;if(!a||!l)return;let c=o_(a);c&&c==="Scroll"&&(l.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(l))==null||h.forEach(d=>{d.dispatchUserEvent(u)}))};let{page:i,sharedAssets:r,domElement:n,isExport:s}=this.eventContext,o=a=>{var l,u,c;if((l=a.data)!=null&&l.events.length){for(let{id:h,data:d}of a.data.events)if(!d.disabled&&d.type==="Scroll")if(d.trigger==="load"||!s){let p=new lBe(h,d,a,i,r,e);this.wheelEventsPerObject.has(a)?(u=this.wheelEventsPerObject.get(a))==null||u.push(p):this.wheelEventsPerObject.set(a,[p])}else{let p=new uBe(h,d,a,i,r,n,e);this.scrollEventsPerObject.has(a)?(c=this.scrollEventsPerObject.get(a))==null||c.push(p):this.scrollEventsPerObject.set(a,[p])}}};i.traverseEntity(a=>{var l;(a instanceof ho||a instanceof bs)&&((l=a.frame)==null||l.traverse(u=>{o(u)})),o(a)}),this.intersectionObserver=new IntersectionObserver(a=>{let l=a[0];l&&(this.isInview=l.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(i=>i.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},cBe=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.actions=Xo(e,e.actions,r,n,s,i)}disconnect(){Es(this.actions)}dispatch(){this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatchFromStart()}),this.actions.Destroy.forEach(t=>{t.dispatchFromStart()})}dispatchAfter(t){this.actions.Audio.forEach(e=>{(e.interaction.data.triggerAfter??"any")===t&&(e.interaction instanceof tm?e.interaction.audioPlayer.play():e.interaction instanceof IO&&e.interaction.dispatch())}),this.actions.Video.forEach(e=>{let i=e.interaction.data.triggerAfter??"autoplay";i===t&&(e.interaction instanceof Nv?e.interaction.play(i==="autoplay"):e.interaction instanceof UO&&e.interaction.dispatch())}),this.actions.Particles.forEach(e=>{(e.data.triggerAfter??"any")===t&&e.dispatchBasic()})}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof tm?e.interaction.audioPlayer.play():e.interaction instanceof IO&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof Nv?e.interaction.play():e.interaction instanceof UO&&e.interaction.dispatch()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()})}},dBe=class extends Lu{constructor(t,e){super(t),this.eventManager=e,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:r}=this.eventContext;(r?document:i).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof tm&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let o=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof Nv&&s.interaction.play(o==="autoplay")}),n.actions.Particles.forEach(s=>{s.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),r.forEach(n=>{n.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:r,reverse:n})=>{var o,a;if(!i||!r)return;let s=o_(i);s&&s==="Start"&&(r instanceof Cs||r.dispatchEvent({type:"beginEvent",eventName:"Start"}),(o=this.eventsPerObject.get(r))==null||o.forEach(l=>{l.dispatchUserEvent(n)}),(a=this.eventsAfterPerObject.get(r))==null||a.forEach(l=>{l.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:t,page:e}=this.eventContext,i=r=>{var n,s,o,a,l;if((n=r.data)!=null&&n.events.length)for(let{id:u,data:c}of r.data.events){if(c.disabled||c.type!=="Start")continue;let h=new cBe(u,c,r,e,t,this.eventManager);(h.actions.Transition.length||h.actions.Animation.length||h.actions.SwitchCamera.length||h.actions.Create.length||h.actions.Destroy.length||h.actions.SceneTransition.length||h.actions.Reset.length||h.actions.SetVariable.length||h.actions.DynamicVariablePlay.length)&&(this.eventsPerObject.has(r)?(s=this.eventsPerObject.get(r))==null||s.push(h):this.eventsPerObject.set(r,[h])),h.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(o=this.eventsAfterPerObject.get(r))==null||o.push(h):this.eventsAfterPerObject.set(r,[h])),h.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(h):this.eventsAfterPerObject.set(r,[h])),h.actions.Particles.length&&(this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(h):this.eventsAfterPerObject.set(r,[h]))}};if(e.traverseEntity(r=>{var n;(r instanceof ho||r instanceof bs)&&((n=r.frame)==null||n.traverse(s=>{i(s)})),i(r)}),[...this.eventsAfterPerObject.values()].some(r=>r.length)){if(this.eventManager.activateCount===0){let{domElement:r,isExport:n}=this.eventContext,s=n?document:r;s.addEventListener("pointerdown",this.onMouseDown,{once:!0}),s.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),s.addEventListener("pointerdown",this.onAny),s.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,a])=>{o.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([r,n])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(s=>s.dispatch()),r.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,i=e?document:t;i.removeEventListener("pointerdown",this.onMouseDown),i.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,n])=>{r.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.removeEventListener("userEvent",this.onUserEvent),e.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},pBe=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.disabled=!1,this.alreadyPlayedNonTogglingActions=new Set,this.actions=Xo(e,e.actions,r,n,s,i),this.target=e.target,this.useToggle=e.runMode==="Toggle"}disconnect(){Es(this.actions)}dispatch(t){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this?(e.object.currentTransitionEvent=this,e.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(e)}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.Animation.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{this.alreadyPlayedNonTogglingActions.has(e)===!1&&e.play()}),this.actions.Animation.forEach(e=>{e.play()})),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(t??!1)}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}))}},fBe=class extends Lu{constructor(t,e,i,r,n){super(t),this.sharedVariables=e,this.eventManager=i,this.needsMouse=r,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.events=[],this.onFrame=s=>{this.rafId=window.requestAnimationFrame(this.onFrame);let o=new Date,a=[],l=[];for(let h=0;h<this.propertiesToWatch.length;h++){let{objectId:d,property:p,prevValue:f}=this.propertiesToWatch[h],m=this.eventContext.scene.find(d),g=wB.propertyPaths[p];if(g[0]==="width"||g[0]==="height"||g[0]==="depth")m=m.geometry.userData.parameters[g[0]];else for(let y=0;y<g.length;y++)m=m[g[y]];f===null?this.propertiesToWatch[h].prevValue=m instanceof N?m.clone():m:(m instanceof N?!m.equals(f):f!==m)&&(l.push({objId:d,property:p}),m instanceof N?this.propertiesToWatch[h].prevValue.copy(m):this.propertiesToWatch[h].prevValue=m)}for(let h=0;h<this.variablesToWatch.length;h++){let{id:d,prevValue:p}=this.variablesToWatch[h],f=this.shared.getVariable(d);f!==p&&(a.push(d),this.variablesToWatch[h].prevValue=f)}for(let h=0;h<this.dynamicVars.length;h++){let{id:d,expectedTime:p,last:f,data:m,timerSeconds:g,startValue:y}=this.dynamicVars[h],v=1e3;if((m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&m.format==="number3decimal"?v=1:m.dynamicVariableType==="counter"?v=m.updateInterval:m.dynamicVariableType==="random"&&(v=m.isStatic?1/0:m.updateInterval),p===-1){this.dynamicVars[h].last=s,this.dynamicVars[h].expectedTime=s+v;continue}if(!((this.shared.getDynamicVariablePlayState(d)==="Stopped"||this.shared.getDynamicVariablePlayState(d)==="Restarted")&&(this.dynamicVars[h].last=s,this.dynamicVars[h].expectedTime=s+v,m.dynamicVariableType==="counter"&&this.shared.getVariable(d)!==y&&(this.shared.updateVariable(d,y),this.eventManager.requestRender()),(m.dynamicVariableType==="timer"||m.dynamicVariableType==="stopwatch")&&this.dynamicVars[h].timerSeconds!==y&&(this.dynamicVars[h].timerSeconds=y,this.shared.updateVariable(d,wl.getFormattedTimerTime(y,m)),this.eventManager.requestRender()),this.shared.getDynamicVariablePlayState(d)==="Restarted"&&this.shared.setDynamicVariablePlayState(d,"Playing"),this.shared.getDynamicVariablePlayState(d)==="Stopped"))){if(this.shared.getDynamicVariablePlayState(d)==="Paused"){this.dynamicVars[h].deltaToExpectedTime===void 0&&(this.dynamicVars[h].deltaToExpectedTime=Math.max(this.dynamicVars[h].expectedTime-s,0)),this.dynamicVars[h].last=s-(v-this.dynamicVars[h].deltaToExpectedTime),this.dynamicVars[h].expectedTime=s+this.dynamicVars[h].deltaToExpectedTime;continue}else this.dynamicVars[h].deltaToExpectedTime=void 0;if(s>=p)if(this.dynamicVars[h].last=s,this.dynamicVars[h].expectedTime+=v,m.dynamicVariableType==="random"){let b=m.min+Math.random()*(m.max-m.min),_=m.decimals;b=Math.round(b*Math.pow(10,_))/Math.pow(10,_),this.shared.updateVariable(d,b),a.push(d),this.eventManager.requestRender()}else if(m.dynamicVariableType==="counter"){if(m.increment===0)continue;let b=this.shared.getVariable(d),_=this.shared.getDynamicVariableToggleIsForward(d)??!0,A=this.shared.getVariable(d)+m.increment*(_?1:-1);m.hasEnd&&(A=m.increment>0?kt.clamp(A,y,m.endValue):kt.clamp(A,m.endValue,y),A===y&&this.shared.setDynamicVariableToggleIsForward(d,void 0),m.repeat?A===m.endValue&&(A=y):(A===y||A===m.endValue)&&this.shared.setDynamicVariablePlayState(d,"Paused")),A!==b&&(a.push(d),this.shared.updateVariable(d,A),this.eventManager.requestRender())}else if(m.dynamicVariableType==="time")this.shared.updateVariable(d,O9(o,m)),a.push(d),this.eventManager.requestRender();else{let b=Ha.isTextValue(m.endValue)?bq(m.endValue.textValue):m.endValue,_=this.shared.getDynamicVariableToggleIsForward(d)??!0,A=g+(s-f)/1e3*(m.dynamicVariableType==="timer"?-1:1)*(_?1:-1);A=Math.max(A,0),m.hasEnd&&(A=m.dynamicVariableType==="stopwatch"?kt.clamp(A,y,b):kt.clamp(A,b,y),A===y&&this.shared.setDynamicVariableToggleIsForward(d,void 0),m.repeat?Math.abs(A-b)<(m.format==="number3decimal"?1e-4:.1)&&(A=y):(Math.abs(A-y)<(m.format==="number3decimal"?1e-4:.1)||Math.abs(A-b)<(m.format==="number3decimal"?1e-4:.1))&&this.shared.setDynamicVariablePlayState(d,"Paused")),A!==g&&(a.push(d),this.dynamicVars[h].timerSeconds=A,this.shared.updateVariable(d,wl.getFormattedTimerTime(A,m)),this.eventManager.requestRender())}}}this.needsMouse&&this.shared.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=this.shared.mouseProperty,this.events.forEach(h=>{h.data.variableId==="mouseProperty"&&(h.dispatch(),this.eventManager.requestRender())}));let u=!1;this.shared.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=this.shared.mouseProperty,u=!0);let c=!1;this.shared.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=this.shared.raycastProperty,c=!0),this.events.forEach(h=>{(a.includes(h.data.variableId)||l.find(d=>d.objId===h.data.objectId&&d.property===h.data.property)||h.data.variableId==="mouseProperty"&&u||h.data.variableId==="raycastProperty"&&c)&&(h.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()},t.page.traverseEntity(s=>{var o;(o=s.data)==null||o.events.filter(a=>a.data.type==="VariableChange"&&!a.data.disabled).forEach(a=>{this.events.push(new mBe(s.uuid,a.data,s,t.page,t.sharedAssets,i))})}),this.propertiesToWatch=this.events.filter(s=>s.data.variableId==="objectProperty"&&s.data.objectId!==null).map(s=>({objectId:s.data.objectId,property:s.data.property,prevValue:null})),this.shared=t.sharedAssets,this.sharedVariables.forEach(({id:s,data:o})=>{if(!("dynamicVariableType"in o)){this.events.find(l=>l.data.variableId===s)&&this.variablesToWatch.push({id:s,prevValue:this.shared.getVariable(s)});return}let a;if(o.dynamicVariableType==="timer"||o.dynamicVariableType==="stopwatch"){let l;if(Ha.isTextValue(o.value)&&Array.isArray(o.value.textValue)){let u=o.value.textValue;u.length===3?l=u[2]+u[1]*60+u[0]*3600:l=u[1]+u[0]*60}else l=o.value;a=l,this.dynamicVars.push({id:s,last:-1,expectedTime:-1,data:o,timerSeconds:l,startValue:a})}else o.dynamicVariableType==="time"&&this.shared.updateVariable(s,O9(new Date,o)),o.dynamicVariableType==="counter"&&(a=Ha.isTextValue(o.value)?bq(o.value.textValue):o.value),this.dynamicVars.push({id:s,last:-1,expectedTime:-1,data:o,startValue:a})})}pause(){this.pauseTime=Date.now()}resume(){let t=Date.now()-this.pauseTime;for(let e=0;e<this.dynamicVars.length;e++)this.dynamicVars[e].last+=t,this.dynamicVars[e].expectedTime+=t}connect(){this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(t=>t.dispose())}},mBe=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.actions=Xo(e,e.actions,r,n,s,i)}dispatch(){let t=this.actions;t.Audio.forEach(e=>e.dispatchConditional()),t.Particles.forEach(e=>e.dispatchConditional()),t.Video.forEach(e=>e.dispatchConditional()),t.Create.forEach(e=>e.dispatch()),t.Destroy.forEach(e=>e.dispatch()),t.Reset.forEach(e=>e.dispatch()),t.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this),e.init()}),t.Transition.forEach(e=>e.play()),t.Animation.forEach(e=>e.play()),t.SwitchCamera.forEach(e=>e.play()),t.SceneTransition.forEach(e=>e.dispatch()),t.SetVariable.forEach(e=>e.checkConditions()),t.SetVariable.forEach(e=>e.dispatch()),t.DynamicVariablePlay.forEach(e=>e.dispatch())}dispose(){Es(this.actions)}};function bq(t){return t.length===3?t[2]+t[1]*60+t[0]*3600:t[1]+t[0]*60}var gBe="https://unpkg.com/@splinetool/runtime@1.0.53/build/",yBe="https://unpkg.com/@splinetool/navmesh-wasm@1.0.53/build/",vBe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${gBe}' + 'navmesh.js'),
		fetch('${yBe}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,bBe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,xBe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,wBe=.001,_Be={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},iie,Pi,Ls;wEe.then(t=>{iie=t,Pi=new t.Vec3,Ls=new t.Vec3});var SBe=new N,ABe=class{constructor(t=!1,e=!1){this.usePhysics=t,this.isExport=e,this.onPointerDown=i=>{if(Qt.length!==1)return;let{raycaster:r,page:n}=this.eventContext;this.eventContext.updateRaycaster(i);let s=n.raycastWithClones(r);if(s.length!==0){if(this.gameControl){let o=SBe.copy(this.gameControl.colliderWorldPosition);o.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(o,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,r)=>n=>{var d,p,f,m,g,y,v;let s;if(n instanceof vu)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof co)s=n.object;else if(s=n,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((p=s.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=s.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(r&&!s.userData.navmesh)return;let o=s.dataPatched;if(!o.visible&&((m=o.physics)==null?void 0:m.enabled)!==!0)return!0;n.updateMatrixWorldSVD();let a=V2(o),l=s.userData.hasDestroy,u=s.userData.hasDrag,c=!1,h=!1;for(let b of o.events)b.data.disabled!==!0&&(b.data.type==="GameControl"?c=!0:b.data.type==="Follow"&&(h=!0));if(c||a||h||l||u)return!0;if(this.usePhysics&&((g=o.physics)==null?void 0:g.rigidBody)==="dynamic"){if(this.usePhysics&&((y=o.physics)!=null&&y.fusedBody))return!0}else if("geometry"in n&&n.geometry&&i.push(Tc(n.geometry,n.matrixWorld)),this.usePhysics&&((v=o.physics)==null?void 0:v.fusedBody))return n.traverseObject((b,_)=>{var E,M;if(_===0)return;let A;if(b instanceof vu)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;A=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof co)A=b.object;else if(A=b,(E=b.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let S=A.dataPatched;if(!S.visible&&((M=S.physics)==null?void 0:M.enabled)!==!0)return!0;"geometry"in b&&b.geometry&&i.push(Tc(b.geometry,b.matrixWorld))}),!0},this.traverseNoPhysics=(i,r)=>n=>{let s;if(n instanceof vu)return;n instanceof co?s=n.object:s=n;let o=s.dataPatched;if(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)return!0;if(r&&!s.userData.navmesh)return;let a=n.geometry,l=s.userData.hasDestroy===!0,u=s.userData.hasDrag===!0;if(V2(o)||l||u||s.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return!0;a&&i.push(Tc(a,n.matrixWorld))},this.navmeshWasm=iie,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(e?vBe:bBe)+xBe])),this._worker=new Worker(this._workerURL)}init(t,e,i){this.gameControl=e,this.eventContext=i,this.resolution=t.ch,this.setDefaultQueryExtent(new N().setScalar(t.ch*t.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,t,r=>{this.buildFromNavmeshData(r.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(t,e,i){e.objects.forEach(l=>{var c;let u=t.scene.find(l);u.traverseEntity(h=>{h.userData.navmesh=!0}),(c=u.cloner)==null||c.traverseObject(h=>{h.userData.navmesh=!0})});let r=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(r,e.zones==="custom");if(t.traverseChildren(n),e.objects.forEach(l=>{var c;let u=t.scene.find(l);u.traverseEntity(h=>{h.userData.navmesh=void 0}),(c=u.cloner)==null||c.traverseObject(h=>{h.userData.navmesh=void 0})}),r.length===0)return!1;let s=em(r),{positions:o,triIndices:a}=VP(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([o,o.length/3,a,a.length,{..._Be,...e}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let t,e,i=this.navMesh.getDebugNavMesh(),r=i.getTriangleCount(),n=new Uint32Array(r*3),s=new Float32Array(r*3*3);for(t=0;t<r*3;t++)n[t]=t;for(t=0;t<r;t++)for(e=0;e<3;e++){let a=i.getTriangle(t).getPoint(e);s[t*9+e*3+0]=a.x,s[t*9+e*3+1]=a.y,s[t*9+e*3+2]=a.z}let o=new Ht;return o.setIndex(new ei(n,1)),o.setAttribute("position",new ei(s,3)),o}getClosestPoint(t){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,this.navMesh.getClosestPoint(Pi)}getClosestPointToRef(t,e){Pi.x=t.x,Pi.y=t.y,Pi.z=t.z;let i=this.navMesh.getClosestPoint(Pi);e.set(i.x,i.y,i.z)}getRandomPointAround(t,e){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,this.navMesh.getRandomPointAround(Pi,e)}getRandomPointAroundToRef(t,e,i){Pi.x=t.x,Pi.y=t.y,Pi.z=t.z;let r=this.navMesh.getRandomPointAround(Pi,e);i.set(r.x,r.y,r.z)}moveAlong(t,e){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,Ls.x=e.x,Ls.y=e.y,Ls.z=e.z,this.navMesh.moveAlong(Pi,Ls)}moveAlongToRef(t,e,i){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,Ls.x=e.x,Ls.y=e.y,Ls.z=e.z,this.navMesh.moveAlong(Pi,Ls)}computePath(t,e){let i=this.getClosestPoint(e);Ls.x=i.x,Ls.y=i.y,Ls.z=i.z,this.getClosestPoint(t);let r=this.navMesh.computePath(Pi,Ls),n=r.getPointCount(),s=[];for(let o=0;o<n;o++){let a=r.getPoint(o);s.push(new N(a.x,a.y,a.z))}return s}createCrowd(t,e){return new EBe(this,t,e)}setDefaultQueryExtent(t){Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,this.navMesh.setDefaultQueryExtent(Pi)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(t){let e=t.length*t.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(e),r=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,e);r.set(t);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=r.byteOffset,n.size=t.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(r.byteOffset)}getNavmeshData(){let t=this.navMesh.getNavmeshData(),e=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,t.dataPointer,t.size),i=new Uint8Array(t.size);return i.set(e),this.navMesh.freeNavmeshData(t),i}getDefaultQueryExtentToRef(t){let e=this.navMesh.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}dispose(){var t;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(t=this.eventContext)==null||t.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(t,e,i){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,this.navMesh.addCylinderObstacle(Pi,e,i)}addBoxObstacle(t,e,i){return Pi.x=t.x,Pi.y=t.y,Pi.z=t.z,Ls.x=e.x,Ls.y=e.y,Ls.z=e.z,this.navMesh.addBoxObstacle(Pi,Ls,i)}removeObstacle(t){this.navMesh.removeObstacle(t)}isSupported(){return this.navmeshWasm!==void 0}},EBe=class{constructor(t,e,i){this.navmeshWasmWrapper=t,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(e,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(t,e){}addAgent(t,e,i){let r=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;r.radius=e.radius,r.height=e.height,r.maxAcceleration=e.maxAcceleration,r.maxSpeed=e.maxSpeed,r.collisionQueryRange=e.collisionQueryRange,r.pathOptimizationRange=e.pathOptimizationRange,r.separationWeight=e.separationWeight,r.updateFlags=7,r.obstacleAvoidanceType=0,r.queryFilterType=0,r.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z),r);return this.transforms.push(i),this.agents.push(n),this.reachRadii.push(e.reachRadius?e.reachRadius:e.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new N(0,0,0)),n}getAgentPosition(t){return this.crowd.getAgentPosition(t)}getAgentPositionToRef(t,e){let i=this.crowd.getAgentPosition(t);e.set(i.x,i.y,i.z)}getAgentVelocity(t){return this.crowd.getAgentVelocity(t)}getAgentVelocityToRef(t,e){let i=this.crowd.getAgentVelocity(t);e.set(i.x,i.y,i.z)}getAgentNextTargetPath(t){return this.crowd.getAgentNextTargetPath(t)}getAgentNextTargetPathToRef(t,e){let i=this.crowd.getAgentNextTargetPath(t);e.set(i.x,i.y,i.z)}getAgentState(t){return this.crowd.getAgentState(t)}overOffmeshConnection(t){return this.crowd.overOffmeshConnection(t)}agentGoto(t,e){this.crowd.agentGoto(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z));let i=this.agents.indexOf(t);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(e.x,e.y,e.z))}agentTeleport(t,e){this.crowd.agentTeleport(t,new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z))}updateAgentParameters(t,e){let i=this.crowd.getAgentParameters(t);e.radius!==void 0&&(i.radius=e.radius),e.height!==void 0&&(i.height=e.height),e.maxAcceleration!==void 0&&(i.maxAcceleration=e.maxAcceleration),e.maxSpeed!==void 0&&(i.maxSpeed=e.maxSpeed),e.collisionQueryRange!==void 0&&(i.collisionQueryRange=e.collisionQueryRange),e.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=e.pathOptimizationRange),e.separationWeight!==void 0&&(i.separationWeight=e.separationWeight),this.crowd.setAgentParameters(t,i)}removeAgent(t){this.crowd.removeAgent(t);let e=this.agents.indexOf(t);e>-1&&(this.agents.splice(e,1),this.transforms.splice(e,1),this.reachRadii.splice(e,1),this._agentDestinationArmed.splice(e,1),this._agentDestination.splice(e,1))}getAgents(){return this.agents}update(t){if(this.navmeshWasmWrapper.navMesh.update(),t<=wBe)return;let e=1/60,i=10;{let r=Math.floor(t/e);r>i&&(r=i),r<1&&(r=1);let n=t/r;for(let s=0;s<r;s++)this.crowd.update(n)}for(let r=0;r<this.agents.length;r++){let n=this.agents[r],s=this.getAgentPosition(n);if(this.transforms[r].copy(s),this._agentDestinationArmed[r]){let o=s.x-this._agentDestination[r].x,a=s.z-this._agentDestination[r].z,l=this.reachRadii[r],u=this._agentDestination[r].y-this.reachRadii[r],c=this._agentDestination[r].y+this.reachRadii[r],h=o*o+a*a;s.y>u&&s.y<c&&h<l*l&&(this.onReachTarget(n,this._agentDestination[r]),this._agentDestinationArmed[r]=!1)}}}setDefaultQueryExtent(t){let e=new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z);this.crowd.setDefaultQueryExtent(e)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(t){let e=this.crowd.getDefaultQueryExtent();t.set(e.x,e.y,e.z)}getCorners(t){let e,i=this.crowd.getCorners(t),r=i.getPointCount(),n=[];for(e=0;e<r;e++){let s=i.getPoint(e);n.push(new N(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function MBe(t){let e=!1;return t.scene.objects.forEach(i=>{i.data.type==="Page"&&!e&&i.data.publish.gameControlObject&&r1.traverseModuleInstances(t,i.id,(r,n,s)=>{for(let o of s)o.data.type==="GameControl"&&o.data.navmesh.enabled&&(e=!0)})}),e}var CBe={type:"change"},xq={type:"changeZoom"},PBe={type:"changePan"},ry={type:"start"},ny={type:"end",changed:!0},TBe={type:"end",changed:!1},T3=new ni,wq=new me,RBe=2*Math.PI,kBe=1e-8,DBe=.01,R3=new N,nE=new me,k3=new N,sE=new ni,_q=new lt,IBe={type:"requestRender"},rie=class extends Ys{constructor(t,e,i={isPlayMode:!1,isExport:!1}){super(),this.object=t,this.domElement=e,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,ll.DOLLY_ROTATE,ll.PAN],this.offset=new N,this.eye=new N,this.lastPosition=new N,this.lastQuaternion=new ni,this.current=new me,this.overShoot=new me,this.overRatio=new me,this.spherical=new o6,this.sphericalDelta=new o6,this.panOffset=new N,this.panLeftV=new N,this.panUpV=new N,this.panV=new N,this.rotateStart=new me,this.rotateEnd=new me,this.rotateDelta=new me,this.panStart=new me,this.panEnd=new me,this.panDelta=new me,this.dollyStart=new me,this.dollyEnd=new me,this.dollyDelta=new me,this.rotationRangeFactor=new me,this.panRangeFactor=new me,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=r=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=r.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(k3,sE,R3),this.offset.copy(k3).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(T3.copy(sE).invert()),this.panOffset.applyQuaternion(T3),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(sE),this.panOffset.applyQuaternion(sE)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),k3.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(_q.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(_q));let r=this.spherical.phi%RBe;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(ir.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),r>0&&r>Math.PI||r<0&&r>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);return this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>DBe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>kBe?(this.dispatchEvent(CBe),this.object.dispatchEvent(IBe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=r=>{this.enabled!==!1&&(r.pointerType==="touch"||r.pointerType==="pen"&&za?this.onPointerDownTouch(r):this.onPointerDownMouse(r),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(ry),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&za||this.domElement.setPointerCapture(r.pointerId)))},this.onPointerLeave=r=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,R3.subVectors(this.position0,this.target0),this.spherical.setFromVector3(R3),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=r},this.onPointerEnter=r=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?nE.set(r.clientX-this.domElement.clientWidth/2,r.clientY-this.domElement.clientHeight/2):nE.set(r.clientX-this.pointerLeaveEvent.clientX,r.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(nE).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(wq,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(r.clientX,r.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(nE).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(r.clientX,r.clientY)),this.update()},this.onPointerMove=r=>{this.enabled!==!1&&(this.checkRaycastLock()||(r.pointerType==="touch"||r.pointerType==="pen"&&za?this.onPointerMoveTouch(r):this.onPointerMoveMouse(r),r.stopPropagation()))},this.onPointerUp=r=>{this.isPointerDown=!1,Qt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),Qt.length>1&&r.preventDefault(),this.hasChange?this.dispatchEvent(ny):this.dispatchEvent(TBe),this.state=-1,r&&(r.stopPropagation(),r.pointerType==="touch"||r.pointerType==="pen"&&za||this.domElement.releasePointerCapture(r.pointerId))},this.onPointerDownMouse=r=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[r.button]:n=this.mouseButtonsPlay[r.button],n){case 0:if(r.altKey===!0&&!r.shiftKey&&!yA(r)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2;break;case 3:if(yA(r)||r.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}break;case 5:if(yA(r)||r.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=r=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(r);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(r);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(r);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=r=>{switch(Qt.length>1&&r.preventDefault(),this.touches[Qt.length-1]){case ll.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case ll.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case ll.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case ll.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=r=>{switch(Qt.length>1&&r.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(r),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(r),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(r),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(r),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=$F(()=>this.dispatchEvent(ny),33),this.onMouseWheel=r=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&r.preventDefault(),this.dispatchEvent(ry),this.handleMouseWheel(r),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=r=>{if(r.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!ez)if(r.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(ry),r.scale>this.prevScale?this.dollyIn(this.getZoomScale()):r.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=r.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(ny)},this.onContextMenu=r=>{r.preventDefault()},this.onTouchEnd=r=>{r.preventDefault()},this.onKeyDown=r=>{this.enabled!==!1&&(this.key=r.key,r.key===" "&&this.dispatchEvent(ry))},this.onKeyUp=r=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&r.key==="Alt"&&this.onPointerUp(Qt[0]),r.key===" "&&this.dispatchEvent(ny))},this.onPointerHover=r=>{r.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(r,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(r,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=r=>{r.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(t){t.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(t)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(t){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=t,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(t,e){this.setEnableDampingSpeed(t.enableDamping),this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.enableRotate=t.enableRotate,this.rotationLimitsMode=t.rotationLimitsMode,this.thetaIsFree=t.rotationHorizontalOffset.min===t.rotationHorizontalOffset.max&&t.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=t.rotationVerticalOffset.min===t.rotationVerticalOffset.max&&t.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=t.panLimitsMode,this.panSoftLimit=t.panSoftLimit,this.rotationSoftLimit=t.rotationSoftLimit,this.hoverRotatePanMode=t.hoverRotatePanMode,this.hoverRotateDamping=t.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=e==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=t.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=t.zoomLimitsEnabled,this.minZoom=t.zoomLimits.min,this.maxZoom=Math.max(t.zoomLimits.min,t.zoomLimits.max),this.minDistance=1e3/t.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/t.zoomLimits.min),this.autoRotate=t.autoRotate,this.autoRotateSpeed=t.autoRotateSpeed,this.autoRotateClockwise=t.autoRotateClockwise;let r=this.object.getTarget().applyQuaternion(T3.copy(this.object.quaternion).invert());this.minV=-t.panVerticalOffset.min+r.y,this.maxV=t.panVerticalOffset.max+r.y,this.minH=-t.panHorizontalOffset.min+r.x,this.maxH=t.panHorizontalOffset.max+r.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=rh(this.spherical.phi-t.rotationVerticalOffset.min),this.maxPhi=rh(this.spherical.phi+t.rotationVerticalOffset.max),this.minTheta=rh(rh(this.spherical.theta)-t.rotationHorizontalOffset.min),this.maxTheta=rh(rh(this.spherical.theta)+t.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,t.orbitTouches===1&&(this.touches[0]=ll.ROTATE),t.panTouches===1&&(this.touches[0]=ll.PAN),t.orbitTouches===2&&(this.touches[1]=ll.DOLLY_ROTATE),t.panTouches===2&&(this.touches[1]=ll.DOLLY_PAN),t.orbitTouches===3&&(this.touches[2]=ll.ROTATE),t.panTouches===3&&(this.touches[2]=ll.PAN),this.isTouchZoom=t.isTouchZoom,this.resetHoverEffectOnPointerLeave=t.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(t,e,i,r,n,s,o,a){this.overShoot.set(0,0);let l,u,c;t instanceof N?(l=t.x,u=t.y,this.current.set(this.target.x,this.target.y),c=!0):(l=t.theta,u=t.phi,this.current.set(rh(this.spherical.theta),rh(this.spherical.phi)),c=!1),i===0&&(this.current.x+=l,this.current.y+=u),(e===3||e===2)&&(!c&&this.isThetaFlipped?this.current.x>r&&this.current.x<0?this.overShoot.x=r-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>r?this.overShoot.x=r-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(e===3||e===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),c||(this.overShoot.x=rh(this.overShoot.x),this.overShoot.y=rh(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=Sq(Math.abs(this.overRatio.x)),this.overRatio.y=Sq(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),u*this.overShoot.y<0&&!this.phiIsFree&&(u*=1-this.overRatio.y)):i===2&&(!c&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||c&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(u=this.overShoot.y*.05),c?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):c?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,u+=this.overShoot.y),t instanceof N?(t.x=l,t.y=u):(this.thetaIsFree||(t.theta=l),this.phiIsFree||(t.phi=u))}setEnableDampingSpeed(t){this.enableDamping=t,this.rotateSpeed=t===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let r=this.object.position;this.panV.copy(r).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*n/i.clientHeight,this.object.matrixWorld),this.panUp(2*e*n/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(PBe)}dollyOut(t){this.object.isPerspectiveCamera?this.scale/=t:this.object.isOrthographicCamera&&(this.object.zoom*=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(xq)}dollyIn(t){this.object.isPerspectiveCamera?this.scale*=t:this.object.isOrthographicCamera&&(this.object.zoom/=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(xq)}zoomOut(t=this.getZoomScale()){this.dispatchEvent(ry),this.dollyOut(t),this.dispatchEvent(ny)}zoomIn(t=this.getZoomScale()){this.dispatchEvent(ry),this.dollyIn(t),this.dispatchEvent(ny)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t,e=1){t.movementX!==void 0?this.rotateDelta.set(t.movementX,t.movementY):(this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*e).rotateAround(wq,-this.object.angleOffsetFromUp);let i=this.domElement,r=this.useWindowEvents?window.innerHeight:i.clientHeight,n=2*Math.PI*this.rotateDelta.x/r,s=2*Math.PI*this.rotateDelta.y/r;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t,e=1){t.movementX!==void 0?this.panDelta.set(t.movementX,t.movementY):(this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*e),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(t){if(gEe===!1&&yA(t)===!1&&yEe(t)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-t.deltaX,-t.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),t.altKey?this.pan(0,this.panDelta.y):t.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;t.deltaY===0?t.deltaX<0?this.dollyIn(this.getZoomScale()):t.deltaX>0&&this.dollyOut(this.getZoomScale()):t.deltaY<0?this.dollyIn(this.getZoomScale()):t.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Qt.length===2){let t=.5*(Qt[0].pageX+Qt[1].pageX),e=.5*(Qt[0].pageY+Qt[1].pageY);this.rotateStart.set(t,e)}else this.rotateStart.set(Qt[0].pageX,Qt[0].pageY)}handleTouchStartPan(){if(Qt.length===2){let t=.5*(Qt[0].pageX+Qt[1].pageX),e=.5*(Qt[0].pageY+Qt[1].pageY);this.panStart.set(t,e)}else this.panStart.set(Qt[0].pageX,Qt[0].pageY)}handleTouchStartDolly(){let t=Qt[0].pageX-Qt[1].pageX,e=Qt[0].pageY-Qt[1].pageY,i=Math.sqrt(t*t+e*e);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(t){if(Qt.length===2){let i=wD(t),r=.5*(t.pageX+i.x),n=.5*(t.pageY+i.y);this.rotateEnd.set(r,n)}else{if(t.pointerId!==Qt[0].pointerId)return;this.rotateEnd.set(t.pageX,t.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;e&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(t){if(Qt.length===2){let e=wD(t),i=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);this.panEnd.set(i,r)}else{if(t.pointerId!==Qt[0].pointerId)return;this.panEnd.set(t.pageX,t.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(t){let e=wD(t),i=t.pageX-e.x,r=t.pageY-e.y,n=Math.sqrt(i*i+r*r);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enablePan&&this.handleTouchMovePan(t)}handleTouchMoveDollyRotate(t){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(t),this.enableRotate&&this.handleTouchMoveRotate(t)}checkRaycastLock(){var t;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let e=(t=this.options)==null?void 0:t.showCameraLock;return e&&e(),!0}}else return!1}};function rh(t){let e=Math.PI*2;for(;t<=-Math.PI;)t+=e;for(;t>Math.PI;)t-=e;return t}function Sq(t){return 1-Math.pow(1-t,4)}var Aq=class{constructor(t,e,i,r,n,s){this.id=t,this.data=e,this.object=i,this.page=r,this.currentIntersectedObjects=[],this.disabled=!1,this.alreadyPlayedNonTogglingActions=new Set,this.actions=Xo(e,e.actions,r,n,s,i),this.target=e.target,this.useToggle=e.runMode==="Toggle",this.triggeringObjects=e.triggeringObjects.map(o=>r.scene.find(o))}isValidTriggeringObject(t){return this.target==="all"?!0:this.triggeringObjects.some(e=>e===t||e.isAncestorOf(t.uuid)||t.isAncestorOf(e.uuid))}disconnect(){Es(this.actions)}dispatch(){this.disabled||this.object.destroyedInAction||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.data.runMode==="Once"&&this.alreadyPlayedNonTogglingActions.add(t)}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()))}},Di;SEe.then(t=>Di=t);var Dn=new N,iu=new ni,Ld=new N,D3=new ts(0,0,0,"YXZ"),Eq=new ts(0,0,0,"XYZ"),ru=new N,I3=new N,L3=new N(1,1,1),sy=new ni,oE=new lt,Mq=new lt,LBe={type:"updateMatrix"},Cq=new ni,B3=new xa,zO={type:"beginEvent",eventName:"Collision"},BBe={type:"beginEvent",eventName:"Trigger"};function OBe(t){if(r1.physicsEnabled(t.scene.objects))return!0;let e=!1;return t.scene.objects.traverse((i,r)=>{if(r.events){if(Array.isArray(r.events)){for(let n of r.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){e=!0;break}}else for(let n of Object.values(r.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){e=!0;break}}}),e}var V2=t=>t.states.some(e=>e.data.position!==void 0||e.data.rotation!==void 0||e.data.hiddenMatrix!==void 0||e.data.cloner!==void 0||e.data.pathSnapping!==void 0),UBe=class{constructor(t){this.eventContext=t,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=e=>{if(e.bodyType()!==Di.RigidBodyType.Dynamic)return;e.isSleeping()||this.nActiveRigidBodies++;let[i,r,n]=this.rigidBodyToMesh.get(e.handle);if(Dn.copy(e.translation()).multiplyScalar(this.pixelsPerMeter),iu.copy(e.rotation()),i.matrixWorld.compose(Dn,iu,r),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(LBe),n){let s=i.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(i.matrixWorld);for(let o of s.children)o.updateMatrixWorld(!0)}for(let o of i.children)o.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(e,i,r)=>{var o,a,l,u;if(r===!1)return;let n,s;if(this.sensorToTriggerEvent[e]?(n=this.sensorToTriggerEvent[e],s=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(n=this.sensorToTriggerEvent[i],s=this.sharedGameControlGlobals.colliderToEntity.get(e)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let c=this.sharedGameControlGlobals.createdObjects.length-1;c>=0;c--){let h=this.sharedGameControlGlobals.createdObjects[c];if(h.userData.hasCollisionDestroy&&(((o=h.rigidBody)==null?void 0:o.collider(0).handle)===e||((a=h.rigidBody)==null?void 0:a.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(c,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(e)){let c=this.sharedGameControlGlobals.colliderToEntity.get(i),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,c,i)}else if(((u=this.gameControl)==null?void 0:u.object)===this.sharedGameControlGlobals.colliderToEntity.get(i)){let c=this.sharedGameControlGlobals.colliderToEntity.get(e),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,c,e)}else{let c=this.sharedGameControlGlobals.colliderToEntity.get(e),h=this.sharedGameControlGlobals.entityToCollisionEvents[c.uuid];if(h!==void 0)for(let f of h)f.data.target==="scene"&&this.dispatchCollisionEvent(f,c,e);let d=this.sharedGameControlGlobals.colliderToEntity.get(i),p=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,d,i)}},this.isExport=t.isExport,this.sharedAssets=t.sharedAssets,this.renderer=t.renderer,this.requestRender=t.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=Yte,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(t){t.forEach(e=>{e.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(t=>{var i,r;let e=t.dataPatched;for(let n of e.events){if(n.data.disabled===!0)continue;let s=(r=(i=n.data.actions)==null?void 0:i.find(o=>o.data.type==="Destroy"))==null?void 0:r.data;if(s)for(let o of s.objects){let a=this.page.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(t=>{let e=t.dataPatched;for(let i of e.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let r of i.data.objects){let n=this.page.scene.find(r);n&&(n.userData.hasDrag=!0)}})}initBVH(){let t=[];if(this.page.traverseChildren(e=>{var u,c;let i,r=e instanceof IM,n=e instanceof BM;if(e instanceof vu||r||n)return;e instanceof co?i=e.object:i=e;let s=i.dataPatched;if(((u=s.physics)==null?void 0:u.enabled)==="visibility"?!s.visible:!((c=s.physics)!=null&&c.enabled))return!0;let o=e.geometry,a=i.userData.hasDestroy===!0,l=i.userData.hasDrag===!0;if(V2(s)||a||l||i.dataPatched.events.some(h=>h.data.disabled!==!0&&h.data.type==="GameControl"))return e.updateMatrixWorldSVD(),this.addBoundsTree(e),!0;o&&t.push(Tc(o,e.matrixWorld))}),t.length>0){let e=em(t,!1);this.sharedGameControlGlobals.staticMeshBVH=new dw(e)}}addRigidBody(t,e,i){let r=[],n="geometry"in t?t.geometry:void 0,s=e.dataPatched;if((n==null?void 0:n.getAttribute("position"))!==void 0&&r.push(Tc(n,t.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(t,r);t.traverseObject(o),t.children.forEach(l=>l.updateMatrixWorld(!0));let a=t.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(r.length>0){let o,a=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;a?(o=Di.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(o=Di.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)):o=Di.RigidBodyDesc.fixed();let l=em(r);(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Dn,iu,Ld),t.position0=Dn.clone().divideScalar(this.pixelsPerMeter),t.rotation0=iu.clone(),Dn.divideScalar(this.pixelsPerMeter),o.setTranslation(Dn.x,Dn.y,Dn.z).setRotation(iu),n?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Ld.x/this.pixelsPerMeter,Ld.y/this.pixelsPerMeter,Ld.z/this.pixelsPerMeter);let u=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(u.handle,[t,Ld.clone(),s.physics.fusedBody]);let c=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(u,s.physics,l,e,c)}catch{try{this.addCollider(u,s.physics,l,e,!1)}catch(h){console.error(h)}}t.rigidBody=u}}addBoundsTree(t){var i,r;let e=[];if(((i=t.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&((r=t.geometry)==null?void 0:r.getAttribute("position").count)>0&&e.push(Tc(t.geometry,t.shearScale)),t.traverseObject(this.gatherChildrenGeom(t,e)),t.children.forEach(n=>n.updateMatrixWorld(!0)),e.length>0){let n=em(e,!1);t.bvhGeometry=n,t.bvhGeometry.boundsTree=new dw(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)}}addCollider(t,e,i,r,n=!0){var a,l;if((i==null?void 0:i.getAttribute("position").count)===0||((a=i==null?void 0:i.getIndex())==null?void 0:a.count)===0)return;let s;i&&(e.colliderType==="trimesh"?s=Di.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=Di.ColliderDesc.convexMesh(i.getAttribute("position").array,n?i.getIndex().array:void 0)),s.setFrictionCombineRule(Di.CoefficientCombineRule.Average).setRestitutionCombineRule(Di.CoefficientCombineRule.Average).setDensity(e.density).setFriction(e.friction).setRestitution(e.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,t);this.sharedGameControlGlobals.colliderToEntity.set(o.handle,r),(l=this.sharedGameControlGlobals.entityToCollisionEvents[r.uuid])!=null&&l.some(u=>u.target==="scene")&&o.setActiveEvents(Di.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(t,e){return(i,r)=>{var a;if(r===0)return;let n;if(i instanceof vu)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;n=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof co)n=i.object;else if(n=i,(a=n.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;r===1?t.hasNonUniformScale?i.matrixWorld.multiplyMatrices(t.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let o=i.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&e.push(Tc(o,i.matrixWorld))}}activate(t){var d,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=t,this.usePhysics=this.page.data.globalPhysics.usePhysics;let e=this.page.playCamera,i=!1,r=5,n=8,s=9,o="drag",a=this.page.data.publish.gameControlObject,l=a!==null?this.page.find(a):null,u=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")break;let m=l;for(;this.usePhysics&&((d=m=m.parent)==null?void 0:d.parent)!==null&&!((p=m.data.physics)!=null&&p.fusedBody););f.data.collisionEnabled&&(this.needsCollisionDetection=!0),u===null&&(u=f.data)}if(this.page.traverseEntity(f=>{for(let m of f.dataPatched.events)if(m.data.disabled===!1&&m.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&u){i=i||u.camera===e.uuid||l.uuid===e.uuid;let f=new Kte(l,this.renderer.domElement,u,this.eventContext.page.data.globalPhysics,this,l.uuid!==e.uuid&&u.camera===e.uuid,e,this.page,this.sharedAssets);this.gameControl=f,r=u.joystickPosLoc,n=u.joystickRotLoc,s=u.jumpTouchButtonLoc,o=u.rotByTouch,za&&u.touchControl&&(this.joystickToGameControls[r]="pos",u.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),o==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new ABe(this.usePhysics,this.isExport);let m;f.collider.type==="sphere"?m=f.collider.radius*2:m=f.collider.height,m=Math.floor(m/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:f,enablePan:m,enableZoom:g,autoRotate:y,hoverRotatePanMode:v}=this.eventManager.publish.orbitControls;(f||m||g||y||v!==0)&&(this.orbitControls=new rie(e,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let c=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,m)=>{let g=document.body.appendChild(document.createElement("div")),[y,v,b]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],_=(c-5*y)/4+y,A={},S=f==="jmp",E=S?0:y;m<10?(m<5?A.top=E/2:A.bottom=E/2,A.left=E/2+m%5*_):m===10?(A.left=E/2,A.top=h/2):(A.right=E/2,A.top=h/2),A.top?A.top-=v[1]:A.bottom+=v[1],A.left?A.left+=v[0]:A.right-=v[0];for(let C in A)A[C]+="px";if(S){let C=g.appendChild(document.createElement("div"));Object.assign(C.style,A,{position:"absolute",width:y+"px",height:y+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:y+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let T=y/16*16*.4;b==="show"&&(C.innerHTML=`
						<svg width="${T}" height="${y*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),C.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),C.addEventListener("touchend",L=>L.preventDefault()),this.joysticks[m]=[void 0,g];return}let M={zone:g,mode:"static",position:A,size:y};b==="hide"&&(M.restOpacity=0);let R=K3e.create(M);R.on("move",(C,T)=>{let L=this.gameControl;f==="pos"?T.force<.2?L.moveForce=0:(L.movementState.movePosZ=Math.sin(-T.angle.radian),L.movementState.movePosX=Math.cos(-T.angle.radian),T.force>1.2?L.movementState.run=1:L.movementState.run=0,T.force<.3?L.moveForce=(T.force-.2)/.1:L.moveForce=1):f==="rot"&&(T.force<.2?L.rotForce=0:(L.movementState.rotPosX=T.vector.y,L.movementState.rotPosY=-T.vector.x,T.force<.3?L.rotForce=(T.force-.2)/.1:L.rotForce=1)),this.requestRender()}),R.on("end",(C,T)=>{let L=this.gameControl;f==="pos"?(L.movementState.movePosZ=0,L.movementState.movePosX=0,L.moveForce=1):f==="rot"&&(L.movementState.rotPosX=0,L.movementState.rotPosY=0,L.rotForce=1)}),this.joysticks[m]=[R,g]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.disabled=!1)},80)}initPhysics(){var o;(o=this.sharedGameControlGlobals.rapierWorld)==null||o.free(),this.sharedGameControlGlobals.rapierWorld=new Di.World(new Di.Vector3(0,this.gravity,0)),this.events=new Di.EventQueue(!0);let t=[],e=[];if(this.page.traverseChildren(a=>{var y,v,b,_;let l;if(a instanceof vu)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;l=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof co)l=a.object;else{if(a instanceof BM||a instanceof IM)return;if(l=a,((y=l.dataPatched.cloner)==null?void 0:y.disabled)===!1&&((v=l.dataPatched.cloner)==null?void 0:v.hideBase)&&((b=l.dataPatched.physics)==null?void 0:b.fusedBody)!==!0)return!0}let u=l.dataPatched,c;for(let A of u.events)A.data.disabled!==!0&&A.data.type==="GameControl"&&(c=A.data);if(!u.physics||(u.physics.enabled==="visibility"?!u.visible:!u.physics.enabled))return!0;a.updateMatrixWorldSVD();let h=V2(u),d=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,m=!1;for(let A of u.events)if(A.data.disabled!==!0){if(A.data.type==="Collision"){d=!0;let S=new pBe(A.id,A.data,l,this.page,this.sharedAssets,this.eventManager);S.disabled=!0,this.collisionEvents.push(S),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(E=>E.id!==A.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(S):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[S]}else if(A.data.type==="Follow"){m=!0;let S=A.data.target;a.traverseVisible(E=>{E.userData.isFollowingObj=S})}}u.physics.rigidBody==="dynamic"&&u.physics.fusedBody===!1&&(a.matrixWorldFusedFalse=a.matrixWorld.clone());let g=a.geometry;if(c!==void 0){let A=Di.RigidBodyDesc.kinematicPositionBased();(a.hasNonUniformScale?a.matrixWorldRigid:a.matrixWorld).decompose(Dn,iu,Ld),a.position0=Dn.clone().divideScalar(this.pixelsPerMeter),a.rotation0=iu.clone(),Dn.divideScalar(this.pixelsPerMeter),A.setTranslation(Dn.x,Dn.y,Dn.z).setRotation(iu);let S=this.sharedGameControlGlobals.rapierWorld.createRigidBody(A);a.rigidBody=S;let E;c.collider.type==="sphere"?E=Di.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?E=Di.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):E=Di.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),E.setFrictionCombineRule(Di.CoefficientCombineRule.Average).setRestitutionCombineRule(Di.CoefficientCombineRule.Average).setDensity(u.physics.density).setFriction(u.physics.friction).setRestitution(u.physics.restitution);let M=this.sharedGameControlGlobals.rapierWorld.createCollider(E,S);this.sharedGameControlGlobals.colliderToEntity.set(M.handle,l),Dn.fromArray(c.collider.position).multiply(Ld.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),M.setTranslationWrtParent(Dn);let R=new ni().setFromEuler(new ts().setFromVector3(new N().fromArray(c.collider.rotation)));M.setRotationWrtParent(R),M.setActiveEvents(Di.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else u.physics.rigidBody==="dynamic"||h||m||p||f||d?(this.addRigidBody(a,l,{hasFollow:m,hasTransformAnim:h,hasDrag:f}),this.generateSensorColliderDescs(l,u.physics.fusedBody)):(g&&t.push(Tc(g,a.matrixWorld)),u.physics.fusedBody&&a.traverseObject((A,S)=>{var C;if(S===0)return;let E;if(A instanceof vu)if(A.objectForSample){if(A.objectForSample.dataPatched.physics.fusedBody)return;E=A.object}else return A.object.dataPatched.physics.fusedBody===!0&&A.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(A instanceof BM||A instanceof IM)return;if(A instanceof co)E=A.object;else if(E=A,(C=E.dataPatched.cloner)==null?void 0:C.hideBase)return!0}let M=E.dataPatched;if(M.physics.enabled==="visibility"?!M.visible:!M.physics.enabled)return!0;let R=A.geometry;(R==null?void 0:R.getAttribute("position"))!==void 0&&t.push(Tc(R,A.matrixWorld))}),this.generateSensorColliderDescs(l,u.physics.fusedBody,e));if(((_=u.physics)==null?void 0:_.fusedBody)===!0||c)return!0}),t.length===0)return;let i=em(t);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let r=Di.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(r),s=Di.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(Di.CoefficientCombineRule.Multiply).setRestitutionCombineRule(Di.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[a,l]of e){let u=this.sharedGameControlGlobals.rapierWorld.createCollider(a,n);this.sensorToTriggerEvent[u.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(t=>{for(let e of t.dataPatched.events)if(e.data.type==="Trigger"&&e.data.disabled!==!0){let i=new Aq(e.id,e.data,t,this.page,this.sharedAssets,this.eventManager),r=new lt().compose(ru.fromArray(e.data.position),sy.setFromEuler(Eq.fromArray(e.data.rotation)),L3);if(e.data.triggerZone==="box"){let n=new Mn;n.min.fromArray(e.data.size).multiplyScalar(-.5),n.max.fromArray(e.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,r,t,i])}else this.sharedGameControlGlobals.triggers.push([e.data.radius,r,t,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(t=>t.disconnect()),this.sharedGameControlGlobals.triggers.forEach(t=>t[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var t,e,i,r;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(n=>{let s=n;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(e=this.gameControl)==null||e.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([n,s])=>{n==null||n.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(r=this.navigationMeshWrapper)==null||r.dispose(),this.navigationMeshWrapper=void 0;for(let n of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))n.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(t,e,i){if(!this.isEnabled)return!0;let r=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(r=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,r=!1):this.initializationCounter===2&&this.gameControl&&(r=!this.gameControl.update(t,e,i)&&r),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(t===0)r=this.stepPhysics()&&r;else{let s=t/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let o=performance.now(),a=0,l=6;for(;this.accumulator>=n&&a<l&&(r=this.stepPhysics()&&r,this.accumulator-=n,a++,!(performance.now()-o>n*1e3)););this.accumulator=this.accumulator%n}}return r}stepPhysics(){var t;for(let e of this.sharedGameControlGlobals.entitiesWithTransformAnim){(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Dn,iu,Ld),D3.setFromQuaternion(iu);let i=e;i.prevR===void 0?(i.prevR=D3.clone(),i.prevT=Dn.clone()):(i.prevR.copy(D3),i.prevT.copy(Dn)),e.rigidBody&&(e.rigidBody.setNextKinematicTranslation(Dn.divideScalar(this.pixelsPerMeter)),e.rigidBody.setNextKinematicRotation(iu))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(t=this.events)==null||t.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(t,e,i){var s;let r=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,n;if(e.cloner){for(let o of e.cloner.children)if(o.rigidBody===r){n=o;break}}t.dispatch(n),e.dispatchEvent(zO)}updateUseWindowEvents(t){var e;(e=this.orbitControls)==null||e.updateUseWindowEvents(t)}generateSensorColliderDescs(t,e,i){let r=Mq.copy(t.matrixWorld).invert();t.traverseEntity((n,s)=>{if(e===!1&&s===1)return!0;for(let o of n.dataPatched.events)if(o.data.type==="Trigger"&&o.data.disabled!==!0){let a=new Aq(o.id,o.data,n,this.page,this.sharedAssets,this.eventManager),l;if(o.data.triggerZone==="box"?l=Di.ColliderDesc.cuboid(...o.data.size.map(u=>u/(2*this.pixelsPerMeter))):l=Di.ColliderDesc.ball(o.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(Di.ActiveEvents.COLLISION_EVENTS),ru.fromArray(o.data.position),sy.setFromEuler(Eq.fromArray(o.data.rotation)),oE.compose(ru,sy,L3).premultiply(n.matrixWorld),i?(oE.decompose(ru,sy,I3),l.setActiveCollisionTypes(Di.ActiveCollisionTypes.KINEMATIC_FIXED|Di.ActiveCollisionTypes.DYNAMIC_FIXED)):(oE.premultiply(r).decompose(ru,sy,I3),t.rigidBody.bodyType()===Di.RigidBodyType.Dynamic||(t.rigidBody.bodyType()===Di.RigidBodyType.Fixed?l.setActiveCollisionTypes(Di.ActiveCollisionTypes.KINEMATIC_FIXED|Di.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(Di.ActiveCollisionTypes.KINEMATIC_KINEMATIC|Di.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),ru.divideScalar(this.pixelsPerMeter),l.setTranslation(ru.x,ru.y,ru.z),l.setRotation(sy),i)i.push([l,a]);else{let u=this.sharedGameControlGlobals.rapierWorld.createCollider(l,t.rigidBody);this.sensorToTriggerEvent[u.handle]=a}}})}checkTrigger(){let t;for(let e=0;e<this.sharedGameControlGlobals.triggers.length;e++){let[i,r,n,s]=this.sharedGameControlGlobals.triggers[e];for(let o=0;o<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;o++){let a=this.sharedGameControlGlobals.entitiesWithTransformAnim[o];if(n===a||s.isValidTriggeringObject(Ti.is(a)?a:a.object)===!1)continue;let l=Mq.copy(n.matrixWorld).decompose(ru,Cq,I3).compose(ru,Cq,L3).multiply(r),u=oE.copy(a.matrixWorld).invert().multiply(l);i instanceof Mn?t=a.bvhGeometry.boundsTree.intersectsBox(i,u):(B3.radius=i,B3.center.setFromMatrixPosition(u),t=a.bvhGeometry.boundsTree.intersectsSphere(B3)),t?s.currentIntersectedObjects.indexOf(a)===-1&&(s.currentIntersectedObjects.push(a),s.dispatch(),n.dispatchEvent(BBe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(c=>c!==a)}}}};function NBe(t){let e=this._clip.duration,i=this._clip.start??0,r=this.loop,n=this.time+t,s=this._loopCount,o=r===xF;if(t===0)return s===-1?n:o&&(s&1)===1?e-(n-i):n;if(r===vQ){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=e)n=e;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),n>=e||n<i){let a=Math.floor((n-i)/(e-i));n-=(e-i)*a,s+=Math.abs(a);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o||(n=t>0?e:i,this.repetitions===1&&(n=e)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(l===1){let u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=n;if(o&&(s&1)===1)return e-(n-i)}return n}var Pq=!1,FBe=class{constructor(t,e,i,r){this.scene=t,this.requestRender=e,this.updateDisplayProgress=i,this.animationInspectorState=r,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,o)=>{let a=s[0]+"/";if(Array.isArray(n.identity)?a+=n.identity[0]:a+=n.uuid,this.clipIdToAction[a])return;let l=eB.parse(JSON.parse(s[2]));n.animations[o]=l;let u=this.mixer.clipAction(l,n);Pq===!1&&(Object.getPrototypeOf(u)._updateTime=NBe,Pq=!0),u.clampWhenFinished=!0,this.clipIdToAction[a]=u})},this.mixer=new Fve(t),this.scene.traverseEntity(this.addClip)}deleteClip(t,e){let i=this.scene.find(e);if(!i)return;let r=i.animations.find(s=>s.uuid===t);if(!r)return;let n=this.clipIdToAction[t];!n||(n.stop(),this.mixer.uncacheClip(r),delete this.clipIdToAction[t],i.animations=i.animations.filter(s=>s.uuid!==t))}get isPlaying(){return Object.values(this.clipIdToAction).some(t=>t.isRunning())}playFromInspector(t){this.mixer.stopAllAction();let e=this.clipIdToAction[t];!e||(e.play(),this.activeClip=e.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(t=>{t.repetitions=1/0,t.loop=bQ}),this.mixer.stopAllAction(),this.requestRender()}play(t){let e=t.clipId+"/"+t.object,i=this.clipIdToAction[e];if(i)return t&&(t.repeat>=0&&(i.repetitions=t.repeat+1),t.direction==="pingpong"&&t.repeat!==0&&(i.loop=xF)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(t){let e=this.clipIdToAction[t];!e||(e.play(),e.paused=!1,this.requestRender())}pauseFromInspector(t){let e=this.clipIdToAction[t];!e||(e.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(t){var e;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(e=this.animationInspectorState)!=null&&e.isScrubbing)return;this.mixer.update(t/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var t,e;return((e=(t=this.activeClip)==null?void 0:t.tracks[0])==null?void 0:e.times.length)??0}setProgressFromInspector(t,e){if(!this.clipIdToAction[e])return;this.activeClip!==this.clipIdToAction[e].getClip()&&this.playFromInspector(e);let i=this.clipIdToAction[e].paused;this.clipIdToAction[e].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?t/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[e].paused=!0)}},O3=new WeakMap,zBe=class extends Q1{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,i,r){let n=new tB(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(t,s=>{this.decodeDracoFile(s,e).catch(r)},i,r)}decodeDracoFile(t,e,i,r){let n={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(t,n).then(e)}decodeGeometry(t,e){let i=JSON.stringify(e);if(O3.has(t)){let a=O3.get(t);if(a.key===i)return a.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r,n=this.workerNextTaskID++,s=t.byteLength,o=this._getWorker(n,s).then(a=>(r=a,new Promise((l,u)=>{r._callbacks[n]={resolve:l,reject:u},r.postMessage({type:"decode",id:n,taskConfig:e,buffer:t},[t])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{r&&n&&this._releaseTask(r,n)}),O3.set(t,{key:i,promise:o}),o}_createGeometry(t){let e=new Ht;t.index&&e.setIndex(new ei(t.index.array,1));for(let i=0;i<t.attributes.length;i++){let r=t.attributes[i],n=r.name,s=r.array,o=r.itemSize;e.setAttribute(n,new ei(s,o))}return e}_loadLibrary(t,e){let i=new tB(this.manager);return i.setPath(this.decoderPath),i.setResponseType(e),i.setWithCredentials(this.withCredentials),new Promise((r,n)=>{i.load(t,r,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(i=>{let r=i[0];t||(this.decoderConfig.wasmBinary=i[1]);let n=HBe.toString(),s=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(n){let s=n.data;switch(s.type){case"decode":r._callbacks[s.id].resolve(s);break;case"error":r._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,n){return r._taskLoad>n._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[t]=e,i._taskLoad+=e,i})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function HBe(){let t,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(c){t.onModuleLoaded=function(h){c({draco:h})},DracoDecoderModule(t)});break;case"decode":let l=a.buffer,u=a.taskConfig;e.then(c=>{let h=c.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=i(h,d,p,u),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function i(o,a,l,u){let c=u.attributeIDs,h=u.attributeTypes,d,p,f=a.GetEncodedGeometryType(l);if(f===o.TRIANGULAR_MESH)d=new o.Mesh,p=a.DecodeBufferToMesh(l,d);else if(f===o.POINT_CLOUD)d=new o.PointCloud,p=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let m={index:null,attributes:[]};for(let g in c){let y=self[h[g]],v,b;if(u.useUniqueIDs)b=c[g],v=a.GetAttributeByUniqueId(d,b);else{if(b=a.GetAttributeId(d,o[c[g]]),b===-1)continue;v=a.GetAttribute(d,b)}m.attributes.push(n(o,a,d,g,y,v))}return f===o.TRIANGULAR_MESH&&(m.index=r(o,a,d)),o.destroy(d),m}function r(o,a,l){let u=l.num_faces()*3,c=u*4,h=o._malloc(c);a.GetTrianglesUInt32Array(l,c,h);let d=new Uint32Array(o.HEAPF32.buffer,h,u).slice();return o._free(h),{array:d,itemSize:1}}function n(o,a,l,u,c,h){let d=h.num_components(),p=l.num_points()*d,f=p*c.BYTES_PER_ELEMENT,m=s(o,c),g=o._malloc(f);a.GetAttributeDataArrayForAllPoints(l,h,m,f,g);let y=new c(o.HEAPF32.buffer,g,p).slice();return o._free(g),{name:u,array:y,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var yp;function GBe(){return yp||(yp=new zBe,yp.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),yp.decoderPending}async function VBe(t){if(yp){let e={attributeIDs:yp.defaultAttributeIDs,attributeTypes:yp.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await yp.decodeGeometry(new Int8Array(t).buffer,e)}catch(r){console.error(r)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([r,n])=>({name:r,itemSize:n.itemSize,array:n.array}))}}return null}async function jBe(t,e){let[i,r]=t$(gB.deserialize(new Uint8Array(t)));M$(i);let n=[];i.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&n.push(o)}),n.length&&await GBe();for(let s of n){let o=await VBe(An(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:u,itemSize:c})=>{a[l]={array:u,itemSize:c,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(i),r.result().data}var WBe=class{constructor(t,e,i,r,n,s,o){this.id=t,this.data=e,this.dataEvent=i,this.object=r,this.stage=!1,this.actions=Xo(i,e.actions,n,s,o,r)}disconnect(){Es(this.actions)}dispatchIn(){this.actions.Audio.forEach(t=>t.dispatchBasic()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Video.forEach(t=>t.dispatchBasic()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.Link.forEach(t=>t.dispatch()),this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.actions.Transition.forEach(t=>t.toggle()),this.actions.Animation.forEach(t=>t.play()),this.actions.SwitchCamera.forEach(t=>t.play()),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch())}dispatchOut(){this.actions.Transition.forEach(t=>{t.toggle()})}},qBe=class extends Lu{constructor(t,e){super(t),this.eventManager=e,this.breakpoints=[],this.resize=(i,r)=>{this.breakpoints.forEach(n=>{let s=xB.deviceToSize(n.data.size),o=n.dataEvent.orientation==="horizontal"?i:r,a;switch(n.data.operator){case"<":a=o<s[0];break;case">":a=o>s[0];break;case"<>":a=o>s[0]&&o<s[1];break}n.stage!==a&&(n.stage=a,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(i=>{for(let r of i){let{width:n,height:s}=r.contentRect;this.resize(n,s)}})}connect(){let{page:t,sharedAssets:e,domElement:i}=this.eventContext;this.onResizeObserver.observe(i);let r=n=>{var s;if(!(!n.visible||!((s=n.data)!=null&&s.events.length)))for(let{data:o}of n.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:a,id:l})=>{try{let u=new WBe(l,a,o,n,t,e,this.eventManager);this.breakpoints.push(u)}catch{}})};t.traverseEntity(n=>{var s;(n instanceof ho||n instanceof bs)&&((s=n.frame)==null||s.traverse(o=>{r(o)})),r(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(t=>{t.disconnect()}),this.breakpoints=[]}},XBe=class{constructor(t,e,i,r,n){this.publish=t,this.controlsManager=e,this.animationControls=i,this.eventContext=r,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=s=>{(s.touches.length>1||this.preventTouchScroll)&&s.preventDefault()},this.onMouseWheelPreventScroll=s=>{this.preventScroll&&s.preventDefault()},this.onMouseMove=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:s.buttons>0}},this.onMouseDown=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!0}},this.onMouseUp=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!1}},this.getMousePosition=s=>{var u;let{domRect:o}=this.eventContext,{pageX:a,pageY:l}=((u=s.touches)==null?void 0:u.length)>0?s.touches[0]:s;return{x:a-(o.left+window.scrollX),y:l-(o.top+window.scrollY)}},this.stopRaycast=t.stopRaycast,this.preventScroll=t.preventScroll,this.preventTouchScroll=t.preventTouchScroll,this.hideCursor=t.hideCursor,this.requestRender=r.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new OLe(this.eventContext),DynamicVariable:new fBe(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),Conditional:new VLe(this.eventContext,this),Start:new dBe(this.eventContext,this),Basic:new NLe(this.eventContext,this,this.needsRaycast),MouseHover:new aBe(this.eventContext,this),Scroll:new hBe(this.eventContext,this),Follow:new $Le(this.eventContext,this),DragDrop:new YLe(this.eventContext,this),LookAt:new nBe(this.eventContext),Resize:new qBe(this.eventContext,this)};let{page:t,domElement:e}=this.eventContext;this.hideCursor&&(e.style.cursor="none"),t.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),e.addEventListener("wheel",this.onMouseWheelPreventScroll),e.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var i;if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:t,domElement:e}=this.eventContext;e.style.cursor="",Object.values(this.handlers).forEach(r=>r.disconnect()),(i=this.controlsManager.gameControl)==null||i.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(r=>{r.removeEventListener("requestRender",this.requestRender),r.destroyedInAction=!1}),e.removeEventListener("touchmove",this.onTouchMovePreventScroll),e.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(t){let e=this.isEnabled;e&&this.deactivate(),this.eventContext.useWindowEvents=t,e&&this.activate()}initializeActionsDependentStates(){let t=this.eventContext.sharedAssets;t.resetDynamicVariablePlayState();let e=i=>{if(i.data.type==="Conditional"&&(i.data.ifActions.forEach(e),i.data.elseActions.forEach(e)),i.data.type==="Conditional"||i.data.type==="SetVariable")for(let r of i.data.type==="Conditional"?i.data.condition:i.data.expression)"id"in r&&Array.isArray(r.id)&&(r.id[0]==="mouse"&&(this.needsMouse=!0),r.id[0]==="raycast"&&(this.needsRaycast=!0));i.data.type==="DynamicVariablePlay"&&i.data.variableId!==""&&(i.data.mode==="Play"||i.data.mode==="PlayPause"||i.data.mode==="Toggle")&&t.setDynamicVariablePlayState(i.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(i=>{var r;if((r=i.data)!=null&&r.events.length){for(let n of i.data.events)if(!n.data.disabled)if(n.data.type==="VariableChange"&&(n.data.variableId==="mouseProperty"&&(this.needsMouse=!0),n.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),n.data.type==="Conditional")for(let s of["inActions","outActions"])n.data[s].forEach(e);else if(n.data.type==="DragDrop")for(let s of["drag","drop"])n.data.dragDropActions[s].forEach(e);else if(n.data.type==="GameControl")for(let s of["idle","move","jump","run"])n.data.gameActions[s].forEach(e);else if(n.data.type==="Resize")for(let s of n.data.breakpoints)s.data.actions.forEach(e);else n.data.type==="LookAt"||n.data.actions.forEach(e)}})}},YBe=class{constructor(t,e,i,r,n){this._aspect=1,this.enableResponsive=!1,this._renderer=t,this._camera=e,this._frameSize=new me().copy(i),this._editorSize=new me().copy(r),this._aspect=e.aspect,this._fov=n??e.fov}set frameSize(t){this._frameSize.copy(t)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let t=this._frameSize.x,e=this._frameSize.y,i=this._editorSize.y;this._aspect=t/e,e<=i&&(this._camera.zoom*=i/e),this._renderer.setViewport(0,0,t,e)}updateCamera(t=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let e=this._frameSize.y,i=this._editorSize.y,r=this._fov;if(t&&e>i){let n=KBe(e,1080,2160,1,15)/100;r*=e/i,r*=1-n}this._camera.aspect=this._aspect,this._camera.fov=r,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(t){this._camera=t,this._aspect=t.aspect,this._fov=t.fov}revert(){let t=window.innerWidth,e=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,t,e),this._renderer.setSize(t,e)),this._camera&&(this._camera.aspect=t/e,this._camera.fov=this._fov,this._camera.setViewplaneSize(t,e,this.enableResponsive),this._camera.updateProjectionMatrix())}};function KBe(t,e,i,r,n){return(t-e)/(i-e)*(n-r)+r}var JBe=class{get sharedAssets(){return this.shared}constructor(t,e={}){this.shared=new Pz(t.shared,e),this.scene=new zz(t.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(t,e){this.scene.clearScene(),this.sharedAssets.reset(t.shared),this.scene.resetAfterClear(t.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let t of this.scene.children)t instanceof bs&&!t.uiScene&&t.personalCamera.updateState(t.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(t=>{t instanceof po&&t.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},QBe=class{constructor({x:t=10,y:e=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}dispose(){var t;(t=this.element.parentElement)==null||t.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let t=performance.now()-this._startTime;this.element.innerHTML=t.toFixed(3)+" ms"}};function ZBe(t){let e;if(t.index)for(let i=0;i<t.index.array.length;i+=3)e=t.index.array[i],t.index.array[i]=t.index.array[i+2],t.index.array[i+2]=e}function yw(t){return t instanceof c1?"SubdivObject":t.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function $Be(t,e){let i={};return t.traverseEntity(r=>{var l;if(!r.visible||!(r instanceof qo)||r.type!=="Mesh"||Array.isArray(r.material)||r.states&&Object.keys(r.states).length)return;let n=r.parent;for(;n;){if(n instanceof qo&&r.states&&Object.keys(r.states).length)return;n=n.parent}let s=r.material.uuid,o=e.shared.materials[s];if(o){if(!fo.isMergable(o))return}else{let u=(l=e.scene.objects.get(r.uuid))==null?void 0:l.data;if(u&&"material"in u&&typeof u.material!="string"){if(!fo.isMergable(u.material))return;s=fo.getHash(u.material)}}i[s]||(i[s]={});let a=i[s][yw(r)];if(a){if(a.push(r),r.cloner)for(let u of r.cloner.children)a.push(u)}else if(i[s][yw(r)]=[r],r.cloner)for(let u of r.cloner.children)i[s][yw(r)].push(u)}),i}function eOe(t){let e=0;return Object.values(t).forEach(i=>{Object.values(i).forEach(r=>{let n=r.length;n>e&&(e=n)})}),e}function tOe(t,e){let i=$Be(e,t),r=eOe(i),n=new Array(r),s=0,o=new Array(r),a=0,l=new Array(r),u=0,c=new Array(r),h=0;for(let[d,p]of Object.entries(i))for(let f of Object.values(p)){if(a=0,u=0,f.forEach(g=>{g instanceof qo&&(o[a++]=g.geometry.clone(),l[u++]=g)}),u<2)continue;for(let g=0;g<u;g++)l[g].updateWorldMatrix(!0,!1),o[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&ZBe(o[g]);let m=em(o.slice(0,a),!1);if(m){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new zn(m,l[0].material);break}default:{g=new zn(m,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,e.add(g);let y=v=>{h=0;for(let b of v)b.children&&y(b.children),b instanceof qo&&(Array.isArray(b.material)||i[b.material.uuid]&&i[b.material.uuid][yw(b)]&&i[b.material.uuid][yw(b)].length>1||(c[h++]=b));for(let b=0;b<h;b++)e.attach(c[b])};for(let v=0;v<u;v++){let b=l[v];y(b.children),n[s++]=b}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var iOe=qn(Sce(),1),rOe=new me;function nOe(t){let e="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";t.endsWith(".spline")?console.warn(e+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(e)}var sOe=class{constructor(t,{renderOnDemand:e,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=r=>{var n,s,o,a,l,u,c,h,d,p,f,m,g;if(this.time=r,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(n=this._perfs)==null||n.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(o=this._perfs)==null||o.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((a=this._eventManager.handlers)!=null&&a.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(u=this._eventManager.handlers)!=null&&u.Conditional.hasVideoAction)&&(this._skipRender=!1),(c=this._animationControls)==null||c.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,(h=this._scene)==null||h.traverseVisibleEntity(y=>{y.type==="ParticleSystem"&&(y.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(d=this._eventManager)!=null&&d.isEnabled&&(((p=this._eventManager.handlers)==null?void 0:p.Follow).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.LookAt).onAnimationFrameDamping(),((m=this._eventManager.handlers)==null?void 0:m.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let y=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=y,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(g=this._perfs)==null||g.end()},this._resize=()=>{var r,n,s,o,a,l,u,c,h,d;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=rOe.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(r=this._scene)==null?void 0:r.activeCamera,(u=this._scene)==null||u.updateViewPlaneSize(((s=(n=this._frameView)==null?void 0:n.frameSize)==null?void 0:s.x)??this._viewportWidth,((a=(o=this._frameView)==null?void 0:o.frameSize)==null?void 0:a.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let p=Object.values(((c=this._data)==null?void 0:c.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(d=this._frameView)==null||d.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=$F(this._resize,10),this._onScroll=r=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=t,this.renderMode=e?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new QBe({x:10,y:10})),bEe(t)}async load(t,e,i){nOe(t),this.disposed=!1;let r=await(await fetch(t,i)).arrayBuffer();await this.start(r,{variables:e})}async start(t,{interactive:e=!0,variables:i}={}){var a,l,u,c;if(this.disposed)return;let r=await jBe(t);this._data=r,r.version&&(0,iOe.default)(r.version,"1.0.53")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([eW(r)&&iPe(),qTe(r)&&Z2e(),r1.physicsEnabled(r.scene.objects)&&AEe(),J9(r)&&ITe(),vW(r)&&BDe(),MBe(r)&&_Ee()].filter(Boolean)),(a=this._eventManager)==null||a.deactivate(),(l=this._controls)==null||l.deactivate(),(u=this._scene)==null||u.dispose();let n=new JBe(r);if(n.resetPersonalCameraFromDocumentData(),this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let h=performance.now();tOe(r,n.scene);let d=performance.now();console.log("Merged geometries in ",d-h," ms")}eW(r)&&this._scene.traverse(h=>{zc(h)&&h.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var h;this._requestRenderAutoMode(),(h=this._scene)==null||h.traverse(d=>{d instanceof vu&&d.pendingMediaLoad&&d.update()})}),(c=this._scene)==null||c.traverse(h=>{h.type==="ParticleSystem"&&(h.wakeUp(),h.data.autoPlay?h.start():h.stop())});let s=Object.keys(r.shared.fonts).map(h=>this._sharedAssetsManager.getFont(h).loadingPromise);if(Promise.all(s).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),J9(r)&&OBe(r)&&await Promise.all(s),vW(r)){let h=[];this._scene.traverseEntity(d=>{(d instanceof ho||d instanceof bs)&&d.uiCanvas&&h.push(d.uiCanvas)}),await Promise.all(h.map(d=>d.promise))}this._scene.rewriteEventsBeforeGoToPlayMode(),$z(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new ADe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=r.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),this._scene.initializeSplatViewer(this._renderer),r.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(r.scene.blueNoiseTextureData);let o=Object.values(r.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(o.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new YBe(this._renderer,this._camera,new me(this._viewportWidth,this._viewportHeight),new me(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&o.preset==="fullscreen"),e){let h=new LLe(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new UBe(h),this._animationControls=new FBe(this._scene,this._requestRenderAutoMode),this._eventManager=new XBe(r.scene.publish,this._controls,this._animationControls,h,r.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),i!==void 0&&this.setVariables(i),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var h;(h=this._renderer)==null||h.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(t){if(this._data!==void 0){let e=Object.entries(t);for(let[i,r]of e)this.setVariable(i,r)}}setVariable(t,e){var r;let i=this._getVariableByName(t);if(i&&!("dynamicVariableType"in i.data)){let n=e;typeof i.data.value=="number"?n=typeof e=="number"?e:typeof e=="boolean"?e===!0?1:0:parseFloat(e):typeof i.data.value=="boolean"?n=typeof e=="number"?!!e:typeof e=="boolean"?e:e.toLocaleLowerCase()==="false"?!1:!!e:typeof i.data.value!="string"&&i.data.value.textValue!==void 0&&(n=e.toString());let s=typeof n=="string"?{textValue:n}:n;(r=this._sharedAssetsManager)==null||r.updateVariable(i.id,s),this.requestRender(),this._requestRenderAutoMode()}else i===void 0?console.warn(`No variable named ${t} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in i.data&&console.warn(`Dynamic variables like ${t} cannot be updated from code.`)}getVariables(){let t={};return this._data&&this._data.shared.variables.forEach(e=>{t[e.data.name]===void 0&&(t[e.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(e.id)))}),t}getVariable(t){let e=this._getVariableByName(t);if(e){let i=this._sharedAssetsManager.getVariable(e.id);return this._getVariableValue(i)}}_getVariableValue(t){return typeof t!="string"&&Ha.isTextValue(t)?Ha.getDisplayedValue(t):t}_getVariableByName(t){if(this._data){if(this._variablesCache.has(t))return this._variablesCache.get(t);let e=this._data.shared.variables.find(i=>i.data.name===t);return e&&this._variablesCache.set(t,e),e}}findObjectById(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",t);return this._createProxyObject(e)}findObjectByName(t){var i;let e=(i=this._scene)==null?void 0:i.getObjectByName(t);return this._createProxyObject(e)}getAllObjects(){var e;let t=[];return(e=this._scene)==null||e.traverseEntity(i=>{if(i.uuid!==X0&&!this._scene.isInvisibleObjects(i)&&!(i instanceof bs)){let r=this._createProxyObject(i);r&&t.push(r)}}),t}getSplineEvents(){var t,e;return((e=(t=this._eventManager)==null?void 0:t.handlers)==null?void 0:e.Spline).splineEvents}emitEvent(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEvent(t)}emitEventReverse(t,e){var i;(i=this.findObjectById(e)||this.findObjectByName(e))==null||i.emitEventReverse(t)}addEventListener(t,e){this.canvas.addEventListener(t,e)}removeEventListener(t,e){this.canvas.removeEventListener(t,e)}setZoom(t){var e,i;((e=this._controls)==null?void 0:e.orbitControls)instanceof rie&&((i=this._controls)==null||i.orbitControls.zoomOut(t))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(t,e){this._viewportWidth=t,this._viewportHeight=e,this._viewportMode=2,this._resize()}setBackgroundColor(t){var o;let{r:e,g:i,b:r,a:n}={r:0,g:0,b:0,a:1},s=new Ws(e,i,r,n);try{s.setStyle(t)}catch{console.error("This is not a valid css color",t)}(o=this._scene)==null||o.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var t,e,i,r,n,s,o;this.disposed=!0,(t=this._eventManager)==null||t.deactivate(),(e=this._scene)==null||e.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(a=>{g6.unsubscribe(a)}),this._variablesCache.clear(),(r=this._renderer)==null||r.setAnimationLoop(null),(n=this._renderer)==null||n.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(o=this._controls)==null||o.deactivate(),xEe(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){var t,e,i;this._isPaused||((t=this._renderer)==null||t.setAnimationLoop(null),this._isPaused=!0,(e=this._eventManager)==null||e.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var t,e,i;!this._isPaused||(this._isPaused=!1,(t=this._eventManager)==null||t.resume(),(e=this._controls)!=null&&e.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(t){var e;(e=this._eventManager)==null||e.updateUseWindowEvents(t)}get data(){return this._data}_createProxyObject(t){var n;if(t==null)return;if(this._proxyObjectCache.has(t.uuid))return this._proxyObjectCache.get(t.uuid);let e;t.traverseAncestors(s=>{s instanceof bs&&(e=s.name)});let i={name:t.name,uuid:t.uuid,visible:t.visible,intensity:t.intensity,position:t.position,rotation:t.rotation,scale:t.scale,type:t.data.type,page:e,parentUuid:t.parent instanceof bs||t instanceof zz||(n=t.parent)==null?void 0:n.uuid,emitEvent(s){t.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){t.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},r=g6(i,(s,o)=>{var a;typeof t[s]!="object"&&((a=Object.getOwnPropertyDescriptor(t,s))!=null&&a.writable)&&(t[s]=o),this._requestRenderAutoMode(),t.updateMatrix()});return this._proxyObjectCache.set(t.uuid,r),r}setUIWasmUrl(t){Dee.skiaWasmUrl=t}},aE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},HO={},oOe={get exports(){return HO},set exports(t){HO=t}},fx={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tq;function aOe(){if(Tq)return fx;Tq=1;var t=Ho,e=Symbol.for("react.element"),i=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,u){var c,h={},d=null,p=null;u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(c in l)r.call(l,c)&&!s.hasOwnProperty(c)&&(h[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)h[c]===void 0&&(h[c]=l[c]);return{$$typeof:e,type:a,key:d,ref:p,props:h,_owner:n.current}}return fx.Fragment=i,fx.jsx=o,fx.jsxs=o,fx}(function(t){t.exports=aOe()})(oOe);const GO=HO.jsx;var lOe="Expected a function",Rq=0/0,uOe="[object Symbol]",hOe=/^\s+|\s+$/g,cOe=/^[-+]0x[0-9a-f]+$/i,dOe=/^0b[01]+$/i,pOe=/^0o[0-7]+$/i,fOe=parseInt,mOe=typeof aE=="object"&&aE&&aE.Object===Object&&aE,gOe=typeof self=="object"&&self&&self.Object===Object&&self,yOe=mOe||gOe||Function("return this")(),vOe=Object.prototype,bOe=vOe.toString,xOe=Math.max,wOe=Math.min,U3=function(){return yOe.Date.now()};function _Oe(t,e,i){var r,n,s,o,a,l,u=0,c=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(lOe);e=kq(e)||0,VO(i)&&(c=!!i.leading,h="maxWait"in i,s=h?xOe(kq(i.maxWait)||0,e):s,d="trailing"in i?!!i.trailing:d);function p(S){var E=r,M=n;return r=n=void 0,u=S,o=t.apply(M,E),o}function f(S){return u=S,a=setTimeout(y,e),c?p(S):o}function m(S){var E=S-l,M=S-u,R=e-E;return h?wOe(R,s-M):R}function g(S){var E=S-l,M=S-u;return l===void 0||E>=e||E<0||h&&M>=s}function y(){var S=U3();if(g(S))return v(S);a=setTimeout(y,m(S))}function v(S){return a=void 0,d&&r?p(S):(r=n=void 0,o)}function b(){a!==void 0&&clearTimeout(a),u=0,r=l=n=a=void 0}function _(){return a===void 0?o:v(U3())}function A(){var S=U3(),E=g(S);if(r=arguments,n=this,l=S,E){if(a===void 0)return f(l);if(h)return a=setTimeout(y,e),p(l)}return a===void 0&&(a=setTimeout(y,e)),o}return A.cancel=b,A.flush=_,A}function VO(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function SOe(t){return!!t&&typeof t=="object"}function AOe(t){return typeof t=="symbol"||SOe(t)&&bOe.call(t)==uOe}function kq(t){if(typeof t=="number")return t;if(AOe(t))return Rq;if(VO(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=VO(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(hOe,"");var i=dOe.test(t);return i||pOe.test(t)?fOe(t.slice(2),i?2:8):cOe.test(t)?Rq:+t}var EOe=_Oe;function MOe(t){return e=>{t.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}const COe=[],POe={width:"100%",height:"100%"},TOe=se.forwardRef(function({className:t,children:e,debounceTime:i=300,ignoreDimensions:r=COe,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const u=se.useRef(null),c=se.useRef(0),[h,d]=se.useState({width:0,height:0,top:0,left:0}),p=se.useMemo(()=>{const f=Array.isArray(r)?r:[r];return EOe(m=>{d(g=>Object.keys(g).filter(y=>g[y]!==m[y]).every(y=>f.includes(y))?g:m)},i,{leading:s})},[i,s,r]);return se.useEffect(()=>{const f=o||window.ResizeObserver,m=new f(g=>{g.forEach(y=>{const{left:v,top:b,width:_,height:A}=(y==null?void 0:y.contentRect)??{};c.current=window.requestAnimationFrame(()=>{p({width:_,height:A,top:b,left:v})})})});return u.current&&m.observe(u.current),()=>{window.cancelAnimationFrame(c.current),m.disconnect(),p.cancel()}},[p,o]),GO("div",{style:{...POe,...n},ref:MOe([l,u]),className:t,...a,children:e({...h,ref:u.current,resize:p})})}),JP=se.forwardRef(({scene:t,style:e,onMouseDown:i,onMouseUp:r,onMouseHover:n,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:u,onWheel:c,onLoad:h,renderOnDemand:d=!0,...p},f)=>{const m=se.useRef(null),[g,y]=se.useState(!0);return se.useEffect(()=>{y(!0);let v;const b=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:r},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:u},{name:"scroll",cb:c}];if(m.current){v=new sOe(m.current,{renderOnDemand:d});async function _(){await v.load(t);for(let A of b)A.cb&&v.addEventListener(A.name,A.cb);y(!1),h==null||h(v)}_()}return()=>{for(let _ of b)_.cb&&v.removeEventListener(_.name,_.cb);v.dispose()}},[t]),GO(TOe,{ref:f,parentSizeStyles:e,debounceTime:50,...p,children:()=>GO("canvas",{ref:m,style:{display:g?"none":"block"}})})}),Z0=t=>({method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),rg=t=>({method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),t4=t=>({method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),Lr=async(t,e={})=>{try{const i=await fetch(t,e),{ok:r,status:n,headers:s}=i;if(!r)throw new Error(`Fetch failed with status - ${n}`,{cause:n});return[await((s.get("content-type")||"").includes("application/json")?i.json():i.text()),null]}catch(i){return console.warn(i),[null,i]}},i4={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},ROe=(t,e)=>t>e?{color:"red",timeText:"Start time cannot be later than end time"}:t===e?{color:"red",timeText:"Start time cannot be the same as end time"}:{color:null,timeText:null},kOe=t=>t.length===0?{tagColor:"red",tagText:"You must select at least one tag for your event"}:{tagColor:null,tagText:null},DOe={"Prospect Park, Brooklyn, NY":"https://thumbs.6sqft.com/wp-content/uploads/2017/06/19174904/prospectpark-e1497909025369.jpg","Brooklyn Bridge Park, Brooklyn, NY":"https://media.timeout.com/images/105683556/image.jpg","McCarren Park, Brooklyn, NY":"https://media.cntraveler.com/photos/5ff637cd1cae1c5896a5f6c3/16:9/w_2560,c_limit/2C7FAW9.jpg","Fort Greene Park, Brooklyn, NY":"https://images.ctfassets.net/1aemqu6a6t65/2KQqJk6ZV3Lsld5H8awzVr/871369d06ea46798e42483e22a3c0216/ftgreene23f?w=1200&h=800&q=75","Marine Park, Brooklyn, NY":"https://static.nycgovparks.org/images/photo_gallery/full_size/22933.jpg","Sunset Park, Brooklyn, NY":"https://images.ctfassets.net/1aemqu6a6t65/3eUGLuY9k4IfQzy4Z6FcEJ/5157b4fb671eb9a46be0af9670df72f5/Sunset-Park-Brooklyn-NYC-Photo-Jordana-Berm__dez.jpg","Domino Park, Brooklyn, NY":"https://cdn.vox-cdn.com/thumbor/Hu91h6N8isy3qREZOYHHwPTCspw=/0x0:2000x1333/1200x800/filters:focal(840x507:1160x827)/cdn.vox-cdn.com/uploads/chorus_image/image/59971589/180524_11_38_47_5DSR5465.0.jpg","Brooklyn Heights Promenade Park, Brooklyn, NY":"https://www.tclf.org/sites/default/files/styles/crop_2000x700/public/thumbnails/image/NY_NYC_BrooklynHeightsPromenade_WikimediaCommons_2017_01_Hero.jpg?itok=0ESTJznT","Manhattan Beach Park, Brooklyn, NY":"https://static.nycgovparks.org/images/photo_gallery/full_size/24748.jpg","WNYC Transmitter Park, Brooklyn, NY":"https://transmitterpark.org/wp-content/uploads/2022/09/13-29-04A-1400-xxx_q85-orig.jpg","Owls Head Park, Brooklyn, NY":"https://pbs.twimg.com/media/DbtxosvW4AAxuhV.jpg","Bushwich Inlet Park, Brooklyn, NY":"https://static.nycgovparks.org/images/photo_gallery/full_size/24722.jpg","Online Class":"https://www.billboard.com/wp-content/uploads/2024/01/online-fitness-class-2024-billboard-1548.jpg?w=942&h=623&crop=1"},nie=t=>DOe[t],Wh="/api/events",IOe=async({title:t,location:e,description:i,date:r,end_date:n,user_id:s})=>Lr(Wh,rg({title:t,location:e,description:i,date:r,end_date:n,user_id:s})),r4=async({user_id:t,event_id:e})=>{console.log(t,e),Lr(`${Wh}/relations/${e}`,rg({user_id:t,event_id:e}))},sie=async({user_id:t,event_id:e})=>{console.log(t,e),Lr(`${Wh}/relations/${e}`,Z0({user_id:t,event_id:e})),console.log(`leave attempt on event  ${e}`)},Dq=async()=>{const[t]=await Lr(Wh);return t||[]},jO=async t=>{console.log("fetching attendees amount");const e=await Lr(`${Wh}/relations/${t}`);return console.log(`attendees :${e}`),e||0},LOe=async t=>{const[e]=await Lr(`${Wh}/${t}/comments`);return e||[]},BOe=async({event_id:t,event_tag_ids:e})=>{Lr(`${Wh}/tags/${t}`,rg({event_tag_ids:e}))},QP=async({event_id:t})=>{Lr(`${Wh}/${t}`,Z0({event_id:t}))},OOe=async({user_id:t,event_id:e,text:i})=>{const r=`${Wh}/${e}/comments`;try{const[n,s]=await Lr(r,rg({user_id:t,event_id:e,text:i}));if(s)throw new Error("Failed to post comment");return n}catch(n){throw console.error("Error posting comment:",n),n}},UOe=async t=>Lr(`/api/comments/${t}/hide`,t4({})),NOe=async t=>{const[e]=await Lr(`${Wh}/${t}`);return e[0]||{}},ng="/api/users",FOe=async({username:t,password:e,fullName:i,email:r})=>{console.log(i);const n=i;return console.log(n,t),await Lr(ng,rg({username:t,password:e,name:n,email:r}))},n4=async t=>{const[e]=await Lr(`${ng}/events/${t}/signed`);return e||[]},oie=async t=>{const[e]=await Lr(`${ng}/events/${t}`);return e||[]},zOe=async t=>Lr(`${ng}/${t}`),HOe=async({id:t,username:e})=>{Lr(`${ng}/${t}`,t4({id:t,username:e}))},GOe=async({id:t})=>{Lr(`${ng}/${t}`,Z0({id:t}))},VOe=async({id:t,profile_pic:e})=>(console.log(e),Lr(`${ng}/profilePic/${t}`,t4({id:t,profile_pic:e}))),Yo=se.createContext({}),ZP="/api/notifications",aie=async({event_id:t,recipient_id:e,attendee_id:i,text:r})=>Lr(ZP,rg({event_id:t,recipient_id:e,attendee_id:i,text:r})),jOe=async t=>{const[e]=await Lr(`${ZP}/${t}`);return console.log(e),e||[]},WOe=async t=>{console.log(t),Lr(`${ZP}/${t}`,Z0({userId:t}))},lie=async(t,e)=>{console.log(t),Lr(`${ZP}`,Z0({userId:t,attendeeId:e}))},qOe=({comment:t,refreshComments:e})=>{const{currentUser:i}=se.useContext(Yo);new Date(t.date).toLocaleString("en-US",i4);const r=async()=>{try{await UOe(t.id),e()}catch(n){console.error("Failed to hide comment:",n)}};return U.jsx("div",{children:U.jsxs("div",{className:"flex flex-col",children:[U.jsxs("div",{className:"flex flex-row mt-12",children:[U.jsx("div",{className:"max-w-16 max-h-16 flex justify-center",children:U.jsx("img",{className:"rounded-full",src:"../upload/default.jpg",width:"full",height:"full"})}),U.jsx("div",{className:"flex justify-center items-center font-medium ml-2",children:U.jsxs("p",{children:[" ",t.commenter_name," "]})})]}),U.jsxs("div",{className:"mt-2",children:[U.jsxs("p",{className:"max-w-full",children:[" ",t.text," "]}),i.id===t.user_id&&U.jsx("button",{onClick:r,children:"Delete Comment"})]})]})},t.id-900)},XOe=({eventId:t,userId:e})=>{const[i,r]=se.useState([]),[n,s]=se.useState(""),[o,a]=se.useState(!1),{currentUser:l}=se.useContext(Yo),u=async()=>{const f=await LOe(t);r(f)},c={borderRadius:"5px",background:"linear-gradient(225deg, #8be28b, #eab308)",boxShadow:"-5px 5px 18px #cacaca, 5px -5px 18px #f6f6f6"};se.useEffect(()=>{u()},[t]),se.useEffect(()=>{const f=h.current;f&&(f.style.height="auto",f.style.height=f.scrollHeight+"px")},[n]);const h=se.useRef(null),d=async f=>{if(f==null||f.preventDefault(),!n.trim()){alert("Please type something before submitting.");return}try{const m=await OOe({user_id:l.id,event_id:t,text:n.trim()});s(""),r(g=>[...g,m])}catch(m){console.error("Failed to post comment:",m)}},p=f=>{f.key==="Enter"&&!f.shiftKey&&d(f)};return U.jsxs("div",{className:"comments",children:[U.jsx("button",{className:"mt-2",onClick:()=>a(!o),children:o?"Cancel":"Add Comment"}),o&&U.jsxs("form",{onSubmit:d,className:"comment-form",children:[U.jsx("textarea",{ref:h,value:n,onChange:f=>s(f.target.value),onKeyDown:p,placeholder:"Add a comment...","aria-label":"Write a comment",className:"comment-textarea w-full mt-5 border-b-2 border-gray-500 max-h-10",style:{resize:"none"}}),U.jsx("button",{style:c,type:"submit",className:"submit-comment p-2 px-5 text-white font-bold mt-3",children:"Submit"})]}),U.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.length===0?U.jsx("p",{children:"No comments yet."}):i.map(f=>U.jsx(qOe,{comment:f,currentUser:l,refreshComments:u},f.id))})]})},uie=t=>{const{eventId:e,joinEvent:i,joinedEvents:r}=t;return U.jsx("div",{children:U.jsx("button",{onClick:i,className:r[e]?"leave-event":"join-event",children:U.jsx("p",{className:"font-bold",children:r&&r[e]?"Leave event":"Join Event"})})})};function YOe({location:t}){return U.jsx("iframe",{className:"mt-5",width:"100%",height:"500",allowFullScreen:"",loading:"async",referrerPolicy:"no-referrer-when-downgrade",src:`https://maps.google.com/maps?&q="+${t}"&output=embed`})}const j2=t=>{const{currentUser:e}=se.useContext(Yo),{event:i,loadJoinedEvents:r,joinedEvents:n,deleteEvent:s}=t;se.useState(!1);const[o,a]=se.useState(0);se.useState(!1),se.useState("Loading...");const l=i.tag_names.split(",").map(f=>f.trim()),u=new Date(i.date).toLocaleString("en-US",i4),c=new Date(i.end_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});se.useEffect(()=>{(async()=>{const m=new Date().getTime(),g=new Date(i.end_date).getTime();m>g&&await QP({event_id:i.id})})()},[i.end_date,i.id]);const h=async()=>{const f=e.id,m=i.id;i.id in n?(await sie({user_id:f,event_id:m}),lie(i.user_id,f)):await r4({user_id:f,event_id:m}),setTimeout(async()=>{await r()},100),setTimeout(async()=>{const g=await jO(i.id);a(g)},160),aie({event_id:m,recipient_id:i.user_id,attendee_id:f,text:`
    ${e.name} joined Event ${i.title}`})},d=()=>n[i.id]?!0:i.location==="Online Class"&&i.attendee_count<4||i.location!=="Online Class";return(()=>{const f=new Date().getTime(),m=new Date(i.date).getTime(),g=3e5;return m-f<=g?U.jsx(Zd,{to:`/room/${i.user_id}`,children:"Link to online room"}):U.jsx("p",{children:"Your Link to the meeting will appear 5 minutes before the event."})})(),U.jsxs("div",{className:"event max-w-xs p-4 relative",children:[console.log(i),U.jsxs(Zd,{to:`/event/${i.id}`,children:[U.jsx("img",{src:nie(i.location),alt:"Modern Glass-Walled House",className:"w-full h-64 object-cover rounded-lg shadow-md mb-4"}),U.jsx("div",{className:"absolute top-0 left-0 w-20 h-7 ml-8 mt-8 font-medium",children:U.jsx("div",{className:"flex flex-col space-y-2",children:l.map(f=>U.jsx("div",{className:"bg-white text-center justify-center rounded-full w-40 h-7",children:f},f))})}),U.jsxs("div",{className:" rounded-lg",children:[U.jsx("h1",{className:"text-md font-semibold mb-4",children:i.title}),U.jsxs("div",{className:"text-sm font-normal text-gray-500",children:[U.jsx("p",{className:"mb-2",children:i.location}),U.jsxs("p",{className:"mb-2",children:[u,"  ",c]}),U.jsx("p",{className:"mb-4"})]})]}),U.jsxs("p",{children:["Attendents: ",o||i.attendee_count]})]}),e&&e.id!==i.user_id&&i.id&&d()&&U.jsx(uie,{joinEvent:h,eventId:i.id,joinedEvents:n}),e&&e.id===i.user_id?U.jsx("button",{onClick:s,style:{color:"red",textAlign:"center"},children:"Delete Event"}):U.jsx("p",{})]})},Iq=t=>{let e;const i=new Set,r=(c,h)=>{const d=typeof c=="function"?c(e):c;if(!Object.is(d,e)){const p=e;e=h??(typeof d!="object"||d===null)?d:Object.assign({},e,d),i.forEach(f=>f(e,p))}},n=()=>e,l={setState:r,getState:n,getInitialState:()=>u,subscribe:c=>(i.add(c),()=>i.delete(c)),destroy:()=>{i.clear()}},u=e=t(r,n,l);return l},KOe=t=>t?Iq(t):Iq;var hie={exports:{}},cie={},die={exports:{}},pie={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0=se;function JOe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var QOe=typeof Object.is=="function"?Object.is:JOe,ZOe=f0.useState,$Oe=f0.useEffect,eUe=f0.useLayoutEffect,tUe=f0.useDebugValue;function iUe(t,e){var i=e(),r=ZOe({inst:{value:i,getSnapshot:e}}),n=r[0].inst,s=r[1];return eUe(function(){n.value=i,n.getSnapshot=e,N3(n)&&s({inst:n})},[t,i,e]),$Oe(function(){return N3(n)&&s({inst:n}),t(function(){N3(n)&&s({inst:n})})},[t]),tUe(i),i}function N3(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!QOe(t,i)}catch{return!0}}function rUe(t,e){return e()}var nUe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rUe:iUe;pie.useSyncExternalStore=f0.useSyncExternalStore!==void 0?f0.useSyncExternalStore:nUe;die.exports=pie;var sUe=die.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $P=se,oUe=sUe;function aUe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var lUe=typeof Object.is=="function"?Object.is:aUe,uUe=oUe.useSyncExternalStore,hUe=$P.useRef,cUe=$P.useEffect,dUe=$P.useMemo,pUe=$P.useDebugValue;cie.useSyncExternalStoreWithSelector=function(t,e,i,r,n){var s=hUe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=dUe(function(){function l(p){if(!u){if(u=!0,c=p,p=r(p),n!==void 0&&o.hasValue){var f=o.value;if(n(f,p))return h=f}return h=p}if(f=h,lUe(c,p))return f;var m=r(p);return n!==void 0&&n(f,m)?f:(c=p,h=m)}var u=!1,c,h,d=i===void 0?null:i;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,i,r,n]);var a=uUe(t,s[0],s[1]);return cUe(function(){o.hasValue=!0,o.value=a},[a]),pUe(a),a};hie.exports=cie;var fUe=hie.exports;const mUe=F1(fUe),{useDebugValue:gUe}=Ho,{useSyncExternalStoreWithSelector:yUe}=mUe,vUe=t=>t;function bUe(t,e=vUe,i){const r=yUe(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,i);return gUe(r),r}const Lq=t=>{const e=typeof t=="function"?KOe(t):t,i=(r,n)=>bUe(e,r,n);return Object.assign(i,e),i},qh=t=>t?Lq(t):Lq,Bq=qh(t=>({errorText:"",setErrorText:e=>t({errorText:e})})),xUe=qh(t=>({workout:"",setWorkout:e=>t({workout:e})})),wUe=qh((t,e)=>({events:[],copiedEvents:[],setRecentEvents:async()=>t({events:await Dq(),copiedEvents:await Dq()}),setUserEvents:async i=>t({events:await oie(i)}),filterEvents:async i=>{console.log(i);const r=e().copiedEvents.filter(n=>n.location.toLowerCase().includes(i.toLowerCase()));console.log(r),t({events:r})}})),_Ue=qh(t=>({selectedTags:[],addTag:e=>t(i=>({selectedTags:[...i.selectedTags,e]})),emptyTags:()=>t({selectedTags:[]}),setSelectedTags:e=>t({selectedTags:e}),err:{color:null,timeText:null,tagText:null,tagColor:null},setErr:e=>t({err:e})})),SUe=qh(t=>({events:[],setUserEvents:async e=>t({events:await oie(e)}),userProfile:null,setUserProfile:e=>t({userProfile:e}),errorText:"",setErrorText:e=>t({errorText:e})})),s4=qh(t=>({page:6,setPage:e=>t({page:e*6}),previous:0,setPrevious:e=>t({previous:(e-1)*6}),pageNumber:1,setPageNumber:e=>t({pageNumber:e}),pageLength:null,setPageLength:e=>t({pageLength:e}),reset:()=>t({page:6,previous:0,pageNumber:1})})),o4=qh(t=>({exerciseIndex:null,setExerciseIndex:e=>t({exerciseIndex:e})})),AUe=qh(t=>({hotEvent:null,setHotEvent:e=>t({hotEvent:e})})),EUe=qh(t=>({isHovered1:!1,setIsHovered1:e=>t({isHovered1:e}),isHovered2:!1,setIsHovered2:e=>t({isHovered2:e}),isHovered3:!1,setIsHovered3:e=>t({isHovered3:e}),isHovered4:!1,setIsHovered4:e=>t({isHovered4:e}),isHovered5:!1,setIsHovered5:e=>t({isHovered5:e}),isHovered6:!1,setIsHovered6:e=>t({isHovered6:e}),isHovered7:!1,setIsHovered7:e=>t({isHovered7:e}),isHovered8:!1,setIsHovered8:e=>t({isHovered8:e}),isHovered9:!1,setIsHovered9:e=>t({isHovered9:e}),isHovered10:!1,setIsHovered10:e=>t({isHovered10:e}),isHovered11:!1,setIsHovered11:e=>t({isHovered11:e}),isHovered12:!1,setIsHovered12:e=>t({isHovered12:e}),isHovered13:!1,setIsHovered13:e=>t({isHovered13:e})})),a4=qh(t=>({partSelected:"none",setPartSelected:e=>t({partSelected:e})}));function MUe({id:t,loadUserEvents:e}){const{selectedTags:i,addTag:r,emptyTags:n,setSelectedTags:s,err:o,setErr:a}=_Ue(m=>m);console.log(i);const l=document.querySelector(".modal"),u=document.querySelector(".modal-wrap"),c=()=>{l.style.opacity=0,l.style.pointerEvents="none",u.style.opacity=0,u.style.transform="scale(0.6)"},h=["yoga","running","biking","weight-lifting","calisthenics","coaching","jogging"],d=async m=>{m.preventDefault();const g=new FormData(m.target),{title:y,location:v,description:b,date:_,startTime:A,endTime:S}=Object.fromEntries(g);console.log(y,v,b,_,A,S),console.log(Object.fromEntries(g)),document.querySelector("#dialogModal");const E=ROe(A,S),M=kOe(i);if(a({...E,...M}),E.color||M.tagColor)return;a({color:null,timeText:null,tagText:null,tagColor:null});const R=await IOe({title:y,location:v,description:b,date:`${_} ${A}`,end_date:`${_} ${S}`,user_id:t});console.log(R),await BOe({event_id:R[0],event_tag_ids:i}),await r4({user_id:t,event_id:R[0]}),n(),m.target.reset(),e(),c()},p=new Date().toISOString().split("T")[0],f=m=>{const g=Number(m.target.value);if(m.target.checked)r(g);else{const v=i.filter(b=>b!==g);s(v)}};return U.jsx("div",{children:U.jsx("div",{className:"mt-10 px-5 sm:mx-auto sm:w-full sm:max-w-sm",children:U.jsxs("form",{onSubmit:d,"aria-labelledby":"login-heading",className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Title for your event"}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{type:"text",id:"title",name:"title",required:!0,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-red-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("label",{htmlFor:"location",className:"block text-sm font-medium leading-6 text-gray-900",children:"Select a park"}),U.jsxs("select",{className:"relative w-full cursor-default rounded-md bg-white p-2 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-red-600 sm:text-sm sm:leading-6",id:"location",name:"location",required:!0,defaultValue:"",children:[U.jsx("option",{value:"",disabled:!0,children:"Select a Park"}),U.jsx("option",{value:"Prospect Park, Brooklyn, NY",children:"Prospect Park"}),U.jsx("option",{value:"Brooklyn Bridge Park, Brooklyn, NY",children:"Brooklyn Bridge Park"}),U.jsx("option",{value:"McCarren Park, Brooklyn, NY",children:"McCarren Park"}),U.jsx("option",{value:"Fort Greene Park, Brooklyn, NY",children:"Fort Greene Park"}),U.jsx("option",{value:"Marine Park, Brooklyn, NY",children:"Marine Park"}),U.jsx("option",{value:"Sunset Park, Brooklyn, NY",children:"Sunset Park"}),U.jsx("option",{value:"Domino Park, Brooklyn, NY",children:"Domino Park"}),U.jsx("option",{value:"Brooklyn Heights Promenade Park, Brooklyn, NY",children:"Brooklyn Heights Promenade Park"}),U.jsx("option",{value:"Manhattan Beach Park, Brooklyn, NY",children:"Manhattan Beach Park"}),U.jsx("option",{value:"WNYC Transmitter Park, Brooklyn, NY",children:"WNYC Transmitter Park"}),U.jsx("option",{value:"Owls Head Park, Brooklyn, NY",children:"Owls Head Park"}),U.jsx("option",{value:"Bushwich Inlet Park, Brooklyn, NY",children:"Bushwich Inlet Park"}),U.jsx("option",{value:"Online Class",children:"Online Class"})]})]}),U.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",htmlFor:"date",children:"Visit Date"}),U.jsx("input",{className:"relative w-full cursor-default rounded-md bg-white p-2 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-red-600 sm:text-sm sm:leading-6",type:"date",id:"date",name:"date",required:!0,min:p,style:{marginTop:"0px"}}),U.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",htmlFor:"startTime",children:"Select a start time"}),U.jsx("input",{type:"time",id:"startTime",name:"startTime",className:"relative w-full cursor-default rounded-md bg-white p-2 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-red-600 sm:text-sm sm:leading-6",required:!0,style:{color:o.color,marginTop:"0px"}}),U.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",htmlFor:"endTime",children:"Select an end time"}),U.jsx("input",{type:"time",id:"endTime",name:"endTime",required:!0,className:"relative w-full cursor-default rounded-md bg-white p-2 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-red-600 sm:text-sm sm:leading-6",style:{color:o.color,marginTop:"0px"}}),U.jsxs("fieldset",{style:{color:o.tagColor},children:[U.jsx("legend",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Select Tags"}),U.jsx("div",{className:"flex flex-col",children:h.map((m,g)=>U.jsxs("label",{className:"flex flex-row text-center font-semibold",children:[U.jsx("input",{type:"checkbox",id:m,name:"tags",className:" justify-center",value:g+1,checked:i.includes(g+1),onChange:f}),m]},m))})]}),U.jsxs("div",{children:[U.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Description"}),U.jsx("div",{className:"h-20 mt-2",children:U.jsx("textarea",{type:"text",id:"description",name:"description",required:!0,className:"block resize-none w-full h-full rounded-md border-0 p-2 px-2 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-red-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("button",{className:"flex w-full mt-12 justify-center rounded-md bg-orange-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #FDBA74, #EA580C)",boxShadow:"-5px 5px 10px rgba(253, 186, 116, 0.5), 5px -5px 10px rgba(234, 88, 12, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Submit"}),U.jsxs("p",{className:"mt-10 text-center text-sm text-gray-500",children:[" ","Enjoy your Event"," "]})]})]})})})}const WO="/assets/Group_1-a3280aa5.png",a_=({currentUser:t})=>{const e=()=>{document.getElementsByClassName("navigation")[0].classList.toggle("active"),document.getElementsByClassName("ham-btn")[0].classList.toggle("bg-orange-200")},i=r=>{const n=document.getElementsByClassName("navigation")[0];switch(console.log("test"),r){case"about":n.classList.toggle("bg-red-300");break;case"community":n.classList.toggle("bg-orange-300");break;case"workouts":n.classList.toggle("bg-green-300");break;case"profile":n.classList.toggle("bg-blue-200");break;default:console.log(`Sorry, we are out of ${expr}.`)}};return U.jsxs("div",{className:"flex flex-row",children:[U.jsx("div",{className:"w-50 h-50",children:U.jsx("img",{className:"fixed rounded-sm z-50 -top-5 left-20",src:WO,alt:"Smiley face 2",width:"140",height:"140"})}),U.jsxs("div",{className:"navigation",children:[U.jsx("div",{className:"fixed -translate-y-3",children:U.jsx("img",{className:"absolute rounded-sm ml-24 mt-5",src:WO,alt:"Smiley face",width:"72",height:"72"})}),U.jsxs("div",{className:"h-full w-full bg-center bg-no-repeat bg-cover relative",children:[U.jsxs("div",{className:"ham-btn",onClick:e,children:[U.jsx("span",{className:"rounded-sm"}),U.jsx("span",{className:"rounded-sm"})]}),U.jsx("div",{className:" h-full w-[98.8%]",children:U.jsx(JP,{className:"spline h-full w-full ",scene:"https://prod.spline.design/267PHsT9Kp1A2iJ6/scene.splinecode"})})]}),U.jsxs("div",{className:"links ",children:[U.jsx("div",{className:"link",onMouseOver:()=>i("community"),onMouseOut:()=>i("community"),children:U.jsx(Zd,{to:"/community",children:"Events"})}),U.jsx("div",{className:"link-2",onMouseOver:()=>i("workouts"),onMouseOut:()=>i("workouts"),children:U.jsx(Zd,{to:"/workouts",children:"Workouts"})}),U.jsx("div",{className:"link-3",onMouseOver:()=>i("profile"),onMouseOut:()=>i("profile"),children:t&&U.jsx(Zd,{to:`/users/${t.id}`,children:"Profile"})}),U.jsx("div",{className:"link-4",onMouseOver:()=>i("about"),onMouseOut:()=>i("about"),children:U.jsx(Zd,{to:"/about",children:"About"})}),U.jsx("div",{className:"link-5",onMouseOver:()=>i("about"),onMouseOut:()=>i("about"),children:U.jsx(Zd,{to:"/",children:"Home"})})]})]})]})};function CUe(){const{currentUser:t}=se.useContext(Yo),[e,i]=se.useState({}),{events:r,setRecentEvents:n,filterEvents:s,setUserEvents:o}=wUe(m=>m),{hotEvent:a,setHotEvent:l}=AUe(m=>m);se.useEffect(()=>{t&&(n(),o(t.id))},[t]);const u=async()=>{if(t){const m=await n4(t.id),g={};m.forEach(y=>{g[y.id]=!0}),i(g)}};se.useEffect(()=>{u()},[t]);const c=async m=>{QP({event_id:m}),n()};se.useEffect(()=>{if(r[0]){const m=r.reduce((g,y)=>g.attendee_count>y.attendee_count?g:y);l(m)}},[r]);const h=m=>{m.target.value.trim().length?s(m.target.value):n()},d={background:"linear-gradient(225deg, #FED7AA, #F97316)",boxShadow:"-8px 8px 12px #F97316, 8px -8px 12px #FED7AA"},p=se.useRef(null),f=se.useRef(null);return se.useEffect(()=>{const m=document.querySelector(".modal"),g=document.querySelector(".modal-wrap"),y=()=>{m.style.opacity=1,m.style.pointerEvents="auto",g.style.opacity=1,g.style.transform="scale(1)"},v=()=>{m.style.opacity=0,m.style.pointerEvents="none",g.style.opacity=0,g.style.transform="scale(0.6)"},b=p.current,_=f.current;return b&&b.addEventListener("click",y),_&&_.addEventListener("click",v),()=>{b&&b.removeEventListener("click",y),_&&_.removeEventListener("click",v)}},[]),U.jsxs(U.Fragment,{children:[U.jsx("div",{className:"section full-height",children:U.jsx("div",{className:"modal",style:{zIndex:"99999999999"},children:U.jsxs("div",{className:"modal-wrap",children:[U.jsxs("button",{className:" px-3 h-8 bg-orange-200 ml-2 rounded-md mt-2 text-white",ref:f,id:"close-btn",children:[" ","X"," "]}),U.jsx("h1",{className:"text-xl font-bold text-center",children:"Create an Event"}),t?U.jsx(MUe,{id:t.id,loadUserEvents:()=>n()}):U.jsx("div",{children:"Loading..."})]})})}),U.jsx(a_,{currentUser:t}),U.jsxs("div",{className:"h-[380px] bg-center bg-no-repeat bg-cover relative bg-orange-200",children:[U.jsx(JP,{className:"h-screen bg-center bg-no-repeat bg-cover relative",scene:"https://prod.spline.design/267PHsT9Kp1A2iJ6/scene.splinecode"}),U.jsx("h1",{className:"absolute left-7 bottom-28 text-8xl mb-7",children:"Excercise with"}),U.jsxs("h1",{className:"absolute left-7 bottom-24 text-4xl",children:[U.jsx("span",{className:"text-orange-600",children:"Others"}),U.jsx("span",{className:"text-black",children:"."})]}),U.jsx("div",{className:"absolute left-0 -bottom-1",children:U.jsx("div",{className:"p-8 w-full bg-white",style:{clipPath:"polygon(93% 0, 0% 0%, 0% 100%, 100% 100%)",width:"58vw"}})})]}),U.jsx("div",{className:"flex items-center justify-center",children:U.jsxs("div",{className:"relative w-96 h-16 mt-9 border border-gray-200 shadow-md bg-white rounded-full",children:[U.jsx("input",{onChange:h,className:"absolute inset-0 m-3 ml-5 outline-none text-base",type:"text",placeholder:"Location..."}),U.jsx("button",{className:"absolute inset-y-0 right-0 w-14 h-5/6 mt-1 rounded-full bg-transparent border-none outline-none",type:"submit",name:"searchQuerySubmit",children:U.jsx("div",{className:"w-10 h-10 m-2 bg-orange-200 rounded-full flex items-center justify-center",children:U.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",children:U.jsx("path",{fill:"#ffff",d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})})})})]})}),U.jsx("div",{className:"mt-8 h-0.5  w-full   bg-gray-100"}),U.jsxs("div",{className:"h-full",children:[U.jsx("div",{className:"grid grid-cols-4 left-0 h-4/5 ml-7",children:a&&U.jsx("div",{className:"mt-8 mb-10",style:{border:"3px solid red"},children:U.jsx(j2,{deleteEvent:()=>c(a.id),event:a,loadJoinedEvents:u,joinedEvents:e},a.id-800)})}),U.jsxs("div",{className:"grid grid-cols-4 left-0 h-4/5 ml-7 mb-28",children:[t&&console.log(t.id),r[0]&&r.map(m=>U.jsx(j2,{deleteEvent:()=>c(m.id),event:m,loadJoinedEvents:u,joinedEvents:e},m.id-800))]}),U.jsx("div",{className:"relative",children:U.jsx("button",{style:d,ref:p,id:"modal-btn",className:"fixed bottom-5 right-5 max-h-11/12 mb-4 mr-4 text-5xl bg-orange-200 hover:bg-orange-500 text-white font-bold py-6 px-8 rounded-full z-50",children:U.jsx("p",{className:"text-center max-h-full",children:"+"})})})]})]})}function PUe(){return U.jsx(U.Fragment,{children:U.jsx("h1",{children:"Not Found"})})}const l4="/api",TUe=async()=>{const[t]=await Lr(`${l4}/me`);return t},RUe=async({username:t,password:e})=>Lr(`${l4}/login`,rg({username:t,password:e})),kUe=async()=>(await Lr(`${l4}/logout`,Z0),!0);var fie={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Oq=Ho.createContext&&Ho.createContext(fie),DUe=["attr","size","title"];function IUe(t,e){if(t==null)return{};var i=LUe(t,e),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function LUe(t,e){if(t==null)return{};var i={},r=Object.keys(t),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(i[n]=t[n]);return i}function W2(){return W2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},W2.apply(this,arguments)}function Uq(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function q2(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?Uq(Object(i),!0).forEach(function(r){BUe(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Uq(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function BUe(t,e,i){return e=OUe(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function OUe(t){var e=UUe(t,"string");return typeof e=="symbol"?e:String(e)}function UUe(t,e){if(typeof t!="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mie(t){return t&&t.map((e,i)=>Ho.createElement(e.tag,q2({key:i},e.attr),mie(e.child)))}function $0(t){return e=>Ho.createElement(NUe,W2({attr:q2({},t.attr)},e),mie(t.child))}function NUe(t){var e=i=>{var{attr:r,size:n,title:s}=t,o=IUe(t,DUe),a=n||i.size||"1em",l;return i.className&&(l=i.className),t.className&&(l=(l?l+" ":"")+t.className),Ho.createElement("svg",W2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,r,o,{className:l,style:q2(q2({color:t.color||i.color},i.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&Ho.createElement("title",null,s),t.children)};return Oq!==void 0?Ho.createElement(Oq.Consumer,null,i=>e(i)):e(fie)}function FUe(t){return $0({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M255.9 456c31.1 0 48.1-22 48.1-53h-96.3c0 31 17 53 48.2 53zM412 352.2c-15.4-20.3-45.7-32.2-45.7-123.1 0-93.3-41.2-130.8-79.6-139.8-3.6-.9-6.2-2.1-6.2-5.9v-2.9c0-13.4-11-24.7-24.4-24.6-13.4-.2-24.4 11.2-24.4 24.6v2.9c0 3.7-2.6 5-6.2 5.9-38.5 9.1-79.6 46.5-79.6 139.8 0 90.9-30.3 102.7-45.7 123.1-9.9 13.1-.5 31.8 15.9 31.8h280.1c16.3 0 25.7-18.8 15.8-31.8z"},child:[]}]})(t)}function zUe({currentUser:t,setCurrentUser:e}){Op(),se.useState(t.username);const[i,r]=se.useState(t.profilePic),n=se.useRef(null),s=se.useRef(null);se.useEffect(()=>{const c=document.querySelector(".modal"),h=document.querySelector(".modal-wrap"),d=()=>{c.style.opacity=1,c.style.pointerEvents="auto",h.style.opacity=1,h.style.transform="scale(1)"},p=()=>{c.style.opacity=0,c.style.pointerEvents="none",h.style.opacity=0,h.style.transform="scale(0.6)"},f=n.current,m=s.current;return f&&f.addEventListener("click",d),m&&m.addEventListener("click",p),()=>{f&&f.removeEventListener("click",d),m&&m.removeEventListener("click",p)}},[]);const o=async c=>{try{console.log(c);const h=new FormData;h.append("file",c);const d=await fetch("/api/upload",{method:"POST",body:h});if(!d.ok)throw new Error(`HTTP error! Status: ${d.status}`);const p=await d.json();return console.log(p),p}catch(h){console.log(h)}},a=async c=>{if(c)try{(await fetch(`/api/delete/${c}`,{method:"DELETE"})).ok?console.log(`File ${c} deleted successfully.`):console.error(`Failed to delete file ${c}.`)}catch(h){console.error("Error deleting file:",h)}},l=async c=>{c.preventDefault();const h=new FormData(c.target),d=await HOe(Object.fromEntries(h));return e(d),c.target.reset(),window.location.reload()},u=async c=>{c.preventDefault();const h=t.profile_pic;if(h&&a(h),i!==null){const d=await o(i),p=await VOe({id:t.id,profile_pic:d});e(p[0]),c.target.reset()}};return U.jsxs(U.Fragment,{children:[U.jsx("div",{class:"modal",style:{zIndex:"99999999999"},children:U.jsxs("div",{class:"modal-wrap",children:[U.jsx("button",{className:" px-3 h-8 bg-blue-300 ml-2 rounded-md mt-2 text-white",ref:s,id:"close-btn",children:" X "}),U.jsx("h1",{className:"text-xl font-bold text-center mb-10",children:"Upload Profile Picture"}),U.jsx("label",{htmlFor:"profilePic",className:"inline-block cursor-pointer hover:bg-blue-200 text-white font-semibold py-2 px-4 transition duration-200 ease-in-out",children:U.jsx("img",{src:"https://www.pngplay.com/wp-content/uploads/8/Upload-Icon-Logo-PNG-Photos.png",alt:"Profile",className:"inline-block cursor-pointer py-2 px-8 transition duration-200 ease-in-out"})}),U.jsx("div",{className:"w-full flex justify-center items-center",children:U.jsx("button",{className:"flex w-3/4 mt-12 justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #93C5FD, #2563EB)",boxShadow:"-5px 5px 10px rgba(147, 197, 253, 0.5), 5px -5px 10px rgba(37, 99, 235, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Upload"})})]})}),U.jsxs("div",{className:"info w-56",children:[U.jsxs("form",{className:"flex flex-col w-56 space-y-2",onSubmit:l,"aria-labelledby":"update-heading",children:[U.jsx("h2",{className:"mb-2 text-2xl font-bold",id:"update-heading",children:"Update Username"}),U.jsx("label",{htmlFor:"username",children:"New Username"}),U.jsx("input",{className:"w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-red-600 sm:text-sm sm:leading-6",type:"text",id:"username",name:"username"}),U.jsx("input",{className:"h-18",type:"hidden",name:"id",value:t.id}),U.jsx("button",{className:"flex w-full mt-2 justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600 mt-5",style:{borderRadius:"5px",background:"linear-gradient(225deg, #93C5FD, #2563EB)",boxShadow:"-5px 5px 10px rgba(147, 197, 253, 0.5), 5px -5px 10px rgba(37, 99, 235, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Update Username"})]}),U.jsxs("form",{onSubmit:u,className:"flex flex-col w-56 space-y-2",children:[U.jsx("h1",{className:"mt-8 mb-2 text-2xl w-80 font-bold",children:" Update Profile Picture "}),U.jsx("input",{type:"file",id:"profilePic",name:"profilePic",className:"hidden",onChange:c=>r(c.target.files[0])})]}),U.jsx("button",{ref:n,id:"modal-btn",className:"flex w-full mt-2 justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #93C5FD, #2563EB)",boxShadow:"-5px 5px 10px rgba(147, 197, 253, 0.5), 5px -5px 10px rgba(37, 99, 235, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Update profile picture"})]})]})}function HUe(){const t=Op(),{currentUser:e,setCurrentUser:i}=se.useContext(Yo),{userProfile:r,setUserProfile:n,events:s,setUserEvents:o,errorText:a,setErrorText:l}=SUe(B=>B),[u,c]=se.useState([]),[h,d]=se.useState(!1),[p,f]=se.useState(!1),[m,g]=se.useState({}),[y,v]=se.useState([]),{id:b}=yF(),_=e&&e.id===Number(b),[A,S]=se.useState("events"),[E,M]=se.useState("profile");se.useEffect(()=>{const B=async()=>{const[j,V]=await zOe(b);if(V)return l(V.message);n(j),_&&T(e.id)};o(b),B()},[b]),se.useEffect(()=>{(async()=>{const j=await jOe(b);c(j)})()},[]);const R=()=>{kUe(),i(null),t("/")},C=()=>{i(null),t("/"),GOe({id:b})},T=async()=>{if(e){const B=await n4(e.id);v(B);const j={};B.forEach(V=>{j[V.id]=!0}),g(j)}};if(!r&&!a)return null;if(a)return U.jsx("p",{children:a});const L=_?e.username:r.username,I=B=>{QP({event_id:B}),o(b)},D=async B=>{WOe(B)},F=_?e.profile_pic:r.profile_pic;return console.log(s),U.jsxs(U.Fragment,{children:[U.jsx(a_,{currentUser:e}),U.jsx("div",{className:"h-[287px] bg-center bg-no-repeat bg-cover relative bg-blue-300",children:U.jsx("div",{className:"profile flex flex-row absolute bottom-0 left-0 px-52",children:U.jsxs("div",{className:"max-w-48 max-h-48 flex justify-center items-center",children:[U.jsx("img",{className:"rounded-t-lg",src:`../upload/${F||"default.jpg"}`,width:"full",height:"full"}),U.jsx("div",{className:"flex font-bold text-white bg-slate-700 items-center justify-center h-12 -ml-8 p-12",children:U.jsx("h1",{className:"inline-block text-5xl font-semibold",children:L})})]})})}),U.jsxs("div",{className:"flex flex-row items-center justify-center space-x-14 bg-white font-medium text-gray-500 text-2xl",children:[U.jsx("div",{className:`events ${A==="events"?"bg-blue-200 p-5":""}`,children:U.jsx("button",{className:`w-20 h-10 flex items-center justify-center ${A==="events"?"text-blue-600 font-semibold":"text-gray-500"}`,onClick:()=>S("events"),children:"Events"})}),U.jsx("div",{className:`management ${A==="management"?"bg-blue-200 p-5":""}`,children:U.jsx("button",{className:`h-10 flex items-center justify-center ${A==="management"?"text-blue-600 font-semibold":"text-gray-500"}`,onClick:()=>S("management"),children:"Management"})})]}),A==="events"&&U.jsx(H,{}),A==="management"&&U.jsx(z,{})]});function H(){return U.jsxs("div",{className:"mb-12 max-h-full pb-32 h-screen font-bold px-52",children:[s[0]&&U.jsx("p",{className:"font-bold mt-7 mb-7",style:{fontSize:"42px"},children:"My Events"}),U.jsx("div",{className:"grid grid-cols-3",children:s[0]&&s.map(B=>U.jsx(j2,{deleteEvent:()=>I(B.id),event:B,loadJoinedEvents:T,joinedEvents:m},B.id-800))}),U.jsxs("div",{className:"",children:[y&&U.jsx("p",{className:"",style:{fontSize:"42px"},children:"Joined Events"}),U.jsx("div",{className:"grid grid-cols-3",children:y.length>0?y.map(B=>U.jsx(j2,{event:B,loadJoinedEvents:T,joinedEvents:m},B.id-800)):U.jsxs("div",{className:"max-w-xs relative flex",children:[U.jsx("p",{className:"s",children:"No joined events :["})," "]})})]})]})}function z(){return U.jsxs("div",{className:"mb-12 max-h-full pb-32 px-52",children:[U.jsx("h1",{className:"font-bold mt-7 mb-7",style:{fontSize:"42px"},children:"Management"}),U.jsxs("div",{className:"grid grid-cols-2 gap-4 w-80 w-44 text-xl",children:[U.jsxs("div",{className:"bg-blue-300 h-56 font-semibold text-gray-800",children:[U.jsxs("div",{className:"profile flex flex-row",onClick:()=>M("profile"),children:[U.jsx("div",{className:"border-r-4 border-blue-600 max-h-full"}),U.jsx("p",{className:"p-2 cursor-pointer",children:" Profile "})]}),U.jsxs("div",{className:"notifications flex flex-row",onClick:()=>M("notifications"),children:[U.jsx("div",{className:"border-r-4 border-blue-500 max-h-full"}),U.jsx("p",{className:"p-2 cursor-pointer",children:" Notification "})]})]}),E==="profile"&&U.jsxs("div",{children:[_&&U.jsx(zUe,{currentUser:e,setCurrentUser:i}),U.jsxs("div",{className:"w-full mt-5",children:[_&&U.jsx("button",{onClick:R,children:"Log Out"}),_&&U.jsx("button",{onClick:C,children:"Delete Account"})]})]}),E==="notifications"&&U.jsxs("div",{className:"",children:[_&&U.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[U.jsx(FUe,{size:35,onClick:async()=>{d(!h),f(!0),await D(b)}}),u.length>0&&!p&&U.jsx("div",{style:{position:"absolute",top:"5%",right:"5px",width:"12px",height:"12px",backgroundColor:"red",borderRadius:"50%"}})]}),_&&U.jsxs("h2",{children:["Notifications : ",u.length]}),h&&u.map((B,j)=>U.jsx("p",{children:B.text},j))]})]})]})}}const gie="/assets/SammyPhoto-af139241.png",yie="/assets/MarvPhoto-df0157f8.png",vie="/assets/MarcyPhoto-fdb7e26b.png";function GUe(){const{currentUser:t}=se.useContext(Yo);return U.jsxs("div",{className:"Site",children:[U.jsxs("header",{className:"Site-header",children:[U.jsx("h1",{children:"Welcome to HealthSync"}),U.jsx("h2",{children:"Mission Statement"}),U.jsx("p",{children:"At HealthSync, our mission is to empower individuals in Brooklyn on their fitness journey by fostering a community-driven platform focused on exercise events, education, and personal growth."}),t?U.jsxs(U.Fragment,{children:[U.jsx(AM,{to:"/community",className:"Site-link",children:"Community Page"}),U.jsx(AM,{to:`/users/${t.id}`,className:"Site-link",style:{marginLeft:"10px"},children:"Create Event"})]}):U.jsx(AM,{to:"/sign-up",className:"Site-link",children:"Sign Up"})]}),U.jsxs("div",{className:"bubbles-container",children:[U.jsxs("div",{className:"text-bubble",children:[U.jsx("h3",{children:"The Problem"}),U.jsx("p",{children:"Brooklyn battles obesity rates higher than many NYC areas, a challenge HealthSync is eager to address. We understand the unique hurdles Brooklynites face in achieving wellness, notably the absence of community support and motivation essential for starting and maintaining fitness journeys. Many residents find it challenging to access reliable information that aligns with their lifestyle, complicating efforts to manage weight, caloric intake, and regular exercise. HealthSync offers a solution: a platform that brings together community support, tailored information, and motivation to help you embark on your fitness journey with confidence."})]}),U.jsxs("div",{className:"text-bubble",children:[U.jsx("h3",{children:"Overview"}),U.jsx("p",{children:"HealthSync is a vibrant platform where Brooklyn's community comes together to create, explore, and participate in local exercise events. It simplifies finding and joining activities with comprehensive event detailslocation, time, and typeenhanced by a smart tagging system for easy navigation. Perfect for beginners seeking to jumpstart their fitness journey, HealthSync also features an educational page rich with exercises filtered by type, equipment needs, ensuring tailored workout recommendations. Plus, a note-taking and journaling section allows users to track their progress and experiences. Dive into HealthSync to connect, stay motivated, and find everything you need for your wellness journey in one place."})]}),U.jsxs("div",{className:"text-bubble",children:[U.jsx("h3",{children:"Who We Serve"}),U.jsx("p",{children:"Our service is tailored for individuals in Brooklyn who are new to fitness, particularly those with little to no prior exercise experience or knowledge, offering a nurturing community, easy-to-follow guidance, and accessible resources to confidently embark on their fitness journey."})]})]}),U.jsxs("div",{className:"founders-section",children:[U.jsx("h2",{children:"Founders"}),U.jsxs("div",{className:"founders-container",children:[U.jsxs("div",{className:"founder",children:[U.jsx("img",{src:gie,alt:"Sammy"}),U.jsx("p",{children:U.jsx("a",{href:"https://www.linkedin.com/in/samuel-pickering-1a0913288/",target:"_blank",rel:"noopener noreferrer",className:"founder-link",children:"Samuel Pickering"})})]}),U.jsxs("div",{className:"founder",children:[U.jsx("img",{src:"/path-to-founder2-image.jpg",alt:"Kory the Allegory"}),U.jsx("p",{children:U.jsx("a",{href:"https://www.linkedin.com/in/kory-telesford-039467177/",target:"_blank",rel:"noopener noreferrer",className:"founder-link",children:"Kory Telesford"})})]}),U.jsxs("div",{className:"founder",children:[U.jsx("img",{src:vie,alt:"Aj"}),U.jsx("p",{children:U.jsx("a",{href:"https://www.linkedin.com/in/ajenebartonfullstack/",target:"_blank",rel:"noopener noreferrer",className:"founder-link",children:"Ajene Barton"})})]}),U.jsxs("div",{className:"founder",children:[U.jsx("img",{src:yie,alt:"Hey Siri"}),U.jsx("p",{children:U.jsx("a",{href:"https://www.linkedin.com/in/marvin-siri/",target:"_blank",rel:"noopener noreferrer",className:"founder-link",children:"Marvin Siri"})})]})]})]})]})}const VUe=()=>{const[t,e]=se.useState("management"),i=()=>{const n=Op(),{currentUser:s,setCurrentUser:o}=se.useContext(Yo),a=Bq(c=>c.errorText),l=Bq(c=>c.setErrorText),u=async c=>{c.preventDefault(),l("");const h=new FormData(c.target),[d,p]=await RUe(Object.fromEntries(h));if(p)return l(p.message);o(d),n("/about"),console.log(Object.fromEntries(h))};return U.jsxs("div",{children:[U.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-sm",children:U.jsx("h2",{className:"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900",children:"Sign in to your account"})}),U.jsxs("div",{className:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm",children:[U.jsxs("form",{onSubmit:u,"aria-labelledby":"login-heading",className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Username"}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("div",{className:"flex items-center justify-between",children:U.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Password"})}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),U.jsx("div",{children:U.jsx("button",{className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #ff3126, #c30a00)",boxShadow:"-5px 5px 10px rgba(195, 10, 0, 0.5), 5px -5px 10px rgba(255, 49, 38, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Sign in"})})]}),!!a&&U.jsx("p",{children:a}),U.jsxs("p",{className:"mt-10 text-center text-sm text-gray-500",children:["Not a part of the crew?"," ",U.jsx("a",{href:"#",onClick:()=>e("events"),className:"font-semibold leading-6 text-red-500 hover:text-red-200",children:"Join Us!"})]})]})]})};function r(){const n=Op(),{currentUser:s,setCurrentUser:o}=se.useContext(Yo),[a,l]=se.useState(""),[u,c]=se.useState(""),[h,d]=se.useState(""),[p,f]=se.useState(""),[m,g]=se.useState("");if(s)return U.jsx(Vhe,{to:"/"});const y=async b=>{if(b.preventDefault(),l(""),!u||!h)return l("Missing username or password");if(!p||!h)return l("Missing name");if(!m)return l("Missing email");const[_,A]=await FOe({username:u,password:h,fullName:p,email:m});if(console.log(_),A)return l(A.message);o(_),n("/about")},v=b=>{const{name:_,value:A}=b.target;_==="username"&&c(A),_==="password"&&d(A),_==="name"&&f(A),_==="email"&&g(A)};return U.jsxs("div",{children:[U.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-sm",children:U.jsx("h2",{className:"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900",children:"Sign Up"})}),U.jsxs("div",{className:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm",children:[U.jsxs("form",{onSubmit:y,onChange:v,"aria-labelledby":"create-heading",className:"space-y-6",children:[U.jsxs("div",{children:[U.jsx("label",{htmlFor:"email",className:"block text-sm font-medium leading-6 text-gray-900",children:"Username"}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"username",name:"username",type:"text",onChange:v,value:u,required:!0,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("div",{className:"flex items-center justify-between",children:U.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Password"})}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"password",name:"password",type:"password",required:!0,onChange:v,value:h,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("div",{className:"flex items-center justify-between",children:U.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Name"})}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"name",name:"name",type:"name",required:!0,onChange:v,value:p,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-red-600 sm:text-sm sm:leading-6"})})]}),U.jsxs("div",{children:[U.jsx("div",{className:"flex items-center justify-between",children:U.jsx("label",{htmlFor:"password",className:"block text-sm font-medium leading-6 text-gray-900",children:"Email"})}),U.jsx("div",{className:"mt-2",children:U.jsx("input",{id:"email",name:"email",type:"email",required:!0,onChange:v,value:m,className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-red-600 sm:text-sm sm:leading-6"})})]}),U.jsx("div",{children:U.jsx("button",{className:"flex w-full justify-center rounded-md bg-red-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #ff3126, #c30a00)",boxShadow:"-5px 5px 10px rgba(195, 10, 0, 0.5), 5px -5px 10px rgba(255, 49, 38, 0.5)",transition:"boxShadow 0.3s ease-in-out"},children:"Sign Up"})})]}),!!a&&U.jsx("p",{children:a}),U.jsxs("p",{className:"mt-10 text-center text-sm text-gray-500",children:["Already In?"," ",U.jsx("a",{href:"#",onClick:()=>e("management"),className:"font-semibold leading-6 text-red-500 hover:text-red-200",children:"Log Back In!"})]})]})]})}return U.jsxs("div",{className:"flex min-h-full flex-1 flex-col justify-center px-6 py-12 md:py-8 lg:px-8",children:[t==="events"&&U.jsx(r,{}),t==="management"&&U.jsx(i,{})]})},jUe=()=>{const{currentUser:t}=se.useContext(Yo),[e,i]=se.useState(!1);se.useState("events"),se.useEffect(()=>{localStorage.getItem("visitedBefore")?i(!0):localStorage.setItem("visitedBefore","true")},[]);const r=se.useRef();(()=>{const b=setTimeout(()=>{r.current.classList.add("fade-out"),document.querySelector(".move-me").classList.add("move-me-start")},1e3);return()=>clearTimeout(b)})();const s=()=>{r.current.classList.add("fade-out"),document.querySelector(".move-me").classList.add("move-me-start")},[o,a]=se.useState(!1);se.useEffect(()=>{o&&(console.log("Animation completed!"),r.current.classList.add("hidden"))},[o]);const l=()=>{a(!0)},u=se.useRef(null),c=se.useRef(null);se.useEffect(()=>{const b=document.querySelector(".modal"),_=document.querySelector(".modal-wrap"),A=()=>{b.style.opacity=1,b.style.pointerEvents="auto",_.style.opacity=1,_.style.transform="scale(1)"},S=()=>{b.style.opacity=0,b.style.pointerEvents="none",_.style.opacity=0,_.style.transform="scale(0.6)"},E=u.current,M=c.current;return E&&E.addEventListener("click",A),M&&M.addEventListener("click",S),()=>{E&&E.removeEventListener("click",A),M&&M.removeEventListener("click",S)}},[]);const h=["Welcome to Health Sync!","Stay healthy and synced!","Your health, our priority!"],[d,p]=se.useState("");se.useEffect(()=>{const b=Math.floor(Math.random()*h.length);p(h[b]);const _=setInterval(()=>{const A=(b+1)%h.length;p(h[A])},5e3);return()=>{clearInterval(_)}},[]);const f=["You came back! Im proud of you!","Another work out?","Youre doing amazing, keep going!"],[m,g]=se.useState("");se.useEffect(()=>{const b=Math.floor(Math.random()*f.length);g(f[b]);const _=setInterval(()=>{const A=(b+1)%f.length;g(f[A])},5e3);return()=>{clearInterval(_)}},[]);const y=Op(),v=()=>{y("/about")};return U.jsxs("div",{className:"p-0",children:[U.jsx("div",{className:"section full-height",children:U.jsx("div",{className:"modal",children:U.jsxs("div",{className:"modal-wrap",children:[U.jsxs("button",{className:" px-3 h-8 bg-red-300 ml-2 rounded-md mt-2 text-white",ref:c,id:"close-btn",children:[" ","X"," "]}),U.jsx(VUe,{})]})})}),U.jsx("div",{className:"move-me",children:U.jsx("img",{src:WO,alt:"Girl in a jacket",width:"140",height:"140"})}),U.jsx("div",{className:"black",id:"black-div",onTransitionEnd:l,ref:r,onClick:s,children:" "}),U.jsxs("div",{className:"relative flex flex-col items-center justify-center h-screen",children:[U.jsx(JP,{scene:"https://prod.spline.design/JvPhrjIbn8g8tMx1/scene.splinecode"}),U.jsxs("div",{className:"absolute top-3/4 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center justify-center",children:[e?U.jsx("h2",{className:"text-xl z-10 font-semibold",children:m}):U.jsx("h2",{className:"text-2xl z-10",children:d}),t?U.jsx("div",{className:"flex items-center justify-center text-white w-36 z-10 mt-5",children:U.jsxs("button",{onClick:v,className:"button w-full h-12 font-bold",children:["Jump Back In"," "]})}):U.jsx("div",{className:"flex items-center justify-center text-white w-36 z-10 mt-5",children:U.jsx("button",{ref:u,id:"modal-btn",className:"button w-full h-12 font-bold",children:"Join Us"})})]})]})]})};class WUe{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const i of this._parts)e.push(i);return qUe(e).buffer}}function qUe(t){let e=0;for(const n of t)e+=n.byteLength;const i=new Uint8Array(e);let r=0;for(const n of t){const s=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);i.set(s,r),r+=n.byteLength}return i}function bie(t){return new XUe(t).unpack()}function xie(t){const e=new YUe,i=e.pack(t);return i instanceof Promise?i.then(()=>e.getBuffer()):e.getBuffer()}class XUe{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let i;if((i=e^160)<=15)return this.unpack_raw(i);if((i=e^176)<=15)return this.unpack_string(i);if((i=e^144)<=15)return this.unpack_array(i);if((i=e^128)<=15)return this.unpack_map(i);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return i=this.unpack_uint16(),this.unpack_string(i);case 217:return i=this.unpack_uint32(),this.unpack_string(i);case 218:return i=this.unpack_uint16(),this.unpack_raw(i);case 219:return i=this.unpack_uint32(),this.unpack_raw(i);case 220:return i=this.unpack_uint16(),this.unpack_array(i);case 221:return i=this.unpack_uint32(),this.unpack_array(i);case 222:return i=this.unpack_uint16(),this.unpack_map(i);case 223:return i=this.unpack_uint32(),this.unpack_map(i)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),i=(e[0]&255)*256+(e[1]&255);return this.index+=2,i}unpack_uint32(){const e=this.read(4),i=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,i}unpack_uint64(){const e=this.read(8),i=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,i}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const i=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,i}unpack_string(e){const i=this.read(e);let r=0,n="",s,o;for(;r<e;)s=i[r],s<160?(o=s,r++):(s^192)<32?(o=(s&31)<<6|i[r+1]&63,r+=2):(s^224)<16?(o=(s&15)<<12|(i[r+1]&63)<<6|i[r+2]&63,r+=3):(o=(s&7)<<18|(i[r+1]&63)<<12|(i[r+2]&63)<<6|i[r+3]&63,r+=4),n+=String.fromCodePoint(o);return this.index+=e,n}unpack_array(e){const i=new Array(e);for(let r=0;r<e;r++)i[r]=this.unpack();return i}unpack_map(e){const i={};for(let r=0;r<e;r++){const n=this.unpack();i[n]=this.unpack()}return i}unpack_float(){const e=this.unpack_uint32(),i=e>>31,r=(e>>23&255)-127,n=e&8388607|8388608;return(i===0?1:-1)*n*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),i=this.unpack_uint32(),r=e>>31,n=(e>>20&2047)-1023,o=(e&1048575|1048576)*2**(n-20)+i*2**(n-52);return(r===0?1:-1)*o}read(e){const i=this.index;if(i+e<=this.length)return this.dataView.subarray(i,i+e);throw new Error("BinaryPackFailure: read index out of range")}}class YUe{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const i=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(i==Object||i.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${i.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const i=e.length;if(i<=15)this.pack_uint8(160+i);else if(i<=65535)this._bufferBuilder.append(218),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const i=this._textEncoder.encode(e),r=i.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(i)}pack_array(e){const i=e.length;if(i<=15)this.pack_uint8(144+i);else if(i<=65535)this._bufferBuilder.append(220),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(i);else throw new Error("Invalid length");const r=n=>{if(n<i){const s=this.pack(e[n]);return s instanceof Promise?s.then(()=>r(n+1)):r(n+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let i=0;e<0&&(i=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),n=e/2**r-1,s=Math.floor(n*2**52),o=2**32,a=i<<31|r+1023<<20|s/o&1048575,l=s%o;this._bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(l)}pack_object(e){const i=Object.keys(e),r=i.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const n=s=>{if(s<i.length){const o=i[s];if(e.hasOwnProperty(o)){this.pack(o);const a=this.pack(e[o]);if(a instanceof Promise)return a.then(()=>n(s+1))}return n(s+1)}};return n(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const i=e&4294967295;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_uint64(e){const i=e/4294967296,r=e%2**32;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const i=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new WUe,this._textEncoder=new TextEncoder}}let wie=!0,_ie=!0;function HM(t,e,i){const r=t.match(e);return r&&r.length>=i&&parseInt(r[i],10)}function sg(t,e,i){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,n=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return n.apply(this,arguments);const l=u=>{const c=i(u);c&&(a.handleEvent?a.handleEvent(c):a(c))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,l),n.apply(this,[o,l])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const l=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function KUe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(wie=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function JUe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(_ie=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Sie(){if(typeof window=="object"){if(wie)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function u4(t,e){_ie&&console.warn(t+" is deprecated, please use "+e+" instead.")}function QUe(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:i}=t;if(i.mozGetUserMedia)e.browser="firefox",e.version=HM(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=HM(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=HM(i.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Nq(t){return Object.prototype.toString.call(t)==="[object Object]"}function Aie(t){return Nq(t)?Object.keys(t).reduce(function(e,i){const r=Nq(t[i]),n=r?Aie(t[i]):t[i],s=r&&!Object.keys(n).length;return n===void 0||s?e:Object.assign(e,{[i]:n})},{}):t}function qO(t,e,i){!e||i.has(e.id)||(i.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?qO(t,t.get(e[r]),i):r.endsWith("Ids")&&e[r].forEach(n=>{qO(t,t.get(n),i)})}))}function Fq(t,e,i){const r=i?"outbound-rtp":"inbound-rtp",n=new Map;if(e===null)return n;const s=[];return t.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{t.forEach(a=>{a.type===r&&a.trackId===o.id&&qO(t,a,n)})}),n}const zq=Sie;function Eie(t,e){const i=t&&t.navigator;if(!i.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const l={};return Object.keys(a).forEach(u=>{if(u==="require"||u==="advanced"||u==="mediaSource")return;const c=typeof a[u]=="object"?a[u]:{ideal:a[u]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const h=function(d,p){return d?d+p.charAt(0).toUpperCase()+p.slice(1):p==="deviceId"?"sourceId":p};if(c.ideal!==void 0){l.optional=l.optional||[];let d={};typeof c.ideal=="number"?(d[h("min",u)]=c.ideal,l.optional.push(d),d={},d[h("max",u)]=c.ideal,l.optional.push(d)):(d[h("",u)]=c.ideal,l.optional.push(d))}c.exact!==void 0&&typeof c.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[h("",u)]=c.exact):["min","max"].forEach(d=>{c[d]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[h(d,u)]=c[d])})}),a.advanced&&(l.optional=(l.optional||[]).concat(a.advanced)),l},n=function(a,l){if(e.version>=61)return l(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const u=function(c,h,d){h in c&&!(d in c)&&(c[d]=c[h],delete c[h])};a=JSON.parse(JSON.stringify(a)),u(a.audio,"autoGainControl","googAutoGainControl"),u(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let u=a.video.facingMode;u=u&&(typeof u=="object"?u:{ideal:u});const c=e.version<66;if(u&&(u.exact==="user"||u.exact==="environment"||u.ideal==="user"||u.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete a.video.facingMode;let h;if(u.exact==="environment"||u.ideal==="environment"?h=["back","rear"]:(u.exact==="user"||u.ideal==="user")&&(h=["front"]),h)return i.mediaDevices.enumerateDevices().then(d=>{d=d.filter(f=>f.kind==="videoinput");let p=d.find(f=>h.some(m=>f.label.toLowerCase().includes(m)));return!p&&d.length&&h.includes("back")&&(p=d[d.length-1]),p&&(a.video.deviceId=u.exact?{exact:p.deviceId}:{ideal:p.deviceId}),a.video=r(a.video),zq("chrome: "+JSON.stringify(a)),l(a)})}a.video=r(a.video)}return zq("chrome: "+JSON.stringify(a)),l(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,l,u){n(a,c=>{i.webkitGetUserMedia(c,l,h=>{u&&u(s(h))})})};if(i.getUserMedia=o.bind(i),i.mediaDevices.getUserMedia){const a=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(l){return n(l,u=>a(u).then(c=>{if(u.audio&&!c.getAudioTracks().length||u.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(s(c))))}}}function ZUe(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(n=>{const s=r.video&&r.video.width,o=r.video&&r.video.height,a=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n,maxFrameRate:a||3}},s&&(r.video.mandatory.maxWidth=s),o&&(r.video.mandatory.maxHeight=o),t.navigator.mediaDevices.getUserMedia(r)})}}}function Mie(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function Cie(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",n=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===n.track.id):s={track:n.track};const o=new Event("track");o.track=n.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(n=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===n.id):s={track:n};const o=new Event("track");o.track=n,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else sg(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Pie(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(n,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=n.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:n}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,l){let u=n.apply(this,arguments);return u||(u=e(this,a),this._senders.push(u)),u};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const l=this._senders.indexOf(a);l!==-1&&this._senders.splice(l,1)}}const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(l=>l.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Tie(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[r,n,s]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const o=function(l){const u={};return l.result().forEach(h=>{const d={id:h.id,timestamp:h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[h.type]||h.type};h.names().forEach(p=>{d[p]=h.stat(p)}),u[d.id]=d}),u},a=function(l){return new Map(Object.keys(l).map(u=>[u,l[u]]))};if(arguments.length>=2){const l=function(u){n(a(o(u)))};return e.apply(this,[l,r])}return new Promise((l,u)=>{e.apply(this,[function(c){l(a(o(c)))},u])}).then(n,s)}}function Rie(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const i=t.RTCPeerConnection.prototype.getSenders;i&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=i.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>Fq(o,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const i=t.RTCPeerConnection.prototype.getReceivers;i&&(t.RTCPeerConnection.prototype.getReceivers=function(){const n=i.apply(this,[]);return n.forEach(s=>s._pc=this),n}),sg(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(s=>Fq(s,n.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let n,s,o;return this.getSenders().forEach(a=>{a.track===r&&(n?o=!0:n=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||n&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function kie(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(l)===-1&&this._shimmedLocalStreams[a.id].push(l):this._shimmedLocalStreams[a.id]=[a,l],l};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(u=>{if(this.getSenders().find(h=>h.track===u))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();i.apply(this,arguments);const l=this.getSenders().filter(u=>a.indexOf(u)===-1);this._shimmedLocalStreams[o.id]=[o].concat(l)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const n=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const l=this._shimmedLocalStreams[a].indexOf(o);l!==-1&&this._shimmedLocalStreams[a].splice(l,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),n.apply(this,arguments)}}function Die(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return kie(t);const i=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const c=i.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(h=>this._reverseStreams[h.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(h=>{if(this.getSenders().find(p=>p.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const h=new t.MediaStream(c.getTracks());this._streams[c.id]=h,this._reverseStreams[h.id]=c,c=h}r.apply(this,[c])};const n=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},t.RTCPeerConnection.prototype.addTrack=function(c,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(m=>m===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const f=this._streams[h.id];if(f)f.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new t.MediaStream([c]);this._streams[h.id]=m,this._reverseStreams[m.id]=h,this.addStream(m)}return this.getSenders().find(m=>m.track===c)};function s(u,c){let h=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(d=>{const p=u._reverseStreams[d],f=u._streams[p.id];h=h.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:h})}function o(u,c){let h=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(d=>{const p=u._reverseStreams[d],f=u._streams[p.id];h=h.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:c.type,sdp:h})}["createOffer","createAnswer"].forEach(function(u){const c=t.RTCPeerConnection.prototype[u],h={[u](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[f=>{const m=s(this,f);d[0].apply(null,[m])},f=>{d[1]&&d[1].apply(null,f)},arguments[2]]):c.apply(this,arguments).then(f=>s(this,f))}};t.RTCPeerConnection.prototype[u]=h[u]});const a=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const u=l.get.apply(this);return u.type===""?u:s(this,u)}}),t.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(p=>{this._streams[p].getTracks().find(m=>c.track===m)&&(d=this._streams[p])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function XO(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const r=t.RTCPeerConnection.prototype[i],n={[i](){return arguments[0]=new(i==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[i]=n[i]})}function Iie(t,e){sg(t,"negotiationneeded",i=>{const r=i.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return i})}const Hq=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Iie,shimAddTrackRemoveTrack:Die,shimAddTrackRemoveTrackWithNative:kie,shimGetDisplayMedia:ZUe,shimGetSendersWithDtmf:Pie,shimGetStats:Tie,shimGetUserMedia:Eie,shimMediaStream:Mie,shimOnTrack:Cie,shimPeerConnection:XO,shimSenderReceiverGetStats:Rie},Symbol.toStringTag,{value:"Module"}));function Lie(t,e){const i=t&&t.navigator,r=t&&t.MediaStreamTrack;if(i.getUserMedia=function(n,s,o){u4("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(n).then(s,o)},!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const n=function(o,a,l){a in o&&!(l in o)&&(o[l]=o[a],delete o[a])},s=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),n(o.audio,"autoGainControl","mozAutoGainControl"),n(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return n(a,"mozAutoGainControl","autoGainControl"),n(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),n(a,"autoGainControl","mozAutoGainControl"),n(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function $Ue(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function Bie(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function YO(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const s=t.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=o[n]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(l=>{if(e.version<53&&!o)try{l.forEach(u=>{u.type=i[u.type]||u.type})}catch(u){if(u.name!=="TypeError")throw u;l.forEach((c,h)=>{l.set(h,Object.assign({},c,{type:i[c.type]||c.type}))})}return l}).then(o,a)}}function Oie(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const n=e.apply(this,[]);return n.forEach(s=>s._pc=this),n});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const n=i.apply(this,arguments);return n._pc=this,n}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Uie(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(n=>n._pc=this),r}),sg(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Nie(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(i){u4("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&i.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Fie(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function zie(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const n=r.length>0;n&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(n){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function Hie(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Gie(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Vie(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Gq=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:zie,shimCreateAnswer:Vie,shimCreateOffer:Gie,shimGetDisplayMedia:$Ue,shimGetParameters:Hie,shimGetUserMedia:Lie,shimOnTrack:Bie,shimPeerConnection:YO,shimRTCDataChannel:Fie,shimReceiverGetStats:Uie,shimRemoveStream:Nie,shimSenderGetStats:Oie},Symbol.toStringTag,{value:"Module"}));function jie(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(n=>e.call(this,n,r)),r.getVideoTracks().forEach(n=>e.call(this,n,r))},t.RTCPeerConnection.prototype.addTrack=function(r,...n){return n&&n.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(i);if(r===-1)return;this._localStreams.splice(r,1);const n=i.getTracks();this.getSenders().forEach(s=>{n.includes(s.track)&&this.removeTrack(s)})})}}function Wie(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const s=new Event("addstream");s.stream=n,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function qie(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,i=e.createOffer,r=e.createAnswer,n=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(u,c){const h=arguments.length>=2?arguments[2]:arguments[0],d=i.apply(this,[h]);return c?(d.then(u,c),Promise.resolve()):d},e.createAnswer=function(u,c){const h=arguments.length>=2?arguments[2]:arguments[0],d=r.apply(this,[h]);return c?(d.then(u,c),Promise.resolve()):d};let a=function(l,u,c){const h=n.apply(this,[l]);return c?(h.then(u,c),Promise.resolve()):h};e.setLocalDescription=a,a=function(l,u,c){const h=s.apply(this,[l]);return c?(h.then(u,c),Promise.resolve()):h},e.setRemoteDescription=a,a=function(l,u,c){const h=o.apply(this,[l]);return c?(h.then(u,c),Promise.resolve()):h},e.addIceCandidate=a}function Xie(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const i=e.mediaDevices,r=i.getUserMedia.bind(i);e.mediaDevices.getUserMedia=n=>r(Yie(n))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,n,s){e.mediaDevices.getUserMedia(r).then(n,s)}).bind(e))}function Yie(t){return t&&t.video!==void 0?Object.assign({},t,{video:Aie(t.video)}):t}function Kie(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,n){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(u4("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,n)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Jie(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qie(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const n=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):r.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Zie(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const Vq=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Zie,shimCallbacksAPI:qie,shimConstraints:Yie,shimCreateOfferLegacy:Qie,shimGetUserMedia:Xie,shimLocalStreamsAPI:jie,shimRTCIceServerUrls:Kie,shimRemoteStreamsAPI:Wie,shimTrackEventTransceiver:Jie},Symbol.toStringTag,{value:"Module"}));var $ie={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(i){return i.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(i){return i.split(`
m=`).map((n,s)=>(s>0?"m="+n:n).trim()+`\r
`)},e.getDescription=function(i){const r=e.splitSections(i);return r&&r[0]},e.getMediaSections=function(i){const r=e.splitSections(i);return r.shift(),r},e.matchPrefix=function(i,r){return e.splitLines(i).filter(n=>n.indexOf(r)===0)},e.parseCandidate=function(i){let r;i.indexOf("a=candidate:")===0?r=i.substring(12).split(" "):r=i.substring(10).split(" ");const n={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":n.relatedAddress=r[s+1];break;case"rport":n.relatedPort=parseInt(r[s+1],10);break;case"tcptype":n.tcpType=r[s+1];break;case"ufrag":n.ufrag=r[s+1],n.usernameFragment=r[s+1];break;default:n[r[s]]===void 0&&(n[r[s]]=r[s+1]);break}return n},e.writeCandidate=function(i){const r=[];r.push(i.foundation);const n=i.component;n==="rtp"?r.push(1):n==="rtcp"?r.push(2):r.push(n),r.push(i.protocol.toUpperCase()),r.push(i.priority),r.push(i.address||i.ip),r.push(i.port);const s=i.type;return r.push("typ"),r.push(s),s!=="host"&&i.relatedAddress&&i.relatedPort&&(r.push("raddr"),r.push(i.relatedAddress),r.push("rport"),r.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(r.push("ufrag"),r.push(i.usernameFragment||i.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(i){return i.substring(14).split(" ")},e.parseRtpMap=function(i){let r=i.substring(9).split(" ");const n={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),n.name=r[0],n.clockRate=parseInt(r[1],10),n.channels=r.length===3?parseInt(r[2],10):1,n.numChannels=n.channels,n},e.writeRtpMap=function(i){let r=i.payloadType;i.preferredPayloadType!==void 0&&(r=i.preferredPayloadType);const n=i.channels||i.numChannels||1;return"a=rtpmap:"+r+" "+i.name+"/"+i.clockRate+(n!==1?"/"+n:"")+`\r
`},e.parseExtmap=function(i){const r=i.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},e.parseFmtp=function(i){const r={};let n;const s=i.substring(i.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)n=s[o].trim().split("="),r[n[0].trim()]=n[1];return r},e.writeFmtp=function(i){let r="",n=i.payloadType;if(i.preferredPayloadType!==void 0&&(n=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const s=[];Object.keys(i.parameters).forEach(o=>{i.parameters[o]!==void 0?s.push(o+"="+i.parameters[o]):s.push(o)}),r+="a=fmtp:"+n+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(i){const r=i.substring(i.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(i){let r="",n=i.payloadType;return i.preferredPayloadType!==void 0&&(n=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+n+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(i){const r=i.indexOf(" "),n={ssrc:parseInt(i.substring(7,r),10)},s=i.indexOf(":",r);return s>-1?(n.attribute=i.substring(r+1,s),n.value=i.substring(s+1)):n.attribute=i.substring(r+1),n},e.parseSsrcGroup=function(i){const r=i.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(n=>parseInt(n,10))}},e.getMid=function(i){const r=e.matchPrefix(i,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(i){const r=i.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(i,r){return{role:"auto",fingerprints:e.matchPrefix(i+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(i,r){let n="a=setup:"+r+`\r
`;return i.fingerprints.forEach(s=>{n+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),n},e.parseCryptoLine=function(i){const r=i.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?e.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const r=i.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},e.getCryptoParameters=function(i,r){return e.matchPrefix(i+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(i,r){const n=e.matchPrefix(i+r,"a=ice-ufrag:")[0],s=e.matchPrefix(i+r,"a=ice-pwd:")[0];return n&&s?{usernameFragment:n.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(i){let r="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(i){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(i)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const l=s[a],u=e.matchPrefix(i,"a=rtpmap:"+l+" ")[0];if(u){const c=e.parseRtpMap(u),h=e.matchPrefix(i,"a=fmtp:"+l+" ");switch(c.parameters=h.length?e.parseFmtp(h[0]):{},c.rtcpFeedback=e.matchPrefix(i,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(c.name.toUpperCase());break}}}e.matchPrefix(i,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(i,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(l=>{a.rtcpFeedback.find(c=>c.type===l.type&&c.parameter===l.parameter)||a.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(i,r){let n="";n+="m="+i+" ",n+=r.codecs.length>0?"9":"0",n+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,n+=`c=IN IP4 0.0.0.0\r
`,n+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{n+=e.writeRtpMap(o),n+=e.writeFmtp(o),n+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(n+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{n+=e.writeExtmap(o)}),n},e.parseRtpEncodingParameters=function(i){const r=[],n=e.parseRtpParameters(i),s=n.fecMechanisms.indexOf("RED")!==-1,o=n.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(i,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname"),l=a.length>0&&a[0].ssrc;let u;const c=e.matchPrefix(i,"a=ssrc-group:FID").map(d=>d.substring(17).split(" ").map(f=>parseInt(f,10)));c.length>0&&c[0].length>1&&c[0][0]===l&&(u=c[0][1]),n.codecs.forEach(d=>{if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){let p={ssrc:l,codecPayloadType:parseInt(d.parameters.apt,10)};l&&u&&(p.rtx={ssrc:u}),r.push(p),s&&(p=JSON.parse(JSON.stringify(p)),p.fec={ssrc:l,mechanism:o?"red+ulpfec":"red"},r.push(p))}}),r.length===0&&l&&r.push({ssrc:l});let h=e.matchPrefix(i,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,r.forEach(d=>{d.maxBitrate=h})),r},e.parseRtcpParameters=function(i){const r={},n=e.matchPrefix(i,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];n&&(r.cname=n.value,r.ssrc=n.ssrc);const s=e.matchPrefix(i,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(i,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(i){let r="";return i.reducedSize&&(r+=`a=rtcp-rsize\r
`),i.mux&&(r+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(r+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),r},e.parseMsid=function(i){let r;const n=e.matchPrefix(i,"a=msid:");if(n.length===1)return r=n[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(i,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(i){const r=e.parseMLine(i),n=e.matchPrefix(i,"a=max-message-size:");let s;n.length>0&&(s=parseInt(n[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(i,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(i,"a=sctpmap:");if(a.length>0){const l=a[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(i,r){let n=[];return i.protocol!=="DTLS/SCTP"?n=["m="+i.kind+" 9 "+i.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:n=["m="+i.kind+" 9 "+i.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&n.push("a=max-message-size:"+r.maxMessageSize+`\r
`),n.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(i,r,n){let s;const o=r!==void 0?r:2;return i?s=i:s=e.generateSessionId(),`v=0\r
o=`+(n||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(i,r){const n=e.splitLines(i);for(let s=0;s<n.length;s++)switch(n[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(i){return e.splitLines(i)[0].split(" ")[0].substring(2)},e.isRejected=function(i){return i.split(" ",2)[1]==="0"},e.parseMLine=function(i){const n=e.splitLines(i)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},e.parseOLine=function(i){const n=e.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},e.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const r=e.splitLines(i);for(let n=0;n<r.length;n++)if(r[n].length<2||r[n].charAt(1)!=="=")return!1;return!0},t.exports=e})($ie);var ere=$ie.exports;const Fv=F1(ere),eNe=HY({__proto__:null,default:Fv},[ere]);function GM(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const n=new e(r),s=Fv.parseCandidate(r.candidate);for(const o in s)o in n||Object.defineProperty(n,o,{value:s[o]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,sg(t,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new t.RTCIceCandidate(i.candidate),writable:"false"}),i))}function KO(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||sg(t,"icecandidate",e=>{if(e.candidate){const i=Fv.parseCandidate(e.candidate.candidate);i.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return e})}function VM(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(a){if(!a||!a.sdp)return!1;const l=Fv.splitSections(a.sdp);return l.shift(),l.some(u=>{const c=Fv.parseMLine(u);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},r=function(a){const l=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const u=parseInt(l[1],10);return u!==u?-1:u},n=function(a){let l=65536;return e.browser==="firefox"&&(e.version<57?a===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},s=function(a,l){let u=65536;e.browser==="firefox"&&e.version===57&&(u=65535);const c=Fv.matchPrefix(a.sdp,"a=max-message-size:");return c.length>0?u=parseInt(c[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(u=2147483637),u},o=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const l=r(arguments[0]),u=n(l),c=s(arguments[0],l);let h;u===0&&c===0?h=Number.POSITIVE_INFINITY:u===0||c===0?h=Math.max(u,c):h=Math.min(u,c);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return h}}),this._sctp=d}return o.apply(this,arguments)}}function jM(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,n){const s=r.send;r.send=function(){const a=arguments[0],l=a.length||a.size||a.byteLength;if(r.readyState==="open"&&n.sctp&&l>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const i=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const n=i.apply(this,arguments);return e(n,this),n},sg(t,"datachannel",r=>(e(r.channel,r.target),r))}function JO(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const r=e[i];e[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const s=n.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",n);s.dispatchEvent(o)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function QO(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const i=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=n.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&n instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:n.type,sdp:s}):n.sdp=s}return i.apply(this,arguments)}}function WM(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const i=t.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function qM(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const i=t.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return i.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?i.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>i.apply(this,[o]))})}const tNe=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:QO,shimAddIceCandidateNullOrEmpty:WM,shimConnectionState:JO,shimMaxMessageSize:VM,shimParameterlessSetLocalDescription:qM,shimRTCIceCandidate:GM,shimRTCIceCandidateRelayProtocol:KO,shimSendThrowTypeError:jM},Symbol.toStringTag,{value:"Module"}));function iNe({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=Sie,r=QUe(t),n={browserDetails:r,commonShim:tNe,extractVersion:HM,disableLog:KUe,disableWarnings:JUe,sdp:eNe};switch(r.browser){case"chrome":if(!Hq||!XO||!e.shimChrome)return i("Chrome shim is not included in this adapter release."),n;if(r.version===null)return i("Chrome shim can not determine version, not shimming."),n;i("adapter.js shimming chrome."),n.browserShim=Hq,WM(t,r),qM(t),Eie(t,r),Mie(t),XO(t,r),Cie(t),Die(t,r),Pie(t),Tie(t),Rie(t),Iie(t,r),GM(t),KO(t),JO(t),VM(t,r),jM(t),QO(t,r);break;case"firefox":if(!Gq||!YO||!e.shimFirefox)return i("Firefox shim is not included in this adapter release."),n;i("adapter.js shimming firefox."),n.browserShim=Gq,WM(t,r),qM(t),Lie(t,r),YO(t,r),Bie(t),Nie(t),Oie(t),Uie(t),Fie(t),zie(t),Hie(t),Gie(t),Vie(t),GM(t),JO(t),VM(t,r),jM(t);break;case"safari":if(!Vq||!e.shimSafari)return i("Safari shim is not included in this adapter release."),n;i("adapter.js shimming safari."),n.browserShim=Vq,WM(t,r),qM(t),Kie(t),Qie(t),qie(t),jie(t),Wie(t),Jie(t),Xie(t),Zie(t),GM(t),KO(t),VM(t,r),jM(t),QO(t,r);break;default:i("Unsupported browser!");break}return n}const jq=iNe({window:typeof window>"u"?void 0:window});let ZO;try{ZO=new TextDecoder}catch{}let Bt,bm,nt=0;const rNe=105,nNe=57342,sNe=57343,Wq=57337,qq=6,oy={};let Bi={},on,X2,Y2=0,p1=0,rs,mu,Wn=[],$O=[],da,Lo,Xx,Xq={useRecords:!1,mapsAsObjects:!0},f1=!1,tre=2;try{new Function("")}catch{tre=1/0}let ire=class eU{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[i,r]of Object.entries(e.keyMap))this.mapKey.set(r,i)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let i=new Map;for(let[r,n]of Object.entries(e))i.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,n);return i}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,n]of Object.entries(this._keyMap))this._mapKey.set(n,r)}let i={};return e.forEach((r,n)=>i[Ml(this._mapKey.has(n)?this._mapKey.get(n):n)]=r),i}mapDecode(e,i){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(n=>this.decodeKeys(n))}return r}decode(e,i){if(Bt)return ore(()=>(nU(),this?this.decode(e,i):eU.prototype.decode.call(Xq,e,i)));bm=i>-1?i:e.length,nt=0,p1=0,X2=null,rs=null,Bt=e;try{Lo=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw Bt=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof eU){if(Bi=this,da=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return on=this.structures,lE();(!on||on.length>0)&&(on=[])}else Bi=Xq,(!on||on.length>0)&&(on=[]),da=null;return lE()}decodeMultiple(e,i){let r,n=0;try{let s=e.length;f1=!0;let o=this?this.decode(e,s):d4.decode(e,s);if(i){if(i(o)===!1)return;for(;nt<s;)if(n=nt,i(lE())===!1)return}else{for(r=[o];nt<s;)n=nt,r.push(lE());return r}}catch(s){throw s.lastPosition=n,s.values=r,s}finally{f1=!1,nU()}}};function lE(){try{let t=Ii();if(rs){if(nt>=rs.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}nt=rs.postBundlePosition,rs=null}if(nt==bm)on=null,Bt=null,mu&&(mu=null);else if(nt>bm){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!f1)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw nU(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function Ii(){let t=Bt[nt++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=Bt[nt++];break;case 25:if(e==7)return uNe();t=Lo.getUint16(nt),nt+=2;break;case 26:if(e==7){let i=Lo.getFloat32(nt);if(Bi.useFloat32>2){let r=c4[(Bt[nt]&127)<<1|Bt[nt+1]>>7];return nt+=4,(r*i+(i>0?.5:-.5)>>0)/r}return nt+=4,i}t=Lo.getUint32(nt),nt+=4;break;case 27:if(e==7){let i=Lo.getFloat64(nt);return nt+=8,i}if(e>1){if(Lo.getUint32(nt)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Lo.getUint32(nt+4)}else Bi.int64AsNumber?(t=Lo.getUint32(nt)*4294967296,t+=Lo.getUint32(nt+4)):t=Lo.getBigUint64(nt);nt+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let i=[],r,n=0;for(;(r=Ii())!=oy;)i[n++]=r;return e==4?i:e==3?i.join(""):Buffer.concat(i);case 5:let s;if(Bi.mapsAsObjects){let o={};if(Bi.keyMap)for(;(s=Ii())!=oy;)o[Ml(Bi.decodeKey(s))]=Ii();else for(;(s=Ii())!=oy;)o[Ml(s)]=Ii();return o}else{Xx&&(Bi.mapsAsObjects=!0,Xx=!1);let o=new Map;if(Bi.keyMap)for(;(s=Ii())!=oy;)o.set(Bi.decodeKey(s),Ii());else for(;(s=Ii())!=oy;)o.set(s,Ii());return o}case 7:return oy;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return lNe(t);case 3:if(p1>=nt)return X2.slice(nt-Y2,(nt+=t)-Y2);if(p1==0&&bm<140&&t<32){let n=t<16?rre(t):aNe(t);if(n!=null)return n}return oNe(t);case 4:let i=new Array(t);for(let n=0;n<t;n++)i[n]=Ii();return i;case 5:if(Bi.mapsAsObjects){let n={};if(Bi.keyMap)for(let s=0;s<t;s++)n[Ml(Bi.decodeKey(Ii()))]=Ii();else for(let s=0;s<t;s++)n[Ml(Ii())]=Ii();return n}else{Xx&&(Bi.mapsAsObjects=!0,Xx=!1);let n=new Map;if(Bi.keyMap)for(let s=0;s<t;s++)n.set(Bi.decodeKey(Ii()),Ii());else for(let s=0;s<t;s++)n.set(Ii(),Ii());return n}case 6:if(t>=Wq){let n=on[t&8191];if(n)return n.read||(n.read=tU(n)),n.read();if(t<65536){if(t==sNe){let s=cv(),o=Ii(),a=Ii();rU(o,a);let l={};if(Bi.keyMap)for(let u=2;u<s;u++){let c=Bi.decodeKey(a[u-2]);l[Ml(c)]=Ii()}else for(let u=2;u<s;u++){let c=a[u-2];l[Ml(c)]=Ii()}return l}else if(t==nNe){let s=cv(),o=Ii();for(let a=2;a<s;a++)rU(o++,Ii());return Ii()}else if(t==Wq)return mNe();if(Bi.getShared&&(h4(),n=on[t&8191],n))return n.read||(n.read=tU(n)),n.read()}}let r=Wn[t];if(r)return r.handlesRead?r(Ii):r(Ii());{let n=Ii();for(let s=0;s<$O.length;s++){let o=$O[s](t,n);if(o!==void 0)return o}return new zm(n,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let n=(da||Bf())[t];if(n!==void 0)return n;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let n=new Error("Unexpected end of CBOR data");throw n.incomplete=!0,n}throw new Error("Unknown CBOR token "+t)}}const Yq=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function tU(t){function e(){let i=Bt[nt++];if(i=i&31,i>23)switch(i){case 24:i=Bt[nt++];break;case 25:i=Lo.getUint16(nt),nt+=2;break;case 26:i=Lo.getUint32(nt),nt+=4;break;default:throw new Error("Expected array header, but got "+Bt[nt-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===i)return r(Ii);r=r.next}if(this.slowReads++>=tre){let s=this.length==i?this:this.slice(0,i);return r=Bi.keyMap?new Function("r","return {"+s.map(o=>Bi.decodeKey(o)).map(o=>Yq.test(o)?Ml(o)+":r()":"["+JSON.stringify(o)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(o=>Yq.test(o)?Ml(o)+":r()":"["+JSON.stringify(o)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=i,this.compiledReader=r,r(Ii)}let n={};if(Bi.keyMap)for(let s=0;s<i;s++)n[Ml(Bi.decodeKey(this[s]))]=Ii();else for(let s=0;s<i;s++)n[Ml(this[s])]=Ii();return n}return t.slowReads=0,e}function Ml(t){return t==="__proto__"?"__proto_":t}let oNe=iU;function iU(t){let e;if(t<16&&(e=rre(t)))return e;if(t>64&&ZO)return ZO.decode(Bt.subarray(nt,nt+=t));const i=nt+t,r=[];for(e="";nt<i;){const n=Bt[nt++];if(!(n&128))r.push(n);else if((n&224)===192){const s=Bt[nt++]&63;r.push((n&31)<<6|s)}else if((n&240)===224){const s=Bt[nt++]&63,o=Bt[nt++]&63;r.push((n&31)<<12|s<<6|o)}else if((n&248)===240){const s=Bt[nt++]&63,o=Bt[nt++]&63,a=Bt[nt++]&63;let l=(n&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(n);r.length>=4096&&(e+=gs.apply(String,r),r.length=0)}return r.length>0&&(e+=gs.apply(String,r)),e}let gs=String.fromCharCode;function aNe(t){let e=nt,i=new Array(t);for(let r=0;r<t;r++){const n=Bt[nt++];if((n&128)>0){nt=e;return}i[r]=n}return gs.apply(String,i)}function rre(t){if(t<4)if(t<2){if(t===0)return"";{let e=Bt[nt++];if((e&128)>1){nt-=1;return}return gs(e)}}else{let e=Bt[nt++],i=Bt[nt++];if((e&128)>0||(i&128)>0){nt-=2;return}if(t<3)return gs(e,i);let r=Bt[nt++];if((r&128)>0){nt-=3;return}return gs(e,i,r)}else{let e=Bt[nt++],i=Bt[nt++],r=Bt[nt++],n=Bt[nt++];if((e&128)>0||(i&128)>0||(r&128)>0||(n&128)>0){nt-=4;return}if(t<6){if(t===4)return gs(e,i,r,n);{let s=Bt[nt++];if((s&128)>0){nt-=5;return}return gs(e,i,r,n,s)}}else if(t<8){let s=Bt[nt++],o=Bt[nt++];if((s&128)>0||(o&128)>0){nt-=6;return}if(t<7)return gs(e,i,r,n,s,o);let a=Bt[nt++];if((a&128)>0){nt-=7;return}return gs(e,i,r,n,s,o,a)}else{let s=Bt[nt++],o=Bt[nt++],a=Bt[nt++],l=Bt[nt++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){nt-=8;return}if(t<10){if(t===8)return gs(e,i,r,n,s,o,a,l);{let u=Bt[nt++];if((u&128)>0){nt-=9;return}return gs(e,i,r,n,s,o,a,l,u)}}else if(t<12){let u=Bt[nt++],c=Bt[nt++];if((u&128)>0||(c&128)>0){nt-=10;return}if(t<11)return gs(e,i,r,n,s,o,a,l,u,c);let h=Bt[nt++];if((h&128)>0){nt-=11;return}return gs(e,i,r,n,s,o,a,l,u,c,h)}else{let u=Bt[nt++],c=Bt[nt++],h=Bt[nt++],d=Bt[nt++];if((u&128)>0||(c&128)>0||(h&128)>0||(d&128)>0){nt-=12;return}if(t<14){if(t===12)return gs(e,i,r,n,s,o,a,l,u,c,h,d);{let p=Bt[nt++];if((p&128)>0){nt-=13;return}return gs(e,i,r,n,s,o,a,l,u,c,h,d,p)}}else{let p=Bt[nt++],f=Bt[nt++];if((p&128)>0||(f&128)>0){nt-=14;return}if(t<15)return gs(e,i,r,n,s,o,a,l,u,c,h,d,p,f);let m=Bt[nt++];if((m&128)>0){nt-=15;return}return gs(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m)}}}}}function lNe(t){return Bi.copyBuffers?Uint8Array.prototype.slice.call(Bt,nt,nt+=t):Bt.subarray(nt,nt+=t)}let nre=new Float32Array(1),uE=new Uint8Array(nre.buffer,0,4);function uNe(){let t=Bt[nt++],e=Bt[nt++],i=(t&127)>>2;if(i===31)return e||t&3?NaN:t&128?-1/0:1/0;if(i===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return uE[3]=t&128|(i>>1)+56,uE[2]=(t&7)<<5|e>>3,uE[1]=e<<5,uE[0]=0,nre[0]}new Array(4096);class zm{constructor(e,i){this.value=e,this.tag=i}}Wn[0]=t=>new Date(t);Wn[1]=t=>new Date(Math.round(t*1e3));Wn[2]=t=>{let e=BigInt(0);for(let i=0,r=t.byteLength;i<r;i++)e=BigInt(t[i])+e<<BigInt(8);return e};Wn[3]=t=>BigInt(-1)-Wn[2](t);Wn[4]=t=>+(t[1]+"e"+t[0]);Wn[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const rU=(t,e)=>{t=t-57344;let i=on[t];i&&i.isShared&&((on.restoreStructures||(on.restoreStructures=[]))[t]=i),on[t]=e,e.read=tU(e)};Wn[rNe]=t=>{let e=t.length,i=t[1];rU(t[0],i);let r={};for(let n=2;n<e;n++){let s=i[n-2];r[Ml(s)]=t[n]}return r};Wn[14]=t=>rs?rs[0].slice(rs.position0,rs.position0+=t):new zm(t,14);Wn[15]=t=>rs?rs[1].slice(rs.position1,rs.position1+=t):new zm(t,15);let hNe={Error,RegExp};Wn[27]=t=>(hNe[t[0]]||Error)(t[1],t[2]);const sre=t=>{if(Bt[nt++]!=132)throw new Error("Packed values structure must be followed by a 4 element array");let e=t();return da=da?e.concat(da.slice(e.length)):e,da.prefixes=t(),da.suffixes=t(),t()};sre.handlesRead=!0;Wn[51]=sre;Wn[qq]=t=>{if(!da)if(Bi.getShared)h4();else return new zm(t,qq);if(typeof t=="number")return da[16+(t>=0?2*t:-2*t-1)];throw new Error("No support for non-integer packed references yet")};Wn[28]=t=>{mu||(mu=new Map,mu.id=0);let e=mu.id++,i=Bt[nt],r;i>>5==4?r=[]:r={};let n={target:r};mu.set(e,n);let s=t();return n.used?Object.assign(r,s):(n.target=s,s)};Wn[28].handlesRead=!0;Wn[29]=t=>{let e=mu.get(t);return e.used=!0,e.target};Wn[258]=t=>new Set(t);(Wn[259]=t=>(Bi.mapsAsObjects&&(Bi.mapsAsObjects=!1,Xx=!0),t())).handlesRead=!0;function ay(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Bf(){if(!da)if(Bi.getShared)h4();else throw new Error("No packed values available");return da}const cNe=1399353956;$O.push((t,e)=>{if(t>=225&&t<=255)return ay(Bf().prefixes[t-224],e);if(t>=28704&&t<=32767)return ay(Bf().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return ay(Bf().prefixes[t-1879048192],e);if(t>=216&&t<=223)return ay(e,Bf().suffixes[t-216]);if(t>=27647&&t<=28671)return ay(e,Bf().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return ay(e,Bf().suffixes[t-1811939328]);if(t==cNe)return{packedValues:da,structures:on.slice(0),version:e};if(t==55799)return e});const dNe=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,Kq=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],pNe=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<Kq.length;t++)fNe(Kq[t],pNe[t]);function fNe(t,e){let i="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let n=0;n<2;n++){if(!n&&r==1)continue;let s=r==2?1:r==4?2:3;Wn[n?e:e-4]=r==1||n==dNe?o=>{if(!t)throw new Error("Could not find typed array for code "+e);return new t(Uint8Array.prototype.slice.call(o,0).buffer)}:o=>{if(!t)throw new Error("Could not find typed array for code "+e);let a=new DataView(o.buffer,o.byteOffset,o.byteLength),l=o.length>>s,u=new t(l),c=a[i];for(let h=0;h<l;h++)u[h]=c.call(a,h<<s,n);return u}}}function mNe(){let t=cv(),e=nt+Ii();for(let r=2;r<t;r++){let n=cv();nt+=n}let i=nt;return nt=e,rs=[iU(cv()),iU(cv())],rs.position0=0,rs.position1=0,rs.postBundlePosition=nt,nt=i,Ii()}function cv(){let t=Bt[nt++]&31;if(t>23)switch(t){case 24:t=Bt[nt++];break;case 25:t=Lo.getUint16(nt),nt+=2;break;case 26:t=Lo.getUint32(nt),nt+=4;break}return t}function h4(){if(Bi.getShared){let t=ore(()=>(Bt=null,Bi.getShared()))||{},e=t.structures||[];Bi.sharedVersion=t.version,da=Bi.sharedValues=t.packedValues,on===!0?Bi.structures=on=e:on.splice.apply(on,[0,e.length].concat(e))}}function ore(t){let e=bm,i=nt,r=Y2,n=p1,s=X2,o=mu,a=rs,l=new Uint8Array(Bt.slice(0,bm)),u=on,c=Bi,h=f1,d=t();return bm=e,nt=i,Y2=r,p1=n,X2=s,mu=o,rs=a,Bt=l,f1=h,on=u,Bi=c,Lo=new DataView(Bt.buffer,Bt.byteOffset,Bt.byteLength),d}function nU(){Bt=null,mu=null,on=null}const c4=new Array(147);for(let t=0;t<256;t++)c4[t]=+("1e"+Math.floor(45.15-t*.30103));let d4=new ire({useRecords:!1});d4.decode;d4.decodeMultiple;let XM;try{XM=new TextEncoder}catch{}let sU,are;const eT=typeof globalThis=="object"&&globalThis.Buffer,l_=typeof eT<"u",F3=l_?eT.allocUnsafeSlow:Uint8Array,Jq=l_?eT:Uint8Array,Qq=256,Zq=l_?4294967296:2144337920;let z3,je,Cr,Ee=0,Bd,Zn=null;const gNe=61440,yNe=/[\u0080-\uFFFF]/,Ra=Symbol("record-id");let vNe=class extends ire{constructor(e){super(e),this.offset=0;let i,r,n,s,o;e=e||{};let a=Jq.prototype.utf8Write?function(I,D,F){return je.utf8Write(I,D,F)}:XM&&XM.encodeInto?function(I,D){return XM.encodeInto(I,je.subarray(D)).written}:!1,l=this,u=e.structures||e.saveStructures,c=e.maxSharedStructures;if(c==null&&(c=u?128:0),c>8190)throw new Error("Maximum maxSharedStructure is 8190");let h=e.sequential;h&&(c=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let d,p,f=e.sharedValues,m;if(f){m=Object.create(null);for(let I=0,D=f.length;I<D;I++)m[f[I]]=I}let g=[],y=0,v=0;this.mapEncode=function(I,D){if(this._keyMap&&!this._mapped)switch(I.constructor.name){case"Array":I=I.map(F=>this.encodeKeys(F));break}return this.encode(I,D)},this.encode=function(I,D){if(je||(je=new F3(8192),Cr=new DataView(je.buffer,0,8192),Ee=0),Bd=je.length-10,Bd-Ee<2048?(je=new F3(je.length),Cr=new DataView(je.buffer,0,je.length),Bd=je.length-10,Ee=0):D===i7&&(Ee=Ee+7&2147483640),i=Ee,l.useSelfDescribedHeader&&(Cr.setUint32(Ee,3654940416),Ee+=3),o=l.structuredClone?new Map:null,l.bundleStrings&&typeof I!="string"?(Zn=[],Zn.size=1/0):Zn=null,r=l.structures,r){if(r.uninitialized){let H=l.getShared()||{};l.structures=r=H.structures||[],l.sharedVersion=H.version;let z=l.sharedValues=H.packedValues;if(z){m={};for(let B=0,j=z.length;B<j;B++)m[z[B]]=B}}let F=r.length;if(F>c&&!h&&(F=c),!r.transitions){r.transitions=Object.create(null);for(let H=0;H<F;H++){let z=r[H];if(!z)continue;let B,j=r.transitions;for(let V=0,q=z.length;V<q;V++){j[Ra]===void 0&&(j[Ra]=H);let K=z[V];B=j[K],B||(B=j[K]=Object.create(null)),j=B}j[Ra]=H|1048576}}h||(r.nextId=F)}if(n&&(n=!1),s=r||[],p=m,e.pack){let F=new Map;if(F.values=[],F.encoder=l,F.maxValues=e.maxPrivatePackedValues||(m?16:1/0),F.objectMap=m||!1,F.samplingPackedValues=d,YM(I,F),F.values.length>0){je[Ee++]=216,je[Ee++]=51,hh(4);let H=F.values;b(H),hh(0),hh(0),p=Object.create(m||null);for(let z=0,B=H.length;z<B;z++)p[H[z]]=z}}z3=D&G3;try{if(z3)return;if(b(I),Zn&&t7(i,b),l.offset=Ee,o&&o.idsToInsert){Ee+=o.idsToInsert.length*2,Ee>Bd&&A(Ee),l.offset=Ee;let F=wNe(je.subarray(i,Ee),o.idsToInsert);return o=null,F}return D&i7?(je.start=i,je.end=Ee,je):je.subarray(i,Ee)}finally{if(r){if(v<10&&v++,r.length>c&&(r.length=c),y>1e4)r.transitions=null,v=0,y=0,g.length>0&&(g=[]);else if(g.length>0&&!h){for(let F=0,H=g.length;F<H;F++)g[F][Ra]=void 0;g=[]}}if(n&&l.saveShared){l.structures.length>c&&(l.structures=l.structures.slice(0,c));let F=je.subarray(i,Ee);return l.updateSharedData()===!1?l.encode(I):F}D&_Ne&&(Ee=i)}},this.findCommonStringsToPack=()=>(d=new Map,m||(m=Object.create(null)),I=>{let D=I&&I.threshold||4,F=this.pack?I.maxPrivatePackedValues||16:0;f||(f=this.sharedValues=[]);for(let[H,z]of d)z.count>D&&(m[H]=F++,f.push(H),n=!0);for(;this.saveShared&&this.updateSharedData()===!1;);d=null});const b=I=>{Ee>Bd&&(je=A(Ee));var D=typeof I,F;if(D==="string"){if(p){let j=p[I];if(j>=0){j<16?je[Ee++]=j+224:(je[Ee++]=198,j&1?b(15-j>>1):b(j-16>>1));return}else if(d&&!e.pack){let V=d.get(I);V?V.count++:d.set(I,{count:1})}}let H=I.length;if(Zn&&H>=4&&H<1024){if((Zn.size+=H)>gNe){let V,q=(Zn[0]?Zn[0].length*3+Zn[1].length:0)+10;Ee+q>Bd&&(je=A(Ee+q)),je[Ee++]=217,je[Ee++]=223,je[Ee++]=249,je[Ee++]=Zn.position?132:130,je[Ee++]=26,V=Ee-i,Ee+=4,Zn.position&&t7(i,b),Zn=["",""],Zn.size=0,Zn.position=V}let j=yNe.test(I);Zn[j?0:1]+=I,je[Ee++]=j?206:207,b(H);return}let z;H<32?z=1:H<256?z=2:H<65536?z=3:z=5;let B=H*3;if(Ee+B>Bd&&(je=A(Ee+B)),H<64||!a){let j,V,q,K=Ee+z;for(j=0;j<H;j++)V=I.charCodeAt(j),V<128?je[K++]=V:V<2048?(je[K++]=V>>6|192,je[K++]=V&63|128):(V&64512)===55296&&((q=I.charCodeAt(j+1))&64512)===56320?(V=65536+((V&1023)<<10)+(q&1023),j++,je[K++]=V>>18|240,je[K++]=V>>12&63|128,je[K++]=V>>6&63|128,je[K++]=V&63|128):(je[K++]=V>>12|224,je[K++]=V>>6&63|128,je[K++]=V&63|128);F=K-Ee-z}else F=a(I,Ee+z,B);F<24?je[Ee++]=96|F:F<256?(z<2&&je.copyWithin(Ee+2,Ee+1,Ee+1+F),je[Ee++]=120,je[Ee++]=F):F<65536?(z<3&&je.copyWithin(Ee+3,Ee+2,Ee+2+F),je[Ee++]=121,je[Ee++]=F>>8,je[Ee++]=F&255):(z<5&&je.copyWithin(Ee+5,Ee+3,Ee+3+F),je[Ee++]=122,Cr.setUint32(Ee,F),Ee+=4),Ee+=F}else if(D==="number")if(!this.alwaysUseFloat&&I>>>0===I)I<24?je[Ee++]=I:I<256?(je[Ee++]=24,je[Ee++]=I):I<65536?(je[Ee++]=25,je[Ee++]=I>>8,je[Ee++]=I&255):(je[Ee++]=26,Cr.setUint32(Ee,I),Ee+=4);else if(!this.alwaysUseFloat&&I>>0===I)I>=-24?je[Ee++]=31-I:I>=-256?(je[Ee++]=56,je[Ee++]=~I):I>=-65536?(je[Ee++]=57,Cr.setUint16(Ee,~I),Ee+=2):(je[Ee++]=58,Cr.setUint32(Ee,~I),Ee+=4);else{let H;if((H=this.useFloat32)>0&&I<4294967296&&I>=-2147483648){je[Ee++]=250,Cr.setFloat32(Ee,I);let z;if(H<4||(z=I*c4[(je[Ee]&127)<<1|je[Ee+1]>>7])>>0===z){Ee+=4;return}else Ee--}je[Ee++]=251,Cr.setFloat64(Ee,I),Ee+=8}else if(D==="object")if(!I)je[Ee++]=246;else{if(o){let z=o.get(I);if(z){if(je[Ee++]=216,je[Ee++]=29,je[Ee++]=25,!z.references){let B=o.idsToInsert||(o.idsToInsert=[]);z.references=[],B.push(z)}z.references.push(Ee-i),Ee+=2;return}else o.set(I,{offset:Ee-i})}let H=I.constructor;if(H===Object)_(I,!0);else if(H===Array){F=I.length,F<24?je[Ee++]=128|F:hh(F);for(let z=0;z<F;z++)b(I[z])}else if(H===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(je[Ee++]=217,je[Ee++]=1,je[Ee++]=3),F=I.size,F<24?je[Ee++]=160|F:F<256?(je[Ee++]=184,je[Ee++]=F):F<65536?(je[Ee++]=185,je[Ee++]=F>>8,je[Ee++]=F&255):(je[Ee++]=186,Cr.setUint32(Ee,F),Ee+=4),l.keyMap)for(let[z,B]of I)b(l.encodeKey(z)),b(B);else for(let[z,B]of I)b(z),b(B);else{for(let z=0,B=sU.length;z<B;z++){let j=are[z];if(I instanceof j){let V=sU[z],q=V.tag;q==null&&(q=V.getTag&&V.getTag.call(this,I)),q<24?je[Ee++]=192|q:q<256?(je[Ee++]=216,je[Ee++]=q):q<65536?(je[Ee++]=217,je[Ee++]=q>>8,je[Ee++]=q&255):q>-1&&(je[Ee++]=218,Cr.setUint32(Ee,q),Ee+=4),V.encode.call(this,I,b,A);return}}if(I[Symbol.iterator]){if(z3){let z=new Error("Iterable should be serialized as iterator");throw z.iteratorNotHandled=!0,z}je[Ee++]=159;for(let z of I)b(z);je[Ee++]=255;return}if(I[Symbol.asyncIterator]||H3(I)){let z=new Error("Iterable/blob should be serialized as iterator");throw z.iteratorNotHandled=!0,z}if(this.useToJSON&&I.toJSON){const z=I.toJSON();if(z!==I)return b(z)}_(I,!I.hasOwnProperty)}}else if(D==="boolean")je[Ee++]=I?245:244;else if(D==="bigint"){if(I<BigInt(1)<<BigInt(64)&&I>=0)je[Ee++]=27,Cr.setBigUint64(Ee,I);else if(I>-(BigInt(1)<<BigInt(64))&&I<0)je[Ee++]=59,Cr.setBigUint64(Ee,-I-BigInt(1));else if(this.largeBigIntToFloat)je[Ee++]=251,Cr.setFloat64(Ee,Number(I));else throw new RangeError(I+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ee+=8}else if(D==="undefined")je[Ee++]=247;else throw new Error("Unknown type: "+D)},_=this.useRecords===!1?this.variableMapSize?I=>{let D=Object.keys(I),F=Object.values(I),H=D.length;if(H<24?je[Ee++]=160|H:H<256?(je[Ee++]=184,je[Ee++]=H):H<65536?(je[Ee++]=185,je[Ee++]=H>>8,je[Ee++]=H&255):(je[Ee++]=186,Cr.setUint32(Ee,H),Ee+=4),l.keyMap)for(let z=0;z<H;z++)b(l.encodeKey(D[z])),b(F[z]);else for(let z=0;z<H;z++)b(D[z]),b(F[z])}:(I,D)=>{je[Ee++]=185;let F=Ee-i;Ee+=2;let H=0;if(l.keyMap)for(let z in I)(D||I.hasOwnProperty(z))&&(b(l.encodeKey(z)),b(I[z]),H++);else for(let z in I)(D||I.hasOwnProperty(z))&&(b(z),b(I[z]),H++);je[F+++i]=H>>8,je[F+i]=H&255}:(I,D)=>{let F,H=s.transitions||(s.transitions=Object.create(null)),z=0,B=0,j,V;if(this.keyMap){V=Object.keys(I).map(K=>this.encodeKey(K)),B=V.length;for(let K=0;K<B;K++){let le=V[K];F=H[le],F||(F=H[le]=Object.create(null),z++),H=F}}else for(let K in I)(D||I.hasOwnProperty(K))&&(F=H[K],F||(H[Ra]&1048576&&(j=H[Ra]&65535),F=H[K]=Object.create(null),z++),H=F,B++);let q=H[Ra];if(q!==void 0)q&=65535,je[Ee++]=217,je[Ee++]=q>>8|224,je[Ee++]=q&255;else if(V||(V=H.__keys__||(H.__keys__=Object.keys(I))),j===void 0?(q=s.nextId++,q||(q=0,s.nextId=1),q>=Qq&&(s.nextId=(q=c)+1)):q=j,s[q]=V,q<c){je[Ee++]=217,je[Ee++]=q>>8|224,je[Ee++]=q&255,H=s.transitions;for(let K=0;K<B;K++)(H[Ra]===void 0||H[Ra]&1048576)&&(H[Ra]=q),H=H[V[K]];H[Ra]=q|1048576,n=!0}else{if(H[Ra]=q,Cr.setUint32(Ee,3655335680),Ee+=3,z&&(y+=v*z),g.length>=Qq-c&&(g.shift()[Ra]=void 0),g.push(H),hh(B+2),b(57344+q),b(V),D===null)return;for(let K in I)(D||I.hasOwnProperty(K))&&b(I[K]);return}if(B<24?je[Ee++]=128|B:hh(B),D!==null)for(let K in I)(D||I.hasOwnProperty(K))&&b(I[K])},A=I=>{let D;if(I>16777216){if(I-i>Zq)throw new Error("Encoded buffer would be larger than maximum buffer size");D=Math.min(Zq,Math.round(Math.max((I-i)*(I>67108864?1.25:2),4194304)/4096)*4096)}else D=(Math.max(I-i<<2,je.length-1)>>12)+1<<12;let F=new F3(D);return Cr=new DataView(F.buffer,0,D),je.copy?je.copy(F,0,i,I):F.set(je.slice(i,I)),Ee-=i,i=0,Bd=F.length-10,je=F};let S=100,E=1e3;this.encodeAsIterable=function(I,D){return T(I,D,M)},this.encodeAsAsyncIterable=function(I,D){return T(I,D,L)};function*M(I,D,F){let H=I.constructor;if(H===Object){let z=l.useRecords!==!1;z?_(I,null):$q(Object.keys(I).length,160);for(let B in I){let j=I[B];z||b(B),j&&typeof j=="object"?D[B]?yield*M(j,D[B]):yield*R(j,D,B):b(j)}}else if(H===Array){let z=I.length;hh(z);for(let B=0;B<z;B++){let j=I[B];j&&(typeof j=="object"||Ee-i>S)?D.element?yield*M(j,D.element):yield*R(j,D,"element"):b(j)}}else if(I[Symbol.iterator]){je[Ee++]=159;for(let z of I)z&&(typeof z=="object"||Ee-i>S)?D.element?yield*M(z,D.element):yield*R(z,D,"element"):b(z);je[Ee++]=255}else H3(I)?($q(I.size,64),yield je.subarray(i,Ee),yield I,C()):I[Symbol.asyncIterator]?(je[Ee++]=159,yield je.subarray(i,Ee),yield I,C(),je[Ee++]=255):b(I);F&&Ee>i?yield je.subarray(i,Ee):Ee-i>S&&(yield je.subarray(i,Ee),C())}function*R(I,D,F){let H=Ee-i;try{b(I),Ee-i>S&&(yield je.subarray(i,Ee),C())}catch(z){if(z.iteratorNotHandled)D[F]={},Ee=i+H,yield*M.call(this,I,D[F]);else throw z}}function C(){S=E,l.encode(null,G3)}function T(I,D,F){return D&&D.chunkThreshold?S=E=D.chunkThreshold:S=100,I&&typeof I=="object"?(l.encode(null,G3),F(I,l.iterateProperties||(l.iterateProperties={}),!0)):[l.encode(I)]}async function*L(I,D){for(let F of M(I,D,!0)){let H=F.constructor;if(H===Jq||H===Uint8Array)yield F;else if(H3(F)){let z=F.stream().getReader(),B;for(;!(B=await z.read()).done;)yield B.value}else if(F[Symbol.asyncIterator])for await(let z of F)C(),z?yield*L(z,D.async||(D.async={})):yield l.encode(z);else yield F}}}useBuffer(e){je=e,Cr=new DataView(je.buffer,je.byteOffset,je.byteLength),Ee=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let i=this.structures.slice(0),r=new lre(i,this.sharedValues,this.sharedVersion),n=this.saveShared(r,s=>(s&&s.version||0)==e);return n===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):i.forEach((s,o)=>this.structures[o]=s),n}};function $q(t,e){t<24?je[Ee++]=e|t:t<256?(je[Ee++]=e|24,je[Ee++]=t):t<65536?(je[Ee++]=e|25,je[Ee++]=t>>8,je[Ee++]=t&255):(je[Ee++]=e|26,Cr.setUint32(Ee,t),Ee+=4)}class lre{constructor(e,i,r){this.structures=e,this.packedValues=i,this.version=r}}function hh(t){t<24?je[Ee++]=128|t:t<256?(je[Ee++]=152,je[Ee++]=t):t<65536?(je[Ee++]=153,je[Ee++]=t>>8,je[Ee++]=t&255):(je[Ee++]=154,Cr.setUint32(Ee,t),Ee+=4)}const bNe=typeof Blob>"u"?function(){}:Blob;function H3(t){if(t instanceof bNe)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function YM(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let n=e.samplingPackedValues.get(t);n?n.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,n=t.length;r<n;r++)YM(t[r],e);else{let r=!e.encoder.useRecords;for(var i in t)t.hasOwnProperty(i)&&(r&&YM(i,e),YM(t[i],e))}break;case"function":console.log(t)}}const xNe=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;are=[Date,Set,Error,RegExp,zm,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,lre];sU=[{tag:1,encode(t,e){let i=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296?(je[Ee++]=26,Cr.setUint32(Ee,i),Ee+=4):(je[Ee++]=251,Cr.setFloat64(Ee,i),Ee+=8)}},{tag:258,encode(t,e){let i=Array.from(t);e(i)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,i){e7(t,i)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||l_&&this.tagUint8Array!==!1))return 64},encode(t,e,i){e7(t,i)}},nh(68,1),nh(69,2),nh(70,4),nh(71,8),nh(72,1),nh(77,2),nh(78,4),nh(79,8),nh(85,4),nh(86,8),{encode(t,e){let i=t.packedValues||[],r=t.structures||[];if(i.values.length>0){je[Ee++]=216,je[Ee++]=51,hh(4);let n=i.values;e(n),hh(0),hh(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,o=n.length;s<o;s++)packedObjectMap[n[s]]=s}if(r){Cr.setUint32(Ee,3655335424),Ee+=3;let n=r.slice(0);n.unshift(57344),n.push(new zm(t.version,1399353956)),e(n)}else e(new zm(t.version,1399353956))}}];function nh(t,e){return!xNe&&e>1&&(t-=4),{tag:t,encode:function(r,n){let s=r.byteLength,o=r.byteOffset||0,a=r.buffer||r;n(l_?eT.from(a,o,s):new Uint8Array(a,o,s))}}}function e7(t,e){let i=t.byteLength;i<24?je[Ee++]=64+i:i<256?(je[Ee++]=88,je[Ee++]=i):i<65536?(je[Ee++]=89,je[Ee++]=i>>8,je[Ee++]=i&255):(je[Ee++]=90,Cr.setUint32(Ee,i),Ee+=4),Ee+i>=je.length&&e(Ee+i),je.set(t.buffer?t:new Uint8Array(t),Ee),Ee+=i}function wNe(t,e){let i,r=e.length*2,n=t.length-r;e.sort((s,o)=>s.offset>o.offset?1:-1);for(let s=0;s<e.length;s++){let o=e[s];o.id=s;for(let a of o.references)t[a++]=s>>8,t[a]=s&255}for(;i=e.pop();){let s=i.offset;t.copyWithin(s+r,s,n),r-=2;let o=s+r;t[o++]=216,t[o++]=28,n=s}return t}function t7(t,e){Cr.setUint32(Zn.position+t,Ee-Zn.position-t+1);let i=Zn;Zn=null,e(i[0]),e(i[1])}let p4=new vNe({useRecords:!1});p4.encode;p4.encodeAsIterable;p4.encodeAsAsyncIterable;const i7=512,_Ne=1024,G3=2048;function og(t,e,i,r){Object.defineProperty(t,e,{get:i,set:r,enumerable:!0,configurable:!0})}class ure{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const i=[],r=e.byteLength,n=Math.ceil(r/this.chunkedMTU);let s=0,o=0;for(;o<r;){const a=Math.min(r,o+this.chunkedMTU),l=e.slice(o,a),u={__peerData:this._dataCount,n:s,data:l,total:n};i.push(u),o=a,s++}return this._dataCount++,i}}}function SNe(t){let e=0;for(const n of t)e+=n.byteLength;const i=new Uint8Array(e);let r=0;for(const n of t)i.set(n,r),r+=n.byteLength;return i}const V3=jq.default||jq,mx=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return V3.browserDetails.browser}getVersion(){return V3.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=V3.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let i,r=!1;try{i=new RTCPeerConnection,i.addTransceiver("audio"),r=!0}catch{}finally{i&&i.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},ANe=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),hre=()=>Math.random().toString(36).slice(2),r7={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class ENe extends ure{noop(){}blobToArrayBuffer(e,i){const r=new FileReader;return r.onload=function(n){n.target&&i(n.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r)&255;return i.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=r7,this.browser=mx.getBrowser(),this.browserVersion=mx.getVersion(),this.pack=xie,this.unpack=bie,this.supports=function(){const i={browser:mx.isBrowserSupported(),webRTC:mx.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!i.webRTC)return i;let r;try{r=new RTCPeerConnection(r7),i.audioVideo=!0;let n;try{n=r.createDataChannel("_PEERJSTEST",{ordered:!0}),i.data=!0,i.reliable=!!n.ordered;try{n.binaryType="blob",i.binaryBlob=!mx.isIOS}catch{}}catch{}finally{n&&n.close()}}catch{}finally{r&&r.close()}return i}(),this.validateId=ANe,this.randomToken=hre}}const oa=new ENe,MNe="PeerJS: ";var n7;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(n7||(n7={}));class CNe{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...i){const r=[MNe,...i];for(const n in r)r[n]instanceof Error&&(r[n]="("+r[n].name+") "+r[n].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var Ot=new CNe,f4={},PNe=Object.prototype.hasOwnProperty,Ko="~";function m1(){}Object.create&&(m1.prototype=Object.create(null),new m1().__proto__||(Ko=!1));function TNe(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function cre(t,e,i,r,n){if(typeof i!="function")throw new TypeError("The listener must be a function");var s=new TNe(i,r||t,n),o=Ko?Ko+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function KM(t,e){--t._eventsCount===0?t._events=new m1:delete t._events[e]}function xo(){this._events=new m1,this._eventsCount=0}xo.prototype.eventNames=function(){var e=[],i,r;if(this._eventsCount===0)return e;for(r in i=this._events)PNe.call(i,r)&&e.push(Ko?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(i)):e};xo.prototype.listeners=function(e){var i=Ko?Ko+e:e,r=this._events[i];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,s=r.length,o=new Array(s);n<s;n++)o[n]=r[n].fn;return o};xo.prototype.listenerCount=function(e){var i=Ko?Ko+e:e,r=this._events[i];return r?r.fn?1:r.length:0};xo.prototype.emit=function(e,i,r,n,s,o){var a=Ko?Ko+e:e;if(!this._events[a])return!1;var l=this._events[a],u=arguments.length,c,h;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,i),!0;case 3:return l.fn.call(l.context,i,r),!0;case 4:return l.fn.call(l.context,i,r,n),!0;case 5:return l.fn.call(l.context,i,r,n,s),!0;case 6:return l.fn.call(l.context,i,r,n,s,o),!0}for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];l.fn.apply(l.context,c)}else{var d=l.length,p;for(h=0;h<d;h++)switch(l[h].once&&this.removeListener(e,l[h].fn,void 0,!0),u){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,i);break;case 3:l[h].fn.call(l[h].context,i,r);break;case 4:l[h].fn.call(l[h].context,i,r,n);break;default:if(!c)for(p=1,c=new Array(u-1);p<u;p++)c[p-1]=arguments[p];l[h].fn.apply(l[h].context,c)}}return!0};xo.prototype.on=function(e,i,r){return cre(this,e,i,r,!1)};xo.prototype.once=function(e,i,r){return cre(this,e,i,r,!0)};xo.prototype.removeListener=function(e,i,r,n){var s=Ko?Ko+e:e;if(!this._events[s])return this;if(!i)return KM(this,s),this;var o=this._events[s];if(o.fn)o.fn===i&&(!n||o.once)&&(!r||o.context===r)&&KM(this,s);else{for(var a=0,l=[],u=o.length;a<u;a++)(o[a].fn!==i||n&&!o[a].once||r&&o[a].context!==r)&&l.push(o[a]);l.length?this._events[s]=l.length===1?l[0]:l:KM(this,s)}return this};xo.prototype.removeAllListeners=function(e){var i;return e?(i=Ko?Ko+e:e,this._events[i]&&KM(this,i)):(this._events=new m1,this._eventsCount=0),this};xo.prototype.off=xo.prototype.removeListener;xo.prototype.addListener=xo.prototype.on;xo.prefixed=Ko;xo.EventEmitter=xo;f4=xo;var ag={};og(ag,"ConnectionType",()=>Th);og(ag,"PeerErrorType",()=>rn);og(ag,"BaseConnectionErrorType",()=>g1);og(ag,"DataConnectionErrorType",()=>y1);og(ag,"SerializationType",()=>m0);og(ag,"SocketEventType",()=>_h);og(ag,"ServerMessageType",()=>xs);var Th;(function(t){t.Data="data",t.Media="media"})(Th||(Th={}));var rn;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(rn||(rn={}));var g1;(function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"})(g1||(g1={}));var y1;(function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"})(y1||(y1={}));var m0;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"})(m0||(m0={}));var _h;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(_h||(_h={}));var xs;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(xs||(xs={}));var m4={};m4=JSON.parse('{"name":"peerjs","version":"1.5.2","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-cbor":"dist/serializer.cbor.mjs","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-cbor":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/Cbor.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","cbor-x":"1.5.4","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^8.0.0"},"alias":{"process":false,"buffer":false}}');class RNe extends f4.EventEmitter{constructor(e,i,r,n,s,o=5e3){super(),this.pingInterval=o,this._disconnected=!0,this._messagesQueue=[];const a=e?"wss://":"ws://";this._baseUrl=a+i+":"+r+n+"peerjs?key="+s}start(e,i){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${i}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+m4.version),this._disconnected=!1,this._socket.onmessage=n=>{let s;try{s=JSON.parse(n.data),Ot.log("Server message received:",s)}catch{Ot.log("Invalid server message",n.data);return}this.emit(_h.Message,s)},this._socket.onclose=n=>{this._disconnected||(Ot.log("Socket closed.",n),this._cleanup(),this._disconnected=!0,this.emit(_h.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Ot.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Ot.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:xs.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const i of e)this.send(i)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(_h.Error,"Invalid message");return}if(!this._wsOpen())return;const i=JSON.stringify(e);this._socket.send(i)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class dre{constructor(e){this.connection=e}startConnection(e){const i=this._startPeerConnection();if(this.connection.peerConnection=i,this.connection.type===Th.Media&&e._stream&&this._addTracksToConnection(e._stream,i),e.originator){const r=this.connection,n={ordered:!!e.reliable},s=i.createDataChannel(r.label,n);r._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Ot.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const i=this.connection.peer,r=this.connection.connectionId,n=this.connection.type,s=this.connection.provider;Ot.log("Listening for ICE candidates."),e.onicecandidate=o=>{!o.candidate||!o.candidate.candidate||(Ot.log(`Received ICE candidates for ${i}:`,o.candidate),s.socket.send({type:xs.Candidate,payload:{candidate:o.candidate,type:n,connectionId:r},dst:i}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Ot.log("iceConnectionState is failed, closing connections to "+i),this.connection.emitError(g1.NegotiationFailed,"Negotiation of connection to "+i+" failed."),this.connection.close();break;case"closed":Ot.log("iceConnectionState is closed, closing connections to "+i),this.connection.emitError(g1.ConnectionClosed,"Connection to "+i+" closed."),this.connection.close();break;case"disconnected":Ot.log("iceConnectionState changed to disconnected on the connection with "+i);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Ot.log("Listening for data channel"),e.ondatachannel=o=>{Ot.log("Received data channel");const a=o.channel;s.getConnection(i,r)._initializeDataChannel(a)},Ot.log("Listening for remote stream"),e.ontrack=o=>{Ot.log("Received remote stream");const a=o.streams[0],l=s.getConnection(i,r);if(l.type===Th.Media){const u=l;this._addStreamToMediaConnection(a,u)}}}cleanup(){Ot.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const i=e.signalingState!=="closed";let r=!1;const n=this.connection.dataChannel;n&&(r=!!n.readyState&&n.readyState!=="closed"),(i||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,i=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);Ot.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Ot.log("Set localDescription:",r,`for:${this.connection.peer}`);let n={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===Th.Data){const s=this.connection;n={...n,label:s.label,reliable:s.reliable,serialization:s.serialization}}i.socket.send({type:xs.Offer,payload:n,dst:this.connection.peer})}catch(n){n!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(i.emitError(rn.WebRTC,n),Ot.log("Failed to setLocalDescription, ",n))}}catch(r){i.emitError(rn.WebRTC,r),Ot.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,i=this.connection.provider;try{const r=await e.createAnswer();Ot.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Ot.log("Set localDescription:",r,`for:${this.connection.peer}`),i.socket.send({type:xs.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(n){i.emitError(rn.WebRTC,n),Ot.log("Failed to setLocalDescription, ",n)}}catch(r){i.emitError(rn.WebRTC,r),Ot.log("Failed to create answer, ",r)}}async handleSDP(e,i){i=new RTCSessionDescription(i);const r=this.connection.peerConnection,n=this.connection.provider;Ot.log("Setting remote description",i);const s=this;try{await r.setRemoteDescription(i),Ot.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(o){n.emitError(rn.WebRTC,o),Ot.log("Failed to setRemoteDescription, ",o)}}async handleCandidate(e){Ot.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Ot.log(`Added ICE candidate for:${this.connection.peer}`)}catch(i){this.connection.provider.emitError(rn.WebRTC,i),Ot.log("Failed to handleCandidate, ",i)}}_addTracksToConnection(e,i){if(Ot.log(`add tracks from stream ${e.id} to peer connection`),!i.addTrack)return Ot.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{i.addTrack(r,e)})}_addStreamToMediaConnection(e,i){Ot.log(`add stream ${e.id} to media connection ${i.connectionId}`),i.addStream(e)}}class pre extends f4.EventEmitter{emitError(e,i){Ot.error("Error:",i),this.emit("error",new kNe(`${e}`,i))}}class kNe extends Error{constructor(e,i){typeof i=="string"?super(i):(super(),Object.assign(this,i)),this.type=e}}class fre extends pre{get open(){return this._open}constructor(e,i,r){super(),this.peer=e,this.provider=i,this.options=r,this._open=!1,this.metadata=r.metadata}}var fN;const Sw=class Sw extends fre{get type(){return Th.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,i,r){super(e,i,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Sw.ID_PREFIX+oa.randomToken(),this._negotiator=new dre(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Ot.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Ot.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Ot.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const i=e.type,r=e.payload;switch(e.type){case xs.Answer:this._negotiator.handleSDP(i,r.sdp),this._open=!0;break;case xs.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:Ot.warn(`Unrecognized message type:${i} from peer:${this.peer}`);break}}answer(e,i={}){if(this._localStream){Ot.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,i&&i.sdpTransform&&(this.options.sdpTransform=i.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const n of r)this.handleMessage(n);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};fN=new WeakMap,Tb(Sw,fN,Sw.ID_PREFIX="mc_");let K2=Sw;class DNe{constructor(e){this._options=e}_buildRequest(e){const i=this._options.secure?"https":"http",{host:r,port:n,path:s,key:o}=this._options,a=new URL(`${i}://${r}:${n}${s}${o}/${e}`);return a.searchParams.set("ts",`${Date.now()}${Math.random()}`),a.searchParams.set("version",m4.version),fetch(a.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Ot.error("Error retrieving ID",e);let i="";throw this._options.path==="/"&&this._options.host!==oa.CLOUD_HOST&&(i=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+i)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let i="";throw this._options.host===oa.CLOUD_HOST?i="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":i="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+i)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Ot.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var mN,gN;const jf=class jf extends fre{get type(){return Th.Data}constructor(e,i,r){super(e,i,r),this.connectionId=this.options.connectionId||jf.ID_PREFIX+hre(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new dre(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Ot.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=i=>{Ot.log(`DC#${this.connectionId} dc onmessage:`,i.data)},this.dataChannel.onclose=()=>{Ot.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,i=!1){if(!this.open){this.emitError(y1.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,i)}async handleMessage(e){const i=e.payload;switch(e.type){case xs.Answer:await this._negotiator.handleSDP(e.type,i.sdp);break;case xs.Candidate:await this._negotiator.handleCandidate(i.candidate);break;default:Ot.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};mN=new WeakMap,gN=new WeakMap,Tb(jf,mN,jf.ID_PREFIX="dc_"),Tb(jf,gN,jf.MAX_BUFFERED_AMOUNT=8388608);let J2=jf;class g4 extends J2{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",i=>this._handleDataMessage(i))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>J2.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(i){return Ot.error(`DC#:${this.connectionId} Error when sending:`,i),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class j3 extends g4{close(e){super.close(e),this._chunkedData={}}constructor(e,i,r){super(e,i,r),this.chunker=new ure,this.serialization=m0.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const i=bie(e),r=i.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(i);return}this.emit("data",i)}_handleChunk(e){const i=e.__peerData,r=this._chunkedData[i]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[i]=r,r.total===r.count){delete this._chunkedData[i];const n=SNe(r.data);this._handleDataMessage({data:n})}}_send(e,i){const r=xie(e);if(r instanceof Promise)return this._send_blob(r);if(!i&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const i=await e;if(i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}_sendChunks(e){const i=this.chunker.chunk(e);Ot.log(`DC#${this.connectionId} Try to send ${i.length} chunks...`);for(const r of i)this.send(r,!0)}}class INe extends g4{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,i){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=m0.None}}class LNe extends g4{_handleDataMessage({data:e}){const i=this.parse(this.decoder.decode(e)),r=i.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",i)}_send(e,i){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=oa.chunkedMTU){this.emitError(y1.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=m0.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var yN;const Aw=class Aw extends pre{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[i,r]of this._connections)e[i]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,i){super(),this._serializers={raw:INe,json:LNe,binary:j3,"binary-utf8":j3,default:j3},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?i=e:e&&(r=e.toString()),i={debug:0,host:oa.CLOUD_HOST,port:oa.CLOUD_PORT,path:"/",key:Aw.DEFAULT_KEY,token:oa.randomToken(),config:oa.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...i},this._options=i,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==oa.CLOUD_HOST?this._options.secure=oa.isSecure():this._options.host==oa.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Ot.setLogFunction(this._options.logFunction),Ot.logLevel=this._options.debug||0,this._api=new DNe(i),this._socket=this._createServerConnection(),!oa.supports.audioVideo&&!oa.supports.data){this._delayedAbort(rn.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!oa.validateId(r)){this._delayedAbort(rn.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(n=>this._initialize(n)).catch(n=>this._abort(rn.ServerError,n))}_createServerConnection(){const e=new RNe(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(_h.Message,i=>{this._handleMessage(i)}),e.on(_h.Error,i=>{this._abort(rn.SocketError,i)}),e.on(_h.Disconnected,()=>{this.disconnected||(this.emitError(rn.Network,"Lost connection to server."),this.disconnect())}),e.on(_h.Close,()=>{this.disconnected||this._abort(rn.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const i=e.type,r=e.payload,n=e.src;switch(i){case xs.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case xs.Error:this._abort(rn.ServerError,r.msg);break;case xs.IdTaken:this._abort(rn.UnavailableID,`ID "${this.id}" is taken`);break;case xs.InvalidKey:this._abort(rn.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case xs.Leave:Ot.log(`Received leave message from ${n}`),this._cleanupPeer(n),this._connections.delete(n);break;case xs.Expire:this.emitError(rn.PeerUnavailable,`Could not connect to peer ${n}`);break;case xs.Offer:{const s=r.connectionId;let o=this.getConnection(n,s);if(o&&(o.close(),Ot.warn(`Offer received for existing Connection ID:${s}`)),r.type===Th.Media){const l=new K2(n,this,{connectionId:s,_payload:r,metadata:r.metadata});o=l,this._addConnection(n,o),this.emit("call",l)}else if(r.type===Th.Data){const l=new this._serializers[r.serialization](n,this,{connectionId:s,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});o=l,this._addConnection(n,o),this.emit("connection",l)}else{Ot.warn(`Received malformed connection type:${r.type}`);return}const a=this._getMessages(s);for(const l of a)o.handleMessage(l);break}default:{if(!r){Ot.warn(`You received a malformed message from ${n} of type ${i}`);return}const s=r.connectionId,o=this.getConnection(n,s);o&&o.peerConnection?o.handleMessage(e):s?this._storeMessage(s,e):Ot.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,i){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(i)}_getMessages(e){const i=this._lostMessages.get(e);return i?(this._lostMessages.delete(e),i):[]}connect(e,i={}){if(i={serialization:"default",...i},this.disconnected){Ot.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(rn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[i.serialization](e,this,i);return this._addConnection(e,r),r}call(e,i,r={}){if(this.disconnected){Ot.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(rn.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!i){Ot.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const n=new K2(e,this,{...r,_stream:i});return this._addConnection(e,n),n}_addConnection(e,i){Ot.log(`add connection ${i.type}:${i.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(i)}_removeConnection(e){const i=this._connections.get(e.peer);if(i){const r=i.indexOf(e);r!==-1&&i.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,i){const r=this._connections.get(e);if(!r)return null;for(const n of r)if(n.connectionId===i)return n;return null}_delayedAbort(e,i){setTimeout(()=>{this._abort(e,i)},0)}_abort(e,i){Ot.error("Aborting!"),this.emitError(e,i),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Ot.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const i=this._connections.get(e);if(i)for(const r of i)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;Ot.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Ot.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Ot.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=i=>{}){this._api.listAllPeers().then(i=>e(i)).catch(i=>this._abort(rn.ServerError,i))}};yN=new WeakMap,Tb(Aw,yN,Aw.DEFAULT_KEY="peerjs");let oU=Aw;var BNe=oU;function ONe(t){return $0({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function UNe(t){return $0({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1l-55-42.5c15.4-1.4 29.2-13.7 29.2-31.1v-257c0-25.5-29.1-40.4-50.4-25.8L448 177.3v137.2l-32-24.7v-178c0-26.4-21.4-47.8-47.8-47.8H123.9L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4L42.7 82 416 370.6l178.5 138c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.5-6.9 4.2-17-2.8-22.4zM32 400.2c0 26.4 21.4 47.8 47.8 47.8h288.4c11.2 0 21.4-4 29.6-10.5L32 154.7v245.5z"},child:[]}]})(t)}function NNe(t){return $0({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"},child:[]}]})(t)}function FNe(t){return $0({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L472.1 344.7c15.2-26 23.9-56.3 23.9-88.7V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 21.2-5.1 41.1-14.2 58.7L416 300.8V96c0-53-43-96-96-96s-96 43-96 96v54.3L38.8 5.1zM344 430.4c20.4-2.8 39.7-9.1 57.3-18.2l-43.1-33.9C346.1 382 333.3 384 320 384c-70.7 0-128-57.3-128-128v-8.7L144.7 210c-.5 1.9-.7 3.9-.7 6v40c0 89.1 66.2 162.7 152 174.4V464H248c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H344V430.4z"},child:[]}]})(t)}function zNe(t){return $0({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M144 464a16 16 0 0 1-16-16v-64h-24a72.08 72.08 0 0 1-72-72V120a72.08 72.08 0 0 1 72-72h304a72.08 72.08 0 0 1 72 72v192a72.08 72.08 0 0 1-72 72H245.74l-91.49 76.29A16.05 16.05 0 0 1 144 464z"},child:[]}]})(t)}const Fh=Object.create(null);Fh.open="0";Fh.close="1";Fh.ping="2";Fh.pong="3";Fh.message="4";Fh.upgrade="5";Fh.noop="6";const JM=Object.create(null);Object.keys(Fh).forEach(t=>{JM[Fh[t]]=t});const aU={type:"error",data:"parser error"},mre=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",gre=typeof ArrayBuffer=="function",yre=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,y4=({type:t,data:e},i,r)=>mre&&e instanceof Blob?i?r(e):s7(e,r):gre&&(e instanceof ArrayBuffer||yre(e))?i?r(e):s7(new Blob([e]),r):r(Fh[t]+(e||"")),s7=(t,e)=>{const i=new FileReader;return i.onload=function(){const r=i.result.split(",")[1];e("b"+(r||""))},i.readAsDataURL(t)};function o7(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let W3;function HNe(t,e){if(mre&&t.data instanceof Blob)return t.data.arrayBuffer().then(o7).then(e);if(gre&&(t.data instanceof ArrayBuffer||yre(t.data)))return e(o7(t.data));y4(t,!1,i=>{W3||(W3=new TextEncoder),e(W3.encode(i))})}const a7="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yx=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<a7.length;t++)Yx[a7.charCodeAt(t)]=t;const GNe=t=>{let e=t.length*.75,i=t.length,r,n=0,s,o,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const u=new ArrayBuffer(e),c=new Uint8Array(u);for(r=0;r<i;r+=4)s=Yx[t.charCodeAt(r)],o=Yx[t.charCodeAt(r+1)],a=Yx[t.charCodeAt(r+2)],l=Yx[t.charCodeAt(r+3)],c[n++]=s<<2|o>>4,c[n++]=(o&15)<<4|a>>2,c[n++]=(a&3)<<6|l&63;return u},VNe=typeof ArrayBuffer=="function",v4=(t,e)=>{if(typeof t!="string")return{type:"message",data:vre(t,e)};const i=t.charAt(0);return i==="b"?{type:"message",data:jNe(t.substring(1),e)}:JM[i]?t.length>1?{type:JM[i],data:t.substring(1)}:{type:JM[i]}:aU},jNe=(t,e)=>{if(VNe){const i=GNe(t);return vre(i,e)}else return{base64:!0,data:t}},vre=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},bre=String.fromCharCode(30),WNe=(t,e)=>{const i=t.length,r=new Array(i);let n=0;t.forEach((s,o)=>{y4(s,!1,a=>{r[o]=a,++n===i&&e(r.join(bre))})})},qNe=(t,e)=>{const i=t.split(bre),r=[];for(let n=0;n<i.length;n++){const s=v4(i[n],e);if(r.push(s),s.type==="error")break}return r};function XNe(){return new TransformStream({transform(t,e){HNe(t,i=>{const r=i.length;let n;if(r<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,r);else if(r<65536){n=new Uint8Array(3);const s=new DataView(n.buffer);s.setUint8(0,126),s.setUint16(1,r)}else{n=new Uint8Array(9);const s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(r))}t.data&&typeof t.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(i)})}})}let q3;function hE(t){return t.reduce((e,i)=>e+i.length,0)}function cE(t,e){if(t[0].length===e)return t.shift();const i=new Uint8Array(e);let r=0;for(let n=0;n<e;n++)i[n]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),i}function YNe(t,e){q3||(q3=new TextDecoder);const i=[];let r=0,n=-1,s=!1;return new TransformStream({transform(o,a){for(i.push(o);;){if(r===0){if(hE(i)<1)break;const l=cE(i,1);s=(l[0]&128)===128,n=l[0]&127,n<126?r=3:n===126?r=1:r=2}else if(r===1){if(hE(i)<2)break;const l=cE(i,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(hE(i)<8)break;const l=cE(i,8),u=new DataView(l.buffer,l.byteOffset,l.length),c=u.getUint32(0);if(c>Math.pow(2,53-32)-1){a.enqueue(aU);break}n=c*Math.pow(2,32)+u.getUint32(4),r=3}else{if(hE(i)<n)break;const l=cE(i,n);a.enqueue(v4(s?l:q3.decode(l),e)),r=0}if(n===0||n>t){a.enqueue(aU);break}}}})}const xre=4;function Hn(t){if(t)return KNe(t)}function KNe(t){for(var e in Hn.prototype)t[e]=Hn.prototype[e];return t}Hn.prototype.on=Hn.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Hn.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this};Hn.prototype.off=Hn.prototype.removeListener=Hn.prototype.removeAllListeners=Hn.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,n=0;n<i.length;n++)if(r=i[n],r===e||r.fn===e){i.splice(n,1);break}return i.length===0&&delete this._callbacks["$"+t],this};Hn.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(i){i=i.slice(0);for(var r=0,n=i.length;r<n;++r)i[r].apply(this,e)}return this};Hn.prototype.emitReserved=Hn.prototype.emit;Hn.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Hn.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Cl=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function wre(t,...e){return e.reduce((i,r)=>(t.hasOwnProperty(r)&&(i[r]=t[r]),i),{})}const JNe=Cl.setTimeout,QNe=Cl.clearTimeout;function tT(t,e){e.useNativeTimers?(t.setTimeoutFn=JNe.bind(Cl),t.clearTimeoutFn=QNe.bind(Cl)):(t.setTimeoutFn=Cl.setTimeout.bind(Cl),t.clearTimeoutFn=Cl.clearTimeout.bind(Cl))}const ZNe=1.33;function $Ne(t){return typeof t=="string"?eFe(t):Math.ceil((t.byteLength||t.size)*ZNe)}function eFe(t){let e=0,i=0;for(let r=0,n=t.length;r<n;r++)e=t.charCodeAt(r),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(r++,i+=4);return i}function tFe(t){let e="";for(let i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e}function iFe(t){let e={},i=t.split("&");for(let r=0,n=i.length;r<n;r++){let s=i[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class rFe extends Error{constructor(e,i,r){super(e),this.description=i,this.context=r,this.type="TransportError"}}class b4 extends Hn{constructor(e){super(),this.writable=!1,tT(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,i,r){return super.emitReserved("error",new rFe(e,i,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const i=v4(e,this.socket.binaryType);this.onPacket(i)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,i={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(i)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const i=tFe(e);return i.length?"?"+i:""}}const _re="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),lU=64,nFe={};let l7=0,dE=0,u7;function h7(t){let e="";do e=_re[t%lU]+e,t=Math.floor(t/lU);while(t>0);return e}function Sre(){const t=h7(+new Date);return t!==u7?(l7=0,u7=t):t+"."+h7(l7++)}for(;dE<lU;dE++)nFe[_re[dE]]=dE;let Are=!1;try{Are=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const sFe=Are;function Ere(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||sFe))return new XMLHttpRequest}catch{}if(!e)try{return new Cl[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function oFe(){}const aFe=function(){return new Ere({xdomain:!1}).responseType!=null}();class lFe extends b4{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}const i=e&&e.forceBase64;this.supportsBinary=aFe&&!i,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const i=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||i()})),this.writable||(r++,this.once("drain",function(){--r||i()}))}else i()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const i=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};qNe(e,this.socket.binaryType).forEach(i),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,WNe(e,i=>{this.doWrite(i,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",i=this.query||{};return this.opts.timestampRequests!==!1&&(i[this.opts.timestampParam]=Sre()),!this.supportsBinary&&!i.sid&&(i.b64=1),this.createUri(e,i)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new zv(this.uri(),e)}doWrite(e,i){const r=this.request({method:"POST",data:e});r.on("success",i),r.on("error",(n,s)=>{this.onError("xhr post error",n,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(i,r)=>{this.onError("xhr poll error",i,r)}),this.pollXhr=e}}let zv=class QM extends Hn{constructor(e,i){super(),tT(this,i),this.opts=i,this.method=i.method||"GET",this.uri=e,this.data=i.data!==void 0?i.data:null,this.create()}create(){var e;const i=wre(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this.opts.xd;const r=this.xhr=new Ere(i);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var n;r.readyState===3&&((n=this.opts.cookieJar)===null||n===void 0||n.parseCookies(r)),r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=QM.requestsCount++,QM.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=oFe,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete QM.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};zv.requestsCount=0;zv.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",c7);else if(typeof addEventListener=="function"){const t="onpagehide"in Cl?"pagehide":"unload";addEventListener(t,c7,!1)}}function c7(){for(let t in zv.requests)zv.requests.hasOwnProperty(t)&&zv.requests[t].abort()}const x4=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,i)=>i(e,0))(),pE=Cl.WebSocket||Cl.MozWebSocket,d7=!0,uFe="arraybuffer",p7=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class hFe extends b4{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),i=this.opts.protocols,r=p7?{}:wre(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=d7&&!p7?i?new pE(e,i):new pE(e):new pE(e,i,r)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let i=0;i<e.length;i++){const r=e[i],n=i===e.length-1;y4(r,this.supportsBinary,s=>{const o={};try{d7&&this.ws.send(s)}catch{}n&&x4(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",i=this.query||{};return this.opts.timestampRequests&&(i[this.opts.timestampParam]=Sre()),this.supportsBinary||(i.b64=1),this.createUri(e,i)}check(){return!!pE}}class cFe extends b4{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const i=YNe(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(i).getReader(),n=XNe();n.readable.pipeTo(e.writable),this.writer=n.writable.getWriter();const s=()=>{r.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let i=0;i<e.length;i++){const r=e[i],n=i===e.length-1;this.writer.write(r).then(()=>{n&&x4(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const dFe={websocket:hFe,webtransport:cFe,polling:lFe},pFe=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fFe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function uU(t){if(t.length>2e3)throw"URI too long";const e=t,i=t.indexOf("["),r=t.indexOf("]");i!=-1&&r!=-1&&(t=t.substring(0,i)+t.substring(i,r).replace(/:/g,";")+t.substring(r,t.length));let n=pFe.exec(t||""),s={},o=14;for(;o--;)s[fFe[o]]=n[o]||"";return i!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=mFe(s,s.path),s.queryKey=gFe(s,s.query),s}function mFe(t,e){const i=/\/{2,9}/g,r=e.replace(i,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function gFe(t,e){const i={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,n,s){n&&(i[n]=s)}),i}let Mre=class Vy extends Hn{constructor(e,i={}){super(),this.binaryType=uFe,this.writeBuffer=[],e&&typeof e=="object"&&(i=e,e=null),e?(e=uU(e),i.hostname=e.host,i.secure=e.protocol==="https"||e.protocol==="wss",i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=uU(i.host).host),tT(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=iFe(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const i=Object.assign({},this.opts.query);i.EIO=xre,i.transport=e,this.id&&(i.sid=this.id);const r=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new dFe[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Vy.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",i=>this.onClose("transport close",i))}probe(e){let i=this.createTransport(e),r=!1;Vy.priorWebsocketSuccess=!1;const n=()=>{r||(i.send([{type:"ping",data:"probe"}]),i.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;Vy.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(c(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const d=new Error("probe error");d.transport=i.name,this.emitReserved("upgradeError",d)}}))};function s(){r||(r=!0,c(),i.close(),i=null)}const o=h=>{const d=new Error("probe error: "+h);d.transport=i.name,s(),this.emitReserved("upgradeError",d)};function a(){o("transport closed")}function l(){o("socket closed")}function u(h){i&&h.name!==i.name&&s()}const c=()=>{i.removeListener("open",n),i.removeListener("error",o),i.removeListener("close",a),this.off("close",l),this.off("upgrading",u)};i.once("open",n),i.once("error",o),i.once("close",a),this.once("close",l),this.once("upgrading",u),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||i.open()},200):i.open()}onOpen(){if(this.readyState="open",Vy.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const i=this.upgrades.length;for(;e<i;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const i=new Error("server error");i.code=e.data,this.onError(i);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let r=0;r<this.writeBuffer.length;r++){const n=this.writeBuffer[r].data;if(n&&(i+=$Ne(n)),r>0&&i>this.maxPayload)return this.writeBuffer.slice(0,r);i+=2}return this.writeBuffer}write(e,i,r){return this.sendPacket("message",e,i,r),this}send(e,i,r){return this.sendPacket("message",e,i,r),this}sendPacket(e,i,r,n){if(typeof i=="function"&&(n=i,i=void 0),typeof r=="function"&&(n=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:i,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),e()},r=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){Vy.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,i){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const i=[];let r=0;const n=e.length;for(;r<n;r++)~this.transports.indexOf(e[r])&&i.push(e[r]);return i}};Mre.protocol=xre;function yFe(t,e="",i){let r=t;i=i||typeof location<"u"&&location,t==null&&(t=i.protocol+"//"+i.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=i.protocol+t:t=i.host+t),/^(https?|wss?):\/\//.test(t)||(typeof i<"u"?t=i.protocol+"//"+t:t="https://"+t),r=uU(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(i&&i.port===r.port?"":":"+r.port),r}const vFe=typeof ArrayBuffer=="function",bFe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Cre=Object.prototype.toString,xFe=typeof Blob=="function"||typeof Blob<"u"&&Cre.call(Blob)==="[object BlobConstructor]",wFe=typeof File=="function"||typeof File<"u"&&Cre.call(File)==="[object FileConstructor]";function w4(t){return vFe&&(t instanceof ArrayBuffer||bFe(t))||xFe&&t instanceof Blob||wFe&&t instanceof File}function ZM(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let i=0,r=t.length;i<r;i++)if(ZM(t[i]))return!0;return!1}if(w4(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return ZM(t.toJSON(),!0);for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&ZM(t[i]))return!0;return!1}function _Fe(t){const e=[],i=t.data,r=t;return r.data=hU(i,e),r.attachments=e.length,{packet:r,buffers:e}}function hU(t,e){if(!t)return t;if(w4(t)){const i={_placeholder:!0,num:e.length};return e.push(t),i}else if(Array.isArray(t)){const i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=hU(t[r],e);return i}else if(typeof t=="object"&&!(t instanceof Date)){const i={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=hU(t[r],e));return i}return t}function SFe(t,e){return t.data=cU(t.data,e),delete t.attachments,t}function cU(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let i=0;i<t.length;i++)t[i]=cU(t[i],e);else if(typeof t=="object")for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=cU(t[i],e));return t}const AFe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],EFe=5;var Oi;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Oi||(Oi={}));class MFe{constructor(e){this.replacer=e}encode(e){return(e.type===Oi.EVENT||e.type===Oi.ACK)&&ZM(e)?this.encodeAsBinary({type:e.type===Oi.EVENT?Oi.BINARY_EVENT:Oi.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let i=""+e.type;return(e.type===Oi.BINARY_EVENT||e.type===Oi.BINARY_ACK)&&(i+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(i+=e.nsp+","),e.id!=null&&(i+=e.id),e.data!=null&&(i+=JSON.stringify(e.data,this.replacer)),i}encodeAsBinary(e){const i=_Fe(e),r=this.encodeAsString(i.packet),n=i.buffers;return n.unshift(r),n}}function f7(t){return Object.prototype.toString.call(t)==="[object Object]"}class _4 extends Hn{constructor(e){super(),this.reviver=e}add(e){let i;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(e);const r=i.type===Oi.BINARY_EVENT;r||i.type===Oi.BINARY_ACK?(i.type=r?Oi.EVENT:Oi.ACK,this.reconstructor=new CFe(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(w4(e)||e.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(e),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let i=0;const r={type:Number(e.charAt(0))};if(Oi[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===Oi.BINARY_EVENT||r.type===Oi.BINARY_ACK){const s=i+1;for(;e.charAt(++i)!=="-"&&i!=e.length;);const o=e.substring(s,i);if(o!=Number(o)||e.charAt(i)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(i+1)==="/"){const s=i+1;for(;++i&&!(e.charAt(i)===","||i===e.length););r.nsp=e.substring(s,i)}else r.nsp="/";const n=e.charAt(i+1);if(n!==""&&Number(n)==n){const s=i+1;for(;++i;){const o=e.charAt(i);if(o==null||Number(o)!=o){--i;break}if(i===e.length)break}r.id=Number(e.substring(s,i+1))}if(e.charAt(++i)){const s=this.tryParse(e.substr(i));if(_4.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,i){switch(e){case Oi.CONNECT:return f7(i);case Oi.DISCONNECT:return i===void 0;case Oi.CONNECT_ERROR:return typeof i=="string"||f7(i);case Oi.EVENT:case Oi.BINARY_EVENT:return Array.isArray(i)&&(typeof i[0]=="number"||typeof i[0]=="string"&&AFe.indexOf(i[0])===-1);case Oi.ACK:case Oi.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class CFe{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const i=SFe(this.reconPack,this.buffers);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const PFe=Object.freeze(Object.defineProperty({__proto__:null,Decoder:_4,Encoder:MFe,get PacketType(){return Oi},protocol:EFe},Symbol.toStringTag,{value:"Module"}));function hu(t,e,i){return t.on(e,i),function(){t.off(e,i)}}const TFe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Pre extends Hn{constructor(e,i,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=i,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[hu(e,"open",this.onopen.bind(this)),hu(e,"packet",this.onpacket.bind(this)),hu(e,"error",this.onerror.bind(this)),hu(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...i){if(TFe.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(i.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;const r={type:Oi.EVENT,data:i};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof i[i.length-1]=="function"){const o=this.ids++,a=i.pop();this._registerAckCallback(o,a),r.id=o}const n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,i){var r;const n=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(n===void 0){this.acks[e]=i;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);i.call(this,new Error("operation has timed out"))},n);this.acks[e]=(...o)=>{this.io.clearTimeoutFn(s),i.apply(this,[null,...o])}}emitWithAck(e,...i){const r=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((n,s)=>{i.push((o,a)=>r?o?s(o):n(a):n(o)),this.emit(e,...i)})}_addToQueue(e){let i;typeof e[e.length-1]=="function"&&(i=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...s)=>r!==this._queue[0]?void 0:(n!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),i&&i(n)):(this._queue.shift(),i&&i(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const i=this._queue[0];i.pending&&!e||(i.pending=!0,i.tryCount++,this.flags=i.flags,this.emit.apply(this,i.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Oi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,i)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Oi.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Oi.EVENT:case Oi.BINARY_EVENT:this.onevent(e);break;case Oi.ACK:case Oi.BINARY_ACK:this.onack(e);break;case Oi.DISCONNECT:this.ondisconnect();break;case Oi.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const i=e.data||[];e.id!=null&&i.push(this.ack(e.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const i=this._anyListeners.slice();for(const r of i)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const i=this;let r=!1;return function(...n){r||(r=!0,i.packet({type:Oi.ACK,id:e,data:n}))}}onack(e){const i=this.acks[e.id];typeof i=="function"&&(i.apply(this,e.data),delete this.acks[e.id])}onconnect(e,i){this.id=e,this.recovered=i&&this._pid===i,this._pid=i,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Oi.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const i=this._anyListeners;for(let r=0;r<i.length;r++)if(e===i[r])return i.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const i=this._anyOutgoingListeners;for(let r=0;r<i.length;r++)if(e===i[r])return i.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const i=this._anyOutgoingListeners.slice();for(const r of i)r.apply(this,e.data)}}}function eb(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}eb.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+i:t-i}return Math.min(t,this.max)|0};eb.prototype.reset=function(){this.attempts=0};eb.prototype.setMin=function(t){this.ms=t};eb.prototype.setMax=function(t){this.max=t};eb.prototype.setJitter=function(t){this.jitter=t};class dU extends Hn{constructor(e,i){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(i=e,e=void 0),i=i||{},i.path=i.path||"/socket.io",this.opts=i,tT(this,i),this.reconnection(i.reconnection!==!1),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor((r=i.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new eb({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(i.timeout==null?2e4:i.timeout),this._readyState="closed",this.uri=e;const n=i.parser||PFe;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=i.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var i;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(i=this.backoff)===null||i===void 0||i.setMin(e),this)}randomizationFactor(e){var i;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(i=this.backoff)===null||i===void 0||i.setJitter(e),this)}reconnectionDelayMax(e){var i;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(i=this.backoff)===null||i===void 0||i.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Mre(this.uri,this.opts);const i=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const n=hu(i,"open",function(){r.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=hu(i,"error",s);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{n(),s(new Error("timeout")),i.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(hu(e,"ping",this.onping.bind(this)),hu(e,"data",this.ondata.bind(this)),hu(e,"error",this.onerror.bind(this)),hu(e,"close",this.onclose.bind(this)),hu(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(i){this.onclose("parse error",i)}}ondecoded(e){x4(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,i){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Pre(this,e,i),this.nsps[e]=r),r}_destroy(e){const i=Object.keys(this.nsps);for(const r of i)if(this.nsps[r].active)return;this._close()}_packet(e){const i=this.encoder.encode(e);for(let r=0;r<i.length;r++)this.engine.write(i[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,i){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const i=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},i);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const gx={};function $M(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const i=yFe(t,e.path||"/socket.io"),r=i.source,n=i.id,s=i.path,o=gx[n]&&s in gx[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new dU(r,e):(gx[n]||(gx[n]=new dU(r,e)),l=gx[n]),i.query&&!e.query&&(e.query=i.queryKey),l.socket(i.path,e)}Object.assign($M,{Manager:dU,Socket:Pre,io:$M,connect:$M});const Tre=se.createContext(null),RFe=()=>se.useContext(Tre),kFe=t=>{const e=se.useMemo(()=>$M("http://localhost:3000"),[]);return U.jsx(Tre.Provider,{value:e,children:t.children})},DFe=()=>{const{currentUser:t}=se.useContext(Yo),{roomid:e}=yF(),i=e,r=RFe(),n=new BNe(void 0,{host:"https://healthsync-9q0e.onrender.com",port:"9000"}),s=se.useRef(),o=se.useRef({}),[a,l]=se.useState([]),[u,c]=se.useState(!1),[h,d]=se.useState(!1),p=se.useRef({}),f=se.useRef();se.useEffect(()=>{t&&(navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(A=>{p.current=document.createElement("video"),p.current.muted=!0,f.current=A,g(p.current,A,t.username),n.on("call",S=>{S.answer(A);const E=document.createElement("video");S.on("stream",M=>{g(E,M,t.username)})}),r.on("user-connected",(S,E)=>{setTimeout(()=>m(S,A,E),1e3)})}),r.on("createMessage",(A,S)=>{console.log("created a msg");let E={username:S,message:A};l(M=>[...M,E])}),r.on("user-disconnected",A=>{o.current[A]&&o.current[A].close(),_()}),n.on("open",A=>{r.emit("join-room",i,A,t.username)}))},[t]);function m(A,S,E){const M=n.call(A,S),R=document.createElement("video");M.on("stream",C=>{g(R,C,E)}),M.on("close",()=>{R.parentNode.remove()}),o.current[A]=M}function g(A,S,E){A.srcObject=S,A.setAttribute("data-username",E),A.addEventListener("loadedmetadata",()=>{A.play()});const M=s.current;if(M){const R=document.createElement("div");R.classList.add("video-container");const C=document.createElement("span");C.innerText=E,C.classList.add("username-text");const T=document.createElement("h1");T.innerText=E,R.appendChild(A),R.appendChild(C),R.appendChild(T),M.appendChild(R)}_()}const y=A=>{A.preventDefault();const S=A.target;S.chat_message.value.length>0&&(r.emit("message",S.chat_message.value,t.username),A.target.reset())},v=()=>{const A=f.current.getAudioTracks()[0].enabled;c(!u),A?f.current.getAudioTracks()[0].enabled=!1:f.current.getAudioTracks()[0].enabled=!0},b=()=>{console.log(r);const A=f.current.getVideoTracks()[0].enabled;d(!h),A?f.current.getVideoTracks()[0].enabled=!1:f.current.getVideoTracks()[0].enabled=!0};function _(){const A=s.current;A&&A.querySelectorAll(".video-container").forEach(E=>{E.querySelector("video")||E.remove()})}return U.jsx(U.Fragment,{children:U.jsxs("div",{className:"main",children:[U.jsxs("div",{className:"main-left",children:[U.jsx("div",{className:"main-videos",children:U.jsx("div",{id:"video-grid",ref:s})}),U.jsxs("div",{className:"main-controls",children:[U.jsxs("div",{className:"controls-block",children:[U.jsx("div",{className:"controls-button",onClick:v,children:u?U.jsxs(U.Fragment,{children:[U.jsx(FNe,{className:"red",size:24}),U.jsx("span",{children:"Unmute"})]}):U.jsxs(U.Fragment,{children:[U.jsx(ONe,{size:24}),U.jsx("span",{children:"Mute"})]})}),U.jsx("div",{className:"controls-button",onClick:b,children:h?U.jsxs(U.Fragment,{children:[U.jsx(UNe,{className:"red",size:24}),U.jsx("span",{children:"Show Video"})]}):U.jsxs(U.Fragment,{children:[U.jsx(NNe,{size:24}),U.jsx("span",{children:"Stop Video"})]})})]}),U.jsx("div",{className:"controls-block",children:U.jsxs("div",{className:"controls-button",children:[U.jsx(zNe,{size:24}),U.jsx("span",{children:"Chat"})]})}),U.jsx("div",{className:"controls-block",children:U.jsx("div",{className:"controls-button",children:U.jsx("span",{className:"leave-meeting flex w-full justify-center rounded-md bg-red-600 px-3 py-3 text-sm font-semibold leading-6 text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",children:"Leave"})})})]})]}),U.jsxs("div",{className:"main-right",children:[U.jsx("div",{className:"header",children:U.jsx("h6",{children:"Chat"})}),U.jsx("div",{className:"chat-window",children:U.jsx("ul",{className:"messages",children:a.map((A,S)=>U.jsx("li",{className:"message-div",children:U.jsxs("div",{children:[U.jsx("span",{className:"chat-username",children:A.username}),U.jsx("span",{className:"chat-message",children:A.message}),U.jsx("span",{className:"chat-time",children:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})},S))})}),U.jsx("div",{className:"message-container",children:U.jsxs("form",{onSubmit:y,children:[U.jsx("input",{id:"chat_message",name:"chat_message",type:"text",placeholder:"Type message here..."}),U.jsx("button",{className:"send",children:"Send"})]})})]})]})})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const u_="161",IFe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},LFe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Rre=0,pU=1,kre=2,BFe=3,Dre=0,iT=1,vw=2,lu=3,zh=0,jo=1,Tl=2,Kc=0,xm=1,fU=2,mU=3,gU=4,Ire=5,rp=100,Lre=101,Bre=102,yU=103,vU=104,Ore=200,Ure=201,Nre=202,Fre=203,Q2=204,Z2=205,zre=206,Hre=207,Gre=208,Vre=209,jre=210,Wre=211,qre=212,Xre=213,Yre=214,Kre=0,Jre=1,Qre=2,v1=3,Zre=4,$re=5,ene=6,tne=7,h_=0,ine=1,rne=2,Rh=0,nne=1,sne=2,one=3,S4=4,ane=5,lne=6,bU="attached",une="detached",rT=300,nd=301,zp=302,b1=303,x1=304,tb=306,Hp=1e3,Hs=1001,g0=1002,an=1003,w1=1004,OFe=1004,np=1005,UFe=1005,Rr=1006,Hv=1007,NFe=1007,Il=1008,FFe=1008,kh=1009,hne=1010,cne=1011,nT=1012,A4=1013,Hc=1014,Rl=1015,y0=1016,E4=1017,M4=1018,kp=1020,dne=1021,Fo=1023,pne=1024,fne=1025,Dp=1026,Hm=1027,mne=1028,C4=1029,gne=1030,P4=1031,T4=1033,eC=33776,tC=33777,iC=33778,rC=33779,xU=35840,wU=35841,_U=35842,SU=35843,R4=36196,AU=37492,EU=37496,MU=37808,CU=37809,PU=37810,TU=37811,RU=37812,kU=37813,DU=37814,IU=37815,LU=37816,BU=37817,OU=37818,UU=37819,NU=37820,FU=37821,nC=36492,zU=36494,HU=36495,yne=36283,GU=36284,VU=36285,jU=36286,vne=2200,bne=2201,xne=2202,v0=2300,Gm=2301,sC=2302,rm=2400,nm=2401,_1=2402,sT=2500,k4=2501,wne=0,D4=1,$2=2,I4=3e3,Ip=3001,_ne=3200,Sne=3201,Jp=0,Ane=1,Oa="",es="srgb",Hh="srgb-linear",oT="display-p3",c_="display-p3-linear",S1="linear",_r="srgb",A1="rec709",E1="p3",zFe=0,Of=7680,HFe=7681,GFe=7682,VFe=7683,jFe=34055,WFe=34056,qFe=5386,XFe=512,YFe=513,KFe=514,JFe=515,QFe=516,ZFe=517,$Fe=518,WU=519,Ene=512,Mne=513,Cne=514,L4=515,Pne=516,Tne=517,Rne=518,kne=519,M1=35044,eze=35048,tze=35040,ize=35045,rze=35049,nze=35041,sze=35046,oze=35050,aze=35042,lze="100",qU="300 es",eP=1035,Sh=2e3,C1=2001;class hd{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(i)===-1&&r[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const n=r.slice(0);for(let s=0,o=n.length;s<o;s++)n[s].call(this,e);e.target=null}}}const ro=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let m7=1234567;const wm=Math.PI/180,b0=180/Math.PI;function qa(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ro[t&255]+ro[t>>8&255]+ro[t>>16&255]+ro[t>>24&255]+"-"+ro[e&255]+ro[e>>8&255]+"-"+ro[e>>16&15|64]+ro[e>>24&255]+"-"+ro[i&63|128]+ro[i>>8&255]+"-"+ro[i>>16&255]+ro[i>>24&255]+ro[r&255]+ro[r>>8&255]+ro[r>>16&255]+ro[r>>24&255]).toLowerCase()}function un(t,e,i){return Math.max(e,Math.min(i,t))}function B4(t,e){return(t%e+e)%e}function uze(t,e,i,r,n){return r+(t-e)*(n-r)/(i-e)}function hze(t,e,i){return t!==e?(i-t)/(e-t):0}function bw(t,e,i){return(1-i)*t+i*e}function cze(t,e,i,r){return bw(t,e,1-Math.exp(-i*r))}function dze(t,e=1){return e-Math.abs(B4(t,e*2)-e)}function pze(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))}function fze(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(t*6-15)+10))}function mze(t,e){return t+Math.floor(Math.random()*(e-t+1))}function gze(t,e){return t+Math.random()*(e-t)}function yze(t){return t*(.5-Math.random())}function vze(t){t!==void 0&&(m7=t);let e=m7+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function bze(t){return t*wm}function xze(t){return t*b0}function XU(t){return(t&t-1)===0&&t!==0}function wze(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function tP(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function _ze(t,e,i,r,n){const s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),u=s((e+r)/2),c=o((e+r)/2),h=s((e-r)/2),d=o((e-r)/2),p=s((r-e)/2),f=o((r-e)/2);switch(n){case"XYX":t.set(a*c,l*h,l*d,a*u);break;case"YZY":t.set(l*d,a*c,l*h,a*u);break;case"ZXZ":t.set(l*h,l*d,a*c,a*u);break;case"XZX":t.set(a*c,l*f,l*p,a*u);break;case"YXY":t.set(l*p,a*c,l*f,a*u);break;case"ZYZ":t.set(l*f,l*p,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function zo(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function wi(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Dne={DEG2RAD:wm,RAD2DEG:b0,generateUUID:qa,clamp:un,euclideanModulo:B4,mapLinear:uze,inverseLerp:hze,lerp:bw,damp:cze,pingpong:dze,smoothstep:pze,smootherstep:fze,randInt:mze,randFloat:gze,randFloatSpread:yze,seededRandom:vze,degToRad:bze,radToDeg:xze,isPowerOfTwo:XU,ceilPowerOfTwo:wze,floorPowerOfTwo:tP,setQuaternionFromProperEuler:_ze,normalize:wi,denormalize:zo};class ot{constructor(e=0,i=0){ot.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,r=this.y,n=e.elements;return this.x=n[0]*i+n[3]*r+n[6],this.y=n[1]*i+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const r=this.dot(e)/i;return Math.acos(un(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,r=this.y-e.y;return i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const r=Math.cos(i),n=Math.sin(i),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*n+e.x,this.y=s*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ei{constructor(e,i,r,n,s,o,a,l,u){Ei.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,r,n,s,o,a,l,u)}set(e,i,r,n,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=i,c[4]=s,c[5]=l,c[6]=r,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,r=e.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],this}extractBasis(e,i,r){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const r=e.elements,n=i.elements,s=this.elements,o=r[0],a=r[3],l=r[6],u=r[1],c=r[4],h=r[7],d=r[2],p=r[5],f=r[8],m=n[0],g=n[3],y=n[6],v=n[1],b=n[4],_=n[7],A=n[2],S=n[5],E=n[8];return s[0]=o*m+a*v+l*A,s[3]=o*g+a*b+l*S,s[6]=o*y+a*_+l*E,s[1]=u*m+c*v+h*A,s[4]=u*g+c*b+h*S,s[7]=u*y+c*_+h*E,s[2]=d*m+p*v+f*A,s[5]=d*g+p*b+f*S,s[8]=d*y+p*_+f*E,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return i*o*c-i*a*u-r*s*c+r*a*l+n*s*u-n*o*l}invert(){const e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=a*l-c*s,p=u*s-o*l,f=i*h+r*d+n*p;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/f;return e[0]=h*m,e[1]=(n*u-c*r)*m,e[2]=(a*r-n*o)*m,e[3]=d*m,e[4]=(c*i-n*l)*m,e[5]=(n*s-a*i)*m,e[6]=p*m,e[7]=(r*l-u*i)*m,e[8]=(o*i-r*s)*m,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,r,n,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(r*l,r*u,-r*(l*o+u*a)+o+e,-n*u,n*l,-n*(-u*o+l*a)+a+i,0,0,1),this}scale(e,i){return this.premultiply(X3.makeScale(e,i)),this}rotate(e){return this.premultiply(X3.makeRotation(-e)),this}translate(e,i){return this.premultiply(X3.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),r=Math.sin(e);return this.set(i,-r,0,r,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,r=e.elements;for(let n=0;n<9;n++)if(i[n]!==r[n])return!1;return!0}fromArray(e,i=0){for(let r=0;r<9;r++)this.elements[r]=e[r+i];return this}toArray(e=[],i=0){const r=this.elements;return e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7],e[i+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const X3=new Ei;function Ine(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Sze={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dv(t,e){return new Sze[t](e)}function P1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Lne(){const t=P1("canvas");return t.style.display="block",t}const g7={};function _m(t){t in g7||(g7[t]=!0,console.warn(t))}const y7=new Ei().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),v7=new Ei().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),fE={[Hh]:{transfer:S1,primaries:A1,toReference:t=>t,fromReference:t=>t},[es]:{transfer:_r,primaries:A1,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[c_]:{transfer:S1,primaries:E1,toReference:t=>t.applyMatrix3(v7),fromReference:t=>t.applyMatrix3(y7)},[oT]:{transfer:_r,primaries:E1,toReference:t=>t.convertSRGBToLinear().applyMatrix3(v7),fromReference:t=>t.applyMatrix3(y7).convertLinearToSRGB()}},Aze=new Set([Hh,c_]),or={enabled:!0,_workingColorSpace:Hh,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Aze.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,i){if(this.enabled===!1||e===i||!e||!i)return t;const r=fE[e].toReference,n=fE[i].fromReference;return n(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return fE[t].primaries},getTransfer:function(t){return t===Oa?S1:fE[t].transfer}};function Gv(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Y3(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let ly;class O4{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{ly===void 0&&(ly=P1("canvas")),ly.width=e.width,ly.height=e.height;const r=ly.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=ly}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=P1("canvas");i.width=e.width,i.height=e.height;const r=i.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),s=n.data;for(let o=0;o<s.length;o++)s[o]=Gv(s[o]/255)*255;return r.putImageData(n,0,0),i}else if(e.data){const i=e.data.slice(0);for(let r=0;r<i.length;r++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[r]=Math.floor(Gv(i[r]/255)*255):i[r]=Gv(i[r]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Eze=0;class sm{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Eze++}),this.uuid=qa(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let o=0,a=n.length;o<a;o++)n[o].isDataTexture?s.push(K3(n[o].image)):s.push(K3(n[o]))}else s=K3(n);r.url=s}return i||(e.images[this.uuid]=r),r}}function K3(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?O4.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Mze=0;class Ir extends hd{constructor(e=Ir.DEFAULT_IMAGE,i=Ir.DEFAULT_MAPPING,r=Hs,n=Hs,s=Rr,o=Il,a=Fo,l=kh,u=Ir.DEFAULT_ANISOTROPY,c=Oa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Mze++}),this.uuid=qa(),this.name="",this.source=new sm(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new ot(0,0),this.repeat=new ot(1,1),this.center=new ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ei,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof c=="string"?this.colorSpace=c:(_m("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=c===Ip?es:Oa),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==rT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Hp:e.x=e.x-Math.floor(e.x);break;case Hs:e.x=e.x<0?0:1;break;case g0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Hp:e.y=e.y-Math.floor(e.y);break;case Hs:e.y=e.y<0?0:1;break;case g0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return _m("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===es?Ip:I4}set encoding(e){_m("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Ip?es:Oa}}Ir.DEFAULT_IMAGE=null;Ir.DEFAULT_MAPPING=rT;Ir.DEFAULT_ANISOTROPY=1;class lr{constructor(e=0,i=0,r=0,n=1){lr.prototype.isVector4=!0,this.x=e,this.y=i,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,r,n){return this.x=e,this.y=i,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,r=this.y,n=this.z,s=this.w,o=e.elements;return this.x=o[0]*i+o[4]*r+o[8]*n+o[12]*s,this.y=o[1]*i+o[5]*r+o[9]*n+o[13]*s,this.z=o[2]*i+o[6]*r+o[10]*n+o[14]*s,this.w=o[3]*i+o[7]*r+o[11]*n+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,r,n,s;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],p=l[5],f=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-m)<.01&&Math.abs(f-g)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+m)<.1&&Math.abs(f+g)<.1&&Math.abs(u+p+y-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const b=(u+1)/2,_=(p+1)/2,A=(y+1)/2,S=(c+d)/4,E=(h+m)/4,M=(f+g)/4;return b>_&&b>A?b<.01?(r=0,n=.707106781,s=.707106781):(r=Math.sqrt(b),n=S/r,s=E/r):_>A?_<.01?(r=.707106781,n=0,s=.707106781):(n=Math.sqrt(_),r=S/n,s=M/n):A<.01?(r=.707106781,n=.707106781,s=0):(s=Math.sqrt(A),r=E/s,n=M/s),this.set(r,n,s,i),this}let v=Math.sqrt((g-f)*(g-f)+(h-m)*(h-m)+(d-c)*(d-c));return Math.abs(v)<.001&&(v=1),this.x=(g-f)/v,this.y=(h-m)/v,this.z=(d-c)/v,this.w=Math.acos((u+p+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this.z=e.z+(i.z-e.z)*r,this.w=e.w+(i.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Bne extends hd{constructor(e=1,i=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new lr(0,0,e,i),this.scissorTest=!1,this.viewport=new lr(0,0,e,i);const n={width:e,height:i,depth:1};r.encoding!==void 0&&(_m("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Ip?es:Oa),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Rr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new Ir(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,i,r=1){(this.width!==e||this.height!==i||this.depth!==r)&&(this.width=e,this.height=i,this.depth=r,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new sm(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Tu extends Bne{constructor(e=1,i=1,r={}){super(e,i,r),this.isWebGLRenderTarget=!0}}class aT extends Ir{constructor(e=null,i=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:r,depth:n},this.magFilter=an,this.minFilter=an,this.wrapR=Hs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Cze extends Tu{constructor(e=1,i=1,r=1,n={}){super(e,i,n),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new aT(null,e,i,r),this.texture.isRenderTargetTexture=!0}}class U4 extends Ir{constructor(e=null,i=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:r,depth:n},this.magFilter=an,this.minFilter=an,this.wrapR=Hs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Pze extends Tu{constructor(e=1,i=1,r=1,n={}){super(e,i,n),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new U4(null,e,i,r),this.texture.isRenderTargetTexture=!0}}class Tze extends Tu{constructor(e=1,i=1,r=1,n={}){super(e,i,n),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,i,r=1){if(this.width!==e||this.height!==i||this.depth!==r){this.width=e,this.height=i,this.depth=r;for(let n=0,s=this.texture.length;n<s;n++)this.texture[n].image.width=e,this.texture[n].image.height=i,this.texture[n].image.depth=r;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let i=0,r=e.texture.length;i<r;i++)this.texture[i]=e.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class go{constructor(e=0,i=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=r,this._w=n}static slerpFlat(e,i,r,n,s,o,a){let l=r[n+0],u=r[n+1],c=r[n+2],h=r[n+3];const d=s[o+0],p=s[o+1],f=s[o+2],m=s[o+3];if(a===0){e[i+0]=l,e[i+1]=u,e[i+2]=c,e[i+3]=h;return}if(a===1){e[i+0]=d,e[i+1]=p,e[i+2]=f,e[i+3]=m;return}if(h!==m||l!==d||u!==p||c!==f){let g=1-a;const y=l*d+u*p+c*f+h*m,v=y>=0?1:-1,b=1-y*y;if(b>Number.EPSILON){const A=Math.sqrt(b),S=Math.atan2(A,y*v);g=Math.sin(g*S)/A,a=Math.sin(a*S)/A}const _=a*v;if(l=l*g+d*_,u=u*g+p*_,c=c*g+f*_,h=h*g+m*_,g===1-a){const A=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=A,u*=A,c*=A,h*=A}}e[i]=l,e[i+1]=u,e[i+2]=c,e[i+3]=h}static multiplyQuaternionsFlat(e,i,r,n,s,o){const a=r[n],l=r[n+1],u=r[n+2],c=r[n+3],h=s[o],d=s[o+1],p=s[o+2],f=s[o+3];return e[i]=a*f+c*h+l*p-u*d,e[i+1]=l*f+c*d+u*h-a*p,e[i+2]=u*f+c*p+a*d-l*h,e[i+3]=c*f-a*h-l*d-u*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,r,n){return this._x=e,this._y=i,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){const r=e._x,n=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(r/2),c=a(n/2),h=a(s/2),d=l(r/2),p=l(n/2),f=l(s/2);switch(o){case"XYZ":this._x=d*c*h+u*p*f,this._y=u*p*h-d*c*f,this._z=u*c*f+d*p*h,this._w=u*c*h-d*p*f;break;case"YXZ":this._x=d*c*h+u*p*f,this._y=u*p*h-d*c*f,this._z=u*c*f-d*p*h,this._w=u*c*h+d*p*f;break;case"ZXY":this._x=d*c*h-u*p*f,this._y=u*p*h+d*c*f,this._z=u*c*f+d*p*h,this._w=u*c*h-d*p*f;break;case"ZYX":this._x=d*c*h-u*p*f,this._y=u*p*h+d*c*f,this._z=u*c*f-d*p*h,this._w=u*c*h+d*p*f;break;case"YZX":this._x=d*c*h+u*p*f,this._y=u*p*h+d*c*f,this._z=u*c*f-d*p*h,this._w=u*c*h-d*p*f;break;case"XZY":this._x=d*c*h-u*p*f,this._y=u*p*h-d*c*f,this._z=u*c*f+d*p*h,this._w=u*c*h+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const r=i/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,r=i[0],n=i[4],s=i[8],o=i[1],a=i[5],l=i[9],u=i[2],c=i[6],h=i[10],d=r+a+h;if(d>0){const p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(c-l)*p,this._y=(s-u)*p,this._z=(o-n)*p}else if(r>a&&r>h){const p=2*Math.sqrt(1+r-a-h);this._w=(c-l)/p,this._x=.25*p,this._y=(n+o)/p,this._z=(s+u)/p}else if(a>h){const p=2*Math.sqrt(1+a-r-h);this._w=(s-u)/p,this._x=(n+o)/p,this._y=.25*p,this._z=(l+c)/p}else{const p=2*Math.sqrt(1+h-r-a);this._w=(o-n)/p,this._x=(s+u)/p,this._y=(l+c)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let r=e.dot(i)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(un(this.dot(e),-1,1)))}rotateTowards(e,i){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,i/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const r=e._x,n=e._y,s=e._z,o=e._w,a=i._x,l=i._y,u=i._z,c=i._w;return this._x=r*c+o*a+n*u-s*l,this._y=n*c+o*l+s*a-r*u,this._z=s*c+o*u+r*l-n*a,this._w=o*c-r*a-n*l-s*u,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const r=this._x,n=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+n*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=n,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const p=1-i;return this._w=p*o+i*this._w,this._x=p*r+i*this._x,this._y=p*n+i*this._y,this._z=p*s+i*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-i)*c)/u,d=Math.sin(i*c)/u;return this._w=o*h+this._w*d,this._x=r*h+this._x*d,this._y=n*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,r){return this.copy(e).slerp(i,r)}random(){const e=Math.random(),i=Math.sqrt(1-e),r=Math.sqrt(e),n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(n),r*Math.sin(s),r*Math.cos(s),i*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ue{constructor(e=0,i=0,r=0){ue.prototype.isVector3=!0,this.x=e,this.y=i,this.z=r}set(e,i,r){return r===void 0&&(r=this.z),this.x=e,this.y=i,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(b7.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(b7.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[3]*r+s[6]*n,this.y=s[1]*i+s[4]*r+s[7]*n,this.z=s[2]*i+s[5]*r+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,r=this.y,n=this.z,s=e.elements,o=1/(s[3]*i+s[7]*r+s[11]*n+s[15]);return this.x=(s[0]*i+s[4]*r+s[8]*n+s[12])*o,this.y=(s[1]*i+s[5]*r+s[9]*n+s[13])*o,this.z=(s[2]*i+s[6]*r+s[10]*n+s[14])*o,this}applyQuaternion(e){const i=this.x,r=this.y,n=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*n-a*r),c=2*(a*i-s*n),h=2*(s*r-o*i);return this.x=i+l*u+o*h-a*c,this.y=r+l*c+a*u-s*h,this.z=n+l*h+s*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[4]*r+s[8]*n,this.y=s[1]*i+s[5]*r+s[9]*n,this.z=s[2]*i+s[6]*r+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this.z=e.z+(i.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const r=e.x,n=e.y,s=e.z,o=i.x,a=i.y,l=i.z;return this.x=n*l-s*a,this.y=s*o-r*l,this.z=r*a-n*o,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const r=e.dot(this)/i;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return J3.copy(this).projectOnVector(e),this.sub(J3)}reflect(e){return this.sub(J3.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const r=this.dot(e)/i;return Math.acos(un(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return i*i+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,r){const n=Math.sin(i)*e;return this.x=n*Math.sin(r),this.y=Math.cos(i)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,r){return this.x=e*Math.sin(i),this.y=r,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=r,this.z=n,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(i),this.y=r*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const J3=new ue,b7=new go;class yo{constructor(e=new ue(1/0,1/0,1/0),i=new ue(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,r=e.length;i<r;i+=3)this.expandByPoint(nu.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,r=e.count;i<r;i++)this.expandByPoint(nu.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,r=e.length;i<r;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const r=nu.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(i===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,nu):nu.fromBufferAttribute(s,o),nu.applyMatrix4(e.matrixWorld),this.expandByPoint(nu);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),mE.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),mE.copy(r.boundingBox)),mE.applyMatrix4(e.matrixWorld),this.union(mE)}const n=e.children;for(let s=0,o=n.length;s<o;s++)this.expandByObject(n[s],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,nu),nu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,r;return e.normal.x>0?(i=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),i<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(yx),gE.subVectors(this.max,yx),uy.subVectors(e.a,yx),hy.subVectors(e.b,yx),cy.subVectors(e.c,yx),Od.subVectors(hy,uy),Ud.subVectors(cy,hy),yf.subVectors(uy,cy);let i=[0,-Od.z,Od.y,0,-Ud.z,Ud.y,0,-yf.z,yf.y,Od.z,0,-Od.x,Ud.z,0,-Ud.x,yf.z,0,-yf.x,-Od.y,Od.x,0,-Ud.y,Ud.x,0,-yf.y,yf.x,0];return!Q3(i,uy,hy,cy,gE)||(i=[1,0,0,0,1,0,0,0,1],!Q3(i,uy,hy,cy,gE))?!1:(yE.crossVectors(Od,Ud),i=[yE.x,yE.y,yE.z],Q3(i,uy,hy,cy,gE))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,nu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(nu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(fc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const fc=[new ue,new ue,new ue,new ue,new ue,new ue,new ue,new ue],nu=new ue,mE=new yo,uy=new ue,hy=new ue,cy=new ue,Od=new ue,Ud=new ue,yf=new ue,yx=new ue,gE=new ue,yE=new ue,vf=new ue;function Q3(t,e,i,r,n){for(let s=0,o=t.length-3;s<=o;s+=3){vf.fromArray(t,s);const a=n.x*Math.abs(vf.x)+n.y*Math.abs(vf.y)+n.z*Math.abs(vf.z),l=e.dot(vf),u=i.dot(vf),c=r.dot(vf);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const Rze=new yo,vx=new ue,Z3=new ue;class qs{constructor(e=new ue,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const r=this.center;i!==void 0?r.copy(i):Rze.setFromPoints(e).getCenter(r);let n=0;for(let s=0,o=e.length;s<o;s++)n=Math.max(n,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const r=this.center.distanceToSquared(e);return i.copy(e),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;vx.subVectors(e,this.center);const i=vx.lengthSq();if(i>this.radius*this.radius){const r=Math.sqrt(i),n=(r-this.radius)*.5;this.center.addScaledVector(vx,n/r),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Z3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(vx.copy(e.center).add(Z3)),this.expandByPoint(vx.copy(e.center).sub(Z3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const mc=new ue,$3=new ue,vE=new ue,Nd=new ue,eI=new ue,bE=new ue,tI=new ue;class ib{constructor(e=new ue,i=new ue(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,mc)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const r=i.dot(this.direction);return r<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=mc.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(mc.copy(this.origin).addScaledVector(this.direction,i),mc.distanceToSquared(e))}distanceSqToSegment(e,i,r,n){$3.copy(e).add(i).multiplyScalar(.5),vE.copy(i).sub(e).normalize(),Nd.copy(this.origin).sub($3);const s=e.distanceTo(i)*.5,o=-this.direction.dot(vE),a=Nd.dot(this.direction),l=-Nd.dot(vE),u=Nd.lengthSq(),c=Math.abs(1-o*o);let h,d,p,f;if(c>0)if(h=o*l-a,d=o*a-l,f=s*c,h>=0)if(d>=-f)if(d<=f){const m=1/c;h*=m,d*=m,p=h*(h+o*d+2*a)+d*(o*h+d+2*l)+u}else d=s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+u;else d=-s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+u;else d<=-f?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+u):d<=f?(h=0,d=Math.min(Math.max(-s,-l),s),p=d*(d+2*l)+u):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+u);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),p=-h*h+d*(d+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,h),n&&n.copy($3).addScaledVector(vE,d),p}intersectSphere(e,i){mc.subVectors(e.center,this.origin);const r=mc.dot(this.direction),n=mc.dot(mc)-r*r,s=e.radius*e.radius;if(n>s)return null;const o=Math.sqrt(s-n),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/i;return r>=0?r:null}intersectPlane(e,i){const r=this.distanceToPlane(e);return r===null?null:this.at(r,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let r,n,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,n=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,n=(e.min.x-d.x)*u),c>=0?(s=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(s=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),r>o||s>n||((s>r||isNaN(r))&&(r=s),(o<n||isNaN(n))&&(n=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),r>l||a>n)||((a>r||r!==r)&&(r=a),(l<n||n!==n)&&(n=l),n<0)?null:this.at(r>=0?r:n,i)}intersectsBox(e){return this.intersectBox(e,mc)!==null}intersectTriangle(e,i,r,n,s){eI.subVectors(i,e),bE.subVectors(r,e),tI.crossVectors(eI,bE);let o=this.direction.dot(tI),a;if(o>0){if(n)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Nd.subVectors(this.origin,e);const l=a*this.direction.dot(bE.crossVectors(Nd,bE));if(l<0)return null;const u=a*this.direction.dot(eI.cross(Nd));if(u<0||l+u>o)return null;const c=-a*Nd.dot(tI);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ii{constructor(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g){ii.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g)}set(e,i,r,n,s,o,a,l,u,c,h,d,p,f,m,g){const y=this.elements;return y[0]=e,y[4]=i,y[8]=r,y[12]=n,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=u,y[6]=c,y[10]=h,y[14]=d,y[3]=p,y[7]=f,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ii().fromArray(this.elements)}copy(e){const i=this.elements,r=e.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this}copyPosition(e){const i=this.elements,r=e.elements;return i[12]=r[12],i[13]=r[13],i[14]=r[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,r){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,i,r){return this.set(e.x,i.x,r.x,0,e.y,i.y,r.y,0,e.z,i.z,r.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,r=e.elements,n=1/dy.setFromMatrixColumn(e,0).length(),s=1/dy.setFromMatrixColumn(e,1).length(),o=1/dy.setFromMatrixColumn(e,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[3]=0,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=0,i[8]=r[8]*o,i[9]=r[9]*o,i[10]=r[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,r=e.x,n=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(n),u=Math.sin(n),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*c,p=o*h,f=a*c,m=a*h;i[0]=l*c,i[4]=-l*h,i[8]=u,i[1]=p+f*u,i[5]=d-m*u,i[9]=-a*l,i[2]=m-d*u,i[6]=f+p*u,i[10]=o*l}else if(e.order==="YXZ"){const d=l*c,p=l*h,f=u*c,m=u*h;i[0]=d+m*a,i[4]=f*a-p,i[8]=o*u,i[1]=o*h,i[5]=o*c,i[9]=-a,i[2]=p*a-f,i[6]=m+d*a,i[10]=o*l}else if(e.order==="ZXY"){const d=l*c,p=l*h,f=u*c,m=u*h;i[0]=d-m*a,i[4]=-o*h,i[8]=f+p*a,i[1]=p+f*a,i[5]=o*c,i[9]=m-d*a,i[2]=-o*u,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){const d=o*c,p=o*h,f=a*c,m=a*h;i[0]=l*c,i[4]=f*u-p,i[8]=d*u+m,i[1]=l*h,i[5]=m*u+d,i[9]=p*u-f,i[2]=-u,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){const d=o*l,p=o*u,f=a*l,m=a*u;i[0]=l*c,i[4]=m-d*h,i[8]=f*h+p,i[1]=h,i[5]=o*c,i[9]=-a*c,i[2]=-u*c,i[6]=p*h+f,i[10]=d-m*h}else if(e.order==="XZY"){const d=o*l,p=o*u,f=a*l,m=a*u;i[0]=l*c,i[4]=-h,i[8]=u*c,i[1]=d*h+m,i[5]=o*c,i[9]=p*h-f,i[2]=f*h-p,i[6]=a*c,i[10]=m*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kze,e,Dze)}lookAt(e,i,r){const n=this.elements;return ka.subVectors(e,i),ka.lengthSq()===0&&(ka.z=1),ka.normalize(),Fd.crossVectors(r,ka),Fd.lengthSq()===0&&(Math.abs(r.z)===1?ka.x+=1e-4:ka.z+=1e-4,ka.normalize(),Fd.crossVectors(r,ka)),Fd.normalize(),xE.crossVectors(ka,Fd),n[0]=Fd.x,n[4]=xE.x,n[8]=ka.x,n[1]=Fd.y,n[5]=xE.y,n[9]=ka.y,n[2]=Fd.z,n[6]=xE.z,n[10]=ka.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const r=e.elements,n=i.elements,s=this.elements,o=r[0],a=r[4],l=r[8],u=r[12],c=r[1],h=r[5],d=r[9],p=r[13],f=r[2],m=r[6],g=r[10],y=r[14],v=r[3],b=r[7],_=r[11],A=r[15],S=n[0],E=n[4],M=n[8],R=n[12],C=n[1],T=n[5],L=n[9],I=n[13],D=n[2],F=n[6],H=n[10],z=n[14],B=n[3],j=n[7],V=n[11],q=n[15];return s[0]=o*S+a*C+l*D+u*B,s[4]=o*E+a*T+l*F+u*j,s[8]=o*M+a*L+l*H+u*V,s[12]=o*R+a*I+l*z+u*q,s[1]=c*S+h*C+d*D+p*B,s[5]=c*E+h*T+d*F+p*j,s[9]=c*M+h*L+d*H+p*V,s[13]=c*R+h*I+d*z+p*q,s[2]=f*S+m*C+g*D+y*B,s[6]=f*E+m*T+g*F+y*j,s[10]=f*M+m*L+g*H+y*V,s[14]=f*R+m*I+g*z+y*q,s[3]=v*S+b*C+_*D+A*B,s[7]=v*E+b*T+_*F+A*j,s[11]=v*M+b*L+_*H+A*V,s[15]=v*R+b*I+_*z+A*q,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],r=e[4],n=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],p=e[14],f=e[3],m=e[7],g=e[11],y=e[15];return f*(+s*l*h-n*u*h-s*a*d+r*u*d+n*a*p-r*l*p)+m*(+i*l*p-i*u*d+s*o*d-n*o*p+n*u*c-s*l*c)+g*(+i*u*h-i*a*p-s*o*h+r*o*p+s*a*c-r*u*c)+y*(-n*a*c-i*l*h+i*a*d+n*o*h-r*o*d+r*l*c)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=i,n[14]=r),this}invert(){const e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=h*g*u-m*d*u+m*l*p-a*g*p-h*l*y+a*d*y,b=f*d*u-c*g*u-f*l*p+o*g*p+c*l*y-o*d*y,_=c*m*u-f*h*u+f*a*p-o*m*p-c*a*y+o*h*y,A=f*h*l-c*m*l-f*a*d+o*m*d+c*a*g-o*h*g,S=i*v+r*b+n*_+s*A;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/S;return e[0]=v*E,e[1]=(m*d*s-h*g*s-m*n*p+r*g*p+h*n*y-r*d*y)*E,e[2]=(a*g*s-m*l*s+m*n*u-r*g*u-a*n*y+r*l*y)*E,e[3]=(h*l*s-a*d*s-h*n*u+r*d*u+a*n*p-r*l*p)*E,e[4]=b*E,e[5]=(c*g*s-f*d*s+f*n*p-i*g*p-c*n*y+i*d*y)*E,e[6]=(f*l*s-o*g*s-f*n*u+i*g*u+o*n*y-i*l*y)*E,e[7]=(o*d*s-c*l*s+c*n*u-i*d*u-o*n*p+i*l*p)*E,e[8]=_*E,e[9]=(f*h*s-c*m*s-f*r*p+i*m*p+c*r*y-i*h*y)*E,e[10]=(o*m*s-f*a*s+f*r*u-i*m*u-o*r*y+i*a*y)*E,e[11]=(c*a*s-o*h*s-c*r*u+i*h*u+o*r*p-i*a*p)*E,e[12]=A*E,e[13]=(c*m*n-f*h*n+f*r*d-i*m*d-c*r*g+i*h*g)*E,e[14]=(f*a*n-o*m*n-f*r*l+i*m*l+o*r*g-i*a*g)*E,e[15]=(o*h*n-c*a*n+c*r*l-i*h*l-o*r*d+i*a*d)*E,this}scale(e){const i=this.elements,r=e.x,n=e.y,s=e.z;return i[0]*=r,i[4]*=n,i[8]*=s,i[1]*=r,i[5]*=n,i[9]*=s,i[2]*=r,i[6]*=n,i[10]*=s,i[3]*=r,i[7]*=n,i[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,r,n))}makeTranslation(e,i,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,r,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,i,-r,0,0,r,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),r=Math.sin(e);return this.set(i,0,r,0,0,1,0,0,-r,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),r=Math.sin(e);return this.set(i,-r,0,0,r,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const r=Math.cos(i),n=Math.sin(i),s=1-r,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+r,u*a-n*l,u*l+n*a,0,u*a+n*l,c*a+r,c*l-n*o,0,u*l-n*a,c*l+n*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,i,r){return this.set(e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,i,r,n,s,o){return this.set(1,r,s,0,e,1,o,0,i,n,1,0,0,0,0,1),this}compose(e,i,r){const n=this.elements,s=i._x,o=i._y,a=i._z,l=i._w,u=s+s,c=o+o,h=a+a,d=s*u,p=s*c,f=s*h,m=o*c,g=o*h,y=a*h,v=l*u,b=l*c,_=l*h,A=r.x,S=r.y,E=r.z;return n[0]=(1-(m+y))*A,n[1]=(p+_)*A,n[2]=(f-b)*A,n[3]=0,n[4]=(p-_)*S,n[5]=(1-(d+y))*S,n[6]=(g+v)*S,n[7]=0,n[8]=(f+b)*E,n[9]=(g-v)*E,n[10]=(1-(d+m))*E,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,i,r){const n=this.elements;let s=dy.set(n[0],n[1],n[2]).length();const o=dy.set(n[4],n[5],n[6]).length(),a=dy.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],su.copy(this);const u=1/s,c=1/o,h=1/a;return su.elements[0]*=u,su.elements[1]*=u,su.elements[2]*=u,su.elements[4]*=c,su.elements[5]*=c,su.elements[6]*=c,su.elements[8]*=h,su.elements[9]*=h,su.elements[10]*=h,i.setFromRotationMatrix(su),r.x=s,r.y=o,r.z=a,this}makePerspective(e,i,r,n,s,o,a=Sh){const l=this.elements,u=2*s/(i-e),c=2*s/(r-n),h=(i+e)/(i-e),d=(r+n)/(r-n);let p,f;if(a===Sh)p=-(o+s)/(o-s),f=-2*o*s/(o-s);else if(a===C1)p=-o/(o-s),f=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,i,r,n,s,o,a=Sh){const l=this.elements,u=1/(i-e),c=1/(r-n),h=1/(o-s),d=(i+e)*u,p=(r+n)*c;let f,m;if(a===Sh)f=(o+s)*h,m=-2*h;else if(a===C1)f=s*h,m=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=m,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const i=this.elements,r=e.elements;for(let n=0;n<16;n++)if(i[n]!==r[n])return!1;return!0}fromArray(e,i=0){for(let r=0;r<16;r++)this.elements[r]=e[r+i];return this}toArray(e=[],i=0){const r=this.elements;return e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7],e[i+8]=r[8],e[i+9]=r[9],e[i+10]=r[10],e[i+11]=r[11],e[i+12]=r[12],e[i+13]=r[13],e[i+14]=r[14],e[i+15]=r[15],e}}const dy=new ue,su=new ii,kze=new ue(0,0,0),Dze=new ue(1,1,1),Fd=new ue,xE=new ue,ka=new ue,x7=new ii,w7=new go;class d_{constructor(e=0,i=0,r=0,n=d_.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,r,n=this._order){return this._x=e,this._y=i,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,r=!0){const n=e.elements,s=n[0],o=n[4],a=n[8],l=n[1],u=n[5],c=n[9],h=n[2],d=n[6],p=n[10];switch(i){case"XYZ":this._y=Math.asin(un(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-un(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(un(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-un(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(un(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-un(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,r){return x7.makeRotationFromQuaternion(e),this.setFromRotationMatrix(x7,i,r)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return w7.setFromEuler(this),this.setFromQuaternion(w7,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}d_.DEFAULT_ORDER="XYZ";class Sm{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Ize=0;const _7=new ue,py=new go,gc=new ii,wE=new ue,bx=new ue,Lze=new ue,Bze=new go,S7=new ue(1,0,0),A7=new ue(0,1,0),E7=new ue(0,0,1),Oze={type:"added"},Uze={type:"removed"};class Hi extends hd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Ize++}),this.uuid=qa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hi.DEFAULT_UP.clone();const e=new ue,i=new d_,r=new go,n=new ue(1,1,1);function s(){r.setFromEuler(i,!1)}function o(){i.setFromQuaternion(r,void 0,!1)}i._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ii},normalMatrix:{value:new Ei}}),this.matrix=new ii,this.matrixWorld=new ii,this.matrixAutoUpdate=Hi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Sm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return py.setFromAxisAngle(e,i),this.quaternion.multiply(py),this}rotateOnWorldAxis(e,i){return py.setFromAxisAngle(e,i),this.quaternion.premultiply(py),this}rotateX(e){return this.rotateOnAxis(S7,e)}rotateY(e){return this.rotateOnAxis(A7,e)}rotateZ(e){return this.rotateOnAxis(E7,e)}translateOnAxis(e,i){return _7.copy(e).applyQuaternion(this.quaternion),this.position.add(_7.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(S7,e)}translateY(e){return this.translateOnAxis(A7,e)}translateZ(e){return this.translateOnAxis(E7,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(gc.copy(this.matrixWorld).invert())}lookAt(e,i,r){e.isVector3?wE.copy(e):wE.set(e,i,r);const n=this.parent;this.updateWorldMatrix(!0,!1),bx.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?gc.lookAt(bx,wE,this.up):gc.lookAt(wE,bx,this.up),this.quaternion.setFromRotationMatrix(gc),n&&(gc.extractRotation(n.matrixWorld),py.setFromRotationMatrix(gc),this.quaternion.premultiply(py.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Oze)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(Uze)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),gc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),gc.multiply(e.parent.matrixWorld)),e.applyMatrix4(gc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let r=0,n=this.children.length;r<n;r++){const o=this.children[r].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i,r=[]){this[e]===i&&r.push(this);const n=this.children;for(let s=0,o=n.length;s<o;s++)n[s].getObjectsByProperty(e,i,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bx,e,Lze),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bx,Bze,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let r=0,n=i.length;r<n;r++){const s=i[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const n=this.children;for(let s=0,o=n.length;s<o;s++){const a=n[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",r={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));n.material=a}else n.material=s(e.materials,this.material);if(this.children.length>0){n.children=[];for(let a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];n.animations.push(s(e.animations,l))}}if(i){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),p=o(e.animations),f=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),h.length>0&&(r.shapes=h),d.length>0&&(r.skeletons=d),p.length>0&&(r.animations=p),f.length>0&&(r.nodes=f)}return r.object=n,r;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}Hi.DEFAULT_UP=new ue(0,1,0);Hi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ou=new ue,yc=new ue,iI=new ue,vc=new ue,fy=new ue,my=new ue,M7=new ue,rI=new ue,nI=new ue,sI=new ue;class Ua{constructor(e=new ue,i=new ue,r=new ue){this.a=e,this.b=i,this.c=r}static getNormal(e,i,r,n){n.subVectors(r,i),ou.subVectors(e,i),n.cross(ou);const s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(e,i,r,n,s){ou.subVectors(n,i),yc.subVectors(r,i),iI.subVectors(e,i);const o=ou.dot(ou),a=ou.dot(yc),l=ou.dot(iI),u=yc.dot(yc),c=yc.dot(iI),h=o*u-a*a;if(h===0)return s.set(0,0,0),null;const d=1/h,p=(u*l-a*c)*d,f=(o*c-a*l)*d;return s.set(1-p-f,f,p)}static containsPoint(e,i,r,n){return this.getBarycoord(e,i,r,n,vc)===null?!1:vc.x>=0&&vc.y>=0&&vc.x+vc.y<=1}static getInterpolation(e,i,r,n,s,o,a,l){return this.getBarycoord(e,i,r,n,vc)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,vc.x),l.addScaledVector(o,vc.y),l.addScaledVector(a,vc.z),l)}static isFrontFacing(e,i,r,n){return ou.subVectors(r,i),yc.subVectors(e,i),ou.cross(yc).dot(n)<0}set(e,i,r){return this.a.copy(e),this.b.copy(i),this.c.copy(r),this}setFromPointsAndIndices(e,i,r,n){return this.a.copy(e[i]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,i,r,n){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ou.subVectors(this.c,this.b),yc.subVectors(this.a,this.b),ou.cross(yc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ua.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return Ua.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,r,n,s){return Ua.getInterpolation(e,this.a,this.b,this.c,i,r,n,s)}containsPoint(e){return Ua.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ua.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const r=this.a,n=this.b,s=this.c;let o,a;fy.subVectors(n,r),my.subVectors(s,r),rI.subVectors(e,r);const l=fy.dot(rI),u=my.dot(rI);if(l<=0&&u<=0)return i.copy(r);nI.subVectors(e,n);const c=fy.dot(nI),h=my.dot(nI);if(c>=0&&h<=c)return i.copy(n);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),i.copy(r).addScaledVector(fy,o);sI.subVectors(e,s);const p=fy.dot(sI),f=my.dot(sI);if(f>=0&&p<=f)return i.copy(s);const m=p*u-l*f;if(m<=0&&u>=0&&f<=0)return a=u/(u-f),i.copy(r).addScaledVector(my,a);const g=c*f-p*h;if(g<=0&&h-c>=0&&p-f>=0)return M7.subVectors(s,n),a=(h-c)/(h-c+(p-f)),i.copy(n).addScaledVector(M7,a);const y=1/(g+m+d);return o=m*y,a=d*y,i.copy(r).addScaledVector(fy,o).addScaledVector(my,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const One={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zd={h:0,s:0,l:0},_E={h:0,s:0,l:0};function oI(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}class St{constructor(e,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,r)}set(e,i,r){if(i===void 0&&r===void 0){const n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,i,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=es){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,or.toWorkingColorSpace(this,i),this}setRGB(e,i,r,n=or.workingColorSpace){return this.r=e,this.g=i,this.b=r,or.toWorkingColorSpace(this,n),this}setHSL(e,i,r,n=or.workingColorSpace){if(e=B4(e,1),i=un(i,0,1),r=un(r,0,1),i===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+i):r+i-r*i,o=2*r-s;this.r=oI(o,s,e+1/3),this.g=oI(o,s,e),this.b=oI(o,s,e-1/3)}return or.toWorkingColorSpace(this,n),this}setStyle(e,i=es){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=n[1],a=n[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,i);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,i);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=n[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,i);if(o===6)return this.setHex(parseInt(s,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=es){const r=One[e.toLowerCase()];return r!==void 0?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Gv(e.r),this.g=Gv(e.g),this.b=Gv(e.b),this}copyLinearToSRGB(e){return this.r=Y3(e.r),this.g=Y3(e.g),this.b=Y3(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=es){return or.fromWorkingColorSpace(no.copy(this),e),Math.round(un(no.r*255,0,255))*65536+Math.round(un(no.g*255,0,255))*256+Math.round(un(no.b*255,0,255))}getHexString(e=es){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=or.workingColorSpace){or.fromWorkingColorSpace(no.copy(this),i);const r=no.r,n=no.g,s=no.b,o=Math.max(r,n,s),a=Math.min(r,n,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case r:l=(n-s)/h+(n<s?6:0);break;case n:l=(s-r)/h+2;break;case s:l=(r-n)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,i=or.workingColorSpace){return or.fromWorkingColorSpace(no.copy(this),i),e.r=no.r,e.g=no.g,e.b=no.b,e}getStyle(e=es){or.fromWorkingColorSpace(no.copy(this),e);const i=no.r,r=no.g,n=no.b;return e!==es?`color(${e} ${i.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,i,r){return this.getHSL(zd),this.setHSL(zd.h+e,zd.s+i,zd.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,r){return this.r=e.r+(i.r-e.r)*r,this.g=e.g+(i.g-e.g)*r,this.b=e.b+(i.b-e.b)*r,this}lerpHSL(e,i){this.getHSL(zd),e.getHSL(_E);const r=bw(zd.h,_E.h,i),n=bw(zd.s,_E.s,i),s=bw(zd.l,_E.l,i);return this.setHSL(r,n,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,r=this.g,n=this.b,s=e.elements;return this.r=s[0]*i+s[3]*r+s[6]*n,this.g=s[1]*i+s[4]*r+s[7]*n,this.b=s[2]*i+s[5]*r+s[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const no=new St;St.NAMES=One;let Nze=0;class jn extends hd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Nze++}),this.uuid=qa(),this.name="",this.type="Material",this.blending=xm,this.side=zh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Q2,this.blendDst=Z2,this.blendEquation=rp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=v1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=WU,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Of,this.stencilZFail=Of,this.stencilZPass=Of,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const r=e[i];if(r===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const n=this[i];if(n===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[i]=r}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==xm&&(r.blending=this.blending),this.side!==zh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==Q2&&(r.blendSrc=this.blendSrc),this.blendDst!==Z2&&(r.blendDst=this.blendDst),this.blendEquation!==rp&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==v1&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==WU&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Of&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Of&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Of&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function n(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i){const s=n(e.textures),o=n(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let r=null;if(i!==null){const n=i.length;r=new Array(n);for(let s=0;s!==n;++s)r[s]=i[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ga extends jn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=h_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ic=Fze();function Fze(){const t=new ArrayBuffer(4),e=new Float32Array(t),i=new Uint32Array(t),r=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(r[l]=0,r[l|256]=32768,n[l]=24,n[l|256]=24):u<-14?(r[l]=1024>>-u-14,r[l|256]=1024>>-u-14|32768,n[l]=-u-1,n[l|256]=-u-1):u<=15?(r[l]=u+15<<10,r[l|256]=u+15<<10|32768,n[l]=13,n[l|256]=13):u<128?(r[l]=31744,r[l|256]=64512,n[l]=24,n[l|256]=24):(r[l]=31744,r[l|256]=64512,n[l]=13,n[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:i,baseTable:r,shiftTable:n,mantissaTable:s,exponentTable:o,offsetTable:a}}function sa(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=un(t,-65504,65504),Ic.floatView[0]=t;const e=Ic.uint32View[0],i=e>>23&511;return Ic.baseTable[i]+((e&8388607)>>Ic.shiftTable[i])}function Kx(t){const e=t>>10;return Ic.uint32View[0]=Ic.mantissaTable[Ic.offsetTable[e]+(t&1023)]+Ic.exponentTable[e],Ic.floatView[0]}const zze={toHalfFloat:sa,fromHalfFloat:Kx},In=new ue,SE=new ot;class Gi{constructor(e,i,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=r,this.usage=M1,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Rl,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return _m("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,r){e*=this.itemSize,r*=i.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[e+n]=i.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,r=this.count;i<r;i++)SE.fromBufferAttribute(this,i),SE.applyMatrix3(e),this.setXY(i,SE.x,SE.y);else if(this.itemSize===3)for(let i=0,r=this.count;i<r;i++)In.fromBufferAttribute(this,i),In.applyMatrix3(e),this.setXYZ(i,In.x,In.y,In.z);return this}applyMatrix4(e){for(let i=0,r=this.count;i<r;i++)In.fromBufferAttribute(this,i),In.applyMatrix4(e),this.setXYZ(i,In.x,In.y,In.z);return this}applyNormalMatrix(e){for(let i=0,r=this.count;i<r;i++)In.fromBufferAttribute(this,i),In.applyNormalMatrix(e),this.setXYZ(i,In.x,In.y,In.z);return this}transformDirection(e){for(let i=0,r=this.count;i<r;i++)In.fromBufferAttribute(this,i),In.transformDirection(e),this.setXYZ(i,In.x,In.y,In.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let r=this.array[e*this.itemSize+i];return this.normalized&&(r=zo(r,this.array)),r}setComponent(e,i,r){return this.normalized&&(r=wi(r,this.array)),this.array[e*this.itemSize+i]=r,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=zo(i,this.array)),i}setX(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=zo(i,this.array)),i}setY(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=zo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=zo(i,this.array)),i}setW(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,r){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array)),this.array[e+0]=i,this.array[e+1]=r,this}setXYZ(e,i,r,n){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array)),this.array[e+0]=i,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,i,r,n,s){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array),s=wi(s,this.array)),this.array[e+0]=i,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==M1&&(e.usage=this.usage),e}}class Hze extends Gi{constructor(e,i,r){super(new Int8Array(e),i,r)}}class Gze extends Gi{constructor(e,i,r){super(new Uint8Array(e),i,r)}}class Vze extends Gi{constructor(e,i,r){super(new Uint8ClampedArray(e),i,r)}}class jze extends Gi{constructor(e,i,r){super(new Int16Array(e),i,r)}}class N4 extends Gi{constructor(e,i,r){super(new Uint16Array(e),i,r)}}class Wze extends Gi{constructor(e,i,r){super(new Int32Array(e),i,r)}}class F4 extends Gi{constructor(e,i,r){super(new Uint32Array(e),i,r)}}class qze extends Gi{constructor(e,i,r){super(new Uint16Array(e),i,r),this.isFloat16BufferAttribute=!0}getX(e){let i=Kx(this.array[e*this.itemSize]);return this.normalized&&(i=zo(i,this.array)),i}setX(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize]=sa(i),this}getY(e){let i=Kx(this.array[e*this.itemSize+1]);return this.normalized&&(i=zo(i,this.array)),i}setY(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+1]=sa(i),this}getZ(e){let i=Kx(this.array[e*this.itemSize+2]);return this.normalized&&(i=zo(i,this.array)),i}setZ(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+2]=sa(i),this}getW(e){let i=Kx(this.array[e*this.itemSize+3]);return this.normalized&&(i=zo(i,this.array)),i}setW(e,i){return this.normalized&&(i=wi(i,this.array)),this.array[e*this.itemSize+3]=sa(i),this}setXY(e,i,r){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array)),this.array[e+0]=sa(i),this.array[e+1]=sa(r),this}setXYZ(e,i,r,n){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array)),this.array[e+0]=sa(i),this.array[e+1]=sa(r),this.array[e+2]=sa(n),this}setXYZW(e,i,r,n,s){return e*=this.itemSize,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array),s=wi(s,this.array)),this.array[e+0]=sa(i),this.array[e+1]=sa(r),this.array[e+2]=sa(n),this.array[e+3]=sa(s),this}}class Ft extends Gi{constructor(e,i,r){super(new Float32Array(e),i,r)}}class Xze extends Gi{constructor(e,i,r){super(new Float64Array(e),i,r)}}let Yze=0;const ml=new ii,aI=new Hi,gy=new ue,Da=new yo,xx=new yo,fs=new ue;class bi extends hd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Yze++}),this.uuid=qa(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Ine(e)?F4:N4)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,r=0){this.groups.push({start:e,count:i,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Ei().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ml.makeRotationFromQuaternion(e),this.applyMatrix4(ml),this}rotateX(e){return ml.makeRotationX(e),this.applyMatrix4(ml),this}rotateY(e){return ml.makeRotationY(e),this.applyMatrix4(ml),this}rotateZ(e){return ml.makeRotationZ(e),this.applyMatrix4(ml),this}translate(e,i,r){return ml.makeTranslation(e,i,r),this.applyMatrix4(ml),this}scale(e,i,r){return ml.makeScale(e,i,r),this.applyMatrix4(ml),this}lookAt(e){return aI.lookAt(e),aI.updateMatrix(),this.applyMatrix4(aI.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(gy).negate(),this.translate(gy.x,gy.y,gy.z),this}setFromPoints(e){const i=[];for(let r=0,n=e.length;r<n;r++){const s=e[r];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ft(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new yo);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ue(-1/0,-1/0,-1/0),new ue(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let r=0,n=i.length;r<n;r++){const s=i[r];Da.setFromBufferAttribute(s),this.morphTargetsRelative?(fs.addVectors(this.boundingBox.min,Da.min),this.boundingBox.expandByPoint(fs),fs.addVectors(this.boundingBox.max,Da.max),this.boundingBox.expandByPoint(fs)):(this.boundingBox.expandByPoint(Da.min),this.boundingBox.expandByPoint(Da.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new qs);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ue,1/0);return}if(e){const r=this.boundingSphere.center;if(Da.setFromBufferAttribute(e),i)for(let s=0,o=i.length;s<o;s++){const a=i[s];xx.setFromBufferAttribute(a),this.morphTargetsRelative?(fs.addVectors(Da.min,xx.min),Da.expandByPoint(fs),fs.addVectors(Da.max,xx.max),Da.expandByPoint(fs)):(Da.expandByPoint(xx.min),Da.expandByPoint(xx.max))}Da.getCenter(r);let n=0;for(let s=0,o=e.count;s<o;s++)fs.fromBufferAttribute(e,s),n=Math.max(n,r.distanceToSquared(fs));if(i)for(let s=0,o=i.length;s<o;s++){const a=i[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)fs.fromBufferAttribute(a,u),l&&(gy.fromBufferAttribute(e,u),fs.add(gy)),n=Math.max(n,r.distanceToSquared(fs))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,n=i.position.array,s=i.normal.array,o=i.uv.array,a=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Gi(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let C=0;C<a;C++)u[C]=new ue,c[C]=new ue;const h=new ue,d=new ue,p=new ue,f=new ot,m=new ot,g=new ot,y=new ue,v=new ue;function b(C,T,L){h.fromArray(n,C*3),d.fromArray(n,T*3),p.fromArray(n,L*3),f.fromArray(o,C*2),m.fromArray(o,T*2),g.fromArray(o,L*2),d.sub(h),p.sub(h),m.sub(f),g.sub(f);const I=1/(m.x*g.y-g.x*m.y);isFinite(I)&&(y.copy(d).multiplyScalar(g.y).addScaledVector(p,-m.y).multiplyScalar(I),v.copy(p).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar(I),u[C].add(y),u[T].add(y),u[L].add(y),c[C].add(v),c[T].add(v),c[L].add(v))}let _=this.groups;_.length===0&&(_=[{start:0,count:r.length}]);for(let C=0,T=_.length;C<T;++C){const L=_[C],I=L.start,D=L.count;for(let F=I,H=I+D;F<H;F+=3)b(r[F+0],r[F+1],r[F+2])}const A=new ue,S=new ue,E=new ue,M=new ue;function R(C){E.fromArray(s,C*3),M.copy(E);const T=u[C];A.copy(T),A.sub(E.multiplyScalar(E.dot(T))).normalize(),S.crossVectors(M,T);const I=S.dot(c[C])<0?-1:1;l[C*4]=A.x,l[C*4+1]=A.y,l[C*4+2]=A.z,l[C*4+3]=I}for(let C=0,T=_.length;C<T;++C){const L=_[C],I=L.start,D=L.count;for(let F=I,H=I+D;F<H;F+=3)R(r[F+0]),R(r[F+1]),R(r[F+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Gi(new Float32Array(i.count*3),3),this.setAttribute("normal",r);else for(let d=0,p=r.count;d<p;d++)r.setXYZ(d,0,0,0);const n=new ue,s=new ue,o=new ue,a=new ue,l=new ue,u=new ue,c=new ue,h=new ue;if(e)for(let d=0,p=e.count;d<p;d+=3){const f=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);n.fromBufferAttribute(i,f),s.fromBufferAttribute(i,m),o.fromBufferAttribute(i,g),c.subVectors(o,s),h.subVectors(n,s),c.cross(h),a.fromBufferAttribute(r,f),l.fromBufferAttribute(r,m),u.fromBufferAttribute(r,g),a.add(c),l.add(c),u.add(c),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(g,u.x,u.y,u.z)}else for(let d=0,p=i.count;d<p;d+=3)n.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),c.subVectors(o,s),h.subVectors(n,s),c.cross(h),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,r=e.count;i<r;i++)fs.fromBufferAttribute(e,i),fs.normalize(),e.setXYZ(i,fs.x,fs.y,fs.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,d=new u.constructor(l.length*c);let p=0,f=0;for(let m=0,g=l.length;m<g;m++){a.isInterleavedBufferAttribute?p=l[m]*a.data.stride+a.offset:p=l[m]*c;for(let y=0;y<c;y++)d[f++]=u[p++]}return new Gi(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new bi,r=this.index.array,n=this.attributes;for(const a in n){const l=n[a],u=e(l,r);i.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,h=u.length;c<h;c++){const d=u[c],p=e(d,r);l.push(p)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];i.addGroup(u.start,u.count,u.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const n={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const p=u[h];c.push(p.toJSON(e.data))}c.length>0&&(n[l]=c,s=!0)}s&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(i));const n=e.attributes;for(const u in n){const c=n[u];this.setAttribute(u,c.clone(i))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let d=0,p=h.length;d<p;d++)c.push(h[d].clone(i));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const C7=new ii,bf=new ib,AE=new qs,P7=new ue,yy=new ue,vy=new ue,by=new ue,lI=new ue,EE=new ue,ME=new ot,CE=new ot,PE=new ot,T7=new ue,R7=new ue,k7=new ue,TE=new ue,RE=new ue;class _n extends Hi{constructor(e=new bi,i=new Ga){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,r=Object.keys(i);if(r.length>0){const n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=n.length;s<o;s++){const a=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,i){const r=this.geometry,n=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;i.fromBufferAttribute(n,e);const a=this.morphTargetInfluences;if(s&&a){EE.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],h=s[l];c!==0&&(lI.fromBufferAttribute(h,e),o?EE.addScaledVector(lI,c):EE.addScaledVector(lI.sub(i),c))}i.add(EE)}return i}raycast(e,i){const r=this.geometry,n=this.material,s=this.matrixWorld;n!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),AE.copy(r.boundingSphere),AE.applyMatrix4(s),bf.copy(e.ray).recast(e.near),!(AE.containsPoint(bf.origin)===!1&&(bf.intersectSphere(AE,P7)===null||bf.origin.distanceToSquared(P7)>(e.far-e.near)**2))&&(C7.copy(s).invert(),bf.copy(e.ray).applyMatrix4(C7),!(r.boundingBox!==null&&bf.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,i,bf)))}_computeIntersections(e,i,r){let n;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,d=s.groups,p=s.drawRange;if(a!==null)if(Array.isArray(o))for(let f=0,m=d.length;f<m;f++){const g=d[f],y=o[g.materialIndex],v=Math.max(g.start,p.start),b=Math.min(a.count,Math.min(g.start+g.count,p.start+p.count));for(let _=v,A=b;_<A;_+=3){const S=a.getX(_),E=a.getX(_+1),M=a.getX(_+2);n=kE(this,y,e,r,u,c,h,S,E,M),n&&(n.faceIndex=Math.floor(_/3),n.face.materialIndex=g.materialIndex,i.push(n))}}else{const f=Math.max(0,p.start),m=Math.min(a.count,p.start+p.count);for(let g=f,y=m;g<y;g+=3){const v=a.getX(g),b=a.getX(g+1),_=a.getX(g+2);n=kE(this,o,e,r,u,c,h,v,b,_),n&&(n.faceIndex=Math.floor(g/3),i.push(n))}}else if(l!==void 0)if(Array.isArray(o))for(let f=0,m=d.length;f<m;f++){const g=d[f],y=o[g.materialIndex],v=Math.max(g.start,p.start),b=Math.min(l.count,Math.min(g.start+g.count,p.start+p.count));for(let _=v,A=b;_<A;_+=3){const S=_,E=_+1,M=_+2;n=kE(this,y,e,r,u,c,h,S,E,M),n&&(n.faceIndex=Math.floor(_/3),n.face.materialIndex=g.materialIndex,i.push(n))}}else{const f=Math.max(0,p.start),m=Math.min(l.count,p.start+p.count);for(let g=f,y=m;g<y;g+=3){const v=g,b=g+1,_=g+2;n=kE(this,o,e,r,u,c,h,v,b,_),n&&(n.faceIndex=Math.floor(g/3),i.push(n))}}}}function Kze(t,e,i,r,n,s,o,a){let l;if(e.side===jo?l=r.intersectTriangle(o,s,n,!0,a):l=r.intersectTriangle(n,s,o,e.side===zh,a),l===null)return null;RE.copy(a),RE.applyMatrix4(t.matrixWorld);const u=i.ray.origin.distanceTo(RE);return u<i.near||u>i.far?null:{distance:u,point:RE.clone(),object:t}}function kE(t,e,i,r,n,s,o,a,l,u){t.getVertexPosition(a,yy),t.getVertexPosition(l,vy),t.getVertexPosition(u,by);const c=Kze(t,e,i,r,yy,vy,by,TE);if(c){n&&(ME.fromBufferAttribute(n,a),CE.fromBufferAttribute(n,l),PE.fromBufferAttribute(n,u),c.uv=Ua.getInterpolation(TE,yy,vy,by,ME,CE,PE,new ot)),s&&(ME.fromBufferAttribute(s,a),CE.fromBufferAttribute(s,l),PE.fromBufferAttribute(s,u),c.uv1=Ua.getInterpolation(TE,yy,vy,by,ME,CE,PE,new ot),c.uv2=c.uv1),o&&(T7.fromBufferAttribute(o,a),R7.fromBufferAttribute(o,l),k7.fromBufferAttribute(o,u),c.normal=Ua.getInterpolation(TE,yy,vy,by,T7,R7,k7,new ue),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const h={a,b:l,c:u,normal:new ue,materialIndex:0};Ua.getNormal(yy,vy,by,h.normal),c.face=h}return c}class lg extends bi{constructor(e=1,i=1,r=1,n=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:r,widthSegments:n,heightSegments:s,depthSegments:o};const a=this;n=Math.floor(n),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],h=[];let d=0,p=0;f("z","y","x",-1,-1,r,i,e,o,s,0),f("z","y","x",1,-1,r,i,-e,o,s,1),f("x","z","y",1,1,e,r,i,n,o,2),f("x","z","y",1,-1,e,r,-i,n,o,3),f("x","y","z",1,-1,e,i,r,n,s,4),f("x","y","z",-1,-1,e,i,-r,n,s,5),this.setIndex(l),this.setAttribute("position",new Ft(u,3)),this.setAttribute("normal",new Ft(c,3)),this.setAttribute("uv",new Ft(h,2));function f(m,g,y,v,b,_,A,S,E,M,R){const C=_/E,T=A/M,L=_/2,I=A/2,D=S/2,F=E+1,H=M+1;let z=0,B=0;const j=new ue;for(let V=0;V<H;V++){const q=V*T-I;for(let K=0;K<F;K++){const le=K*C-L;j[m]=le*v,j[g]=q*b,j[y]=D,u.push(j.x,j.y,j.z),j[m]=0,j[g]=0,j[y]=S>0?1:-1,c.push(j.x,j.y,j.z),h.push(K/E),h.push(1-V/M),z+=1}}for(let V=0;V<M;V++)for(let q=0;q<E;q++){const K=d+q+F*V,le=d+q+F*(V+1),Z=d+(q+1)+F*(V+1),oe=d+(q+1)+F*V;l.push(K,le,oe),l.push(le,Z,oe),B+=6}a.addGroup(p,B,R),p+=B,d+=z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function x0(t){const e={};for(const i in t){e[i]={};for(const r in t[i]){const n=t[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][r]=null):e[i][r]=n.clone():Array.isArray(n)?e[i][r]=n.slice():e[i][r]=n}}return e}function ko(t){const e={};for(let i=0;i<t.length;i++){const r=x0(t[i]);for(const n in r)e[n]=r[n]}return e}function Jze(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function Une(t){return t.getRenderTarget()===null?t.outputColorSpace:or.workingColorSpace}const Nne={clone:x0,merge:ko};var Qze=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Zze=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ru extends jn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Qze,this.fragmentShader=Zze,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=x0(e.uniforms),this.uniformsGroups=Jze(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const n in this.uniforms){const o=this.uniforms[n].value;o&&o.isTexture?i.uniforms[n]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[n]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[n]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[n]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[n]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[n]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[n]={type:"m4",value:o.toArray()}:i.uniforms[n]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const r={};for(const n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(i.extensions=r),i}}class p_ extends Hi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ii,this.projectionMatrix=new ii,this.projectionMatrixInverse=new ii,this.coordinateSystem=Sh}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Hd=new ue,D7=new ot,I7=new ot;class xn extends p_{constructor(e=50,i=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=b0*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(wm*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return b0*2*Math.atan(Math.tan(wm*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,r){Hd.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Hd.x,Hd.y).multiplyScalar(-e/Hd.z),Hd.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Hd.x,Hd.y).multiplyScalar(-e/Hd.z)}getViewSize(e,i){return this.getViewBounds(e,D7,I7),i.subVectors(I7,D7)}setViewOffset(e,i,r,n,s,o){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(wm*.5*this.fov)/this.zoom,r=2*i,n=this.aspect*r,s=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*n/l,i-=o.offsetY*r/u,n*=o.width/l,r*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,i,i-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const xy=-90,wy=1;class Fne extends Hi{constructor(e,i,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new xn(xy,wy,e,i);n.layers=this.layers,this.add(n);const s=new xn(xy,wy,e,i);s.layers=this.layers,this.add(s);const o=new xn(xy,wy,e,i);o.layers=this.layers,this.add(o);const a=new xn(xy,wy,e,i);a.layers=this.layers,this.add(a);const l=new xn(xy,wy,e,i);l.layers=this.layers,this.add(l);const u=new xn(xy,wy,e,i);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[r,n,s,o,a,l]=i;for(const u of i)this.remove(u);if(e===Sh)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===C1)r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of i)this.add(u),u.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const m=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,n),e.render(i,s),e.setRenderTarget(r,1,n),e.render(i,o),e.setRenderTarget(r,2,n),e.render(i,a),e.setRenderTarget(r,3,n),e.render(i,l),e.setRenderTarget(r,4,n),e.render(i,u),r.texture.generateMipmaps=m,e.setRenderTarget(r,5,n),e.render(i,c),e.setRenderTarget(h,d,p),e.xr.enabled=f,r.texture.needsPMREMUpdate=!0}}class f_ extends Ir{constructor(e,i,r,n,s,o,a,l,u,c){e=e!==void 0?e:[],i=i!==void 0?i:nd,super(e,i,r,n,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class zne extends Tu{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];i.encoding!==void 0&&(_m("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Ip?es:Oa),this.texture=new f_(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Rr}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new lg(5,5,5),s=new Ru({name:"CubemapFromEquirect",uniforms:x0(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:jo,blending:Kc});s.uniforms.tEquirect.value=i;const o=new _n(n,s),a=i.minFilter;return i.minFilter===Il&&(i.minFilter=Rr),new Fne(1,10,this).update(e,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,i,r,n){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(i,r,n);e.setRenderTarget(s)}}const uI=new ue,$ze=new ue,e4e=new Ei;class Yd{constructor(e=new ue(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,r,n){return this.normal.set(e,i,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,r){const n=uI.subVectors(r,i).cross($ze.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const r=e.delta(uI),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:i.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const i=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return i<0&&r>0||r<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const r=i||e4e.getNormalMatrix(e),n=this.coplanarPoint(uI).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const xf=new qs,DE=new ue;class m_{constructor(e=new Yd,i=new Yd,r=new Yd,n=new Yd,s=new Yd,o=new Yd){this.planes=[e,i,r,n,s,o]}set(e,i,r,n,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(i),a[2].copy(r),a[3].copy(n),a[4].copy(s),a[5].copy(o),this}copy(e){const i=this.planes;for(let r=0;r<6;r++)i[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,i=Sh){const r=this.planes,n=e.elements,s=n[0],o=n[1],a=n[2],l=n[3],u=n[4],c=n[5],h=n[6],d=n[7],p=n[8],f=n[9],m=n[10],g=n[11],y=n[12],v=n[13],b=n[14],_=n[15];if(r[0].setComponents(l-s,d-u,g-p,_-y).normalize(),r[1].setComponents(l+s,d+u,g+p,_+y).normalize(),r[2].setComponents(l+o,d+c,g+f,_+v).normalize(),r[3].setComponents(l-o,d-c,g-f,_-v).normalize(),r[4].setComponents(l-a,d-h,g-m,_-b).normalize(),i===Sh)r[5].setComponents(l+a,d+h,g+m,_+b).normalize();else if(i===C1)r[5].setComponents(a,h,m,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),xf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),xf.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xf)}intersectsSprite(e){return xf.center.set(0,0,0),xf.radius=.7071067811865476,xf.applyMatrix4(e.matrixWorld),this.intersectsSphere(xf)}intersectsSphere(e){const i=this.planes,r=e.center,n=-e.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){const i=this.planes;for(let r=0;r<6;r++){const n=i[r];if(DE.x=n.normal.x>0?e.max.x:e.min.x,DE.y=n.normal.y>0?e.max.y:e.min.y,DE.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(DE)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let r=0;r<6;r++)if(i[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Hne(){let t=null,e=!1,i=null,r=null;function n(s,o){i(s,o),r=t.requestAnimationFrame(n)}return{start:function(){e!==!0&&i!==null&&(r=t.requestAnimationFrame(n),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){i=s},setContext:function(s){t=s}}}function t4e(t,e){const i=e.isWebGL2,r=new WeakMap;function n(u,c){const h=u.array,d=u.usage,p=h.byteLength,f=t.createBuffer();t.bindBuffer(c,f),t.bufferData(c,h,d),u.onUploadCallback();let m;if(h instanceof Float32Array)m=t.FLOAT;else if(h instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(i)m=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else m=t.UNSIGNED_SHORT;else if(h instanceof Int16Array)m=t.SHORT;else if(h instanceof Uint32Array)m=t.UNSIGNED_INT;else if(h instanceof Int32Array)m=t.INT;else if(h instanceof Int8Array)m=t.BYTE;else if(h instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:m,bytesPerElement:h.BYTES_PER_ELEMENT,version:u.version,size:p}}function s(u,c,h){const d=c.array,p=c._updateRange,f=c.updateRanges;if(t.bindBuffer(h,u),p.count===-1&&f.length===0&&t.bufferSubData(h,0,d),f.length!==0){for(let m=0,g=f.length;m<g;m++){const y=f[m];i?t.bufferSubData(h,y.start*d.BYTES_PER_ELEMENT,d,y.start,y.count):t.bufferSubData(h,y.start*d.BYTES_PER_ELEMENT,d.subarray(y.start,y.start+y.count))}c.clearUpdateRanges()}p.count!==-1&&(i?t.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):t.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),c.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=r.get(u);c&&(t.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const d=r.get(u);(!d||d.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const h=r.get(u);if(h===void 0)r.set(u,n(u,c));else if(h.version<u.version){if(h.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(h.buffer,u,c),h.version=u.version}}return{get:o,remove:a,update:l}}class rb extends bi{constructor(e=1,i=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:r,heightSegments:n};const s=e/2,o=i/2,a=Math.floor(r),l=Math.floor(n),u=a+1,c=l+1,h=e/a,d=i/l,p=[],f=[],m=[],g=[];for(let y=0;y<c;y++){const v=y*d-o;for(let b=0;b<u;b++){const _=b*h-s;f.push(_,-v,0),m.push(0,0,1),g.push(b/a),g.push(1-y/l)}}for(let y=0;y<l;y++)for(let v=0;v<a;v++){const b=v+u*y,_=v+u*(y+1),A=v+1+u*(y+1),S=v+1+u*y;p.push(b,_,S),p.push(_,A,S)}this.setIndex(p),this.setAttribute("position",new Ft(f,3)),this.setAttribute("normal",new Ft(m,3)),this.setAttribute("uv",new Ft(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rb(e.width,e.height,e.widthSegments,e.heightSegments)}}var i4e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,r4e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,n4e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,s4e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,o4e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,a4e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,l4e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,u4e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,h4e=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,c4e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,d4e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,p4e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,f4e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,m4e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,g4e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,y4e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,v4e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,b4e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,x4e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,w4e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,_4e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,S4e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,A4e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,E4e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,M4e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,C4e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,P4e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,T4e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,R4e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,k4e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,D4e="gl_FragColor = linearToOutputTexel( gl_FragColor );",I4e=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,L4e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,B4e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,O4e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,U4e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,N4e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,F4e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,z4e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,H4e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,G4e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,V4e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,j4e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,W4e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,q4e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,X4e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Y4e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,K4e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,J4e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Q4e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Z4e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,$4e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,e5e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,t5e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,i5e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,r5e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,n5e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,s5e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,o5e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,a5e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,l5e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,u5e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,h5e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,c5e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,d5e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,p5e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,f5e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,m5e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,g5e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,y5e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,v5e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,b5e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,x5e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,w5e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_5e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,S5e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,A5e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,E5e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,M5e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,C5e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,P5e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,T5e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,R5e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,k5e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,D5e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,I5e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,L5e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,B5e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,O5e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,U5e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,N5e=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,F5e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,z5e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,H5e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,G5e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,V5e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,j5e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,W5e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,q5e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,X5e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Y5e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,K5e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,J5e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Q5e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Z5e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,$5e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,eHe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const tHe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,iHe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rHe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nHe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sHe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,oHe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,aHe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,lHe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,uHe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,hHe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,cHe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,dHe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,pHe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fHe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,mHe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,gHe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yHe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vHe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bHe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,xHe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wHe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_He=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,SHe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AHe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EHe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,MHe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CHe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,PHe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,THe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,RHe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kHe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DHe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,IHe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,LHe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_i={alphahash_fragment:i4e,alphahash_pars_fragment:r4e,alphamap_fragment:n4e,alphamap_pars_fragment:s4e,alphatest_fragment:o4e,alphatest_pars_fragment:a4e,aomap_fragment:l4e,aomap_pars_fragment:u4e,batching_pars_vertex:h4e,batching_vertex:c4e,begin_vertex:d4e,beginnormal_vertex:p4e,bsdfs:f4e,iridescence_fragment:m4e,bumpmap_pars_fragment:g4e,clipping_planes_fragment:y4e,clipping_planes_pars_fragment:v4e,clipping_planes_pars_vertex:b4e,clipping_planes_vertex:x4e,color_fragment:w4e,color_pars_fragment:_4e,color_pars_vertex:S4e,color_vertex:A4e,common:E4e,cube_uv_reflection_fragment:M4e,defaultnormal_vertex:C4e,displacementmap_pars_vertex:P4e,displacementmap_vertex:T4e,emissivemap_fragment:R4e,emissivemap_pars_fragment:k4e,colorspace_fragment:D4e,colorspace_pars_fragment:I4e,envmap_fragment:L4e,envmap_common_pars_fragment:B4e,envmap_pars_fragment:O4e,envmap_pars_vertex:U4e,envmap_physical_pars_fragment:K4e,envmap_vertex:N4e,fog_vertex:F4e,fog_pars_vertex:z4e,fog_fragment:H4e,fog_pars_fragment:G4e,gradientmap_pars_fragment:V4e,lightmap_fragment:j4e,lightmap_pars_fragment:W4e,lights_lambert_fragment:q4e,lights_lambert_pars_fragment:X4e,lights_pars_begin:Y4e,lights_toon_fragment:J4e,lights_toon_pars_fragment:Q4e,lights_phong_fragment:Z4e,lights_phong_pars_fragment:$4e,lights_physical_fragment:e5e,lights_physical_pars_fragment:t5e,lights_fragment_begin:i5e,lights_fragment_maps:r5e,lights_fragment_end:n5e,logdepthbuf_fragment:s5e,logdepthbuf_pars_fragment:o5e,logdepthbuf_pars_vertex:a5e,logdepthbuf_vertex:l5e,map_fragment:u5e,map_pars_fragment:h5e,map_particle_fragment:c5e,map_particle_pars_fragment:d5e,metalnessmap_fragment:p5e,metalnessmap_pars_fragment:f5e,morphcolor_vertex:m5e,morphnormal_vertex:g5e,morphtarget_pars_vertex:y5e,morphtarget_vertex:v5e,normal_fragment_begin:b5e,normal_fragment_maps:x5e,normal_pars_fragment:w5e,normal_pars_vertex:_5e,normal_vertex:S5e,normalmap_pars_fragment:A5e,clearcoat_normal_fragment_begin:E5e,clearcoat_normal_fragment_maps:M5e,clearcoat_pars_fragment:C5e,iridescence_pars_fragment:P5e,opaque_fragment:T5e,packing:R5e,premultiplied_alpha_fragment:k5e,project_vertex:D5e,dithering_fragment:I5e,dithering_pars_fragment:L5e,roughnessmap_fragment:B5e,roughnessmap_pars_fragment:O5e,shadowmap_pars_fragment:U5e,shadowmap_pars_vertex:N5e,shadowmap_vertex:F5e,shadowmask_pars_fragment:z5e,skinbase_vertex:H5e,skinning_pars_vertex:G5e,skinning_vertex:V5e,skinnormal_vertex:j5e,specularmap_fragment:W5e,specularmap_pars_fragment:q5e,tonemapping_fragment:X5e,tonemapping_pars_fragment:Y5e,transmission_fragment:K5e,transmission_pars_fragment:J5e,uv_pars_fragment:Q5e,uv_pars_vertex:Z5e,uv_vertex:$5e,worldpos_vertex:eHe,background_vert:tHe,background_frag:iHe,backgroundCube_vert:rHe,backgroundCube_frag:nHe,cube_vert:sHe,cube_frag:oHe,depth_vert:aHe,depth_frag:lHe,distanceRGBA_vert:uHe,distanceRGBA_frag:hHe,equirect_vert:cHe,equirect_frag:dHe,linedashed_vert:pHe,linedashed_frag:fHe,meshbasic_vert:mHe,meshbasic_frag:gHe,meshlambert_vert:yHe,meshlambert_frag:vHe,meshmatcap_vert:bHe,meshmatcap_frag:xHe,meshnormal_vert:wHe,meshnormal_frag:_He,meshphong_vert:SHe,meshphong_frag:AHe,meshphysical_vert:EHe,meshphysical_frag:MHe,meshtoon_vert:CHe,meshtoon_frag:PHe,points_vert:THe,points_frag:RHe,shadow_vert:kHe,shadow_frag:DHe,sprite_vert:IHe,sprite_frag:LHe},wt={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ei},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ei}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ei}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ei}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ei},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ei},normalScale:{value:new ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ei},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ei}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ei}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ei}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0},uvTransform:{value:new Ei}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new ot(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ei},alphaMap:{value:null},alphaMapTransform:{value:new Ei},alphaTest:{value:0}}},pu={basic:{uniforms:ko([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.fog]),vertexShader:_i.meshbasic_vert,fragmentShader:_i.meshbasic_frag},lambert:{uniforms:ko([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,wt.lights,{emissive:{value:new St(0)}}]),vertexShader:_i.meshlambert_vert,fragmentShader:_i.meshlambert_frag},phong:{uniforms:ko([wt.common,wt.specularmap,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,wt.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:_i.meshphong_vert,fragmentShader:_i.meshphong_frag},standard:{uniforms:ko([wt.common,wt.envmap,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.roughnessmap,wt.metalnessmap,wt.fog,wt.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_i.meshphysical_vert,fragmentShader:_i.meshphysical_frag},toon:{uniforms:ko([wt.common,wt.aomap,wt.lightmap,wt.emissivemap,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.gradientmap,wt.fog,wt.lights,{emissive:{value:new St(0)}}]),vertexShader:_i.meshtoon_vert,fragmentShader:_i.meshtoon_frag},matcap:{uniforms:ko([wt.common,wt.bumpmap,wt.normalmap,wt.displacementmap,wt.fog,{matcap:{value:null}}]),vertexShader:_i.meshmatcap_vert,fragmentShader:_i.meshmatcap_frag},points:{uniforms:ko([wt.points,wt.fog]),vertexShader:_i.points_vert,fragmentShader:_i.points_frag},dashed:{uniforms:ko([wt.common,wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_i.linedashed_vert,fragmentShader:_i.linedashed_frag},depth:{uniforms:ko([wt.common,wt.displacementmap]),vertexShader:_i.depth_vert,fragmentShader:_i.depth_frag},normal:{uniforms:ko([wt.common,wt.bumpmap,wt.normalmap,wt.displacementmap,{opacity:{value:1}}]),vertexShader:_i.meshnormal_vert,fragmentShader:_i.meshnormal_frag},sprite:{uniforms:ko([wt.sprite,wt.fog]),vertexShader:_i.sprite_vert,fragmentShader:_i.sprite_frag},background:{uniforms:{uvTransform:{value:new Ei},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:_i.background_vert,fragmentShader:_i.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:_i.backgroundCube_vert,fragmentShader:_i.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_i.cube_vert,fragmentShader:_i.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_i.equirect_vert,fragmentShader:_i.equirect_frag},distanceRGBA:{uniforms:ko([wt.common,wt.displacementmap,{referencePosition:{value:new ue},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_i.distanceRGBA_vert,fragmentShader:_i.distanceRGBA_frag},shadow:{uniforms:ko([wt.lights,wt.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:_i.shadow_vert,fragmentShader:_i.shadow_frag}};pu.physical={uniforms:ko([pu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ei},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ei},clearcoatNormalScale:{value:new ot(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ei},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ei},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ei},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ei},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ei},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ei},transmissionSamplerSize:{value:new ot},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ei},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ei},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ei},anisotropyVector:{value:new ot},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ei}}]),vertexShader:_i.meshphysical_vert,fragmentShader:_i.meshphysical_frag};const IE={r:0,b:0,g:0};function BHe(t,e,i,r,n,s,o){const a=new St(0);let l=s===!0?0:1,u,c,h=null,d=0,p=null;function f(g,y){let v=!1,b=y.isScene===!0?y.background:null;b&&b.isTexture&&(b=(y.backgroundBlurriness>0?i:e).get(b)),b===null?m(a,l):b&&b.isColor&&(m(b,1),v=!0);const _=t.xr.getEnvironmentBlendMode();_==="additive"?r.buffers.color.setClear(0,0,0,1,o):_==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(t.autoClear||v)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),b&&(b.isCubeTexture||b.mapping===tb)?(c===void 0&&(c=new _n(new lg(1,1,1),new Ru({name:"BackgroundCubeMaterial",uniforms:x0(pu.backgroundCube.uniforms),vertexShader:pu.backgroundCube.vertexShader,fragmentShader:pu.backgroundCube.fragmentShader,side:jo,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(A,S,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=b,c.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=or.getTransfer(b.colorSpace)!==_r,(h!==b||d!==b.version||p!==t.toneMapping)&&(c.material.needsUpdate=!0,h=b,d=b.version,p=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null)):b&&b.isTexture&&(u===void 0&&(u=new _n(new rb(2,2),new Ru({name:"BackgroundMaterial",uniforms:x0(pu.background.uniforms),vertexShader:pu.background.vertexShader,fragmentShader:pu.background.fragmentShader,side:zh,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=b,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=or.getTransfer(b.colorSpace)!==_r,b.matrixAutoUpdate===!0&&b.updateMatrix(),u.material.uniforms.uvTransform.value.copy(b.matrix),(h!==b||d!==b.version||p!==t.toneMapping)&&(u.material.needsUpdate=!0,h=b,d=b.version,p=t.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null))}function m(g,y){g.getRGB(IE,Une(t)),r.buffers.color.setClear(IE.r,IE.g,IE.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(g,y=1){a.set(g),l=y,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(a,l)},render:f}}function OHe(t,e,i,r){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=g(null);let u=l,c=!1;function h(D,F,H,z,B){let j=!1;if(o){const V=m(z,H,F);u!==V&&(u=V,p(u.object)),j=y(D,z,H,B),j&&v(D,z,H,B)}else{const V=F.wireframe===!0;(u.geometry!==z.id||u.program!==H.id||u.wireframe!==V)&&(u.geometry=z.id,u.program=H.id,u.wireframe=V,j=!0)}B!==null&&i.update(B,t.ELEMENT_ARRAY_BUFFER),(j||c)&&(c=!1,M(D,F,H,z),B!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.get(B).buffer))}function d(){return r.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function p(D){return r.isWebGL2?t.bindVertexArray(D):s.bindVertexArrayOES(D)}function f(D){return r.isWebGL2?t.deleteVertexArray(D):s.deleteVertexArrayOES(D)}function m(D,F,H){const z=H.wireframe===!0;let B=a[D.id];B===void 0&&(B={},a[D.id]=B);let j=B[F.id];j===void 0&&(j={},B[F.id]=j);let V=j[z];return V===void 0&&(V=g(d()),j[z]=V),V}function g(D){const F=[],H=[],z=[];for(let B=0;B<n;B++)F[B]=0,H[B]=0,z[B]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:H,attributeDivisors:z,object:D,attributes:{},index:null}}function y(D,F,H,z){const B=u.attributes,j=F.attributes;let V=0;const q=H.getAttributes();for(const K in q)if(q[K].location>=0){const Z=B[K];let oe=j[K];if(oe===void 0&&(K==="instanceMatrix"&&D.instanceMatrix&&(oe=D.instanceMatrix),K==="instanceColor"&&D.instanceColor&&(oe=D.instanceColor)),Z===void 0||Z.attribute!==oe||oe&&Z.data!==oe.data)return!0;V++}return u.attributesNum!==V||u.index!==z}function v(D,F,H,z){const B={},j=F.attributes;let V=0;const q=H.getAttributes();for(const K in q)if(q[K].location>=0){let Z=j[K];Z===void 0&&(K==="instanceMatrix"&&D.instanceMatrix&&(Z=D.instanceMatrix),K==="instanceColor"&&D.instanceColor&&(Z=D.instanceColor));const oe={};oe.attribute=Z,Z&&Z.data&&(oe.data=Z.data),B[K]=oe,V++}u.attributes=B,u.attributesNum=V,u.index=z}function b(){const D=u.newAttributes;for(let F=0,H=D.length;F<H;F++)D[F]=0}function _(D){A(D,0)}function A(D,F){const H=u.newAttributes,z=u.enabledAttributes,B=u.attributeDivisors;H[D]=1,z[D]===0&&(t.enableVertexAttribArray(D),z[D]=1),B[D]!==F&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,F),B[D]=F)}function S(){const D=u.newAttributes,F=u.enabledAttributes;for(let H=0,z=F.length;H<z;H++)F[H]!==D[H]&&(t.disableVertexAttribArray(H),F[H]=0)}function E(D,F,H,z,B,j,V){V===!0?t.vertexAttribIPointer(D,F,H,B,j):t.vertexAttribPointer(D,F,H,z,B,j)}function M(D,F,H,z){if(r.isWebGL2===!1&&(D.isInstancedMesh||z.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const B=z.attributes,j=H.getAttributes(),V=F.defaultAttributeValues;for(const q in j){const K=j[q];if(K.location>=0){let le=B[q];if(le===void 0&&(q==="instanceMatrix"&&D.instanceMatrix&&(le=D.instanceMatrix),q==="instanceColor"&&D.instanceColor&&(le=D.instanceColor)),le!==void 0){const Z=le.normalized,oe=le.itemSize,ae=i.get(le);if(ae===void 0)continue;const ve=ae.buffer,ye=ae.type,pe=ae.bytesPerElement,Se=r.isWebGL2===!0&&(ye===t.INT||ye===t.UNSIGNED_INT||le.gpuType===A4);if(le.isInterleavedBufferAttribute){const be=le.data,ee=be.stride,_e=le.offset;if(be.isInstancedInterleavedBuffer){for(let Me=0;Me<K.locationSize;Me++)A(K.location+Me,be.meshPerAttribute);D.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=be.meshPerAttribute*be.count)}else for(let Me=0;Me<K.locationSize;Me++)_(K.location+Me);t.bindBuffer(t.ARRAY_BUFFER,ve);for(let Me=0;Me<K.locationSize;Me++)E(K.location+Me,oe/K.locationSize,ye,Z,ee*pe,(_e+oe/K.locationSize*Me)*pe,Se)}else{if(le.isInstancedBufferAttribute){for(let be=0;be<K.locationSize;be++)A(K.location+be,le.meshPerAttribute);D.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let be=0;be<K.locationSize;be++)_(K.location+be);t.bindBuffer(t.ARRAY_BUFFER,ve);for(let be=0;be<K.locationSize;be++)E(K.location+be,oe/K.locationSize,ye,Z,oe*pe,oe/K.locationSize*be*pe,Se)}}else if(V!==void 0){const Z=V[q];if(Z!==void 0)switch(Z.length){case 2:t.vertexAttrib2fv(K.location,Z);break;case 3:t.vertexAttrib3fv(K.location,Z);break;case 4:t.vertexAttrib4fv(K.location,Z);break;default:t.vertexAttrib1fv(K.location,Z)}}}}S()}function R(){L();for(const D in a){const F=a[D];for(const H in F){const z=F[H];for(const B in z)f(z[B].object),delete z[B];delete F[H]}delete a[D]}}function C(D){if(a[D.id]===void 0)return;const F=a[D.id];for(const H in F){const z=F[H];for(const B in z)f(z[B].object),delete z[B];delete F[H]}delete a[D.id]}function T(D){for(const F in a){const H=a[F];if(H[D.id]===void 0)continue;const z=H[D.id];for(const B in z)f(z[B].object),delete z[B];delete H[D.id]}}function L(){I(),c=!0,u!==l&&(u=l,p(u.object))}function I(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:L,resetDefaultState:I,dispose:R,releaseStatesOfGeometry:C,releaseStatesOfProgram:T,initAttributes:b,enableAttribute:_,disableUnusedAttributes:S}}function UHe(t,e,i,r){const n=r.isWebGL2;let s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),i.update(h,s,1)}function l(c,h,d){if(d===0)return;let p,f;if(n)p=t,f="drawArraysInstanced";else if(p=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",p===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[f](s,c,h,d),i.update(h,s,d)}function u(c,h,d){if(d===0)return;const p=e.get("WEBGL_multi_draw");if(p===null)for(let f=0;f<d;f++)this.render(c[f],h[f]);else{p.multiDrawArraysWEBGL(s,c,0,h,0,d);let f=0;for(let m=0;m<d;m++)f+=h[m];i.update(f,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=u}function NHe(t,e,i){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const E=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(E){if(E==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=i.precision!==void 0?i.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),c=i.logarithmicDepthBuffer===!0,h=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_TEXTURE_SIZE),f=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),m=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),y=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),b=d>0,_=o||e.has("OES_texture_float"),A=b&&_,S=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:n,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:m,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:v,vertexTextures:b,floatFragmentTextures:_,floatVertexTextures:A,maxSamples:S}}function FHe(t){const e=this;let i=null,r=0,n=!1,s=!1;const o=new Yd,a=new Ei,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const p=h.length!==0||d||r!==0||n;return n=d,r=h.length,p},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=c(h,d,0)},this.setState=function(h,d,p){const f=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,y=t.get(h);if(!n||f===null||f.length===0||s&&!g)s?c(null):u();else{const v=s?0:r,b=v*4;let _=y.clippingState||null;l.value=_,_=c(f,d,b,p);for(let A=0;A!==b;++A)_[A]=i[A];y.clippingState=_,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}};function u(){l.value!==i&&(l.value=i,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(h,d,p,f){const m=h!==null?h.length:0;let g=null;if(m!==0){if(g=l.value,f!==!0||g===null){const y=p+m*4,v=d.matrixWorldInverse;a.getNormalMatrix(v),(g===null||g.length<y)&&(g=new Float32Array(y));for(let b=0,_=p;b!==m;++b,_+=4)o.copy(h[b]).applyMatrix4(v,a),o.normal.toArray(g,_),g[_+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function zHe(t){let e=new WeakMap;function i(o,a){return a===b1?o.mapping=nd:a===x1&&(o.mapping=zp),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===b1||a===x1)if(e.has(o)){const l=e.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new zne(l.height);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",n),i(u.texture,o.mapping)}else return null}}return o}function n(o){const a=o.target;a.removeEventListener("dispose",n);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class Qp extends p_{constructor(e=-1,i=1,r=1,n=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=r,this.bottom=n,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,r,n,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=n+i,l=n-i;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const pv=4,L7=[.125,.215,.35,.446,.526,.582],Vf=20,hI=new Qp,B7=new St;let cI=null,dI=0,pI=0;const Uf=(1+Math.sqrt(5))/2,_y=1/Uf,O7=[new ue(1,1,1),new ue(-1,1,1),new ue(1,1,-1),new ue(-1,1,-1),new ue(0,Uf,_y),new ue(0,Uf,-_y),new ue(_y,0,Uf),new ue(-_y,0,Uf),new ue(Uf,_y,0),new ue(-Uf,_y,0)];class YU{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,r=.1,n=100){cI=this._renderer.getRenderTarget(),dI=this._renderer.getActiveCubeFace(),pI=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,n,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=F7(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=N7(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(cI,dI,pI),e.scissorTest=!1,LE(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===nd||e.mapping===zp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),cI=this._renderer.getRenderTarget(),dI=this._renderer.getActiveCubeFace(),pI=this._renderer.getActiveMipmapLevel();const r=i||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,r={magFilter:Rr,minFilter:Rr,generateMipmaps:!1,type:y0,format:Fo,colorSpace:Hh,depthBuffer:!1},n=U7(e,i,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=U7(e,i,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=HHe(s)),this._blurMaterial=GHe(s,e,i)}return n}_compileMaterial(e){const i=new _n(this._lodPlanes[0],e);this._renderer.compile(i,hI)}_sceneToCubeUV(e,i,r,n){const a=new xn(90,1,i,r),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,d=c.toneMapping;c.getClearColor(B7),c.toneMapping=Rh,c.autoClear=!1;const p=new Ga({name:"PMREM.Background",side:jo,depthWrite:!1,depthTest:!1}),f=new _n(new lg,p);let m=!1;const g=e.background;g?g.isColor&&(p.color.copy(g),e.background=null,m=!0):(p.color.copy(B7),m=!0);for(let y=0;y<6;y++){const v=y%3;v===0?(a.up.set(0,l[y],0),a.lookAt(u[y],0,0)):v===1?(a.up.set(0,0,l[y]),a.lookAt(0,u[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,u[y]));const b=this._cubeSize;LE(n,v*b,y>2?b:0,b,b),c.setRenderTarget(n),m&&c.render(f,a),c.render(e,a)}f.geometry.dispose(),f.material.dispose(),c.toneMapping=d,c.autoClear=h,e.background=g}_textureToCubeUV(e,i){const r=this._renderer,n=e.mapping===nd||e.mapping===zp;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=F7()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=N7());const s=n?this._cubemapMaterial:this._equirectMaterial,o=new _n(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;LE(i,0,0,3*l,2*l),r.setRenderTarget(i),r.render(o,hI)}_applyPMREM(e){const i=this._renderer,r=i.autoClear;i.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){const s=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),o=O7[(n-1)%O7.length];this._blur(e,n-1,n,s,o)}i.autoClear=r}_blur(e,i,r,n,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,i,r,n,"latitudinal",s),this._halfBlur(o,e,r,r,n,"longitudinal",s)}_halfBlur(e,i,r,n,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new _n(this._lodPlanes[n],u),d=u.uniforms,p=this._sizeLods[r]-1,f=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*Vf-1),m=s/f,g=isFinite(s)?1+Math.floor(c*m):Vf;g>Vf&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Vf}`);const y=[];let v=0;for(let E=0;E<Vf;++E){const M=E/m,R=Math.exp(-M*M/2);y.push(R),E===0?v+=R:E<g&&(v+=2*R)}for(let E=0;E<y.length;E++)y[E]=y[E]/v;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=y,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:b}=this;d.dTheta.value=f,d.mipInt.value=b-r;const _=this._sizeLods[n],A=3*_*(n>b-pv?n-b+pv:0),S=4*(this._cubeSize-_);LE(i,A,S,3*_,2*_),l.setRenderTarget(i),l.render(h,hI)}}function HHe(t){const e=[],i=[],r=[];let n=t;const s=t-pv+1+L7.length;for(let o=0;o<s;o++){const a=Math.pow(2,n);i.push(a);let l=1/a;o>t-pv?l=L7[o-t+pv-1]:o===0&&(l=0),r.push(l);const u=1/(a-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],p=6,f=6,m=3,g=2,y=1,v=new Float32Array(m*f*p),b=new Float32Array(g*f*p),_=new Float32Array(y*f*p);for(let S=0;S<p;S++){const E=S%3*2/3-1,M=S>2?0:-1,R=[E,M,0,E+2/3,M,0,E+2/3,M+1,0,E,M,0,E+2/3,M+1,0,E,M+1,0];v.set(R,m*f*S),b.set(d,g*f*S);const C=[S,S,S,S,S,S];_.set(C,y*f*S)}const A=new bi;A.setAttribute("position",new Gi(v,m)),A.setAttribute("uv",new Gi(b,g)),A.setAttribute("faceIndex",new Gi(_,y)),e.push(A),n>pv&&n--}return{lodPlanes:e,sizeLods:i,sigmas:r}}function U7(t,e,i){const r=new Tu(t,e,i);return r.texture.mapping=tb,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function LE(t,e,i,r,n){t.viewport.set(e,i,r,n),t.scissor.set(e,i,r,n)}function GHe(t,e,i){const r=new Float32Array(Vf),n=new ue(0,1,0);return new Ru({name:"SphericalGaussianBlur",defines:{n:Vf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:z4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Kc,depthTest:!1,depthWrite:!1})}function N7(){return new Ru({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:z4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Kc,depthTest:!1,depthWrite:!1})}function F7(){return new Ru({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:z4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Kc,depthTest:!1,depthWrite:!1})}function z4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function VHe(t){let e=new WeakMap,i=null;function r(a){if(a&&a.isTexture){const l=a.mapping,u=l===b1||l===x1,c=l===nd||l===zp;if(u||c)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return i===null&&(i=new YU(t)),h=u?i.fromEquirectangular(a,h):i.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(u&&h&&h.height>0||c&&h&&n(h)){i===null&&(i=new YU(t));const d=u?i.fromEquirectangular(a):i.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function n(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:r,dispose:o}}function jHe(t){const e={};function i(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return e[r]=n,n}return{has:function(r){return i(r)!==null},init:function(r){r.isWebGL2?(i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance")):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(r){const n=i(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}function WHe(t,e,i,r){const n={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const f in d.attributes)e.remove(d.attributes[f]);for(const f in d.morphAttributes){const m=d.morphAttributes[f];for(let g=0,y=m.length;g<y;g++)e.remove(m[g])}d.removeEventListener("dispose",o),delete n[d.id];const p=s.get(d);p&&(e.remove(p),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(h,d){return n[d.id]===!0||(d.addEventListener("dispose",o),n[d.id]=!0,i.memory.geometries++),d}function l(h){const d=h.attributes;for(const f in d)e.update(d[f],t.ARRAY_BUFFER);const p=h.morphAttributes;for(const f in p){const m=p[f];for(let g=0,y=m.length;g<y;g++)e.update(m[g],t.ARRAY_BUFFER)}}function u(h){const d=[],p=h.index,f=h.attributes.position;let m=0;if(p!==null){const v=p.array;m=p.version;for(let b=0,_=v.length;b<_;b+=3){const A=v[b+0],S=v[b+1],E=v[b+2];d.push(A,S,S,E,E,A)}}else if(f!==void 0){const v=f.array;m=f.version;for(let b=0,_=v.length/3-1;b<_;b+=3){const A=b+0,S=b+1,E=b+2;d.push(A,S,S,E,E,A)}}else return;const g=new(Ine(d)?F4:N4)(d,1);g.version=m;const y=s.get(h);y&&e.remove(y),s.set(h,g)}function c(h){const d=s.get(h);if(d){const p=h.index;p!==null&&d.version<p.version&&u(h)}else u(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function qHe(t,e,i,r){const n=r.isWebGL2;let s;function o(p){s=p}let a,l;function u(p){a=p.type,l=p.bytesPerElement}function c(p,f){t.drawElements(s,f,a,p*l),i.update(f,s,1)}function h(p,f,m){if(m===0)return;let g,y;if(n)g=t,y="drawElementsInstanced";else if(g=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",g===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[y](s,f,a,p*l,m),i.update(f,s,m)}function d(p,f,m){if(m===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let y=0;y<m;y++)this.render(p[y]/l,f[y]);else{g.multiDrawElementsWEBGL(s,f,0,a,p,0,m);let y=0;for(let v=0;v<m;v++)y+=f[v];i.update(y,s,1)}}this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=h,this.renderMultiDraw=d}function XHe(t){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(i.calls++,o){case t.TRIANGLES:i.triangles+=a*(s/3);break;case t.LINES:i.lines+=a*(s/2);break;case t.LINE_STRIP:i.lines+=a*(s-1);break;case t.LINE_LOOP:i.lines+=a*s;break;case t.POINTS:i.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:n,update:r}}function YHe(t,e){return t[0]-e[0]}function KHe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function JHe(t,e,i){const r={},n=new Float32Array(8),s=new WeakMap,o=new lr,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,c,h){const d=u.morphTargetInfluences;if(e.isWebGL2===!0){const f=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,m=f!==void 0?f.length:0;let g=s.get(c);if(g===void 0||g.count!==m){let F=function(){I.dispose(),s.delete(c),c.removeEventListener("dispose",F)};var p=F;g!==void 0&&g.texture.dispose();const b=c.morphAttributes.position!==void 0,_=c.morphAttributes.normal!==void 0,A=c.morphAttributes.color!==void 0,S=c.morphAttributes.position||[],E=c.morphAttributes.normal||[],M=c.morphAttributes.color||[];let R=0;b===!0&&(R=1),_===!0&&(R=2),A===!0&&(R=3);let C=c.attributes.position.count*R,T=1;C>e.maxTextureSize&&(T=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const L=new Float32Array(C*T*4*m),I=new aT(L,C,T,m);I.type=Rl,I.needsUpdate=!0;const D=R*4;for(let H=0;H<m;H++){const z=S[H],B=E[H],j=M[H],V=C*T*4*H;for(let q=0;q<z.count;q++){const K=q*D;b===!0&&(o.fromBufferAttribute(z,q),L[V+K+0]=o.x,L[V+K+1]=o.y,L[V+K+2]=o.z,L[V+K+3]=0),_===!0&&(o.fromBufferAttribute(B,q),L[V+K+4]=o.x,L[V+K+5]=o.y,L[V+K+6]=o.z,L[V+K+7]=0),A===!0&&(o.fromBufferAttribute(j,q),L[V+K+8]=o.x,L[V+K+9]=o.y,L[V+K+10]=o.z,L[V+K+11]=j.itemSize===4?o.w:1)}}g={count:m,texture:I,size:new ot(C,T)},s.set(c,g),c.addEventListener("dispose",F)}let y=0;for(let b=0;b<d.length;b++)y+=d[b];const v=c.morphTargetsRelative?1:1-y;h.getUniforms().setValue(t,"morphTargetBaseInfluence",v),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",g.texture,i),h.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{const f=d===void 0?0:d.length;let m=r[c.id];if(m===void 0||m.length!==f){m=[];for(let _=0;_<f;_++)m[_]=[_,0];r[c.id]=m}for(let _=0;_<f;_++){const A=m[_];A[0]=_,A[1]=d[_]}m.sort(KHe);for(let _=0;_<8;_++)_<f&&m[_][1]?(a[_][0]=m[_][0],a[_][1]=m[_][1]):(a[_][0]=Number.MAX_SAFE_INTEGER,a[_][1]=0);a.sort(YHe);const g=c.morphAttributes.position,y=c.morphAttributes.normal;let v=0;for(let _=0;_<8;_++){const A=a[_],S=A[0],E=A[1];S!==Number.MAX_SAFE_INTEGER&&E?(g&&c.getAttribute("morphTarget"+_)!==g[S]&&c.setAttribute("morphTarget"+_,g[S]),y&&c.getAttribute("morphNormal"+_)!==y[S]&&c.setAttribute("morphNormal"+_,y[S]),n[_]=E,v+=E):(g&&c.hasAttribute("morphTarget"+_)===!0&&c.deleteAttribute("morphTarget"+_),y&&c.hasAttribute("morphNormal"+_)===!0&&c.deleteAttribute("morphNormal"+_),n[_]=0)}const b=c.morphTargetsRelative?1:1-v;h.getUniforms().setValue(t,"morphTargetBaseInfluence",b),h.getUniforms().setValue(t,"morphTargetInfluences",n)}}return{update:l}}function QHe(t,e,i,r){let n=new WeakMap;function s(l){const u=r.render.frame,c=l.geometry,h=e.get(l,c);if(n.get(h)!==u&&(e.update(h),n.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.get(l)!==u&&(i.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&i.update(l.instanceColor,t.ARRAY_BUFFER),n.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;n.get(d)!==u&&(d.update(),n.set(d,u))}return h}function o(){n=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),i.remove(u.instanceMatrix),u.instanceColor!==null&&i.remove(u.instanceColor)}return{update:s,dispose:o}}class H4 extends Ir{constructor(e,i,r,n,s,o,a,l,u,c){if(c=c!==void 0?c:Dp,c!==Dp&&c!==Hm)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Dp&&(r=Hc),r===void 0&&c===Hm&&(r=kp),super(null,n,s,o,a,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=a!==void 0?a:an,this.minFilter=l!==void 0?l:an,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}const Gne=new Ir,Vne=new H4(1,1);Vne.compareFunction=L4;const jne=new aT,Wne=new U4,qne=new f_,z7=[],H7=[],G7=new Float32Array(16),V7=new Float32Array(9),j7=new Float32Array(4);function nb(t,e,i){const r=t[0];if(r<=0||r>0)return t;const n=e*i;let s=z7[n];if(s===void 0&&(s=new Float32Array(n),z7[n]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(s,a)}return s}function as(t,e){if(t.length!==e.length)return!1;for(let i=0,r=t.length;i<r;i++)if(t[i]!==e[i])return!1;return!0}function ls(t,e){for(let i=0,r=e.length;i<r;i++)t[i]=e[i]}function lT(t,e){let i=H7[e];i===void 0&&(i=new Int32Array(e),H7[e]=i);for(let r=0;r!==e;++r)i[r]=t.allocateTextureUnit();return i}function ZHe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function $He(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(as(i,e))return;t.uniform2fv(this.addr,e),ls(i,e)}}function eGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(as(i,e))return;t.uniform3fv(this.addr,e),ls(i,e)}}function tGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(as(i,e))return;t.uniform4fv(this.addr,e),ls(i,e)}}function iGe(t,e){const i=this.cache,r=e.elements;if(r===void 0){if(as(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),ls(i,e)}else{if(as(i,r))return;j7.set(r),t.uniformMatrix2fv(this.addr,!1,j7),ls(i,r)}}function rGe(t,e){const i=this.cache,r=e.elements;if(r===void 0){if(as(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),ls(i,e)}else{if(as(i,r))return;V7.set(r),t.uniformMatrix3fv(this.addr,!1,V7),ls(i,r)}}function nGe(t,e){const i=this.cache,r=e.elements;if(r===void 0){if(as(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),ls(i,e)}else{if(as(i,r))return;G7.set(r),t.uniformMatrix4fv(this.addr,!1,G7),ls(i,r)}}function sGe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function oGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(as(i,e))return;t.uniform2iv(this.addr,e),ls(i,e)}}function aGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(as(i,e))return;t.uniform3iv(this.addr,e),ls(i,e)}}function lGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(as(i,e))return;t.uniform4iv(this.addr,e),ls(i,e)}}function uGe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function hGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(as(i,e))return;t.uniform2uiv(this.addr,e),ls(i,e)}}function cGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(as(i,e))return;t.uniform3uiv(this.addr,e),ls(i,e)}}function dGe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(as(i,e))return;t.uniform4uiv(this.addr,e),ls(i,e)}}function pGe(t,e,i){const r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n);const s=this.type===t.SAMPLER_2D_SHADOW?Vne:Gne;i.setTexture2D(e||s,n)}function fGe(t,e,i){const r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(e||Wne,n)}function mGe(t,e,i){const r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTextureCube(e||qne,n)}function gGe(t,e,i){const r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(t.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(e||jne,n)}function yGe(t){switch(t){case 5126:return ZHe;case 35664:return $He;case 35665:return eGe;case 35666:return tGe;case 35674:return iGe;case 35675:return rGe;case 35676:return nGe;case 5124:case 35670:return sGe;case 35667:case 35671:return oGe;case 35668:case 35672:return aGe;case 35669:case 35673:return lGe;case 5125:return uGe;case 36294:return hGe;case 36295:return cGe;case 36296:return dGe;case 35678:case 36198:case 36298:case 36306:case 35682:return pGe;case 35679:case 36299:case 36307:return fGe;case 35680:case 36300:case 36308:case 36293:return mGe;case 36289:case 36303:case 36311:case 36292:return gGe}}function vGe(t,e){t.uniform1fv(this.addr,e)}function bGe(t,e){const i=nb(e,this.size,2);t.uniform2fv(this.addr,i)}function xGe(t,e){const i=nb(e,this.size,3);t.uniform3fv(this.addr,i)}function wGe(t,e){const i=nb(e,this.size,4);t.uniform4fv(this.addr,i)}function _Ge(t,e){const i=nb(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function SGe(t,e){const i=nb(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function AGe(t,e){const i=nb(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function EGe(t,e){t.uniform1iv(this.addr,e)}function MGe(t,e){t.uniform2iv(this.addr,e)}function CGe(t,e){t.uniform3iv(this.addr,e)}function PGe(t,e){t.uniform4iv(this.addr,e)}function TGe(t,e){t.uniform1uiv(this.addr,e)}function RGe(t,e){t.uniform2uiv(this.addr,e)}function kGe(t,e){t.uniform3uiv(this.addr,e)}function DGe(t,e){t.uniform4uiv(this.addr,e)}function IGe(t,e,i){const r=this.cache,n=e.length,s=lT(i,n);as(r,s)||(t.uniform1iv(this.addr,s),ls(r,s));for(let o=0;o!==n;++o)i.setTexture2D(e[o]||Gne,s[o])}function LGe(t,e,i){const r=this.cache,n=e.length,s=lT(i,n);as(r,s)||(t.uniform1iv(this.addr,s),ls(r,s));for(let o=0;o!==n;++o)i.setTexture3D(e[o]||Wne,s[o])}function BGe(t,e,i){const r=this.cache,n=e.length,s=lT(i,n);as(r,s)||(t.uniform1iv(this.addr,s),ls(r,s));for(let o=0;o!==n;++o)i.setTextureCube(e[o]||qne,s[o])}function OGe(t,e,i){const r=this.cache,n=e.length,s=lT(i,n);as(r,s)||(t.uniform1iv(this.addr,s),ls(r,s));for(let o=0;o!==n;++o)i.setTexture2DArray(e[o]||jne,s[o])}function UGe(t){switch(t){case 5126:return vGe;case 35664:return bGe;case 35665:return xGe;case 35666:return wGe;case 35674:return _Ge;case 35675:return SGe;case 35676:return AGe;case 5124:case 35670:return EGe;case 35667:case 35671:return MGe;case 35668:case 35672:return CGe;case 35669:case 35673:return PGe;case 5125:return TGe;case 36294:return RGe;case 36295:return kGe;case 36296:return DGe;case 35678:case 36198:case 36298:case 36306:case 35682:return IGe;case 35679:case 36299:case 36307:return LGe;case 35680:case 36300:case 36308:case 36293:return BGe;case 36289:case 36303:case 36311:case 36292:return OGe}}class NGe{constructor(e,i,r){this.id=e,this.addr=r,this.cache=[],this.type=i.type,this.setValue=yGe(i.type)}}class FGe{constructor(e,i,r){this.id=e,this.addr=r,this.cache=[],this.type=i.type,this.size=i.size,this.setValue=UGe(i.type)}}class zGe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,r){const n=this.seq;for(let s=0,o=n.length;s!==o;++s){const a=n[s];a.setValue(e,i[a.id],r)}}}const fI=/(\w+)(\])?(\[|\.)?/g;function W7(t,e){t.seq.push(e),t.map[e.id]=e}function HGe(t,e,i){const r=t.name,n=r.length;for(fI.lastIndex=0;;){const s=fI.exec(r),o=fI.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===n){W7(i,u===void 0?new NGe(a,t,e):new FGe(a,t,e));break}else{let h=i.map[a];h===void 0&&(h=new zGe(a),W7(i,h)),i=h}}}class oC{constructor(e,i){this.seq=[],this.map={};const r=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){const s=e.getActiveUniform(i,n),o=e.getUniformLocation(i,s.name);HGe(s,o,this)}}setValue(e,i,r,n){const s=this.map[i];s!==void 0&&s.setValue(e,r,n)}setOptional(e,i,r){const n=i[r];n!==void 0&&this.setValue(e,r,n)}static upload(e,i,r,n){for(let s=0,o=i.length;s!==o;++s){const a=i[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,n)}}static seqWithValue(e,i){const r=[];for(let n=0,s=e.length;n!==s;++n){const o=e[n];o.id in i&&r.push(o)}return r}}function q7(t,e,i){const r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}const GGe=37297;let VGe=0;function jGe(t,e){const i=t.split(`
`),r=[],n=Math.max(e-6,0),s=Math.min(e+6,i.length);for(let o=n;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return r.join(`
`)}function WGe(t){const e=or.getPrimaries(or.workingColorSpace),i=or.getPrimaries(t);let r;switch(e===i?r="":e===E1&&i===A1?r="LinearDisplayP3ToLinearSRGB":e===A1&&i===E1&&(r="LinearSRGBToLinearDisplayP3"),t){case Hh:case c_:return[r,"LinearTransferOETF"];case es:case oT:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[r,"LinearTransferOETF"]}}function X7(t,e,i){const r=t.getShaderParameter(e,t.COMPILE_STATUS),n=t.getShaderInfoLog(e).trim();if(r&&n==="")return"";const s=/ERROR: 0:(\d+)/.exec(n);if(s){const o=parseInt(s[1]);return i.toUpperCase()+`

`+n+`

`+jGe(t.getShaderSource(e),o)}else return n}function qGe(t,e){const i=WGe(e);return`vec4 ${t}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function XGe(t,e){let i;switch(e){case nne:i="Linear";break;case sne:i="Reinhard";break;case one:i="OptimizedCineon";break;case S4:i="ACESFilmic";break;case lne:i="AgX";break;case ane:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function YGe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.alphaToCoverage||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(fv).join(`
`)}function KGe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(fv).join(`
`)}function JGe(t){const e=[];for(const i in t){const r=t[i];r!==!1&&e.push("#define "+i+" "+r)}return e.join(`
`)}function QGe(t,e){const i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){const s=t.getActiveAttrib(e,n),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),i[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function fv(t){return t!==""}function Y7(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function K7(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ZGe=/^[ \t]*#include +<([\w\d./]+)>/gm;function KU(t){return t.replace(ZGe,eVe)}const $Ge=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function eVe(t,e){let i=_i[e];if(i===void 0){const r=$Ge.get(e);if(r!==void 0)i=_i[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return KU(i)}const tVe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function J7(t){return t.replace(tVe,iVe)}function iVe(t,e,i,r){let n="";for(let s=parseInt(e);s<parseInt(i);s++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function Q7(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	`;return t.isWebGL2&&(e+=`precision ${t.precision} sampler3D;
		precision ${t.precision} sampler2DArray;
		precision ${t.precision} sampler2DShadow;
		precision ${t.precision} samplerCubeShadow;
		precision ${t.precision} sampler2DArrayShadow;
		precision ${t.precision} isampler2D;
		precision ${t.precision} isampler3D;
		precision ${t.precision} isamplerCube;
		precision ${t.precision} isampler2DArray;
		precision ${t.precision} usampler2D;
		precision ${t.precision} usampler3D;
		precision ${t.precision} usamplerCube;
		precision ${t.precision} usampler2DArray;
		`),t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function rVe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===iT?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===vw?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===lu&&(e="SHADOWMAP_TYPE_VSM"),e}function nVe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case nd:case zp:e="ENVMAP_TYPE_CUBE";break;case tb:e="ENVMAP_TYPE_CUBE_UV";break}return e}function sVe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case zp:e="ENVMAP_MODE_REFRACTION";break}return e}function oVe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case h_:e="ENVMAP_BLENDING_MULTIPLY";break;case ine:e="ENVMAP_BLENDING_MIX";break;case rne:e="ENVMAP_BLENDING_ADD";break}return e}function aVe(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:r,maxMip:i}}function lVe(t,e,i,r){const n=t.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=rVe(i),u=nVe(i),c=sVe(i),h=oVe(i),d=aVe(i),p=i.isWebGL2?"":YGe(i),f=KGe(i),m=JGe(s),g=n.createProgram();let y,v,b=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(y=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(fv).join(`
`),y.length>0&&(y+=`
`),v=[p,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m].filter(fv).join(`
`),v.length>0&&(v+=`
`)):(y=[Q7(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(fv).join(`
`),v=[p,Q7(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,m,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Rh?"#define TONE_MAPPING":"",i.toneMapping!==Rh?_i.tonemapping_pars_fragment:"",i.toneMapping!==Rh?XGe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",_i.colorspace_pars_fragment,qGe("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(fv).join(`
`)),o=KU(o),o=Y7(o,i),o=K7(o,i),a=KU(a),a=Y7(a,i),a=K7(a,i),o=J7(o),a=J7(a),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,y=[f,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["precision mediump sampler2DArray;","#define varying in",i.glslVersion===qU?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===qU?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const _=b+y+o,A=b+v+a,S=q7(n,n.VERTEX_SHADER,_),E=q7(n,n.FRAGMENT_SHADER,A);n.attachShader(g,S),n.attachShader(g,E),i.index0AttributeName!==void 0?n.bindAttribLocation(g,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(g,0,"position"),n.linkProgram(g);function M(L){if(t.debug.checkShaderErrors){const I=n.getProgramInfoLog(g).trim(),D=n.getShaderInfoLog(S).trim(),F=n.getShaderInfoLog(E).trim();let H=!0,z=!0;if(n.getProgramParameter(g,n.LINK_STATUS)===!1)if(H=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(n,g,S,E);else{const B=X7(n,S,"vertex"),j=X7(n,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(g,n.VALIDATE_STATUS)+`

Material Name: `+L.name+`
Material Type: `+L.type+`

Program Info Log: `+I+`
`+B+`
`+j)}else I!==""?console.warn("THREE.WebGLProgram: Program Info Log:",I):(D===""||F==="")&&(z=!1);z&&(L.diagnostics={runnable:H,programLog:I,vertexShader:{log:D,prefix:y},fragmentShader:{log:F,prefix:v}})}n.deleteShader(S),n.deleteShader(E),R=new oC(n,g),C=QGe(n,g)}let R;this.getUniforms=function(){return R===void 0&&M(this),R};let C;this.getAttributes=function(){return C===void 0&&M(this),C};let T=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return T===!1&&(T=n.getProgramParameter(g,GGe)),T},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(g),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=VGe++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=S,this.fragmentShader=E,this}let uVe=0;class hVe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(i),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const r of i)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let r=i.get(e);return r===void 0&&(r=new Set,i.set(e,r)),r}_getShaderStage(e){const i=this.shaderCache;let r=i.get(e);return r===void 0&&(r=new cVe(e),i.set(e,r)),r}}class cVe{constructor(e){this.id=uVe++,this.code=e,this.usedTimes=0}}function dVe(t,e,i,r,n,s,o){const a=new Sm,l=new hVe,u=new Set,c=[],h=n.isWebGL2,d=n.logarithmicDepthBuffer,p=n.vertexTextures;let f=n.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(C){return u.add(C),C===0?"uv":`uv${C}`}function y(C,T,L,I,D){const F=I.fog,H=D.geometry,z=C.isMeshStandardMaterial?I.environment:null,B=(C.isMeshStandardMaterial?i:e).get(C.envMap||z),j=B&&B.mapping===tb?B.image.height:null,V=m[C.type];C.precision!==null&&(f=n.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));const q=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,K=q!==void 0?q.length:0;let le=0;H.morphAttributes.position!==void 0&&(le=1),H.morphAttributes.normal!==void 0&&(le=2),H.morphAttributes.color!==void 0&&(le=3);let Z,oe,ae,ve;if(V){const Si=pu[V];Z=Si.vertexShader,oe=Si.fragmentShader}else Z=C.vertexShader,oe=C.fragmentShader,l.update(C),ae=l.getVertexShaderID(C),ve=l.getFragmentShaderID(C);const ye=t.getRenderTarget(),pe=D.isInstancedMesh===!0,Se=D.isBatchedMesh===!0,be=!!C.map,ee=!!C.matcap,_e=!!B,Me=!!C.aoMap,Ce=!!C.lightMap,Re=!!C.bumpMap,Xe=!!C.normalMap,Oe=!!C.displacementMap,$=!!C.emissiveMap,J=!!C.metalnessMap,we=!!C.roughnessMap,te=C.anisotropy>0,Y=C.clearcoat>0,ce=C.iridescence>0,Le=C.sheen>0,X=C.transmission>0,Ue=te&&!!C.anisotropyMap,et=Y&&!!C.clearcoatMap,ze=Y&&!!C.clearcoatNormalMap,ge=Y&&!!C.clearcoatRoughnessMap,ct=ce&&!!C.iridescenceMap,rt=ce&&!!C.iridescenceThicknessMap,ut=Le&&!!C.sheenColorMap,ht=Le&&!!C.sheenRoughnessMap,tt=!!C.specularMap,pt=!!C.specularColorMap,Nt=!!C.specularIntensityMap,ti=X&&!!C.transmissionMap,xe=X&&!!C.thicknessMap,Ge=!!C.gradientMap,ie=!!C.alphaMap,He=C.alphaTest>0,Ye=!!C.alphaHash,dt=!!C.extensions;let At=Rh;C.toneMapped&&(ye===null||ye.isXRRenderTarget===!0)&&(At=t.toneMapping);const ri={isWebGL2:h,shaderID:V,shaderType:C.type,shaderName:C.name,vertexShader:Z,fragmentShader:oe,defines:C.defines,customVertexShaderID:ae,customFragmentShaderID:ve,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,batching:Se,instancing:pe,instancingColor:pe&&D.instanceColor!==null,supportsVertexTextures:p,outputColorSpace:ye===null?t.outputColorSpace:ye.isXRRenderTarget===!0?ye.texture.colorSpace:Hh,alphaToCoverage:!!C.alphaToCoverage,map:be,matcap:ee,envMap:_e,envMapMode:_e&&B.mapping,envMapCubeUVHeight:j,aoMap:Me,lightMap:Ce,bumpMap:Re,normalMap:Xe,displacementMap:p&&Oe,emissiveMap:$,normalMapObjectSpace:Xe&&C.normalMapType===Ane,normalMapTangentSpace:Xe&&C.normalMapType===Jp,metalnessMap:J,roughnessMap:we,anisotropy:te,anisotropyMap:Ue,clearcoat:Y,clearcoatMap:et,clearcoatNormalMap:ze,clearcoatRoughnessMap:ge,iridescence:ce,iridescenceMap:ct,iridescenceThicknessMap:rt,sheen:Le,sheenColorMap:ut,sheenRoughnessMap:ht,specularMap:tt,specularColorMap:pt,specularIntensityMap:Nt,transmission:X,transmissionMap:ti,thicknessMap:xe,gradientMap:Ge,opaque:C.transparent===!1&&C.blending===xm&&C.alphaToCoverage===!1,alphaMap:ie,alphaTest:He,alphaHash:Ye,combine:C.combine,mapUv:be&&g(C.map.channel),aoMapUv:Me&&g(C.aoMap.channel),lightMapUv:Ce&&g(C.lightMap.channel),bumpMapUv:Re&&g(C.bumpMap.channel),normalMapUv:Xe&&g(C.normalMap.channel),displacementMapUv:Oe&&g(C.displacementMap.channel),emissiveMapUv:$&&g(C.emissiveMap.channel),metalnessMapUv:J&&g(C.metalnessMap.channel),roughnessMapUv:we&&g(C.roughnessMap.channel),anisotropyMapUv:Ue&&g(C.anisotropyMap.channel),clearcoatMapUv:et&&g(C.clearcoatMap.channel),clearcoatNormalMapUv:ze&&g(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ge&&g(C.clearcoatRoughnessMap.channel),iridescenceMapUv:ct&&g(C.iridescenceMap.channel),iridescenceThicknessMapUv:rt&&g(C.iridescenceThicknessMap.channel),sheenColorMapUv:ut&&g(C.sheenColorMap.channel),sheenRoughnessMapUv:ht&&g(C.sheenRoughnessMap.channel),specularMapUv:tt&&g(C.specularMap.channel),specularColorMapUv:pt&&g(C.specularColorMap.channel),specularIntensityMapUv:Nt&&g(C.specularIntensityMap.channel),transmissionMapUv:ti&&g(C.transmissionMap.channel),thicknessMapUv:xe&&g(C.thicknessMap.channel),alphaMapUv:ie&&g(C.alphaMap.channel),vertexTangents:!!H.attributes.tangent&&(Xe||te),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,pointsUvs:D.isPoints===!0&&!!H.attributes.uv&&(be||ie),fog:!!F,useFog:C.fog===!0,fogExp2:!!F&&F.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:D.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:le,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:t.shadowMap.enabled&&L.length>0,shadowMapType:t.shadowMap.type,toneMapping:At,useLegacyLights:t._useLegacyLights,decodeVideoTexture:be&&C.map.isVideoTexture===!0&&or.getTransfer(C.map.colorSpace)===_r,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Tl,flipSided:C.side===jo,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:dt&&C.extensions.derivatives===!0,extensionFragDepth:dt&&C.extensions.fragDepth===!0,extensionDrawBuffers:dt&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:dt&&C.extensions.shaderTextureLOD===!0,extensionClipCullDistance:dt&&C.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:dt&&C.extensions.multiDraw===!0&&r.has("WEBGL_multi_draw"),rendererExtensionFragDepth:h||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()};return ri.vertexUv1s=u.has(1),ri.vertexUv2s=u.has(2),ri.vertexUv3s=u.has(3),u.clear(),ri}function v(C){const T=[];if(C.shaderID?T.push(C.shaderID):(T.push(C.customVertexShaderID),T.push(C.customFragmentShaderID)),C.defines!==void 0)for(const L in C.defines)T.push(L),T.push(C.defines[L]);return C.isRawShaderMaterial===!1&&(b(T,C),_(T,C),T.push(t.outputColorSpace)),T.push(C.customProgramCacheKey),T.join()}function b(C,T){C.push(T.precision),C.push(T.outputColorSpace),C.push(T.envMapMode),C.push(T.envMapCubeUVHeight),C.push(T.mapUv),C.push(T.alphaMapUv),C.push(T.lightMapUv),C.push(T.aoMapUv),C.push(T.bumpMapUv),C.push(T.normalMapUv),C.push(T.displacementMapUv),C.push(T.emissiveMapUv),C.push(T.metalnessMapUv),C.push(T.roughnessMapUv),C.push(T.anisotropyMapUv),C.push(T.clearcoatMapUv),C.push(T.clearcoatNormalMapUv),C.push(T.clearcoatRoughnessMapUv),C.push(T.iridescenceMapUv),C.push(T.iridescenceThicknessMapUv),C.push(T.sheenColorMapUv),C.push(T.sheenRoughnessMapUv),C.push(T.specularMapUv),C.push(T.specularColorMapUv),C.push(T.specularIntensityMapUv),C.push(T.transmissionMapUv),C.push(T.thicknessMapUv),C.push(T.combine),C.push(T.fogExp2),C.push(T.sizeAttenuation),C.push(T.morphTargetsCount),C.push(T.morphAttributeCount),C.push(T.numDirLights),C.push(T.numPointLights),C.push(T.numSpotLights),C.push(T.numSpotLightMaps),C.push(T.numHemiLights),C.push(T.numRectAreaLights),C.push(T.numDirLightShadows),C.push(T.numPointLightShadows),C.push(T.numSpotLightShadows),C.push(T.numSpotLightShadowsWithMaps),C.push(T.numLightProbes),C.push(T.shadowMapType),C.push(T.toneMapping),C.push(T.numClippingPlanes),C.push(T.numClipIntersection),C.push(T.depthPacking)}function _(C,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),T.batching&&a.enable(19),C.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.useLegacyLights&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),T.alphaToCoverage&&a.enable(20),C.push(a.mask)}function A(C){const T=m[C.type];let L;if(T){const I=pu[T];L=Nne.clone(I.uniforms)}else L=C.uniforms;return L}function S(C,T){let L;for(let I=0,D=c.length;I<D;I++){const F=c[I];if(F.cacheKey===T){L=F,++L.usedTimes;break}}return L===void 0&&(L=new lVe(t,T,C,s),c.push(L)),L}function E(C){if(--C.usedTimes===0){const T=c.indexOf(C);c[T]=c[c.length-1],c.pop(),C.destroy()}}function M(C){l.remove(C)}function R(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:A,acquireProgram:S,releaseProgram:E,releaseShaderCache:M,programs:c,dispose:R}}function pVe(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function i(s){t.delete(s)}function r(s,o,a){t.get(s)[o]=a}function n(){t=new WeakMap}return{get:e,remove:i,update:r,dispose:n}}function fVe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Z7(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function $7(){const t=[];let e=0;const i=[],r=[],n=[];function s(){e=0,i.length=0,r.length=0,n.length=0}function o(h,d,p,f,m,g){let y=t[e];return y===void 0?(y={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:m,group:g},t[e]=y):(y.id=h.id,y.object=h,y.geometry=d,y.material=p,y.groupOrder=f,y.renderOrder=h.renderOrder,y.z=m,y.group=g),e++,y}function a(h,d,p,f,m,g){const y=o(h,d,p,f,m,g);p.transmission>0?r.push(y):p.transparent===!0?n.push(y):i.push(y)}function l(h,d,p,f,m,g){const y=o(h,d,p,f,m,g);p.transmission>0?r.unshift(y):p.transparent===!0?n.unshift(y):i.unshift(y)}function u(h,d){i.length>1&&i.sort(h||fVe),r.length>1&&r.sort(d||Z7),n.length>1&&n.sort(d||Z7)}function c(){for(let h=e,d=t.length;h<d;h++){const p=t[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:i,transmissive:r,transparent:n,init:s,push:a,unshift:l,finish:c,sort:u}}function mVe(){let t=new WeakMap;function e(r,n){const s=t.get(r);let o;return s===void 0?(o=new $7,t.set(r,[o])):n>=s.length?(o=new $7,s.push(o)):o=s[n],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function gVe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new ue,color:new St};break;case"SpotLight":i={position:new ue,direction:new ue,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ue,color:new St,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ue,skyColor:new St,groundColor:new St};break;case"RectAreaLight":i={color:new St,position:new ue,halfWidth:new ue,halfHeight:new ue};break}return t[e.id]=i,i}}}function yVe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ot,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}let vVe=0;function bVe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function xVe(t,e){const i=new gVe,r=yVe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new ue);const s=new ue,o=new ii,a=new ii;function l(c,h){let d=0,p=0,f=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let m=0,g=0,y=0,v=0,b=0,_=0,A=0,S=0,E=0,M=0,R=0;c.sort(bVe);const C=h===!0?Math.PI:1;for(let L=0,I=c.length;L<I;L++){const D=c[L],F=D.color,H=D.intensity,z=D.distance,B=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)d+=F.r*H*C,p+=F.g*H*C,f+=F.b*H*C;else if(D.isLightProbe){for(let j=0;j<9;j++)n.probe[j].addScaledVector(D.sh.coefficients[j],H);R++}else if(D.isDirectionalLight){const j=i.get(D);if(j.color.copy(D.color).multiplyScalar(D.intensity*C),D.castShadow){const V=D.shadow,q=r.get(D);q.shadowBias=V.bias,q.shadowNormalBias=V.normalBias,q.shadowRadius=V.radius,q.shadowMapSize=V.mapSize,n.directionalShadow[m]=q,n.directionalShadowMap[m]=B,n.directionalShadowMatrix[m]=D.shadow.matrix,_++}n.directional[m]=j,m++}else if(D.isSpotLight){const j=i.get(D);j.position.setFromMatrixPosition(D.matrixWorld),j.color.copy(F).multiplyScalar(H*C),j.distance=z,j.coneCos=Math.cos(D.angle),j.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),j.decay=D.decay,n.spot[y]=j;const V=D.shadow;if(D.map&&(n.spotLightMap[E]=D.map,E++,V.updateMatrices(D),D.castShadow&&M++),n.spotLightMatrix[y]=V.matrix,D.castShadow){const q=r.get(D);q.shadowBias=V.bias,q.shadowNormalBias=V.normalBias,q.shadowRadius=V.radius,q.shadowMapSize=V.mapSize,n.spotShadow[y]=q,n.spotShadowMap[y]=B,S++}y++}else if(D.isRectAreaLight){const j=i.get(D);j.color.copy(F).multiplyScalar(H),j.halfWidth.set(D.width*.5,0,0),j.halfHeight.set(0,D.height*.5,0),n.rectArea[v]=j,v++}else if(D.isPointLight){const j=i.get(D);if(j.color.copy(D.color).multiplyScalar(D.intensity*C),j.distance=D.distance,j.decay=D.decay,D.castShadow){const V=D.shadow,q=r.get(D);q.shadowBias=V.bias,q.shadowNormalBias=V.normalBias,q.shadowRadius=V.radius,q.shadowMapSize=V.mapSize,q.shadowCameraNear=V.camera.near,q.shadowCameraFar=V.camera.far,n.pointShadow[g]=q,n.pointShadowMap[g]=B,n.pointShadowMatrix[g]=D.shadow.matrix,A++}n.point[g]=j,g++}else if(D.isHemisphereLight){const j=i.get(D);j.skyColor.copy(D.color).multiplyScalar(H*C),j.groundColor.copy(D.groundColor).multiplyScalar(H*C),n.hemi[b]=j,b++}}v>0&&(e.isWebGL2?t.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=wt.LTC_FLOAT_1,n.rectAreaLTC2=wt.LTC_FLOAT_2):(n.rectAreaLTC1=wt.LTC_HALF_1,n.rectAreaLTC2=wt.LTC_HALF_2):t.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=wt.LTC_FLOAT_1,n.rectAreaLTC2=wt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=wt.LTC_HALF_1,n.rectAreaLTC2=wt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=f;const T=n.hash;(T.directionalLength!==m||T.pointLength!==g||T.spotLength!==y||T.rectAreaLength!==v||T.hemiLength!==b||T.numDirectionalShadows!==_||T.numPointShadows!==A||T.numSpotShadows!==S||T.numSpotMaps!==E||T.numLightProbes!==R)&&(n.directional.length=m,n.spot.length=y,n.rectArea.length=v,n.point.length=g,n.hemi.length=b,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=A,n.pointShadowMap.length=A,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=A,n.spotLightMatrix.length=S+E-M,n.spotLightMap.length=E,n.numSpotLightShadowsWithMaps=M,n.numLightProbes=R,T.directionalLength=m,T.pointLength=g,T.spotLength=y,T.rectAreaLength=v,T.hemiLength=b,T.numDirectionalShadows=_,T.numPointShadows=A,T.numSpotShadows=S,T.numSpotMaps=E,T.numLightProbes=R,n.version=vVe++)}function u(c,h){let d=0,p=0,f=0,m=0,g=0;const y=h.matrixWorldInverse;for(let v=0,b=c.length;v<b;v++){const _=c[v];if(_.isDirectionalLight){const A=n.directional[d];A.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),d++}else if(_.isSpotLight){const A=n.spot[f];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),A.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(y),f++}else if(_.isRectAreaLight){const A=n.rectArea[m];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),a.identity(),o.copy(_.matrixWorld),o.premultiply(y),a.extractRotation(o),A.halfWidth.set(_.width*.5,0,0),A.halfHeight.set(0,_.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),m++}else if(_.isPointLight){const A=n.point[p];A.position.setFromMatrixPosition(_.matrixWorld),A.position.applyMatrix4(y),p++}else if(_.isHemisphereLight){const A=n.hemi[g];A.direction.setFromMatrixPosition(_.matrixWorld),A.direction.transformDirection(y),g++}}}return{setup:l,setupView:u,state:n}}function eX(t,e){const i=new xVe(t,e),r=[],n=[];function s(){r.length=0,n.length=0}function o(h){r.push(h)}function a(h){n.push(h)}function l(h){i.setup(r,h)}function u(h){i.setupView(r,h)}return{init:s,state:{lightsArray:r,shadowsArray:n,lights:i},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function wVe(t,e){let i=new WeakMap;function r(s,o=0){const a=i.get(s);let l;return a===void 0?(l=new eX(t,e),i.set(s,[l])):o>=a.length?(l=new eX(t,e),a.push(l)):l=a[o],l}function n(){i=new WeakMap}return{get:r,dispose:n}}class G4 extends jn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=_ne,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class V4 extends jn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const _Ve=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,SVe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function AVe(t,e,i){let r=new m_;const n=new ot,s=new ot,o=new lr,a=new G4({depthPacking:Sne}),l=new V4,u={},c=i.maxTextureSize,h={[zh]:jo,[jo]:zh,[Tl]:Tl},d=new Ru({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ot},radius:{value:4}},vertexShader:_Ve,fragmentShader:SVe}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new bi;f.setAttribute("position",new Gi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new _n(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=iT;let y=this.type;this.render=function(S,E,M){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||S.length===0)return;const R=t.getRenderTarget(),C=t.getActiveCubeFace(),T=t.getActiveMipmapLevel(),L=t.state;L.setBlending(Kc),L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);const I=y!==lu&&this.type===lu,D=y===lu&&this.type!==lu;for(let F=0,H=S.length;F<H;F++){const z=S[F],B=z.shadow;if(B===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(B.autoUpdate===!1&&B.needsUpdate===!1)continue;n.copy(B.mapSize);const j=B.getFrameExtents();if(n.multiply(j),s.copy(B.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(s.x=Math.floor(c/j.x),n.x=s.x*j.x,B.mapSize.x=s.x),n.y>c&&(s.y=Math.floor(c/j.y),n.y=s.y*j.y,B.mapSize.y=s.y)),B.map===null||I===!0||D===!0){const q=this.type!==lu?{minFilter:an,magFilter:an}:{};B.map!==null&&B.map.dispose(),B.map=new Tu(n.x,n.y,q),B.map.texture.name=z.name+".shadowMap",B.camera.updateProjectionMatrix()}t.setRenderTarget(B.map),t.clear();const V=B.getViewportCount();for(let q=0;q<V;q++){const K=B.getViewport(q);o.set(s.x*K.x,s.y*K.y,s.x*K.z,s.y*K.w),L.viewport(o),B.updateMatrices(z,q),r=B.getFrustum(),_(E,M,B.camera,z,this.type)}B.isPointLightShadow!==!0&&this.type===lu&&v(B,M),B.needsUpdate=!1}y=this.type,g.needsUpdate=!1,t.setRenderTarget(R,C,T)};function v(S,E){const M=e.update(m);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,p.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new Tu(n.x,n.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,t.setRenderTarget(S.mapPass),t.clear(),t.renderBufferDirect(E,null,M,d,m,null),p.uniforms.shadow_pass.value=S.mapPass.texture,p.uniforms.resolution.value=S.mapSize,p.uniforms.radius.value=S.radius,t.setRenderTarget(S.map),t.clear(),t.renderBufferDirect(E,null,M,p,m,null)}function b(S,E,M,R){let C=null;const T=M.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(T!==void 0)C=T;else if(C=M.isPointLight===!0?l:a,t.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){const L=C.uuid,I=E.uuid;let D=u[L];D===void 0&&(D={},u[L]=D);let F=D[I];F===void 0&&(F=C.clone(),D[I]=F,E.addEventListener("dispose",A)),C=F}if(C.visible=E.visible,C.wireframe=E.wireframe,R===lu?C.side=E.shadowSide!==null?E.shadowSide:E.side:C.side=E.shadowSide!==null?E.shadowSide:h[E.side],C.alphaMap=E.alphaMap,C.alphaTest=E.alphaTest,C.map=E.map,C.clipShadows=E.clipShadows,C.clippingPlanes=E.clippingPlanes,C.clipIntersection=E.clipIntersection,C.displacementMap=E.displacementMap,C.displacementScale=E.displacementScale,C.displacementBias=E.displacementBias,C.wireframeLinewidth=E.wireframeLinewidth,C.linewidth=E.linewidth,M.isPointLight===!0&&C.isMeshDistanceMaterial===!0){const L=t.properties.get(C);L.light=M}return C}function _(S,E,M,R,C){if(S.visible===!1)return;if(S.layers.test(E.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&C===lu)&&(!S.frustumCulled||r.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,S.matrixWorld);const I=e.update(S),D=S.material;if(Array.isArray(D)){const F=I.groups;for(let H=0,z=F.length;H<z;H++){const B=F[H],j=D[B.materialIndex];if(j&&j.visible){const V=b(S,j,R,C);S.onBeforeShadow(t,S,E,M,I,V,B),t.renderBufferDirect(M,null,I,V,S,B),S.onAfterShadow(t,S,E,M,I,V,B)}}}else if(D.visible){const F=b(S,D,R,C);S.onBeforeShadow(t,S,E,M,I,F,null),t.renderBufferDirect(M,null,I,F,S,null),S.onAfterShadow(t,S,E,M,I,F,null)}}const L=S.children;for(let I=0,D=L.length;I<D;I++)_(L[I],E,M,R,C)}function A(S){S.target.removeEventListener("dispose",A);for(const M in u){const R=u[M],C=S.target.uuid;C in R&&(R[C].dispose(),delete R[C])}}}function EVe(t,e,i){const r=i.isWebGL2;function n(){let ie=!1;const He=new lr;let Ye=null;const dt=new lr(0,0,0,0);return{setMask:function(At){Ye!==At&&!ie&&(t.colorMask(At,At,At,At),Ye=At)},setLocked:function(At){ie=At},setClear:function(At,ri,Si,li,yr){yr===!0&&(At*=li,ri*=li,Si*=li),He.set(At,ri,Si,li),dt.equals(He)===!1&&(t.clearColor(At,ri,Si,li),dt.copy(He))},reset:function(){ie=!1,Ye=null,dt.set(-1,0,0,0)}}}function s(){let ie=!1,He=null,Ye=null,dt=null;return{setTest:function(At){At?pe(t.DEPTH_TEST):Se(t.DEPTH_TEST)},setMask:function(At){He!==At&&!ie&&(t.depthMask(At),He=At)},setFunc:function(At){if(Ye!==At){switch(At){case Kre:t.depthFunc(t.NEVER);break;case Jre:t.depthFunc(t.ALWAYS);break;case Qre:t.depthFunc(t.LESS);break;case v1:t.depthFunc(t.LEQUAL);break;case Zre:t.depthFunc(t.EQUAL);break;case $re:t.depthFunc(t.GEQUAL);break;case ene:t.depthFunc(t.GREATER);break;case tne:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Ye=At}},setLocked:function(At){ie=At},setClear:function(At){dt!==At&&(t.clearDepth(At),dt=At)},reset:function(){ie=!1,He=null,Ye=null,dt=null}}}function o(){let ie=!1,He=null,Ye=null,dt=null,At=null,ri=null,Si=null,li=null,yr=null;return{setTest:function(gi){ie||(gi?pe(t.STENCIL_TEST):Se(t.STENCIL_TEST))},setMask:function(gi){He!==gi&&!ie&&(t.stencilMask(gi),He=gi)},setFunc:function(gi,Br,Ks){(Ye!==gi||dt!==Br||At!==Ks)&&(t.stencilFunc(gi,Br,Ks),Ye=gi,dt=Br,At=Ks)},setOp:function(gi,Br,Ks){(ri!==gi||Si!==Br||li!==Ks)&&(t.stencilOp(gi,Br,Ks),ri=gi,Si=Br,li=Ks)},setLocked:function(gi){ie=gi},setClear:function(gi){yr!==gi&&(t.clearStencil(gi),yr=gi)},reset:function(){ie=!1,He=null,Ye=null,dt=null,At=null,ri=null,Si=null,li=null,yr=null}}}const a=new n,l=new s,u=new o,c=new WeakMap,h=new WeakMap;let d={},p={},f=new WeakMap,m=[],g=null,y=!1,v=null,b=null,_=null,A=null,S=null,E=null,M=null,R=new St(0,0,0),C=0,T=!1,L=null,I=null,D=null,F=null,H=null;const z=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let B=!1,j=0;const V=t.getParameter(t.VERSION);V.indexOf("WebGL")!==-1?(j=parseFloat(/^WebGL (\d)/.exec(V)[1]),B=j>=1):V.indexOf("OpenGL ES")!==-1&&(j=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),B=j>=2);let q=null,K={};const le=t.getParameter(t.SCISSOR_BOX),Z=t.getParameter(t.VIEWPORT),oe=new lr().fromArray(le),ae=new lr().fromArray(Z);function ve(ie,He,Ye,dt){const At=new Uint8Array(4),ri=t.createTexture();t.bindTexture(ie,ri),t.texParameteri(ie,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ie,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Si=0;Si<Ye;Si++)r&&(ie===t.TEXTURE_3D||ie===t.TEXTURE_2D_ARRAY)?t.texImage3D(He,0,t.RGBA,1,1,dt,0,t.RGBA,t.UNSIGNED_BYTE,At):t.texImage2D(He+Si,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,At);return ri}const ye={};ye[t.TEXTURE_2D]=ve(t.TEXTURE_2D,t.TEXTURE_2D,1),ye[t.TEXTURE_CUBE_MAP]=ve(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(ye[t.TEXTURE_2D_ARRAY]=ve(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),ye[t.TEXTURE_3D]=ve(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),pe(t.DEPTH_TEST),l.setFunc(v1),Oe(!1),$(pU),pe(t.CULL_FACE),Re(Kc);function pe(ie){d[ie]!==!0&&(t.enable(ie),d[ie]=!0)}function Se(ie){d[ie]!==!1&&(t.disable(ie),d[ie]=!1)}function be(ie,He){return p[ie]!==He?(t.bindFramebuffer(ie,He),p[ie]=He,r&&(ie===t.DRAW_FRAMEBUFFER&&(p[t.FRAMEBUFFER]=He),ie===t.FRAMEBUFFER&&(p[t.DRAW_FRAMEBUFFER]=He)),!0):!1}function ee(ie,He){let Ye=m,dt=!1;if(ie)if(Ye=f.get(He),Ye===void 0&&(Ye=[],f.set(He,Ye)),ie.isWebGLMultipleRenderTargets){const At=ie.texture;if(Ye.length!==At.length||Ye[0]!==t.COLOR_ATTACHMENT0){for(let ri=0,Si=At.length;ri<Si;ri++)Ye[ri]=t.COLOR_ATTACHMENT0+ri;Ye.length=At.length,dt=!0}}else Ye[0]!==t.COLOR_ATTACHMENT0&&(Ye[0]=t.COLOR_ATTACHMENT0,dt=!0);else Ye[0]!==t.BACK&&(Ye[0]=t.BACK,dt=!0);dt&&(i.isWebGL2?t.drawBuffers(Ye):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ye))}function _e(ie){return g!==ie?(t.useProgram(ie),g=ie,!0):!1}const Me={[rp]:t.FUNC_ADD,[Lre]:t.FUNC_SUBTRACT,[Bre]:t.FUNC_REVERSE_SUBTRACT};if(r)Me[yU]=t.MIN,Me[vU]=t.MAX;else{const ie=e.get("EXT_blend_minmax");ie!==null&&(Me[yU]=ie.MIN_EXT,Me[vU]=ie.MAX_EXT)}const Ce={[Ore]:t.ZERO,[Ure]:t.ONE,[Nre]:t.SRC_COLOR,[Q2]:t.SRC_ALPHA,[jre]:t.SRC_ALPHA_SATURATE,[Gre]:t.DST_COLOR,[zre]:t.DST_ALPHA,[Fre]:t.ONE_MINUS_SRC_COLOR,[Z2]:t.ONE_MINUS_SRC_ALPHA,[Vre]:t.ONE_MINUS_DST_COLOR,[Hre]:t.ONE_MINUS_DST_ALPHA,[Wre]:t.CONSTANT_COLOR,[qre]:t.ONE_MINUS_CONSTANT_COLOR,[Xre]:t.CONSTANT_ALPHA,[Yre]:t.ONE_MINUS_CONSTANT_ALPHA};function Re(ie,He,Ye,dt,At,ri,Si,li,yr,gi){if(ie===Kc){y===!0&&(Se(t.BLEND),y=!1);return}if(y===!1&&(pe(t.BLEND),y=!0),ie!==Ire){if(ie!==v||gi!==T){if((b!==rp||S!==rp)&&(t.blendEquation(t.FUNC_ADD),b=rp,S=rp),gi)switch(ie){case xm:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case fU:t.blendFunc(t.ONE,t.ONE);break;case mU:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gU:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}else switch(ie){case xm:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case fU:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case mU:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gU:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ie);break}_=null,A=null,E=null,M=null,R.set(0,0,0),C=0,v=ie,T=gi}return}At=At||He,ri=ri||Ye,Si=Si||dt,(He!==b||At!==S)&&(t.blendEquationSeparate(Me[He],Me[At]),b=He,S=At),(Ye!==_||dt!==A||ri!==E||Si!==M)&&(t.blendFuncSeparate(Ce[Ye],Ce[dt],Ce[ri],Ce[Si]),_=Ye,A=dt,E=ri,M=Si),(li.equals(R)===!1||yr!==C)&&(t.blendColor(li.r,li.g,li.b,yr),R.copy(li),C=yr),v=ie,T=!1}function Xe(ie,He){ie.side===Tl?Se(t.CULL_FACE):pe(t.CULL_FACE);let Ye=ie.side===jo;He&&(Ye=!Ye),Oe(Ye),ie.blending===xm&&ie.transparent===!1?Re(Kc):Re(ie.blending,ie.blendEquation,ie.blendSrc,ie.blendDst,ie.blendEquationAlpha,ie.blendSrcAlpha,ie.blendDstAlpha,ie.blendColor,ie.blendAlpha,ie.premultipliedAlpha),l.setFunc(ie.depthFunc),l.setTest(ie.depthTest),l.setMask(ie.depthWrite),a.setMask(ie.colorWrite);const dt=ie.stencilWrite;u.setTest(dt),dt&&(u.setMask(ie.stencilWriteMask),u.setFunc(ie.stencilFunc,ie.stencilRef,ie.stencilFuncMask),u.setOp(ie.stencilFail,ie.stencilZFail,ie.stencilZPass)),we(ie.polygonOffset,ie.polygonOffsetFactor,ie.polygonOffsetUnits),ie.alphaToCoverage===!0?pe(t.SAMPLE_ALPHA_TO_COVERAGE):Se(t.SAMPLE_ALPHA_TO_COVERAGE)}function Oe(ie){L!==ie&&(ie?t.frontFace(t.CW):t.frontFace(t.CCW),L=ie)}function $(ie){ie!==Rre?(pe(t.CULL_FACE),ie!==I&&(ie===pU?t.cullFace(t.BACK):ie===kre?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Se(t.CULL_FACE),I=ie}function J(ie){ie!==D&&(B&&t.lineWidth(ie),D=ie)}function we(ie,He,Ye){ie?(pe(t.POLYGON_OFFSET_FILL),(F!==He||H!==Ye)&&(t.polygonOffset(He,Ye),F=He,H=Ye)):Se(t.POLYGON_OFFSET_FILL)}function te(ie){ie?pe(t.SCISSOR_TEST):Se(t.SCISSOR_TEST)}function Y(ie){ie===void 0&&(ie=t.TEXTURE0+z-1),q!==ie&&(t.activeTexture(ie),q=ie)}function ce(ie,He,Ye){Ye===void 0&&(q===null?Ye=t.TEXTURE0+z-1:Ye=q);let dt=K[Ye];dt===void 0&&(dt={type:void 0,texture:void 0},K[Ye]=dt),(dt.type!==ie||dt.texture!==He)&&(q!==Ye&&(t.activeTexture(Ye),q=Ye),t.bindTexture(ie,He||ye[ie]),dt.type=ie,dt.texture=He)}function Le(){const ie=K[q];ie!==void 0&&ie.type!==void 0&&(t.bindTexture(ie.type,null),ie.type=void 0,ie.texture=void 0)}function X(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function Ue(){try{t.compressedTexImage3D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function et(){try{t.texSubImage2D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ze(){try{t.texSubImage3D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ge(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ct(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function rt(){try{t.texStorage2D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ut(){try{t.texStorage3D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function ht(){try{t.texImage2D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function tt(){try{t.texImage3D.apply(t,arguments)}catch(ie){console.error("THREE.WebGLState:",ie)}}function pt(ie){oe.equals(ie)===!1&&(t.scissor(ie.x,ie.y,ie.z,ie.w),oe.copy(ie))}function Nt(ie){ae.equals(ie)===!1&&(t.viewport(ie.x,ie.y,ie.z,ie.w),ae.copy(ie))}function ti(ie,He){let Ye=h.get(He);Ye===void 0&&(Ye=new WeakMap,h.set(He,Ye));let dt=Ye.get(ie);dt===void 0&&(dt=t.getUniformBlockIndex(He,ie.name),Ye.set(ie,dt))}function xe(ie,He){const dt=h.get(He).get(ie);c.get(He)!==dt&&(t.uniformBlockBinding(He,dt,ie.__bindingPointIndex),c.set(He,dt))}function Ge(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),r===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},q=null,K={},p={},f=new WeakMap,m=[],g=null,y=!1,v=null,b=null,_=null,A=null,S=null,E=null,M=null,R=new St(0,0,0),C=0,T=!1,L=null,I=null,D=null,F=null,H=null,oe.set(0,0,t.canvas.width,t.canvas.height),ae.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:pe,disable:Se,bindFramebuffer:be,drawBuffers:ee,useProgram:_e,setBlending:Re,setMaterial:Xe,setFlipSided:Oe,setCullFace:$,setLineWidth:J,setPolygonOffset:we,setScissorTest:te,activeTexture:Y,bindTexture:ce,unbindTexture:Le,compressedTexImage2D:X,compressedTexImage3D:Ue,texImage2D:ht,texImage3D:tt,updateUBOMapping:ti,uniformBlockBinding:xe,texStorage2D:rt,texStorage3D:ut,texSubImage2D:et,texSubImage3D:ze,compressedTexSubImage2D:ge,compressedTexSubImage3D:ct,scissor:pt,viewport:Nt,reset:Ge}}function MVe(t,e,i,r,n,s,o){const a=n.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new WeakMap;let h;const d=new WeakMap;let p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f($,J){return p?new OffscreenCanvas($,J):P1("canvas")}function m($,J,we,te){let Y=1;if(($.width>te||$.height>te)&&(Y=te/Math.max($.width,$.height)),Y<1||J===!0)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const ce=J?tP:Math.floor,Le=ce(Y*$.width),X=ce(Y*$.height);h===void 0&&(h=f(Le,X));const Ue=we?f(Le,X):h;return Ue.width=Le,Ue.height=X,Ue.getContext("2d").drawImage($,0,0,Le,X),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+Le+"x"+X+")."),Ue}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$;return $}function g($){return XU($.width)&&XU($.height)}function y($){return a?!1:$.wrapS!==Hs||$.wrapT!==Hs||$.minFilter!==an&&$.minFilter!==Rr}function v($,J){return $.generateMipmaps&&J&&$.minFilter!==an&&$.minFilter!==Rr}function b($){t.generateMipmap($)}function _($,J,we,te,Y=!1){if(a===!1)return J;if($!==null){if(t[$]!==void 0)return t[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let ce=J;if(J===t.RED&&(we===t.FLOAT&&(ce=t.R32F),we===t.HALF_FLOAT&&(ce=t.R16F),we===t.UNSIGNED_BYTE&&(ce=t.R8)),J===t.RED_INTEGER&&(we===t.UNSIGNED_BYTE&&(ce=t.R8UI),we===t.UNSIGNED_SHORT&&(ce=t.R16UI),we===t.UNSIGNED_INT&&(ce=t.R32UI),we===t.BYTE&&(ce=t.R8I),we===t.SHORT&&(ce=t.R16I),we===t.INT&&(ce=t.R32I)),J===t.RG&&(we===t.FLOAT&&(ce=t.RG32F),we===t.HALF_FLOAT&&(ce=t.RG16F),we===t.UNSIGNED_BYTE&&(ce=t.RG8)),J===t.RGBA){const Le=Y?S1:or.getTransfer(te);we===t.FLOAT&&(ce=t.RGBA32F),we===t.HALF_FLOAT&&(ce=t.RGBA16F),we===t.UNSIGNED_BYTE&&(ce=Le===_r?t.SRGB8_ALPHA8:t.RGBA8),we===t.UNSIGNED_SHORT_4_4_4_4&&(ce=t.RGBA4),we===t.UNSIGNED_SHORT_5_5_5_1&&(ce=t.RGB5_A1)}return(ce===t.R16F||ce===t.R32F||ce===t.RG16F||ce===t.RG32F||ce===t.RGBA16F||ce===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ce}function A($,J,we){return v($,we)===!0||$.isFramebufferTexture&&$.minFilter!==an&&$.minFilter!==Rr?Math.log2(Math.max(J.width,J.height))+1:$.mipmaps!==void 0&&$.mipmaps.length>0?$.mipmaps.length:$.isCompressedTexture&&Array.isArray($.image)?J.mipmaps.length:1}function S($){return $===an||$===w1||$===np?t.NEAREST:t.LINEAR}function E($){const J=$.target;J.removeEventListener("dispose",E),R(J),J.isVideoTexture&&c.delete(J)}function M($){const J=$.target;J.removeEventListener("dispose",M),T(J)}function R($){const J=r.get($);if(J.__webglInit===void 0)return;const we=$.source,te=d.get(we);if(te){const Y=te[J.__cacheKey];Y.usedTimes--,Y.usedTimes===0&&C($),Object.keys(te).length===0&&d.delete(we)}r.remove($)}function C($){const J=r.get($);t.deleteTexture(J.__webglTexture);const we=$.source,te=d.get(we);delete te[J.__cacheKey],o.memory.textures--}function T($){const J=$.texture,we=r.get($),te=r.get(J);if(te.__webglTexture!==void 0&&(t.deleteTexture(te.__webglTexture),o.memory.textures--),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let Y=0;Y<6;Y++){if(Array.isArray(we.__webglFramebuffer[Y]))for(let ce=0;ce<we.__webglFramebuffer[Y].length;ce++)t.deleteFramebuffer(we.__webglFramebuffer[Y][ce]);else t.deleteFramebuffer(we.__webglFramebuffer[Y]);we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer[Y])}else{if(Array.isArray(we.__webglFramebuffer))for(let Y=0;Y<we.__webglFramebuffer.length;Y++)t.deleteFramebuffer(we.__webglFramebuffer[Y]);else t.deleteFramebuffer(we.__webglFramebuffer);if(we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&t.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer)for(let Y=0;Y<we.__webglColorRenderbuffer.length;Y++)we.__webglColorRenderbuffer[Y]&&t.deleteRenderbuffer(we.__webglColorRenderbuffer[Y]);we.__webglDepthRenderbuffer&&t.deleteRenderbuffer(we.__webglDepthRenderbuffer)}if($.isWebGLMultipleRenderTargets)for(let Y=0,ce=J.length;Y<ce;Y++){const Le=r.get(J[Y]);Le.__webglTexture&&(t.deleteTexture(Le.__webglTexture),o.memory.textures--),r.remove(J[Y])}r.remove(J),r.remove($)}let L=0;function I(){L=0}function D(){const $=L;return $>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+n.maxTextures),L+=1,$}function F($){const J=[];return J.push($.wrapS),J.push($.wrapT),J.push($.wrapR||0),J.push($.magFilter),J.push($.minFilter),J.push($.anisotropy),J.push($.internalFormat),J.push($.format),J.push($.type),J.push($.generateMipmaps),J.push($.premultiplyAlpha),J.push($.flipY),J.push($.unpackAlignment),J.push($.colorSpace),J.join()}function H($,J){const we=r.get($);if($.isVideoTexture&&Xe($),$.isRenderTargetTexture===!1&&$.version>0&&we.__version!==$.version){const te=$.image;if(te===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(te.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(we,$,J);return}}i.bindTexture(t.TEXTURE_2D,we.__webglTexture,t.TEXTURE0+J)}function z($,J){const we=r.get($);if($.version>0&&we.__version!==$.version){oe(we,$,J);return}i.bindTexture(t.TEXTURE_2D_ARRAY,we.__webglTexture,t.TEXTURE0+J)}function B($,J){const we=r.get($);if($.version>0&&we.__version!==$.version){oe(we,$,J);return}i.bindTexture(t.TEXTURE_3D,we.__webglTexture,t.TEXTURE0+J)}function j($,J){const we=r.get($);if($.version>0&&we.__version!==$.version){ae(we,$,J);return}i.bindTexture(t.TEXTURE_CUBE_MAP,we.__webglTexture,t.TEXTURE0+J)}const V={[Hp]:t.REPEAT,[Hs]:t.CLAMP_TO_EDGE,[g0]:t.MIRRORED_REPEAT},q={[an]:t.NEAREST,[w1]:t.NEAREST_MIPMAP_NEAREST,[np]:t.NEAREST_MIPMAP_LINEAR,[Rr]:t.LINEAR,[Hv]:t.LINEAR_MIPMAP_NEAREST,[Il]:t.LINEAR_MIPMAP_LINEAR},K={[Ene]:t.NEVER,[kne]:t.ALWAYS,[Mne]:t.LESS,[L4]:t.LEQUAL,[Cne]:t.EQUAL,[Rne]:t.GEQUAL,[Pne]:t.GREATER,[Tne]:t.NOTEQUAL};function le($,J,we){if(J.type===Rl&&e.has("OES_texture_float_linear")===!1&&(J.magFilter===Rr||J.magFilter===Hv||J.magFilter===np||J.magFilter===Il||J.minFilter===Rr||J.minFilter===Hv||J.minFilter===np||J.minFilter===Il)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),we?(t.texParameteri($,t.TEXTURE_WRAP_S,V[J.wrapS]),t.texParameteri($,t.TEXTURE_WRAP_T,V[J.wrapT]),($===t.TEXTURE_3D||$===t.TEXTURE_2D_ARRAY)&&t.texParameteri($,t.TEXTURE_WRAP_R,V[J.wrapR]),t.texParameteri($,t.TEXTURE_MAG_FILTER,q[J.magFilter]),t.texParameteri($,t.TEXTURE_MIN_FILTER,q[J.minFilter])):(t.texParameteri($,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri($,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),($===t.TEXTURE_3D||$===t.TEXTURE_2D_ARRAY)&&t.texParameteri($,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(J.wrapS!==Hs||J.wrapT!==Hs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri($,t.TEXTURE_MAG_FILTER,S(J.magFilter)),t.texParameteri($,t.TEXTURE_MIN_FILTER,S(J.minFilter)),J.minFilter!==an&&J.minFilter!==Rr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),J.compareFunction&&(t.texParameteri($,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri($,t.TEXTURE_COMPARE_FUNC,K[J.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const te=e.get("EXT_texture_filter_anisotropic");if(J.magFilter===an||J.minFilter!==np&&J.minFilter!==Il||J.type===Rl&&e.has("OES_texture_float_linear")===!1||a===!1&&J.type===y0&&e.has("OES_texture_half_float_linear")===!1)return;(J.anisotropy>1||r.get(J).__currentAnisotropy)&&(t.texParameterf($,te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,n.getMaxAnisotropy())),r.get(J).__currentAnisotropy=J.anisotropy)}}function Z($,J){let we=!1;$.__webglInit===void 0&&($.__webglInit=!0,J.addEventListener("dispose",E));const te=J.source;let Y=d.get(te);Y===void 0&&(Y={},d.set(te,Y));const ce=F(J);if(ce!==$.__cacheKey){Y[ce]===void 0&&(Y[ce]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,we=!0),Y[ce].usedTimes++;const Le=Y[$.__cacheKey];Le!==void 0&&(Y[$.__cacheKey].usedTimes--,Le.usedTimes===0&&C(J)),$.__cacheKey=ce,$.__webglTexture=Y[ce].texture}return we}function oe($,J,we){let te=t.TEXTURE_2D;(J.isDataArrayTexture||J.isCompressedArrayTexture)&&(te=t.TEXTURE_2D_ARRAY),J.isData3DTexture&&(te=t.TEXTURE_3D);const Y=Z($,J),ce=J.source;i.bindTexture(te,$.__webglTexture,t.TEXTURE0+we);const Le=r.get(ce);if(ce.version!==Le.__version||Y===!0){i.activeTexture(t.TEXTURE0+we);const X=or.getPrimaries(or.workingColorSpace),Ue=J.colorSpace===Oa?null:or.getPrimaries(J.colorSpace),et=J.colorSpace===Oa||X===Ue?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,J.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,J.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,et);const ze=y(J)&&g(J.image)===!1;let ge=m(J.image,ze,!1,n.maxTextureSize);ge=Oe(J,ge);const ct=g(ge)||a,rt=s.convert(J.format,J.colorSpace);let ut=s.convert(J.type),ht=_(J.internalFormat,rt,ut,J.colorSpace,J.isVideoTexture);le(te,J,ct);let tt;const pt=J.mipmaps,Nt=a&&J.isVideoTexture!==!0&&ht!==R4,ti=Le.__version===void 0||Y===!0,xe=ce.dataReady,Ge=A(J,ge,ct);if(J.isDepthTexture)ht=t.DEPTH_COMPONENT,a?J.type===Rl?ht=t.DEPTH_COMPONENT32F:J.type===Hc?ht=t.DEPTH_COMPONENT24:J.type===kp?ht=t.DEPTH24_STENCIL8:ht=t.DEPTH_COMPONENT16:J.type===Rl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),J.format===Dp&&ht===t.DEPTH_COMPONENT&&J.type!==nT&&J.type!==Hc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),J.type=Hc,ut=s.convert(J.type)),J.format===Hm&&ht===t.DEPTH_COMPONENT&&(ht=t.DEPTH_STENCIL,J.type!==kp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),J.type=kp,ut=s.convert(J.type))),ti&&(Nt?i.texStorage2D(t.TEXTURE_2D,1,ht,ge.width,ge.height):i.texImage2D(t.TEXTURE_2D,0,ht,ge.width,ge.height,0,rt,ut,null));else if(J.isDataTexture)if(pt.length>0&&ct){Nt&&ti&&i.texStorage2D(t.TEXTURE_2D,Ge,ht,pt[0].width,pt[0].height);for(let ie=0,He=pt.length;ie<He;ie++)tt=pt[ie],Nt?xe&&i.texSubImage2D(t.TEXTURE_2D,ie,0,0,tt.width,tt.height,rt,ut,tt.data):i.texImage2D(t.TEXTURE_2D,ie,ht,tt.width,tt.height,0,rt,ut,tt.data);J.generateMipmaps=!1}else Nt?(ti&&i.texStorage2D(t.TEXTURE_2D,Ge,ht,ge.width,ge.height),xe&&i.texSubImage2D(t.TEXTURE_2D,0,0,0,ge.width,ge.height,rt,ut,ge.data)):i.texImage2D(t.TEXTURE_2D,0,ht,ge.width,ge.height,0,rt,ut,ge.data);else if(J.isCompressedTexture)if(J.isCompressedArrayTexture){Nt&&ti&&i.texStorage3D(t.TEXTURE_2D_ARRAY,Ge,ht,pt[0].width,pt[0].height,ge.depth);for(let ie=0,He=pt.length;ie<He;ie++)tt=pt[ie],J.format!==Fo?rt!==null?Nt?xe&&i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ie,0,0,0,tt.width,tt.height,ge.depth,rt,tt.data,0,0):i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,ie,ht,tt.width,tt.height,ge.depth,0,tt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Nt?xe&&i.texSubImage3D(t.TEXTURE_2D_ARRAY,ie,0,0,0,tt.width,tt.height,ge.depth,rt,ut,tt.data):i.texImage3D(t.TEXTURE_2D_ARRAY,ie,ht,tt.width,tt.height,ge.depth,0,rt,ut,tt.data)}else{Nt&&ti&&i.texStorage2D(t.TEXTURE_2D,Ge,ht,pt[0].width,pt[0].height);for(let ie=0,He=pt.length;ie<He;ie++)tt=pt[ie],J.format!==Fo?rt!==null?Nt?xe&&i.compressedTexSubImage2D(t.TEXTURE_2D,ie,0,0,tt.width,tt.height,rt,tt.data):i.compressedTexImage2D(t.TEXTURE_2D,ie,ht,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Nt?xe&&i.texSubImage2D(t.TEXTURE_2D,ie,0,0,tt.width,tt.height,rt,ut,tt.data):i.texImage2D(t.TEXTURE_2D,ie,ht,tt.width,tt.height,0,rt,ut,tt.data)}else if(J.isDataArrayTexture)Nt?(ti&&i.texStorage3D(t.TEXTURE_2D_ARRAY,Ge,ht,ge.width,ge.height,ge.depth),xe&&i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,ge.width,ge.height,ge.depth,rt,ut,ge.data)):i.texImage3D(t.TEXTURE_2D_ARRAY,0,ht,ge.width,ge.height,ge.depth,0,rt,ut,ge.data);else if(J.isData3DTexture)Nt?(ti&&i.texStorage3D(t.TEXTURE_3D,Ge,ht,ge.width,ge.height,ge.depth),xe&&i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,ge.width,ge.height,ge.depth,rt,ut,ge.data)):i.texImage3D(t.TEXTURE_3D,0,ht,ge.width,ge.height,ge.depth,0,rt,ut,ge.data);else if(J.isFramebufferTexture){if(ti)if(Nt)i.texStorage2D(t.TEXTURE_2D,Ge,ht,ge.width,ge.height);else{let ie=ge.width,He=ge.height;for(let Ye=0;Ye<Ge;Ye++)i.texImage2D(t.TEXTURE_2D,Ye,ht,ie,He,0,rt,ut,null),ie>>=1,He>>=1}}else if(pt.length>0&&ct){Nt&&ti&&i.texStorage2D(t.TEXTURE_2D,Ge,ht,pt[0].width,pt[0].height);for(let ie=0,He=pt.length;ie<He;ie++)tt=pt[ie],Nt?xe&&i.texSubImage2D(t.TEXTURE_2D,ie,0,0,rt,ut,tt):i.texImage2D(t.TEXTURE_2D,ie,ht,rt,ut,tt);J.generateMipmaps=!1}else Nt?(ti&&i.texStorage2D(t.TEXTURE_2D,Ge,ht,ge.width,ge.height),xe&&i.texSubImage2D(t.TEXTURE_2D,0,0,0,rt,ut,ge)):i.texImage2D(t.TEXTURE_2D,0,ht,rt,ut,ge);v(J,ct)&&b(te),Le.__version=ce.version,J.onUpdate&&J.onUpdate(J)}$.__version=J.version}function ae($,J,we){if(J.image.length!==6)return;const te=Z($,J),Y=J.source;i.bindTexture(t.TEXTURE_CUBE_MAP,$.__webglTexture,t.TEXTURE0+we);const ce=r.get(Y);if(Y.version!==ce.__version||te===!0){i.activeTexture(t.TEXTURE0+we);const Le=or.getPrimaries(or.workingColorSpace),X=J.colorSpace===Oa?null:or.getPrimaries(J.colorSpace),Ue=J.colorSpace===Oa||Le===X?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,J.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,J.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,J.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ue);const et=J.isCompressedTexture||J.image[0].isCompressedTexture,ze=J.image[0]&&J.image[0].isDataTexture,ge=[];for(let ie=0;ie<6;ie++)!et&&!ze?ge[ie]=m(J.image[ie],!1,!0,n.maxCubemapSize):ge[ie]=ze?J.image[ie].image:J.image[ie],ge[ie]=Oe(J,ge[ie]);const ct=ge[0],rt=g(ct)||a,ut=s.convert(J.format,J.colorSpace),ht=s.convert(J.type),tt=_(J.internalFormat,ut,ht,J.colorSpace),pt=a&&J.isVideoTexture!==!0,Nt=ce.__version===void 0||te===!0,ti=Y.dataReady;let xe=A(J,ct,rt);le(t.TEXTURE_CUBE_MAP,J,rt);let Ge;if(et){pt&&Nt&&i.texStorage2D(t.TEXTURE_CUBE_MAP,xe,tt,ct.width,ct.height);for(let ie=0;ie<6;ie++){Ge=ge[ie].mipmaps;for(let He=0;He<Ge.length;He++){const Ye=Ge[He];J.format!==Fo?ut!==null?pt?ti&&i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He,0,0,Ye.width,Ye.height,ut,Ye.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He,tt,Ye.width,Ye.height,0,Ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?ti&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He,0,0,Ye.width,Ye.height,ut,ht,Ye.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He,tt,Ye.width,Ye.height,0,ut,ht,Ye.data)}}}else{Ge=J.mipmaps,pt&&Nt&&(Ge.length>0&&xe++,i.texStorage2D(t.TEXTURE_CUBE_MAP,xe,tt,ge[0].width,ge[0].height));for(let ie=0;ie<6;ie++)if(ze){pt?ti&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,0,0,ge[ie].width,ge[ie].height,ut,ht,ge[ie].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,tt,ge[ie].width,ge[ie].height,0,ut,ht,ge[ie].data);for(let He=0;He<Ge.length;He++){const dt=Ge[He].image[ie].image;pt?ti&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He+1,0,0,dt.width,dt.height,ut,ht,dt.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He+1,tt,dt.width,dt.height,0,ut,ht,dt.data)}}else{pt?ti&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,0,0,ut,ht,ge[ie]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,tt,ut,ht,ge[ie]);for(let He=0;He<Ge.length;He++){const Ye=Ge[He];pt?ti&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He+1,0,0,ut,ht,Ye.image[ie]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ie,He+1,tt,ut,ht,Ye.image[ie])}}}v(J,rt)&&b(t.TEXTURE_CUBE_MAP),ce.__version=Y.version,J.onUpdate&&J.onUpdate(J)}$.__version=J.version}function ve($,J,we,te,Y,ce){const Le=s.convert(we.format,we.colorSpace),X=s.convert(we.type),Ue=_(we.internalFormat,Le,X,we.colorSpace);if(!r.get(J).__hasExternalTextures){const ze=Math.max(1,J.width>>ce),ge=Math.max(1,J.height>>ce);Y===t.TEXTURE_3D||Y===t.TEXTURE_2D_ARRAY?i.texImage3D(Y,ce,Ue,ze,ge,J.depth,0,Le,X,null):i.texImage2D(Y,ce,Ue,ze,ge,0,Le,X,null)}i.bindFramebuffer(t.FRAMEBUFFER,$),Re(J)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,te,Y,r.get(we).__webglTexture,0,Ce(J)):(Y===t.TEXTURE_2D||Y>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Y<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,te,Y,r.get(we).__webglTexture,ce),i.bindFramebuffer(t.FRAMEBUFFER,null)}function ye($,J,we){if(t.bindRenderbuffer(t.RENDERBUFFER,$),J.depthBuffer&&!J.stencilBuffer){let te=a===!0?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(we||Re(J)){const Y=J.depthTexture;Y&&Y.isDepthTexture&&(Y.type===Rl?te=t.DEPTH_COMPONENT32F:Y.type===Hc&&(te=t.DEPTH_COMPONENT24));const ce=Ce(J);Re(J)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ce,te,J.width,J.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,ce,te,J.width,J.height)}else t.renderbufferStorage(t.RENDERBUFFER,te,J.width,J.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,$)}else if(J.depthBuffer&&J.stencilBuffer){const te=Ce(J);we&&Re(J)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,te,t.DEPTH24_STENCIL8,J.width,J.height):Re(J)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,te,t.DEPTH24_STENCIL8,J.width,J.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,J.width,J.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,$)}else{const te=J.isWebGLMultipleRenderTargets===!0?J.texture:[J.texture];for(let Y=0;Y<te.length;Y++){const ce=te[Y],Le=s.convert(ce.format,ce.colorSpace),X=s.convert(ce.type),Ue=_(ce.internalFormat,Le,X,ce.colorSpace),et=Ce(J);we&&Re(J)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,et,Ue,J.width,J.height):Re(J)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,et,Ue,J.width,J.height):t.renderbufferStorage(t.RENDERBUFFER,Ue,J.width,J.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function pe($,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,$),!(J.depthTexture&&J.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(J.depthTexture).__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),H(J.depthTexture,0);const te=r.get(J.depthTexture).__webglTexture,Y=Ce(J);if(J.depthTexture.format===Dp)Re(J)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,te,0,Y):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,te,0);else if(J.depthTexture.format===Hm)Re(J)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,te,0,Y):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,te,0);else throw new Error("Unknown depthTexture format")}function Se($){const J=r.get($),we=$.isWebGLCubeRenderTarget===!0;if($.depthTexture&&!J.__autoAllocateDepthBuffer){if(we)throw new Error("target.depthTexture not supported in Cube render targets");pe(J.__webglFramebuffer,$)}else if(we){J.__webglDepthbuffer=[];for(let te=0;te<6;te++)i.bindFramebuffer(t.FRAMEBUFFER,J.__webglFramebuffer[te]),J.__webglDepthbuffer[te]=t.createRenderbuffer(),ye(J.__webglDepthbuffer[te],$,!1)}else i.bindFramebuffer(t.FRAMEBUFFER,J.__webglFramebuffer),J.__webglDepthbuffer=t.createRenderbuffer(),ye(J.__webglDepthbuffer,$,!1);i.bindFramebuffer(t.FRAMEBUFFER,null)}function be($,J,we){const te=r.get($);J!==void 0&&ve(te.__webglFramebuffer,$,$.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),we!==void 0&&Se($)}function ee($){const J=$.texture,we=r.get($),te=r.get(J);$.addEventListener("dispose",M),$.isWebGLMultipleRenderTargets!==!0&&(te.__webglTexture===void 0&&(te.__webglTexture=t.createTexture()),te.__version=J.version,o.memory.textures++);const Y=$.isWebGLCubeRenderTarget===!0,ce=$.isWebGLMultipleRenderTargets===!0,Le=g($)||a;if(Y){we.__webglFramebuffer=[];for(let X=0;X<6;X++)if(a&&J.mipmaps&&J.mipmaps.length>0){we.__webglFramebuffer[X]=[];for(let Ue=0;Ue<J.mipmaps.length;Ue++)we.__webglFramebuffer[X][Ue]=t.createFramebuffer()}else we.__webglFramebuffer[X]=t.createFramebuffer()}else{if(a&&J.mipmaps&&J.mipmaps.length>0){we.__webglFramebuffer=[];for(let X=0;X<J.mipmaps.length;X++)we.__webglFramebuffer[X]=t.createFramebuffer()}else we.__webglFramebuffer=t.createFramebuffer();if(ce)if(n.drawBuffers){const X=$.texture;for(let Ue=0,et=X.length;Ue<et;Ue++){const ze=r.get(X[Ue]);ze.__webglTexture===void 0&&(ze.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&$.samples>0&&Re($)===!1){const X=ce?J:[J];we.__webglMultisampledFramebuffer=t.createFramebuffer(),we.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,we.__webglMultisampledFramebuffer);for(let Ue=0;Ue<X.length;Ue++){const et=X[Ue];we.__webglColorRenderbuffer[Ue]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,we.__webglColorRenderbuffer[Ue]);const ze=s.convert(et.format,et.colorSpace),ge=s.convert(et.type),ct=_(et.internalFormat,ze,ge,et.colorSpace,$.isXRRenderTarget===!0),rt=Ce($);t.renderbufferStorageMultisample(t.RENDERBUFFER,rt,ct,$.width,$.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ue,t.RENDERBUFFER,we.__webglColorRenderbuffer[Ue])}t.bindRenderbuffer(t.RENDERBUFFER,null),$.depthBuffer&&(we.__webglDepthRenderbuffer=t.createRenderbuffer(),ye(we.__webglDepthRenderbuffer,$,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Y){i.bindTexture(t.TEXTURE_CUBE_MAP,te.__webglTexture),le(t.TEXTURE_CUBE_MAP,J,Le);for(let X=0;X<6;X++)if(a&&J.mipmaps&&J.mipmaps.length>0)for(let Ue=0;Ue<J.mipmaps.length;Ue++)ve(we.__webglFramebuffer[X][Ue],$,J,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+X,Ue);else ve(we.__webglFramebuffer[X],$,J,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+X,0);v(J,Le)&&b(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(ce){const X=$.texture;for(let Ue=0,et=X.length;Ue<et;Ue++){const ze=X[Ue],ge=r.get(ze);i.bindTexture(t.TEXTURE_2D,ge.__webglTexture),le(t.TEXTURE_2D,ze,Le),ve(we.__webglFramebuffer,$,ze,t.COLOR_ATTACHMENT0+Ue,t.TEXTURE_2D,0),v(ze,Le)&&b(t.TEXTURE_2D)}i.unbindTexture()}else{let X=t.TEXTURE_2D;if(($.isWebGL3DRenderTarget||$.isWebGLArrayRenderTarget)&&(a?X=$.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(X,te.__webglTexture),le(X,J,Le),a&&J.mipmaps&&J.mipmaps.length>0)for(let Ue=0;Ue<J.mipmaps.length;Ue++)ve(we.__webglFramebuffer[Ue],$,J,t.COLOR_ATTACHMENT0,X,Ue);else ve(we.__webglFramebuffer,$,J,t.COLOR_ATTACHMENT0,X,0);v(J,Le)&&b(X),i.unbindTexture()}$.depthBuffer&&Se($)}function _e($){const J=g($)||a,we=$.isWebGLMultipleRenderTargets===!0?$.texture:[$.texture];for(let te=0,Y=we.length;te<Y;te++){const ce=we[te];if(v(ce,J)){const Le=$.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,X=r.get(ce).__webglTexture;i.bindTexture(Le,X),b(Le),i.unbindTexture()}}}function Me($){if(a&&$.samples>0&&Re($)===!1){const J=$.isWebGLMultipleRenderTargets?$.texture:[$.texture],we=$.width,te=$.height;let Y=t.COLOR_BUFFER_BIT;const ce=[],Le=$.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,X=r.get($),Ue=$.isWebGLMultipleRenderTargets===!0;if(Ue)for(let et=0;et<J.length;et++)i.bindFramebuffer(t.FRAMEBUFFER,X.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+et,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,X.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+et,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,X.__webglMultisampledFramebuffer),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,X.__webglFramebuffer);for(let et=0;et<J.length;et++){ce.push(t.COLOR_ATTACHMENT0+et),$.depthBuffer&&ce.push(Le);const ze=X.__ignoreDepthValues!==void 0?X.__ignoreDepthValues:!1;if(ze===!1&&($.depthBuffer&&(Y|=t.DEPTH_BUFFER_BIT),$.stencilBuffer&&(Y|=t.STENCIL_BUFFER_BIT)),Ue&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,X.__webglColorRenderbuffer[et]),ze===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Le]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Le])),Ue){const ge=r.get(J[et]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,ge,0)}t.blitFramebuffer(0,0,we,te,0,0,we,te,Y,t.NEAREST),u&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,ce)}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ue)for(let et=0;et<J.length;et++){i.bindFramebuffer(t.FRAMEBUFFER,X.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+et,t.RENDERBUFFER,X.__webglColorRenderbuffer[et]);const ze=r.get(J[et]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,X.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+et,t.TEXTURE_2D,ze,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,X.__webglMultisampledFramebuffer)}}function Ce($){return Math.min(n.maxSamples,$.samples)}function Re($){const J=r.get($);return a&&$.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&J.__useRenderToTexture!==!1}function Xe($){const J=o.render.frame;c.get($)!==J&&(c.set($,J),$.update())}function Oe($,J){const we=$.colorSpace,te=$.format,Y=$.type;return $.isCompressedTexture===!0||$.isVideoTexture===!0||$.format===eP||we!==Hh&&we!==Oa&&(or.getTransfer(we)===_r?a===!1?e.has("EXT_sRGB")===!0&&te===Fo?($.format=eP,$.minFilter=Rr,$.generateMipmaps=!1):J=O4.sRGBToLinear(J):(te!==Fo||Y!==kh)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",we)),J}this.allocateTextureUnit=D,this.resetTextureUnits=I,this.setTexture2D=H,this.setTexture2DArray=z,this.setTexture3D=B,this.setTextureCube=j,this.rebindTextures=be,this.setupRenderTarget=ee,this.updateRenderTargetMipmap=_e,this.updateMultisampleRenderTarget=Me,this.setupDepthRenderbuffer=Se,this.setupFrameBufferTexture=ve,this.useMultisampledRTT=Re}function Xne(t,e,i){const r=i.isWebGL2;function n(s,o=Oa){let a;const l=or.getTransfer(o);if(s===kh)return t.UNSIGNED_BYTE;if(s===E4)return t.UNSIGNED_SHORT_4_4_4_4;if(s===M4)return t.UNSIGNED_SHORT_5_5_5_1;if(s===hne)return t.BYTE;if(s===cne)return t.SHORT;if(s===nT)return t.UNSIGNED_SHORT;if(s===A4)return t.INT;if(s===Hc)return t.UNSIGNED_INT;if(s===Rl)return t.FLOAT;if(s===y0)return r?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===dne)return t.ALPHA;if(s===Fo)return t.RGBA;if(s===pne)return t.LUMINANCE;if(s===fne)return t.LUMINANCE_ALPHA;if(s===Dp)return t.DEPTH_COMPONENT;if(s===Hm)return t.DEPTH_STENCIL;if(s===eP)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===mne)return t.RED;if(s===C4)return t.RED_INTEGER;if(s===gne)return t.RG;if(s===P4)return t.RG_INTEGER;if(s===T4)return t.RGBA_INTEGER;if(s===eC||s===tC||s===iC||s===rC)if(l===_r)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===eC)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===tC)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===iC)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===rC)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===eC)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===tC)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===iC)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===rC)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===xU||s===wU||s===_U||s===SU)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===xU)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===wU)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===_U)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===SU)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===R4)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===AU||s===EU)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===AU)return l===_r?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===EU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===MU||s===CU||s===PU||s===TU||s===RU||s===kU||s===DU||s===IU||s===LU||s===BU||s===OU||s===UU||s===NU||s===FU)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===MU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===CU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===PU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===TU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===RU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===kU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===DU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===IU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===LU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===BU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===OU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===UU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===NU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===FU)return l===_r?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===nC||s===zU||s===HU)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===nC)return l===_r?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===zU)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===HU)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===yne||s===GU||s===VU||s===jU)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===nC)return a.COMPRESSED_RED_RGTC1_EXT;if(s===GU)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===VU)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===jU)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===kp?r?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:n}}class Yne extends xn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Gc extends Hi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const CVe={type:"move"};class mI{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Gc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Gc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ue,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ue),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Gc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ue,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ue),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const r of e.hand.values())this._getHandJoint(i,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,r){let n=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const m of e.hand.values()){const g=i.getJointPose(m,r),y=this._getHandJoint(u,m);g!==null&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=g.radius),y.visible=g!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),p=.02,f=.005;u.inputState.pinching&&d>p+f?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=p-f&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=i.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(n=i.getPose(e.targetRaySpace,r),n===null&&s!==null&&(n=s),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(CVe)))}return a!==null&&(a.visible=n!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const r=new Gc;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[i.jointName]=r,e.add(r)}return e.joints[i.jointName]}}const PVe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,TVe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class RVe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,i,r){if(this.texture===null){const n=new Ir,s=e.properties.get(n);s.__webglTexture=i.texture,(i.depthNear!=r.depthNear||i.depthFar!=r.depthFar)&&(this.depthNear=i.depthNear,this.depthFar=i.depthFar),this.texture=n}}render(e,i){if(this.texture!==null){if(this.mesh===null){const r=i.cameras[0].viewport,n=new Ru({extensions:{fragDepth:!0},vertexShader:PVe,fragmentShader:TVe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new _n(new rb(20,20),n)}e.render(this.mesh,i)}}reset(){this.texture=null,this.mesh=null}}class kVe extends hd{constructor(e,i){super();const r=this;let n=null,s=1,o=null,a="local-floor",l=1,u=null,c=null,h=null,d=null,p=null,f=null;const m=new RVe,g=i.getContextAttributes();let y=null,v=null;const b=[],_=[],A=new ot;let S=null;const E=new xn;E.layers.enable(1),E.viewport=new lr;const M=new xn;M.layers.enable(2),M.viewport=new lr;const R=[E,M],C=new Yne;C.layers.enable(1),C.layers.enable(2);let T=null,L=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Z){let oe=b[Z];return oe===void 0&&(oe=new mI,b[Z]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(Z){let oe=b[Z];return oe===void 0&&(oe=new mI,b[Z]=oe),oe.getGripSpace()},this.getHand=function(Z){let oe=b[Z];return oe===void 0&&(oe=new mI,b[Z]=oe),oe.getHandSpace()};function I(Z){const oe=_.indexOf(Z.inputSource);if(oe===-1)return;const ae=b[oe];ae!==void 0&&(ae.update(Z.inputSource,Z.frame,u||o),ae.dispatchEvent({type:Z.type,data:Z.inputSource}))}function D(){n.removeEventListener("select",I),n.removeEventListener("selectstart",I),n.removeEventListener("selectend",I),n.removeEventListener("squeeze",I),n.removeEventListener("squeezestart",I),n.removeEventListener("squeezeend",I),n.removeEventListener("end",D),n.removeEventListener("inputsourceschange",F);for(let Z=0;Z<b.length;Z++){const oe=_[Z];oe!==null&&(_[Z]=null,b[Z].disconnect(oe))}T=null,L=null,m.reset(),e.setRenderTarget(y),p=null,d=null,h=null,n=null,v=null,le.stop(),r.isPresenting=!1,e.setPixelRatio(S),e.setSize(A.width,A.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Z){s=Z,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Z){a=Z,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(Z){u=Z},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(Z){if(n=Z,n!==null){if(y=e.getRenderTarget(),n.addEventListener("select",I),n.addEventListener("selectstart",I),n.addEventListener("selectend",I),n.addEventListener("squeeze",I),n.addEventListener("squeezestart",I),n.addEventListener("squeezeend",I),n.addEventListener("end",D),n.addEventListener("inputsourceschange",F),g.xrCompatible!==!0&&await i.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(A),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const oe={antialias:n.renderState.layers===void 0?g.antialias:!0,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(n,i,oe),n.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),v=new Tu(p.framebufferWidth,p.framebufferHeight,{format:Fo,type:kh,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let oe=null,ae=null,ve=null;g.depth&&(ve=g.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,oe=g.stencil?Hm:Dp,ae=g.stencil?kp:Hc);const ye={colorFormat:i.RGBA8,depthFormat:ve,scaleFactor:s};h=new XRWebGLBinding(n,i),d=h.createProjectionLayer(ye),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),v=new Tu(d.textureWidth,d.textureHeight,{format:Fo,type:kh,depthTexture:new H4(d.textureWidth,d.textureHeight,ae,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0});const pe=e.properties.get(v);pe.__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await n.requestReferenceSpace(a),le.setContext(n),le.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode};function F(Z){for(let oe=0;oe<Z.removed.length;oe++){const ae=Z.removed[oe],ve=_.indexOf(ae);ve>=0&&(_[ve]=null,b[ve].disconnect(ae))}for(let oe=0;oe<Z.added.length;oe++){const ae=Z.added[oe];let ve=_.indexOf(ae);if(ve===-1){for(let pe=0;pe<b.length;pe++)if(pe>=_.length){_.push(ae),ve=pe;break}else if(_[pe]===null){_[pe]=ae,ve=pe;break}if(ve===-1)break}const ye=b[ve];ye&&ye.connect(ae)}}const H=new ue,z=new ue;function B(Z,oe,ae){H.setFromMatrixPosition(oe.matrixWorld),z.setFromMatrixPosition(ae.matrixWorld);const ve=H.distanceTo(z),ye=oe.projectionMatrix.elements,pe=ae.projectionMatrix.elements,Se=ye[14]/(ye[10]-1),be=ye[14]/(ye[10]+1),ee=(ye[9]+1)/ye[5],_e=(ye[9]-1)/ye[5],Me=(ye[8]-1)/ye[0],Ce=(pe[8]+1)/pe[0],Re=Se*Me,Xe=Se*Ce,Oe=ve/(-Me+Ce),$=Oe*-Me;oe.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX($),Z.translateZ(Oe),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.copy(Z.matrixWorld).invert();const J=Se+Oe,we=be+Oe,te=Re-$,Y=Xe+(ve-$),ce=ee*be/we*J,Le=_e*be/we*J;Z.projectionMatrix.makePerspective(te,Y,ce,Le,J,we),Z.projectionMatrixInverse.copy(Z.projectionMatrix).invert()}function j(Z,oe){oe===null?Z.matrixWorld.copy(Z.matrix):Z.matrixWorld.multiplyMatrices(oe.matrixWorld,Z.matrix),Z.matrixWorldInverse.copy(Z.matrixWorld).invert()}this.updateCamera=function(Z){if(n===null)return;m.texture!==null&&(Z.near=m.depthNear,Z.far=m.depthFar),C.near=M.near=E.near=Z.near,C.far=M.far=E.far=Z.far,(T!==C.near||L!==C.far)&&(n.updateRenderState({depthNear:C.near,depthFar:C.far}),T=C.near,L=C.far,E.near=T,E.far=L,M.near=T,M.far=L,E.updateProjectionMatrix(),M.updateProjectionMatrix(),Z.updateProjectionMatrix());const oe=Z.parent,ae=C.cameras;j(C,oe);for(let ve=0;ve<ae.length;ve++)j(ae[ve],oe);ae.length===2?B(C,E,M):C.projectionMatrix.copy(E.projectionMatrix),V(Z,C,oe)};function V(Z,oe,ae){ae===null?Z.matrix.copy(oe.matrixWorld):(Z.matrix.copy(ae.matrixWorld),Z.matrix.invert(),Z.matrix.multiply(oe.matrixWorld)),Z.matrix.decompose(Z.position,Z.quaternion,Z.scale),Z.updateMatrixWorld(!0),Z.projectionMatrix.copy(oe.projectionMatrix),Z.projectionMatrixInverse.copy(oe.projectionMatrixInverse),Z.isPerspectiveCamera&&(Z.fov=b0*2*Math.atan(1/Z.projectionMatrix.elements[5]),Z.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(d===null&&p===null))return l},this.setFoveation=function(Z){l=Z,d!==null&&(d.fixedFoveation=Z),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=Z)},this.hasDepthSensing=function(){return m.texture!==null};let q=null;function K(Z,oe){if(c=oe.getViewerPose(u||o),f=oe,c!==null){const ae=c.views;p!==null&&(e.setRenderTargetFramebuffer(v,p.framebuffer),e.setRenderTarget(v));let ve=!1;ae.length!==C.cameras.length&&(C.cameras.length=0,ve=!0);for(let pe=0;pe<ae.length;pe++){const Se=ae[pe];let be=null;if(p!==null)be=p.getViewport(Se);else{const _e=h.getViewSubImage(d,Se);be=_e.viewport,pe===0&&(e.setRenderTargetTextures(v,_e.colorTexture,d.ignoreDepthValues?void 0:_e.depthStencilTexture),e.setRenderTarget(v))}let ee=R[pe];ee===void 0&&(ee=new xn,ee.layers.enable(pe),ee.viewport=new lr,R[pe]=ee),ee.matrix.fromArray(Se.transform.matrix),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale),ee.projectionMatrix.fromArray(Se.projectionMatrix),ee.projectionMatrixInverse.copy(ee.projectionMatrix).invert(),ee.viewport.set(be.x,be.y,be.width,be.height),pe===0&&(C.matrix.copy(ee.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),ve===!0&&C.cameras.push(ee)}const ye=n.enabledFeatures;if(ye&&ye.includes("depth-sensing")){const pe=h.getDepthInformation(ae[0]);pe&&pe.isValid&&pe.texture&&m.init(e,pe,n.renderState)}}for(let ae=0;ae<b.length;ae++){const ve=_[ae],ye=b[ae];ve!==null&&ye!==void 0&&ye.update(ve,oe,u||o)}m.render(e,C),q&&q(Z,oe),oe.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:oe}),f=null}const le=new Hne;le.setAnimationLoop(K),this.setAnimationLoop=function(Z){q=Z},this.dispose=function(){}}}function DVe(t,e){function i(g,y){g.matrixAutoUpdate===!0&&g.updateMatrix(),y.value.copy(g.matrix)}function r(g,y){y.color.getRGB(g.fogColor.value,Une(t)),y.isFog?(g.fogNear.value=y.near,g.fogFar.value=y.far):y.isFogExp2&&(g.fogDensity.value=y.density)}function n(g,y,v,b,_){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(g,y):y.isMeshToonMaterial?(s(g,y),h(g,y)):y.isMeshPhongMaterial?(s(g,y),c(g,y)):y.isMeshStandardMaterial?(s(g,y),d(g,y),y.isMeshPhysicalMaterial&&p(g,y,_)):y.isMeshMatcapMaterial?(s(g,y),f(g,y)):y.isMeshDepthMaterial?s(g,y):y.isMeshDistanceMaterial?(s(g,y),m(g,y)):y.isMeshNormalMaterial?s(g,y):y.isLineBasicMaterial?(o(g,y),y.isLineDashedMaterial&&a(g,y)):y.isPointsMaterial?l(g,y,v,b):y.isSpriteMaterial?u(g,y):y.isShadowMaterial?(g.color.value.copy(y.color),g.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(g,y){g.opacity.value=y.opacity,y.color&&g.diffuse.value.copy(y.color),y.emissive&&g.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(g.map.value=y.map,i(y.map,g.mapTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,i(y.alphaMap,g.alphaMapTransform)),y.bumpMap&&(g.bumpMap.value=y.bumpMap,i(y.bumpMap,g.bumpMapTransform),g.bumpScale.value=y.bumpScale,y.side===jo&&(g.bumpScale.value*=-1)),y.normalMap&&(g.normalMap.value=y.normalMap,i(y.normalMap,g.normalMapTransform),g.normalScale.value.copy(y.normalScale),y.side===jo&&g.normalScale.value.negate()),y.displacementMap&&(g.displacementMap.value=y.displacementMap,i(y.displacementMap,g.displacementMapTransform),g.displacementScale.value=y.displacementScale,g.displacementBias.value=y.displacementBias),y.emissiveMap&&(g.emissiveMap.value=y.emissiveMap,i(y.emissiveMap,g.emissiveMapTransform)),y.specularMap&&(g.specularMap.value=y.specularMap,i(y.specularMap,g.specularMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest);const v=e.get(y).envMap;if(v&&(g.envMap.value=v,g.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=y.reflectivity,g.ior.value=y.ior,g.refractionRatio.value=y.refractionRatio),y.lightMap){g.lightMap.value=y.lightMap;const b=t._useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=y.lightMapIntensity*b,i(y.lightMap,g.lightMapTransform)}y.aoMap&&(g.aoMap.value=y.aoMap,g.aoMapIntensity.value=y.aoMapIntensity,i(y.aoMap,g.aoMapTransform))}function o(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,y.map&&(g.map.value=y.map,i(y.map,g.mapTransform))}function a(g,y){g.dashSize.value=y.dashSize,g.totalSize.value=y.dashSize+y.gapSize,g.scale.value=y.scale}function l(g,y,v,b){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.size.value=y.size*v,g.scale.value=b*.5,y.map&&(g.map.value=y.map,i(y.map,g.uvTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,i(y.alphaMap,g.alphaMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest)}function u(g,y){g.diffuse.value.copy(y.color),g.opacity.value=y.opacity,g.rotation.value=y.rotation,y.map&&(g.map.value=y.map,i(y.map,g.mapTransform)),y.alphaMap&&(g.alphaMap.value=y.alphaMap,i(y.alphaMap,g.alphaMapTransform)),y.alphaTest>0&&(g.alphaTest.value=y.alphaTest)}function c(g,y){g.specular.value.copy(y.specular),g.shininess.value=Math.max(y.shininess,1e-4)}function h(g,y){y.gradientMap&&(g.gradientMap.value=y.gradientMap)}function d(g,y){g.metalness.value=y.metalness,y.metalnessMap&&(g.metalnessMap.value=y.metalnessMap,i(y.metalnessMap,g.metalnessMapTransform)),g.roughness.value=y.roughness,y.roughnessMap&&(g.roughnessMap.value=y.roughnessMap,i(y.roughnessMap,g.roughnessMapTransform)),e.get(y).envMap&&(g.envMapIntensity.value=y.envMapIntensity)}function p(g,y,v){g.ior.value=y.ior,y.sheen>0&&(g.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),g.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(g.sheenColorMap.value=y.sheenColorMap,i(y.sheenColorMap,g.sheenColorMapTransform)),y.sheenRoughnessMap&&(g.sheenRoughnessMap.value=y.sheenRoughnessMap,i(y.sheenRoughnessMap,g.sheenRoughnessMapTransform))),y.clearcoat>0&&(g.clearcoat.value=y.clearcoat,g.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(g.clearcoatMap.value=y.clearcoatMap,i(y.clearcoatMap,g.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,i(y.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(g.clearcoatNormalMap.value=y.clearcoatNormalMap,i(y.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===jo&&g.clearcoatNormalScale.value.negate())),y.iridescence>0&&(g.iridescence.value=y.iridescence,g.iridescenceIOR.value=y.iridescenceIOR,g.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(g.iridescenceMap.value=y.iridescenceMap,i(y.iridescenceMap,g.iridescenceMapTransform)),y.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=y.iridescenceThicknessMap,i(y.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),y.transmission>0&&(g.transmission.value=y.transmission,g.transmissionSamplerMap.value=v.texture,g.transmissionSamplerSize.value.set(v.width,v.height),y.transmissionMap&&(g.transmissionMap.value=y.transmissionMap,i(y.transmissionMap,g.transmissionMapTransform)),g.thickness.value=y.thickness,y.thicknessMap&&(g.thicknessMap.value=y.thicknessMap,i(y.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=y.attenuationDistance,g.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(g.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(g.anisotropyMap.value=y.anisotropyMap,i(y.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=y.specularIntensity,g.specularColor.value.copy(y.specularColor),y.specularColorMap&&(g.specularColorMap.value=y.specularColorMap,i(y.specularColorMap,g.specularColorMapTransform)),y.specularIntensityMap&&(g.specularIntensityMap.value=y.specularIntensityMap,i(y.specularIntensityMap,g.specularIntensityMapTransform))}function f(g,y){y.matcap&&(g.matcap.value=y.matcap)}function m(g,y){const v=e.get(y).light;g.referencePosition.value.setFromMatrixPosition(v.matrixWorld),g.nearDistance.value=v.shadow.camera.near,g.farDistance.value=v.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:n}}function IVe(t,e,i,r){let n={},s={},o=[];const a=i.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(v,b){const _=b.program;r.uniformBlockBinding(v,_)}function u(v,b){let _=n[v.id];_===void 0&&(f(v),_=c(v),n[v.id]=_,v.addEventListener("dispose",g));const A=b.program;r.updateUBOMapping(v,A);const S=e.render.frame;s[v.id]!==S&&(d(v),s[v.id]=S)}function c(v){const b=h();v.__bindingPointIndex=b;const _=t.createBuffer(),A=v.__size,S=v.usage;return t.bindBuffer(t.UNIFORM_BUFFER,_),t.bufferData(t.UNIFORM_BUFFER,A,S),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,b,_),_}function h(){for(let v=0;v<a;v++)if(o.indexOf(v)===-1)return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(v){const b=n[v.id],_=v.uniforms,A=v.__cache;t.bindBuffer(t.UNIFORM_BUFFER,b);for(let S=0,E=_.length;S<E;S++){const M=Array.isArray(_[S])?_[S]:[_[S]];for(let R=0,C=M.length;R<C;R++){const T=M[R];if(p(T,S,R,A)===!0){const L=T.__offset,I=Array.isArray(T.value)?T.value:[T.value];let D=0;for(let F=0;F<I.length;F++){const H=I[F],z=m(H);typeof H=="number"||typeof H=="boolean"?(T.__data[0]=H,t.bufferSubData(t.UNIFORM_BUFFER,L+D,T.__data)):H.isMatrix3?(T.__data[0]=H.elements[0],T.__data[1]=H.elements[1],T.__data[2]=H.elements[2],T.__data[3]=0,T.__data[4]=H.elements[3],T.__data[5]=H.elements[4],T.__data[6]=H.elements[5],T.__data[7]=0,T.__data[8]=H.elements[6],T.__data[9]=H.elements[7],T.__data[10]=H.elements[8],T.__data[11]=0):(H.toArray(T.__data,D),D+=z.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,L,T.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function p(v,b,_,A){const S=v.value,E=b+"_"+_;if(A[E]===void 0)return typeof S=="number"||typeof S=="boolean"?A[E]=S:A[E]=S.clone(),!0;{const M=A[E];if(typeof S=="number"||typeof S=="boolean"){if(M!==S)return A[E]=S,!0}else if(M.equals(S)===!1)return M.copy(S),!0}return!1}function f(v){const b=v.uniforms;let _=0;const A=16;for(let E=0,M=b.length;E<M;E++){const R=Array.isArray(b[E])?b[E]:[b[E]];for(let C=0,T=R.length;C<T;C++){const L=R[C],I=Array.isArray(L.value)?L.value:[L.value];for(let D=0,F=I.length;D<F;D++){const H=I[D],z=m(H),B=_%A;B!==0&&A-B<z.boundary&&(_+=A-B),L.__data=new Float32Array(z.storage/Float32Array.BYTES_PER_ELEMENT),L.__offset=_,_+=z.storage}}}const S=_%A;return S>0&&(_+=A-S),v.__size=_,v.__cache={},this}function m(v){const b={boundary:0,storage:0};return typeof v=="number"||typeof v=="boolean"?(b.boundary=4,b.storage=4):v.isVector2?(b.boundary=8,b.storage=8):v.isVector3||v.isColor?(b.boundary=16,b.storage=12):v.isVector4?(b.boundary=16,b.storage=16):v.isMatrix3?(b.boundary=48,b.storage=48):v.isMatrix4?(b.boundary=64,b.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),b}function g(v){const b=v.target;b.removeEventListener("dispose",g);const _=o.indexOf(b.__bindingPointIndex);o.splice(_,1),t.deleteBuffer(n[b.id]),delete n[b.id],delete s[b.id]}function y(){for(const v in n)t.deleteBuffer(n[v]);o=[],n={},s={}}return{bind:l,update:u,dispose:y}}class j4{constructor(e={}){const{canvas:i=Lne(),context:r=null,depth:n=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;r!==null?d=r.getContextAttributes().alpha:d=o;const p=new Uint32Array(4),f=new Int32Array(4);let m=null,g=null;const y=[],v=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=es,this._useLegacyLights=!1,this.toneMapping=Rh,this.toneMappingExposure=1;const b=this;let _=!1,A=0,S=0,E=null,M=-1,R=null;const C=new lr,T=new lr;let L=null;const I=new St(0);let D=0,F=i.width,H=i.height,z=1,B=null,j=null;const V=new lr(0,0,F,H),q=new lr(0,0,F,H);let K=!1;const le=new m_;let Z=!1,oe=!1,ae=null;const ve=new ii,ye=new ot,pe=new ue,Se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function be(){return E===null?z:1}let ee=r;function _e(ne,Pe){for(let De=0;De<ne.length;De++){const Be=ne[De],ke=i.getContext(Be,Pe);if(ke!==null)return ke}return null}try{const ne={alpha:!0,depth:n,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${u_}`),i.addEventListener("webglcontextlost",Ge,!1),i.addEventListener("webglcontextrestored",ie,!1),i.addEventListener("webglcontextcreationerror",He,!1),ee===null){const Pe=["webgl2","webgl","experimental-webgl"];if(b.isWebGL1Renderer===!0&&Pe.shift(),ee=_e(Pe,ne),ee===null)throw _e(Pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&ee instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),ee.getShaderPrecisionFormat===void 0&&(ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}let Me,Ce,Re,Xe,Oe,$,J,we,te,Y,ce,Le,X,Ue,et,ze,ge,ct,rt,ut,ht,tt,pt,Nt;function ti(){Me=new jHe(ee),Ce=new NHe(ee,Me,e),Me.init(Ce),tt=new Xne(ee,Me,Ce),Re=new EVe(ee,Me,Ce),Xe=new XHe(ee),Oe=new pVe,$=new MVe(ee,Me,Re,Oe,Ce,tt,Xe),J=new zHe(b),we=new VHe(b),te=new t4e(ee,Ce),pt=new OHe(ee,Me,te,Ce),Y=new WHe(ee,te,Xe,pt),ce=new QHe(ee,Y,te,Xe),rt=new JHe(ee,Ce,$),ze=new FHe(Oe),Le=new dVe(b,J,we,Me,Ce,pt,ze),X=new DVe(b,Oe),Ue=new mVe,et=new wVe(Me,Ce),ct=new BHe(b,J,we,Re,ce,d,l),ge=new AVe(b,ce,Ce),Nt=new IVe(ee,Xe,Ce,Re),ut=new UHe(ee,Me,Xe,Ce),ht=new qHe(ee,Me,Xe,Ce),Xe.programs=Le.programs,b.capabilities=Ce,b.extensions=Me,b.properties=Oe,b.renderLists=Ue,b.shadowMap=ge,b.state=Re,b.info=Xe}ti();const xe=new kVe(b,ee);this.xr=xe,this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.forceContextLoss=function(){const ne=Me.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=Me.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(ne){ne!==void 0&&(z=ne,this.setSize(F,H,!1))},this.getSize=function(ne){return ne.set(F,H)},this.setSize=function(ne,Pe,De=!0){if(xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}F=ne,H=Pe,i.width=Math.floor(ne*z),i.height=Math.floor(Pe*z),De===!0&&(i.style.width=ne+"px",i.style.height=Pe+"px"),this.setViewport(0,0,ne,Pe)},this.getDrawingBufferSize=function(ne){return ne.set(F*z,H*z).floor()},this.setDrawingBufferSize=function(ne,Pe,De){F=ne,H=Pe,z=De,i.width=Math.floor(ne*De),i.height=Math.floor(Pe*De),this.setViewport(0,0,ne,Pe)},this.getCurrentViewport=function(ne){return ne.copy(C)},this.getViewport=function(ne){return ne.copy(V)},this.setViewport=function(ne,Pe,De,Be){ne.isVector4?V.set(ne.x,ne.y,ne.z,ne.w):V.set(ne,Pe,De,Be),Re.viewport(C.copy(V).multiplyScalar(z).floor())},this.getScissor=function(ne){return ne.copy(q)},this.setScissor=function(ne,Pe,De,Be){ne.isVector4?q.set(ne.x,ne.y,ne.z,ne.w):q.set(ne,Pe,De,Be),Re.scissor(T.copy(q).multiplyScalar(z).floor())},this.getScissorTest=function(){return K},this.setScissorTest=function(ne){Re.setScissorTest(K=ne)},this.setOpaqueSort=function(ne){B=ne},this.setTransparentSort=function(ne){j=ne},this.getClearColor=function(ne){return ne.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(ne=!0,Pe=!0,De=!0){let Be=0;if(ne){let ke=!1;if(E!==null){const gt=E.texture.format;ke=gt===T4||gt===P4||gt===C4}if(ke){const gt=E.texture.type,Rt=gt===kh||gt===Hc||gt===nT||gt===kp||gt===E4||gt===M4,zt=ct.getClearColor(),Mt=ct.getClearAlpha(),bt=zt.r,Gt=zt.g,yt=zt.b;Rt?(p[0]=bt,p[1]=Gt,p[2]=yt,p[3]=Mt,ee.clearBufferuiv(ee.COLOR,0,p)):(f[0]=bt,f[1]=Gt,f[2]=yt,f[3]=Mt,ee.clearBufferiv(ee.COLOR,0,f))}else Be|=ee.COLOR_BUFFER_BIT}Pe&&(Be|=ee.DEPTH_BUFFER_BIT),De&&(Be|=ee.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ee.clear(Be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",Ge,!1),i.removeEventListener("webglcontextrestored",ie,!1),i.removeEventListener("webglcontextcreationerror",He,!1),Ue.dispose(),et.dispose(),Oe.dispose(),J.dispose(),we.dispose(),ce.dispose(),pt.dispose(),Nt.dispose(),Le.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",yr),xe.removeEventListener("sessionend",gi),ae&&(ae.dispose(),ae=null),Br.stop()};function Ge(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function ie(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const ne=Xe.autoReset,Pe=ge.enabled,De=ge.autoUpdate,Be=ge.needsUpdate,ke=ge.type;ti(),Xe.autoReset=ne,ge.enabled=Pe,ge.autoUpdate=De,ge.needsUpdate=Be,ge.type=ke}function He(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function Ye(ne){const Pe=ne.target;Pe.removeEventListener("dispose",Ye),dt(Pe)}function dt(ne){At(ne),Oe.remove(ne)}function At(ne){const Pe=Oe.get(ne).programs;Pe!==void 0&&(Pe.forEach(function(De){Le.releaseProgram(De)}),ne.isShaderMaterial&&Le.releaseShaderCache(ne))}this.renderBufferDirect=function(ne,Pe,De,Be,ke,gt){Pe===null&&(Pe=Se);const Rt=ke.isMesh&&ke.matrixWorld.determinant()<0,zt=Lt(ne,Pe,De,Be,ke);Re.setMaterial(Be,Rt);let Mt=De.index,bt=1;if(Be.wireframe===!0){if(Mt=Y.getWireframeAttribute(De),Mt===void 0)return;bt=2}const Gt=De.drawRange,yt=De.attributes.position;let Vi=Gt.start*bt,Er=(Gt.start+Gt.count)*bt;gt!==null&&(Vi=Math.max(Vi,gt.start*bt),Er=Math.min(Er,(gt.start+gt.count)*bt)),Mt!==null?(Vi=Math.max(Vi,0),Er=Math.min(Er,Mt.count)):yt!=null&&(Vi=Math.max(Vi,0),Er=Math.min(Er,yt.count));const Ni=Er-Vi;if(Ni<0||Ni===1/0)return;pt.setup(ke,Be,zt,De,Mt);let rr,W=ut;if(Mt!==null&&(rr=te.get(Mt),W=ht,W.setIndex(rr)),ke.isMesh)Be.wireframe===!0?(Re.setLineWidth(Be.wireframeLinewidth*be()),W.setMode(ee.LINES)):W.setMode(ee.TRIANGLES);else if(ke.isLine){let Q=Be.linewidth;Q===void 0&&(Q=1),Re.setLineWidth(Q*be()),ke.isLineSegments?W.setMode(ee.LINES):ke.isLineLoop?W.setMode(ee.LINE_LOOP):W.setMode(ee.LINE_STRIP)}else ke.isPoints?W.setMode(ee.POINTS):ke.isSprite&&W.setMode(ee.TRIANGLES);if(ke.isBatchedMesh)W.renderMultiDraw(ke._multiDrawStarts,ke._multiDrawCounts,ke._multiDrawCount);else if(ke.isInstancedMesh)W.renderInstances(Vi,Ni,ke.count);else if(De.isInstancedBufferGeometry){const Q=De._maxInstanceCount!==void 0?De._maxInstanceCount:1/0,fe=Math.min(De.instanceCount,Q);W.renderInstances(Vi,Ni,fe)}else W.render(Vi,Ni)};function ri(ne,Pe,De){ne.transparent===!0&&ne.side===Tl&&ne.forceSinglePass===!1?(ne.side=jo,ne.needsUpdate=!0,Qe(ne,Pe,De),ne.side=zh,ne.needsUpdate=!0,Qe(ne,Pe,De),ne.side=Tl):Qe(ne,Pe,De)}this.compile=function(ne,Pe,De=null){De===null&&(De=ne),g=et.get(De),g.init(),v.push(g),De.traverseVisible(function(ke){ke.isLight&&ke.layers.test(Pe.layers)&&(g.pushLight(ke),ke.castShadow&&g.pushShadow(ke))}),ne!==De&&ne.traverseVisible(function(ke){ke.isLight&&ke.layers.test(Pe.layers)&&(g.pushLight(ke),ke.castShadow&&g.pushShadow(ke))}),g.setupLights(b._useLegacyLights);const Be=new Set;return ne.traverse(function(ke){const gt=ke.material;if(gt)if(Array.isArray(gt))for(let Rt=0;Rt<gt.length;Rt++){const zt=gt[Rt];ri(zt,De,ke),Be.add(zt)}else ri(gt,De,ke),Be.add(gt)}),v.pop(),g=null,Be},this.compileAsync=function(ne,Pe,De=null){const Be=this.compile(ne,Pe,De);return new Promise(ke=>{function gt(){if(Be.forEach(function(Rt){Oe.get(Rt).currentProgram.isReady()&&Be.delete(Rt)}),Be.size===0){ke(ne);return}setTimeout(gt,10)}Me.get("KHR_parallel_shader_compile")!==null?gt():setTimeout(gt,10)})};let Si=null;function li(ne){Si&&Si(ne)}function yr(){Br.stop()}function gi(){Br.start()}const Br=new Hne;Br.setAnimationLoop(li),typeof self<"u"&&Br.setContext(self),this.setAnimationLoop=function(ne){Si=ne,xe.setAnimationLoop(ne),ne===null?Br.stop():Br.start()},xe.addEventListener("sessionstart",yr),xe.addEventListener("sessionend",gi),this.render=function(ne,Pe){if(Pe!==void 0&&Pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Pe.parent===null&&Pe.matrixWorldAutoUpdate===!0&&Pe.updateMatrixWorld(),xe.enabled===!0&&xe.isPresenting===!0&&(xe.cameraAutoUpdate===!0&&xe.updateCamera(Pe),Pe=xe.getCamera()),ne.isScene===!0&&ne.onBeforeRender(b,ne,Pe,E),g=et.get(ne,v.length),g.init(),v.push(g),ve.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),le.setFromProjectionMatrix(ve),oe=this.localClippingEnabled,Z=ze.init(this.clippingPlanes,oe),m=Ue.get(ne,y.length),m.init(),y.push(m),Ks(ne,Pe,0,b.sortObjects),m.finish(),b.sortObjects===!0&&m.sort(B,j),this.info.render.frame++,Z===!0&&ze.beginShadows();const De=g.state.shadowsArray;if(ge.render(De,ne,Pe),Z===!0&&ze.endShadows(),this.info.autoReset===!0&&this.info.reset(),(xe.enabled===!1||xe.isPresenting===!1||xe.hasDepthSensing()===!1)&&ct.render(m,ne),g.setupLights(b._useLegacyLights),Pe.isArrayCamera){const Be=Pe.cameras;for(let ke=0,gt=Be.length;ke<gt;ke++){const Rt=Be[ke];Kh(m,ne,Rt,Rt.viewport)}}else Kh(m,ne,Pe);E!==null&&($.updateMultisampleRenderTarget(E),$.updateRenderTargetMipmap(E)),ne.isScene===!0&&ne.onAfterRender(b,ne,Pe),pt.resetDefaultState(),M=-1,R=null,v.pop(),v.length>0?g=v[v.length-1]:g=null,y.pop(),y.length>0?m=y[y.length-1]:m=null};function Ks(ne,Pe,De,Be){if(ne.visible===!1)return;if(ne.layers.test(Pe.layers)){if(ne.isGroup)De=ne.renderOrder;else if(ne.isLOD)ne.autoUpdate===!0&&ne.update(Pe);else if(ne.isLight)g.pushLight(ne),ne.castShadow&&g.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||le.intersectsSprite(ne)){Be&&pe.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(ve);const Rt=ce.update(ne),zt=ne.material;zt.visible&&m.push(ne,Rt,zt,De,pe.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(!ne.frustumCulled||le.intersectsObject(ne))){const Rt=ce.update(ne),zt=ne.material;if(Be&&(ne.boundingSphere!==void 0?(ne.boundingSphere===null&&ne.computeBoundingSphere(),pe.copy(ne.boundingSphere.center)):(Rt.boundingSphere===null&&Rt.computeBoundingSphere(),pe.copy(Rt.boundingSphere.center)),pe.applyMatrix4(ne.matrixWorld).applyMatrix4(ve)),Array.isArray(zt)){const Mt=Rt.groups;for(let bt=0,Gt=Mt.length;bt<Gt;bt++){const yt=Mt[bt],Vi=zt[yt.materialIndex];Vi&&Vi.visible&&m.push(ne,Rt,Vi,De,pe.z,yt)}}else zt.visible&&m.push(ne,Rt,zt,De,pe.z,null)}}const gt=ne.children;for(let Rt=0,zt=gt.length;Rt<zt;Rt++)Ks(gt[Rt],Pe,De,Be)}function Kh(ne,Pe,De,Be){const ke=ne.opaque,gt=ne.transmissive,Rt=ne.transparent;g.setupLightsView(De),Z===!0&&ze.setGlobalState(b.clippingPlanes,De),gt.length>0&&Vl(ke,gt,Pe,De),Be&&Re.viewport(C.copy(Be)),ke.length>0&&he(ke,Pe,De),gt.length>0&&he(gt,Pe,De),Rt.length>0&&he(Rt,Pe,De),Re.buffers.depth.setTest(!0),Re.buffers.depth.setMask(!0),Re.buffers.color.setMask(!0),Re.setPolygonOffset(!1)}function Vl(ne,Pe,De,Be){if((De.isScene===!0?De.overrideMaterial:null)!==null)return;const gt=Ce.isWebGL2;ae===null&&(ae=new Tu(1,1,{generateMipmaps:!0,type:Me.has("EXT_color_buffer_half_float")?y0:kh,minFilter:Il,samples:gt?4:0})),b.getDrawingBufferSize(ye),gt?ae.setSize(ye.x,ye.y):ae.setSize(tP(ye.x),tP(ye.y));const Rt=b.getRenderTarget();b.setRenderTarget(ae),b.getClearColor(I),D=b.getClearAlpha(),D<1&&b.setClearColor(16777215,.5),b.clear();const zt=b.toneMapping;b.toneMapping=Rh,he(ne,De,Be),$.updateMultisampleRenderTarget(ae),$.updateRenderTargetMipmap(ae);let Mt=!1;for(let bt=0,Gt=Pe.length;bt<Gt;bt++){const yt=Pe[bt],Vi=yt.object,Er=yt.geometry,Ni=yt.material,rr=yt.group;if(Ni.side===Tl&&Vi.layers.test(Be.layers)){const W=Ni.side;Ni.side=jo,Ni.needsUpdate=!0,Ve(Vi,De,Be,Er,Ni,rr),Ni.side=W,Ni.needsUpdate=!0,Mt=!0}}Mt===!0&&($.updateMultisampleRenderTarget(ae),$.updateRenderTargetMipmap(ae)),b.setRenderTarget(Rt),b.setClearColor(I,D),b.toneMapping=zt}function he(ne,Pe,De){const Be=Pe.isScene===!0?Pe.overrideMaterial:null;for(let ke=0,gt=ne.length;ke<gt;ke++){const Rt=ne[ke],zt=Rt.object,Mt=Rt.geometry,bt=Be===null?Rt.material:Be,Gt=Rt.group;zt.layers.test(De.layers)&&Ve(zt,Pe,De,Mt,bt,Gt)}}function Ve(ne,Pe,De,Be,ke,gt){ne.onBeforeRender(b,Pe,De,Be,ke,gt),ne.modelViewMatrix.multiplyMatrices(De.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),ke.onBeforeRender(b,Pe,De,Be,ne,gt),ke.transparent===!0&&ke.side===Tl&&ke.forceSinglePass===!1?(ke.side=jo,ke.needsUpdate=!0,b.renderBufferDirect(De,Pe,Be,ke,ne,gt),ke.side=zh,ke.needsUpdate=!0,b.renderBufferDirect(De,Pe,Be,ke,ne,gt),ke.side=Tl):b.renderBufferDirect(De,Pe,Be,ke,ne,gt),ne.onAfterRender(b,Pe,De,Be,ke,gt)}function Qe(ne,Pe,De){Pe.isScene!==!0&&(Pe=Se);const Be=Oe.get(ne),ke=g.state.lights,gt=g.state.shadowsArray,Rt=ke.state.version,zt=Le.getParameters(ne,ke.state,gt,Pe,De),Mt=Le.getProgramCacheKey(zt);let bt=Be.programs;Be.environment=ne.isMeshStandardMaterial?Pe.environment:null,Be.fog=Pe.fog,Be.envMap=(ne.isMeshStandardMaterial?we:J).get(ne.envMap||Be.environment),bt===void 0&&(ne.addEventListener("dispose",Ye),bt=new Map,Be.programs=bt);let Gt=bt.get(Mt);if(Gt!==void 0){if(Be.currentProgram===Gt&&Be.lightsStateVersion===Rt)return $e(ne,zt),Gt}else zt.uniforms=Le.getUniforms(ne),ne.onBuild(De,zt,b),ne.onBeforeCompile(zt,b),Gt=Le.acquireProgram(zt,Mt),bt.set(Mt,Gt),Be.uniforms=zt.uniforms;const yt=Be.uniforms;return(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||ne.clipping===!0)&&(yt.clippingPlanes=ze.uniform),$e(ne,zt),Be.needsLights=hi(ne),Be.lightsStateVersion=Rt,Be.needsLights&&(yt.ambientLightColor.value=ke.state.ambient,yt.lightProbe.value=ke.state.probe,yt.directionalLights.value=ke.state.directional,yt.directionalLightShadows.value=ke.state.directionalShadow,yt.spotLights.value=ke.state.spot,yt.spotLightShadows.value=ke.state.spotShadow,yt.rectAreaLights.value=ke.state.rectArea,yt.ltc_1.value=ke.state.rectAreaLTC1,yt.ltc_2.value=ke.state.rectAreaLTC2,yt.pointLights.value=ke.state.point,yt.pointLightShadows.value=ke.state.pointShadow,yt.hemisphereLights.value=ke.state.hemi,yt.directionalShadowMap.value=ke.state.directionalShadowMap,yt.directionalShadowMatrix.value=ke.state.directionalShadowMatrix,yt.spotShadowMap.value=ke.state.spotShadowMap,yt.spotLightMatrix.value=ke.state.spotLightMatrix,yt.spotLightMap.value=ke.state.spotLightMap,yt.pointShadowMap.value=ke.state.pointShadowMap,yt.pointShadowMatrix.value=ke.state.pointShadowMatrix),Be.currentProgram=Gt,Be.uniformsList=null,Gt}function Ne(ne){if(ne.uniformsList===null){const Pe=ne.currentProgram.getUniforms();ne.uniformsList=oC.seqWithValue(Pe.seq,ne.uniforms)}return ne.uniformsList}function $e(ne,Pe){const De=Oe.get(ne);De.outputColorSpace=Pe.outputColorSpace,De.batching=Pe.batching,De.instancing=Pe.instancing,De.instancingColor=Pe.instancingColor,De.skinning=Pe.skinning,De.morphTargets=Pe.morphTargets,De.morphNormals=Pe.morphNormals,De.morphColors=Pe.morphColors,De.morphTargetsCount=Pe.morphTargetsCount,De.numClippingPlanes=Pe.numClippingPlanes,De.numIntersection=Pe.numClipIntersection,De.vertexAlphas=Pe.vertexAlphas,De.vertexTangents=Pe.vertexTangents,De.toneMapping=Pe.toneMapping}function Lt(ne,Pe,De,Be,ke){Pe.isScene!==!0&&(Pe=Se),$.resetTextureUnits();const gt=Pe.fog,Rt=Be.isMeshStandardMaterial?Pe.environment:null,zt=E===null?b.outputColorSpace:E.isXRRenderTarget===!0?E.texture.colorSpace:Hh,Mt=(Be.isMeshStandardMaterial?we:J).get(Be.envMap||Rt),bt=Be.vertexColors===!0&&!!De.attributes.color&&De.attributes.color.itemSize===4,Gt=!!De.attributes.tangent&&(!!Be.normalMap||Be.anisotropy>0),yt=!!De.morphAttributes.position,Vi=!!De.morphAttributes.normal,Er=!!De.morphAttributes.color;let Ni=Rh;Be.toneMapped&&(E===null||E.isXRRenderTarget===!0)&&(Ni=b.toneMapping);const rr=De.morphAttributes.position||De.morphAttributes.normal||De.morphAttributes.color,W=rr!==void 0?rr.length:0,Q=Oe.get(Be),fe=g.state.lights;if(Z===!0&&(oe===!0||ne!==R)){const dn=ne===R&&Be.id===M;ze.setState(Be,ne,dn)}let re=!1;Be.version===Q.__version?(Q.needsLights&&Q.lightsStateVersion!==fe.state.version||Q.outputColorSpace!==zt||ke.isBatchedMesh&&Q.batching===!1||!ke.isBatchedMesh&&Q.batching===!0||ke.isInstancedMesh&&Q.instancing===!1||!ke.isInstancedMesh&&Q.instancing===!0||ke.isSkinnedMesh&&Q.skinning===!1||!ke.isSkinnedMesh&&Q.skinning===!0||ke.isInstancedMesh&&Q.instancingColor===!0&&ke.instanceColor===null||ke.isInstancedMesh&&Q.instancingColor===!1&&ke.instanceColor!==null||Q.envMap!==Mt||Be.fog===!0&&Q.fog!==gt||Q.numClippingPlanes!==void 0&&(Q.numClippingPlanes!==ze.numPlanes||Q.numIntersection!==ze.numIntersection)||Q.vertexAlphas!==bt||Q.vertexTangents!==Gt||Q.morphTargets!==yt||Q.morphNormals!==Vi||Q.morphColors!==Er||Q.toneMapping!==Ni||Ce.isWebGL2===!0&&Q.morphTargetsCount!==W)&&(re=!0):(re=!0,Q.__version=Be.version);let Ae=Q.currentProgram;re===!0&&(Ae=Qe(Be,Pe,ke));let at=!1,Yr=!1,Kr=!1;const xr=Ae.getUniforms(),$o=Q.uniforms;if(Re.useProgram(Ae.program)&&(at=!0,Yr=!0,Kr=!0),Be.id!==M&&(M=Be.id,Yr=!0),at||R!==ne){xr.setValue(ee,"projectionMatrix",ne.projectionMatrix),xr.setValue(ee,"viewMatrix",ne.matrixWorldInverse);const dn=xr.map.cameraPosition;dn!==void 0&&dn.setValue(ee,pe.setFromMatrixPosition(ne.matrixWorld)),Ce.logarithmicDepthBuffer&&xr.setValue(ee,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),(Be.isMeshPhongMaterial||Be.isMeshToonMaterial||Be.isMeshLambertMaterial||Be.isMeshBasicMaterial||Be.isMeshStandardMaterial||Be.isShaderMaterial)&&xr.setValue(ee,"isOrthographic",ne.isOrthographicCamera===!0),R!==ne&&(R=ne,Yr=!0,Kr=!0)}if(ke.isSkinnedMesh){xr.setOptional(ee,ke,"bindMatrix"),xr.setOptional(ee,ke,"bindMatrixInverse");const dn=ke.skeleton;dn&&(Ce.floatVertexTextures?(dn.boneTexture===null&&dn.computeBoneTexture(),xr.setValue(ee,"boneTexture",dn.boneTexture,$)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}ke.isBatchedMesh&&(xr.setOptional(ee,ke,"batchingTexture"),xr.setValue(ee,"batchingTexture",ke._matricesTexture,$));const jl=De.morphAttributes;if((jl.position!==void 0||jl.normal!==void 0||jl.color!==void 0&&Ce.isWebGL2===!0)&&rt.update(ke,De,Ae),(Yr||Q.receiveShadow!==ke.receiveShadow)&&(Q.receiveShadow=ke.receiveShadow,xr.setValue(ee,"receiveShadow",ke.receiveShadow)),Be.isMeshGouraudMaterial&&Be.envMap!==null&&($o.envMap.value=Mt,$o.flipEnvMap.value=Mt.isCubeTexture&&Mt.isRenderTargetTexture===!1?-1:1),Yr&&(xr.setValue(ee,"toneMappingExposure",b.toneMappingExposure),Q.needsLights&&oi($o,Kr),gt&&Be.fog===!0&&X.refreshFogUniforms($o,gt),X.refreshMaterialUniforms($o,Be,z,H,ae),oC.upload(ee,Ne(Q),$o,$)),Be.isShaderMaterial&&Be.uniformsNeedUpdate===!0&&(oC.upload(ee,Ne(Q),$o,$),Be.uniformsNeedUpdate=!1),Be.isSpriteMaterial&&xr.setValue(ee,"center",ke.center),xr.setValue(ee,"modelViewMatrix",ke.modelViewMatrix),xr.setValue(ee,"normalMatrix",ke.normalMatrix),xr.setValue(ee,"modelMatrix",ke.matrixWorld),Be.isShaderMaterial||Be.isRawShaderMaterial){const dn=Be.uniformsGroups;for(let dg=0,Sa=dn.length;dg<Sa;dg++)if(Ce.isWebGL2){const T_=dn[dg];Nt.update(T_,Ae),Nt.bind(T_,Ae)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ae}function oi(ne,Pe){ne.ambientLightColor.needsUpdate=Pe,ne.lightProbe.needsUpdate=Pe,ne.directionalLights.needsUpdate=Pe,ne.directionalLightShadows.needsUpdate=Pe,ne.pointLights.needsUpdate=Pe,ne.pointLightShadows.needsUpdate=Pe,ne.spotLights.needsUpdate=Pe,ne.spotLightShadows.needsUpdate=Pe,ne.rectAreaLights.needsUpdate=Pe,ne.hemisphereLights.needsUpdate=Pe}function hi(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&ne.lights===!0}this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return E},this.setRenderTargetTextures=function(ne,Pe,De){Oe.get(ne.texture).__webglTexture=Pe,Oe.get(ne.depthTexture).__webglTexture=De;const Be=Oe.get(ne);Be.__hasExternalTextures=!0,Be.__hasExternalTextures&&(Be.__autoAllocateDepthBuffer=De===void 0,Be.__autoAllocateDepthBuffer||Me.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Be.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ne,Pe){const De=Oe.get(ne);De.__webglFramebuffer=Pe,De.__useDefaultFramebuffer=Pe===void 0},this.setRenderTarget=function(ne,Pe=0,De=0){E=ne,A=Pe,S=De;let Be=!0,ke=null,gt=!1,Rt=!1;if(ne){const Mt=Oe.get(ne);Mt.__useDefaultFramebuffer!==void 0?(Re.bindFramebuffer(ee.FRAMEBUFFER,null),Be=!1):Mt.__webglFramebuffer===void 0?$.setupRenderTarget(ne):Mt.__hasExternalTextures&&$.rebindTextures(ne,Oe.get(ne.texture).__webglTexture,Oe.get(ne.depthTexture).__webglTexture);const bt=ne.texture;(bt.isData3DTexture||bt.isDataArrayTexture||bt.isCompressedArrayTexture)&&(Rt=!0);const Gt=Oe.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Array.isArray(Gt[Pe])?ke=Gt[Pe][De]:ke=Gt[Pe],gt=!0):Ce.isWebGL2&&ne.samples>0&&$.useMultisampledRTT(ne)===!1?ke=Oe.get(ne).__webglMultisampledFramebuffer:Array.isArray(Gt)?ke=Gt[De]:ke=Gt,C.copy(ne.viewport),T.copy(ne.scissor),L=ne.scissorTest}else C.copy(V).multiplyScalar(z).floor(),T.copy(q).multiplyScalar(z).floor(),L=K;if(Re.bindFramebuffer(ee.FRAMEBUFFER,ke)&&Ce.drawBuffers&&Be&&Re.drawBuffers(ne,ke),Re.viewport(C),Re.scissor(T),Re.setScissorTest(L),gt){const Mt=Oe.get(ne.texture);ee.framebufferTexture2D(ee.FRAMEBUFFER,ee.COLOR_ATTACHMENT0,ee.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,Mt.__webglTexture,De)}else if(Rt){const Mt=Oe.get(ne.texture),bt=Pe||0;ee.framebufferTextureLayer(ee.FRAMEBUFFER,ee.COLOR_ATTACHMENT0,Mt.__webglTexture,De||0,bt)}M=-1},this.readRenderTargetPixels=function(ne,Pe,De,Be,ke,gt,Rt){if(!(ne&&ne.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let zt=Oe.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&Rt!==void 0&&(zt=zt[Rt]),zt){Re.bindFramebuffer(ee.FRAMEBUFFER,zt);try{const Mt=ne.texture,bt=Mt.format,Gt=Mt.type;if(bt!==Fo&&tt.convert(bt)!==ee.getParameter(ee.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const yt=Gt===y0&&(Me.has("EXT_color_buffer_half_float")||Ce.isWebGL2&&Me.has("EXT_color_buffer_float"));if(Gt!==kh&&tt.convert(Gt)!==ee.getParameter(ee.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Gt===Rl&&(Ce.isWebGL2||Me.has("OES_texture_float")||Me.has("WEBGL_color_buffer_float")))&&!yt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Pe>=0&&Pe<=ne.width-Be&&De>=0&&De<=ne.height-ke&&ee.readPixels(Pe,De,Be,ke,tt.convert(bt),tt.convert(Gt),gt)}finally{const Mt=E!==null?Oe.get(E).__webglFramebuffer:null;Re.bindFramebuffer(ee.FRAMEBUFFER,Mt)}}},this.copyFramebufferToTexture=function(ne,Pe,De=0){const Be=Math.pow(2,-De),ke=Math.floor(Pe.image.width*Be),gt=Math.floor(Pe.image.height*Be);$.setTexture2D(Pe,0),ee.copyTexSubImage2D(ee.TEXTURE_2D,De,0,0,ne.x,ne.y,ke,gt),Re.unbindTexture()},this.copyTextureToTexture=function(ne,Pe,De,Be=0){const ke=Pe.image.width,gt=Pe.image.height,Rt=tt.convert(De.format),zt=tt.convert(De.type);$.setTexture2D(De,0),ee.pixelStorei(ee.UNPACK_FLIP_Y_WEBGL,De.flipY),ee.pixelStorei(ee.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),ee.pixelStorei(ee.UNPACK_ALIGNMENT,De.unpackAlignment),Pe.isDataTexture?ee.texSubImage2D(ee.TEXTURE_2D,Be,ne.x,ne.y,ke,gt,Rt,zt,Pe.image.data):Pe.isCompressedTexture?ee.compressedTexSubImage2D(ee.TEXTURE_2D,Be,ne.x,ne.y,Pe.mipmaps[0].width,Pe.mipmaps[0].height,Rt,Pe.mipmaps[0].data):ee.texSubImage2D(ee.TEXTURE_2D,Be,ne.x,ne.y,Rt,zt,Pe.image),Be===0&&De.generateMipmaps&&ee.generateMipmap(ee.TEXTURE_2D),Re.unbindTexture()},this.copyTextureToTexture3D=function(ne,Pe,De,Be,ke=0){if(b.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const gt=ne.max.x-ne.min.x+1,Rt=ne.max.y-ne.min.y+1,zt=ne.max.z-ne.min.z+1,Mt=tt.convert(Be.format),bt=tt.convert(Be.type);let Gt;if(Be.isData3DTexture)$.setTexture3D(Be,0),Gt=ee.TEXTURE_3D;else if(Be.isDataArrayTexture||Be.isCompressedArrayTexture)$.setTexture2DArray(Be,0),Gt=ee.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ee.pixelStorei(ee.UNPACK_FLIP_Y_WEBGL,Be.flipY),ee.pixelStorei(ee.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Be.premultiplyAlpha),ee.pixelStorei(ee.UNPACK_ALIGNMENT,Be.unpackAlignment);const yt=ee.getParameter(ee.UNPACK_ROW_LENGTH),Vi=ee.getParameter(ee.UNPACK_IMAGE_HEIGHT),Er=ee.getParameter(ee.UNPACK_SKIP_PIXELS),Ni=ee.getParameter(ee.UNPACK_SKIP_ROWS),rr=ee.getParameter(ee.UNPACK_SKIP_IMAGES),W=De.isCompressedTexture?De.mipmaps[ke]:De.image;ee.pixelStorei(ee.UNPACK_ROW_LENGTH,W.width),ee.pixelStorei(ee.UNPACK_IMAGE_HEIGHT,W.height),ee.pixelStorei(ee.UNPACK_SKIP_PIXELS,ne.min.x),ee.pixelStorei(ee.UNPACK_SKIP_ROWS,ne.min.y),ee.pixelStorei(ee.UNPACK_SKIP_IMAGES,ne.min.z),De.isDataTexture||De.isData3DTexture?ee.texSubImage3D(Gt,ke,Pe.x,Pe.y,Pe.z,gt,Rt,zt,Mt,bt,W.data):De.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ee.compressedTexSubImage3D(Gt,ke,Pe.x,Pe.y,Pe.z,gt,Rt,zt,Mt,W.data)):ee.texSubImage3D(Gt,ke,Pe.x,Pe.y,Pe.z,gt,Rt,zt,Mt,bt,W),ee.pixelStorei(ee.UNPACK_ROW_LENGTH,yt),ee.pixelStorei(ee.UNPACK_IMAGE_HEIGHT,Vi),ee.pixelStorei(ee.UNPACK_SKIP_PIXELS,Er),ee.pixelStorei(ee.UNPACK_SKIP_ROWS,Ni),ee.pixelStorei(ee.UNPACK_SKIP_IMAGES,rr),ke===0&&Be.generateMipmaps&&ee.generateMipmap(Gt),Re.unbindTexture()},this.initTexture=function(ne){ne.isCubeTexture?$.setTextureCube(ne,0):ne.isData3DTexture?$.setTexture3D(ne,0):ne.isDataArrayTexture||ne.isCompressedArrayTexture?$.setTexture2DArray(ne,0):$.setTexture2D(ne,0),Re.unbindTexture()},this.resetState=function(){A=0,S=0,E=null,Re.reset(),pt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Sh}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=e===oT?"display-p3":"srgb",i.unpackColorSpace=or.workingColorSpace===c_?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===es?Ip:I4}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Ip?es:Hh}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Kne extends j4{}Kne.prototype.isWebGL1Renderer=!0;class uT{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new St(e),this.density=i}clone(){return new uT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class hT{constructor(e,i=1,r=1e3){this.isFog=!0,this.name="",this.color=new St(e),this.near=i,this.far=r}clone(){return new hT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class iP extends Hi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}}class g_{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=M1,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=qa()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return _m("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,r){e*=this.stride,r*=i.stride;for(let n=0,s=this.stride;n<s;n++)this.array[e+n]=i.array[r+n];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(i,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=qa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const To=new ue;class Gp{constructor(e,i,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,r=this.data.count;i<r;i++)To.fromBufferAttribute(this,i),To.applyMatrix4(e),this.setXYZ(i,To.x,To.y,To.z);return this}applyNormalMatrix(e){for(let i=0,r=this.count;i<r;i++)To.fromBufferAttribute(this,i),To.applyNormalMatrix(e),this.setXYZ(i,To.x,To.y,To.z);return this}transformDirection(e){for(let i=0,r=this.count;i<r;i++)To.fromBufferAttribute(this,i),To.transformDirection(e),this.setXYZ(i,To.x,To.y,To.z);return this}getComponent(e,i){let r=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(r=zo(r,this.array)),r}setComponent(e,i,r){return this.normalized&&(r=wi(r,this.array)),this.data.array[e*this.data.stride+this.offset+i]=r,this}setX(e,i){return this.normalized&&(i=wi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=zo(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=zo(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=zo(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=zo(i,this.array)),i}setXY(e,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this}setXYZ(e,i,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,i,r,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=wi(i,this.array),r=wi(r,this.array),n=wi(n,this.array),s=wi(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let r=0;r<this.count;r++){const n=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[n+s])}return new Gi(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Gp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let r=0;r<this.count;r++){const n=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)i.push(this.data.array[n+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class W4 extends jn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Sy;const wx=new ue,Ay=new ue,Ey=new ue,My=new ot,_x=new ot,Jne=new ii,BE=new ue,Sx=new ue,OE=new ue,tX=new ot,gI=new ot,iX=new ot;class Qne extends Hi{constructor(e=new W4){if(super(),this.isSprite=!0,this.type="Sprite",Sy===void 0){Sy=new bi;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new g_(i,5);Sy.setIndex([0,1,2,0,2,3]),Sy.setAttribute("position",new Gp(r,3,0,!1)),Sy.setAttribute("uv",new Gp(r,2,3,!1))}this.geometry=Sy,this.material=e,this.center=new ot(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ay.setFromMatrixScale(this.matrixWorld),Jne.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ey.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ay.multiplyScalar(-Ey.z);const r=this.material.rotation;let n,s;r!==0&&(s=Math.cos(r),n=Math.sin(r));const o=this.center;UE(BE.set(-.5,-.5,0),Ey,o,Ay,n,s),UE(Sx.set(.5,-.5,0),Ey,o,Ay,n,s),UE(OE.set(.5,.5,0),Ey,o,Ay,n,s),tX.set(0,0),gI.set(1,0),iX.set(1,1);let a=e.ray.intersectTriangle(BE,Sx,OE,!1,wx);if(a===null&&(UE(Sx.set(-.5,.5,0),Ey,o,Ay,n,s),gI.set(0,1),a=e.ray.intersectTriangle(BE,OE,Sx,!1,wx),a===null))return;const l=e.ray.origin.distanceTo(wx);l<e.near||l>e.far||i.push({distance:l,point:wx.clone(),uv:Ua.getInterpolation(wx,BE,Sx,OE,tX,gI,iX,new ot),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function UE(t,e,i,r,n,s){My.subVectors(t,i).addScalar(.5).multiply(r),n!==void 0?(_x.x=s*My.x-n*My.y,_x.y=n*My.x+s*My.y):_x.copy(My),t.copy(e),t.x+=_x.x,t.y+=_x.y,t.applyMatrix4(Jne)}const NE=new ue,rX=new ue;class Zne extends Hi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let r=0,n=i.length;r<n;r++){const s=i[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,r=0){i=Math.abs(i);const n=this.levels;let s;for(s=0;s<n.length&&!(i<n[s].distance);s++);return n.splice(s,0,{distance:i,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let r,n;for(r=1,n=i.length;r<n;r++){let s=i[r].distance;if(i[r].object.visible&&(s-=s*i[r].hysteresis),e<s)break}return i[r-1].object}return null}raycast(e,i){if(this.levels.length>0){NE.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(NE);this.getObjectForDistance(n).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){NE.setFromMatrixPosition(e.matrixWorld),rX.setFromMatrixPosition(this.matrixWorld);const r=NE.distanceTo(rX)/e.zoom;i[0].object.visible=!0;let n,s;for(n=1,s=i.length;n<s;n++){let o=i[n].distance;if(i[n].object.visible&&(o-=o*i[n].hysteresis),r>=o)i[n-1].object.visible=!1,i[n].object.visible=!0;else break}for(this._currentLevel=n-1;n<s;n++)i[n].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const r=this.levels;for(let n=0,s=r.length;n<s;n++){const o=r[n];i.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return i}}const nX=new ue,sX=new lr,oX=new lr,LVe=new ue,aX=new ii,FE=new ue,yI=new qs,lX=new ii,vI=new ib;class q4 extends _n{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=bU,this.bindMatrix=new ii,this.bindMatrixInverse=new ii,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new yo),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let r=0;r<i.count;r++)this.getVertexPosition(r,FE),this.boundingBox.expandByPoint(FE)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new qs),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let r=0;r<i.count;r++)this.getVertexPosition(r,FE),this.boundingSphere.expandByPoint(FE)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const r=this.material,n=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),yI.copy(this.boundingSphere),yI.applyMatrix4(n),e.ray.intersectsSphere(yI)!==!1&&(lX.copy(n).invert(),vI.copy(e.ray).applyMatrix4(lX),!(this.boundingBox!==null&&vI.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,vI)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new lr,i=this.geometry.attributes.skinWeight;for(let r=0,n=i.count;r<n;r++){e.fromBufferAttribute(i,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),i.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===bU?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===une?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const r=this.skeleton,n=this.geometry;sX.fromBufferAttribute(n.attributes.skinIndex,e),oX.fromBufferAttribute(n.attributes.skinWeight,e),nX.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let s=0;s<4;s++){const o=oX.getComponent(s);if(o!==0){const a=sX.getComponent(s);aX.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),i.addScaledVector(LVe.copy(nX).applyMatrix4(aX),o)}}return i.applyMatrix4(this.bindMatrixInverse)}}class cT extends Hi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Am extends Ir{constructor(e=null,i=1,r=1,n,s,o,a,l,u=an,c=an,h,d){super(null,o,a,l,u,c,n,s,h,d),this.isDataTexture=!0,this.image={data:e,width:i,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const uX=new ii,BVe=new ii;class y_{constructor(e=[],i=[]){this.uuid=qa(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new ii)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const r=new ii;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,i=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:BVe;uX.multiplyMatrices(a,i[s]),uX.toArray(r,s*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new y_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const r=new Am(i,e,e,Fo,Rl);return r.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=r,this}getBoneByName(e){for(let i=0,r=this.bones.length;i<r;i++){const n=this.bones[i];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){const s=e.bones[r];let o=i[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new cT),this.bones.push(o),this.boneInverses.push(new ii().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,r=this.boneInverses;for(let n=0,s=i.length;n<s;n++){const o=i[n];e.bones.push(o.uuid);const a=r[n];e.boneInverses.push(a.toArray())}return e}}class w0 extends Gi{constructor(e,i,r,n=1){super(e,i,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Cy=new ii,hX=new ii,zE=[],cX=new yo,OVe=new ii,Ax=new _n,Ex=new qs;class X4 extends _n{constructor(e,i,r){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new w0(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<r;n++)this.setMatrixAt(n,OVe)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new yo),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<i;r++)this.getMatrixAt(r,Cy),cX.copy(e.boundingBox).applyMatrix4(Cy),this.boundingBox.union(cX)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new qs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<i;r++)this.getMatrixAt(r,Cy),Ex.copy(e.boundingSphere).applyMatrix4(Cy),this.boundingSphere.union(Ex)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const r=this.matrixWorld,n=this.count;if(Ax.geometry=this.geometry,Ax.material=this.material,Ax.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ex.copy(this.boundingSphere),Ex.applyMatrix4(r),e.ray.intersectsSphere(Ex)!==!1))for(let s=0;s<n;s++){this.getMatrixAt(s,Cy),hX.multiplyMatrices(r,Cy),Ax.matrixWorld=hX,Ax.raycast(e,zE);for(let o=0,a=zE.length;o<a;o++){const l=zE[o];l.instanceId=s,l.object=this,i.push(l)}zE.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new w0(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function UVe(t,e){return t.z-e.z}function NVe(t,e){return e.z-t.z}class FVe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,i){const r=this.pool,n=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];n.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=i}reset(){this.list.length=0,this.index=0}}const Py="batchId",Gd=new ii,dX=new ii,zVe=new ii,pX=new ii,bI=new m_,HE=new yo,wf=new qs,Mx=new ue,xI=new FVe,so=new _n,GE=[];function HVe(t,e,i=0){const r=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const n=t.count;for(let s=0;s<n;s++)for(let o=0;o<r;o++)e.setComponent(s+i,o,t.getComponent(s,o))}else e.array.set(t.array,i*r);e.needsUpdate=!0}class $ne extends _n{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,i,r=i*2,n){super(new bi,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=i,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const i=new Float32Array(e*e*4),r=new Am(i,e,e,Fo,Rl);this._matricesTexture=r}_initializeGeometry(e){const i=this.geometry,r=this._maxVertexCount,n=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:u,itemSize:c,normalized:h}=l,d=new u.constructor(r*c),p=new l.constructor(d,c,h);p.setUsage(l.usage),i.setAttribute(a,p)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);i.setIndex(new Gi(a,1))}const o=n>65536?new Uint32Array(r):new Uint16Array(r);i.setAttribute(Py,new Gi(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Py))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Py}"`);const i=this.geometry;if(!!e.getIndex()!=!!i.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in i.attributes){if(r===Py)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const n=e.getAttribute(r),s=i.getAttribute(r);if(n.itemSize!==s.itemSize||n.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new yo);const e=this._geometryCount,i=this.boundingBox,r=this._active;i.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,Gd),this.getBoundingBoxAt(n,HE).applyMatrix4(Gd),i.union(HE))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new qs);const e=this._geometryCount,i=this.boundingSphere,r=this._active;i.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,Gd),this.getBoundingSphereAt(n,wf).applyMatrix4(Gd),i.union(wf))}addGeometry(e,i=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),i===-1?n.vertexCount=e.getAttribute("position").count:n.vertexCount=i,s===null?n.vertexStart=0:n.vertexStart=s.vertexStart+s.vertexCount;const u=e.getIndex(),c=u!==null;if(c&&(r===-1?n.indexCount=u.count:n.indexCount=r,s===null?n.indexStart=0:n.indexStart=s.indexStart+s.indexCount),n.indexStart!==-1&&n.indexStart+n.indexCount>this._maxIndexCount||n.vertexStart+n.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const h=this._visibility,d=this._active,p=this._matricesTexture,f=this._matricesTexture.image.data;h.push(!0),d.push(!0);const m=this._geometryCount;this._geometryCount++,zVe.toArray(f,m*16),p.needsUpdate=!0,o.push(n),a.push({start:c?n.indexStart:n.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new yo,sphereInitialized:!1,sphere:new qs});const g=this.geometry.getAttribute(Py);for(let y=0;y<n.vertexCount;y++)g.setX(n.vertexStart+y,m);return g.needsUpdate=!0,this.setGeometryAt(m,e),m}setGeometryAt(e,i){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(i);const r=this.geometry,n=r.getIndex()!==null,s=r.getIndex(),o=i.getIndex(),a=this._reservedRanges[e];if(n&&o.count>a.indexCount||i.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,u=a.vertexCount;for(const p in r.attributes){if(p===Py)continue;const f=i.getAttribute(p),m=r.getAttribute(p);HVe(f,m,l);const g=f.itemSize;for(let y=f.count,v=u;y<v;y++){const b=l+y;for(let _=0;_<g;_++)m.setComponent(b,_,0)}m.needsUpdate=!0}if(n){const p=a.indexStart;for(let f=0;f<o.count;f++)s.setX(p+f,l+o.getX(f));for(let f=o.count,m=a.indexCount;f<m;f++)s.setX(p+f,l);s.needsUpdate=!0}const c=this._bounds[e];i.boundingBox!==null?(c.box.copy(i.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,i.boundingSphere!==null?(c.sphere.copy(i.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const h=this._drawRanges[e],d=i.getAttribute("position");return h.count=n?o.count:d.count,this._visibilityChanged=!0,e}deleteGeometry(e){const i=this._active;return e>=i.length||i[e]===!1?this:(i[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,i){if(this._active[e]===!1)return null;const n=this._bounds[e],s=n.box,o=this.geometry;if(n.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,u=this._drawRanges[e];for(let c=u.start,h=u.start+u.count;c<h;c++){let d=c;a&&(d=a.getX(d)),s.expandByPoint(Mx.fromBufferAttribute(l,d))}n.boxInitialized=!0}return i.copy(s),i}getBoundingSphereAt(e,i){if(this._active[e]===!1)return null;const n=this._bounds[e],s=n.sphere,o=this.geometry;if(n.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,HE),HE.getCenter(s.center);const a=o.index,l=o.attributes.position,u=this._drawRanges[e];let c=0;for(let h=u.start,d=u.start+u.count;h<d;h++){let p=h;a&&(p=a.getX(p)),Mx.fromBufferAttribute(l,p),c=Math.max(c,s.center.distanceToSquared(Mx))}s.radius=Math.sqrt(c),n.sphereInitialized=!0}return i.copy(s),i}setMatrixAt(e,i){const r=this._active,n=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(i.toArray(s,e*16),n.needsUpdate=!0,this)}getMatrixAt(e,i){const r=this._active,n=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:i.fromArray(n,e*16)}setVisibleAt(e,i){const r=this._visibility,n=this._active,s=this._geometryCount;return e>=s||n[e]===!1||r[e]===i?this:(r[e]=i,this._visibilityChanged=!0,this)}getVisibleAt(e){const i=this._visibility,r=this._active,n=this._geometryCount;return e>=n||r[e]===!1?!1:i[e]}raycast(e,i){const r=this._visibility,n=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;so.material=this.material,so.geometry.index=l.index,so.geometry.attributes=l.attributes,so.geometry.boundingBox===null&&(so.geometry.boundingBox=new yo),so.geometry.boundingSphere===null&&(so.geometry.boundingSphere=new qs);for(let u=0;u<o;u++){if(!r[u]||!n[u])continue;const c=s[u];so.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(u,so.matrixWorld).premultiply(a),this.getBoundingBoxAt(u,so.geometry.boundingBox),this.getBoundingSphereAt(u,so.geometry.boundingSphere),so.raycast(e,GE);for(let h=0,d=GE.length;h<d;h++){const p=GE[h];p.object=this,p.batchId=u,i.push(p)}GE.length=0}so.material=null,so.geometry.index=null,so.geometry.attributes={},so.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(i=>({...i})),this._reservedRanges=e._reservedRanges.map(i=>({...i})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(i=>({boxInitialized:i.boxInitialized,box:i.box.clone(),sphereInitialized:i.sphereInitialized,sphere:i.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,i,r,n,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=n.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._active,u=this._visibility,c=this._multiDrawStarts,h=this._multiDrawCounts,d=this._drawRanges,p=this.perObjectFrustumCulled;p&&(pX.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),bI.setFromProjectionMatrix(pX,e.coordinateSystem));let f=0;if(this.sortObjects){dX.copy(this.matrixWorld).invert(),Mx.setFromMatrixPosition(r.matrixWorld).applyMatrix4(dX);for(let y=0,v=u.length;y<v;y++)if(u[y]&&l[y]){this.getMatrixAt(y,Gd),this.getBoundingSphereAt(y,wf).applyMatrix4(Gd);let b=!1;if(p&&(b=!bI.intersectsSphere(wf)),!b){const _=Mx.distanceTo(wf.center);xI.push(d[y],_)}}const m=xI.list,g=this.customSort;g===null?m.sort(s.transparent?NVe:UVe):g.call(this,m,r);for(let y=0,v=m.length;y<v;y++){const b=m[y];c[f]=b.start*a,h[f]=b.count,f++}xI.reset()}else for(let m=0,g=u.length;m<g;m++)if(u[m]&&l[m]){let y=!1;if(p&&(this.getMatrixAt(m,Gd),this.getBoundingSphereAt(m,wf).applyMatrix4(Gd),y=!bI.intersectsSphere(wf)),!y){const v=d[m];c[f]=v.start*a,h[f]=v.count,f++}}this._multiDrawCount=f,this._visibilityChanged=!1}onBeforeShadow(e,i,r,n,s,o){this.onBeforeRender(e,null,n,s,o)}}class wo extends jn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const fX=new ue,mX=new ue,gX=new ii,wI=new ib,VE=new qs;class sd extends Hi{constructor(e=new bi,i=new wo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,r=[0];for(let n=1,s=i.count;n<s;n++)fX.fromBufferAttribute(i,n-1),mX.fromBufferAttribute(i,n),r[n]=r[n-1],r[n]+=fX.distanceTo(mX);e.setAttribute("lineDistance",new Ft(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const r=this.geometry,n=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),VE.copy(r.boundingSphere),VE.applyMatrix4(n),VE.radius+=s,e.ray.intersectsSphere(VE)===!1)return;gX.copy(n).invert(),wI.copy(e.ray).applyMatrix4(gX);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new ue,c=new ue,h=new ue,d=new ue,p=this.isLineSegments?2:1,f=r.index,g=r.attributes.position;if(f!==null){const y=Math.max(0,o.start),v=Math.min(f.count,o.start+o.count);for(let b=y,_=v-1;b<_;b+=p){const A=f.getX(b),S=f.getX(b+1);if(u.fromBufferAttribute(g,A),c.fromBufferAttribute(g,S),wI.distanceSqToSegment(u,c,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||i.push({distance:M,point:h.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,o.start),v=Math.min(g.count,o.start+o.count);for(let b=y,_=v-1;b<_;b+=p){if(u.fromBufferAttribute(g,b),c.fromBufferAttribute(g,b+1),wI.distanceSqToSegment(u,c,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||i.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,r=Object.keys(i);if(r.length>0){const n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=n.length;s<o;s++){const a=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const yX=new ue,vX=new ue;class Bu extends sd{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,r=[];for(let n=0,s=i.count;n<s;n+=2)yX.fromBufferAttribute(i,n),vX.fromBufferAttribute(i,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+yX.distanceTo(vX);e.setAttribute("lineDistance",new Ft(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Y4 extends sd{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class dT extends jn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const bX=new ii,JU=new ib,jE=new qs,WE=new ue;class K4 extends Hi{constructor(e=new bi,i=new dT){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){const r=this.geometry,n=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),jE.copy(r.boundingSphere),jE.applyMatrix4(n),jE.radius+=s,e.ray.intersectsSphere(jE)===!1)return;bX.copy(n).invert(),JU.copy(e.ray).applyMatrix4(bX);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=r.index,h=r.attributes.position;if(u!==null){const d=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);for(let f=d,m=p;f<m;f++){const g=u.getX(f);WE.fromBufferAttribute(h,g),xX(WE,g,l,n,e,i,this)}}else{const d=Math.max(0,o.start),p=Math.min(h.count,o.start+o.count);for(let f=d,m=p;f<m;f++)WE.fromBufferAttribute(h,f),xX(WE,f,l,n,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,r=Object.keys(i);if(r.length>0){const n=i[r[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=n.length;s<o;s++){const a=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function xX(t,e,i,r,n,s,o){const a=JU.distanceSqToPoint(t);if(a<i){const l=new ue;JU.closestPointToPoint(t,l),l.applyMatrix4(r);const u=n.ray.origin.distanceTo(l);if(u<n.near||u>n.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class GVe extends Ir{constructor(e,i,r,n,s,o,a,l,u){super(e,i,r,n,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Rr,this.magFilter=s!==void 0?s:Rr,this.generateMipmaps=!1;const c=this;function h(){c.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class VVe extends Ir{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=an,this.minFilter=an,this.generateMipmaps=!1,this.needsUpdate=!0}}class pT extends Ir{constructor(e,i,r,n,s,o,a,l,u,c,h,d){super(null,o,a,l,u,c,n,s,h,d),this.isCompressedTexture=!0,this.image={width:i,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class jVe extends pT{constructor(e,i,r,n,s,o){super(e,i,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=Hs}}class WVe extends pT{constructor(e,i,r){super(void 0,e[0].width,e[0].height,i,r,nd),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class qVe extends Ir{constructor(e,i,r,n,s,o,a,l,u){super(e,i,r,n,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ou{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const r=this.getUtoTmapping(e);return this.getPoint(r,i)}getPoints(e=5){const i=[];for(let r=0;r<=e;r++)i.push(this.getPoint(r/e));return i}getSpacedPoints(e=5){const i=[];for(let r=0;r<=e;r++)i.push(this.getPointAt(r/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let r,n=this.getPoint(0),s=0;i.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(n),i.push(s),n=r;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const r=this.getLengths();let n=0;const s=r.length;let o;i?o=i:o=e*r[s-1];let a=0,l=s-1,u;for(;a<=l;)if(n=Math.floor(a+(l-a)/2),u=r[n]-o,u<0)a=n+1;else if(u>0)l=n-1;else{l=n;break}if(n=l,r[n]===o)return n/(s-1);const c=r[n],d=r[n+1]-c,p=(o-c)/d;return(n+p)/(s-1)}getTangent(e,i){let n=e-1e-4,s=e+1e-4;n<0&&(n=0),s>1&&(s=1);const o=this.getPoint(n),a=this.getPoint(s),l=i||(o.isVector2?new ot:new ue);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,i){const r=this.getUtoTmapping(e);return this.getTangent(r,i)}computeFrenetFrames(e,i){const r=new ue,n=[],s=[],o=[],a=new ue,l=new ii;for(let p=0;p<=e;p++){const f=p/e;n[p]=this.getTangentAt(f,new ue)}s[0]=new ue,o[0]=new ue;let u=Number.MAX_VALUE;const c=Math.abs(n[0].x),h=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=u&&(u=c,r.set(1,0,0)),h<=u&&(u=h,r.set(0,1,0)),d<=u&&r.set(0,0,1),a.crossVectors(n[0],r).normalize(),s[0].crossVectors(n[0],a),o[0].crossVectors(n[0],s[0]);for(let p=1;p<=e;p++){if(s[p]=s[p-1].clone(),o[p]=o[p-1].clone(),a.crossVectors(n[p-1],n[p]),a.length()>Number.EPSILON){a.normalize();const f=Math.acos(un(n[p-1].dot(n[p]),-1,1));s[p].applyMatrix4(l.makeRotationAxis(a,f))}o[p].crossVectors(n[p],s[p])}if(i===!0){let p=Math.acos(un(s[0].dot(s[e]),-1,1));p/=e,n[0].dot(a.crossVectors(s[0],s[e]))>0&&(p=-p);for(let f=1;f<=e;f++)s[f].applyMatrix4(l.makeRotationAxis(n[f],p*f)),o[f].crossVectors(n[f],s[f])}return{tangents:n,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class fT extends Ou{constructor(e=0,i=0,r=1,n=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=r,this.yRadius=n,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,i){const r=i||new ot,n=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=n;for(;s>n;)s-=n;s<Number.EPSILON&&(o?s=0:s=n),this.aClockwise===!0&&!o&&(s===n?s=-n:s=s-n);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,p=u-this.aY;l=d*c-p*h+this.aX,u=d*h+p*c+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class ese extends fT{constructor(e,i,r,n,s,o){super(e,i,r,r,n,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function J4(){let t=0,e=0,i=0,r=0;function n(s,o,a,l){t=s,e=a,i=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){n(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,c,h){let d=(o-s)/u-(a-s)/(u+c)+(a-o)/c,p=(a-o)/c-(l-o)/(c+h)+(l-a)/h;d*=c,p*=c,n(o,a,d,p)},calc:function(s){const o=s*s,a=o*s;return t+e*s+i*o+r*a}}}const qE=new ue,_I=new J4,SI=new J4,AI=new J4;class tse extends Ou{constructor(e=[],i=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=r,this.tension=n}getPoint(e,i=new ue){const r=i,n=this.points,s=n.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,c;this.closed||a>0?u=n[(a-1)%s]:(qE.subVectors(n[0],n[1]).add(n[0]),u=qE);const h=n[a%s],d=n[(a+1)%s];if(this.closed||a+2<s?c=n[(a+2)%s]:(qE.subVectors(n[s-1],n[s-2]).add(n[s-1]),c=qE),this.curveType==="centripetal"||this.curveType==="chordal"){const p=this.curveType==="chordal"?.5:.25;let f=Math.pow(u.distanceToSquared(h),p),m=Math.pow(h.distanceToSquared(d),p),g=Math.pow(d.distanceToSquared(c),p);m<1e-4&&(m=1),f<1e-4&&(f=m),g<1e-4&&(g=m),_I.initNonuniformCatmullRom(u.x,h.x,d.x,c.x,f,m,g),SI.initNonuniformCatmullRom(u.y,h.y,d.y,c.y,f,m,g),AI.initNonuniformCatmullRom(u.z,h.z,d.z,c.z,f,m,g)}else this.curveType==="catmullrom"&&(_I.initCatmullRom(u.x,h.x,d.x,c.x,this.tension),SI.initCatmullRom(u.y,h.y,d.y,c.y,this.tension),AI.initCatmullRom(u.z,h.z,d.z,c.z,this.tension));return r.set(_I.calc(l),SI.calc(l),AI.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){const n=e.points[i];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,r=this.points.length;i<r;i++){const n=this.points[i];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){const n=e.points[i];this.points.push(new ue().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function wX(t,e,i,r,n){const s=(r-e)*.5,o=(n-i)*.5,a=t*t,l=t*a;return(2*i-2*r+s+o)*l+(-3*i+3*r-2*s-o)*a+s*t+i}function XVe(t,e){const i=1-t;return i*i*e}function YVe(t,e){return 2*(1-t)*t*e}function KVe(t,e){return t*t*e}function xw(t,e,i,r){return XVe(t,e)+YVe(t,i)+KVe(t,r)}function JVe(t,e){const i=1-t;return i*i*i*e}function QVe(t,e){const i=1-t;return 3*i*i*t*e}function ZVe(t,e){return 3*(1-t)*t*t*e}function $Ve(t,e){return t*t*t*e}function ww(t,e,i,r,n){return JVe(t,e)+QVe(t,i)+ZVe(t,r)+$Ve(t,n)}class Q4 extends Ou{constructor(e=new ot,i=new ot,r=new ot,n=new ot){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=r,this.v3=n}getPoint(e,i=new ot){const r=i,n=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(ww(e,n.x,s.x,o.x,a.x),ww(e,n.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ise extends Ou{constructor(e=new ue,i=new ue,r=new ue,n=new ue){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=r,this.v3=n}getPoint(e,i=new ue){const r=i,n=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(ww(e,n.x,s.x,o.x,a.x),ww(e,n.y,s.y,o.y,a.y),ww(e,n.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Z4 extends Ou{constructor(e=new ot,i=new ot){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new ot){const r=i;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new ot){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class rse extends Ou{constructor(e=new ue,i=new ue){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new ue){const r=i;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new ue){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $4 extends Ou{constructor(e=new ot,i=new ot,r=new ot){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=r}getPoint(e,i=new ot){const r=i,n=this.v0,s=this.v1,o=this.v2;return r.set(xw(e,n.x,s.x,o.x),xw(e,n.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class e5 extends Ou{constructor(e=new ue,i=new ue,r=new ue){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=r}getPoint(e,i=new ue){const r=i,n=this.v0,s=this.v1,o=this.v2;return r.set(xw(e,n.x,s.x,o.x),xw(e,n.y,s.y,o.y),xw(e,n.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class t5 extends Ou{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new ot){const r=i,n=this.points,s=(n.length-1)*e,o=Math.floor(s),a=s-o,l=n[o===0?o:o-1],u=n[o],c=n[o>n.length-2?n.length-1:o+1],h=n[o>n.length-3?n.length-1:o+2];return r.set(wX(a,l.x,u.x,c.x,h.x),wX(a,l.y,u.y,c.y,h.y)),r}copy(e){super.copy(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){const n=e.points[i];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,r=this.points.length;i<r;i++){const n=this.points[i];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){const n=e.points[i];this.points.push(new ot().fromArray(n))}return this}}var rP=Object.freeze({__proto__:null,ArcCurve:ese,CatmullRomCurve3:tse,CubicBezierCurve:Q4,CubicBezierCurve3:ise,EllipseCurve:fT,LineCurve:Z4,LineCurve3:rse,QuadraticBezierCurve:$4,QuadraticBezierCurve3:e5,SplineCurve:t5});class nse extends Ou{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(i)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new rP[r](i,e))}return this}getPoint(e,i){const r=e*this.getLength(),n=this.getCurveLengths();let s=0;for(;s<n.length;){if(n[s]>=r){const o=n[s]-r,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,i)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let r=0,n=this.curves.length;r<n;r++)i+=this.curves[r].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let r=0;r<=e;r++)i.push(this.getPoint(r/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let r;for(let n=0,s=this.curves;n<s.length;n++){const o=s[n],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const c=l[u];r&&r.equals(c)||(i.push(c),r=c)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,r=e.curves.length;i<r;i++){const n=e.curves[i];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,r=this.curves.length;i<r;i++){const n=this.curves[i];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,r=e.curves.length;i<r;i++){const n=e.curves[i];this.curves.push(new rP[n.type]().fromJSON(n))}return this}}class T1 extends nse{constructor(e){super(),this.type="Path",this.currentPoint=new ot,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,r=e.length;i<r;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const r=new Z4(this.currentPoint.clone(),new ot(e,i));return this.curves.push(r),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,r,n){const s=new $4(this.currentPoint.clone(),new ot(e,i),new ot(r,n));return this.curves.push(s),this.currentPoint.set(r,n),this}bezierCurveTo(e,i,r,n,s,o){const a=new Q4(this.currentPoint.clone(),new ot(e,i),new ot(r,n),new ot(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),r=new t5(i);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,r,n,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,i+l,r,n,s,o),this}absarc(e,i,r,n,s,o){return this.absellipse(e,i,r,r,n,s,o),this}ellipse(e,i,r,n,s,o,a,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,i+c,r,n,s,o,a,l),this}absellipse(e,i,r,n,s,o,a,l){const u=new fT(e,i,r,n,s,o,a,l);if(this.curves.length>0){const h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class v_ extends bi{constructor(e=[new ot(0,-.5),new ot(.5,0),new ot(0,.5)],i=12,r=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:r,phiLength:n},i=Math.floor(i),n=un(n,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],c=1/i,h=new ue,d=new ot,p=new ue,f=new ue,m=new ue;let g=0,y=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,p.x=y*1,p.y=-g,p.z=y*0,m.copy(p),p.normalize(),l.push(p.x,p.y,p.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,p.x=y*1,p.y=-g,p.z=y*0,f.copy(p),p.x+=m.x,p.y+=m.y,p.z+=m.z,p.normalize(),l.push(p.x,p.y,p.z),m.copy(f)}for(let v=0;v<=i;v++){const b=r+v*c*n,_=Math.sin(b),A=Math.cos(b);for(let S=0;S<=e.length-1;S++){h.x=e[S].x*_,h.y=e[S].y,h.z=e[S].x*A,o.push(h.x,h.y,h.z),d.x=v/i,d.y=S/(e.length-1),a.push(d.x,d.y);const E=l[3*S+0]*_,M=l[3*S+1],R=l[3*S+0]*A;u.push(E,M,R)}}for(let v=0;v<i;v++)for(let b=0;b<e.length-1;b++){const _=b+v*e.length,A=_,S=_+e.length,E=_+e.length+1,M=_+1;s.push(A,S,M),s.push(E,M,S)}this.setIndex(s),this.setAttribute("position",new Ft(o,3)),this.setAttribute("uv",new Ft(a,2)),this.setAttribute("normal",new Ft(u,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new v_(e.points,e.segments,e.phiStart,e.phiLength)}}class mT extends v_{constructor(e=1,i=1,r=4,n=8){const s=new T1;s.absarc(0,-i/2,e,Math.PI*1.5,0),s.absarc(0,i/2,e,0,Math.PI*.5),super(s.getPoints(r),n),this.type="CapsuleGeometry",this.parameters={radius:e,length:i,capSegments:r,radialSegments:n}}static fromJSON(e){return new mT(e.radius,e.length,e.capSegments,e.radialSegments)}}class gT extends bi{constructor(e=1,i=32,r=0,n=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:r,thetaLength:n},i=Math.max(3,i);const s=[],o=[],a=[],l=[],u=new ue,c=new ot;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=i;h++,d+=3){const p=r+h/i*n;u.x=e*Math.cos(p),u.y=e*Math.sin(p),o.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(o[d]/e+1)/2,c.y=(o[d+1]/e+1)/2,l.push(c.x,c.y)}for(let h=1;h<=i;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Ft(o,3)),this.setAttribute("normal",new Ft(a,3)),this.setAttribute("uv",new Ft(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class sb extends bi{constructor(e=1,i=1,r=1,n=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:r,radialSegments:n,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;n=Math.floor(n),s=Math.floor(s);const c=[],h=[],d=[],p=[];let f=0;const m=[],g=r/2;let y=0;v(),o===!1&&(e>0&&b(!0),i>0&&b(!1)),this.setIndex(c),this.setAttribute("position",new Ft(h,3)),this.setAttribute("normal",new Ft(d,3)),this.setAttribute("uv",new Ft(p,2));function v(){const _=new ue,A=new ue;let S=0;const E=(i-e)/r;for(let M=0;M<=s;M++){const R=[],C=M/s,T=C*(i-e)+e;for(let L=0;L<=n;L++){const I=L/n,D=I*l+a,F=Math.sin(D),H=Math.cos(D);A.x=T*F,A.y=-C*r+g,A.z=T*H,h.push(A.x,A.y,A.z),_.set(F,E,H).normalize(),d.push(_.x,_.y,_.z),p.push(I,1-C),R.push(f++)}m.push(R)}for(let M=0;M<n;M++)for(let R=0;R<s;R++){const C=m[R][M],T=m[R+1][M],L=m[R+1][M+1],I=m[R][M+1];c.push(C,T,I),c.push(T,L,I),S+=6}u.addGroup(y,S,0),y+=S}function b(_){const A=f,S=new ot,E=new ue;let M=0;const R=_===!0?e:i,C=_===!0?1:-1;for(let L=1;L<=n;L++)h.push(0,g*C,0),d.push(0,C,0),p.push(.5,.5),f++;const T=f;for(let L=0;L<=n;L++){const D=L/n*l+a,F=Math.cos(D),H=Math.sin(D);E.x=R*H,E.y=g*C,E.z=R*F,h.push(E.x,E.y,E.z),d.push(0,C,0),S.x=F*.5+.5,S.y=H*.5*C+.5,p.push(S.x,S.y),f++}for(let L=0;L<n;L++){const I=A+L,D=T+L;_===!0?c.push(D,D+1,I):c.push(D+1,D,I),M+=3}u.addGroup(y,M,_===!0?1:2),y+=M}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sb(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class yT extends sb{constructor(e=1,i=1,r=32,n=1,s=!1,o=0,a=Math.PI*2){super(0,e,i,r,n,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:r,heightSegments:n,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new yT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zp extends bi{constructor(e=[],i=[],r=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:r,detail:n};const s=[],o=[];a(n),u(r),c(),this.setAttribute("position",new Ft(s,3)),this.setAttribute("normal",new Ft(s.slice(),3)),this.setAttribute("uv",new Ft(o,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function a(v){const b=new ue,_=new ue,A=new ue;for(let S=0;S<i.length;S+=3)p(i[S+0],b),p(i[S+1],_),p(i[S+2],A),l(b,_,A,v)}function l(v,b,_,A){const S=A+1,E=[];for(let M=0;M<=S;M++){E[M]=[];const R=v.clone().lerp(_,M/S),C=b.clone().lerp(_,M/S),T=S-M;for(let L=0;L<=T;L++)L===0&&M===S?E[M][L]=R:E[M][L]=R.clone().lerp(C,L/T)}for(let M=0;M<S;M++)for(let R=0;R<2*(S-M)-1;R++){const C=Math.floor(R/2);R%2===0?(d(E[M][C+1]),d(E[M+1][C]),d(E[M][C])):(d(E[M][C+1]),d(E[M+1][C+1]),d(E[M+1][C]))}}function u(v){const b=new ue;for(let _=0;_<s.length;_+=3)b.x=s[_+0],b.y=s[_+1],b.z=s[_+2],b.normalize().multiplyScalar(v),s[_+0]=b.x,s[_+1]=b.y,s[_+2]=b.z}function c(){const v=new ue;for(let b=0;b<s.length;b+=3){v.x=s[b+0],v.y=s[b+1],v.z=s[b+2];const _=g(v)/2/Math.PI+.5,A=y(v)/Math.PI+.5;o.push(_,1-A)}f(),h()}function h(){for(let v=0;v<o.length;v+=6){const b=o[v+0],_=o[v+2],A=o[v+4],S=Math.max(b,_,A),E=Math.min(b,_,A);S>.9&&E<.1&&(b<.2&&(o[v+0]+=1),_<.2&&(o[v+2]+=1),A<.2&&(o[v+4]+=1))}}function d(v){s.push(v.x,v.y,v.z)}function p(v,b){const _=v*3;b.x=e[_+0],b.y=e[_+1],b.z=e[_+2]}function f(){const v=new ue,b=new ue,_=new ue,A=new ue,S=new ot,E=new ot,M=new ot;for(let R=0,C=0;R<s.length;R+=9,C+=6){v.set(s[R+0],s[R+1],s[R+2]),b.set(s[R+3],s[R+4],s[R+5]),_.set(s[R+6],s[R+7],s[R+8]),S.set(o[C+0],o[C+1]),E.set(o[C+2],o[C+3]),M.set(o[C+4],o[C+5]),A.copy(v).add(b).add(_).divideScalar(3);const T=g(A);m(S,C+0,v,T),m(E,C+2,b,T),m(M,C+4,_,T)}}function m(v,b,_,A){A<0&&v.x===1&&(o[b]=v.x-1),_.x===0&&_.z===0&&(o[b]=A/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function y(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zp(e.vertices,e.indices,e.radius,e.details)}}class vT extends Zp{constructor(e=1,i=0){const r=(1+Math.sqrt(5))/2,n=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new vT(e.radius,e.detail)}}const XE=new ue,YE=new ue,EI=new ue,KE=new Ua;class sse extends bi{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const n=Math.pow(10,4),s=Math.cos(wm*i),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},p=[];for(let f=0;f<l;f+=3){o?(u[0]=o.getX(f),u[1]=o.getX(f+1),u[2]=o.getX(f+2)):(u[0]=f,u[1]=f+1,u[2]=f+2);const{a:m,b:g,c:y}=KE;if(m.fromBufferAttribute(a,u[0]),g.fromBufferAttribute(a,u[1]),y.fromBufferAttribute(a,u[2]),KE.getNormal(EI),h[0]=`${Math.round(m.x*n)},${Math.round(m.y*n)},${Math.round(m.z*n)}`,h[1]=`${Math.round(g.x*n)},${Math.round(g.y*n)},${Math.round(g.z*n)}`,h[2]=`${Math.round(y.x*n)},${Math.round(y.y*n)},${Math.round(y.z*n)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let v=0;v<3;v++){const b=(v+1)%3,_=h[v],A=h[b],S=KE[c[v]],E=KE[c[b]],M=`${_}_${A}`,R=`${A}_${_}`;R in d&&d[R]?(EI.dot(d[R].normal)<=s&&(p.push(S.x,S.y,S.z),p.push(E.x,E.y,E.z)),d[R]=null):M in d||(d[M]={index0:u[v],index1:u[b],normal:EI.clone()})}}for(const f in d)if(d[f]){const{index0:m,index1:g}=d[f];XE.fromBufferAttribute(a,m),YE.fromBufferAttribute(a,g),p.push(XE.x,XE.y,XE.z),p.push(YE.x,YE.y,YE.z)}this.setAttribute("position",new Ft(p,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Em extends T1{constructor(e){super(e),this.uuid=qa(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let r=0,n=this.holes.length;r<n;r++)i[r]=this.holes[r].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,r=e.holes.length;i<r;i++){const n=e.holes[i];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,r=this.holes.length;i<r;i++){const n=this.holes[i];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,r=e.holes.length;i<r;i++){const n=e.holes[i];this.holes.push(new T1().fromJSON(n))}return this}}const eje={triangulate:function(t,e,i=2){const r=e&&e.length,n=r?e[0]*i:t.length;let s=ose(t,0,n,i,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,c,h,d,p;if(r&&(s=sje(t,e,s,i)),t.length>80*i){a=u=t[0],l=c=t[1];for(let f=i;f<n;f+=i)h=t[f],d=t[f+1],h<a&&(a=h),d<l&&(l=d),h>u&&(u=h),d>c&&(c=d);p=Math.max(u-a,c-l),p=p!==0?32767/p:0}return R1(s,o,i,a,l,p,0),o}};function ose(t,e,i,r,n){let s,o;if(n===gje(t,e,i,r)>0)for(s=e;s<i;s+=r)o=_X(s,t[s],t[s+1],o);else for(s=i-r;s>=e;s-=r)o=_X(s,t[s],t[s+1],o);return o&&bT(o,o.next)&&(D1(o),o=o.next),o}function Vm(t,e){if(!t)return t;e||(e=t);let i=t,r;do if(r=!1,!i.steiner&&(bT(i,i.next)||Vr(i.prev,i,i.next)===0)){if(D1(i),i=e=i.prev,i===i.next)break;r=!0}else i=i.next;while(r||i!==e);return e}function R1(t,e,i,r,n,s,o){if(!t)return;!o&&s&&hje(t,r,n,s);let a=t,l,u;for(;t.prev!==t.next;){if(l=t.prev,u=t.next,s?ije(t,r,n,s):tje(t)){e.push(l.i/i|0),e.push(t.i/i|0),e.push(u.i/i|0),D1(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=rje(Vm(t),e,i),R1(t,e,i,r,n,s,2)):o===2&&nje(t,e,i,r,n,s):R1(Vm(t),e,i,r,n,s,1);break}}}function tje(t){const e=t.prev,i=t,r=t.next;if(Vr(e,i,r)>=0)return!1;const n=e.x,s=i.x,o=r.x,a=e.y,l=i.y,u=r.y,c=n<s?n<o?n:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,d=n>s?n>o?n:o:s>o?s:o,p=a>l?a>u?a:u:l>u?l:u;let f=r.next;for(;f!==e;){if(f.x>=c&&f.x<=d&&f.y>=h&&f.y<=p&&mv(n,a,s,l,o,u,f.x,f.y)&&Vr(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function ije(t,e,i,r){const n=t.prev,s=t,o=t.next;if(Vr(n,s,o)>=0)return!1;const a=n.x,l=s.x,u=o.x,c=n.y,h=s.y,d=o.y,p=a<l?a<u?a:u:l<u?l:u,f=c<h?c<d?c:d:h<d?h:d,m=a>l?a>u?a:u:l>u?l:u,g=c>h?c>d?c:d:h>d?h:d,y=QU(p,f,e,i,r),v=QU(m,g,e,i,r);let b=t.prevZ,_=t.nextZ;for(;b&&b.z>=y&&_&&_.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==o&&mv(a,c,l,h,u,d,b.x,b.y)&&Vr(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==o&&mv(a,c,l,h,u,d,_.x,_.y)&&Vr(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==o&&mv(a,c,l,h,u,d,b.x,b.y)&&Vr(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==o&&mv(a,c,l,h,u,d,_.x,_.y)&&Vr(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function rje(t,e,i){let r=t;do{const n=r.prev,s=r.next.next;!bT(n,s)&&ase(n,r,r.next,s)&&k1(n,s)&&k1(s,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(s.i/i|0),D1(r),D1(r.next),r=t=s),r=r.next}while(r!==t);return Vm(r)}function nje(t,e,i,r,n,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&pje(o,a)){let l=lse(o,a);o=Vm(o,o.next),l=Vm(l,l.next),R1(o,e,i,r,n,s,0),R1(l,e,i,r,n,s,0);return}a=a.next}o=o.next}while(o!==t)}function sje(t,e,i,r){const n=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,u=ose(t,a,l,r,!1),u===u.next&&(u.steiner=!0),n.push(dje(u));for(n.sort(oje),s=0;s<n.length;s++)i=aje(n[s],i);return i}function oje(t,e){return t.x-e.x}function aje(t,e){const i=lje(t,e);if(!i)return e;const r=lse(i,t);return Vm(r,r.next),Vm(i,i.next)}function lje(t,e){let i=e,r=-1/0,n;const s=t.x,o=t.y;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){const d=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>r&&(r=d,n=i.x<i.next.x?i:i.next,d===s))return n}i=i.next}while(i!==e);if(!n)return null;const a=n,l=n.x,u=n.y;let c=1/0,h;i=n;do s>=i.x&&i.x>=l&&s!==i.x&&mv(o<u?s:r,o,l,u,o<u?r:s,o,i.x,i.y)&&(h=Math.abs(o-i.y)/(s-i.x),k1(i,t)&&(h<c||h===c&&(i.x>n.x||i.x===n.x&&uje(n,i)))&&(n=i,c=h)),i=i.next;while(i!==a);return n}function uje(t,e){return Vr(t.prev,t,e.prev)<0&&Vr(e.next,t,t.next)<0}function hje(t,e,i,r){let n=t;do n.z===0&&(n.z=QU(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,cje(n)}function cje(t){let e,i,r,n,s,o,a,l,u=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,r=i,a=0,e=0;e<u&&(a++,r=r.nextZ,!!r);e++);for(l=u;a>0||l>0&&r;)a!==0&&(l===0||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,l--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,u*=2}while(o>1);return t}function QU(t,e,i,r,n){return t=(t-i)*n|0,e=(e-r)*n|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function dje(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function mv(t,e,i,r,n,s,o,a){return(n-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(i-o)*(e-a)&&(i-o)*(s-a)>=(n-o)*(r-a)}function pje(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!fje(t,e)&&(k1(t,e)&&k1(e,t)&&mje(t,e)&&(Vr(t.prev,t,e.prev)||Vr(t,e.prev,e))||bT(t,e)&&Vr(t.prev,t,t.next)>0&&Vr(e.prev,e,e.next)>0)}function Vr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function bT(t,e){return t.x===e.x&&t.y===e.y}function ase(t,e,i,r){const n=QE(Vr(t,e,i)),s=QE(Vr(t,e,r)),o=QE(Vr(i,r,t)),a=QE(Vr(i,r,e));return!!(n!==s&&o!==a||n===0&&JE(t,i,e)||s===0&&JE(t,r,e)||o===0&&JE(i,t,r)||a===0&&JE(i,e,r))}function JE(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function QE(t){return t>0?1:t<0?-1:0}function fje(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&ase(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function k1(t,e){return Vr(t.prev,t,t.next)<0?Vr(t,e,t.next)>=0&&Vr(t,t.prev,e)>=0:Vr(t,e,t.prev)<0||Vr(t,t.next,e)<0}function mje(t,e){let i=t,r=!1;const n=(t.x+e.x)/2,s=(t.y+e.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==t);return r}function lse(t,e){const i=new ZU(t.i,t.x,t.y),r=new ZU(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function _X(t,e,i,r){const n=new ZU(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function D1(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ZU(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function gje(t,e,i,r){let n=0;for(let s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}class Dh{static area(e){const i=e.length;let r=0;for(let n=i-1,s=0;s<i;n=s++)r+=e[n].x*e[s].y-e[s].x*e[n].y;return r*.5}static isClockWise(e){return Dh.area(e)<0}static triangulateShape(e,i){const r=[],n=[],s=[];SX(e),AX(r,e);let o=e.length;i.forEach(SX);for(let l=0;l<i.length;l++)n.push(o),o+=i[l].length,AX(r,i[l]);const a=eje.triangulate(r,n);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function SX(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function AX(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class xT extends bi{constructor(e=new Em([new ot(.5,.5),new ot(-.5,.5),new ot(-.5,-.5),new ot(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const r=this,n=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new Ft(n,3)),this.setAttribute("uv",new Ft(s,2)),this.computeVertexNormals();function o(a){const l=[],u=i.curveSegments!==void 0?i.curveSegments:12,c=i.steps!==void 0?i.steps:1,h=i.depth!==void 0?i.depth:1;let d=i.bevelEnabled!==void 0?i.bevelEnabled:!0,p=i.bevelThickness!==void 0?i.bevelThickness:.2,f=i.bevelSize!==void 0?i.bevelSize:p-.1,m=i.bevelOffset!==void 0?i.bevelOffset:0,g=i.bevelSegments!==void 0?i.bevelSegments:3;const y=i.extrudePath,v=i.UVGenerator!==void 0?i.UVGenerator:yje;let b,_=!1,A,S,E,M;y&&(b=y.getSpacedPoints(c),_=!0,d=!1,A=y.computeFrenetFrames(c,!1),S=new ue,E=new ue,M=new ue),d||(g=0,p=0,f=0,m=0);const R=a.extractPoints(u);let C=R.shape;const T=R.holes;if(!Dh.isClockWise(C)){C=C.reverse();for(let ee=0,_e=T.length;ee<_e;ee++){const Me=T[ee];Dh.isClockWise(Me)&&(T[ee]=Me.reverse())}}const I=Dh.triangulateShape(C,T),D=C;for(let ee=0,_e=T.length;ee<_e;ee++){const Me=T[ee];C=C.concat(Me)}function F(ee,_e,Me){return _e||console.error("THREE.ExtrudeGeometry: vec does not exist"),ee.clone().addScaledVector(_e,Me)}const H=C.length,z=I.length;function B(ee,_e,Me){let Ce,Re,Xe;const Oe=ee.x-_e.x,$=ee.y-_e.y,J=Me.x-ee.x,we=Me.y-ee.y,te=Oe*Oe+$*$,Y=Oe*we-$*J;if(Math.abs(Y)>Number.EPSILON){const ce=Math.sqrt(te),Le=Math.sqrt(J*J+we*we),X=_e.x-$/ce,Ue=_e.y+Oe/ce,et=Me.x-we/Le,ze=Me.y+J/Le,ge=((et-X)*we-(ze-Ue)*J)/(Oe*we-$*J);Ce=X+Oe*ge-ee.x,Re=Ue+$*ge-ee.y;const ct=Ce*Ce+Re*Re;if(ct<=2)return new ot(Ce,Re);Xe=Math.sqrt(ct/2)}else{let ce=!1;Oe>Number.EPSILON?J>Number.EPSILON&&(ce=!0):Oe<-Number.EPSILON?J<-Number.EPSILON&&(ce=!0):Math.sign($)===Math.sign(we)&&(ce=!0),ce?(Ce=-$,Re=Oe,Xe=Math.sqrt(te)):(Ce=Oe,Re=$,Xe=Math.sqrt(te/2))}return new ot(Ce/Xe,Re/Xe)}const j=[];for(let ee=0,_e=D.length,Me=_e-1,Ce=ee+1;ee<_e;ee++,Me++,Ce++)Me===_e&&(Me=0),Ce===_e&&(Ce=0),j[ee]=B(D[ee],D[Me],D[Ce]);const V=[];let q,K=j.concat();for(let ee=0,_e=T.length;ee<_e;ee++){const Me=T[ee];q=[];for(let Ce=0,Re=Me.length,Xe=Re-1,Oe=Ce+1;Ce<Re;Ce++,Xe++,Oe++)Xe===Re&&(Xe=0),Oe===Re&&(Oe=0),q[Ce]=B(Me[Ce],Me[Xe],Me[Oe]);V.push(q),K=K.concat(q)}for(let ee=0;ee<g;ee++){const _e=ee/g,Me=p*Math.cos(_e*Math.PI/2),Ce=f*Math.sin(_e*Math.PI/2)+m;for(let Re=0,Xe=D.length;Re<Xe;Re++){const Oe=F(D[Re],j[Re],Ce);ve(Oe.x,Oe.y,-Me)}for(let Re=0,Xe=T.length;Re<Xe;Re++){const Oe=T[Re];q=V[Re];for(let $=0,J=Oe.length;$<J;$++){const we=F(Oe[$],q[$],Ce);ve(we.x,we.y,-Me)}}}const le=f+m;for(let ee=0;ee<H;ee++){const _e=d?F(C[ee],K[ee],le):C[ee];_?(E.copy(A.normals[0]).multiplyScalar(_e.x),S.copy(A.binormals[0]).multiplyScalar(_e.y),M.copy(b[0]).add(E).add(S),ve(M.x,M.y,M.z)):ve(_e.x,_e.y,0)}for(let ee=1;ee<=c;ee++)for(let _e=0;_e<H;_e++){const Me=d?F(C[_e],K[_e],le):C[_e];_?(E.copy(A.normals[ee]).multiplyScalar(Me.x),S.copy(A.binormals[ee]).multiplyScalar(Me.y),M.copy(b[ee]).add(E).add(S),ve(M.x,M.y,M.z)):ve(Me.x,Me.y,h/c*ee)}for(let ee=g-1;ee>=0;ee--){const _e=ee/g,Me=p*Math.cos(_e*Math.PI/2),Ce=f*Math.sin(_e*Math.PI/2)+m;for(let Re=0,Xe=D.length;Re<Xe;Re++){const Oe=F(D[Re],j[Re],Ce);ve(Oe.x,Oe.y,h+Me)}for(let Re=0,Xe=T.length;Re<Xe;Re++){const Oe=T[Re];q=V[Re];for(let $=0,J=Oe.length;$<J;$++){const we=F(Oe[$],q[$],Ce);_?ve(we.x,we.y+b[c-1].y,b[c-1].x+Me):ve(we.x,we.y,h+Me)}}}Z(),oe();function Z(){const ee=n.length/3;if(d){let _e=0,Me=H*_e;for(let Ce=0;Ce<z;Ce++){const Re=I[Ce];ye(Re[2]+Me,Re[1]+Me,Re[0]+Me)}_e=c+g*2,Me=H*_e;for(let Ce=0;Ce<z;Ce++){const Re=I[Ce];ye(Re[0]+Me,Re[1]+Me,Re[2]+Me)}}else{for(let _e=0;_e<z;_e++){const Me=I[_e];ye(Me[2],Me[1],Me[0])}for(let _e=0;_e<z;_e++){const Me=I[_e];ye(Me[0]+H*c,Me[1]+H*c,Me[2]+H*c)}}r.addGroup(ee,n.length/3-ee,0)}function oe(){const ee=n.length/3;let _e=0;ae(D,_e),_e+=D.length;for(let Me=0,Ce=T.length;Me<Ce;Me++){const Re=T[Me];ae(Re,_e),_e+=Re.length}r.addGroup(ee,n.length/3-ee,1)}function ae(ee,_e){let Me=ee.length;for(;--Me>=0;){const Ce=Me;let Re=Me-1;Re<0&&(Re=ee.length-1);for(let Xe=0,Oe=c+g*2;Xe<Oe;Xe++){const $=H*Xe,J=H*(Xe+1),we=_e+Ce+$,te=_e+Re+$,Y=_e+Re+J,ce=_e+Ce+J;pe(we,te,Y,ce)}}}function ve(ee,_e,Me){l.push(ee),l.push(_e),l.push(Me)}function ye(ee,_e,Me){Se(ee),Se(_e),Se(Me);const Ce=n.length/3,Re=v.generateTopUV(r,n,Ce-3,Ce-2,Ce-1);be(Re[0]),be(Re[1]),be(Re[2])}function pe(ee,_e,Me,Ce){Se(ee),Se(_e),Se(Ce),Se(_e),Se(Me),Se(Ce);const Re=n.length/3,Xe=v.generateSideWallUV(r,n,Re-6,Re-3,Re-2,Re-1);be(Xe[0]),be(Xe[1]),be(Xe[3]),be(Xe[1]),be(Xe[2]),be(Xe[3])}function Se(ee){n.push(l[ee*3+0]),n.push(l[ee*3+1]),n.push(l[ee*3+2])}function be(ee){s.push(ee.x),s.push(ee.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,r=this.parameters.options;return vje(i,r,e)}static fromJSON(e,i){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=i[e.shapes[s]];r.push(a)}const n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new rP[n.type]().fromJSON(n)),new xT(r,e.options)}}const yje={generateTopUV:function(t,e,i,r,n){const s=e[i*3],o=e[i*3+1],a=e[r*3],l=e[r*3+1],u=e[n*3],c=e[n*3+1];return[new ot(s,o),new ot(a,l),new ot(u,c)]},generateSideWallUV:function(t,e,i,r,n,s){const o=e[i*3],a=e[i*3+1],l=e[i*3+2],u=e[r*3],c=e[r*3+1],h=e[r*3+2],d=e[n*3],p=e[n*3+1],f=e[n*3+2],m=e[s*3],g=e[s*3+1],y=e[s*3+2];return Math.abs(a-c)<Math.abs(o-u)?[new ot(o,1-l),new ot(u,1-h),new ot(d,1-f),new ot(m,1-y)]:[new ot(a,1-l),new ot(c,1-h),new ot(p,1-f),new ot(g,1-y)]}};function vje(t,e,i){if(i.shapes=[],Array.isArray(t))for(let r=0,n=t.length;r<n;r++){const s=t[r];i.shapes.push(s.uuid)}else i.shapes.push(t.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class wT extends Zp{constructor(e=1,i=0){const r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,s,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new wT(e.radius,e.detail)}}class b_ extends Zp{constructor(e=1,i=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,n,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new b_(e.radius,e.detail)}}class _T extends bi{constructor(e=.5,i=1,r=32,n=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:r,phiSegments:n,thetaStart:s,thetaLength:o},r=Math.max(3,r),n=Math.max(1,n);const a=[],l=[],u=[],c=[];let h=e;const d=(i-e)/n,p=new ue,f=new ot;for(let m=0;m<=n;m++){for(let g=0;g<=r;g++){const y=s+g/r*o;p.x=h*Math.cos(y),p.y=h*Math.sin(y),l.push(p.x,p.y,p.z),u.push(0,0,1),f.x=(p.x/i+1)/2,f.y=(p.y/i+1)/2,c.push(f.x,f.y)}h+=d}for(let m=0;m<n;m++){const g=m*(r+1);for(let y=0;y<r;y++){const v=y+g,b=v,_=v+r+1,A=v+r+2,S=v+1;a.push(b,_,S),a.push(_,A,S)}}this.setIndex(a),this.setAttribute("position",new Ft(l,3)),this.setAttribute("normal",new Ft(u,3)),this.setAttribute("uv",new Ft(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _T(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ST extends bi{constructor(e=new Em([new ot(0,.5),new ot(-.5,-.5),new ot(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const r=[],n=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let c=0;c<e.length;c++)u(e[c]),this.addGroup(a,l,c),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Ft(n,3)),this.setAttribute("normal",new Ft(s,3)),this.setAttribute("uv",new Ft(o,2));function u(c){const h=n.length/3,d=c.extractPoints(i);let p=d.shape;const f=d.holes;Dh.isClockWise(p)===!1&&(p=p.reverse());for(let g=0,y=f.length;g<y;g++){const v=f[g];Dh.isClockWise(v)===!0&&(f[g]=v.reverse())}const m=Dh.triangulateShape(p,f);for(let g=0,y=f.length;g<y;g++){const v=f[g];p=p.concat(v)}for(let g=0,y=p.length;g<y;g++){const v=p[g];n.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,y=m.length;g<y;g++){const v=m[g],b=v[0]+h,_=v[1]+h,A=v[2]+h;r.push(b,_,A),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return bje(i,e)}static fromJSON(e,i){const r=[];for(let n=0,s=e.shapes.length;n<s;n++){const o=i[e.shapes[n]];r.push(o)}return new ST(r,e.curveSegments)}}function bje(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const n=t[i];e.shapes.push(n.uuid)}else e.shapes.push(t.uuid);return e}class x_ extends bi{constructor(e=1,i=32,r=16,n=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:r,phiStart:n,phiLength:s,thetaStart:o,thetaLength:a},i=Math.max(3,Math.floor(i)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let u=0;const c=[],h=new ue,d=new ue,p=[],f=[],m=[],g=[];for(let y=0;y<=r;y++){const v=[],b=y/r;let _=0;y===0&&o===0?_=.5/i:y===r&&l===Math.PI&&(_=-.5/i);for(let A=0;A<=i;A++){const S=A/i;h.x=-e*Math.cos(n+S*s)*Math.sin(o+b*a),h.y=e*Math.cos(o+b*a),h.z=e*Math.sin(n+S*s)*Math.sin(o+b*a),f.push(h.x,h.y,h.z),d.copy(h).normalize(),m.push(d.x,d.y,d.z),g.push(S+_,1-b),v.push(u++)}c.push(v)}for(let y=0;y<r;y++)for(let v=0;v<i;v++){const b=c[y][v+1],_=c[y][v],A=c[y+1][v],S=c[y+1][v+1];(y!==0||o>0)&&p.push(b,_,S),(y!==r-1||l<Math.PI)&&p.push(_,A,S)}this.setIndex(p),this.setAttribute("position",new Ft(f,3)),this.setAttribute("normal",new Ft(m,3)),this.setAttribute("uv",new Ft(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new x_(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class AT extends Zp{constructor(e=1,i=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,n,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new AT(e.radius,e.detail)}}class ET extends bi{constructor(e=1,i=.4,r=12,n=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:r,tubularSegments:n,arc:s},r=Math.floor(r),n=Math.floor(n);const o=[],a=[],l=[],u=[],c=new ue,h=new ue,d=new ue;for(let p=0;p<=r;p++)for(let f=0;f<=n;f++){const m=f/n*s,g=p/r*Math.PI*2;h.x=(e+i*Math.cos(g))*Math.cos(m),h.y=(e+i*Math.cos(g))*Math.sin(m),h.z=i*Math.sin(g),a.push(h.x,h.y,h.z),c.x=e*Math.cos(m),c.y=e*Math.sin(m),d.subVectors(h,c).normalize(),l.push(d.x,d.y,d.z),u.push(f/n),u.push(p/r)}for(let p=1;p<=r;p++)for(let f=1;f<=n;f++){const m=(n+1)*p+f-1,g=(n+1)*(p-1)+f-1,y=(n+1)*(p-1)+f,v=(n+1)*p+f;o.push(m,g,v),o.push(g,y,v)}this.setIndex(o),this.setAttribute("position",new Ft(a,3)),this.setAttribute("normal",new Ft(l,3)),this.setAttribute("uv",new Ft(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ET(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class MT extends bi{constructor(e=1,i=.4,r=64,n=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:r,radialSegments:n,p:s,q:o},r=Math.floor(r),n=Math.floor(n);const a=[],l=[],u=[],c=[],h=new ue,d=new ue,p=new ue,f=new ue,m=new ue,g=new ue,y=new ue;for(let b=0;b<=r;++b){const _=b/r*s*Math.PI*2;v(_,s,o,e,p),v(_+.01,s,o,e,f),g.subVectors(f,p),y.addVectors(f,p),m.crossVectors(g,y),y.crossVectors(m,g),m.normalize(),y.normalize();for(let A=0;A<=n;++A){const S=A/n*Math.PI*2,E=-i*Math.cos(S),M=i*Math.sin(S);h.x=p.x+(E*y.x+M*m.x),h.y=p.y+(E*y.y+M*m.y),h.z=p.z+(E*y.z+M*m.z),l.push(h.x,h.y,h.z),d.subVectors(h,p).normalize(),u.push(d.x,d.y,d.z),c.push(b/r),c.push(A/n)}}for(let b=1;b<=r;b++)for(let _=1;_<=n;_++){const A=(n+1)*(b-1)+(_-1),S=(n+1)*b+(_-1),E=(n+1)*b+_,M=(n+1)*(b-1)+_;a.push(A,S,M),a.push(S,E,M)}this.setIndex(a),this.setAttribute("position",new Ft(l,3)),this.setAttribute("normal",new Ft(u,3)),this.setAttribute("uv",new Ft(c,2));function v(b,_,A,S,E){const M=Math.cos(b),R=Math.sin(b),C=A/_*b,T=Math.cos(C);E.x=S*(2+T)*.5*M,E.y=S*(2+T)*R*.5,E.z=S*Math.sin(C)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MT(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class CT extends bi{constructor(e=new e5(new ue(-1,-1,0),new ue(-1,1,0),new ue(1,1,0)),i=64,r=1,n=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:r,radialSegments:n,closed:s};const o=e.computeFrenetFrames(i,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ue,l=new ue,u=new ot;let c=new ue;const h=[],d=[],p=[],f=[];m(),this.setIndex(f),this.setAttribute("position",new Ft(h,3)),this.setAttribute("normal",new Ft(d,3)),this.setAttribute("uv",new Ft(p,2));function m(){for(let b=0;b<i;b++)g(b);g(s===!1?i:0),v(),y()}function g(b){c=e.getPointAt(b/i,c);const _=o.normals[b],A=o.binormals[b];for(let S=0;S<=n;S++){const E=S/n*Math.PI*2,M=Math.sin(E),R=-Math.cos(E);l.x=R*_.x+M*A.x,l.y=R*_.y+M*A.y,l.z=R*_.z+M*A.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=c.x+r*l.x,a.y=c.y+r*l.y,a.z=c.z+r*l.z,h.push(a.x,a.y,a.z)}}function y(){for(let b=1;b<=i;b++)for(let _=1;_<=n;_++){const A=(n+1)*(b-1)+(_-1),S=(n+1)*b+(_-1),E=(n+1)*b+_,M=(n+1)*(b-1)+_;f.push(A,S,M),f.push(S,E,M)}}function v(){for(let b=0;b<=i;b++)for(let _=0;_<=n;_++)u.x=b/i,u.y=_/n,p.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new CT(new rP[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class use extends bi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],r=new Set,n=new ue,s=new ue;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,c=l.length;u<c;++u){const h=l[u],d=h.start,p=h.count;for(let f=d,m=d+p;f<m;f+=3)for(let g=0;g<3;g++){const y=a.getX(f+g),v=a.getX(f+(g+1)%3);n.fromBufferAttribute(o,y),s.fromBufferAttribute(o,v),EX(n,s,r)===!0&&(i.push(n.x,n.y,n.z),i.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const c=3*a+u,h=3*a+(u+1)%3;n.fromBufferAttribute(o,c),s.fromBufferAttribute(o,h),EX(n,s,r)===!0&&(i.push(n.x,n.y,n.z),i.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ft(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function EX(t,e,i){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,n=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return i.has(r)===!0||i.has(n)===!0?!1:(i.add(r),i.add(n),!0)}var MX=Object.freeze({__proto__:null,BoxGeometry:lg,CapsuleGeometry:mT,CircleGeometry:gT,ConeGeometry:yT,CylinderGeometry:sb,DodecahedronGeometry:vT,EdgesGeometry:sse,ExtrudeGeometry:xT,IcosahedronGeometry:wT,LatheGeometry:v_,OctahedronGeometry:b_,PlaneGeometry:rb,PolyhedronGeometry:Zp,RingGeometry:_T,ShapeGeometry:ST,SphereGeometry:x_,TetrahedronGeometry:AT,TorusGeometry:ET,TorusKnotGeometry:MT,TubeGeometry:CT,WireframeGeometry:use});class hse extends jn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new St(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cse extends Ru{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class w_ extends jn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xh extends w_{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ot(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return un(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class dse extends jn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new St(16777215),this.specular=new St(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=h_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class pse extends jn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new St(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class fse extends jn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class mse extends jn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=h_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gse extends jn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new St(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jp,this.normalScale=new ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yse extends wo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function om(t,e,i){return!t||!i&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function vse(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function bse(t){function e(n,s){return t[n]-t[s]}const i=t.length,r=new Array(i);for(let n=0;n!==i;++n)r[n]=n;return r.sort(e),r}function $U(t,e,i){const r=t.length,n=new t.constructor(r);for(let s=0,o=0;o!==r;++s){const a=i[s]*e;for(let l=0;l!==e;++l)n[o++]=t[a+l]}return n}function i5(t,e,i,r){let n=1,s=t[0];for(;s!==void 0&&s[r]===void 0;)s=t[n++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),i.push.apply(i,o)),s=t[n++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(i,i.length)),s=t[n++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),i.push(o)),s=t[n++];while(s!==void 0)}function xje(t,e,i,r,n=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],c=u.getValueSize(),h=[],d=[];for(let p=0;p<u.times.length;++p){const f=u.times[p]*n;if(!(f<i||f>=r)){h.push(u.times[p]);for(let m=0;m<c;++m)d.push(u.values[p*c+m])}}h.length!==0&&(u.times=om(h,u.times.constructor),u.values=om(d,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function wje(t,e=0,i=t,r=30){r<=0&&(r=30);const n=i.tracks.length,s=e/r;for(let o=0;o<n;++o){const a=i.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=t.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(u===void 0)continue;let c=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=h/3);let d=0;const p=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=p/3);const f=a.times.length-1;let m;if(s<=a.times[0]){const y=c,v=h-c;m=a.values.slice(y,v)}else if(s>=a.times[f]){const y=f*h+c,v=y+h-c;m=a.values.slice(y,v)}else{const y=a.createInterpolant(),v=c,b=h-c;y.evaluate(s),m=y.resultBuffer.slice(v,b)}l==="quaternion"&&new go().fromArray(m).normalize().conjugate().toArray(m);const g=u.times.length;for(let y=0;y<g;++y){const v=y*p+d;if(l==="quaternion")go.multiplyQuaternionsFlat(u.values,v,m,0,u.values,v);else{const b=p-d*2;for(let _=0;_<b;++_)u.values[v+_]-=m[_]}}}return t.blendMode=k4,t}const _je={convertArray:om,isTypedArray:vse,getKeyframeOrder:bse,sortedArray:$U,flattenJSON:i5,subclip:xje,makeClipAdditive:wje};class ob{constructor(e,i,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new i.constructor(r),this.sampleValues=i,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let r=this._cachedIndex,n=i[r],s=i[r-1];e:{t:{let o;i:{r:if(!(e<n)){for(let a=r+2;;){if(n===void 0){if(e<s)break r;return r=i.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=n,n=i[++r],e<n)break t}o=i.length;break i}if(!(e>=s)){const a=i[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(n=s,s=i[--r-1],e>=s)break t}o=r,r=0;break i}break e}for(;r<o;){const a=r+o>>>1;e<i[a]?o=a:r=a+1}if(n=i[r],s=i[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return r=i.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,n)}return this.interpolate_(r,s,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n;for(let o=0;o!==n;++o)i[o]=r[s+o];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class xse extends ob{constructor(e,i,r,n){super(e,i,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:rm,endingEnd:rm}}intervalChanged_(e,i,r){const n=this.parameterPositions;let s=e-2,o=e+1,a=n[s],l=n[o];if(a===void 0)switch(this.getSettings_().endingStart){case nm:s=e,a=2*i-r;break;case _1:s=n.length-2,a=i+n[s]-n[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case nm:o=e,l=2*r-i;break;case _1:o=1,l=r+n[1]-n[0];break;default:o=e-1,l=i}const u=(r-i)*.5,c=this.valueSize;this._weightPrev=u/(i-a),this._weightNext=u/(l-r),this._offsetPrev=s*c,this._offsetNext=o*c}interpolate_(e,i,r,n){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(r-i)/(n-i),m=f*f,g=m*f,y=-d*g+2*d*m-d*f,v=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*f+1,b=(-1-p)*g+(1.5+p)*m+.5*f,_=p*g-p*m;for(let A=0;A!==a;++A)s[A]=y*o[c+A]+v*o[u+A]+b*o[l+A]+_*o[h+A];return s}}class r5 extends ob{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e,i,r,n){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,c=(r-i)/(n-i),h=1-c;for(let d=0;d!==a;++d)s[d]=o[u+d]*h+o[l+d]*c;return s}}class wse extends ob{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class Uu{constructor(e,i,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=om(i,this.TimeBufferType),this.values=om(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let r;if(i.toJSON!==this.toJSON)r=i.toJSON(e);else{r={name:e.name,times:om(e.times,Array),values:om(e.values,Array)};const n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new wse(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new r5(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new xse(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case v0:i=this.InterpolantFactoryMethodDiscrete;break;case Gm:i=this.InterpolantFactoryMethodLinear;break;case sC:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return v0;case this.InterpolantFactoryMethodLinear:return Gm;case this.InterpolantFactoryMethodSmooth:return sC}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let r=0,n=i.length;r!==n;++r)i[r]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let r=0,n=i.length;r!==n;++r)i[r]*=e}return this}trim(e,i){const r=this.times,n=r.length;let s=0,o=n-1;for(;s!==n&&r[s]<e;)++s;for(;o!==-1&&r[o]>i;)--o;if(++o,s!==0||o!==n){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,n=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(n!==void 0&&vse(n))for(let a=0,l=n.length;a!==l;++a){const u=n[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),r=this.getValueSize(),n=this.getInterpolation()===sC,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],c=e[a+1];if(u!==c&&(a!==1||u!==e[0]))if(n)l=!0;else{const h=a*r,d=h-r,p=h+r;for(let f=0;f!==r;++f){const m=i[h+f];if(m!==i[d+f]||m!==i[p+f]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*r,d=o*r;for(let p=0;p!==r;++p)i[d+p]=i[h+p]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,u=0;u!==r;++u)i[l+u]=i[a+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=i.slice(0,o*r)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),r=this.constructor,n=new r(this.name,e,i);return n.createInterpolant=this.createInterpolant,n}}Uu.prototype.TimeBufferType=Float32Array;Uu.prototype.ValueBufferType=Float32Array;Uu.prototype.DefaultInterpolation=Gm;class ug extends Uu{}ug.prototype.ValueTypeName="bool";ug.prototype.ValueBufferType=Array;ug.prototype.DefaultInterpolation=v0;ug.prototype.InterpolantFactoryMethodLinear=void 0;ug.prototype.InterpolantFactoryMethodSmooth=void 0;class n5 extends Uu{}n5.prototype.ValueTypeName="color";class _0 extends Uu{}_0.prototype.ValueTypeName="number";class _se extends ob{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e,i,r,n){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-i)/(n-i);let u=e*a;for(let c=u+a;u!==c;u+=4)go.slerpFlat(s,0,o,u-a,o,u,l);return s}}class Vp extends Uu{InterpolantFactoryMethodLinear(e){return new _se(this.times,this.values,this.getValueSize(),e)}}Vp.prototype.ValueTypeName="quaternion";Vp.prototype.DefaultInterpolation=Gm;Vp.prototype.InterpolantFactoryMethodSmooth=void 0;class hg extends Uu{}hg.prototype.ValueTypeName="string";hg.prototype.ValueBufferType=Array;hg.prototype.DefaultInterpolation=v0;hg.prototype.InterpolantFactoryMethodLinear=void 0;hg.prototype.InterpolantFactoryMethodSmooth=void 0;class S0 extends Uu{}S0.prototype.ValueTypeName="vector";class A0{constructor(e,i=-1,r,n=sT){this.name=e,this.tracks=r,this.duration=i,this.blendMode=n,this.uuid=qa(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],r=e.tracks,n=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)i.push(Aje(r[o]).scale(n));const s=new this(e.name,e.duration,i,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const i=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)i.push(Uu.toJSON(r[s]));return n}static CreateFromMorphTargetSequence(e,i,r,n){const s=i.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const c=bse(l);l=$U(l,1,c),u=$U(u,1,c),!n&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new _0(".morphTargetInfluences["+i[a].name+"]",l,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,i){let r=e;if(!Array.isArray(e)){const n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===i)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,i,r){const n={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],c=u.name.match(s);if(c&&c.length>1){const h=c[1];let d=n[h];d||(n[h]=d=[]),d.push(u)}}const o=[];for(const a in n)o.push(this.CreateFromMorphTargetSequence(a,n[a],i,r));return o}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(h,d,p,f,m){if(p.length!==0){const g=[],y=[];i5(p,g,y,f),g.length!==0&&m.push(new h(d,g,y))}},n=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let h=0;h<u.length;h++){const d=u[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const p={};let f;for(f=0;f<d.length;f++)if(d[f].morphTargets)for(let m=0;m<d[f].morphTargets.length;m++)p[d[f].morphTargets[m]]=-1;for(const m in p){const g=[],y=[];for(let v=0;v!==d[f].morphTargets.length;++v){const b=d[f];g.push(b.time),y.push(b.morphTarget===m?1:0)}n.push(new _0(".morphTargetInfluence["+m+"]",g,y))}l=p.length*o}else{const p=".bones["+i[h].name+"]";r(S0,p+".position",d,"pos",n),r(Vp,p+".quaternion",d,"rot",n),r(S0,p+".scale",d,"scl",n)}}return n.length===0?null:new this(s,l,n,a)}resetDuration(){const e=this.tracks;let i=0;for(let r=0,n=e.length;r!==n;++r){const s=this.tracks[r];i=Math.max(i,s.times[s.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Sje(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _0;case"vector":case"vector2":case"vector3":case"vector4":return S0;case"color":return n5;case"quaternion":return Vp;case"bool":case"boolean":return ug;case"string":return hg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Aje(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Sje(t.type);if(t.times===void 0){const i=[],r=[];i5(t.keys,i,r,"value"),t.times=i,t.values=r}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Vc={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class s5{constructor(e,i,r){const n=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=r,this.itemStart=function(c){a++,s===!1&&n.onStart!==void 0&&n.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,n.onProgress!==void 0&&n.onProgress(c,o,a),o===a&&(s=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){const p=u[h],f=u[h+1];if(p.global&&(p.lastIndex=0),p.test(c))return f}return null}}}const Sse=new s5;class _o{constructor(e){this.manager=e!==void 0?e:Sse,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const r=this;return new Promise(function(n,s){r.load(e,n,i,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}_o.DEFAULT_MATERIAL_NAME="__DEFAULT";const bc={};class Eje extends Error{constructor(e,i){super(e),this.response=i}}class Ja extends _o{constructor(e){super(e)}load(e,i,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Vc.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(s),this.manager.itemEnd(e)},0),s;if(bc[e]!==void 0){bc[e].push({onLoad:i,onProgress:r,onError:n});return}bc[e]=[],bc[e].push({onLoad:i,onProgress:r,onError:n});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=bc[e],h=u.body.getReader(),d=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),p=d?parseInt(d):0,f=p!==0;let m=0;const g=new ReadableStream({start(y){v();function v(){h.read().then(({done:b,value:_})=>{if(b)y.close();else{m+=_.byteLength;const A=new ProgressEvent("progress",{lengthComputable:f,loaded:m,total:p});for(let S=0,E=c.length;S<E;S++){const M=c[S];M.onProgress&&M.onProgress(A)}y.enqueue(_),v()}})}}});return new Response(g)}else throw new Eje(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return u.json();default:if(a===void 0)return u.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,p=new TextDecoder(d);return u.arrayBuffer().then(f=>p.decode(f))}}}).then(u=>{Vc.add(e,u);const c=bc[e];delete bc[e];for(let h=0,d=c.length;h<d;h++){const p=c[h];p.onLoad&&p.onLoad(u)}}).catch(u=>{const c=bc[e];if(c===void 0)throw this.manager.itemError(e),u;delete bc[e];for(let h=0,d=c.length;h<d;h++){const p=c[h];p.onError&&p.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Mje extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=new Ja(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){n?n(l):console.error(l),s.manager.itemError(e)}},r,n)}parse(e){const i=[];for(let r=0;r<e.length;r++){const n=A0.parse(e[r]);i.push(n)}return i}}class Cje extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=[],a=new pT,l=new Ja(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function c(h){l.load(e[h],function(d){const p=s.parse(d,!0);o[h]={width:p.width,height:p.height,format:p.format,mipmaps:p.mipmaps},u+=1,u===6&&(p.mipmapCount===1&&(a.minFilter=Rr),a.image=o,a.format=p.format,a.needsUpdate=!0,i&&i(a))},r,n)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)c(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const p=d.mipmaps.length/d.mipmapCount;for(let f=0;f<p;f++){o[f]={mipmaps:[]};for(let m=0;m<d.mipmapCount;m++)o[f].mipmaps.push(d.mipmaps[f*d.mipmapCount+m]),o[f].format=d.format,o[f].width=d.width,o[f].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=Rr),a.format=d.format,a.needsUpdate=!0,i&&i(a)},r,n);return a}}class I1 extends _o{constructor(e){super(e)}load(e,i,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Vc.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o;const a=P1("img");function l(){c(),Vc.add(e,this),i&&i(this),s.manager.itemEnd(e)}function u(h){c(),n&&n(h),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Pje extends _o{constructor(e){super(e)}load(e,i,r,n){const s=new f_;s.colorSpace=es;const o=new I1(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(c){s.images[u]=c,a++,a===6&&(s.needsUpdate=!0,i&&i(s))},void 0,n)}for(let u=0;u<e.length;++u)l(u);return s}}class Tje extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=new Am,a=new Ja(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let u;try{u=s.parse(l)}catch(c){if(n!==void 0)n(c);else{console.error(c);return}}u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:Hs,o.wrapT=u.wrapT!==void 0?u.wrapT:Hs,o.magFilter=u.magFilter!==void 0?u.magFilter:Rr,o.minFilter=u.minFilter!==void 0?u.minFilter:Rr,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.colorSpace!==void 0?o.colorSpace=u.colorSpace:u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=Il),u.mipmapCount===1&&(o.minFilter=Rr),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,i&&i(o,u)},r,n),o}}class Ase extends _o{constructor(e){super(e)}load(e,i,r,n){const s=new Ir,o=new I1(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,i!==void 0&&i(s)},r,n),s}}class $p extends Hi{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class Ese extends $p{constructor(e,i,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Hi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new St(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const MI=new ii,CX=new ue,PX=new ue;class o5{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ot(512,512),this.map=null,this.mapPass=null,this.matrix=new ii,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new m_,this._frameExtents=new ot(1,1),this._viewportCount=1,this._viewports=[new lr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,r=this.matrix;CX.setFromMatrixPosition(e.matrixWorld),i.position.copy(CX),PX.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(PX),i.updateMatrixWorld(),MI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MI),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(MI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Rje extends o5{constructor(){super(new xn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,r=b0*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,s=e.distance||i.far;(r!==i.fov||n!==i.aspect||s!==i.far)&&(i.fov=r,i.aspect=n,i.far=s,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class a5 extends $p{constructor(e,i,r=0,n=Math.PI/3,s=0,o=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Hi.DEFAULT_UP),this.updateMatrix(),this.target=new Hi,this.distance=r,this.angle=n,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Rje}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const TX=new ii,Cx=new ue,CI=new ue;class kje extends o5{constructor(){super(new xn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ot(4,2),this._viewportCount=6,this._viewports=[new lr(2,1,1,1),new lr(0,1,1,1),new lr(3,1,1,1),new lr(1,1,1,1),new lr(3,0,1,1),new lr(1,0,1,1)],this._cubeDirections=[new ue(1,0,0),new ue(-1,0,0),new ue(0,0,1),new ue(0,0,-1),new ue(0,1,0),new ue(0,-1,0)],this._cubeUps=[new ue(0,1,0),new ue(0,1,0),new ue(0,1,0),new ue(0,1,0),new ue(0,0,1),new ue(0,0,-1)]}updateMatrices(e,i=0){const r=this.camera,n=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),Cx.setFromMatrixPosition(e.matrixWorld),r.position.copy(Cx),CI.copy(r.position),CI.add(this._cubeDirections[i]),r.up.copy(this._cubeUps[i]),r.lookAt(CI),r.updateMatrixWorld(),n.makeTranslation(-Cx.x,-Cx.y,-Cx.z),TX.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TX)}}class l5 extends $p{constructor(e,i,r=0,n=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new kje}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Dje extends o5{constructor(){super(new Qp(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class u5 extends $p{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Hi.DEFAULT_UP),this.updateMatrix(),this.target=new Hi,this.shadow=new Dje}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Mse extends $p{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class Cse extends $p{constructor(e,i,r=10,n=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=n}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class Pse{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ue)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const r=e.x,n=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.282095),i.addScaledVector(o[1],.488603*n),i.addScaledVector(o[2],.488603*s),i.addScaledVector(o[3],.488603*r),i.addScaledVector(o[4],1.092548*(r*n)),i.addScaledVector(o[5],1.092548*(n*s)),i.addScaledVector(o[6],.315392*(3*s*s-1)),i.addScaledVector(o[7],1.092548*(r*s)),i.addScaledVector(o[8],.546274*(r*r-n*n)),i}getIrradianceAt(e,i){const r=e.x,n=e.y,s=e.z,o=this.coefficients;return i.copy(o[0]).multiplyScalar(.886227),i.addScaledVector(o[1],2*.511664*n),i.addScaledVector(o[2],2*.511664*s),i.addScaledVector(o[3],2*.511664*r),i.addScaledVector(o[4],2*.429043*r*n),i.addScaledVector(o[5],2*.429043*n*s),i.addScaledVector(o[6],.743125*s*s-.247708),i.addScaledVector(o[7],2*.429043*r*s),i.addScaledVector(o[8],.429043*(r*r-n*n)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,i+n*3);return this}toArray(e=[],i=0){const r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,i+n*3);return e}static getBasisAt(e,i){const r=e.x,n=e.y,s=e.z;i[0]=.282095,i[1]=.488603*n,i[2]=.488603*s,i[3]=.488603*r,i[4]=1.092548*r*n,i[5]=1.092548*n*s,i[6]=.315392*(3*s*s-1),i[7]=1.092548*r*s,i[8]=.546274*(r*r-n*n)}}class Tse extends $p{constructor(e=new Pse,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class PT extends _o{constructor(e){super(e),this.textures={}}load(e,i,r,n){const s=this,o=new Ja(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){n?n(l):console.error(l),s.manager.itemError(e)}},r,n)}parse(e){const i=this.textures;function r(s){return i[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),i[s]}const n=PT.createMaterialFromType(e.type);if(e.uuid!==void 0&&(n.uuid=e.uuid),e.name!==void 0&&(n.name=e.name),e.color!==void 0&&n.color!==void 0&&n.color.setHex(e.color),e.roughness!==void 0&&(n.roughness=e.roughness),e.metalness!==void 0&&(n.metalness=e.metalness),e.sheen!==void 0&&(n.sheen=e.sheen),e.sheenColor!==void 0&&(n.sheenColor=new St().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(n.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&n.emissive!==void 0&&n.emissive.setHex(e.emissive),e.specular!==void 0&&n.specular!==void 0&&n.specular.setHex(e.specular),e.specularIntensity!==void 0&&(n.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&n.specularColor!==void 0&&n.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(n.shininess=e.shininess),e.clearcoat!==void 0&&(n.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(n.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(n.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(n.transmission=e.transmission),e.thickness!==void 0&&(n.thickness=e.thickness),e.attenuationDistance!==void 0&&(n.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&n.attenuationColor!==void 0&&n.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(n.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(n.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(n.fog=e.fog),e.flatShading!==void 0&&(n.flatShading=e.flatShading),e.blending!==void 0&&(n.blending=e.blending),e.combine!==void 0&&(n.combine=e.combine),e.side!==void 0&&(n.side=e.side),e.shadowSide!==void 0&&(n.shadowSide=e.shadowSide),e.opacity!==void 0&&(n.opacity=e.opacity),e.transparent!==void 0&&(n.transparent=e.transparent),e.alphaTest!==void 0&&(n.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(n.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(n.depthFunc=e.depthFunc),e.depthTest!==void 0&&(n.depthTest=e.depthTest),e.depthWrite!==void 0&&(n.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(n.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(n.blendSrc=e.blendSrc),e.blendDst!==void 0&&(n.blendDst=e.blendDst),e.blendEquation!==void 0&&(n.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(n.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(n.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(n.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&n.blendColor!==void 0&&n.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(n.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(n.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(n.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(n.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(n.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(n.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(n.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(n.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(n.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(n.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(n.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(n.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(n.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(n.rotation=e.rotation),e.linewidth!==void 0&&(n.linewidth=e.linewidth),e.dashSize!==void 0&&(n.dashSize=e.dashSize),e.gapSize!==void 0&&(n.gapSize=e.gapSize),e.scale!==void 0&&(n.scale=e.scale),e.polygonOffset!==void 0&&(n.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(n.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(n.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(n.dithering=e.dithering),e.alphaToCoverage!==void 0&&(n.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(n.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(n.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(n.visible=e.visible),e.toneMapped!==void 0&&(n.toneMapped=e.toneMapped),e.userData!==void 0&&(n.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(n.uniforms[s]={},o.type){case"t":n.uniforms[s].value=r(o.value);break;case"c":n.uniforms[s].value=new St().setHex(o.value);break;case"v2":n.uniforms[s].value=new ot().fromArray(o.value);break;case"v3":n.uniforms[s].value=new ue().fromArray(o.value);break;case"v4":n.uniforms[s].value=new lr().fromArray(o.value);break;case"m3":n.uniforms[s].value=new Ei().fromArray(o.value);break;case"m4":n.uniforms[s].value=new ii().fromArray(o.value);break;default:n.uniforms[s].value=o.value}}if(e.defines!==void 0&&(n.defines=e.defines),e.vertexShader!==void 0&&(n.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(n.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(n.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)n.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(n.lights=e.lights),e.clipping!==void 0&&(n.clipping=e.clipping),e.size!==void 0&&(n.size=e.size),e.sizeAttenuation!==void 0&&(n.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(n.map=r(e.map)),e.matcap!==void 0&&(n.matcap=r(e.matcap)),e.alphaMap!==void 0&&(n.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(n.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(n.bumpScale=e.bumpScale),e.normalMap!==void 0&&(n.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(n.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),n.normalScale=new ot().fromArray(s)}return e.displacementMap!==void 0&&(n.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(n.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(n.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(n.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(n.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(n.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(n.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(n.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(n.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(n.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(n.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(n.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(n.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(n.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(n.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(n.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(n.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(n.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(n.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(n.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(n.clearcoatNormalScale=new ot().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(n.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(n.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(n.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(n.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(n.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(n.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:hse,SpriteMaterial:W4,RawShaderMaterial:cse,ShaderMaterial:Ru,PointsMaterial:dT,MeshPhysicalMaterial:Xh,MeshStandardMaterial:w_,MeshPhongMaterial:dse,MeshToonMaterial:pse,MeshNormalMaterial:fse,MeshLambertMaterial:mse,MeshDepthMaterial:G4,MeshDistanceMaterial:V4,MeshBasicMaterial:Ga,MeshMatcapMaterial:gse,LineDashedMaterial:yse,LineBasicMaterial:wo,Material:jn};return new i[e]}}class Ih{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let r=0,n=e.length;r<n;r++)i+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class Rse extends bi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class kse extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=new Ja(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{i(s.parse(JSON.parse(a)))}catch(l){n?n(l):console.error(l),s.manager.itemError(e)}},r,n)}parse(e){const i={},r={};function n(p,f){if(i[f]!==void 0)return i[f];const g=p.interleavedBuffers[f],y=s(p,g.buffer),v=dv(g.type,y),b=new g_(v,g.stride);return b.uuid=g.uuid,i[f]=b,b}function s(p,f){if(r[f]!==void 0)return r[f];const g=p.arrayBuffers[f],y=new Uint32Array(g).buffer;return r[f]=y,y}const o=e.isInstancedBufferGeometry?new Rse:new bi,a=e.data.index;if(a!==void 0){const p=dv(a.type,a.array);o.setIndex(new Gi(p,1))}const l=e.data.attributes;for(const p in l){const f=l[p];let m;if(f.isInterleavedBufferAttribute){const g=n(e.data,f.data);m=new Gp(g,f.itemSize,f.offset,f.normalized)}else{const g=dv(f.type,f.array),y=f.isInstancedBufferAttribute?w0:Gi;m=new y(g,f.itemSize,f.normalized)}f.name!==void 0&&(m.name=f.name),f.usage!==void 0&&m.setUsage(f.usage),o.setAttribute(p,m)}const u=e.data.morphAttributes;if(u)for(const p in u){const f=u[p],m=[];for(let g=0,y=f.length;g<y;g++){const v=f[g];let b;if(v.isInterleavedBufferAttribute){const _=n(e.data,v.data);b=new Gp(_,v.itemSize,v.offset,v.normalized)}else{const _=dv(v.type,v.array);b=new Gi(_,v.itemSize,v.normalized)}v.name!==void 0&&(b.name=v.name),m.push(b)}o.morphAttributes[p]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let p=0,f=h.length;p!==f;++p){const m=h[p];o.addGroup(m.start,m.count,m.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const p=new ue;d.center!==void 0&&p.fromArray(d.center),o.boundingSphere=new qs(p,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Ije extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=this.path===""?Ih.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Ja(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(h){n!==void 0&&n(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const c=u.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry"){n!==void 0&&n(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,i)},r,n)}async loadAsync(e,i){const r=this,n=this.path===""?Ih.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const s=new Ja(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,i),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,i){const r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),o=this.parseImages(e.images,function(){i!==void 0&&i(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,r),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),i!==void 0){let h=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&i(u)}return u}async parseAsync(e){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,n,a,o,i),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),l}parseShapes(e){const i={};if(e!==void 0)for(let r=0,n=e.length;r<n;r++){const s=new Em().fromJSON(e[r]);i[s.uuid]=s}return i}parseSkeletons(e,i){const r={},n={};if(i.traverse(function(s){s.isBone&&(n[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new y_().fromJSON(e[s],n);r[a.uuid]=a}return r}parseGeometries(e,i){const r={};if(e!==void 0){const n=new kse;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(l);break;default:l.type in MX?a=MX[l.type].fromJSON(l,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,i){const r={},n={};if(e!==void 0){const s=new PT;s.setTextures(i);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),n[l.uuid]=r[l.uuid]}}return n}parseAnimations(e){const i={};if(e!==void 0)for(let r=0;r<e.length;r++){const n=e[r],s=A0.parse(n);i[s.uuid]=s}return i}parseImages(e,i){const r=this,n={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:r.resourcePath+u;return o(c)}else return l.data?{data:dv(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new s5(i);s=new I1(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,c=e.length;u<c;u++){const h=e[u],d=h.url;if(Array.isArray(d)){const p=[];for(let f=0,m=d.length;f<m;f++){const g=d[f],y=a(g);y!==null&&(y instanceof HTMLImageElement?p.push(y):p.push(new Am(y.data,y.width,y.height)))}n[h.uuid]=new sm(p)}else{const p=a(h.url);n[h.uuid]=new sm(p)}}}return n}async parseImagesAsync(e){const i=this,r={};let n;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:i.resourcePath+a;return await n.loadAsync(l)}else return o.data?{data:dv(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){n=new I1(this.manager),n.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const c=[];for(let h=0,d=u.length;h<d;h++){const p=u[h],f=await s(p);f!==null&&(f instanceof HTMLImageElement?c.push(f):c.push(new Am(f.data,f.width,f.height)))}r[l.uuid]=new sm(c)}else{const c=await s(l.url);r[l.uuid]=new sm(c)}}}return r}parseTextures(e,i){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const n={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),i[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=i[a.image],u=l.data;let c;Array.isArray(u)?(c=new f_,u.length===6&&(c.needsUpdate=!0)):(u&&u.data?c=new Am:c=new Ir,u&&(c.needsUpdate=!0)),c.source=l,c.uuid=a.uuid,a.name!==void 0&&(c.name=a.name),a.mapping!==void 0&&(c.mapping=r(a.mapping,Lje)),a.channel!==void 0&&(c.channel=a.channel),a.offset!==void 0&&c.offset.fromArray(a.offset),a.repeat!==void 0&&c.repeat.fromArray(a.repeat),a.center!==void 0&&c.center.fromArray(a.center),a.rotation!==void 0&&(c.rotation=a.rotation),a.wrap!==void 0&&(c.wrapS=r(a.wrap[0],RX),c.wrapT=r(a.wrap[1],RX)),a.format!==void 0&&(c.format=a.format),a.internalFormat!==void 0&&(c.internalFormat=a.internalFormat),a.type!==void 0&&(c.type=a.type),a.colorSpace!==void 0&&(c.colorSpace=a.colorSpace),a.encoding!==void 0&&(c.encoding=a.encoding),a.minFilter!==void 0&&(c.minFilter=r(a.minFilter,kX)),a.magFilter!==void 0&&(c.magFilter=r(a.magFilter,kX)),a.anisotropy!==void 0&&(c.anisotropy=a.anisotropy),a.flipY!==void 0&&(c.flipY=a.flipY),a.generateMipmaps!==void 0&&(c.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(c.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(c.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(c.compareFunction=a.compareFunction),a.userData!==void 0&&(c.userData=a.userData),n[a.uuid]=c}return n}parseObject(e,i,r,n,s){let o;function a(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),i[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const p=[];for(let f=0,m=d.length;f<m;f++){const g=d[f];r[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),p.push(r[g])}return p}return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),r[d]}}function u(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),n[d]}let c,h;switch(e.type){case"Scene":o=new iP,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new St(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new hT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new uT(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new xn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Qp(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Mse(e.color,e.intensity);break;case"DirectionalLight":o=new u5(e.color,e.intensity);break;case"PointLight":o=new l5(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Cse(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new a5(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Ese(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Tse().fromJSON(e);break;case"SkinnedMesh":c=a(e.geometry),h=l(e.material),o=new q4(c,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":c=a(e.geometry),h=l(e.material),o=new _n(c,h);break;case"InstancedMesh":c=a(e.geometry),h=l(e.material);const d=e.count,p=e.instanceMatrix,f=e.instanceColor;o=new X4(c,h,d),o.instanceMatrix=new w0(new Float32Array(p.array),16),f!==void 0&&(o.instanceColor=new w0(new Float32Array(f.array),f.itemSize));break;case"BatchedMesh":c=a(e.geometry),h=l(e.material),o=new $ne(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,h),o.geometry=c,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(m=>{const g=new yo;g.min.fromArray(m.boxMin),g.max.fromArray(m.boxMax);const y=new qs;return y.radius=m.sphereRadius,y.center.fromArray(m.sphereCenter),{boxInitialized:m.boxInitialized,box:g,sphereInitialized:m.sphereInitialized,sphere:y}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=u(e.matricesTexture.uuid);break;case"LOD":o=new Zne;break;case"Line":o=new sd(a(e.geometry),l(e.material));break;case"LineLoop":o=new Y4(a(e.geometry),l(e.material));break;case"LineSegments":o=new Bu(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new K4(a(e.geometry),l(e.material));break;case"Sprite":o=new Qne(l(e.material));break;case"Group":o=new Gc;break;case"Bone":o=new cT;break;default:o=new Hi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let p=0;p<d.length;p++)o.add(this.parseObject(d[p],i,r,n,s))}if(e.animations!==void 0){const d=e.animations;for(let p=0;p<d.length;p++){const f=d[p];o.animations.push(s[f])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let p=0;p<d.length;p++){const f=d[p],m=o.getObjectByProperty("uuid",f.object);m!==void 0&&o.addLevel(m,f.distance,f.hysteresis)}}return o}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const n=i[r.skeleton];n===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(n,r.bindMatrix)}})}}const Lje={UVMapping:rT,CubeReflectionMapping:nd,CubeRefractionMapping:zp,EquirectangularReflectionMapping:b1,EquirectangularRefractionMapping:x1,CubeUVReflectionMapping:tb},RX={RepeatWrapping:Hp,ClampToEdgeWrapping:Hs,MirroredRepeatWrapping:g0},kX={NearestFilter:an,NearestMipmapNearestFilter:w1,NearestMipmapLinearFilter:np,LinearFilter:Rr,LinearMipmapNearestFilter:Hv,LinearMipmapLinearFilter:Il};class Dse extends _o{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Vc.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(u=>{i&&i(u),s.manager.itemEnd(e)}).catch(u=>{n&&n(u)});return}return setTimeout(function(){i&&i(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){return Vc.add(e,u),i&&i(u),s.manager.itemEnd(e),u}).catch(function(u){n&&n(u),Vc.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Vc.add(e,l),s.manager.itemStart(e)}}let ZE,h5=class{static getContext(){return ZE===void 0&&(ZE=new(window.AudioContext||window.webkitAudioContext)),ZE}static setContext(e){ZE=e}};class Bje extends _o{constructor(e){super(e)}load(e,i,r,n){const s=this,o=new Ja(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const u=l.slice(0);h5.getContext().decodeAudioData(u,function(h){i(h)}).catch(a)}catch(u){a(u)}},r,n);function a(l){n?n(l):console.error(l),s.manager.itemError(e)}}}const DX=new ii,IX=new ii,_f=new ii;class Oje{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new xn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new xn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,_f.copy(e.projectionMatrix);const n=i.eyeSep/2,s=n*i.near/i.focus,o=i.near*Math.tan(wm*i.fov*.5)/i.zoom;let a,l;IX.elements[12]=-n,DX.elements[12]=n,a=-o*i.aspect+s,l=o*i.aspect+s,_f.elements[0]=2*i.near/(l-a),_f.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(_f),a=-o*i.aspect-s,l=o*i.aspect-s,_f.elements[0]=2*i.near/(l-a),_f.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(_f)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(IX),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(DX)}}class c5{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=LX(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=LX();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function LX(){return(typeof performance>"u"?Date:performance).now()}const Sf=new ue,BX=new go,Uje=new ue,Af=new ue;class Nje extends Hi{constructor(){super(),this.type="AudioListener",this.context=h5.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new c5}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sf,BX,Uje),Af.set(0,0,-1).applyQuaternion(BX),i.positionX){const n=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(Sf.x,n),i.positionY.linearRampToValueAtTime(Sf.y,n),i.positionZ.linearRampToValueAtTime(Sf.z,n),i.forwardX.linearRampToValueAtTime(Af.x,n),i.forwardY.linearRampToValueAtTime(Af.y,n),i.forwardZ.linearRampToValueAtTime(Af.z,n),i.upX.linearRampToValueAtTime(r.x,n),i.upY.linearRampToValueAtTime(r.y,n),i.upZ.linearRampToValueAtTime(r.z,n)}else i.setPosition(Sf.x,Sf.y,Sf.z),i.setOrientation(Af.x,Af.y,Af.z,r.x,r.y,r.z)}}let Ise=class extends Hi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Ef=new ue,OX=new go,Fje=new ue,Mf=new ue;class zje extends Ise{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Ef,OX,Fje),Mf.set(0,0,1).applyQuaternion(OX);const i=this.panner;if(i.positionX){const r=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Ef.x,r),i.positionY.linearRampToValueAtTime(Ef.y,r),i.positionZ.linearRampToValueAtTime(Ef.z,r),i.orientationX.linearRampToValueAtTime(Mf.x,r),i.orientationY.linearRampToValueAtTime(Mf.y,r),i.orientationZ.linearRampToValueAtTime(Mf.z,r)}else i.setPosition(Ef.x,Ef.y,Ef.z),i.setOrientation(Mf.x,Mf.y,Mf.z)}}class Hje{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let r=0;r<i.length;r++)e+=i[r];return e/i.length}}class Lse{constructor(e,i,r){this.binding=e,this.valueSize=r;let n,s,o;switch(i){case"quaternion":n=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":n=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:n=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const r=this.buffer,n=this.valueSize,s=e*n+n;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==n;++a)r[s+a]=r[a];o=i}else{o+=i;const a=i/o;this._mixBufferRegion(r,s,0,a,n)}this.cumulativeWeight=o}accumulateAdditive(e){const i=this.buffer,r=this.valueSize,n=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,r=this.buffer,n=e*i+i,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=i*this._origIndex;this._mixBufferRegion(r,n,l,1-s,i)}o>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*i,1,i);for(let l=i,u=i+i;l!==u;++l)if(r[l]!==r[l+i]){a.setValue(r,n);break}}saveOriginalState(){const e=this.binding,i=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(i,n);for(let s=r,o=n;s!==o;++s)i[s]=i[n+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let r=e;r<i;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[i+r]=this.buffer[e+r]}_select(e,i,r,n,s){if(n>=.5)for(let o=0;o!==s;++o)e[i+o]=e[r+o]}_slerp(e,i,r,n){go.slerpFlat(e,i,e,i,e,r,n)}_slerpAdditive(e,i,r,n,s){const o=this._workIndex*s;go.multiplyQuaternionsFlat(e,o,e,i,e,r),go.slerpFlat(e,i,e,i,e,o,n)}_lerp(e,i,r,n,s){const o=1-n;for(let a=0;a!==s;++a){const l=i+a;e[l]=e[l]*o+e[r+a]*n}}_lerpAdditive(e,i,r,n,s){for(let o=0;o!==s;++o){const a=i+o;e[a]=e[a]+e[r+o]*n}}}const d5="\\[\\]\\.:\\/",Gje=new RegExp("["+d5+"]","g"),p5="[^"+d5+"]",Vje="[^"+d5.replace("\\.","")+"]",jje=/((?:WC+[\/:])*)/.source.replace("WC",p5),Wje=/(WCOD+)?/.source.replace("WCOD",Vje),qje=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",p5),Xje=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",p5),Yje=new RegExp("^"+jje+Wje+qje+Xje+"$"),Kje=["material","materials","bones","map"];class Jje{constructor(e,i,r){const n=r||zi.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,n)}getValue(e,i){this.bind();const r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(e,i)}setValue(e,i){const r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=r.length;n!==s;++n)r[n].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=e.length;i!==r;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=e.length;i!==r;++i)e[i].unbind()}}class zi{constructor(e,i,r){this.path=i,this.parsedPath=r||zi.parseTrackName(i),this.node=zi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,r){return e&&e.isAnimationObjectGroup?new zi.Composite(e,i,r):new zi(e,i,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Gje,"")}static parseTrackName(e){const i=Yje.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){const s=r.nodeName.substring(n+1);Kje.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(i);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===i||a.uuid===i)return a;const l=r(a.children);if(l)return l}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)e[i++]=r[n]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,r=i.objectName,n=i.propertyName;let s=i.propertyIndex;if(e||(e=zi.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=i.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[n];if(o===void 0){const u=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}zi.Composite=Jje;zi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};zi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};zi.prototype.GetterByBindingType=[zi.prototype._getValue_direct,zi.prototype._getValue_array,zi.prototype._getValue_arrayElement,zi.prototype._getValue_toArray];zi.prototype.SetterByBindingTypeAndVersioning=[[zi.prototype._setValue_direct,zi.prototype._setValue_direct_setNeedsUpdate,zi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_array,zi.prototype._setValue_array_setNeedsUpdate,zi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_arrayElement,zi.prototype._setValue_arrayElement_setNeedsUpdate,zi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[zi.prototype._setValue_fromArray,zi.prototype._setValue_fromArray_setNeedsUpdate,zi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Qje{constructor(){this.isAnimationObjectGroup=!0,this.uuid=qa(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,n=arguments.length;r!==n;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,r=this._paths,n=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let c=0,h=arguments.length;c!==h;++c){const d=arguments[c],p=d.uuid;let f=i[p];if(f===void 0){f=l++,i[p]=f,e.push(d);for(let m=0,g=o;m!==g;++m)s[m].push(new zi(d,r[m],n[m]))}else if(f<u){a=e[f];const m=--u,g=e[m];i[g.uuid]=f,e[f]=g,i[p]=m,e[m]=d;for(let y=0,v=o;y!==v;++y){const b=s[y],_=b[m];let A=b[f];b[f]=_,A===void 0&&(A=new zi(d,r[y],n[y])),b[m]=A}}else e[f]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,c=i[u];if(c!==void 0&&c>=s){const h=s++,d=e[h];i[d.uuid]=c,e[c]=d,i[u]=h,e[h]=l;for(let p=0,f=n;p!==f;++p){const m=r[p],g=m[h],y=m[c];m[c]=g,m[h]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,i=this._indicesByUUID,r=this._bindings,n=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],c=u.uuid,h=i[c];if(h!==void 0)if(delete i[c],h<s){const d=--s,p=e[d],f=--o,m=e[f];i[p.uuid]=h,e[h]=p,i[m.uuid]=d,e[d]=m,e.pop();for(let g=0,y=n;g!==y;++g){const v=r[g],b=v[d],_=v[f];v[h]=b,v[d]=_,v.pop()}}else{const d=--o,p=e[d];d>0&&(i[p.uuid]=h),e[h]=p,e.pop();for(let f=0,m=n;f!==m;++f){const g=r[f];g[h]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,i){const r=this._bindingsIndicesByPath;let n=r[e];const s=this._bindings;if(n!==void 0)return s[n];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,c=this.nCachedObjects_,h=new Array(u);n=s.length,r[e]=n,o.push(e),a.push(i),s.push(h);for(let d=c,p=l.length;d!==p;++d){const f=l[d];h[d]=new zi(f,e,i)}return h}unsubscribe_(e){const i=this._bindingsIndicesByPath,r=i[e];if(r!==void 0){const n=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];i[u]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),n[r]=n[a],n.pop()}}}class Bse{constructor(e,i,r=null,n=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=r,this.blendMode=n;const s=i.tracks,o=s.length,a=new Array(o),l={endingStart:rm,endingEnd:rm};for(let u=0;u!==o;++u){const c=s[u].createInterpolant(null);a[u]=c,c.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bne,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,r){if(e.fadeOut(i),this.fadeIn(i),r){const n=this._clip.duration,s=e._clip.duration,o=s/n,a=n/s;e.warp(1,o,i),this.warp(a,1,i)}return this}crossFadeTo(e,i,r){return e.crossFadeFrom(this,i,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,r){const n=this._mixer,s=n.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+r,u[0]=e/o,u[1]=i/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,r,n){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?i=0:(this._startTime=null,i=r*l)}i*=this._updateTimeScale(e);const o=this._updateTime(i),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case k4:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(a);break;case sT:default:for(let c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulate(n,a)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const r=this._weightInterpolant;if(r!==null){const n=r.evaluate(e)[0];i*=n,e>r.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const n=r.evaluate(e)[0];i*=n,e>r.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,r=this.loop;let n=this.time+e,s=this._loopCount;const o=r===xne;if(e===0)return s===-1?n:o&&(s&1)===1?i-n:n;if(r===vne){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=i)n=i;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),n>=i||n<0){const a=Math.floor(n/i);n-=i*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?i:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=n;if(o&&(s&1)===1)return i-n}return n}_setEndings(e,i,r){const n=this._interpolantSettings;r?(n.endingStart=nm,n.endingEnd=nm):(e?n.endingStart=this.zeroSlopeAtStart?nm:rm:n.endingStart=_1,i?n.endingEnd=this.zeroSlopeAtEnd?nm:rm:n.endingEnd=_1)}_scheduleFading(e,i,r){const n=this._mixer,s=n.time;let o=this._weightInterpolant;o===null&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=i,a[1]=s+e,l[1]=r,this}}const Zje=new Float32Array(1);class $je extends hd{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const r=e._localRoot||this._root,n=e._clip.tracks,s=n.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,u=this._bindingsByRootAndName;let c=u[l];c===void 0&&(c={},u[l]=c);for(let h=0;h!==s;++h){const d=n[h],p=d.name;let f=c[p];if(f!==void 0)++f.referenceCount,o[h]=f;else{if(f=o[h],f!==void 0){f._cacheIndex===null&&(++f.referenceCount,this._addInactiveBinding(f,l,p));continue}const m=i&&i._propertyBindings[h].binding.parsedPath;f=new Lse(zi.create(r,p,m),d.ValueTypeName,d.getValueSize()),++f.referenceCount,this._addInactiveBinding(f,l,p),o[h]=f}a[h].resultBuffer=f.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,n=e._clip.uuid,s=this._actionsByClip[n];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,n,r)}const i=e._propertyBindings;for(let r=0,n=i.length;r!==n;++r){const s=i[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let r=0,n=i.length;r!==n;++r){const s=i[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,r){const n=this._actions,s=this._actionsByClip;let o=s[i];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[i]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const i=this._actions,r=i[i.length-1],n=e._cacheIndex;r._cacheIndex=n,i[n]=r,i.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,l[c]=u,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let r=0,n=i.length;r!==n;++r){const s=i[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const i=this._actions,r=e._cacheIndex,n=this._nActiveActions++,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_takeBackAction(e){const i=this._actions,r=e._cacheIndex,n=--this._nActiveActions,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_addInactiveBinding(e,i,r){const n=this._bindingsByRootAndName,s=this._bindings;let o=n[i];o===void 0&&(o={},n[i]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const i=this._bindings,r=e.binding,n=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[n],l=i[i.length-1],u=e._cacheIndex;l._cacheIndex=u,i[u]=l,i.pop(),delete a[s],Object.keys(a).length===0&&delete o[n]}_lendBinding(e){const i=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_takeBackBinding(e){const i=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let r=e[i];return r===void 0&&(r=new r5(new Float32Array(2),new Float32Array(2),1,Zje),r.__cacheIndex=i,e[i]=r),r}_takeBackControlInterpolant(e){const i=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,s=i[n];e.__cacheIndex=n,i[n]=e,s.__cacheIndex=r,i[r]=s}clipAction(e,i,r){const n=i||this._root,s=n.uuid;let o=typeof e=="string"?A0.findByName(n,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(r===void 0&&(o!==null?r=o.blendMode:r=sT),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===r)return h;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const c=new Bse(this,o,i,r);return this._bindAction(c,u),this._addInactiveAction(c,a,s),c}existingAction(e,i){const r=i||this._root,n=r.uuid,s=typeof e=="string"?A0.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[n]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let r=i-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const i=this._actions,r=this._nActiveActions,n=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==r;++u)i[u]._update(n,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,r=e.uuid,n=this._actionsByClip,s=n[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const c=u._cacheIndex,h=i[i.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,h._cacheIndex=c,i[c]=h,i.pop(),this._removeInactiveBindingsForAction(u)}delete n[r]}}uncacheRoot(e){const i=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[i];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const n=this._bindingsByRootAndName,s=n[i];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,i){const r=this.existingAction(e,i);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class f5{constructor(e){this.value=e}clone(){return new f5(this.value.clone===void 0?this.value:this.value.clone())}}let e6e=0;class t6e extends hd{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:e6e++}),this.name="",this.usage=M1,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let r=0,n=i.length;r<n;r++){const s=Array.isArray(i[r])?i[r]:[i[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class i6e extends g_{constructor(e,i,r=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class r6e{constructor(e,i,r,n,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=r,this.elementSize=n,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class Ose{constructor(e,i,r=0,n=1/0){this.ray=new ib(e,i),this.near=r,this.far=n,this.camera=null,this.layers=new Sm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,r=[]){return eN(e,this,r,i),r.sort(UX),r}intersectObjects(e,i=!0,r=[]){for(let n=0,s=e.length;n<s;n++)eN(e[n],this,r,i);return r.sort(UX),r}}function UX(t,e){return t.distance-e.distance}function eN(t,e,i,r){if(t.layers.test(e.layers)&&t.raycast(e,i),r===!0){const n=t.children;for(let s=0,o=n.length;s<o;s++)eN(n[s],e,i,!0)}}class n6e{constructor(e=1,i=0,r=0){return this.radius=e,this.phi=i,this.theta=r,this}set(e,i,r){return this.radius=e,this.phi=i,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,r){return this.radius=Math.sqrt(e*e+i*i+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(un(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class s6e{constructor(e=1,i=0,r=0){return this.radius=e,this.theta=i,this.y=r,this}set(e,i,r){return this.radius=e,this.theta=i,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=i,this}clone(){return new this.constructor().copy(this)}}const NX=new ot;class o6e{constructor(e=new ot(1/0,1/0),i=new ot(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,r=e.length;i<r;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const r=NX.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,NX).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const FX=new ue,$E=new ue;class a6e{constructor(e=new ue,i=new ue){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){FX.subVectors(e,this.start),$E.subVectors(this.end,this.start);const r=$E.dot($E);let s=$E.dot(FX)/r;return i&&(s=un(s,0,1)),s}closestPointToPoint(e,i,r){const n=this.closestPointToPointParameter(e,i);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const zX=new ue;class l6e extends Hi{constructor(e,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const r=new bi,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,c=a/l*Math.PI*2;n.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new Ft(n,3));const s=new wo({fog:!1,toneMapped:!1});this.cone=new Bu(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),zX.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(zX),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Vd=new ue,eM=new ii,PI=new ii;class u6e extends Bu{constructor(e){const i=Use(e),r=new bi,n=[],s=[],o=new St(0,0,1),a=new St(0,1,0);for(let u=0;u<i.length;u++){const c=i[u];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Ft(n,3)),r.setAttribute("color",new Ft(s,3));const l=new wo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,r=this.geometry,n=r.getAttribute("position");PI.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<i.length;s++){const a=i[s];a.parent&&a.parent.isBone&&(eM.multiplyMatrices(PI,a.matrixWorld),Vd.setFromMatrixPosition(eM),n.setXYZ(o,Vd.x,Vd.y,Vd.z),eM.multiplyMatrices(PI,a.parent.matrixWorld),Vd.setFromMatrixPosition(eM),n.setXYZ(o+1,Vd.x,Vd.y,Vd.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Use(t){const e=[];t.isBone===!0&&e.push(t);for(let i=0;i<t.children.length;i++)e.push.apply(e,Use(t.children[i]));return e}class h6e extends _n{constructor(e,i,r){const n=new x_(i,4,2),s=new Ga({wireframe:!0,fog:!1,toneMapped:!1});super(n,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const c6e=new ue,HX=new St,GX=new St;class d6e extends Hi{constructor(e,i,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const n=new b_(i);n.rotateY(Math.PI*.5),this.material=new Ga({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=n.getAttribute("position"),o=new Float32Array(s.count*3);n.setAttribute("color",new Gi(o,3)),this.add(new _n(n,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");HX.copy(this.light.color),GX.copy(this.light.groundColor);for(let r=0,n=i.count;r<n;r++){const s=r<n/2?HX:GX;i.setXYZ(r,s.r,s.g,s.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(c6e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class p6e extends Bu{constructor(e=10,i=10,r=4473924,n=8947848){r=new St(r),n=new St(n);const s=i/2,o=e/i,a=e/2,l=[],u=[];for(let d=0,p=0,f=-a;d<=i;d++,f+=o){l.push(-a,0,f,a,0,f),l.push(f,0,-a,f,0,a);const m=d===s?r:n;m.toArray(u,p),p+=3,m.toArray(u,p),p+=3,m.toArray(u,p),p+=3,m.toArray(u,p),p+=3}const c=new bi;c.setAttribute("position",new Ft(l,3)),c.setAttribute("color",new Ft(u,3));const h=new wo({vertexColors:!0,toneMapped:!1});super(c,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class f6e extends Bu{constructor(e=10,i=16,r=8,n=64,s=4473924,o=8947848){s=new St(s),o=new St(o);const a=[],l=[];if(i>1)for(let h=0;h<i;h++){const d=h/i*(Math.PI*2),p=Math.sin(d)*e,f=Math.cos(d)*e;a.push(0,0,0),a.push(p,0,f);const m=h&1?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let h=0;h<r;h++){const d=h&1?s:o,p=e-e/r*h;for(let f=0;f<n;f++){let m=f/n*(Math.PI*2),g=Math.sin(m)*p,y=Math.cos(m)*p;a.push(g,0,y),l.push(d.r,d.g,d.b),m=(f+1)/n*(Math.PI*2),g=Math.sin(m)*p,y=Math.cos(m)*p,a.push(g,0,y),l.push(d.r,d.g,d.b)}}const u=new bi;u.setAttribute("position",new Ft(a,3)),u.setAttribute("color",new Ft(l,3));const c=new wo({vertexColors:!0,toneMapped:!1});super(u,c),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const VX=new ue,tM=new ue,jX=new ue;class m6e extends Hi{constructor(e,i,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",i===void 0&&(i=1);let n=new bi;n.setAttribute("position",new Ft([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const s=new wo({fog:!1,toneMapped:!1});this.lightPlane=new sd(n,s),this.add(this.lightPlane),n=new bi,n.setAttribute("position",new Ft([0,0,0,0,0,1],3)),this.targetLine=new sd(n,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),VX.setFromMatrixPosition(this.light.matrixWorld),tM.setFromMatrixPosition(this.light.target.matrixWorld),jX.subVectors(tM,VX),this.lightPlane.lookAt(tM),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(tM),this.targetLine.scale.z=jX.length()}}const iM=new ue,Zr=new p_;class g6e extends Bu{constructor(e){const i=new bi,r=new wo({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(f,m){l(f),l(m)}function l(f){n.push(0,0,0),s.push(0,0,0),o[f]===void 0&&(o[f]=[]),o[f].push(n.length/3-1)}i.setAttribute("position",new Ft(n,3)),i.setAttribute("color",new Ft(s,3)),super(i,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new St(16755200),c=new St(16711680),h=new St(43775),d=new St(16777215),p=new St(3355443);this.setColors(u,c,h,d,p)}setColors(e,i,r,n,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,i.r,i.g,i.b),a.setXYZ(25,i.r,i.g,i.b),a.setXYZ(26,i.r,i.g,i.b),a.setXYZ(27,i.r,i.g,i.b),a.setXYZ(28,i.r,i.g,i.b),a.setXYZ(29,i.r,i.g,i.b),a.setXYZ(30,i.r,i.g,i.b),a.setXYZ(31,i.r,i.g,i.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,n.r,n.g,n.b),a.setXYZ(39,n.r,n.g,n.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,r=1,n=1;Zr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),yn("c",i,e,Zr,0,0,-1),yn("t",i,e,Zr,0,0,1),yn("n1",i,e,Zr,-r,-n,-1),yn("n2",i,e,Zr,r,-n,-1),yn("n3",i,e,Zr,-r,n,-1),yn("n4",i,e,Zr,r,n,-1),yn("f1",i,e,Zr,-r,-n,1),yn("f2",i,e,Zr,r,-n,1),yn("f3",i,e,Zr,-r,n,1),yn("f4",i,e,Zr,r,n,1),yn("u1",i,e,Zr,r*.7,n*1.1,-1),yn("u2",i,e,Zr,-r*.7,n*1.1,-1),yn("u3",i,e,Zr,0,n*2,-1),yn("cf1",i,e,Zr,-r,0,1),yn("cf2",i,e,Zr,r,0,1),yn("cf3",i,e,Zr,0,-n,1),yn("cf4",i,e,Zr,0,n,1),yn("cn1",i,e,Zr,-r,0,-1),yn("cn2",i,e,Zr,r,0,-1),yn("cn3",i,e,Zr,0,-n,-1),yn("cn4",i,e,Zr,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function yn(t,e,i,r,n,s,o){iM.set(n,s,o).unproject(r);const a=e[t];if(a!==void 0){const l=i.getAttribute("position");for(let u=0,c=a.length;u<c;u++)l.setXYZ(a[u],iM.x,iM.y,iM.z)}}const rM=new yo;class y6e extends Bu{constructor(e,i=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(8*3),s=new bi;s.setIndex(new Gi(r,1)),s.setAttribute("position",new Gi(n,3)),super(s,new wo({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&rM.setFromObject(this.object),rM.isEmpty())return;const i=rM.min,r=rM.max,n=this.geometry.attributes.position,s=n.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=i.x,s[4]=r.y,s[5]=r.z,s[6]=i.x,s[7]=i.y,s[8]=r.z,s[9]=r.x,s[10]=i.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=i.z,s[15]=i.x,s[16]=r.y,s[17]=i.z,s[18]=i.x,s[19]=i.y,s[20]=i.z,s[21]=r.x,s[22]=i.y,s[23]=i.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class v6e extends Bu{constructor(e,i=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new bi;s.setIndex(new Gi(r,1)),s.setAttribute("position",new Ft(n,3)),super(s,new wo({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class b6e extends sd{constructor(e,i=1,r=16776960){const n=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new bi;o.setAttribute("position",new Ft(s,3)),o.computeBoundingSphere(),super(o,new wo({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new bi;l.setAttribute("position",new Ft(a,3)),l.computeBoundingSphere(),this.add(new _n(l,new Ga({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const WX=new ue;let nM,TI;class x6e extends Hi{constructor(e=new ue(0,0,1),i=new ue(0,0,0),r=1,n=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",nM===void 0&&(nM=new bi,nM.setAttribute("position",new Ft([0,0,0,0,1,0],3)),TI=new sb(0,.5,1,5,1),TI.translate(0,-.5,0)),this.position.copy(i),this.line=new sd(nM,new wo({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new _n(TI,new Ga({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{WX.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(WX,i)}}setLength(e,i=e*.2,r=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(r,i,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class w6e extends Bu{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new bi;n.setAttribute("position",new Ft(i,3)),n.setAttribute("color",new Ft(r,3));const s=new wo({vertexColors:!0,toneMapped:!1});super(n,s),this.type="AxesHelper"}setColors(e,i,r){const n=new St,s=this.geometry.attributes.color.array;return n.set(e),n.toArray(s,0),n.toArray(s,3),n.set(i),n.toArray(s,6),n.toArray(s,9),n.set(r),n.toArray(s,12),n.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class _6e{constructor(){this.type="ShapePath",this.color=new St,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new T1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,r,n){return this.currentPath.quadraticCurveTo(e,i,r,n),this}bezierCurveTo(e,i,r,n,s,o){return this.currentPath.bezierCurveTo(e,i,r,n,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(y){const v=[];for(let b=0,_=y.length;b<_;b++){const A=y[b],S=new Em;S.curves=A.curves,v.push(S)}return v}function r(y,v){const b=v.length;let _=!1;for(let A=b-1,S=0;S<b;A=S++){let E=v[A],M=v[S],R=M.x-E.x,C=M.y-E.y;if(Math.abs(C)>Number.EPSILON){if(C<0&&(E=v[S],R=-R,M=v[A],C=-C),y.y<E.y||y.y>M.y)continue;if(y.y===E.y){if(y.x===E.x)return!0}else{const T=C*(y.x-E.x)-R*(y.y-E.y);if(T===0)return!0;if(T<0)continue;_=!_}}else{if(y.y!==E.y)continue;if(M.x<=y.x&&y.x<=E.x||E.x<=y.x&&y.x<=M.x)return!0}}return _}const n=Dh.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new Em,l.curves=a.curves,u.push(l),u;let c=!n(s[0].getPoints());c=e?!c:c;const h=[],d=[];let p=[],f=0,m;d[f]=void 0,p[f]=[];for(let y=0,v=s.length;y<v;y++)a=s[y],m=a.getPoints(),o=n(m),o=e?!o:o,o?(!c&&d[f]&&f++,d[f]={s:new Em,p:m},d[f].s.curves=a.curves,c&&f++,p[f]=[]):p[f].push({h:a,p:m[0]});if(!d[0])return i(s);if(d.length>1){let y=!1,v=0;for(let b=0,_=d.length;b<_;b++)h[b]=[];for(let b=0,_=d.length;b<_;b++){const A=p[b];for(let S=0;S<A.length;S++){const E=A[S];let M=!0;for(let R=0;R<d.length;R++)r(E.p,d[R].p)&&(b!==R&&v++,M?(M=!1,h[R].push(E)):y=!0);M&&h[b].push(E)}}v>0&&y===!1&&(p=h)}let g;for(let y=0,v=d.length;y<v;y++){l=d[y].s,u.push(l),g=p[y];for(let b=0,_=g.length;b<_;b++)l.holes.push(g[b].h)}return u}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:u_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=u_);const S6e=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:S4,AddEquation:rp,AddOperation:rne,AdditiveAnimationBlendMode:k4,AdditiveBlending:fU,AgXToneMapping:lne,AlphaFormat:dne,AlwaysCompare:kne,AlwaysDepth:Jre,AlwaysStencilFunc:WU,AmbientLight:Mse,AnimationAction:Bse,AnimationClip:A0,AnimationLoader:Mje,AnimationMixer:$je,AnimationObjectGroup:Qje,AnimationUtils:_je,ArcCurve:ese,ArrayCamera:Yne,ArrowHelper:x6e,AttachedBindMode:bU,Audio:Ise,AudioAnalyser:Hje,AudioContext:h5,AudioListener:Nje,AudioLoader:Bje,AxesHelper:w6e,BackSide:jo,BasicDepthPacking:_ne,BasicShadowMap:Dre,BatchedMesh:$ne,Bone:cT,BooleanKeyframeTrack:ug,Box2:o6e,Box3:yo,Box3Helper:v6e,BoxGeometry:lg,BoxHelper:y6e,BufferAttribute:Gi,BufferGeometry:bi,BufferGeometryLoader:kse,ByteType:hne,Cache:Vc,Camera:p_,CameraHelper:g6e,CanvasTexture:qVe,CapsuleGeometry:mT,CatmullRomCurve3:tse,CineonToneMapping:one,CircleGeometry:gT,ClampToEdgeWrapping:Hs,Clock:c5,Color:St,ColorKeyframeTrack:n5,ColorManagement:or,CompressedArrayTexture:jVe,CompressedCubeTexture:WVe,CompressedTexture:pT,CompressedTextureLoader:Cje,ConeGeometry:yT,ConstantAlphaFactor:Xre,ConstantColorFactor:Wre,CubeCamera:Fne,CubeReflectionMapping:nd,CubeRefractionMapping:zp,CubeTexture:f_,CubeTextureLoader:Pje,CubeUVReflectionMapping:tb,CubicBezierCurve:Q4,CubicBezierCurve3:ise,CubicInterpolant:xse,CullFaceBack:pU,CullFaceFront:kre,CullFaceFrontBack:BFe,CullFaceNone:Rre,Curve:Ou,CurvePath:nse,CustomBlending:Ire,CustomToneMapping:ane,CylinderGeometry:sb,Cylindrical:s6e,Data3DTexture:U4,DataArrayTexture:aT,DataTexture:Am,DataTextureLoader:Tje,DataUtils:zze,DecrementStencilOp:VFe,DecrementWrapStencilOp:WFe,DefaultLoadingManager:Sse,DepthFormat:Dp,DepthStencilFormat:Hm,DepthTexture:H4,DetachedBindMode:une,DirectionalLight:u5,DirectionalLightHelper:m6e,DiscreteInterpolant:wse,DisplayP3ColorSpace:oT,DodecahedronGeometry:vT,DoubleSide:Tl,DstAlphaFactor:zre,DstColorFactor:Gre,DynamicCopyUsage:oze,DynamicDrawUsage:eze,DynamicReadUsage:rze,EdgesGeometry:sse,EllipseCurve:fT,EqualCompare:Cne,EqualDepth:Zre,EqualStencilFunc:KFe,EquirectangularReflectionMapping:b1,EquirectangularRefractionMapping:x1,Euler:d_,EventDispatcher:hd,ExtrudeGeometry:xT,FileLoader:Ja,Float16BufferAttribute:qze,Float32BufferAttribute:Ft,Float64BufferAttribute:Xze,FloatType:Rl,Fog:hT,FogExp2:uT,FramebufferTexture:VVe,FrontSide:zh,Frustum:m_,GLBufferAttribute:r6e,GLSL1:lze,GLSL3:qU,GreaterCompare:Pne,GreaterDepth:ene,GreaterEqualCompare:Rne,GreaterEqualDepth:$re,GreaterEqualStencilFunc:$Fe,GreaterStencilFunc:QFe,GridHelper:p6e,Group:Gc,HalfFloatType:y0,HemisphereLight:Ese,HemisphereLightHelper:d6e,IcosahedronGeometry:wT,ImageBitmapLoader:Dse,ImageLoader:I1,ImageUtils:O4,IncrementStencilOp:GFe,IncrementWrapStencilOp:jFe,InstancedBufferAttribute:w0,InstancedBufferGeometry:Rse,InstancedInterleavedBuffer:i6e,InstancedMesh:X4,Int16BufferAttribute:jze,Int32BufferAttribute:Wze,Int8BufferAttribute:Hze,IntType:A4,InterleavedBuffer:g_,InterleavedBufferAttribute:Gp,Interpolant:ob,InterpolateDiscrete:v0,InterpolateLinear:Gm,InterpolateSmooth:sC,InvertStencilOp:qFe,KeepStencilOp:Of,KeyframeTrack:Uu,LOD:Zne,LatheGeometry:v_,Layers:Sm,LessCompare:Mne,LessDepth:Qre,LessEqualCompare:L4,LessEqualDepth:v1,LessEqualStencilFunc:JFe,LessStencilFunc:YFe,Light:$p,LightProbe:Tse,Line:sd,Line3:a6e,LineBasicMaterial:wo,LineCurve:Z4,LineCurve3:rse,LineDashedMaterial:yse,LineLoop:Y4,LineSegments:Bu,LinearDisplayP3ColorSpace:c_,LinearEncoding:I4,LinearFilter:Rr,LinearInterpolant:r5,LinearMipMapLinearFilter:FFe,LinearMipMapNearestFilter:NFe,LinearMipmapLinearFilter:Il,LinearMipmapNearestFilter:Hv,LinearSRGBColorSpace:Hh,LinearToneMapping:nne,LinearTransfer:S1,Loader:_o,LoaderUtils:Ih,LoadingManager:s5,LoopOnce:vne,LoopPingPong:xne,LoopRepeat:bne,LuminanceAlphaFormat:fne,LuminanceFormat:pne,MOUSE:IFe,Material:jn,MaterialLoader:PT,MathUtils:Dne,Matrix3:Ei,Matrix4:ii,MaxEquation:vU,Mesh:_n,MeshBasicMaterial:Ga,MeshDepthMaterial:G4,MeshDistanceMaterial:V4,MeshLambertMaterial:mse,MeshMatcapMaterial:gse,MeshNormalMaterial:fse,MeshPhongMaterial:dse,MeshPhysicalMaterial:Xh,MeshStandardMaterial:w_,MeshToonMaterial:pse,MinEquation:yU,MirroredRepeatWrapping:g0,MixOperation:ine,MultiplyBlending:gU,MultiplyOperation:h_,NearestFilter:an,NearestMipMapLinearFilter:UFe,NearestMipMapNearestFilter:OFe,NearestMipmapLinearFilter:np,NearestMipmapNearestFilter:w1,NeverCompare:Ene,NeverDepth:Kre,NeverStencilFunc:XFe,NoBlending:Kc,NoColorSpace:Oa,NoToneMapping:Rh,NormalAnimationBlendMode:sT,NormalBlending:xm,NotEqualCompare:Tne,NotEqualDepth:tne,NotEqualStencilFunc:ZFe,NumberKeyframeTrack:_0,Object3D:Hi,ObjectLoader:Ije,ObjectSpaceNormalMap:Ane,OctahedronGeometry:b_,OneFactor:Ure,OneMinusConstantAlphaFactor:Yre,OneMinusConstantColorFactor:qre,OneMinusDstAlphaFactor:Hre,OneMinusDstColorFactor:Vre,OneMinusSrcAlphaFactor:Z2,OneMinusSrcColorFactor:Fre,OrthographicCamera:Qp,P3Primaries:E1,PCFShadowMap:iT,PCFSoftShadowMap:vw,PMREMGenerator:YU,Path:T1,PerspectiveCamera:xn,Plane:Yd,PlaneGeometry:rb,PlaneHelper:b6e,PointLight:l5,PointLightHelper:h6e,Points:K4,PointsMaterial:dT,PolarGridHelper:f6e,PolyhedronGeometry:Zp,PositionalAudio:zje,PropertyBinding:zi,PropertyMixer:Lse,QuadraticBezierCurve:$4,QuadraticBezierCurve3:e5,Quaternion:go,QuaternionKeyframeTrack:Vp,QuaternionLinearInterpolant:_se,RED_GREEN_RGTC2_Format:VU,RED_RGTC1_Format:yne,REVISION:u_,RGBADepthPacking:Sne,RGBAFormat:Fo,RGBAIntegerFormat:T4,RGBA_ASTC_10x10_Format:UU,RGBA_ASTC_10x5_Format:LU,RGBA_ASTC_10x6_Format:BU,RGBA_ASTC_10x8_Format:OU,RGBA_ASTC_12x10_Format:NU,RGBA_ASTC_12x12_Format:FU,RGBA_ASTC_4x4_Format:MU,RGBA_ASTC_5x4_Format:CU,RGBA_ASTC_5x5_Format:PU,RGBA_ASTC_6x5_Format:TU,RGBA_ASTC_6x6_Format:RU,RGBA_ASTC_8x5_Format:kU,RGBA_ASTC_8x6_Format:DU,RGBA_ASTC_8x8_Format:IU,RGBA_BPTC_Format:nC,RGBA_ETC2_EAC_Format:EU,RGBA_PVRTC_2BPPV1_Format:SU,RGBA_PVRTC_4BPPV1_Format:_U,RGBA_S3TC_DXT1_Format:tC,RGBA_S3TC_DXT3_Format:iC,RGBA_S3TC_DXT5_Format:rC,RGB_BPTC_SIGNED_Format:zU,RGB_BPTC_UNSIGNED_Format:HU,RGB_ETC1_Format:R4,RGB_ETC2_Format:AU,RGB_PVRTC_2BPPV1_Format:wU,RGB_PVRTC_4BPPV1_Format:xU,RGB_S3TC_DXT1_Format:eC,RGFormat:gne,RGIntegerFormat:P4,RawShaderMaterial:cse,Ray:ib,Raycaster:Ose,Rec709Primaries:A1,RectAreaLight:Cse,RedFormat:mne,RedIntegerFormat:C4,ReinhardToneMapping:sne,RenderTarget:Bne,RepeatWrapping:Hp,ReplaceStencilOp:HFe,ReverseSubtractEquation:Bre,RingGeometry:_T,SIGNED_RED_GREEN_RGTC2_Format:jU,SIGNED_RED_RGTC1_Format:GU,SRGBColorSpace:es,SRGBTransfer:_r,Scene:iP,ShaderChunk:_i,ShaderLib:pu,ShaderMaterial:Ru,ShadowMaterial:hse,Shape:Em,ShapeGeometry:ST,ShapePath:_6e,ShapeUtils:Dh,ShortType:cne,Skeleton:y_,SkeletonHelper:u6e,SkinnedMesh:q4,Source:sm,Sphere:qs,SphereGeometry:x_,Spherical:n6e,SphericalHarmonics3:Pse,SplineCurve:t5,SpotLight:a5,SpotLightHelper:l6e,Sprite:Qne,SpriteMaterial:W4,SrcAlphaFactor:Q2,SrcAlphaSaturateFactor:jre,SrcColorFactor:Nre,StaticCopyUsage:sze,StaticDrawUsage:M1,StaticReadUsage:ize,StereoCamera:Oje,StreamCopyUsage:aze,StreamDrawUsage:tze,StreamReadUsage:nze,StringKeyframeTrack:hg,SubtractEquation:Lre,SubtractiveBlending:mU,TOUCH:LFe,TangentSpaceNormalMap:Jp,TetrahedronGeometry:AT,Texture:Ir,TextureLoader:Ase,TorusGeometry:ET,TorusKnotGeometry:MT,Triangle:Ua,TriangleFanDrawMode:$2,TriangleStripDrawMode:D4,TrianglesDrawMode:wne,TubeGeometry:CT,UVMapping:rT,Uint16BufferAttribute:N4,Uint32BufferAttribute:F4,Uint8BufferAttribute:Gze,Uint8ClampedBufferAttribute:Vze,Uniform:f5,UniformsGroup:t6e,UniformsLib:wt,UniformsUtils:Nne,UnsignedByteType:kh,UnsignedInt248Type:kp,UnsignedIntType:Hc,UnsignedShort4444Type:E4,UnsignedShort5551Type:M4,UnsignedShortType:nT,VSMShadowMap:lu,Vector2:ot,Vector3:ue,Vector4:lr,VectorKeyframeTrack:S0,VideoTexture:GVe,WebGL1Renderer:Kne,WebGL3DRenderTarget:Pze,WebGLArrayRenderTarget:Cze,WebGLCoordinateSystem:Sh,WebGLCubeRenderTarget:zne,WebGLMultipleRenderTargets:Tze,WebGLRenderTarget:Tu,WebGLRenderer:j4,WebGLUtils:Xne,WebGPUCoordinateSystem:C1,WireframeGeometry:use,WrapAroundEnding:_1,ZeroCurvatureEnding:rm,ZeroFactor:Ore,ZeroSlopeEnding:nm,ZeroStencilOp:zFe,_SRGBAFormat:eP,createCanvasElement:Lne,sRGBEncoding:Ip},Symbol.toStringTag,{value:"Module"}));var Nse={exports:{}},cg={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */cg.ConcurrentRoot=1;cg.ContinuousEventPriority=4;cg.DefaultEventPriority=16;cg.DiscreteEventPriority=1;cg.IdleEventPriority=536870912;cg.LegacyRoot=0;Nse.exports=cg;var gv=Nse.exports;function A6e(t){let e;const i=new Set,r=(u,c)=>{const h=typeof u=="function"?u(e):u;if(h!==e){const d=e;e=c?h:Object.assign({},e,h),i.forEach(p=>p(e,d))}},n=()=>e,s=(u,c=n,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=c(e);function p(){const f=c(e);if(!h(d,f)){const m=d;u(d=f,m)}}return i.add(p),()=>i.delete(p)},l={setState:r,getState:n,subscribe:(u,c,h)=>c||h?s(u,c,h):(i.add(u),()=>i.delete(u)),destroy:()=>i.clear()};return e=t(r,n,l),l}const E6e=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),qX=E6e?se.useEffect:se.useLayoutEffect;function M6e(t){const e=typeof t=="function"?A6e(t):t,i=(r=e.getState,n=Object.is)=>{const[,s]=se.useReducer(g=>g+1,0),o=e.getState(),a=se.useRef(o),l=se.useRef(r),u=se.useRef(n),c=se.useRef(!1),h=se.useRef();h.current===void 0&&(h.current=r(o));let d,p=!1;(a.current!==o||l.current!==r||u.current!==n||c.current)&&(d=r(o),p=!n(h.current,d)),qX(()=>{p&&(h.current=d),a.current=o,l.current=r,u.current=n,c.current=!1});const f=se.useRef(o);qX(()=>{const g=()=>{try{const v=e.getState(),b=l.current(v);u.current(h.current,b)||(a.current=v,h.current=b,s())}catch{c.current=!0,s()}},y=e.subscribe(g);return e.getState()!==f.current&&g(),y},[]);const m=p?d:h.current;return se.useDebugValue(m),m};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[i,e];return{next(){const n=r.length<=0;return{value:r.shift(),done:n}}}},i}var Fse={exports:{}},zse={exports:{}},Hse={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,j){var V=B.length;B.push(j);e:for(;0<V;){var q=V-1>>>1,K=B[q];if(0<n(K,j))B[q]=j,B[V]=K,V=q;else break e}}function i(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var j=B[0],V=B.pop();if(V!==j){B[0]=V;e:for(var q=0,K=B.length,le=K>>>1;q<le;){var Z=2*(q+1)-1,oe=B[Z],ae=Z+1,ve=B[ae];if(0>n(oe,V))ae<K&&0>n(ve,oe)?(B[q]=ve,B[ae]=V,q=ae):(B[q]=oe,B[Z]=V,q=Z);else if(ae<K&&0>n(ve,V))B[q]=ve,B[ae]=V,q=ae;else break e}}return j}function n(B,j){var V=B.sortIndex-j.sortIndex;return V!==0?V:B.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,p=!1,f=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(B){for(var j=i(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=B)r(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=i(u)}}function _(B){if(m=!1,b(B),!f)if(i(l)!==null)f=!0,H(A);else{var j=i(u);j!==null&&z(_,j.startTime-B)}}function A(B,j){f=!1,m&&(m=!1,y(M),M=-1),p=!0;var V=d;try{for(b(j),h=i(l);h!==null&&(!(h.expirationTime>j)||B&&!T());){var q=h.callback;if(typeof q=="function"){h.callback=null,d=h.priorityLevel;var K=q(h.expirationTime<=j);j=t.unstable_now(),typeof K=="function"?h.callback=K:h===i(l)&&r(l),b(j)}else r(l);h=i(l)}if(h!==null)var le=!0;else{var Z=i(u);Z!==null&&z(_,Z.startTime-j),le=!1}return le}finally{h=null,d=V,p=!1}}var S=!1,E=null,M=-1,R=5,C=-1;function T(){return!(t.unstable_now()-C<R)}function L(){if(E!==null){var B=t.unstable_now();C=B;var j=!0;try{j=E(!0,B)}finally{j?I():(S=!1,E=null)}}else S=!1}var I;if(typeof v=="function")I=function(){v(L)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,F=D.port2;D.port1.onmessage=L,I=function(){F.postMessage(null)}}else I=function(){g(L,0)};function H(B){E=B,S||(S=!0,I())}function z(B,j){M=g(function(){B(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,H(A))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(B){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var V=d;d=j;try{return B()}finally{d=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,j){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var V=d;d=B;try{return j()}finally{d=V}},t.unstable_scheduleCallback=function(B,j,V){var q=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?q+V:q):V=q,B){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=V+K,B={id:c++,callback:j,priorityLevel:B,startTime:V,expirationTime:K,sortIndex:-1},V>q?(B.sortIndex=V,e(u,B),i(l)===null&&B===i(u)&&(m?(y(M),M=-1):m=!0,z(_,V-q))):(B.sortIndex=K,e(l,B),f||p||(f=!0,H(A))),B},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(B){var j=d;return function(){var V=d;d=j;try{return B.apply(this,arguments)}finally{d=V}}}})(Hse);zse.exports=Hse;var tN=zse.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C6e=function(e){var i={},r=se,n=tN,s=Object.assign;function o(x){for(var w="https://reactjs.org/docs/error-decoder.html?invariant="+x,P=1;P<arguments.length;P++)w+="&args[]="+encodeURIComponent(arguments[P]);return"Minified React error #"+x+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),A=Symbol.iterator;function S(x){return x===null||typeof x!="object"?null:(x=A&&x[A]||x["@@iterator"],typeof x=="function"?x:null)}function E(x){if(x==null)return null;if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case c:return"Fragment";case u:return"Portal";case d:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case y:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case f:return(x.displayName||"Context")+".Consumer";case p:return(x._context.displayName||"Context")+".Provider";case m:var w=x.render;return x=x.displayName,x||(x=w.displayName||w.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case v:return w=x.displayName||null,w!==null?w:E(x.type)||"Memo";case b:w=x._payload,x=x._init;try{return E(x(w))}catch{}}return null}function M(x){var w=x.type;switch(x.tag){case 24:return"Cache";case 9:return(w.displayName||"Context")+".Consumer";case 10:return(w._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return x=w.render,x=x.displayName||x.name||"",w.displayName||(x!==""?"ForwardRef("+x+")":"ForwardRef");case 7:return"Fragment";case 5:return w;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return E(w);case 8:return w===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w}return null}function R(x){var w=x,P=x;if(x.alternate)for(;w.return;)w=w.return;else{x=w;do w=x,w.flags&4098&&(P=w.return),x=w.return;while(x)}return w.tag===3?P:null}function C(x){if(R(x)!==x)throw Error(o(188))}function T(x){var w=x.alternate;if(!w){if(w=R(x),w===null)throw Error(o(188));return w!==x?null:x}for(var P=x,k=w;;){var O=P.return;if(O===null)break;var G=O.alternate;if(G===null){if(k=O.return,k!==null){P=k;continue}break}if(O.child===G.child){for(G=O.child;G;){if(G===P)return C(O),x;if(G===k)return C(O),w;G=G.sibling}throw Error(o(188))}if(P.return!==k.return)P=O,k=G;else{for(var de=!1,Te=O.child;Te;){if(Te===P){de=!0,P=O,k=G;break}if(Te===k){de=!0,k=O,P=G;break}Te=Te.sibling}if(!de){for(Te=G.child;Te;){if(Te===P){de=!0,P=G,k=O;break}if(Te===k){de=!0,k=G,P=O;break}Te=Te.sibling}if(!de)throw Error(o(189))}}if(P.alternate!==k)throw Error(o(190))}if(P.tag!==3)throw Error(o(188));return P.stateNode.current===P?x:w}function L(x){return x=T(x),x!==null?I(x):null}function I(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){var w=I(x);if(w!==null)return w;x=x.sibling}return null}function D(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){if(x.tag!==4){var w=D(x);if(w!==null)return w}x=x.sibling}return null}var F=Array.isArray,H=e.getPublicInstance,z=e.getRootHostContext,B=e.getChildHostContext,j=e.prepareForCommit,V=e.resetAfterCommit,q=e.createInstance,K=e.appendInitialChild,le=e.finalizeInitialChildren,Z=e.prepareUpdate,oe=e.shouldSetTextContent,ae=e.createTextInstance,ve=e.scheduleTimeout,ye=e.cancelTimeout,pe=e.noTimeout,Se=e.isPrimaryRenderer,be=e.supportsMutation,ee=e.supportsPersistence,_e=e.supportsHydration,Me=e.getInstanceFromNode,Ce=e.preparePortalMount,Re=e.getCurrentEventPriority,Xe=e.detachDeletedInstance,Oe=e.supportsMicrotasks,$=e.scheduleMicrotask,J=e.supportsTestSelectors,we=e.findFiberRoot,te=e.getBoundingRect,Y=e.getTextContent,ce=e.isHiddenSubtree,Le=e.matchAccessibilityRole,X=e.setFocusIfFocusable,Ue=e.setupIntersectionObserver,et=e.appendChild,ze=e.appendChildToContainer,ge=e.commitTextUpdate,ct=e.commitMount,rt=e.commitUpdate,ut=e.insertBefore,ht=e.insertInContainerBefore,tt=e.removeChild,pt=e.removeChildFromContainer,Nt=e.resetTextContent,ti=e.hideInstance,xe=e.hideTextInstance,Ge=e.unhideInstance,ie=e.unhideTextInstance,He=e.clearContainer,Ye=e.cloneInstance,dt=e.createContainerChildSet,At=e.appendChildToContainerChildSet,ri=e.finalizeContainerChildren,Si=e.replaceContainerChildren,li=e.cloneHiddenInstance,yr=e.cloneHiddenTextInstance,gi=e.canHydrateInstance,Br=e.canHydrateTextInstance,Ks=e.canHydrateSuspenseInstance,Kh=e.isSuspenseInstancePending,Vl=e.isSuspenseInstanceFallback,he=e.registerSuspenseInstanceRetry,Ve=e.getNextHydratableSibling,Qe=e.getFirstHydratableChild,Ne=e.getFirstHydratableChildWithinContainer,$e=e.getFirstHydratableChildWithinSuspenseInstance,Lt=e.hydrateInstance,oi=e.hydrateTextInstance,hi=e.hydrateSuspenseInstance,ne=e.getNextHydratableInstanceAfterSuspenseInstance,Pe=e.commitHydratedContainer,De=e.commitHydratedSuspenseInstance,Be=e.clearSuspenseBoundary,ke=e.clearSuspenseBoundaryFromContainer,gt=e.shouldDeleteUnhydratedTailInstances,Rt=e.didNotMatchHydratedContainerTextInstance,zt=e.didNotMatchHydratedTextInstance,Mt;function bt(x){if(Mt===void 0)try{throw Error()}catch(P){var w=P.stack.trim().match(/\n( *(at )?)/);Mt=w&&w[1]||""}return`
`+Mt+x}var Gt=!1;function yt(x,w){if(!x||Gt)return"";Gt=!0;var P=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(w)if(w=function(){throw Error()},Object.defineProperty(w.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(w,[])}catch(mt){var k=mt}Reflect.construct(x,[],w)}else{try{w.call()}catch(mt){k=mt}x.call(w.prototype)}else{try{throw Error()}catch(mt){k=mt}x()}}catch(mt){if(mt&&k&&typeof mt.stack=="string"){for(var O=mt.stack.split(`
`),G=k.stack.split(`
`),de=O.length-1,Te=G.length-1;1<=de&&0<=Te&&O[de]!==G[Te];)Te--;for(;1<=de&&0<=Te;de--,Te--)if(O[de]!==G[Te]){if(de!==1||Te!==1)do if(de--,Te--,0>Te||O[de]!==G[Te]){var Ze=`
`+O[de].replace(" at new "," at ");return x.displayName&&Ze.includes("<anonymous>")&&(Ze=Ze.replace("<anonymous>",x.displayName)),Ze}while(1<=de&&0<=Te);break}}}finally{Gt=!1,Error.prepareStackTrace=P}return(x=x?x.displayName||x.name:"")?bt(x):""}var Vi=Object.prototype.hasOwnProperty,Er=[],Ni=-1;function rr(x){return{current:x}}function W(x){0>Ni||(x.current=Er[Ni],Er[Ni]=null,Ni--)}function Q(x,w){Ni++,Er[Ni]=x.current,x.current=w}var fe={},re=rr(fe),Ae=rr(!1),at=fe;function Yr(x,w){var P=x.type.contextTypes;if(!P)return fe;var k=x.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===w)return k.__reactInternalMemoizedMaskedChildContext;var O={},G;for(G in P)O[G]=w[G];return k&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=w,x.__reactInternalMemoizedMaskedChildContext=O),O}function Kr(x){return x=x.childContextTypes,x!=null}function xr(){W(Ae),W(re)}function $o(x,w,P){if(re.current!==fe)throw Error(o(168));Q(re,w),Q(Ae,P)}function jl(x,w,P){var k=x.stateNode;if(w=w.childContextTypes,typeof k.getChildContext!="function")return P;k=k.getChildContext();for(var O in k)if(!(O in w))throw Error(o(108,M(x)||"Unknown",O));return s({},P,k)}function dn(x){return x=(x=x.stateNode)&&x.__reactInternalMemoizedMergedChildContext||fe,at=re.current,Q(re,x),Q(Ae,Ae.current),!0}function dg(x,w,P){var k=x.stateNode;if(!k)throw Error(o(169));P?(x=jl(x,w,at),k.__reactInternalMemoizedMergedChildContext=x,W(Ae),W(re),Q(re,x)):W(Ae),Q(Ae,P)}var Sa=Math.clz32?Math.clz32:Voe,T_=Math.log,Goe=Math.LN2;function Voe(x){return x>>>=0,x===0?32:31-(T_(x)/Goe|0)|0}var R_=64,k_=4194304;function hb(x){switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return x&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return x}}function D_(x,w){var P=x.pendingLanes;if(P===0)return 0;var k=0,O=x.suspendedLanes,G=x.pingedLanes,de=P&268435455;if(de!==0){var Te=de&~O;Te!==0?k=hb(Te):(G&=de,G!==0&&(k=hb(G)))}else de=P&~O,de!==0?k=hb(de):G!==0&&(k=hb(G));if(k===0)return 0;if(w!==0&&w!==k&&!(w&O)&&(O=k&-k,G=w&-w,O>=G||O===16&&(G&4194240)!==0))return w;if(k&4&&(k|=P&16),w=x.entangledLanes,w!==0)for(x=x.entanglements,w&=k;0<w;)P=31-Sa(w),O=1<<P,k|=x[P],w&=~O;return k}function joe(x,w){switch(x){case 1:case 2:case 4:return w+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Woe(x,w){for(var P=x.suspendedLanes,k=x.pingedLanes,O=x.expirationTimes,G=x.pendingLanes;0<G;){var de=31-Sa(G),Te=1<<de,Ze=O[de];Ze===-1?(!(Te&P)||Te&k)&&(O[de]=joe(Te,w)):Ze<=w&&(x.expiredLanes|=Te),G&=~Te}}function iR(x){return x=x.pendingLanes&-1073741825,x!==0?x:x&1073741824?1073741824:0}function rR(x){for(var w=[],P=0;31>P;P++)w.push(x);return w}function cb(x,w,P){x.pendingLanes|=w,w!==536870912&&(x.suspendedLanes=0,x.pingedLanes=0),x=x.eventTimes,w=31-Sa(w),x[w]=P}function qoe(x,w){var P=x.pendingLanes&~w;x.pendingLanes=w,x.suspendedLanes=0,x.pingedLanes=0,x.expiredLanes&=w,x.mutableReadLanes&=w,x.entangledLanes&=w,w=x.entanglements;var k=x.eventTimes;for(x=x.expirationTimes;0<P;){var O=31-Sa(P),G=1<<O;w[O]=0,k[O]=-1,x[O]=-1,P&=~G}}function nR(x,w){var P=x.entangledLanes|=w;for(x=x.entanglements;P;){var k=31-Sa(P),O=1<<k;O&w|x[k]&w&&(x[k]|=w),P&=~O}}var Wi=0;function U5(x){return x&=-x,1<x?4<x?x&268435455?16:536870912:4:1}var sR=n.unstable_scheduleCallback,N5=n.unstable_cancelCallback,Xoe=n.unstable_shouldYield,Yoe=n.unstable_requestPaint,us=n.unstable_now,oR=n.unstable_ImmediatePriority,Koe=n.unstable_UserBlockingPriority,aR=n.unstable_NormalPriority,Joe=n.unstable_IdlePriority,I_=null,Nu=null;function Qoe(x){if(Nu&&typeof Nu.onCommitFiberRoot=="function")try{Nu.onCommitFiberRoot(I_,x,void 0,(x.current.flags&128)===128)}catch{}}function Zoe(x,w){return x===w&&(x!==0||1/x===1/w)||x!==x&&w!==w}var Fu=typeof Object.is=="function"?Object.is:Zoe,Jh=null,L_=!1,lR=!1;function F5(x){Jh===null?Jh=[x]:Jh.push(x)}function $oe(x){L_=!0,F5(x)}function zu(){if(!lR&&Jh!==null){lR=!0;var x=0,w=Wi;try{var P=Jh;for(Wi=1;x<P.length;x++){var k=P[x];do k=k(!0);while(k!==null)}Jh=null,L_=!1}catch(O){throw Jh!==null&&(Jh=Jh.slice(x+1)),sR(oR,zu),O}finally{Wi=w,lR=!1}}return null}var eae=a.ReactCurrentBatchConfig;function B_(x,w){if(Fu(x,w))return!0;if(typeof x!="object"||x===null||typeof w!="object"||w===null)return!1;var P=Object.keys(x),k=Object.keys(w);if(P.length!==k.length)return!1;for(k=0;k<P.length;k++){var O=P[k];if(!Vi.call(w,O)||!Fu(x[O],w[O]))return!1}return!0}function tae(x){switch(x.tag){case 5:return bt(x.type);case 16:return bt("Lazy");case 13:return bt("Suspense");case 19:return bt("SuspenseList");case 0:case 2:case 15:return x=yt(x.type,!1),x;case 11:return x=yt(x.type.render,!1),x;case 1:return x=yt(x.type,!0),x;default:return""}}function Wl(x,w){if(x&&x.defaultProps){w=s({},w),x=x.defaultProps;for(var P in x)w[P]===void 0&&(w[P]=x[P]);return w}return w}var O_=rr(null),U_=null,pg=null,uR=null;function hR(){uR=pg=U_=null}function z5(x,w,P){Se?(Q(O_,w._currentValue),w._currentValue=P):(Q(O_,w._currentValue2),w._currentValue2=P)}function cR(x){var w=O_.current;W(O_),Se?x._currentValue=w:x._currentValue2=w}function dR(x,w,P){for(;x!==null;){var k=x.alternate;if((x.childLanes&w)!==w?(x.childLanes|=w,k!==null&&(k.childLanes|=w)):k!==null&&(k.childLanes&w)!==w&&(k.childLanes|=w),x===P)break;x=x.return}}function fg(x,w){U_=x,uR=pg=null,x=x.dependencies,x!==null&&x.firstContext!==null&&(x.lanes&w&&(Ma=!0),x.firstContext=null)}function el(x){var w=Se?x._currentValue:x._currentValue2;if(uR!==x)if(x={context:x,memoizedValue:w,next:null},pg===null){if(U_===null)throw Error(o(308));pg=x,U_.dependencies={lanes:0,firstContext:x}}else pg=pg.next=x;return w}var Hu=null,cd=!1;function pR(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H5(x,w){x=x.updateQueue,w.updateQueue===x&&(w.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,effects:x.effects})}function Qh(x,w){return{eventTime:x,lane:w,tag:0,payload:null,callback:null,next:null}}function dd(x,w){var P=x.updateQueue;P!==null&&(P=P.shared,Tn!==null&&x.mode&1&&!(Ci&2)?(x=P.interleaved,x===null?(w.next=w,Hu===null?Hu=[P]:Hu.push(P)):(w.next=x.next,x.next=w),P.interleaved=w):(x=P.pending,x===null?w.next=w:(w.next=x.next,x.next=w),P.pending=w))}function N_(x,w,P){if(w=w.updateQueue,w!==null&&(w=w.shared,(P&4194240)!==0)){var k=w.lanes;k&=x.pendingLanes,P|=k,w.lanes=P,nR(x,P)}}function G5(x,w){var P=x.updateQueue,k=x.alternate;if(k!==null&&(k=k.updateQueue,P===k)){var O=null,G=null;if(P=P.firstBaseUpdate,P!==null){do{var de={eventTime:P.eventTime,lane:P.lane,tag:P.tag,payload:P.payload,callback:P.callback,next:null};G===null?O=G=de:G=G.next=de,P=P.next}while(P!==null);G===null?O=G=w:G=G.next=w}else O=G=w;P={baseState:k.baseState,firstBaseUpdate:O,lastBaseUpdate:G,shared:k.shared,effects:k.effects},x.updateQueue=P;return}x=P.lastBaseUpdate,x===null?P.firstBaseUpdate=w:x.next=w,P.lastBaseUpdate=w}function F_(x,w,P,k){var O=x.updateQueue;cd=!1;var G=O.firstBaseUpdate,de=O.lastBaseUpdate,Te=O.shared.pending;if(Te!==null){O.shared.pending=null;var Ze=Te,mt=Ze.next;Ze.next=null,de===null?G=mt:de.next=mt,de=Ze;var It=x.alternate;It!==null&&(It=It.updateQueue,Te=It.lastBaseUpdate,Te!==de&&(Te===null?It.firstBaseUpdate=mt:Te.next=mt,It.lastBaseUpdate=Ze))}if(G!==null){var yi=O.baseState;de=0,It=mt=Ze=null,Te=G;do{var Jt=Te.lane,vr=Te.eventTime;if((k&Jt)===Jt){It!==null&&(It=It.next={eventTime:vr,lane:0,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null});e:{var jt=x,$s=Te;switch(Jt=w,vr=P,$s.tag){case 1:if(jt=$s.payload,typeof jt=="function"){yi=jt.call(vr,yi,Jt);break e}yi=jt;break e;case 3:jt.flags=jt.flags&-65537|128;case 0:if(jt=$s.payload,Jt=typeof jt=="function"?jt.call(vr,yi,Jt):jt,Jt==null)break e;yi=s({},yi,Jt);break e;case 2:cd=!0}}Te.callback!==null&&Te.lane!==0&&(x.flags|=64,Jt=O.effects,Jt===null?O.effects=[Te]:Jt.push(Te))}else vr={eventTime:vr,lane:Jt,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null},It===null?(mt=It=vr,Ze=yi):It=It.next=vr,de|=Jt;if(Te=Te.next,Te===null){if(Te=O.shared.pending,Te===null)break;Jt=Te,Te=Jt.next,Jt.next=null,O.lastBaseUpdate=Jt,O.shared.pending=null}}while(1);if(It===null&&(Ze=yi),O.baseState=Ze,O.firstBaseUpdate=mt,O.lastBaseUpdate=It,w=O.shared.interleaved,w!==null){O=w;do de|=O.lane,O=O.next;while(O!==w)}else G===null&&(O.shared.lanes=0);Sg|=de,x.lanes=de,x.memoizedState=yi}}function V5(x,w,P){if(x=w.effects,w.effects=null,x!==null)for(w=0;w<x.length;w++){var k=x[w],O=k.callback;if(O!==null){if(k.callback=null,k=P,typeof O!="function")throw Error(o(191,O));O.call(k)}}}var j5=new r.Component().refs;function fR(x,w,P,k){w=x.memoizedState,P=P(k,w),P=P==null?w:s({},w,P),x.memoizedState=P,x.lanes===0&&(x.updateQueue.baseState=P)}var z_={isMounted:function(x){return(x=x._reactInternals)?R(x)===x:!1},enqueueSetState:function(x,w,P){x=x._reactInternals;var k=Ao(),O=md(x),G=Qh(k,O);G.payload=w,P!=null&&(G.callback=P),dd(x,G),w=sl(x,O,k),w!==null&&N_(w,x,O)},enqueueReplaceState:function(x,w,P){x=x._reactInternals;var k=Ao(),O=md(x),G=Qh(k,O);G.tag=1,G.payload=w,P!=null&&(G.callback=P),dd(x,G),w=sl(x,O,k),w!==null&&N_(w,x,O)},enqueueForceUpdate:function(x,w){x=x._reactInternals;var P=Ao(),k=md(x),O=Qh(P,k);O.tag=2,w!=null&&(O.callback=w),dd(x,O),w=sl(x,k,P),w!==null&&N_(w,x,k)}};function W5(x,w,P,k,O,G,de){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(k,G,de):w.prototype&&w.prototype.isPureReactComponent?!B_(P,k)||!B_(O,G):!0}function q5(x,w,P){var k=!1,O=fe,G=w.contextType;return typeof G=="object"&&G!==null?G=el(G):(O=Kr(w)?at:re.current,k=w.contextTypes,G=(k=k!=null)?Yr(x,O):fe),w=new w(P,G),x.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=z_,x.stateNode=w,w._reactInternals=x,k&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=O,x.__reactInternalMemoizedMaskedChildContext=G),w}function X5(x,w,P,k){x=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(P,k),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(P,k),w.state!==x&&z_.enqueueReplaceState(w,w.state,null)}function mR(x,w,P,k){var O=x.stateNode;O.props=P,O.state=x.memoizedState,O.refs=j5,pR(x);var G=w.contextType;typeof G=="object"&&G!==null?O.context=el(G):(G=Kr(w)?at:re.current,O.context=Yr(x,G)),O.state=x.memoizedState,G=w.getDerivedStateFromProps,typeof G=="function"&&(fR(x,w,G,P),O.state=x.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(w=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),w!==O.state&&z_.enqueueReplaceState(O,O.state,null),F_(x,P,O,k),O.state=x.memoizedState),typeof O.componentDidMount=="function"&&(x.flags|=4194308)}var mg=[],gg=0,H_=null,G_=0,tl=[],il=0,ef=null,Zh=1,$h="";function tf(x,w){mg[gg++]=G_,mg[gg++]=H_,H_=x,G_=w}function Y5(x,w,P){tl[il++]=Zh,tl[il++]=$h,tl[il++]=ef,ef=x;var k=Zh;x=$h;var O=32-Sa(k)-1;k&=~(1<<O),P+=1;var G=32-Sa(w)+O;if(30<G){var de=O-O%5;G=(k&(1<<de)-1).toString(32),k>>=de,O-=de,Zh=1<<32-Sa(w)+O|P<<O|k,$h=G+x}else Zh=1<<G|P<<O|k,$h=x}function gR(x){x.return!==null&&(tf(x,1),Y5(x,1,0))}function yR(x){for(;x===H_;)H_=mg[--gg],mg[gg]=null,G_=mg[--gg],mg[gg]=null;for(;x===ef;)ef=tl[--il],tl[il]=null,$h=tl[--il],tl[il]=null,Zh=tl[--il],tl[il]=null}var Aa=null,Ea=null,Or=!1,db=!1,ql=null;function K5(x,w){var P=ol(5,null,null,0);P.elementType="DELETED",P.stateNode=w,P.return=x,w=x.deletions,w===null?(x.deletions=[P],x.flags|=16):w.push(P)}function J5(x,w){switch(x.tag){case 5:return w=gi(w,x.type,x.pendingProps),w!==null?(x.stateNode=w,Aa=x,Ea=Qe(w),!0):!1;case 6:return w=Br(w,x.pendingProps),w!==null?(x.stateNode=w,Aa=x,Ea=null,!0):!1;case 13:if(w=Ks(w),w!==null){var P=ef!==null?{id:Zh,overflow:$h}:null;return x.memoizedState={dehydrated:w,treeContext:P,retryLane:1073741824},P=ol(18,null,null,0),P.stateNode=w,P.return=x,x.child=P,Aa=x,Ea=null,!0}return!1;default:return!1}}function vR(x){return(x.mode&1)!==0&&(x.flags&128)===0}function bR(x){if(Or){var w=Ea;if(w){var P=w;if(!J5(x,w)){if(vR(x))throw Error(o(418));w=Ve(P);var k=Aa;w&&J5(x,w)?K5(k,P):(x.flags=x.flags&-4097|2,Or=!1,Aa=x)}}else{if(vR(x))throw Error(o(418));x.flags=x.flags&-4097|2,Or=!1,Aa=x}}}function Q5(x){for(x=x.return;x!==null&&x.tag!==5&&x.tag!==3&&x.tag!==13;)x=x.return;Aa=x}function pb(x){if(!_e||x!==Aa)return!1;if(!Or)return Q5(x),Or=!0,!1;if(x.tag!==3&&(x.tag!==5||gt(x.type)&&!oe(x.type,x.memoizedProps))){var w=Ea;if(w){if(vR(x)){for(x=Ea;x;)x=Ve(x);throw Error(o(418))}for(;w;)K5(x,w),w=Ve(w)}}if(Q5(x),x.tag===13){if(!_e)throw Error(o(316));if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));Ea=ne(x)}else Ea=Aa?Ve(x.stateNode):null;return!0}function yg(){_e&&(Ea=Aa=null,db=Or=!1)}function xR(x){ql===null?ql=[x]:ql.push(x)}function fb(x,w,P){if(x=P.ref,x!==null&&typeof x!="function"&&typeof x!="object"){if(P._owner){if(P=P._owner,P){if(P.tag!==1)throw Error(o(309));var k=P.stateNode}if(!k)throw Error(o(147,x));var O=k,G=""+x;return w!==null&&w.ref!==null&&typeof w.ref=="function"&&w.ref._stringRef===G?w.ref:(w=function(de){var Te=O.refs;Te===j5&&(Te=O.refs={}),de===null?delete Te[G]:Te[G]=de},w._stringRef=G,w)}if(typeof x!="string")throw Error(o(284));if(!P._owner)throw Error(o(290,x))}return x}function V_(x,w){throw x=Object.prototype.toString.call(w),Error(o(31,x==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":x))}function Z5(x){var w=x._init;return w(x._payload)}function $5(x){function w(We,Ie){if(x){var Ke=We.deletions;Ke===null?(We.deletions=[Ie],We.flags|=16):Ke.push(Ie)}}function P(We,Ie){if(!x)return null;for(;Ie!==null;)w(We,Ie),Ie=Ie.sibling;return null}function k(We,Ie){for(We=new Map;Ie!==null;)Ie.key!==null?We.set(Ie.key,Ie):We.set(Ie.index,Ie),Ie=Ie.sibling;return We}function O(We,Ie){return We=yd(We,Ie),We.index=0,We.sibling=null,We}function G(We,Ie,Ke){return We.index=Ke,x?(Ke=We.alternate,Ke!==null?(Ke=Ke.index,Ke<Ie?(We.flags|=2,Ie):Ke):(We.flags|=2,Ie)):(We.flags|=1048576,Ie)}function de(We){return x&&We.alternate===null&&(We.flags|=2),We}function Te(We,Ie,Ke,Ct){return Ie===null||Ie.tag!==6?(Ie=rk(Ke,We.mode,Ct),Ie.return=We,Ie):(Ie=O(Ie,Ke),Ie.return=We,Ie)}function Ze(We,Ie,Ke,Ct){var Vt=Ke.type;return Vt===c?It(We,Ie,Ke.props.children,Ct,Ke.key):Ie!==null&&(Ie.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===b&&Z5(Vt)===Ie.type)?(Ct=O(Ie,Ke.props),Ct.ref=fb(We,Ie,Ke),Ct.return=We,Ct):(Ct=xS(Ke.type,Ke.key,Ke.props,null,We.mode,Ct),Ct.ref=fb(We,Ie,Ke),Ct.return=We,Ct)}function mt(We,Ie,Ke,Ct){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==Ke.containerInfo||Ie.stateNode.implementation!==Ke.implementation?(Ie=nk(Ke,We.mode,Ct),Ie.return=We,Ie):(Ie=O(Ie,Ke.children||[]),Ie.return=We,Ie)}function It(We,Ie,Ke,Ct,Vt){return Ie===null||Ie.tag!==7?(Ie=uf(Ke,We.mode,Ct,Vt),Ie.return=We,Ie):(Ie=O(Ie,Ke),Ie.return=We,Ie)}function yi(We,Ie,Ke){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number")return Ie=rk(""+Ie,We.mode,Ke),Ie.return=We,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case l:return Ke=xS(Ie.type,Ie.key,Ie.props,null,We.mode,Ke),Ke.ref=fb(We,null,Ie),Ke.return=We,Ke;case u:return Ie=nk(Ie,We.mode,Ke),Ie.return=We,Ie;case b:var Ct=Ie._init;return yi(We,Ct(Ie._payload),Ke)}if(F(Ie)||S(Ie))return Ie=uf(Ie,We.mode,Ke,null),Ie.return=We,Ie;V_(We,Ie)}return null}function Jt(We,Ie,Ke,Ct){var Vt=Ie!==null?Ie.key:null;if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number")return Vt!==null?null:Te(We,Ie,""+Ke,Ct);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case l:return Ke.key===Vt?Ze(We,Ie,Ke,Ct):null;case u:return Ke.key===Vt?mt(We,Ie,Ke,Ct):null;case b:return Vt=Ke._init,Jt(We,Ie,Vt(Ke._payload),Ct)}if(F(Ke)||S(Ke))return Vt!==null?null:It(We,Ie,Ke,Ct,null);V_(We,Ke)}return null}function vr(We,Ie,Ke,Ct,Vt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return We=We.get(Ke)||null,Te(Ie,We,""+Ct,Vt);if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case l:return We=We.get(Ct.key===null?Ke:Ct.key)||null,Ze(Ie,We,Ct,Vt);case u:return We=We.get(Ct.key===null?Ke:Ct.key)||null,mt(Ie,We,Ct,Vt);case b:var Ai=Ct._init;return vr(We,Ie,Ke,Ai(Ct._payload),Vt)}if(F(Ct)||S(Ct))return We=We.get(Ke)||null,It(Ie,We,Ct,Vt,null);V_(Ie,Ct)}return null}function jt(We,Ie,Ke,Ct){for(var Vt=null,Ai=null,vi=Ie,qi=Ie=0,cs=null;vi!==null&&qi<Ke.length;qi++){vi.index>qi?(cs=vi,vi=null):cs=vi.sibling;var Xi=Jt(We,vi,Ke[qi],Ct);if(Xi===null){vi===null&&(vi=cs);break}x&&vi&&Xi.alternate===null&&w(We,vi),Ie=G(Xi,Ie,qi),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi,vi=cs}if(qi===Ke.length)return P(We,vi),Or&&tf(We,qi),Vt;if(vi===null){for(;qi<Ke.length;qi++)vi=yi(We,Ke[qi],Ct),vi!==null&&(Ie=G(vi,Ie,qi),Ai===null?Vt=vi:Ai.sibling=vi,Ai=vi);return Or&&tf(We,qi),Vt}for(vi=k(We,vi);qi<Ke.length;qi++)cs=vr(vi,We,qi,Ke[qi],Ct),cs!==null&&(x&&cs.alternate!==null&&vi.delete(cs.key===null?qi:cs.key),Ie=G(cs,Ie,qi),Ai===null?Vt=cs:Ai.sibling=cs,Ai=cs);return x&&vi.forEach(function(vd){return w(We,vd)}),Or&&tf(We,qi),Vt}function $s(We,Ie,Ke,Ct){var Vt=S(Ke);if(typeof Vt!="function")throw Error(o(150));if(Ke=Vt.call(Ke),Ke==null)throw Error(o(151));for(var Ai=Vt=null,vi=Ie,qi=Ie=0,cs=null,Xi=Ke.next();vi!==null&&!Xi.done;qi++,Xi=Ke.next()){vi.index>qi?(cs=vi,vi=null):cs=vi.sibling;var vd=Jt(We,vi,Xi.value,Ct);if(vd===null){vi===null&&(vi=cs);break}x&&vi&&vd.alternate===null&&w(We,vi),Ie=G(vd,Ie,qi),Ai===null?Vt=vd:Ai.sibling=vd,Ai=vd,vi=cs}if(Xi.done)return P(We,vi),Or&&tf(We,qi),Vt;if(vi===null){for(;!Xi.done;qi++,Xi=Ke.next())Xi=yi(We,Xi.value,Ct),Xi!==null&&(Ie=G(Xi,Ie,qi),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi);return Or&&tf(We,qi),Vt}for(vi=k(We,vi);!Xi.done;qi++,Xi=Ke.next())Xi=vr(vi,We,qi,Xi.value,Ct),Xi!==null&&(x&&Xi.alternate!==null&&vi.delete(Xi.key===null?qi:Xi.key),Ie=G(Xi,Ie,qi),Ai===null?Vt=Xi:Ai.sibling=Xi,Ai=Xi);return x&&vi.forEach(function(kae){return w(We,kae)}),Or&&tf(We,qi),Vt}function al(We,Ie,Ke,Ct){if(typeof Ke=="object"&&Ke!==null&&Ke.type===c&&Ke.key===null&&(Ke=Ke.props.children),typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case l:e:{for(var Vt=Ke.key,Ai=Ie;Ai!==null;){if(Ai.key===Vt){if(Vt=Ke.type,Vt===c){if(Ai.tag===7){P(We,Ai.sibling),Ie=O(Ai,Ke.props.children),Ie.return=We,We=Ie;break e}}else if(Ai.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===b&&Z5(Vt)===Ai.type){P(We,Ai.sibling),Ie=O(Ai,Ke.props),Ie.ref=fb(We,Ai,Ke),Ie.return=We,We=Ie;break e}P(We,Ai);break}else w(We,Ai);Ai=Ai.sibling}Ke.type===c?(Ie=uf(Ke.props.children,We.mode,Ct,Ke.key),Ie.return=We,We=Ie):(Ct=xS(Ke.type,Ke.key,Ke.props,null,We.mode,Ct),Ct.ref=fb(We,Ie,Ke),Ct.return=We,We=Ct)}return de(We);case u:e:{for(Ai=Ke.key;Ie!==null;){if(Ie.key===Ai)if(Ie.tag===4&&Ie.stateNode.containerInfo===Ke.containerInfo&&Ie.stateNode.implementation===Ke.implementation){P(We,Ie.sibling),Ie=O(Ie,Ke.children||[]),Ie.return=We,We=Ie;break e}else{P(We,Ie);break}else w(We,Ie);Ie=Ie.sibling}Ie=nk(Ke,We.mode,Ct),Ie.return=We,We=Ie}return de(We);case b:return Ai=Ke._init,al(We,Ie,Ai(Ke._payload),Ct)}if(F(Ke))return jt(We,Ie,Ke,Ct);if(S(Ke))return $s(We,Ie,Ke,Ct);V_(We,Ke)}return typeof Ke=="string"&&Ke!==""||typeof Ke=="number"?(Ke=""+Ke,Ie!==null&&Ie.tag===6?(P(We,Ie.sibling),Ie=O(Ie,Ke),Ie.return=We,We=Ie):(P(We,Ie),Ie=rk(Ke,We.mode,Ct),Ie.return=We,We=Ie),de(We)):P(We,Ie)}return al}var vg=$5(!0),eH=$5(!1),mb={},rl=rr(mb),gb=rr(mb),bg=rr(mb);function Gu(x){if(x===mb)throw Error(o(174));return x}function wR(x,w){Q(bg,w),Q(gb,x),Q(rl,mb),x=z(w),W(rl),Q(rl,x)}function xg(){W(rl),W(gb),W(bg)}function tH(x){var w=Gu(bg.current),P=Gu(rl.current);w=B(P,x.type,w),P!==w&&(Q(gb,x),Q(rl,w))}function _R(x){gb.current===x&&(W(rl),W(gb))}var Fr=rr(0);function j_(x){for(var w=x;w!==null;){if(w.tag===13){var P=w.memoizedState;if(P!==null&&(P=P.dehydrated,P===null||Kh(P)||Vl(P)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if(w.flags&128)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}var SR=[];function AR(){for(var x=0;x<SR.length;x++){var w=SR[x];Se?w._workInProgressVersionPrimary=null:w._workInProgressVersionSecondary=null}SR.length=0}var W_=a.ReactCurrentDispatcher,nl=a.ReactCurrentBatchConfig,wg=0,Jr=null,Js=null,hs=null,q_=!1,yb=!1,vb=0,iae=0;function Qs(){throw Error(o(321))}function ER(x,w){if(w===null)return!1;for(var P=0;P<w.length&&P<x.length;P++)if(!Fu(x[P],w[P]))return!1;return!0}function MR(x,w,P,k,O,G){if(wg=G,Jr=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,W_.current=x===null||x.memoizedState===null?oae:aae,x=P(k,O),yb){G=0;do{if(yb=!1,vb=0,25<=G)throw Error(o(301));G+=1,hs=Js=null,w.updateQueue=null,W_.current=lae,x=P(k,O)}while(yb)}if(W_.current=Q_,w=Js!==null&&Js.next!==null,wg=0,hs=Js=Jr=null,q_=!1,w)throw Error(o(300));return x}function CR(){var x=vb!==0;return vb=0,x}function ec(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hs===null?Jr.memoizedState=hs=x:hs=hs.next=x,hs}function Vu(){if(Js===null){var x=Jr.alternate;x=x!==null?x.memoizedState:null}else x=Js.next;var w=hs===null?Jr.memoizedState:hs.next;if(w!==null)hs=w,Js=x;else{if(x===null)throw Error(o(310));Js=x,x={memoizedState:Js.memoizedState,baseState:Js.baseState,baseQueue:Js.baseQueue,queue:Js.queue,next:null},hs===null?Jr.memoizedState=hs=x:hs=hs.next=x}return hs}function rf(x,w){return typeof w=="function"?w(x):w}function X_(x){var w=Vu(),P=w.queue;if(P===null)throw Error(o(311));P.lastRenderedReducer=x;var k=Js,O=k.baseQueue,G=P.pending;if(G!==null){if(O!==null){var de=O.next;O.next=G.next,G.next=de}k.baseQueue=O=G,P.pending=null}if(O!==null){G=O.next,k=k.baseState;var Te=de=null,Ze=null,mt=G;do{var It=mt.lane;if((wg&It)===It)Ze!==null&&(Ze=Ze.next={lane:0,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null}),k=mt.hasEagerState?mt.eagerState:x(k,mt.action);else{var yi={lane:It,action:mt.action,hasEagerState:mt.hasEagerState,eagerState:mt.eagerState,next:null};Ze===null?(Te=Ze=yi,de=k):Ze=Ze.next=yi,Jr.lanes|=It,Sg|=It}mt=mt.next}while(mt!==null&&mt!==G);Ze===null?de=k:Ze.next=Te,Fu(k,w.memoizedState)||(Ma=!0),w.memoizedState=k,w.baseState=de,w.baseQueue=Ze,P.lastRenderedState=k}if(x=P.interleaved,x!==null){O=x;do G=O.lane,Jr.lanes|=G,Sg|=G,O=O.next;while(O!==x)}else O===null&&(P.lanes=0);return[w.memoizedState,P.dispatch]}function Y_(x){var w=Vu(),P=w.queue;if(P===null)throw Error(o(311));P.lastRenderedReducer=x;var k=P.dispatch,O=P.pending,G=w.memoizedState;if(O!==null){P.pending=null;var de=O=O.next;do G=x(G,de.action),de=de.next;while(de!==O);Fu(G,w.memoizedState)||(Ma=!0),w.memoizedState=G,w.baseQueue===null&&(w.baseState=G),P.lastRenderedState=G}return[G,k]}function iH(){}function rH(x,w){var P=Jr,k=Vu(),O=w(),G=!Fu(k.memoizedState,O);if(G&&(k.memoizedState=O,Ma=!0),k=k.queue,xb(oH.bind(null,P,k,x),[x]),k.getSnapshot!==w||G||hs!==null&&hs.memoizedState.tag&1){if(P.flags|=2048,bb(9,sH.bind(null,P,k,O,w),void 0,null),Tn===null)throw Error(o(349));wg&30||nH(P,w,O)}return O}function nH(x,w,P){x.flags|=16384,x={getSnapshot:w,value:P},w=Jr.updateQueue,w===null?(w={lastEffect:null,stores:null},Jr.updateQueue=w,w.stores=[x]):(P=w.stores,P===null?w.stores=[x]:P.push(x))}function sH(x,w,P,k){w.value=P,w.getSnapshot=k,aH(w)&&sl(x,1,-1)}function oH(x,w,P){return P(function(){aH(w)&&sl(x,1,-1)})}function aH(x){var w=x.getSnapshot;x=x.value;try{var P=w();return!Fu(x,P)}catch{return!0}}function PR(x){var w=ec();return typeof x=="function"&&(x=x()),w.memoizedState=w.baseState=x,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rf,lastRenderedState:x},w.queue=x,x=x.dispatch=sae.bind(null,Jr,x),[w.memoizedState,x]}function bb(x,w,P,k){return x={tag:x,create:w,destroy:P,deps:k,next:null},w=Jr.updateQueue,w===null?(w={lastEffect:null,stores:null},Jr.updateQueue=w,w.lastEffect=x.next=x):(P=w.lastEffect,P===null?w.lastEffect=x.next=x:(k=P.next,P.next=x,x.next=k,w.lastEffect=x)),x}function lH(){return Vu().memoizedState}function K_(x,w,P,k){var O=ec();Jr.flags|=x,O.memoizedState=bb(1|w,P,void 0,k===void 0?null:k)}function J_(x,w,P,k){var O=Vu();k=k===void 0?null:k;var G=void 0;if(Js!==null){var de=Js.memoizedState;if(G=de.destroy,k!==null&&ER(k,de.deps)){O.memoizedState=bb(w,P,G,k);return}}Jr.flags|=x,O.memoizedState=bb(1|w,P,G,k)}function TR(x,w){return K_(8390656,8,x,w)}function xb(x,w){return J_(2048,8,x,w)}function uH(x,w){return J_(4,2,x,w)}function hH(x,w){return J_(4,4,x,w)}function cH(x,w){if(typeof w=="function")return x=x(),w(x),function(){w(null)};if(w!=null)return x=x(),w.current=x,function(){w.current=null}}function dH(x,w,P){return P=P!=null?P.concat([x]):null,J_(4,4,cH.bind(null,w,x),P)}function RR(){}function pH(x,w){var P=Vu();w=w===void 0?null:w;var k=P.memoizedState;return k!==null&&w!==null&&ER(w,k[1])?k[0]:(P.memoizedState=[x,w],x)}function fH(x,w){var P=Vu();w=w===void 0?null:w;var k=P.memoizedState;return k!==null&&w!==null&&ER(w,k[1])?k[0]:(x=x(),P.memoizedState=[x,w],x)}function rae(x,w){var P=Wi;Wi=P!==0&&4>P?P:4,x(!0);var k=nl.transition;nl.transition={};try{x(!1),w()}finally{Wi=P,nl.transition=k}}function mH(){return Vu().memoizedState}function nae(x,w,P){var k=md(x);P={lane:k,action:P,hasEagerState:!1,eagerState:null,next:null},gH(x)?yH(w,P):(vH(x,w,P),P=Ao(),x=sl(x,k,P),x!==null&&bH(x,w,k))}function sae(x,w,P){var k=md(x),O={lane:k,action:P,hasEagerState:!1,eagerState:null,next:null};if(gH(x))yH(w,O);else{vH(x,w,O);var G=x.alternate;if(x.lanes===0&&(G===null||G.lanes===0)&&(G=w.lastRenderedReducer,G!==null))try{var de=w.lastRenderedState,Te=G(de,P);if(O.hasEagerState=!0,O.eagerState=Te,Fu(Te,de))return}catch{}finally{}P=Ao(),x=sl(x,k,P),x!==null&&bH(x,w,k)}}function gH(x){var w=x.alternate;return x===Jr||w!==null&&w===Jr}function yH(x,w){yb=q_=!0;var P=x.pending;P===null?w.next=w:(w.next=P.next,P.next=w),x.pending=w}function vH(x,w,P){Tn!==null&&x.mode&1&&!(Ci&2)?(x=w.interleaved,x===null?(P.next=P,Hu===null?Hu=[w]:Hu.push(w)):(P.next=x.next,x.next=P),w.interleaved=P):(x=w.pending,x===null?P.next=P:(P.next=x.next,x.next=P),w.pending=P)}function bH(x,w,P){if(P&4194240){var k=w.lanes;k&=x.pendingLanes,P|=k,w.lanes=P,nR(x,P)}}var Q_={readContext:el,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useInsertionEffect:Qs,useLayoutEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useMutableSource:Qs,useSyncExternalStore:Qs,useId:Qs,unstable_isNewReconciler:!1},oae={readContext:el,useCallback:function(x,w){return ec().memoizedState=[x,w===void 0?null:w],x},useContext:el,useEffect:TR,useImperativeHandle:function(x,w,P){return P=P!=null?P.concat([x]):null,K_(4194308,4,cH.bind(null,w,x),P)},useLayoutEffect:function(x,w){return K_(4194308,4,x,w)},useInsertionEffect:function(x,w){return K_(4,2,x,w)},useMemo:function(x,w){var P=ec();return w=w===void 0?null:w,x=x(),P.memoizedState=[x,w],x},useReducer:function(x,w,P){var k=ec();return w=P!==void 0?P(w):w,k.memoizedState=k.baseState=w,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:w},k.queue=x,x=x.dispatch=nae.bind(null,Jr,x),[k.memoizedState,x]},useRef:function(x){var w=ec();return x={current:x},w.memoizedState=x},useState:PR,useDebugValue:RR,useDeferredValue:function(x){var w=PR(x),P=w[0],k=w[1];return TR(function(){var O=nl.transition;nl.transition={};try{k(x)}finally{nl.transition=O}},[x]),P},useTransition:function(){var x=PR(!1),w=x[0];return x=rae.bind(null,x[1]),ec().memoizedState=x,[w,x]},useMutableSource:function(){},useSyncExternalStore:function(x,w,P){var k=Jr,O=ec();if(Or){if(P===void 0)throw Error(o(407));P=P()}else{if(P=w(),Tn===null)throw Error(o(349));wg&30||nH(k,w,P)}O.memoizedState=P;var G={value:P,getSnapshot:w};return O.queue=G,TR(oH.bind(null,k,G,x),[x]),k.flags|=2048,bb(9,sH.bind(null,k,G,P,w),void 0,null),P},useId:function(){var x=ec(),w=Tn.identifierPrefix;if(Or){var P=$h,k=Zh;P=(k&~(1<<32-Sa(k)-1)).toString(32)+P,w=":"+w+"R"+P,P=vb++,0<P&&(w+="H"+P.toString(32)),w+=":"}else P=iae++,w=":"+w+"r"+P.toString(32)+":";return x.memoizedState=w},unstable_isNewReconciler:!1},aae={readContext:el,useCallback:pH,useContext:el,useEffect:xb,useImperativeHandle:dH,useInsertionEffect:uH,useLayoutEffect:hH,useMemo:fH,useReducer:X_,useRef:lH,useState:function(){return X_(rf)},useDebugValue:RR,useDeferredValue:function(x){var w=X_(rf),P=w[0],k=w[1];return xb(function(){var O=nl.transition;nl.transition={};try{k(x)}finally{nl.transition=O}},[x]),P},useTransition:function(){var x=X_(rf)[0],w=Vu().memoizedState;return[x,w]},useMutableSource:iH,useSyncExternalStore:rH,useId:mH,unstable_isNewReconciler:!1},lae={readContext:el,useCallback:pH,useContext:el,useEffect:xb,useImperativeHandle:dH,useInsertionEffect:uH,useLayoutEffect:hH,useMemo:fH,useReducer:Y_,useRef:lH,useState:function(){return Y_(rf)},useDebugValue:RR,useDeferredValue:function(x){var w=Y_(rf),P=w[0],k=w[1];return xb(function(){var O=nl.transition;nl.transition={};try{k(x)}finally{nl.transition=O}},[x]),P},useTransition:function(){var x=Y_(rf)[0],w=Vu().memoizedState;return[x,w]},useMutableSource:iH,useSyncExternalStore:rH,useId:mH,unstable_isNewReconciler:!1};function kR(x,w){try{var P="",k=w;do P+=tae(k),k=k.return;while(k);var O=P}catch(G){O=`
Error generating stack: `+G.message+`
`+G.stack}return{value:x,source:w,stack:O}}function DR(x,w){try{console.error(w.value)}catch(P){setTimeout(function(){throw P})}}var uae=typeof WeakMap=="function"?WeakMap:Map;function xH(x,w,P){P=Qh(-1,P),P.tag=3,P.payload={element:null};var k=w.value;return P.callback=function(){pS||(pS=!0,JR=k),DR(x,w)},P}function wH(x,w,P){P=Qh(-1,P),P.tag=3;var k=x.type.getDerivedStateFromError;if(typeof k=="function"){var O=w.value;P.payload=function(){return k(O)},P.callback=function(){DR(x,w)}}var G=x.stateNode;return G!==null&&typeof G.componentDidCatch=="function"&&(P.callback=function(){DR(x,w),typeof k!="function"&&(pd===null?pd=new Set([this]):pd.add(this));var de=w.stack;this.componentDidCatch(w.value,{componentStack:de!==null?de:""})}),P}function _H(x,w,P){var k=x.pingCache;if(k===null){k=x.pingCache=new uae;var O=new Set;k.set(w,O)}else O=k.get(w),O===void 0&&(O=new Set,k.set(w,O));O.has(P)||(O.add(P),x=Sae.bind(null,x,w,P),w.then(x,x))}function SH(x){do{var w;if((w=x.tag===13)&&(w=x.memoizedState,w=w!==null?w.dehydrated!==null:!0),w)return x;x=x.return}while(x!==null);return null}function AH(x,w,P,k,O){return x.mode&1?(x.flags|=65536,x.lanes=O,x):(x===w?x.flags|=65536:(x.flags|=128,P.flags|=131072,P.flags&=-52805,P.tag===1&&(P.alternate===null?P.tag=17:(w=Qh(-1,1),w.tag=2,dd(P,w))),P.lanes|=1),x)}function ju(x){x.flags|=4}function EH(x,w){if(x!==null&&x.child===w.child)return!0;if(w.flags&16)return!1;for(x=w.child;x!==null;){if(x.flags&12854||x.subtreeFlags&12854)return!1;x=x.sibling}return!0}var wb,_b,Z_,$_;if(be)wb=function(x,w){for(var P=w.child;P!==null;){if(P.tag===5||P.tag===6)K(x,P.stateNode);else if(P.tag!==4&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===w)break;for(;P.sibling===null;){if(P.return===null||P.return===w)return;P=P.return}P.sibling.return=P.return,P=P.sibling}},_b=function(){},Z_=function(x,w,P,k,O){if(x=x.memoizedProps,x!==k){var G=w.stateNode,de=Gu(rl.current);P=Z(G,P,x,k,O,de),(w.updateQueue=P)&&ju(w)}},$_=function(x,w,P,k){P!==k&&ju(w)};else if(ee){wb=function(x,w,P,k){for(var O=w.child;O!==null;){if(O.tag===5){var G=O.stateNode;P&&k&&(G=li(G,O.type,O.memoizedProps,O)),K(x,G)}else if(O.tag===6)G=O.stateNode,P&&k&&(G=yr(G,O.memoizedProps,O)),K(x,G);else if(O.tag!==4){if(O.tag===22&&O.memoizedState!==null)G=O.child,G!==null&&(G.return=O),wb(x,O,!0,!0);else if(O.child!==null){O.child.return=O,O=O.child;continue}}if(O===w)break;for(;O.sibling===null;){if(O.return===null||O.return===w)return;O=O.return}O.sibling.return=O.return,O=O.sibling}};var MH=function(x,w,P,k){for(var O=w.child;O!==null;){if(O.tag===5){var G=O.stateNode;P&&k&&(G=li(G,O.type,O.memoizedProps,O)),At(x,G)}else if(O.tag===6)G=O.stateNode,P&&k&&(G=yr(G,O.memoizedProps,O)),At(x,G);else if(O.tag!==4){if(O.tag===22&&O.memoizedState!==null)G=O.child,G!==null&&(G.return=O),MH(x,O,!0,!0);else if(O.child!==null){O.child.return=O,O=O.child;continue}}if(O===w)break;for(;O.sibling===null;){if(O.return===null||O.return===w)return;O=O.return}O.sibling.return=O.return,O=O.sibling}};_b=function(x,w){var P=w.stateNode;if(!EH(x,w)){x=P.containerInfo;var k=dt(x);MH(k,w,!1,!1),P.pendingChildren=k,ju(w),ri(x,k)}},Z_=function(x,w,P,k,O){var G=x.stateNode,de=x.memoizedProps;if((x=EH(x,w))&&de===k)w.stateNode=G;else{var Te=w.stateNode,Ze=Gu(rl.current),mt=null;de!==k&&(mt=Z(Te,P,de,k,O,Ze)),x&&mt===null?w.stateNode=G:(G=Ye(G,mt,P,de,k,w,x,Te),le(G,P,k,O,Ze)&&ju(w),w.stateNode=G,x?ju(w):wb(G,w,!1,!1))}},$_=function(x,w,P,k){P!==k?(x=Gu(bg.current),P=Gu(rl.current),w.stateNode=ae(k,x,P,w),ju(w)):w.stateNode=x.stateNode}}else _b=function(){},Z_=function(){},$_=function(){};function Sb(x,w){if(!Or)switch(x.tailMode){case"hidden":w=x.tail;for(var P=null;w!==null;)w.alternate!==null&&(P=w),w=w.sibling;P===null?x.tail=null:P.sibling=null;break;case"collapsed":P=x.tail;for(var k=null;P!==null;)P.alternate!==null&&(k=P),P=P.sibling;k===null?w||x.tail===null?x.tail=null:x.tail.sibling=null:k.sibling=null}}function Zs(x){var w=x.alternate!==null&&x.alternate.child===x.child,P=0,k=0;if(w)for(var O=x.child;O!==null;)P|=O.lanes|O.childLanes,k|=O.subtreeFlags&14680064,k|=O.flags&14680064,O.return=x,O=O.sibling;else for(O=x.child;O!==null;)P|=O.lanes|O.childLanes,k|=O.subtreeFlags,k|=O.flags,O.return=x,O=O.sibling;return x.subtreeFlags|=k,x.childLanes=P,w}function hae(x,w,P){var k=w.pendingProps;switch(yR(w),w.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zs(w),null;case 1:return Kr(w.type)&&xr(),Zs(w),null;case 3:return k=w.stateNode,xg(),W(Ae),W(re),AR(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(x===null||x.child===null)&&(pb(w)?ju(w):x===null||x.memoizedState.isDehydrated&&!(w.flags&256)||(w.flags|=1024,ql!==null&&($R(ql),ql=null))),_b(x,w),Zs(w),null;case 5:_R(w),P=Gu(bg.current);var O=w.type;if(x!==null&&w.stateNode!=null)Z_(x,w,O,k,P),x.ref!==w.ref&&(w.flags|=512,w.flags|=2097152);else{if(!k){if(w.stateNode===null)throw Error(o(166));return Zs(w),null}if(x=Gu(rl.current),pb(w)){if(!_e)throw Error(o(175));x=Lt(w.stateNode,w.type,w.memoizedProps,P,x,w,!db),w.updateQueue=x,x!==null&&ju(w)}else{var G=q(O,k,P,x,w);wb(G,w,!1,!1),w.stateNode=G,le(G,O,k,P,x)&&ju(w)}w.ref!==null&&(w.flags|=512,w.flags|=2097152)}return Zs(w),null;case 6:if(x&&w.stateNode!=null)$_(x,w,x.memoizedProps,k);else{if(typeof k!="string"&&w.stateNode===null)throw Error(o(166));if(x=Gu(bg.current),P=Gu(rl.current),pb(w)){if(!_e)throw Error(o(176));if(x=w.stateNode,k=w.memoizedProps,(P=oi(x,k,w,!db))&&(O=Aa,O!==null))switch(G=(O.mode&1)!==0,O.tag){case 3:Rt(O.stateNode.containerInfo,x,k,G);break;case 5:zt(O.type,O.memoizedProps,O.stateNode,x,k,G)}P&&ju(w)}else w.stateNode=ae(k,x,P,w)}return Zs(w),null;case 13:if(W(Fr),k=w.memoizedState,Or&&Ea!==null&&w.mode&1&&!(w.flags&128)){for(x=Ea;x;)x=Ve(x);return yg(),w.flags|=98560,w}if(k!==null&&k.dehydrated!==null){if(k=pb(w),x===null){if(!k)throw Error(o(318));if(!_e)throw Error(o(344));if(x=w.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));hi(x,w)}else yg(),!(w.flags&128)&&(w.memoizedState=null),w.flags|=4;return Zs(w),null}return ql!==null&&($R(ql),ql=null),w.flags&128?(w.lanes=P,w):(k=k!==null,P=!1,x===null?pb(w):P=x.memoizedState!==null,k&&!P&&(w.child.flags|=8192,w.mode&1&&(x===null||Fr.current&1?Xn===0&&(Xn=3):tk())),w.updateQueue!==null&&(w.flags|=4),Zs(w),null);case 4:return xg(),_b(x,w),x===null&&Ce(w.stateNode.containerInfo),Zs(w),null;case 10:return cR(w.type._context),Zs(w),null;case 17:return Kr(w.type)&&xr(),Zs(w),null;case 19:if(W(Fr),O=w.memoizedState,O===null)return Zs(w),null;if(k=(w.flags&128)!==0,G=O.rendering,G===null)if(k)Sb(O,!1);else{if(Xn!==0||x!==null&&x.flags&128)for(x=w.child;x!==null;){if(G=j_(x),G!==null){for(w.flags|=128,Sb(O,!1),x=G.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),w.subtreeFlags=0,x=P,k=w.child;k!==null;)P=k,O=x,P.flags&=14680066,G=P.alternate,G===null?(P.childLanes=0,P.lanes=O,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=G.childLanes,P.lanes=G.lanes,P.child=G.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=G.memoizedProps,P.memoizedState=G.memoizedState,P.updateQueue=G.updateQueue,P.type=G.type,O=G.dependencies,P.dependencies=O===null?null:{lanes:O.lanes,firstContext:O.firstContext}),k=k.sibling;return Q(Fr,Fr.current&1|2),w.child}x=x.sibling}O.tail!==null&&us()>KR&&(w.flags|=128,k=!0,Sb(O,!1),w.lanes=4194304)}else{if(!k)if(x=j_(G),x!==null){if(w.flags|=128,k=!0,x=x.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),Sb(O,!0),O.tail===null&&O.tailMode==="hidden"&&!G.alternate&&!Or)return Zs(w),null}else 2*us()-O.renderingStartTime>KR&&P!==1073741824&&(w.flags|=128,k=!0,Sb(O,!1),w.lanes=4194304);O.isBackwards?(G.sibling=w.child,w.child=G):(x=O.last,x!==null?x.sibling=G:w.child=G,O.last=G)}return O.tail!==null?(w=O.tail,O.rendering=w,O.tail=w.sibling,O.renderingStartTime=us(),w.sibling=null,x=Fr.current,Q(Fr,k?x&1|2:x&1),w):(Zs(w),null);case 22:case 23:return ek(),k=w.memoizedState!==null,x!==null&&x.memoizedState!==null!==k&&(w.flags|=8192),k&&w.mode&1?Ca&1073741824&&(Zs(w),be&&w.subtreeFlags&6&&(w.flags|=8192)):Zs(w),null;case 24:return null;case 25:return null}throw Error(o(156,w.tag))}var cae=a.ReactCurrentOwner,Ma=!1;function So(x,w,P,k){w.child=x===null?eH(w,null,P,k):vg(w,x.child,P,k)}function CH(x,w,P,k,O){P=P.render;var G=w.ref;return fg(w,O),k=MR(x,w,P,k,G,O),P=CR(),x!==null&&!Ma?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~O,tc(x,w,O)):(Or&&P&&gR(w),w.flags|=1,So(x,w,k,O),w.child)}function PH(x,w,P,k,O){if(x===null){var G=P.type;return typeof G=="function"&&!ik(G)&&G.defaultProps===void 0&&P.compare===null&&P.defaultProps===void 0?(w.tag=15,w.type=G,TH(x,w,G,k,O)):(x=xS(P.type,null,k,w,w.mode,O),x.ref=w.ref,x.return=w,w.child=x)}if(G=x.child,!(x.lanes&O)){var de=G.memoizedProps;if(P=P.compare,P=P!==null?P:B_,P(de,k)&&x.ref===w.ref)return tc(x,w,O)}return w.flags|=1,x=yd(G,k),x.ref=w.ref,x.return=w,w.child=x}function TH(x,w,P,k,O){if(x!==null&&B_(x.memoizedProps,k)&&x.ref===w.ref)if(Ma=!1,(x.lanes&O)!==0)x.flags&131072&&(Ma=!0);else return w.lanes=x.lanes,tc(x,w,O);return IR(x,w,P,k,O)}function RH(x,w,P){var k=w.pendingProps,O=k.children,G=x!==null?x.memoizedState:null;if(k.mode==="hidden")if(!(w.mode&1))w.memoizedState={baseLanes:0,cachePool:null},Q(_g,Ca),Ca|=P;else if(P&1073741824)w.memoizedState={baseLanes:0,cachePool:null},k=G!==null?G.baseLanes:P,Q(_g,Ca),Ca|=k;else return x=G!==null?G.baseLanes|P:P,w.lanes=w.childLanes=1073741824,w.memoizedState={baseLanes:x,cachePool:null},w.updateQueue=null,Q(_g,Ca),Ca|=x,null;else G!==null?(k=G.baseLanes|P,w.memoizedState=null):k=P,Q(_g,Ca),Ca|=k;return So(x,w,O,P),w.child}function kH(x,w){var P=w.ref;(x===null&&P!==null||x!==null&&x.ref!==P)&&(w.flags|=512,w.flags|=2097152)}function IR(x,w,P,k,O){var G=Kr(P)?at:re.current;return G=Yr(w,G),fg(w,O),P=MR(x,w,P,k,G,O),k=CR(),x!==null&&!Ma?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~O,tc(x,w,O)):(Or&&k&&gR(w),w.flags|=1,So(x,w,P,O),w.child)}function DH(x,w,P,k,O){if(Kr(P)){var G=!0;dn(w)}else G=!1;if(fg(w,O),w.stateNode===null)x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),q5(w,P,k),mR(w,P,k,O),k=!0;else if(x===null){var de=w.stateNode,Te=w.memoizedProps;de.props=Te;var Ze=de.context,mt=P.contextType;typeof mt=="object"&&mt!==null?mt=el(mt):(mt=Kr(P)?at:re.current,mt=Yr(w,mt));var It=P.getDerivedStateFromProps,yi=typeof It=="function"||typeof de.getSnapshotBeforeUpdate=="function";yi||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Te!==k||Ze!==mt)&&X5(w,de,k,mt),cd=!1;var Jt=w.memoizedState;de.state=Jt,F_(w,k,de,O),Ze=w.memoizedState,Te!==k||Jt!==Ze||Ae.current||cd?(typeof It=="function"&&(fR(w,P,It,k),Ze=w.memoizedState),(Te=cd||W5(w,P,Te,k,Jt,Ze,mt))?(yi||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(w.flags|=4194308)):(typeof de.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=k,w.memoizedState=Ze),de.props=k,de.state=Ze,de.context=mt,k=Te):(typeof de.componentDidMount=="function"&&(w.flags|=4194308),k=!1)}else{de=w.stateNode,H5(x,w),Te=w.memoizedProps,mt=w.type===w.elementType?Te:Wl(w.type,Te),de.props=mt,yi=w.pendingProps,Jt=de.context,Ze=P.contextType,typeof Ze=="object"&&Ze!==null?Ze=el(Ze):(Ze=Kr(P)?at:re.current,Ze=Yr(w,Ze));var vr=P.getDerivedStateFromProps;(It=typeof vr=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(Te!==yi||Jt!==Ze)&&X5(w,de,k,Ze),cd=!1,Jt=w.memoizedState,de.state=Jt,F_(w,k,de,O);var jt=w.memoizedState;Te!==yi||Jt!==jt||Ae.current||cd?(typeof vr=="function"&&(fR(w,P,vr,k),jt=w.memoizedState),(mt=cd||W5(w,P,mt,k,Jt,jt,Ze)||!1)?(It||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(k,jt,Ze),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(k,jt,Ze)),typeof de.componentDidUpdate=="function"&&(w.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof de.componentDidUpdate!="function"||Te===x.memoizedProps&&Jt===x.memoizedState||(w.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Te===x.memoizedProps&&Jt===x.memoizedState||(w.flags|=1024),w.memoizedProps=k,w.memoizedState=jt),de.props=k,de.state=jt,de.context=Ze,k=mt):(typeof de.componentDidUpdate!="function"||Te===x.memoizedProps&&Jt===x.memoizedState||(w.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||Te===x.memoizedProps&&Jt===x.memoizedState||(w.flags|=1024),k=!1)}return LR(x,w,P,k,G,O)}function LR(x,w,P,k,O,G){kH(x,w);var de=(w.flags&128)!==0;if(!k&&!de)return O&&dg(w,P,!1),tc(x,w,G);k=w.stateNode,cae.current=w;var Te=de&&typeof P.getDerivedStateFromError!="function"?null:k.render();return w.flags|=1,x!==null&&de?(w.child=vg(w,x.child,null,G),w.child=vg(w,null,Te,G)):So(x,w,Te,G),w.memoizedState=k.state,O&&dg(w,P,!0),w.child}function IH(x){var w=x.stateNode;w.pendingContext?$o(x,w.pendingContext,w.pendingContext!==w.context):w.context&&$o(x,w.context,!1),wR(x,w.containerInfo)}function LH(x,w,P,k,O){return yg(),xR(O),w.flags|=256,So(x,w,P,k),w.child}var eS={dehydrated:null,treeContext:null,retryLane:0};function tS(x){return{baseLanes:x,cachePool:null}}function BH(x,w,P){var k=w.pendingProps,O=Fr.current,G=!1,de=(w.flags&128)!==0,Te;if((Te=de)||(Te=x!==null&&x.memoizedState===null?!1:(O&2)!==0),Te?(G=!0,w.flags&=-129):(x===null||x.memoizedState!==null)&&(O|=1),Q(Fr,O&1),x===null)return bR(w),x=w.memoizedState,x!==null&&(x=x.dehydrated,x!==null)?(w.mode&1?Vl(x)?w.lanes=8:w.lanes=1073741824:w.lanes=1,null):(O=k.children,x=k.fallback,G?(k=w.mode,G=w.child,O={mode:"hidden",children:O},!(k&1)&&G!==null?(G.childLanes=0,G.pendingProps=O):G=wS(O,k,0,null),x=uf(x,k,P,null),G.return=w,x.return=w,G.sibling=x,w.child=G,w.child.memoizedState=tS(P),w.memoizedState=eS,x):BR(w,O));if(O=x.memoizedState,O!==null){if(Te=O.dehydrated,Te!==null){if(de)return w.flags&256?(w.flags&=-257,iS(x,w,P,Error(o(422)))):w.memoizedState!==null?(w.child=x.child,w.flags|=128,null):(G=k.fallback,O=w.mode,k=wS({mode:"visible",children:k.children},O,0,null),G=uf(G,O,P,null),G.flags|=2,k.return=w,G.return=w,k.sibling=G,w.child=k,w.mode&1&&vg(w,x.child,null,P),w.child.memoizedState=tS(P),w.memoizedState=eS,G);if(!(w.mode&1))w=iS(x,w,P,null);else if(Vl(Te))w=iS(x,w,P,Error(o(419)));else if(k=(P&x.childLanes)!==0,Ma||k){if(k=Tn,k!==null){switch(P&-P){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}k=G&(k.suspendedLanes|P)?0:G,k!==0&&k!==O.retryLane&&(O.retryLane=k,sl(x,k,-1))}tk(),w=iS(x,w,P,Error(o(421)))}else Kh(Te)?(w.flags|=128,w.child=x.child,w=Aae.bind(null,x),he(Te,w),w=null):(P=O.treeContext,_e&&(Ea=$e(Te),Aa=w,Or=!0,ql=null,db=!1,P!==null&&(tl[il++]=Zh,tl[il++]=$h,tl[il++]=ef,Zh=P.id,$h=P.overflow,ef=w)),w=BR(w,w.pendingProps.children),w.flags|=4096);return w}return G?(k=UH(x,w,k.children,k.fallback,P),G=w.child,O=x.child.memoizedState,G.memoizedState=O===null?tS(P):{baseLanes:O.baseLanes|P,cachePool:null},G.childLanes=x.childLanes&~P,w.memoizedState=eS,k):(P=OH(x,w,k.children,P),w.memoizedState=null,P)}return G?(k=UH(x,w,k.children,k.fallback,P),G=w.child,O=x.child.memoizedState,G.memoizedState=O===null?tS(P):{baseLanes:O.baseLanes|P,cachePool:null},G.childLanes=x.childLanes&~P,w.memoizedState=eS,k):(P=OH(x,w,k.children,P),w.memoizedState=null,P)}function BR(x,w){return w=wS({mode:"visible",children:w},x.mode,0,null),w.return=x,x.child=w}function OH(x,w,P,k){var O=x.child;return x=O.sibling,P=yd(O,{mode:"visible",children:P}),!(w.mode&1)&&(P.lanes=k),P.return=w,P.sibling=null,x!==null&&(k=w.deletions,k===null?(w.deletions=[x],w.flags|=16):k.push(x)),w.child=P}function UH(x,w,P,k,O){var G=w.mode;x=x.child;var de=x.sibling,Te={mode:"hidden",children:P};return!(G&1)&&w.child!==x?(P=w.child,P.childLanes=0,P.pendingProps=Te,w.deletions=null):(P=yd(x,Te),P.subtreeFlags=x.subtreeFlags&14680064),de!==null?k=yd(de,k):(k=uf(k,G,O,null),k.flags|=2),k.return=w,P.return=w,P.sibling=k,w.child=P,k}function iS(x,w,P,k){return k!==null&&xR(k),vg(w,x.child,null,P),x=BR(w,w.pendingProps.children),x.flags|=2,w.memoizedState=null,x}function NH(x,w,P){x.lanes|=w;var k=x.alternate;k!==null&&(k.lanes|=w),dR(x.return,w,P)}function OR(x,w,P,k,O){var G=x.memoizedState;G===null?x.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:k,tail:P,tailMode:O}:(G.isBackwards=w,G.rendering=null,G.renderingStartTime=0,G.last=k,G.tail=P,G.tailMode=O)}function FH(x,w,P){var k=w.pendingProps,O=k.revealOrder,G=k.tail;if(So(x,w,k.children,P),k=Fr.current,k&2)k=k&1|2,w.flags|=128;else{if(x!==null&&x.flags&128)e:for(x=w.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&NH(x,P,w);else if(x.tag===19)NH(x,P,w);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===w)break e;for(;x.sibling===null;){if(x.return===null||x.return===w)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}k&=1}if(Q(Fr,k),!(w.mode&1))w.memoizedState=null;else switch(O){case"forwards":for(P=w.child,O=null;P!==null;)x=P.alternate,x!==null&&j_(x)===null&&(O=P),P=P.sibling;P=O,P===null?(O=w.child,w.child=null):(O=P.sibling,P.sibling=null),OR(w,!1,O,P,G);break;case"backwards":for(P=null,O=w.child,w.child=null;O!==null;){if(x=O.alternate,x!==null&&j_(x)===null){w.child=O;break}x=O.sibling,O.sibling=P,P=O,O=x}OR(w,!0,P,null,G);break;case"together":OR(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function tc(x,w,P){if(x!==null&&(w.dependencies=x.dependencies),Sg|=w.lanes,!(P&w.childLanes))return null;if(x!==null&&w.child!==x.child)throw Error(o(153));if(w.child!==null){for(x=w.child,P=yd(x,x.pendingProps),w.child=P,P.return=w;x.sibling!==null;)x=x.sibling,P=P.sibling=yd(x,x.pendingProps),P.return=w;P.sibling=null}return w.child}function dae(x,w,P){switch(w.tag){case 3:IH(w),yg();break;case 5:tH(w);break;case 1:Kr(w.type)&&dn(w);break;case 4:wR(w,w.stateNode.containerInfo);break;case 10:z5(w,w.type._context,w.memoizedProps.value);break;case 13:var k=w.memoizedState;if(k!==null)return k.dehydrated!==null?(Q(Fr,Fr.current&1),w.flags|=128,null):P&w.child.childLanes?BH(x,w,P):(Q(Fr,Fr.current&1),x=tc(x,w,P),x!==null?x.sibling:null);Q(Fr,Fr.current&1);break;case 19:if(k=(P&w.childLanes)!==0,x.flags&128){if(k)return FH(x,w,P);w.flags|=128}var O=w.memoizedState;if(O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),Q(Fr,Fr.current),k)break;return null;case 22:case 23:return w.lanes=0,RH(x,w,P)}return tc(x,w,P)}function pae(x,w){switch(yR(w),w.tag){case 1:return Kr(w.type)&&xr(),x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 3:return xg(),W(Ae),W(re),AR(),x=w.flags,x&65536&&!(x&128)?(w.flags=x&-65537|128,w):null;case 5:return _R(w),null;case 13:if(W(Fr),x=w.memoizedState,x!==null&&x.dehydrated!==null){if(w.alternate===null)throw Error(o(340));yg()}return x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 19:return W(Fr),null;case 4:return xg(),null;case 10:return cR(w.type._context),null;case 22:case 23:return ek(),null;case 24:return null;default:return null}}var rS=!1,nf=!1,fae=typeof WeakSet=="function"?WeakSet:Set,Et=null;function nS(x,w){var P=x.ref;if(P!==null)if(typeof P=="function")try{P(null)}catch(k){ia(x,w,k)}else P.current=null}function UR(x,w,P){try{P()}catch(k){ia(x,w,k)}}var zH=!1;function mae(x,w){for(j(x.containerInfo),Et=w;Et!==null;)if(x=Et,w=x.child,(x.subtreeFlags&1028)!==0&&w!==null)w.return=x,Et=w;else for(;Et!==null;){x=Et;try{var P=x.alternate;if(x.flags&1024)switch(x.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var k=P.memoizedProps,O=P.memoizedState,G=x.stateNode,de=G.getSnapshotBeforeUpdate(x.elementType===x.type?k:Wl(x.type,k),O);G.__reactInternalSnapshotBeforeUpdate=de}break;case 3:be&&He(x.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Te){ia(x,x.return,Te)}if(w=x.sibling,w!==null){w.return=x.return,Et=w;break}Et=x.return}return P=zH,zH=!1,P}function sf(x,w,P){var k=w.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var O=k=k.next;do{if((O.tag&x)===x){var G=O.destroy;O.destroy=void 0,G!==void 0&&UR(w,P,G)}O=O.next}while(O!==k)}}function Ab(x,w){if(w=w.updateQueue,w=w!==null?w.lastEffect:null,w!==null){var P=w=w.next;do{if((P.tag&x)===x){var k=P.create;P.destroy=k()}P=P.next}while(P!==w)}}function NR(x){var w=x.ref;if(w!==null){var P=x.stateNode;switch(x.tag){case 5:x=H(P);break;default:x=P}typeof w=="function"?w(x):w.current=x}}function HH(x,w,P){if(Nu&&typeof Nu.onCommitFiberUnmount=="function")try{Nu.onCommitFiberUnmount(I_,w)}catch{}switch(w.tag){case 0:case 11:case 14:case 15:if(x=w.updateQueue,x!==null&&(x=x.lastEffect,x!==null)){var k=x=x.next;do{var O=k,G=O.destroy;O=O.tag,G!==void 0&&(O&2||O&4)&&UR(w,P,G),k=k.next}while(k!==x)}break;case 1:if(nS(w,P),x=w.stateNode,typeof x.componentWillUnmount=="function")try{x.props=w.memoizedProps,x.state=w.memoizedState,x.componentWillUnmount()}catch(de){ia(w,P,de)}break;case 5:nS(w,P);break;case 4:be?XH(x,w,P):ee&&ee&&(w=w.stateNode.containerInfo,P=dt(w),Si(w,P))}}function GH(x,w,P){for(var k=w;;)if(HH(x,k,P),k.child===null||be&&k.tag===4){if(k===w)break;for(;k.sibling===null;){if(k.return===null||k.return===w)return;k=k.return}k.sibling.return=k.return,k=k.sibling}else k.child.return=k,k=k.child}function VH(x){var w=x.alternate;w!==null&&(x.alternate=null,VH(w)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(w=x.stateNode,w!==null&&Xe(w)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}function jH(x){return x.tag===5||x.tag===3||x.tag===4}function WH(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||jH(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function qH(x){if(be){e:{for(var w=x.return;w!==null;){if(jH(w))break e;w=w.return}throw Error(o(160))}var P=w;switch(P.tag){case 5:w=P.stateNode,P.flags&32&&(Nt(w),P.flags&=-33),P=WH(x),zR(x,P,w);break;case 3:case 4:w=P.stateNode.containerInfo,P=WH(x),FR(x,P,w);break;default:throw Error(o(161))}}}function FR(x,w,P){var k=x.tag;if(k===5||k===6)x=x.stateNode,w?ht(P,x,w):ze(P,x);else if(k!==4&&(x=x.child,x!==null))for(FR(x,w,P),x=x.sibling;x!==null;)FR(x,w,P),x=x.sibling}function zR(x,w,P){var k=x.tag;if(k===5||k===6)x=x.stateNode,w?ut(P,x,w):et(P,x);else if(k!==4&&(x=x.child,x!==null))for(zR(x,w,P),x=x.sibling;x!==null;)zR(x,w,P),x=x.sibling}function XH(x,w,P){for(var k=w,O=!1,G,de;;){if(!O){O=k.return;e:for(;;){if(O===null)throw Error(o(160));switch(G=O.stateNode,O.tag){case 5:de=!1;break e;case 3:G=G.containerInfo,de=!0;break e;case 4:G=G.containerInfo,de=!0;break e}O=O.return}O=!0}if(k.tag===5||k.tag===6)GH(x,k,P),de?pt(G,k.stateNode):tt(G,k.stateNode);else if(k.tag===18)de?ke(G,k.stateNode):Be(G,k.stateNode);else if(k.tag===4){if(k.child!==null){G=k.stateNode.containerInfo,de=!0,k.child.return=k,k=k.child;continue}}else if(HH(x,k,P),k.child!==null){k.child.return=k,k=k.child;continue}if(k===w)break;for(;k.sibling===null;){if(k.return===null||k.return===w)return;k=k.return,k.tag===4&&(O=!1)}k.sibling.return=k.return,k=k.sibling}}function HR(x,w){if(be){switch(w.tag){case 0:case 11:case 14:case 15:sf(3,w,w.return),Ab(3,w),sf(5,w,w.return);return;case 1:return;case 5:var P=w.stateNode;if(P!=null){var k=w.memoizedProps;x=x!==null?x.memoizedProps:k;var O=w.type,G=w.updateQueue;w.updateQueue=null,G!==null&&rt(P,G,O,x,k,w)}return;case 6:if(w.stateNode===null)throw Error(o(162));P=w.memoizedProps,ge(w.stateNode,x!==null?x.memoizedProps:P,P);return;case 3:_e&&x!==null&&x.memoizedState.isDehydrated&&Pe(w.stateNode.containerInfo);return;case 12:return;case 13:sS(w);return;case 19:sS(w);return;case 17:return}throw Error(o(163))}switch(w.tag){case 0:case 11:case 14:case 15:sf(3,w,w.return),Ab(3,w),sf(5,w,w.return);return;case 12:return;case 13:sS(w);return;case 19:sS(w);return;case 3:_e&&x!==null&&x.memoizedState.isDehydrated&&Pe(w.stateNode.containerInfo);break;case 22:case 23:return}e:if(ee){switch(w.tag){case 1:case 5:case 6:break e;case 3:case 4:w=w.stateNode,Si(w.containerInfo,w.pendingChildren);break e}throw Error(o(163))}}function sS(x){var w=x.updateQueue;if(w!==null){x.updateQueue=null;var P=x.stateNode;P===null&&(P=x.stateNode=new fae),w.forEach(function(k){var O=Eae.bind(null,x,k);P.has(k)||(P.add(k),k.then(O,O))})}}function gae(x,w){for(Et=w;Et!==null;){w=Et;var P=w.deletions;if(P!==null)for(var k=0;k<P.length;k++){var O=P[k];try{var G=x;be?XH(G,O,w):GH(G,O,w);var de=O.alternate;de!==null&&(de.return=null),O.return=null}catch(Vt){ia(O,w,Vt)}}if(P=w.child,w.subtreeFlags&12854&&P!==null)P.return=w,Et=P;else for(;Et!==null;){w=Et;try{var Te=w.flags;if(Te&32&&be&&Nt(w.stateNode),Te&512){var Ze=w.alternate;if(Ze!==null){var mt=Ze.ref;mt!==null&&(typeof mt=="function"?mt(null):mt.current=null)}}if(Te&8192)switch(w.tag){case 13:if(w.memoizedState!==null){var It=w.alternate;(It===null||It.memoizedState===null)&&(YR=us())}break;case 22:var yi=w.memoizedState!==null,Jt=w.alternate,vr=Jt!==null&&Jt.memoizedState!==null;if(P=w,be){e:if(k=P,O=yi,G=null,be)for(var jt=k;;){if(jt.tag===5){if(G===null){G=jt;var $s=jt.stateNode;O?ti($s):Ge(jt.stateNode,jt.memoizedProps)}}else if(jt.tag===6){if(G===null){var al=jt.stateNode;O?xe(al):ie(al,jt.memoizedProps)}}else if((jt.tag!==22&&jt.tag!==23||jt.memoizedState===null||jt===k)&&jt.child!==null){jt.child.return=jt,jt=jt.child;continue}if(jt===k)break;for(;jt.sibling===null;){if(jt.return===null||jt.return===k)break e;G===jt&&(G=null),jt=jt.return}G===jt&&(G=null),jt.sibling.return=jt.return,jt=jt.sibling}}if(yi&&!vr&&P.mode&1){Et=P;for(var We=P.child;We!==null;){for(P=Et=We;Et!==null;){k=Et;var Ie=k.child;switch(k.tag){case 0:case 11:case 14:case 15:sf(4,k,k.return);break;case 1:nS(k,k.return);var Ke=k.stateNode;if(typeof Ke.componentWillUnmount=="function"){var Ct=k.return;try{Ke.props=k.memoizedProps,Ke.state=k.memoizedState,Ke.componentWillUnmount()}catch(Vt){ia(k,Ct,Vt)}}break;case 5:nS(k,k.return);break;case 22:if(k.memoizedState!==null){JH(P);continue}}Ie!==null?(Ie.return=k,Et=Ie):JH(P)}We=We.sibling}}}switch(Te&4102){case 2:qH(w),w.flags&=-3;break;case 6:qH(w),w.flags&=-3,HR(w.alternate,w);break;case 4096:w.flags&=-4097;break;case 4100:w.flags&=-4097,HR(w.alternate,w);break;case 4:HR(w.alternate,w)}}catch(Vt){ia(w,w.return,Vt)}if(P=w.sibling,P!==null){P.return=w.return,Et=P;break}Et=w.return}}}function yae(x,w,P){Et=x,YH(x)}function YH(x,w,P){for(var k=(x.mode&1)!==0;Et!==null;){var O=Et,G=O.child;if(O.tag===22&&k){var de=O.memoizedState!==null||rS;if(!de){var Te=O.alternate,Ze=Te!==null&&Te.memoizedState!==null||nf;Te=rS;var mt=nf;if(rS=de,(nf=Ze)&&!mt)for(Et=O;Et!==null;)de=Et,Ze=de.child,de.tag===22&&de.memoizedState!==null?QH(O):Ze!==null?(Ze.return=de,Et=Ze):QH(O);for(;G!==null;)Et=G,YH(G),G=G.sibling;Et=O,rS=Te,nf=mt}KH(x)}else O.subtreeFlags&8772&&G!==null?(G.return=O,Et=G):KH(x)}}function KH(x){for(;Et!==null;){var w=Et;if(w.flags&8772){var P=w.alternate;try{if(w.flags&8772)switch(w.tag){case 0:case 11:case 15:nf||Ab(5,w);break;case 1:var k=w.stateNode;if(w.flags&4&&!nf)if(P===null)k.componentDidMount();else{var O=w.elementType===w.type?P.memoizedProps:Wl(w.type,P.memoizedProps);k.componentDidUpdate(O,P.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var G=w.updateQueue;G!==null&&V5(w,G,k);break;case 3:var de=w.updateQueue;if(de!==null){if(P=null,w.child!==null)switch(w.child.tag){case 5:P=H(w.child.stateNode);break;case 1:P=w.child.stateNode}V5(w,de,P)}break;case 5:var Te=w.stateNode;P===null&&w.flags&4&&ct(Te,w.type,w.memoizedProps,w);break;case 6:break;case 4:break;case 12:break;case 13:if(_e&&w.memoizedState===null){var Ze=w.alternate;if(Ze!==null){var mt=Ze.memoizedState;if(mt!==null){var It=mt.dehydrated;It!==null&&De(It)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}nf||w.flags&512&&NR(w)}catch(yi){ia(w,w.return,yi)}}if(w===x){Et=null;break}if(P=w.sibling,P!==null){P.return=w.return,Et=P;break}Et=w.return}}function JH(x){for(;Et!==null;){var w=Et;if(w===x){Et=null;break}var P=w.sibling;if(P!==null){P.return=w.return,Et=P;break}Et=w.return}}function QH(x){for(;Et!==null;){var w=Et;try{switch(w.tag){case 0:case 11:case 15:var P=w.return;try{Ab(4,w)}catch(Ze){ia(w,P,Ze)}break;case 1:var k=w.stateNode;if(typeof k.componentDidMount=="function"){var O=w.return;try{k.componentDidMount()}catch(Ze){ia(w,O,Ze)}}var G=w.return;try{NR(w)}catch(Ze){ia(w,G,Ze)}break;case 5:var de=w.return;try{NR(w)}catch(Ze){ia(w,de,Ze)}}}catch(Ze){ia(w,w.return,Ze)}if(w===x){Et=null;break}var Te=w.sibling;if(Te!==null){Te.return=w.return,Et=Te;break}Et=w.return}}var oS=0,aS=1,lS=2,uS=3,hS=4;if(typeof Symbol=="function"&&Symbol.for){var Eb=Symbol.for;oS=Eb("selector.component"),aS=Eb("selector.has_pseudo_class"),lS=Eb("selector.role"),uS=Eb("selector.test_id"),hS=Eb("selector.text")}function GR(x){var w=Me(x);if(w!=null){if(typeof w.memoizedProps["data-testname"]!="string")throw Error(o(364));return w}if(x=we(x),x===null)throw Error(o(362));return x.stateNode.current}function VR(x,w){switch(w.$$typeof){case oS:if(x.type===w.value)return!0;break;case aS:e:{w=w.value,x=[x,0];for(var P=0;P<x.length;){var k=x[P++],O=x[P++],G=w[O];if(k.tag!==5||!ce(k)){for(;G!=null&&VR(k,G);)O++,G=w[O];if(O===w.length){w=!0;break e}else for(k=k.child;k!==null;)x.push(k,O),k=k.sibling}}w=!1}return w;case lS:if(x.tag===5&&Le(x.stateNode,w.value))return!0;break;case hS:if((x.tag===5||x.tag===6)&&(x=Y(x),x!==null&&0<=x.indexOf(w.value)))return!0;break;case uS:if(x.tag===5&&(x=x.memoizedProps["data-testname"],typeof x=="string"&&x.toLowerCase()===w.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function jR(x){switch(x.$$typeof){case oS:return"<"+(E(x.value)||"Unknown")+">";case aS:return":has("+(jR(x)||"")+")";case lS:return'[role="'+x.value+'"]';case hS:return'"'+x.value+'"';case uS:return'[data-testname="'+x.value+'"]';default:throw Error(o(365))}}function ZH(x,w){var P=[];x=[x,0];for(var k=0;k<x.length;){var O=x[k++],G=x[k++],de=w[G];if(O.tag!==5||!ce(O)){for(;de!=null&&VR(O,de);)G++,de=w[G];if(G===w.length)P.push(O);else for(O=O.child;O!==null;)x.push(O,G),O=O.sibling}}return P}function WR(x,w){if(!J)throw Error(o(363));x=GR(x),x=ZH(x,w),w=[],x=Array.from(x);for(var P=0;P<x.length;){var k=x[P++];if(k.tag===5)ce(k)||w.push(k.stateNode);else for(k=k.child;k!==null;)x.push(k),k=k.sibling}return w}var vae=Math.ceil,cS=a.ReactCurrentDispatcher,qR=a.ReactCurrentOwner,pn=a.ReactCurrentBatchConfig,Ci=0,Tn=null,Rn=null,Ds=0,Ca=0,_g=rr(0),Xn=0,Mb=null,Sg=0,dS=0,XR=0,Cb=null,ea=null,YR=0,KR=1/0;function Ag(){KR=us()+500}var pS=!1,JR=null,pd=null,fS=!1,fd=null,mS=0,Pb=0,QR=null,gS=-1,yS=0;function Ao(){return Ci&6?us():gS!==-1?gS:gS=us()}function md(x){return x.mode&1?Ci&2&&Ds!==0?Ds&-Ds:eae.transition!==null?(yS===0&&(x=R_,R_<<=1,!(R_&4194240)&&(R_=64),yS=x),yS):(x=Wi,x!==0?x:Re()):1}function sl(x,w,P){if(50<Pb)throw Pb=0,QR=null,Error(o(185));var k=vS(x,w);return k===null?null:(cb(k,w,P),(!(Ci&2)||k!==Tn)&&(k===Tn&&(!(Ci&2)&&(dS|=w),Xn===4&&gd(k,Ds)),ta(k,P),w===1&&Ci===0&&!(x.mode&1)&&(Ag(),L_&&zu())),k)}function vS(x,w){x.lanes|=w;var P=x.alternate;for(P!==null&&(P.lanes|=w),P=x,x=x.return;x!==null;)x.childLanes|=w,P=x.alternate,P!==null&&(P.childLanes|=w),P=x,x=x.return;return P.tag===3?P.stateNode:null}function ta(x,w){var P=x.callbackNode;Woe(x,w);var k=D_(x,x===Tn?Ds:0);if(k===0)P!==null&&N5(P),x.callbackNode=null,x.callbackPriority=0;else if(w=k&-k,x.callbackPriority!==w){if(P!=null&&N5(P),w===1)x.tag===0?$oe(eG.bind(null,x)):F5(eG.bind(null,x)),Oe?$(function(){Ci===0&&zu()}):sR(oR,zu),P=null;else{switch(U5(k)){case 1:P=oR;break;case 4:P=Koe;break;case 16:P=aR;break;case 536870912:P=Joe;break;default:P=aR}P=uG(P,$H.bind(null,x))}x.callbackPriority=w,x.callbackNode=P}}function $H(x,w){if(gS=-1,yS=0,Ci&6)throw Error(o(327));var P=x.callbackNode;if(lf()&&x.callbackNode!==P)return null;var k=D_(x,x===Tn?Ds:0);if(k===0)return null;if(k&30||k&x.expiredLanes||w)w=bS(x,k);else{w=k;var O=Ci;Ci|=2;var G=rG();(Tn!==x||Ds!==w)&&(Ag(),of(x,w));do try{wae();break}catch(Te){iG(x,Te)}while(1);hR(),cS.current=G,Ci=O,Rn!==null?w=0:(Tn=null,Ds=0,w=Xn)}if(w!==0){if(w===2&&(O=iR(x),O!==0&&(k=O,w=ZR(x,O))),w===1)throw P=Mb,of(x,0),gd(x,k),ta(x,us()),P;if(w===6)gd(x,k);else{if(O=x.current.alternate,!(k&30)&&!bae(O)&&(w=bS(x,k),w===2&&(G=iR(x),G!==0&&(k=G,w=ZR(x,G))),w===1))throw P=Mb,of(x,0),gd(x,k),ta(x,us()),P;switch(x.finishedWork=O,x.finishedLanes=k,w){case 0:case 1:throw Error(o(345));case 2:af(x,ea);break;case 3:if(gd(x,k),(k&130023424)===k&&(w=YR+500-us(),10<w)){if(D_(x,0)!==0)break;if(O=x.suspendedLanes,(O&k)!==k){Ao(),x.pingedLanes|=x.suspendedLanes&O;break}x.timeoutHandle=ve(af.bind(null,x,ea),w);break}af(x,ea);break;case 4:if(gd(x,k),(k&4194240)===k)break;for(w=x.eventTimes,O=-1;0<k;){var de=31-Sa(k);G=1<<de,de=w[de],de>O&&(O=de),k&=~G}if(k=O,k=us()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*vae(k/1960))-k,10<k){x.timeoutHandle=ve(af.bind(null,x,ea),k);break}af(x,ea);break;case 5:af(x,ea);break;default:throw Error(o(329))}}}return ta(x,us()),x.callbackNode===P?$H.bind(null,x):null}function ZR(x,w){var P=Cb;return x.current.memoizedState.isDehydrated&&(of(x,w).flags|=256),x=bS(x,w),x!==2&&(w=ea,ea=P,w!==null&&$R(w)),x}function $R(x){ea===null?ea=x:ea.push.apply(ea,x)}function bae(x){for(var w=x;;){if(w.flags&16384){var P=w.updateQueue;if(P!==null&&(P=P.stores,P!==null))for(var k=0;k<P.length;k++){var O=P[k],G=O.getSnapshot;O=O.value;try{if(!Fu(G(),O))return!1}catch{return!1}}}if(P=w.child,w.subtreeFlags&16384&&P!==null)P.return=w,w=P;else{if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function gd(x,w){for(w&=~XR,w&=~dS,x.suspendedLanes|=w,x.pingedLanes&=~w,x=x.expirationTimes;0<w;){var P=31-Sa(w),k=1<<P;x[P]=-1,w&=~k}}function eG(x){if(Ci&6)throw Error(o(327));lf();var w=D_(x,0);if(!(w&1))return ta(x,us()),null;var P=bS(x,w);if(x.tag!==0&&P===2){var k=iR(x);k!==0&&(w=k,P=ZR(x,k))}if(P===1)throw P=Mb,of(x,0),gd(x,w),ta(x,us()),P;if(P===6)throw Error(o(345));return x.finishedWork=x.current.alternate,x.finishedLanes=w,af(x,ea),ta(x,us()),null}function tG(x){fd!==null&&fd.tag===0&&!(Ci&6)&&lf();var w=Ci;Ci|=1;var P=pn.transition,k=Wi;try{if(pn.transition=null,Wi=1,x)return x()}finally{Wi=k,pn.transition=P,Ci=w,!(Ci&6)&&zu()}}function ek(){Ca=_g.current,W(_g)}function of(x,w){x.finishedWork=null,x.finishedLanes=0;var P=x.timeoutHandle;if(P!==pe&&(x.timeoutHandle=pe,ye(P)),Rn!==null)for(P=Rn.return;P!==null;){var k=P;switch(yR(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&xr();break;case 3:xg(),W(Ae),W(re),AR();break;case 5:_R(k);break;case 4:xg();break;case 13:W(Fr);break;case 19:W(Fr);break;case 10:cR(k.type._context);break;case 22:case 23:ek()}P=P.return}if(Tn=x,Rn=x=yd(x.current,null),Ds=Ca=w,Xn=0,Mb=null,XR=dS=Sg=0,ea=Cb=null,Hu!==null){for(w=0;w<Hu.length;w++)if(P=Hu[w],k=P.interleaved,k!==null){P.interleaved=null;var O=k.next,G=P.pending;if(G!==null){var de=G.next;G.next=O,k.next=de}P.pending=k}Hu=null}return x}function iG(x,w){do{var P=Rn;try{if(hR(),W_.current=Q_,q_){for(var k=Jr.memoizedState;k!==null;){var O=k.queue;O!==null&&(O.pending=null),k=k.next}q_=!1}if(wg=0,hs=Js=Jr=null,yb=!1,vb=0,qR.current=null,P===null||P.return===null){Xn=1,Mb=w,Rn=null;break}e:{var G=x,de=P.return,Te=P,Ze=w;if(w=Ds,Te.flags|=32768,Ze!==null&&typeof Ze=="object"&&typeof Ze.then=="function"){var mt=Ze,It=Te,yi=It.tag;if(!(It.mode&1)&&(yi===0||yi===11||yi===15)){var Jt=It.alternate;Jt?(It.updateQueue=Jt.updateQueue,It.memoizedState=Jt.memoizedState,It.lanes=Jt.lanes):(It.updateQueue=null,It.memoizedState=null)}var vr=SH(de);if(vr!==null){vr.flags&=-257,AH(vr,de,Te,G,w),vr.mode&1&&_H(G,mt,w),w=vr,Ze=mt;var jt=w.updateQueue;if(jt===null){var $s=new Set;$s.add(Ze),w.updateQueue=$s}else jt.add(Ze);break e}else{if(!(w&1)){_H(G,mt,w),tk();break e}Ze=Error(o(426))}}else if(Or&&Te.mode&1){var al=SH(de);if(al!==null){!(al.flags&65536)&&(al.flags|=256),AH(al,de,Te,G,w),xR(Ze);break e}}G=Ze,Xn!==4&&(Xn=2),Cb===null?Cb=[G]:Cb.push(G),Ze=kR(Ze,Te),Te=de;do{switch(Te.tag){case 3:Te.flags|=65536,w&=-w,Te.lanes|=w;var We=xH(Te,Ze,w);G5(Te,We);break e;case 1:G=Ze;var Ie=Te.type,Ke=Te.stateNode;if(!(Te.flags&128)&&(typeof Ie.getDerivedStateFromError=="function"||Ke!==null&&typeof Ke.componentDidCatch=="function"&&(pd===null||!pd.has(Ke)))){Te.flags|=65536,w&=-w,Te.lanes|=w;var Ct=wH(Te,G,w);G5(Te,Ct);break e}}Te=Te.return}while(Te!==null)}sG(P)}catch(Vt){w=Vt,Rn===P&&P!==null&&(Rn=P=P.return);continue}break}while(1)}function rG(){var x=cS.current;return cS.current=Q_,x===null?Q_:x}function tk(){(Xn===0||Xn===3||Xn===2)&&(Xn=4),Tn===null||!(Sg&268435455)&&!(dS&268435455)||gd(Tn,Ds)}function bS(x,w){var P=Ci;Ci|=2;var k=rG();Tn===x&&Ds===w||of(x,w);do try{xae();break}catch(O){iG(x,O)}while(1);if(hR(),Ci=P,cS.current=k,Rn!==null)throw Error(o(261));return Tn=null,Ds=0,Xn}function xae(){for(;Rn!==null;)nG(Rn)}function wae(){for(;Rn!==null&&!Xoe();)nG(Rn)}function nG(x){var w=lG(x.alternate,x,Ca);x.memoizedProps=x.pendingProps,w===null?sG(x):Rn=w,qR.current=null}function sG(x){var w=x;do{var P=w.alternate;if(x=w.return,w.flags&32768){if(P=pae(P,w),P!==null){P.flags&=32767,Rn=P;return}if(x!==null)x.flags|=32768,x.subtreeFlags=0,x.deletions=null;else{Xn=6,Rn=null;return}}else if(P=hae(P,w,Ca),P!==null){Rn=P;return}if(w=w.sibling,w!==null){Rn=w;return}Rn=w=x}while(w!==null);Xn===0&&(Xn=5)}function af(x,w){var P=Wi,k=pn.transition;try{pn.transition=null,Wi=1,_ae(x,w,P)}finally{pn.transition=k,Wi=P}return null}function _ae(x,w,P){do lf();while(fd!==null);if(Ci&6)throw Error(o(327));var k=x.finishedWork,O=x.finishedLanes;if(k===null)return null;if(x.finishedWork=null,x.finishedLanes=0,k===x.current)throw Error(o(177));x.callbackNode=null,x.callbackPriority=0;var G=k.lanes|k.childLanes;if(qoe(x,G),x===Tn&&(Rn=Tn=null,Ds=0),!(k.subtreeFlags&2064)&&!(k.flags&2064)||fS||(fS=!0,uG(aR,function(){return lf(),null})),G=(k.flags&15990)!==0,k.subtreeFlags&15990||G){G=pn.transition,pn.transition=null;var de=Wi;Wi=1;var Te=Ci;Ci|=4,qR.current=null,mae(x,k),gae(x,k),V(x.containerInfo),x.current=k,yae(k),Yoe(),Ci=Te,Wi=de,pn.transition=G}else x.current=k;if(fS&&(fS=!1,fd=x,mS=O),G=x.pendingLanes,G===0&&(pd=null),Qoe(k.stateNode),ta(x,us()),w!==null)for(P=x.onRecoverableError,k=0;k<w.length;k++)P(w[k]);if(pS)throw pS=!1,x=JR,JR=null,x;return mS&1&&x.tag!==0&&lf(),G=x.pendingLanes,G&1?x===QR?Pb++:(Pb=0,QR=x):Pb=0,zu(),null}function lf(){if(fd!==null){var x=U5(mS),w=pn.transition,P=Wi;try{if(pn.transition=null,Wi=16>x?16:x,fd===null)var k=!1;else{if(x=fd,fd=null,mS=0,Ci&6)throw Error(o(331));var O=Ci;for(Ci|=4,Et=x.current;Et!==null;){var G=Et,de=G.child;if(Et.flags&16){var Te=G.deletions;if(Te!==null){for(var Ze=0;Ze<Te.length;Ze++){var mt=Te[Ze];for(Et=mt;Et!==null;){var It=Et;switch(It.tag){case 0:case 11:case 15:sf(8,It,G)}var yi=It.child;if(yi!==null)yi.return=It,Et=yi;else for(;Et!==null;){It=Et;var Jt=It.sibling,vr=It.return;if(VH(It),It===mt){Et=null;break}if(Jt!==null){Jt.return=vr,Et=Jt;break}Et=vr}}}var jt=G.alternate;if(jt!==null){var $s=jt.child;if($s!==null){jt.child=null;do{var al=$s.sibling;$s.sibling=null,$s=al}while($s!==null)}}Et=G}}if(G.subtreeFlags&2064&&de!==null)de.return=G,Et=de;else e:for(;Et!==null;){if(G=Et,G.flags&2048)switch(G.tag){case 0:case 11:case 15:sf(9,G,G.return)}var We=G.sibling;if(We!==null){We.return=G.return,Et=We;break e}Et=G.return}}var Ie=x.current;for(Et=Ie;Et!==null;){de=Et;var Ke=de.child;if(de.subtreeFlags&2064&&Ke!==null)Ke.return=de,Et=Ke;else e:for(de=Ie;Et!==null;){if(Te=Et,Te.flags&2048)try{switch(Te.tag){case 0:case 11:case 15:Ab(9,Te)}}catch(Vt){ia(Te,Te.return,Vt)}if(Te===de){Et=null;break e}var Ct=Te.sibling;if(Ct!==null){Ct.return=Te.return,Et=Ct;break e}Et=Te.return}}if(Ci=O,zu(),Nu&&typeof Nu.onPostCommitFiberRoot=="function")try{Nu.onPostCommitFiberRoot(I_,x)}catch{}k=!0}return k}finally{Wi=P,pn.transition=w}}return!1}function oG(x,w,P){w=kR(P,w),w=xH(x,w,1),dd(x,w),w=Ao(),x=vS(x,1),x!==null&&(cb(x,1,w),ta(x,w))}function ia(x,w,P){if(x.tag===3)oG(x,x,P);else for(;w!==null;){if(w.tag===3){oG(w,x,P);break}else if(w.tag===1){var k=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(pd===null||!pd.has(k))){x=kR(P,x),x=wH(w,x,1),dd(w,x),x=Ao(),w=vS(w,1),w!==null&&(cb(w,1,x),ta(w,x));break}}w=w.return}}function Sae(x,w,P){var k=x.pingCache;k!==null&&k.delete(w),w=Ao(),x.pingedLanes|=x.suspendedLanes&P,Tn===x&&(Ds&P)===P&&(Xn===4||Xn===3&&(Ds&130023424)===Ds&&500>us()-YR?of(x,0):XR|=P),ta(x,w)}function aG(x,w){w===0&&(x.mode&1?(w=k_,k_<<=1,!(k_&130023424)&&(k_=4194304)):w=1);var P=Ao();x=vS(x,w),x!==null&&(cb(x,w,P),ta(x,P))}function Aae(x){var w=x.memoizedState,P=0;w!==null&&(P=w.retryLane),aG(x,P)}function Eae(x,w){var P=0;switch(x.tag){case 13:var k=x.stateNode,O=x.memoizedState;O!==null&&(P=O.retryLane);break;case 19:k=x.stateNode;break;default:throw Error(o(314))}k!==null&&k.delete(w),aG(x,P)}var lG;lG=function(x,w,P){if(x!==null)if(x.memoizedProps!==w.pendingProps||Ae.current)Ma=!0;else{if(!(x.lanes&P)&&!(w.flags&128))return Ma=!1,dae(x,w,P);Ma=!!(x.flags&131072)}else Ma=!1,Or&&w.flags&1048576&&Y5(w,G_,w.index);switch(w.lanes=0,w.tag){case 2:var k=w.type;x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),x=w.pendingProps;var O=Yr(w,re.current);fg(w,P),O=MR(null,w,k,x,O,P);var G=CR();return w.flags|=1,typeof O=="object"&&O!==null&&typeof O.render=="function"&&O.$$typeof===void 0?(w.tag=1,w.memoizedState=null,w.updateQueue=null,Kr(k)?(G=!0,dn(w)):G=!1,w.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,pR(w),O.updater=z_,w.stateNode=O,O._reactInternals=w,mR(w,k,x,P),w=LR(null,w,k,!0,G,P)):(w.tag=0,Or&&G&&gR(w),So(null,w,O,P),w=w.child),w;case 16:k=w.elementType;e:{switch(x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),x=w.pendingProps,O=k._init,k=O(k._payload),w.type=k,O=w.tag=Cae(k),x=Wl(k,x),O){case 0:w=IR(null,w,k,x,P);break e;case 1:w=DH(null,w,k,x,P);break e;case 11:w=CH(null,w,k,x,P);break e;case 14:w=PH(null,w,k,Wl(k.type,x),P);break e}throw Error(o(306,k,""))}return w;case 0:return k=w.type,O=w.pendingProps,O=w.elementType===k?O:Wl(k,O),IR(x,w,k,O,P);case 1:return k=w.type,O=w.pendingProps,O=w.elementType===k?O:Wl(k,O),DH(x,w,k,O,P);case 3:e:{if(IH(w),x===null)throw Error(o(387));k=w.pendingProps,G=w.memoizedState,O=G.element,H5(x,w),F_(w,k,null,P);var de=w.memoizedState;if(k=de.element,_e&&G.isDehydrated)if(G={element:k,isDehydrated:!1,cache:de.cache,transitions:de.transitions},w.updateQueue.baseState=G,w.memoizedState=G,w.flags&256){O=Error(o(423)),w=LH(x,w,k,P,O);break e}else if(k!==O){O=Error(o(424)),w=LH(x,w,k,P,O);break e}else for(_e&&(Ea=Ne(w.stateNode.containerInfo),Aa=w,Or=!0,ql=null,db=!1),P=eH(w,null,k,P),w.child=P;P;)P.flags=P.flags&-3|4096,P=P.sibling;else{if(yg(),k===O){w=tc(x,w,P);break e}So(x,w,k,P)}w=w.child}return w;case 5:return tH(w),x===null&&bR(w),k=w.type,O=w.pendingProps,G=x!==null?x.memoizedProps:null,de=O.children,oe(k,O)?de=null:G!==null&&oe(k,G)&&(w.flags|=32),kH(x,w),So(x,w,de,P),w.child;case 6:return x===null&&bR(w),null;case 13:return BH(x,w,P);case 4:return wR(w,w.stateNode.containerInfo),k=w.pendingProps,x===null?w.child=vg(w,null,k,P):So(x,w,k,P),w.child;case 11:return k=w.type,O=w.pendingProps,O=w.elementType===k?O:Wl(k,O),CH(x,w,k,O,P);case 7:return So(x,w,w.pendingProps,P),w.child;case 8:return So(x,w,w.pendingProps.children,P),w.child;case 12:return So(x,w,w.pendingProps.children,P),w.child;case 10:e:{if(k=w.type._context,O=w.pendingProps,G=w.memoizedProps,de=O.value,z5(w,k,de),G!==null)if(Fu(G.value,de)){if(G.children===O.children&&!Ae.current){w=tc(x,w,P);break e}}else for(G=w.child,G!==null&&(G.return=w);G!==null;){var Te=G.dependencies;if(Te!==null){de=G.child;for(var Ze=Te.firstContext;Ze!==null;){if(Ze.context===k){if(G.tag===1){Ze=Qh(-1,P&-P),Ze.tag=2;var mt=G.updateQueue;if(mt!==null){mt=mt.shared;var It=mt.pending;It===null?Ze.next=Ze:(Ze.next=It.next,It.next=Ze),mt.pending=Ze}}G.lanes|=P,Ze=G.alternate,Ze!==null&&(Ze.lanes|=P),dR(G.return,P,w),Te.lanes|=P;break}Ze=Ze.next}}else if(G.tag===10)de=G.type===w.type?null:G.child;else if(G.tag===18){if(de=G.return,de===null)throw Error(o(341));de.lanes|=P,Te=de.alternate,Te!==null&&(Te.lanes|=P),dR(de,P,w),de=G.sibling}else de=G.child;if(de!==null)de.return=G;else for(de=G;de!==null;){if(de===w){de=null;break}if(G=de.sibling,G!==null){G.return=de.return,de=G;break}de=de.return}G=de}So(x,w,O.children,P),w=w.child}return w;case 9:return O=w.type,k=w.pendingProps.children,fg(w,P),O=el(O),k=k(O),w.flags|=1,So(x,w,k,P),w.child;case 14:return k=w.type,O=Wl(k,w.pendingProps),O=Wl(k.type,O),PH(x,w,k,O,P);case 15:return TH(x,w,w.type,w.pendingProps,P);case 17:return k=w.type,O=w.pendingProps,O=w.elementType===k?O:Wl(k,O),x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),w.tag=1,Kr(k)?(x=!0,dn(w)):x=!1,fg(w,P),q5(w,k,O),mR(w,k,O,P),LR(null,w,k,!0,x,P);case 19:return FH(x,w,P);case 22:return RH(x,w,P)}throw Error(o(156,w.tag))};function uG(x,w){return sR(x,w)}function Mae(x,w,P,k){this.tag=x,this.key=P,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ol(x,w,P,k){return new Mae(x,w,P,k)}function ik(x){return x=x.prototype,!(!x||!x.isReactComponent)}function Cae(x){if(typeof x=="function")return ik(x)?1:0;if(x!=null){if(x=x.$$typeof,x===m)return 11;if(x===v)return 14}return 2}function yd(x,w){var P=x.alternate;return P===null?(P=ol(x.tag,w,x.key,x.mode),P.elementType=x.elementType,P.type=x.type,P.stateNode=x.stateNode,P.alternate=x,x.alternate=P):(P.pendingProps=w,P.type=x.type,P.flags=0,P.subtreeFlags=0,P.deletions=null),P.flags=x.flags&14680064,P.childLanes=x.childLanes,P.lanes=x.lanes,P.child=x.child,P.memoizedProps=x.memoizedProps,P.memoizedState=x.memoizedState,P.updateQueue=x.updateQueue,w=x.dependencies,P.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},P.sibling=x.sibling,P.index=x.index,P.ref=x.ref,P}function xS(x,w,P,k,O,G){var de=2;if(k=x,typeof x=="function")ik(x)&&(de=1);else if(typeof x=="string")de=5;else e:switch(x){case c:return uf(P.children,O,G,w);case h:de=8,O|=8;break;case d:return x=ol(12,P,w,O|2),x.elementType=d,x.lanes=G,x;case g:return x=ol(13,P,w,O),x.elementType=g,x.lanes=G,x;case y:return x=ol(19,P,w,O),x.elementType=y,x.lanes=G,x;case _:return wS(P,O,G,w);default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case p:de=10;break e;case f:de=9;break e;case m:de=11;break e;case v:de=14;break e;case b:de=16,k=null;break e}throw Error(o(130,x==null?x:typeof x,""))}return w=ol(de,P,w,O),w.elementType=x,w.type=k,w.lanes=G,w}function uf(x,w,P,k){return x=ol(7,x,k,w),x.lanes=P,x}function wS(x,w,P,k){return x=ol(22,x,k,w),x.elementType=_,x.lanes=P,x.stateNode={},x}function rk(x,w,P){return x=ol(6,x,null,w),x.lanes=P,x}function nk(x,w,P){return w=ol(4,x.children!==null?x.children:[],x.key,w),w.lanes=P,w.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},w}function Pae(x,w,P,k,O){this.tag=w,this.containerInfo=x,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=pe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rR(0),this.expirationTimes=rR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rR(0),this.identifierPrefix=k,this.onRecoverableError=O,_e&&(this.mutableSourceEagerHydrationData=null)}function hG(x,w,P,k,O,G,de,Te,Ze){return x=new Pae(x,w,P,Te,Ze),w===1?(w=1,G===!0&&(w|=8)):w=0,G=ol(3,null,null,w),x.current=G,G.stateNode=x,G.memoizedState={element:k,isDehydrated:P,cache:null,transitions:null},pR(G),x}function cG(x){if(!x)return fe;x=x._reactInternals;e:{if(R(x)!==x||x.tag!==1)throw Error(o(170));var w=x;do{switch(w.tag){case 3:w=w.stateNode.context;break e;case 1:if(Kr(w.type)){w=w.stateNode.__reactInternalMemoizedMergedChildContext;break e}}w=w.return}while(w!==null);throw Error(o(171))}if(x.tag===1){var P=x.type;if(Kr(P))return jl(x,P,w)}return w}function dG(x){var w=x._reactInternals;if(w===void 0)throw typeof x.render=="function"?Error(o(188)):(x=Object.keys(x).join(","),Error(o(268,x)));return x=L(w),x===null?null:x.stateNode}function pG(x,w){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var P=x.retryLane;x.retryLane=P!==0&&P<w?P:w}}function sk(x,w){pG(x,w),(x=x.alternate)&&pG(x,w)}function Tae(x){return x=L(x),x===null?null:x.stateNode}function Rae(){return null}return i.attemptContinuousHydration=function(x){if(x.tag===13){var w=Ao();sl(x,134217728,w),sk(x,134217728)}},i.attemptHydrationAtCurrentPriority=function(x){if(x.tag===13){var w=Ao(),P=md(x);sl(x,P,w),sk(x,P)}},i.attemptSynchronousHydration=function(x){switch(x.tag){case 3:var w=x.stateNode;if(w.current.memoizedState.isDehydrated){var P=hb(w.pendingLanes);P!==0&&(nR(w,P|1),ta(w,us()),!(Ci&6)&&(Ag(),zu()))}break;case 13:var k=Ao();tG(function(){return sl(x,1,k)}),sk(x,1)}},i.batchedUpdates=function(x,w){var P=Ci;Ci|=1;try{return x(w)}finally{Ci=P,Ci===0&&(Ag(),L_&&zu())}},i.createComponentSelector=function(x){return{$$typeof:oS,value:x}},i.createContainer=function(x,w,P,k,O,G,de){return hG(x,w,!1,null,P,k,O,G,de)},i.createHasPseudoClassSelector=function(x){return{$$typeof:aS,value:x}},i.createHydrationContainer=function(x,w,P,k,O,G,de,Te,Ze){return x=hG(P,k,!0,x,O,G,de,Te,Ze),x.context=cG(null),P=x.current,k=Ao(),O=md(P),G=Qh(k,O),G.callback=w??null,dd(P,G),x.current.lanes=O,cb(x,O,k),ta(x,k),x},i.createPortal=function(x,w,P){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:k==null?null:""+k,children:x,containerInfo:w,implementation:P}},i.createRoleSelector=function(x){return{$$typeof:lS,value:x}},i.createTestNameSelector=function(x){return{$$typeof:uS,value:x}},i.createTextSelector=function(x){return{$$typeof:hS,value:x}},i.deferredUpdates=function(x){var w=Wi,P=pn.transition;try{return pn.transition=null,Wi=16,x()}finally{Wi=w,pn.transition=P}},i.discreteUpdates=function(x,w,P,k,O){var G=Wi,de=pn.transition;try{return pn.transition=null,Wi=1,x(w,P,k,O)}finally{Wi=G,pn.transition=de,Ci===0&&Ag()}},i.findAllNodes=WR,i.findBoundingRects=function(x,w){if(!J)throw Error(o(363));w=WR(x,w),x=[];for(var P=0;P<w.length;P++)x.push(te(w[P]));for(w=x.length-1;0<w;w--){P=x[w];for(var k=P.x,O=k+P.width,G=P.y,de=G+P.height,Te=w-1;0<=Te;Te--)if(w!==Te){var Ze=x[Te],mt=Ze.x,It=mt+Ze.width,yi=Ze.y,Jt=yi+Ze.height;if(k>=mt&&G>=yi&&O<=It&&de<=Jt){x.splice(w,1);break}else if(k!==mt||P.width!==Ze.width||Jt<G||yi>de){if(!(G!==yi||P.height!==Ze.height||It<k||mt>O)){mt>k&&(Ze.width+=mt-k,Ze.x=k),It<O&&(Ze.width=O-mt),x.splice(w,1);break}}else{yi>G&&(Ze.height+=yi-G,Ze.y=G),Jt<de&&(Ze.height=de-yi),x.splice(w,1);break}}}return x},i.findHostInstance=dG,i.findHostInstanceWithNoPortals=function(x){return x=T(x),x=x!==null?D(x):null,x===null?null:x.stateNode},i.findHostInstanceWithWarning=function(x){return dG(x)},i.flushControlled=function(x){var w=Ci;Ci|=1;var P=pn.transition,k=Wi;try{pn.transition=null,Wi=1,x()}finally{Wi=k,pn.transition=P,Ci=w,Ci===0&&(Ag(),zu())}},i.flushPassiveEffects=lf,i.flushSync=tG,i.focusWithin=function(x,w){if(!J)throw Error(o(363));for(x=GR(x),w=ZH(x,w),w=Array.from(w),x=0;x<w.length;){var P=w[x++];if(!ce(P)){if(P.tag===5&&X(P.stateNode))return!0;for(P=P.child;P!==null;)w.push(P),P=P.sibling}}return!1},i.getCurrentUpdatePriority=function(){return Wi},i.getFindAllNodesFailureDescription=function(x,w){if(!J)throw Error(o(363));var P=0,k=[];x=[GR(x),0];for(var O=0;O<x.length;){var G=x[O++],de=x[O++],Te=w[de];if((G.tag!==5||!ce(G))&&(VR(G,Te)&&(k.push(jR(Te)),de++,de>P&&(P=de)),de<w.length))for(G=G.child;G!==null;)x.push(G,de),G=G.sibling}if(P<w.length){for(x=[];P<w.length;P++)x.push(jR(w[P]));return`findAllNodes was able to match part of the selector:
  `+(k.join(" > ")+`

No matching component was found for:
  `)+x.join(" > ")}return null},i.getPublicRootInstance=function(x){if(x=x.current,!x.child)return null;switch(x.child.tag){case 5:return H(x.child.stateNode);default:return x.child.stateNode}},i.injectIntoDevTools=function(x){if(x={bundleType:x.bundleType,version:x.version,rendererPackageName:x.rendererPackageName,rendererConfig:x.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Tae,findFiberByHostInstance:x.findFiberByHostInstance||Rae,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")x=!1;else{var w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(w.isDisabled||!w.supportsFiber)x=!0;else{try{I_=w.inject(x),Nu=w}catch{}x=!!w.checkDCE}}return x},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(x,w,P,k){if(!J)throw Error(o(363));x=WR(x,w);var O=Ue(x,P,k).disconnect;return{disconnect:function(){O()}}},i.registerMutableSourceForHydration=function(x,w){var P=w._getVersion;P=P(w._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[w,P]:x.mutableSourceEagerHydrationData.push(w,P)},i.runWithPriority=function(x,w){var P=Wi;try{return Wi=x,w()}finally{Wi=P}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(x,w,P,k){var O=w.current,G=Ao(),de=md(O);return P=cG(P),w.context===null?w.context=P:w.pendingContext=P,w=Qh(G,de),w.payload={element:x},k=k===void 0?null:k,k!==null&&(w.callback=k),dd(O,w),x=sl(O,de,G),x!==null&&N_(x,O,de),de},i};Fse.exports=C6e;var P6e=Fse.exports;const T6e=F1(P6e),R6e=t=>typeof t=="object"&&typeof t.then=="function",am=[];function Gse(t,e,i=(r,n)=>r===n){if(t===e)return!0;if(!t||!e)return!1;const r=t.length;if(e.length!==r)return!1;for(let n=0;n<r;n++)if(!i(t[n],e[n]))return!1;return!0}function Vse(t,e=null,i=!1,r={}){e===null&&(e=[t]);for(const s of am)if(Gse(e,s.keys,s.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!i)throw s.promise}const n={keys:e,equal:r.equal,remove:()=>{const s=am.indexOf(n);s!==-1&&am.splice(s,1)},promise:(R6e(t)?t:t(...e)).then(s=>{n.response=s,r.lifespan&&r.lifespan>0&&(n.timeout=setTimeout(n.remove,r.lifespan))}).catch(s=>n.error=s)};if(am.push(n),!i)throw n.promise}const k6e=(t,e,i)=>Vse(t,e,!1,i),D6e=(t,e,i)=>void Vse(t,e,!0,i),I6e=t=>{if(t===void 0||t.length===0)am.splice(0,am.length);else{const e=am.find(i=>Gse(t,i.keys,i.equal));e&&e.remove()}},m5={},L6e=t=>void Object.assign(m5,t);function B6e(t,e){function i(c,{args:h=[],attach:d,...p},f){let m=`${c[0].toUpperCase()}${c.slice(1)}`,g;if(c==="primitive"){if(p.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=p.object;g=jy(y,{type:c,root:f,attach:d,primitive:!0})}else{const y=m5[m];if(!y)throw new Error(`R3F: ${m} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(h))throw new Error("R3F: The args prop must be an array!");g=jy(new y(...h),{type:c,root:f,attach:d,memoizedProps:{args:h}})}return g.__r3f.attach===void 0&&(g instanceof bi?g.__r3f.attach="geometry":g instanceof jn&&(g.__r3f.attach="material")),m!=="inject"&&DI(g,p),g}function r(c,h){let d=!1;if(h){var p,f;(p=h.__r3f)!=null&&p.attach?kI(c,h,h.__r3f.attach):h.isObject3D&&c.isObject3D&&(c.add(h),d=!0),d||(f=c.__r3f)==null||f.objects.push(h),h.__r3f||jy(h,{}),h.__r3f.parent=c,rN(h),Wy(h)}}function n(c,h,d){let p=!1;if(h){var f,m;if((f=h.__r3f)!=null&&f.attach)kI(c,h,h.__r3f.attach);else if(h.isObject3D&&c.isObject3D){h.parent=c,h.dispatchEvent({type:"added"});const g=c.children.filter(v=>v!==h),y=g.indexOf(d);c.children=[...g.slice(0,y),h,...g.slice(y)],p=!0}p||(m=c.__r3f)==null||m.objects.push(h),h.__r3f||jy(h,{}),h.__r3f.parent=c,rN(h),Wy(h)}}function s(c,h,d=!1){c&&[...c].forEach(p=>o(h,p,d))}function o(c,h,d){if(h){var p,f,m;if(h.__r3f&&(h.__r3f.parent=null),(p=c.__r3f)!=null&&p.objects&&(c.__r3f.objects=c.__r3f.objects.filter(_=>_!==h)),(f=h.__r3f)!=null&&f.attach)QX(c,h,h.__r3f.attach);else if(h.isObject3D&&c.isObject3D){var g;c.remove(h),(g=h.__r3f)!=null&&g.root&&j6e(aC(h),h)}const v=(m=h.__r3f)==null?void 0:m.primitive,b=!v&&(d===void 0?h.dispose!==null:d);if(!v){var y;s((y=h.__r3f)==null?void 0:y.objects,h,b),s(h.children,h,b)}if(delete h.__r3f,b&&h.dispose&&h.type!=="Scene"){const _=()=>{try{h.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?tN.unstable_scheduleCallback(tN.unstable_IdlePriority,_):_()}Wy(c)}}function a(c,h,d,p){var f;const m=(f=c.__r3f)==null?void 0:f.parent;if(!m)return;const g=i(h,d,c.__r3f.root);if(c.children){for(const y of c.children)y.__r3f&&r(g,y);c.children=c.children.filter(y=>!y.__r3f)}c.__r3f.objects.forEach(y=>r(g,y)),c.__r3f.objects=[],c.__r3f.autoRemovedBeforeAppend||o(m,c),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),r(m,g),g.raycast&&g.__r3f.eventCount&&aC(g).getState().internal.interaction.push(g),[p,p.alternate].forEach(y=>{y!==null&&(y.stateNode=g,y.ref&&(typeof y.ref=="function"?y.ref(g):y.ref.current=g))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:T6e({createInstance:i,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:n,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(c,h)=>{if(!h)return;const d=c.getState().scene;d.__r3f&&(d.__r3f.root=c,r(d,h))},removeChildFromContainer:(c,h)=>{h&&o(c.getState().scene,h)},insertInContainerBefore:(c,h,d)=>{if(!h||!d)return;const p=c.getState().scene;p.__r3f&&n(p,h,d)},getRootHostContext:()=>null,getChildHostContext:c=>c,finalizeInitialChildren(c){var h;return!!((h=c==null?void 0:c.__r3f)!=null?h:{}).handlers},prepareUpdate(c,h,d,p){var f;if(((f=c==null?void 0:c.__r3f)!=null?f:{}).primitive&&p.object&&p.object!==c)return[!0];{const{args:g=[],children:y,...v}=p,{args:b=[],children:_,...A}=d;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((E,M)=>E!==b[M]))return[!0];const S=Jse(c,v,A,!0);return S.changes.length?[!1,S]:null}},commitUpdate(c,[h,d],p,f,m,g){h?a(c,p,m,g):DI(c,d)},commitMount(c,h,d,p){var f;const m=(f=c.__r3f)!=null?f:{};c.raycast&&m.handlers&&m.eventCount&&aC(c).getState().internal.interaction.push(c)},getPublicInstance:c=>c,prepareForCommit:()=>null,preparePortalMount:c=>jy(c.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(c){var h;const{attach:d,parent:p}=(h=c.__r3f)!=null?h:{};d&&p&&QX(p,c,d),c.isObject3D&&(c.visible=!1),Wy(c)},unhideInstance(c,h){var d;const{attach:p,parent:f}=(d=c.__r3f)!=null?d:{};p&&f&&kI(f,c,p),(c.isObject3D&&h.visible==null||h.visible)&&(c.visible=!0),Wy(c)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():gv.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Tr.fun(performance.now)?performance.now:Tr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Tr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Tr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:DI}}var XX,YX;const RI=t=>"colorSpace"in t||"outputColorSpace"in t,jse=()=>{var t;return(t=m5.ColorManagement)!=null?t:null},Wse=t=>t&&t.isOrthographicCamera,O6e=t=>t&&t.hasOwnProperty("current"),__=typeof window<"u"&&((XX=window.document)!=null&&XX.createElement||((YX=window.navigator)==null?void 0:YX.product)==="ReactNative")?se.useLayoutEffect:se.useEffect;function qse(t){const e=se.useRef(t);return __(()=>void(e.current=t),[t]),e}function U6e({set:t}){return __(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class Xse extends se.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Xse.getDerivedStateFromError=()=>({error:!0});const Yse="__default",KX=new Map,N6e=t=>t&&!!t.memoized&&!!t.changes;function Kse(t){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],i),t[1]):t}const Px=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};function aC(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Tr={obj:t=>t===Object(t)&&!Tr.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:i="shallow",objects:r="reference",strict:n=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Tr.str(t)||Tr.num(t))return t===e;const s=Tr.obj(t);if(s&&r==="reference")return t===e;const o=Tr.arr(t);if(o&&i==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&i==="shallow"&&r==="shallow"){for(a in n?e:t)if(!Tr.equ(t[a],e[a],{strict:n,objects:"reference"}))return!1}else for(a in n?e:t)if(t[a]!==e[a])return!1;if(Tr.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function F6e(t){const e={nodes:{},materials:{}};return t&&t.traverse(i=>{i.name&&(e.nodes[i.name]=i),i.material&&!e.materials[i.material.name]&&(e.materials[i.material.name]=i.material)}),e}function z6e(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function jy(t,e){const i=t;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function iN(t,e){let i=t;if(e.includes("-")){const r=e.split("-"),n=r.pop();return i=r.reduce((s,o)=>s[o],t),{target:i,key:n}}else return{target:i,key:e}}const JX=/-\d+$/;function kI(t,e,i){if(Tr.str(i)){if(JX.test(i)){const s=i.replace(JX,""),{target:o,key:a}=iN(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:n}=iN(t,i);e.__r3f.previousAttach=r[n],r[n]=e}else e.__r3f.previousAttach=i(t,e)}function QX(t,e,i){var r,n;if(Tr.str(i)){const{target:s,key:o}=iN(t,i),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(t,e);(n=e.__r3f)==null||delete n.previousAttach}function Jse(t,{children:e,key:i,ref:r,...n},{children:s,key:o,ref:a,...l}={},u=!1){var c;const h=(c=t==null?void 0:t.__r3f)!=null?c:{},d=Object.entries(n),p=[];if(u){const m=Object.keys(l);for(let g=0;g<m.length;g++)n.hasOwnProperty(m[g])||d.unshift([m[g],Yse+"remove"])}d.forEach(([m,g])=>{var y;if((y=t.__r3f)!=null&&y.primitive&&m==="object"||Tr.equ(g,l[m]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(m))return p.push([m,g,!0,[]]);let v=[];m.includes("-")&&(v=m.split("-")),p.push([m,g,!1,v]);for(const b in n){const _=n[b];b.startsWith(`${m}-`)&&p.push([b,_,!1,b.split("-")])}});const f={...n};return h.memoizedProps&&h.memoizedProps.args&&(f.args=h.memoizedProps.args),h.memoizedProps&&h.memoizedProps.attach&&(f.attach=h.memoizedProps.attach),{memoized:f,changes:p}}const H6e=typeof process<"u"&&!1;function DI(t,e){var i,r,n;const s=(i=t.__r3f)!=null?i:{},o=s.root,a=(r=o==null||o.getState==null?void 0:o.getState())!=null?r:{},{memoized:l,changes:u}=N6e(e)?e:Jse(t,e),c=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let d=0;d<u.length;d++){let[p,f,m,g]=u[d];if(RI(t)){const _="srgb",A="srgb-linear";p==="encoding"?(p="colorSpace",f=f===3001?_:A):p==="outputEncoding"&&(p="outputColorSpace",f=f===3001?_:A)}let y=t,v=y[p];if(g.length&&(v=g.reduce((b,_)=>b[_],t),!(v&&v.set))){const[b,..._]=g.reverse();y=_.reverse().reduce((A,S)=>A[S],t),p=b}if(f===Yse+"remove")if(y.constructor){let b=KX.get(y.constructor);b||(b=new y.constructor,KX.set(y.constructor,b)),f=b[p]}else f=0;if(m)f?s.handlers[p]=f:delete s.handlers[p],s.eventCount=Object.keys(s.handlers).length;else if(v&&v.set&&(v.copy||v instanceof Sm)){if(Array.isArray(f))v.fromArray?v.fromArray(f):v.set(...f);else if(v.copy&&f&&f.constructor&&(H6e?v.constructor.name===f.constructor.name:v.constructor===f.constructor))v.copy(f);else if(f!==void 0){const b=v instanceof St;!b&&v.setScalar?v.setScalar(f):v instanceof Sm&&f instanceof Sm?v.mask=f.mask:v.set(f),!jse()&&!a.linear&&b&&v.convertSRGBToLinear()}}else if(y[p]=f,y[p]instanceof Ir&&y[p].format===Fo&&y[p].type===kh){const b=y[p];RI(b)&&RI(a.gl)?b.colorSpace=a.gl.outputColorSpace:b.encoding=a.gl.outputEncoding}Wy(t)}if(s.parent&&t.raycast&&c!==s.eventCount){const d=aC(t).getState().internal,p=d.interaction.indexOf(t);p>-1&&d.interaction.splice(p,1),s.eventCount&&d.interaction.push(t)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(n=t.__r3f)!=null&&n.parent&&rN(t),t}function Wy(t){var e,i;const r=(e=t.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();r&&r.internal.frames===0&&r.invalidate()}function rN(t){t.onUpdate==null||t.onUpdate(t)}function G6e(t,e){t.manual||(Wse(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function sM(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function V6e(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return gv.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return gv.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return gv.ContinuousEventPriority;default:return gv.DefaultEventPriority}}function Qse(t,e,i,r){const n=i.get(e);n&&(i.delete(e),i.size===0&&(t.delete(r),n.target.releasePointerCapture(r)))}function j6e(t,e){const{internal:i}=t.getState();i.interaction=i.interaction.filter(r=>r!==e),i.initialHits=i.initialHits.filter(r=>r!==e),i.hovered.forEach((r,n)=>{(r.eventObject===e||r.object===e)&&i.hovered.delete(n)}),i.capturedMap.forEach((r,n)=>{Qse(i.capturedMap,e,r,n)})}function W6e(t){function e(l){const{internal:u}=t.getState(),c=l.offsetX-u.initialClick[0],h=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(c*c+h*h))}function i(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(c=>{var h;return(h=u.__r3f)==null?void 0:h.handlers["onPointer"+c]}))}function r(l,u){const c=t.getState(),h=new Set,d=[],p=u?u(c.internal.interaction):c.internal.interaction;for(let y=0;y<p.length;y++){const v=Px(p[y]);v&&(v.raycaster.camera=void 0)}c.previousRoot||c.events.compute==null||c.events.compute(l,c);function f(y){const v=Px(y);if(!v||!v.events.enabled||v.raycaster.camera===null)return[];if(v.raycaster.camera===void 0){var b;v.events.compute==null||v.events.compute(l,v,(b=v.previousRoot)==null?void 0:b.getState()),v.raycaster.camera===void 0&&(v.raycaster.camera=null)}return v.raycaster.camera?v.raycaster.intersectObject(y,!0):[]}let m=p.flatMap(f).sort((y,v)=>{const b=Px(y.object),_=Px(v.object);return!b||!_?y.distance-v.distance:_.events.priority-b.events.priority||y.distance-v.distance}).filter(y=>{const v=sM(y);return h.has(v)?!1:(h.add(v),!0)});c.events.filter&&(m=c.events.filter(m,c));for(const y of m){let v=y.object;for(;v;){var g;(g=v.__r3f)!=null&&g.eventCount&&d.push({...y,eventObject:v}),v=v.parent}}if("pointerId"in l&&c.internal.capturedMap.has(l.pointerId))for(let y of c.internal.capturedMap.get(l.pointerId).values())h.has(sM(y.intersection))||d.push(y.intersection);return d}function n(l,u,c,h){const d=t.getState();if(l.length){const p={stopped:!1};for(const f of l){const m=Px(f.object)||d,{raycaster:g,pointer:y,camera:v,internal:b}=m,_=new ue(y.x,y.y,0).unproject(v),A=C=>{var T,L;return(T=(L=b.capturedMap.get(C))==null?void 0:L.has(f.eventObject))!=null?T:!1},S=C=>{const T={intersection:f,target:u.target};b.capturedMap.has(C)?b.capturedMap.get(C).set(f.eventObject,T):b.capturedMap.set(C,new Map([[f.eventObject,T]])),u.target.setPointerCapture(C)},E=C=>{const T=b.capturedMap.get(C);T&&Qse(b.capturedMap,f.eventObject,T,C)};let M={};for(let C in u){let T=u[C];typeof T!="function"&&(M[C]=T)}let R={...f,...M,pointer:y,intersections:l,stopped:p.stopped,delta:c,unprojectedPoint:_,ray:g.ray,camera:v,stopPropagation(){const C="pointerId"in u&&b.capturedMap.get(u.pointerId);if((!C||C.has(f.eventObject))&&(R.stopped=p.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(T=>T.eventObject===f.eventObject))){const T=l.slice(0,l.indexOf(f));s([...T,f])}},target:{hasPointerCapture:A,setPointerCapture:S,releasePointerCapture:E},currentTarget:{hasPointerCapture:A,setPointerCapture:S,releasePointerCapture:E},nativeEvent:u};if(h(R),p.stopped===!0)break}}return l}function s(l){const{internal:u}=t.getState();for(const c of u.hovered.values())if(!l.length||!l.find(h=>h.object===c.object&&h.index===c.index&&h.instanceId===c.instanceId)){const d=c.eventObject.__r3f,p=d==null?void 0:d.handlers;if(u.hovered.delete(sM(c)),d!=null&&d.eventCount){const f={...c,intersections:l};p.onPointerOut==null||p.onPointerOut(f),p.onPointerLeave==null||p.onPointerLeave(f)}}}function o(l,u){for(let c=0;c<u.length;c++){const h=u[c].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:c}=t.getState();"pointerId"in u&&c.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{c.capturedMap.has(u.pointerId)&&(c.capturedMap.delete(u.pointerId),s([]))})}}return function(c){const{onPointerMissed:h,internal:d}=t.getState();d.lastEvent.current=c;const p=l==="onPointerMove",f=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",g=r(c,p?i:void 0),y=f?e(c):0;l==="onPointerDown"&&(d.initialClick=[c.offsetX,c.offsetY],d.initialHits=g.map(b=>b.eventObject)),f&&!g.length&&y<=2&&(o(c,d.interaction),h&&h(c)),p&&s(g);function v(b){const _=b.eventObject,A=_.__r3f,S=A==null?void 0:A.handlers;if(A!=null&&A.eventCount)if(p){if(S.onPointerOver||S.onPointerEnter||S.onPointerOut||S.onPointerLeave){const E=sM(b),M=d.hovered.get(E);M?M.stopped&&b.stopPropagation():(d.hovered.set(E,b),S.onPointerOver==null||S.onPointerOver(b),S.onPointerEnter==null||S.onPointerEnter(b))}S.onPointerMove==null||S.onPointerMove(b)}else{const E=S[l];E?(!f||d.initialHits.includes(_))&&(o(c,d.interaction.filter(M=>!d.initialHits.includes(M))),E(b)):f&&d.initialHits.includes(_)&&o(c,d.interaction.filter(M=>!d.initialHits.includes(M)))}}n(g,c,y,v)}}return{handlePointer:a}}const Zse=t=>!!(t!=null&&t.render),$se=se.createContext(null),q6e=(t,e)=>{const i=M6e((a,l)=>{const u=new ue,c=new ue,h=new ue;function d(y=l().camera,v=c,b=l().size){const{width:_,height:A,top:S,left:E}=b,M=_/A;v instanceof ue?h.copy(v):h.set(...v);const R=y.getWorldPosition(u).distanceTo(h);if(Wse(y))return{width:_/y.zoom,height:A/y.zoom,top:S,left:E,factor:1,distance:R,aspect:M};{const C=y.fov*Math.PI/180,T=2*Math.tan(C/2)*R,L=T*(_/A);return{width:L,height:T,top:S,left:E,factor:_/L,distance:R,aspect:M}}}let p;const f=y=>a(v=>({performance:{...v.performance,current:y}})),m=new ot;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>t(l(),y),advance:(y,v)=>e(y,v,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new c5,pointer:m,mouse:m,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();p&&clearTimeout(p),y.performance.current!==y.performance.min&&f(y.performance.min),p=setTimeout(()=>f(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:y=>a(v=>({...v,events:{...v.events,...y}})),setSize:(y,v,b,_,A)=>{const S=l().camera,E={width:y,height:v,top:_||0,left:A||0,updateStyle:b};a(M=>({size:E,viewport:{...M.viewport,...d(S,c,E)}}))},setDpr:y=>a(v=>{const b=Kse(y);return{viewport:{...v.viewport,dpr:b,initialDpr:v.viewport.initialDpr||b}}}),setFrameloop:(y="always")=>{const v=l().clock;v.stop(),v.elapsedTime=0,y!=="never"&&(v.start(),v.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:se.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,v,b)=>{const _=l().internal;return _.priority=_.priority+(v>0?1:0),_.subscribers.push({ref:y,priority:v,store:b}),_.subscribers=_.subscribers.sort((A,S)=>A.priority-S.priority),()=>{const A=l().internal;A!=null&&A.subscribers&&(A.priority=A.priority-(v>0?1:0),A.subscribers=A.subscribers.filter(S=>S.ref!==y))}}}}}),r=i.getState();let n=r.size,s=r.viewport.dpr,o=r.camera;return i.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:c,set:h}=i.getState();if(l.width!==n.width||l.height!==n.height||u.dpr!==s){var d;n=l,s=u.dpr,G6e(a,l),c.setPixelRatio(u.dpr);const p=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&c.domElement instanceof HTMLCanvasElement;c.setSize(l.width,l.height,p)}a!==o&&(o=a,h(p=>({viewport:{...p.viewport,...p.viewport.getCurrentViewport(a)}})))}),i.subscribe(a=>t(a)),i};let oM,X6e=new Set,Y6e=new Set,K6e=new Set;function II(t,e){if(t.size)for(const{callback:i}of t.values())i(e)}function Tx(t,e){switch(t){case"before":return II(X6e,e);case"after":return II(Y6e,e);case"tail":return II(K6e,e)}}let LI,BI;function OI(t,e,i){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(r=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),LI=e.internal.subscribers,oM=0;oM<LI.length;oM++)BI=LI[oM],BI.ref.current(BI.store.getState(),r,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function J6e(t){let e=!1,i,r,n;function s(l){r=requestAnimationFrame(s),e=!0,i=0,Tx("before",l);for(const c of t.values()){var u;n=c.store.getState(),n.internal.active&&(n.frameloop==="always"||n.internal.frames>0)&&!((u=n.gl.xr)!=null&&u.isPresenting)&&(i+=OI(l,n))}if(Tx("after",l),i===0)return Tx("tail",l),e=!1,cancelAnimationFrame(r)}function o(l,u=1){var c;if(!l)return t.forEach(h=>o(h.store.getState()),u);(c=l.gl.xr)!=null&&c.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+u),e||(e=!0,requestAnimationFrame(s)))}function a(l,u=!0,c,h){if(u&&Tx("before",l),c)OI(l,c,h);else for(const d of t.values())OI(l,d.store.getState());u&&Tx("after",l)}return{loop:s,invalidate:o,advance:a}}function eoe(){const t=se.useContext($se);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Q6e(t=i=>i,e){return eoe()(t,e)}function toe(t,e=0){const i=eoe(),r=i.getState().internal.subscribe,n=qse(t);return __(()=>r(n,e,i),[e,r,i]),null}const ZX=new WeakMap;function ioe(t,e){return function(i,...r){let n=ZX.get(i);return n||(n=new i,ZX.set(i,n)),t&&t(n),Promise.all(r.map(s=>new Promise((o,a)=>n.load(s,l=>{l.scene&&Object.assign(l,F6e(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`)))))).finally(()=>n.dispose==null?void 0:n.dispose())}}function S_(t,e,i,r){const n=Array.isArray(e)?e:[e],s=k6e(ioe(i,r),[t,...n],{equal:Tr.equ});return Array.isArray(e)?s:s[0]}S_.preload=function(t,e,i){const r=Array.isArray(e)?e:[e];return D6e(ioe(i),[t,...r])};S_.clear=function(t,e){const i=Array.isArray(e)?e:[e];return I6e([t,...i])};const E0=new Map,{invalidate:$X,advance:eY}=J6e(E0),{reconciler:nP,applyProps:Ty}=B6e(E0,V6e),Ry={objects:"shallow",strict:!1},Z6e=(t,e)=>{const i=typeof t=="function"?t(e):t;return Zse(i)?i:new j4({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function $6e(t,e){const i=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:r,height:n,top:s,left:o,updateStyle:a=i}=e;return{width:r,height:n,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:r,height:n,top:s,left:o}=t.parentElement.getBoundingClientRect();return{width:r,height:n,top:s,left:o,updateStyle:i}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:i};return{width:0,height:0,top:0,left:0}}function e8e(t){const e=E0.get(t),i=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const n=typeof reportError=="function"?reportError:console.error,s=r||q6e($X,eY),o=i||nP.createContainer(s,gv.ConcurrentRoot,null,!1,null,"",n,null);e||E0.set(t,{fiber:o,store:s});let a,l=!1,u;return{configure(c={}){let{gl:h,size:d,scene:p,events:f,onCreated:m,shadows:g=!1,linear:y=!1,flat:v=!1,legacy:b=!1,orthographic:_=!1,frameloop:A="always",dpr:S=[1,2],performance:E,raycaster:M,camera:R,onPointerMissed:C}=c,T=s.getState(),L=T.gl;T.gl||T.set({gl:L=Z6e(h,t)});let I=T.raycaster;I||T.set({raycaster:I=new Ose});const{params:D,...F}=M||{};if(Tr.equ(F,I,Ry)||Ty(I,{...F}),Tr.equ(D,I.params,Ry)||Ty(I,{params:{...I.params,...D}}),!T.camera||T.camera===u&&!Tr.equ(u,R,Ry)){u=R;const K=R instanceof p_,le=K?R:_?new Qp(0,0,0,0,.1,1e3):new xn(75,0,.1,1e3);K||(le.position.z=5,R&&Ty(le,R),!T.camera&&!(R!=null&&R.rotation)&&le.lookAt(0,0,0)),T.set({camera:le}),I.camera=le}if(!T.scene){let K;p instanceof iP?K=p:(K=new iP,p&&Ty(K,p)),T.set({scene:jy(K)})}if(!T.xr){var H;const K=(oe,ae)=>{const ve=s.getState();ve.frameloop!=="never"&&eY(oe,!0,ve,ae)},le=()=>{const oe=s.getState();oe.gl.xr.enabled=oe.gl.xr.isPresenting,oe.gl.xr.setAnimationLoop(oe.gl.xr.isPresenting?K:null),oe.gl.xr.isPresenting||$X(oe)},Z={connect(){const oe=s.getState().gl;oe.xr.addEventListener("sessionstart",le),oe.xr.addEventListener("sessionend",le)},disconnect(){const oe=s.getState().gl;oe.xr.removeEventListener("sessionstart",le),oe.xr.removeEventListener("sessionend",le)}};typeof((H=L.xr)==null?void 0:H.addEventListener)=="function"&&Z.connect(),T.set({xr:Z})}if(L.shadowMap){const K=L.shadowMap.enabled,le=L.shadowMap.type;if(L.shadowMap.enabled=!!g,Tr.boo(g))L.shadowMap.type=vw;else if(Tr.str(g)){var z;const Z={basic:Dre,percentage:iT,soft:vw,variance:lu};L.shadowMap.type=(z=Z[g])!=null?z:vw}else Tr.obj(g)&&Object.assign(L.shadowMap,g);(K!==L.shadowMap.enabled||le!==L.shadowMap.type)&&(L.shadowMap.needsUpdate=!0)}const B=jse();B&&("enabled"in B?B.enabled=!b:"legacyMode"in B&&(B.legacyMode=b)),Ty(L,{outputEncoding:y?3e3:3001,toneMapping:v?Rh:S4}),T.legacy!==b&&T.set(()=>({legacy:b})),T.linear!==y&&T.set(()=>({linear:y})),T.flat!==v&&T.set(()=>({flat:v})),h&&!Tr.fun(h)&&!Zse(h)&&!Tr.equ(h,L,Ry)&&Ty(L,h),f&&!T.events.handlers&&T.set({events:f(s)});const q=$6e(t,d);return Tr.equ(q,T.size,Ry)||T.setSize(q.width,q.height,q.updateStyle,q.top,q.left),S&&T.viewport.dpr!==Kse(S)&&T.setDpr(S),T.frameloop!==A&&T.setFrameloop(A),T.onPointerMissed||T.set({onPointerMissed:C}),E&&!Tr.equ(E,T.performance,Ry)&&T.set(K=>({performance:{...K.performance,...E}})),a=m,l=!0,this},render(c){return l||this.configure(),nP.updateContainer(se.createElement(t8e,{store:s,children:c,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){roe(t)}}}function t8e({store:t,children:e,onCreated:i,rootElement:r}){return __(()=>{const n=t.getState();n.set(s=>({internal:{...s.internal,active:!0}})),i&&i(n),t.getState().events.connected||n.events.connect==null||n.events.connect(r)},[]),se.createElement($se.Provider,{value:t},e)}function roe(t,e){const i=E0.get(t),r=i==null?void 0:i.fiber;if(r){const n=i==null?void 0:i.store.getState();n&&(n.internal.active=!1),nP.updateContainer(null,r,null,()=>{n&&setTimeout(()=>{try{var s,o,a,l;n.events.disconnect==null||n.events.disconnect(),(s=n.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=n.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=n.gl)!=null&&l.xr&&n.xr.disconnect(),z6e(n),E0.delete(t),e&&e(t)}catch{}},500)})}}nP.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:se.version});function L1(){return L1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},L1.apply(this,arguments)}function nN(t,e,i){var r,n,s,o,a;e==null&&(e=100);function l(){var c=Date.now()-o;c<e&&c>=0?r=setTimeout(l,e-c):(r=null,i||(a=t.apply(s,n),s=n=null))}var u=function(){s=this,n=arguments,o=Date.now();var c=i&&!r;return r||(r=setTimeout(l,e)),c&&(a=t.apply(s,n),s=n=null),a};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(a=t.apply(s,n),s=n=null,clearTimeout(r),r=null)},u}nN.debounce=nN;var i8e=nN;const tY=F1(i8e);function r8e(t){let{debounce:e,scroll:i,polyfill:r,offsetSize:n}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=se.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=se.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),u=e?typeof e=="number"?e:e.scroll:null,c=e?typeof e=="number"?e:e.resize:null,h=se.useRef(!1);se.useEffect(()=>(h.current=!0,()=>void(h.current=!1)));const[d,p,f]=se.useMemo(()=>{const v=()=>{if(!l.current.element)return;const{left:b,top:_,width:A,height:S,bottom:E,right:M,x:R,y:C}=l.current.element.getBoundingClientRect(),T={left:b,top:_,width:A,height:S,bottom:E,right:M,x:R,y:C};l.current.element instanceof HTMLElement&&n&&(T.height=l.current.element.offsetHeight,T.width=l.current.element.offsetWidth),Object.freeze(T),h.current&&!a8e(l.current.lastBounds,T)&&a(l.current.lastBounds=T)};return[v,c?tY(v,c):v,u?tY(v,u):v]},[a,n,u,c]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",f,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function g(){l.current.element&&(l.current.resizeObserver=new s(f),l.current.resizeObserver.observe(l.current.element),i&&l.current.scrollContainers&&l.current.scrollContainers.forEach(v=>v.addEventListener("scroll",f,{capture:!0,passive:!0})))}const y=v=>{!v||v===l.current.element||(m(),l.current.element=v,l.current.scrollContainers=noe(v),g())};return s8e(f,!!i),n8e(p),se.useEffect(()=>{m(),g()},[i,f,p]),se.useEffect(()=>m,[]),[y,o,d]}function n8e(t){se.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function s8e(t,e){se.useEffect(()=>{if(e){const i=t;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[t,e])}function noe(t){const e=[];if(!t||t===document.body)return e;const{overflow:i,overflowX:r,overflowY:n}=window.getComputedStyle(t);return[i,r,n].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...noe(t.parentElement)]}const o8e=["x","y","top","bottom","left","right","width","height"],a8e=(t,e)=>o8e.every(i=>t[i]===e[i]);var l8e=Object.defineProperty,u8e=Object.defineProperties,h8e=Object.getOwnPropertyDescriptors,iY=Object.getOwnPropertySymbols,c8e=Object.prototype.hasOwnProperty,d8e=Object.prototype.propertyIsEnumerable,rY=(t,e,i)=>e in t?l8e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,nY=(t,e)=>{for(var i in e||(e={}))c8e.call(e,i)&&rY(t,i,e[i]);if(iY)for(var i of iY(e))d8e.call(e,i)&&rY(t,i,e[i]);return t},p8e=(t,e)=>u8e(t,h8e(e));function soe(t,e,i){if(!t)return;if(i(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const n=soe(r,e,i);if(n)return n;r=e?null:r.sibling}}function ooe(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const g5=ooe(se.createContext(null));class aoe extends se.Component{render(){return se.createElement(g5.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:sY,ReactCurrentDispatcher:oY}=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function f8e(){const t=se.useContext(g5);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=se.useId();return se.useMemo(()=>{for(const r of[sY==null?void 0:sY.current,t,t==null?void 0:t.alternate]){if(!r)continue;const n=soe(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(n)return n}},[t,e])}function m8e(){var t,e;const i=f8e(),[r]=se.useState(()=>new Map);r.clear();let n=i;for(;n;){const s=(t=n.type)==null?void 0:t._context;s&&s!==g5&&!r.has(s)&&r.set(s,(e=oY==null?void 0:oY.current)==null?void 0:e.readContext(ooe(s))),n=n.return}return r}function g8e(){const t=m8e();return se.useMemo(()=>Array.from(t.keys()).reduce((e,i)=>r=>se.createElement(e,null,se.createElement(i.Provider,p8e(nY({},r),{value:t.get(i)}))),e=>se.createElement(aoe,nY({},e))),[t])}const UI={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function y8e(t){const{handlePointer:e}=W6e(t);return{priority:1,enabled:!0,compute(i,r,n){r.pointer.set(i.offsetX/r.size.width*2-1,-(i.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(UI).reduce((i,r)=>({...i,[r]:e(r)}),{}),update:()=>{var i;const{events:r,internal:n}=t.getState();(i=n.lastEvent)!=null&&i.current&&r.handlers&&r.handlers.onPointerMove(n.lastEvent.current)},connect:i=>{var r;const{set:n,events:s}=t.getState();s.disconnect==null||s.disconnect(),n(o=>({events:{...o.events,connected:i}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,u]=UI[o];i.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:i,events:r}=t.getState();if(r.connected){var n;Object.entries((n=r.handlers)!=null?n:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=UI[s];r.connected.removeEventListener(a,o)}}),i(s=>({events:{...s.events,connected:void 0}}))}}}}const v8e=se.forwardRef(function({children:e,fallback:i,resize:r,style:n,gl:s,events:o=y8e,eventSource:a,eventPrefix:l,shadows:u,linear:c,flat:h,legacy:d,orthographic:p,frameloop:f,dpr:m,performance:g,raycaster:y,camera:v,scene:b,onPointerMissed:_,onCreated:A,...S},E){se.useMemo(()=>L6e(S6e),[]);const M=g8e(),[R,C]=r8e({scroll:!0,debounce:{scroll:50,resize:0},...r}),T=se.useRef(null),L=se.useRef(null);se.useImperativeHandle(E,()=>T.current);const I=qse(_),[D,F]=se.useState(!1),[H,z]=se.useState(!1);if(D)throw D;if(H)throw H;const B=se.useRef(null);__(()=>{const V=T.current;C.width>0&&C.height>0&&V&&(B.current||(B.current=e8e(V)),B.current.configure({gl:s,events:o,shadows:u,linear:c,flat:h,legacy:d,orthographic:p,frameloop:f,dpr:m,performance:g,raycaster:y,camera:v,scene:b,size:C,onPointerMissed:(...q)=>I.current==null?void 0:I.current(...q),onCreated:q=>{q.events.connect==null||q.events.connect(a?O6e(a)?a.current:a:L.current),l&&q.setEvents({compute:(K,le)=>{const Z=K[l+"X"],oe=K[l+"Y"];le.pointer.set(Z/le.size.width*2-1,-(oe/le.size.height)*2+1),le.raycaster.setFromCamera(le.pointer,le.camera)}}),A==null||A(q)}}),B.current.render(se.createElement(M,null,se.createElement(Xse,{set:z},se.createElement(se.Suspense,{fallback:se.createElement(U6e,{set:F})},e)))))}),se.useEffect(()=>{const V=T.current;if(V)return()=>roe(V)},[]);const j=a?"none":"auto";return se.createElement("div",L1({ref:L,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:j,...n}},S),se.createElement("div",{ref:R,style:{width:"100%",height:"100%"}},se.createElement("canvas",{ref:T,style:{display:"block"}},i)))}),b8e=se.forwardRef(function(e,i){return se.createElement(aoe,null,se.createElement(v8e,L1({},e,{ref:i})))}),A_=new ue,y5=new ue,x8e=new ue;function w8e(t,e,i){const r=A_.setFromMatrixPosition(t.matrixWorld);r.project(e);const n=i.width/2,s=i.height/2;return[r.x*n+n,-(r.y*s)+s]}function _8e(t,e){const i=A_.setFromMatrixPosition(t.matrixWorld),r=y5.setFromMatrixPosition(e.matrixWorld),n=i.sub(r),s=e.getWorldDirection(x8e);return n.angleTo(s)>Math.PI/2}function S8e(t,e,i,r){const n=A_.setFromMatrixPosition(t.matrixWorld),s=n.clone();s.project(e),i.setFromCamera(s,e);const o=i.intersectObjects(r,!0);if(o.length){const a=o[0].distance;return n.distanceTo(i.ray.origin)<a}return!0}function A8e(t,e){if(e instanceof Qp)return e.zoom;if(e instanceof xn){const i=A_.setFromMatrixPosition(t.matrixWorld),r=y5.setFromMatrixPosition(e.matrixWorld),n=e.fov*Math.PI/180,s=i.distanceTo(r);return 1/(2*Math.tan(n/2)*s)}else return 1}function E8e(t,e,i){if(e instanceof xn||e instanceof Qp){const r=A_.setFromMatrixPosition(t.matrixWorld),n=y5.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(n),o=(i[1]-i[0])/(e.far-e.near),a=i[1]-o*e.far;return Math.round(o*s+a)}}const sN=t=>Math.abs(t)<1e-10?0:t;function loe(t,e,i=""){let r="matrix3d(";for(let n=0;n!==16;n++)r+=sN(e[n]*t.elements[n])+(n!==15?",":")");return i+r}const M8e=(t=>e=>loe(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),C8e=(t=>(e,i)=>loe(e,t(i),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function P8e(t){return t&&typeof t=="object"&&"current"in t}const T8e=se.forwardRef(({children:t,eps:e=.001,style:i,className:r,prepend:n,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:u=!1,transform:c=!1,occlude:h,onOcclude:d,castShadow:p,receiveShadow:f,material:m,geometry:g,zIndexRange:y=[16777271,0],calculatePosition:v=w8e,as:b="div",wrapperClass:_,pointerEvents:A="auto",...S},E)=>{const{gl:M,camera:R,scene:C,size:T,raycaster:L,events:I,viewport:D}=Q6e(),[F]=se.useState(()=>document.createElement(b)),H=se.useRef(),z=se.useRef(null),B=se.useRef(0),j=se.useRef([0,0]),V=se.useRef(null),q=se.useRef(null),K=(a==null?void 0:a.current)||I.connected||M.domElement.parentNode,le=se.useRef(null),Z=se.useRef(!1),oe=se.useMemo(()=>h&&h!=="blending"||Array.isArray(h)&&h.length&&P8e(h[0]),[h]);se.useLayoutEffect(()=>{const Se=M.domElement;h&&h==="blending"?(Se.style.zIndex=`${Math.floor(y[0]/2)}`,Se.style.position="absolute",Se.style.pointerEvents="none"):(Se.style.zIndex=null,Se.style.position=null,Se.style.pointerEvents=null)},[h]),se.useLayoutEffect(()=>{if(z.current){const Se=H.current=tQ(F);if(C.updateMatrixWorld(),c)F.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const be=v(z.current,R,T);F.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${be[0]}px,${be[1]}px,0);transform-origin:0 0;`}return K&&(n?K.prepend(F):K.appendChild(F)),()=>{K&&K.removeChild(F),Se.unmount()}}},[K,c]),se.useLayoutEffect(()=>{_&&(F.className=_)},[_]);const ae=se.useMemo(()=>c?{position:"absolute",top:0,left:0,width:T.width,height:T.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-T.height/2,left:-T.width/2,width:T.width,height:T.height},...i},[i,s,o,T,c]),ve=se.useMemo(()=>({position:"absolute",pointerEvents:A}),[A]);se.useLayoutEffect(()=>{if(Z.current=!1,c){var Se;(Se=H.current)==null||Se.render(se.createElement("div",{ref:V,style:ae},se.createElement("div",{ref:q,style:ve},se.createElement("div",{ref:E,className:r,style:i,children:t}))))}else{var be;(be=H.current)==null||be.render(se.createElement("div",{ref:E,style:ae,className:r,children:t}))}});const ye=se.useRef(!0);toe(Se=>{if(z.current){R.updateMatrixWorld(),z.current.updateWorldMatrix(!0,!1);const be=c?j.current:v(z.current,R,T);if(c||Math.abs(B.current-R.zoom)>e||Math.abs(j.current[0]-be[0])>e||Math.abs(j.current[1]-be[1])>e){const ee=_8e(z.current,R);let _e=!1;oe&&(Array.isArray(h)?_e=h.map(Xe=>Xe.current):h!=="blending"&&(_e=[C]));const Me=ye.current;if(_e){const Xe=S8e(z.current,R,L,_e);ye.current=Xe&&!ee}else ye.current=!ee;Me!==ye.current&&(d?d(!ye.current):F.style.display=ye.current?"block":"none");const Ce=Math.floor(y[0]/2),Re=h?oe?[y[0],Ce]:[Ce-1,0]:y;if(F.style.zIndex=`${E8e(z.current,R,Re)}`,c){const[Xe,Oe]=[T.width/2,T.height/2],$=R.projectionMatrix.elements[5]*Oe,{isOrthographicCamera:J,top:we,left:te,bottom:Y,right:ce}=R,Le=M8e(R.matrixWorldInverse),X=J?`scale(${$})translate(${sN(-(ce+te)/2)}px,${sN((we+Y)/2)}px)`:`translateZ(${$}px)`;let Ue=z.current.matrixWorld;u&&(Ue=R.matrixWorldInverse.clone().transpose().copyPosition(Ue).scale(z.current.scale),Ue.elements[3]=Ue.elements[7]=Ue.elements[11]=0,Ue.elements[15]=1),F.style.width=T.width+"px",F.style.height=T.height+"px",F.style.perspective=J?"":`${$}px`,V.current&&q.current&&(V.current.style.transform=`${X}${Le}translate(${Xe}px,${Oe}px)`,q.current.style.transform=C8e(Ue,1/((l||10)/400)))}else{const Xe=l===void 0?1:A8e(z.current,R)*l;F.style.transform=`translate3d(${be[0]}px,${be[1]}px,0) scale(${Xe})`}j.current=be,B.current=R.zoom}}if(!oe&&le.current&&!Z.current)if(c){if(V.current){const be=V.current.children[0];if(be!=null&&be.clientWidth&&be!=null&&be.clientHeight){const{isOrthographicCamera:ee}=R;if(ee||g)S.scale&&(Array.isArray(S.scale)?S.scale instanceof ue?le.current.scale.copy(S.scale.clone().divideScalar(1)):le.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):le.current.scale.setScalar(1/S.scale));else{const _e=(l||10)/400,Me=be.clientWidth*_e,Ce=be.clientHeight*_e;le.current.scale.set(Me,Ce,1)}Z.current=!0}}}else{const be=F.children[0];if(be!=null&&be.clientWidth&&be!=null&&be.clientHeight){const ee=1/D.factor,_e=be.clientWidth*ee,Me=be.clientHeight*ee;le.current.scale.set(_e,Me,1),Z.current=!0}le.current.lookAt(Se.camera.position)}});const pe=se.useMemo(()=>({vertexShader:c?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[c]);return se.createElement("group",L1({},S,{ref:z}),h&&!oe&&se.createElement("mesh",{castShadow:p,receiveShadow:f,ref:le},g||se.createElement("planeGeometry",null),m||se.createElement("shaderMaterial",{side:Tl,vertexShader:pe.vertexShader,fragmentShader:pe.fragmentShader})))});function aY(t,e){if(e===wne)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===$2||e===D4){let i=t.getIndex();if(i===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),i=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const r=i.count-2,n=[];if(i)if(e===$2)for(let o=1;o<=r;o++)n.push(i.getX(0)),n.push(i.getX(o)),n.push(i.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(n.push(i.getX(o)),n.push(i.getX(o+1)),n.push(i.getX(o+2))):(n.push(i.getX(o+2)),n.push(i.getX(o+1)),n.push(i.getX(o)));n.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(n),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}const R8e=parseInt(u_.replace(/\D+/g,""));class v5 extends _o{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(i){return new B8e(i)}),this.register(function(i){return new V8e(i)}),this.register(function(i){return new j8e(i)}),this.register(function(i){return new W8e(i)}),this.register(function(i){return new U8e(i)}),this.register(function(i){return new N8e(i)}),this.register(function(i){return new F8e(i)}),this.register(function(i){return new z8e(i)}),this.register(function(i){return new L8e(i)}),this.register(function(i){return new H8e(i)}),this.register(function(i){return new O8e(i)}),this.register(function(i){return new G8e(i)}),this.register(function(i){return new D8e(i)}),this.register(function(i){return new q8e(i)}),this.register(function(i){return new X8e(i)})}load(e,i,r,n){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Ih.extractUrlBase(e),this.manager.itemStart(e);const a=function(u){n?n(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Ja(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{s.parse(u,o,function(c){i(c),s.manager.itemEnd(e)},a)}catch(c){a(c)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,i,r,n){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Ih.decodeText(new Uint8Array(e.slice(0,4)))===uoe){try{o[Ui.KHR_BINARY_GLTF]=new Y8e(e)}catch(c){n&&n(c);return}s=JSON.parse(o[Ui.KHR_BINARY_GLTF].content)}else s=JSON.parse(Ih.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new a9e(s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const c=this.pluginCallbacks[u](l);a[c.name]=c,o[c.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const c=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(c){case Ui.KHR_MATERIALS_UNLIT:o[c]=new I8e;break;case Ui.KHR_DRACO_MESH_COMPRESSION:o[c]=new K8e(s,this.dracoLoader);break;case Ui.KHR_TEXTURE_TRANSFORM:o[c]=new J8e;break;case Ui.KHR_MESH_QUANTIZATION:o[c]=new Q8e;break;default:h.indexOf(c)>=0&&a[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(r,n)}parseAsync(e,i){const r=this;return new Promise(function(n,s){r.parse(e,i,n,s)})}}function k8e(){let t={};return{get:function(e){return t[e]},add:function(e,i){t[e]=i},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const Ui={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class D8e{constructor(e){this.parser=e,this.name=Ui.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,i=this.parser.json.nodes||[];for(let r=0,n=i.length;r<n;r++){const s=i[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const i=this.parser,r="light:"+e;let n=i.cache.get(r);if(n)return n;const s=i.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const c=new St(16777215);l.color!==void 0&&c.fromArray(l.color);const h=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new u5(c),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new l5(c),u.distance=h;break;case"spot":u=new a5(c),u.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,Kd(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=i.createUniqueName(l.name||"light_"+e),n=Promise.resolve(u),i.cache.add(r,n),n}getDependency(e,i){if(e==="light")return this._loadLight(i)}createNodeAttachment(e){const i=this,r=this.parser,s=r.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return r._getNodeRef(i.cache,a,l)})}}class I8e{constructor(){this.name=Ui.KHR_MATERIALS_UNLIT}getMaterialType(){return Ga}extendParams(e,i,r){const n=[];e.color=new St(1,1,1),e.opacity=1;const s=i.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&n.push(r.assignTexture(e,"map",s.baseColorTexture,3001))}return Promise.all(n)}}class L8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,i){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name].emissiveStrength;return s!==void 0&&(i.emissiveIntensity=s),Promise.resolve()}}class B8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];if(o.clearcoatFactor!==void 0&&(i.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(i,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(i.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(i,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(i,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new ot(a,a)}return Promise.all(s)}}class O8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];return o.iridescenceFactor!==void 0&&(i.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(i,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(i.iridescenceIOR=o.iridescenceIor),i.iridescenceThicknessRange===void 0&&(i.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(i.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(i.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(i,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class U8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];i.sheenColor=new St(0,0,0),i.sheenRoughness=0,i.sheen=1;const o=n.extensions[this.name];return o.sheenColorFactor!==void 0&&i.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(i.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(i,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(i,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class N8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];return o.transmissionFactor!==void 0&&(i.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(i,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class F8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];i.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(i,"thicknessMap",o.thicknessTexture)),i.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return i.attenuationColor=new St(a[0],a[1],a[2]),Promise.all(s)}}class z8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return i.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class H8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];i.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(i,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return i.specularColor=new St(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(r.assignTexture(i,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class G8e{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Xh}extendMaterialParams(e,i){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],o=n.extensions[this.name];return o.anisotropyStrength!==void 0&&(i.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(i.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(i,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class V8e{constructor(e){this.parser=e,this.name=Ui.KHR_TEXTURE_BASISU}loadTexture(e){const i=this.parser,r=i.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],o=i.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(e,s.source,o)}}class j8e{constructor(e){this.parser=e,this.name=Ui.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const i=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=n.images[o.source];let l=r.textureLoader;if(a.uri){const u=r.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return r.loadTextureImage(e,o.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class W8e{constructor(e){this.parser=e,this.name=Ui.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const i=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[i])return null;const o=s.extensions[i],a=n.images[o.source];let l=r.textureLoader;if(a.uri){const u=r.options.manager.getHandler(a.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return r.loadTextureImage(e,o.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){e(i.height===1)}})),this.isSupported}}class q8e{constructor(e){this.name=Ui.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const i=this.parser.json,r=i.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const n=r.extensions[this.name],s=this.parser.getDependency("buffer",n.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=n.byteOffset||0,u=n.byteLength||0,c=n.count,h=n.byteStride,d=new Uint8Array(a,l,u);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(c,h,d,n.mode,n.filter).then(function(p){return p.buffer}):o.ready.then(function(){const p=new ArrayBuffer(c*h);return o.decodeGltfBuffer(new Uint8Array(p),c,h,d,n.mode,n.filter),p})})}else return null}}class X8e{constructor(e){this.name=Ui.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const i=this.parser.json,r=i.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const n=i.meshes[r.mesh];for(const u of n.primitives)if(u.mode!==vl.TRIANGLES&&u.mode!==vl.TRIANGLE_STRIP&&u.mode!==vl.TRIANGLE_FAN&&u.mode!==void 0)return null;const o=r.extensions[this.name].attributes,a=[],l={};for(const u in o)a.push(this.parser.getDependency("accessor",o[u]).then(c=>(l[u]=c,l[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const c=u.pop(),h=c.isGroup?c.children:[c],d=u[0].count,p=[];for(const f of h){const m=new ii,g=new ue,y=new go,v=new ue(1,1,1),b=new X4(f.geometry,f.material,d);for(let _=0;_<d;_++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,_),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,_),l.SCALE&&v.fromBufferAttribute(l.SCALE,_),b.setMatrixAt(_,m.compose(g,y,v));for(const _ in l)_!=="TRANSLATION"&&_!=="ROTATION"&&_!=="SCALE"&&f.geometry.setAttribute(_,l[_]);Hi.prototype.copy.call(b,f),this.parser.assignFinalMaterial(b),p.push(b)}return c.isGroup?(c.clear(),c.add(...p),c):p[0]}))}}const uoe="glTF",Rx=12,lY={JSON:1313821514,BIN:5130562};class Y8e{constructor(e){this.name=Ui.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(e,0,Rx);if(this.header={magic:Ih.decodeText(new Uint8Array(e.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==uoe)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Rx,n=new DataView(e,Rx);let s=0;for(;s<r;){const o=n.getUint32(s,!0);s+=4;const a=n.getUint32(s,!0);if(s+=4,a===lY.JSON){const l=new Uint8Array(e,Rx+s,o);this.content=Ih.decodeText(l)}else if(a===lY.BIN){const l=Rx+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class K8e{constructor(e,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ui.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(e,i){const r=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},u={};for(const c in o){const h=oN[c]||c.toLowerCase();a[h]=o[c]}for(const c in e.attributes){const h=oN[c]||c.toLowerCase();if(o[c]!==void 0){const d=r.accessors[e.attributes[c]],p=Vv[d.componentType];u[h]=p.name,l[h]=d.normalized===!0}}return i.getDependency("bufferView",s).then(function(c){return new Promise(function(h){n.decodeDracoFile(c,function(d){for(const p in d.attributes){const f=d.attributes[p],m=l[p];m!==void 0&&(f.normalized=m)}h(d)},a,u)})})}}class J8e{constructor(){this.name=Ui.KHR_TEXTURE_TRANSFORM}extendTexture(e,i){return(i.texCoord===void 0||i.texCoord===e.channel)&&i.offset===void 0&&i.rotation===void 0&&i.scale===void 0||(e=e.clone(),i.texCoord!==void 0&&(e.channel=i.texCoord),i.offset!==void 0&&e.offset.fromArray(i.offset),i.rotation!==void 0&&(e.rotation=i.rotation),i.scale!==void 0&&e.repeat.fromArray(i.scale),e.needsUpdate=!0),e}}class Q8e{constructor(){this.name=Ui.KHR_MESH_QUANTIZATION}}class hoe extends ob{constructor(e,i,r,n){super(e,i,r,n)}copySampleValue_(e){const i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let o=0;o!==n;o++)i[o]=r[s+o];return i}interpolate_(e,i,r,n){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,u=a*3,c=n-i,h=(r-i)/c,d=h*h,p=d*h,f=e*u,m=f-u,g=-2*p+3*d,y=p-d,v=1-g,b=y-d+h;for(let _=0;_!==a;_++){const A=o[m+_+a],S=o[m+_+l]*c,E=o[f+_+a],M=o[f+_]*c;s[_]=v*A+b*S+g*E+y*M}return s}}const Z8e=new go;class $8e extends hoe{interpolate_(e,i,r,n){const s=super.interpolate_(e,i,r,n);return Z8e.fromArray(s).normalize().toArray(s),s}}const vl={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Vv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},uY={9728:an,9729:Rr,9984:w1,9985:Hv,9986:np,9987:Il},hY={33071:Hs,33648:g0,10497:Hp},NI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},oN={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...R8e>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},jd={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},e9e={CUBICSPLINE:void 0,LINEAR:Gm,STEP:v0},FI={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function t9e(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new w_({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:zh})),t.DefaultMaterial}function Cf(t,e,i){for(const r in i.extensions)t[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=i.extensions[r])}function Kd(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function i9e(t,e,i){let r=!1,n=!1,s=!1;for(let u=0,c=e.length;u<c;u++){const h=e[u];if(h.POSITION!==void 0&&(r=!0),h.NORMAL!==void 0&&(n=!0),h.COLOR_0!==void 0&&(s=!0),r&&n&&s)break}if(!r&&!n&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let u=0,c=e.length;u<c;u++){const h=e[u];if(r){const d=h.POSITION!==void 0?i.getDependency("accessor",h.POSITION):t.attributes.position;o.push(d)}if(n){const d=h.NORMAL!==void 0?i.getDependency("accessor",h.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=h.COLOR_0!==void 0?i.getDependency("accessor",h.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(u){const c=u[0],h=u[1],d=u[2];return r&&(t.morphAttributes.position=c),n&&(t.morphAttributes.normal=h),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function r9e(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let i=0,r=e.weights.length;i<r;i++)t.morphTargetInfluences[i]=e.weights[i];if(e.extras&&Array.isArray(e.extras.targetNames)){const i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(let r=0,n=i.length;r<n;r++)t.morphTargetDictionary[i[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function n9e(t){let e;const i=t.extensions&&t.extensions[Ui.KHR_DRACO_MESH_COMPRESSION];if(i?e="draco:"+i.bufferView+":"+i.indices+":"+zI(i.attributes):e=t.indices+":"+zI(t.attributes)+":"+t.mode,t.targets!==void 0)for(let r=0,n=t.targets.length;r<n;r++)e+=":"+zI(t.targets[r]);return e}function zI(t){let e="";const i=Object.keys(t).sort();for(let r=0,n=i.length;r<n;r++)e+=i[r]+":"+t[i[r]]+";";return e}function aN(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function s9e(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const o9e=new ii;class a9e{constructor(e={},i={}){this.json=e,this.extensions={},this.plugins={},this.options=i,this.cache=new k8e,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,s=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||n&&s<98?this.textureLoader=new Ase(this.options.manager):this.textureLoader=new Dse(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ja(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,i){const r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const a={scene:o[0][n.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:n.asset,parser:r,userData:{}};Cf(s,a,n),Kd(a,n),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(i)}_markDefs(){const e=this.json.nodes||[],i=this.json.skins||[],r=this.json.meshes||[];for(let n=0,s=i.length;n<s;n++){const o=i[n].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let n=0,s=e.length;n<s;n++){const o=e[n];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,i){i!==void 0&&(e.refs[i]===void 0&&(e.refs[i]=e.uses[i]=0),e.refs[i]++)}_getNodeRef(e,i,r){if(e.refs[i]<=1)return r;const n=r.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[u,c]of o.children.entries())s(c,a.children[u])};return s(r,n),n.name+="_instance_"+e.uses[i]++,n}_invokeOne(e){const i=Object.values(this.plugins);i.push(this);for(let r=0;r<i.length;r++){const n=e(i[r]);if(n)return n}return null}_invokeAll(e){const i=Object.values(this.plugins);i.unshift(this);const r=[];for(let n=0;n<i.length;n++){const s=e(i[n]);s&&r.push(s)}return r}getDependency(e,i){const r=e+":"+i;let n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(i);break;case"node":n=this._invokeOne(function(s){return s.loadNode&&s.loadNode(i)});break;case"mesh":n=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(i)});break;case"accessor":n=this.loadAccessor(i);break;case"bufferView":n=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(i)});break;case"buffer":n=this.loadBuffer(i);break;case"material":n=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(i)});break;case"texture":n=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(i)});break;case"skin":n=this.loadSkin(i);break;case"animation":n=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(i)});break;case"camera":n=this.loadCamera(i);break;default:if(n=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,i)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(r,n)}return n}getDependencies(e){let i=this.cache.get(e);if(!i){const r=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];i=Promise.all(n.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,i)}return i}loadBuffer(e){const i=this.json.buffers[e],r=this.fileLoader;if(i.type&&i.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(i.uri===void 0&&e===0)return Promise.resolve(this.extensions[Ui.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(s,o){r.load(Ih.resolveURL(i.uri,n.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(e){const i=this.json.bufferViews[e];return this.getDependency("buffer",i.buffer).then(function(r){const n=i.byteLength||0,s=i.byteOffset||0;return r.slice(s,s+n)})}loadAccessor(e){const i=this,r=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){const o=NI[n.type],a=Vv[n.componentType],l=n.normalized===!0,u=new a(n.count*o);return Promise.resolve(new Gi(u,o,l))}const s=[];return n.bufferView!==void 0?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),n.sparse!==void 0&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=NI[n.type],u=Vv[n.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,d=n.byteOffset||0,p=n.bufferView!==void 0?r.bufferViews[n.bufferView].byteStride:void 0,f=n.normalized===!0;let m,g;if(p&&p!==h){const y=Math.floor(d/p),v="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+y+":"+n.count;let b=i.cache.get(v);b||(m=new u(a,y*p,n.count*p/c),b=new g_(m,p/c),i.cache.add(v,b)),g=new Gp(b,l,d%p/c,f)}else a===null?m=new u(n.count*l):m=new u(a,d,n.count*l),g=new Gi(m,l,f);if(n.sparse!==void 0){const y=NI.SCALAR,v=Vv[n.sparse.indices.componentType],b=n.sparse.indices.byteOffset||0,_=n.sparse.values.byteOffset||0,A=new v(o[1],b,n.sparse.count*y),S=new u(o[2],_,n.sparse.count*l);a!==null&&(g=new Gi(g.array.slice(),g.itemSize,g.normalized));for(let E=0,M=A.length;E<M;E++){const R=A[E];if(g.setX(R,S[E*l]),l>=2&&g.setY(R,S[E*l+1]),l>=3&&g.setZ(R,S[E*l+2]),l>=4&&g.setW(R,S[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const i=this.json,r=this.options,s=i.textures[e].source,o=i.images[s];let a=this.textureLoader;if(o.uri){const l=r.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,i,r){const n=this,s=this.json,o=s.textures[e],a=s.images[i],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(i,r).then(function(c){c.flipY=!1,c.name=o.name||a.name||"",c.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(c.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return c.magFilter=uY[d.magFilter]||Rr,c.minFilter=uY[d.minFilter]||Il,c.wrapS=hY[d.wrapS]||Hp,c.wrapT=hY[d.wrapT]||Hp,n.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,i){const r=this,n=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const o=n.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",u=!1;if(o.bufferView!==void 0)l=r.getDependency("bufferView",o.bufferView).then(function(h){u=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then(function(h){return new Promise(function(d,p){let f=d;i.isImageBitmapLoader===!0&&(f=function(m){const g=new Ir(m);g.needsUpdate=!0,d(g)}),i.load(Ih.resolveURL(h,s.path),f,void 0,p)})}).then(function(h){return u===!0&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||s9e(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=c,c}assignTexture(e,i,r,n){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[Ui.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[Ui.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[Ui.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return n!==void 0&&("colorSpace"in o?o.colorSpace=n===3001?"srgb":"srgb-linear":o.encoding=n),e[i]=o,o})}assignFinalMaterial(e){const i=e.geometry;let r=e.material;const n=i.attributes.tangent===void 0,s=i.attributes.color!==void 0,o=i.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new dT,jn.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(a,l)),r=l}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new wo,jn.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,this.cache.add(a,l)),r=l}if(n||s||o){let a="ClonedMaterial:"+r.uuid+":";n&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=r.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),n&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(r))),r=l}e.material=r}getMaterialType(){return w_}loadMaterial(e){const i=this,r=this.json,n=this.extensions,s=r.materials[e];let o;const a={},l=s.extensions||{},u=[];if(l[Ui.KHR_MATERIALS_UNLIT]){const h=n[Ui.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),u.push(h.extendParams(a,s,i))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new St(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}h.baseColorTexture!==void 0&&u.push(i.assignTexture(a,"map",h.baseColorTexture,3001)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(u.push(i.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),u.push(i.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Tl);const c=s.alphaMode||FI.OPAQUE;if(c===FI.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===FI.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Ga&&(u.push(i.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ot(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return s.occlusionTexture!==void 0&&o!==Ga&&(u.push(i.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Ga&&(a.emissive=new St().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==Ga&&u.push(i.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(u).then(function(){const h=new o(a);return s.name&&(h.name=s.name),Kd(h,s),i.associations.set(h,{materials:e}),s.extensions&&Cf(n,h,s),h})}createUniqueName(e){const i=zi.sanitizeNodeName(e||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(e){const i=this,r=this.extensions,n=this.primitiveCache;function s(a){return r[Ui.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,i).then(function(l){return cY(l,a,i)})}const o=[];for(let a=0,l=e.length;a<l;a++){const u=e[a],c=n9e(u),h=n[c];if(h)o.push(h.promise);else{let d;u.extensions&&u.extensions[Ui.KHR_DRACO_MESH_COMPRESSION]?d=s(u):d=cY(new bi,u,i),n[c]={primitive:u,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const i=this,r=this.json,n=this.extensions,s=r.meshes[e],o=s.primitives,a=[];for(let l=0,u=o.length;l<u;l++){const c=o[l].material===void 0?t9e(this.cache):this.getDependency("material",o[l].material);a.push(c)}return a.push(i.loadGeometries(o)),Promise.all(a).then(function(l){const u=l.slice(0,l.length-1),c=l[l.length-1],h=[];for(let p=0,f=c.length;p<f;p++){const m=c[p],g=o[p];let y;const v=u[p];if(g.mode===vl.TRIANGLES||g.mode===vl.TRIANGLE_STRIP||g.mode===vl.TRIANGLE_FAN||g.mode===void 0)y=s.isSkinnedMesh===!0?new q4(m,v):new _n(m,v),y.isSkinnedMesh===!0&&y.normalizeSkinWeights(),g.mode===vl.TRIANGLE_STRIP?y.geometry=aY(y.geometry,D4):g.mode===vl.TRIANGLE_FAN&&(y.geometry=aY(y.geometry,$2));else if(g.mode===vl.LINES)y=new Bu(m,v);else if(g.mode===vl.LINE_STRIP)y=new sd(m,v);else if(g.mode===vl.LINE_LOOP)y=new Y4(m,v);else if(g.mode===vl.POINTS)y=new K4(m,v);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(y.geometry.morphAttributes).length>0&&r9e(y,s),y.name=i.createUniqueName(s.name||"mesh_"+e),Kd(y,s),g.extensions&&Cf(n,y,g),i.assignFinalMaterial(y),h.push(y)}for(let p=0,f=h.length;p<f;p++)i.associations.set(h[p],{meshes:e,primitives:p});if(h.length===1)return s.extensions&&Cf(n,h[0],s),h[0];const d=new Gc;s.extensions&&Cf(n,d,s),i.associations.set(d,{meshes:e});for(let p=0,f=h.length;p<f;p++)d.add(h[p]);return d})}loadCamera(e){let i;const r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?i=new xn(Dne.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):r.type==="orthographic"&&(i=new Qp(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(i.name=this.createUniqueName(r.name)),Kd(i,r),Promise.resolve(i)}loadSkin(e){const i=this.json.skins[e],r=[];for(let n=0,s=i.joints.length;n<s;n++)r.push(this._loadNodeShallow(i.joints[n]));return i.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",i.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(n){const s=n.pop(),o=n,a=[],l=[];for(let u=0,c=o.length;u<c;u++){const h=o[u];if(h){a.push(h);const d=new ii;s!==null&&d.fromArray(s.array,u*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[u])}return new y_(a,l)})}loadAnimation(e){const r=this.json.animations[e],n=r.name?r.name:"animation_"+e,s=[],o=[],a=[],l=[],u=[];for(let c=0,h=r.channels.length;c<h;c++){const d=r.channels[c],p=r.samplers[d.sampler],f=d.target,m=f.node,g=r.parameters!==void 0?r.parameters[p.input]:p.input,y=r.parameters!==void 0?r.parameters[p.output]:p.output;f.node!==void 0&&(s.push(this.getDependency("node",m)),o.push(this.getDependency("accessor",g)),a.push(this.getDependency("accessor",y)),l.push(p),u.push(f))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(u)]).then(function(c){const h=c[0],d=c[1],p=c[2],f=c[3],m=c[4],g=[];for(let y=0,v=h.length;y<v;y++){const b=h[y],_=d[y],A=p[y],S=f[y],E=m[y];if(b===void 0)continue;b.updateMatrix();let M;switch(jd[E.path]){case jd.weights:M=_0;break;case jd.rotation:M=Vp;break;case jd.position:case jd.scale:default:M=S0;break}const R=b.name?b.name:b.uuid,C=S.interpolation!==void 0?e9e[S.interpolation]:Gm,T=[];jd[E.path]===jd.weights?b.traverse(function(I){I.morphTargetInfluences&&T.push(I.name?I.name:I.uuid)}):T.push(R);let L=A.array;if(A.normalized){const I=aN(L.constructor),D=new Float32Array(L.length);for(let F=0,H=L.length;F<H;F++)D[F]=L[F]*I;L=D}for(let I=0,D=T.length;I<D;I++){const F=new M(T[I]+"."+jd[E.path],_.array,L,C);S.interpolation==="CUBICSPLINE"&&(F.createInterpolant=function(z){const B=this instanceof Vp?$8e:hoe;return new B(this.times,this.values,this.getValueSize()/3,z)},F.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(F)}}return new A0(n,void 0,g)})}createNodeMesh(e){const i=this.json,r=this,n=i.nodes[e];return n.mesh===void 0?null:r.getDependency("mesh",n.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,n.mesh,s);return n.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,u=n.weights.length;l<u;l++)a.morphTargetInfluences[l]=n.weights[l]}),o})}loadNode(e){const i=this.json,r=this,n=i.nodes[e],s=r._loadNodeShallow(e),o=[],a=n.children||[];for(let u=0,c=a.length;u<c;u++)o.push(r.getDependency("node",a[u]));const l=n.skin===void 0?Promise.resolve(null):r.getDependency("skin",n.skin);return Promise.all([s,Promise.all(o),l]).then(function(u){const c=u[0],h=u[1],d=u[2];d!==null&&c.traverse(function(p){p.isSkinnedMesh&&p.bind(d,o9e)});for(let p=0,f=h.length;p<f;p++)c.add(h[p]);return c})}_loadNodeShallow(e){const i=this.json,r=this.extensions,n=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=i.nodes[e],o=s.name?n.createUniqueName(s.name):"",a=[],l=n._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(n.getDependency("camera",s.camera).then(function(u){return n._getNodeRef(n.cameraCache,s.camera,u)})),n._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let c;if(s.isBone===!0?c=new cT:u.length>1?c=new Gc:u.length===1?c=u[0]:c=new Hi,c!==u[0])for(let h=0,d=u.length;h<d;h++)c.add(u[h]);if(s.name&&(c.userData.name=s.name,c.name=o),Kd(c,s),s.extensions&&Cf(r,c,s),s.matrix!==void 0){const h=new ii;h.fromArray(s.matrix),c.applyMatrix4(h)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);return n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=e,c}),this.nodeCache[e]}loadScene(e){const i=this.extensions,r=this.json.scenes[e],n=this,s=new Gc;r.name&&(s.name=n.createUniqueName(r.name)),Kd(s,r),r.extensions&&Cf(i,s,r);const o=r.nodes||[],a=[];for(let l=0,u=o.length;l<u;l++)a.push(n.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let c=0,h=l.length;c<h;c++)s.add(l[c]);const u=c=>{const h=new Map;for(const[d,p]of n.associations)(d instanceof jn||d instanceof Ir)&&h.set(d,p);return c.traverse(d=>{const p=n.associations.get(d);p!=null&&h.set(d,p)}),h};return n.associations=u(s),s})}}function l9e(t,e,i){const r=e.attributes,n=new yo;if(r.POSITION!==void 0){const a=i.json.accessors[r.POSITION],l=a.min,u=a.max;if(l!==void 0&&u!==void 0){if(n.set(new ue(l[0],l[1],l[2]),new ue(u[0],u[1],u[2])),a.normalized){const c=aN(Vv[a.componentType]);n.min.multiplyScalar(c),n.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new ue,l=new ue;for(let u=0,c=s.length;u<c;u++){const h=s[u];if(h.POSITION!==void 0){const d=i.json.accessors[h.POSITION],p=d.min,f=d.max;if(p!==void 0&&f!==void 0){if(l.setX(Math.max(Math.abs(p[0]),Math.abs(f[0]))),l.setY(Math.max(Math.abs(p[1]),Math.abs(f[1]))),l.setZ(Math.max(Math.abs(p[2]),Math.abs(f[2]))),d.normalized){const m=aN(Vv[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(a)}t.boundingBox=n;const o=new qs;n.getCenter(o.center),o.radius=n.min.distanceTo(n.max)/2,t.boundingSphere=o}function cY(t,e,i){const r=e.attributes,n=[];function s(o,a){return i.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in r){const a=oN[o]||o.toLowerCase();a in t.attributes||n.push(s(r[o],a))}if(e.indices!==void 0&&!t.index){const o=i.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});n.push(o)}return Kd(t,e),l9e(t,e,i),Promise.all(n).then(function(){return e.targets!==void 0?i9e(t,e.targets,i):t})}const HI=new WeakMap;class u9e extends _o{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,i,r,n){const s=new Ja(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(i).catch(n)},r,n)}decodeDracoFile(e,i,r,n){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(i)}decodeGeometry(e,i){for(const l in i.attributeTypes){const u=i.attributeTypes[l];u.BYTES_PER_ELEMENT!==void 0&&(i.attributeTypes[l]=u.name)}const r=JSON.stringify(i);if(HI.has(e)){const l=HI.get(e);if(l.key===r)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(n=l,new Promise((u,c)=>{n._callbacks[s]={resolve:u,reject:c},n.postMessage({type:"decode",id:s,taskConfig:i,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{n&&s&&this._releaseTask(n,s)}),HI.set(e,{key:r,promise:a}),a}_createGeometry(e){const i=new bi;e.index&&i.setIndex(new Gi(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r],s=n.name,o=n.array,a=n.itemSize;i.setAttribute(s,new Gi(o,a))}return i}_loadLibrary(e,i){const r=new Ja(this.manager);return r.setPath(this.decoderPath),r.setResponseType(i),r.setWithCredentials(this.withCredentials),new Promise((n,s)=>{r.load(e,n,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",i=[];return e?i.push(this._loadLibrary("draco_decoder.js","text")):(i.push(this._loadLibrary("draco_wasm_wrapper.js","text")),i.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(i).then(r=>{const n=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=h9e.toString(),o=["/* draco decoder */",n,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,i){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(s){const o=s.data;switch(o.type){case"decode":n._callbacks[o.id].resolve(o);break;case"error":n._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,s){return n._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=i,r._taskLoad+=i,r})}_releaseTask(e,i){e._taskLoad-=e._taskCosts[i],delete e._callbacks[i],delete e._taskCosts[i]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function h9e(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(c){t.onModuleLoaded=function(h){c({draco:h})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,u=a.taskConfig;e.then(c=>{const h=c.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{const f=i(h,d,p,u),m=f.attributes.map(g=>g.array.buffer);f.index&&m.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},m)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function i(o,a,l,u){const c=u.attributeIDs,h=u.attributeTypes;let d,p;const f=a.GetEncodedGeometryType(l);if(f===o.TRIANGULAR_MESH)d=new o.Mesh,p=a.DecodeBufferToMesh(l,d);else if(f===o.POINT_CLOUD)d=new o.PointCloud,p=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());const m={index:null,attributes:[]};for(const g in c){const y=self[h[g]];let v,b;if(u.useUniqueIDs)b=c[g],v=a.GetAttributeByUniqueId(d,b);else{if(b=a.GetAttributeId(d,o[c[g]]),b===-1)continue;v=a.GetAttribute(d,b)}m.attributes.push(n(o,a,d,g,y,v))}return f===o.TRIANGULAR_MESH&&(m.index=r(o,a,d)),o.destroy(d),m}function r(o,a,l){const c=l.num_faces()*3,h=c*4,d=o._malloc(h);a.GetTrianglesUInt32Array(l,h,d);const p=new Uint32Array(o.HEAPF32.buffer,d,c).slice();return o._free(d),{array:p,itemSize:1}}function n(o,a,l,u,c,h){const d=h.num_components(),f=l.num_points()*d,m=f*c.BYTES_PER_ELEMENT,g=s(o,c),y=o._malloc(m);a.GetAttributeDataArrayForAllPoints(l,h,g,m,y);const v=new c(o.HEAPF32.buffer,y,f).slice();return o._free(y),{name:u,array:v,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let aM;const GI=()=>{if(aM)return aM;const t="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let n=t;WebAssembly.validate(i)&&(n=e);let s;const o=WebAssembly.instantiate(a(n),{}).then(h=>{s=h.instance,s.exports.__wasm_call_ctors()});function a(h){const d=new Uint8Array(h.length);for(let f=0;f<h.length;++f){const m=h.charCodeAt(f);d[f]=m>96?m-71:m>64?m-65:m>47?m+4:m>46?63:62}let p=0;for(let f=0;f<h.length;++f)d[p++]=d[f]<60?r[d[f]]:(d[f]-60)*64+d[++f];return d.buffer.slice(0,p)}function l(h,d,p,f,m,g){const y=s.exports.sbrk,v=p+3&-4,b=y(v*f),_=y(m.length),A=new Uint8Array(s.exports.memory.buffer);A.set(m,_);const S=h(b,p,f,_,m.length);if(S===0&&g&&g(b,v,f),d.set(A.subarray(b,b+p*f)),y(b-y(0)),S!==0)throw new Error(`Malformed buffer data: ${S}`)}const u={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},c={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return aM={ready:o,supported:!0,decodeVertexBuffer(h,d,p,f,m){l(s.exports.meshopt_decodeVertexBuffer,h,d,p,f,s.exports[u[m]])},decodeIndexBuffer(h,d,p,f){l(s.exports.meshopt_decodeIndexBuffer,h,d,p,f)},decodeIndexSequence(h,d,p,f){l(s.exports.meshopt_decodeIndexSequence,h,d,p,f)},decodeGltfBuffer(h,d,p,f,m,g){l(s.exports[c[m]],h,d,p,f,s.exports[u[g]])}},aM};let lM=null,coe="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function doe(t,e,i){return r=>{i&&i(r),t&&(lM||(lM=new u9e),lM.setDecoderPath(typeof t=="string"?t:coe),r.setDRACOLoader(lM)),e&&r.setMeshoptDecoder(typeof GI=="function"?GI():GI)}}function TT(t,e=!0,i=!0,r){return S_(v5,t,doe(e,i,r))}TT.preload=(t,e=!0,i=!0,r)=>S_.preload(v5,t,doe(e,i,r));TT.clear=t=>S_.clear(v5,t);TT.setDecoderPath=t=>{coe=t};const c9e=se.forwardRef((t,e)=>{const{isHovered1:i,setIsHovered1:r,isHovered2:n,setIsHovered2:s,isHovered3:o,setIsHovered3:a,isHovered4:l,setIsHovered4:u,isHovered5:c,setIsHovered5:h,isHovered6:d,setIsHovered6:p,isHovered7:f,setIsHovered7:m,isHovered8:g,setIsHovered8:y,isHovered9:v,setIsHovered9:b,isHovered10:_,setIsHovered10:A,isHovered11:S,setIsHovered11:E,isHovered12:M,setIsHovered12:R}=EUe(D=>D),{partSelected:C,setPartSelected:T}=a4(D=>D),{nodes:L,materials:I}=TT("/Model2222222.gltf");return U.jsx(U.Fragment,{children:U.jsxs("group",{...t,ref:e,dispose:null,position:[0,-2,0],children:[U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M001.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),r(!0)),onPointerLeave:()=>r(!1),onClick:()=>T("shoulders"),scale:.325,children:i&&U.jsx("meshStandardMaterial",{color:i?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M002.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),s(!0)),onClick:()=>T("upper arms"),onPointerLeave:()=>s(!1),scale:.325,children:n&&U.jsx("meshStandardMaterial",{color:n?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M003.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),a(!0)),onPointerLeave:()=>a(!1),onClick:()=>T("lower arms"),scale:.325,children:o&&U.jsx("meshStandardMaterial",{color:o?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M004.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),u(!0)),onPointerLeave:()=>u(!1),onClick:()=>T("shoulders"),scale:.325,children:l&&U.jsx("meshStandardMaterial",{color:l?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M005.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),h(!0)),onPointerLeave:()=>h(!1),onClick:()=>T("upper arms"),scale:.325,children:c&&U.jsx("meshStandardMaterial",{color:c?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M006.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),p(!0)),onPointerLeave:()=>p(!1),scale:.325,onClick:()=>T("lower arms"),children:d&&U.jsx("meshStandardMaterial",{color:d?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M007.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),m(!0)),onPointerLeave:()=>m(!1),onClick:()=>T("back"),scale:.325,children:f&&U.jsx("meshStandardMaterial",{color:f?"red":"lightblue"})}),U.jsxs("group",{scale:.325,children:[U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.Mesh010.geometry,material:I.Body_M}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.Mesh010_1.geometry,material:I["Body_M.001"]})]}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M009.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),y(!0)),onPointerLeave:()=>y(!1),onClick:D=>(D.stopPropagation(),T("chest")),scale:.325,children:g&&U.jsx("meshStandardMaterial",{color:g?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.BustUp__Body_M010.geometry,material:I.Body_M,onPointerEnter:D=>(D.stopPropagation(),b(!0)),onPointerLeave:()=>b(!1),onClick:D=>(D.stopPropagation(),T("waist")),scale:.325,children:v&&U.jsx("meshStandardMaterial",{color:v?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.Hair__Body_M001.geometry,material:I["Body_M.001"],onPointerEnter:D=>(D.stopPropagation(),A(!0)),onPointerLeave:()=>A(!1),onClick:D=>(D.stopPropagation(),T("upper legs")),scale:.325,children:_&&U.jsx("meshStandardMaterial",{color:_?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.Hair__Body_M002.geometry,material:I["Body_M.001"],onPointerEnter:D=>(D.stopPropagation(),E(!0)),onPointerLeave:()=>E(!1),onClick:()=>T("lower legs"),scale:.325,children:S&&U.jsx("meshStandardMaterial",{color:S?"red":"lightblue"})}),U.jsx("mesh",{castShadow:!0,receiveShadow:!0,geometry:L.Hair__Body_M003.geometry,material:I["Body_M.001"],onPointerEnter:D=>(D.stopPropagation(),R(!0)),onPointerLeave:()=>R(!1),onClick:()=>T("cardio"),scale:.325,children:M&&U.jsx("meshStandardMaterial",{color:M?"red":"lightblue"})})]})})}),d9e=[{name:"3/4 sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/If6PR56qjoPyh4",id:1,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"45 side bend",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/naG9D34uNCSQHk",id:2,target:"abs",instructions:`Stand with your feet shoulder-width apart and your arms extended straight down by your sides.
Keeping your back straight and your core engaged, slowly bend your torso to one side, lowering your hand towards your knee.
Pause for a moment at the bottom, then slowly return to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"air bike",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/QxGXcAPpI10v7R",id:3,target:"abs",instructions:`Lie flat on your back with your hands placed behind your head.
Lift your legs off the ground and bend your knees at a 90-degree angle.
Bring your right elbow towards your left knee while simultaneously straightening your right leg.
Return to the starting position and repeat the movement on the opposite side, bringing your left elbow towards your right knee while straightening your left leg.
Continue alternating sides in a pedaling motion for the desired number of repetitions.`},{name:"all fours squad stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/2LfekjIOWTLI-D",id:1512,target:"quads",instructions:`Start on all fours with your hands directly under your shoulders and your knees directly under your hips.
Extend one leg straight back, keeping your knee bent and your foot flexed.
Slowly lower your hips towards the ground, feeling a stretch in your quads.
Hold this position for 20-30 seconds.
Switch legs and repeat the stretch on the other side.`},{name:"alternate heel touchers",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/EXtSlr3PbWJoWb",id:6,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Extend your arms straight out to the sides, parallel to the ground.
Engaging your abs, lift your shoulders off the ground and reach your right hand towards your right heel.
Return to the starting position and repeat on the left side, reaching your left hand towards your left heel.
Continue alternating sides for the desired number of repetitions.`},{name:"ankle circles",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qSOGE1mNqK30CM",id:1368,target:"calves",instructions:`Sit on the ground with your legs extended in front of you.
Lift one leg off the ground and rotate your ankle in a circular motion.
Perform the desired number of circles in one direction, then switch to the other direction.
Repeat with the other leg.`},{name:"archer pull up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/fkjTRvQawGlm-n",id:3293,target:"lats",instructions:`Start by hanging from a pull-up bar with an overhand grip, slightly wider than shoulder-width apart.
Engage your core and pull your shoulder blades down and back.
As you pull yourself up, bend one arm and bring your elbow towards your side, while keeping the other arm straight.
Continue pulling until your chin is above the bar and your bent arm is fully flexed.
Lower yourself back down with control, straightening the bent arm and repeating the movement on the other side.
Alternate sides with each repetition.`},{name:"archer push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/zpd4FknibGJulY",id:3294,target:"pectorals",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart.
Extend one arm straight out to the side, parallel to the ground.
Lower your body by bending your elbows, keeping your back straight and core engaged.
Push back up to the starting position.
Repeat on the other side, extending the opposite arm out to the side.
Continue alternating sides for the desired number of repetitions.`},{name:"arm slingers hanging bent knee legs",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-L-uLetUoesXbn",id:2355,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your knees bent at a 90-degree angle.
Engage your core and lift your knees towards your chest, bringing them as close to your elbows as possible.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"arm slingers hanging straight legs",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/5Fj3Df1kIkykyY",id:2333,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your legs straight down.
Engage your core and lift your legs up in front of you until they are parallel to the ground.
Hold for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"arms apart circular toe touch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZFX5vOdrotkiPf",id:3214,target:"glutes",instructions:`Stand with your feet shoulder-width apart and arms extended to the sides.
Keeping your legs straight, bend forward at the waist and reach down towards your toes with your right hand.
As you reach down, simultaneously lift your left leg straight up behind you, maintaining balance.
Return to the starting position and repeat the movement with your left hand reaching towards your toes and your right leg lifting up behind you.
Continue alternating sides for the desired number of repetitions.`},{name:"arms overhead full sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/X2684eBUAmNHcw",id:3204,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Extend your arms overhead, keeping them straight.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is upright.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"assisted motion russian twist",bodyPart:"waist",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/pddPOmpOFjRzgB",id:14,target:"abs",instructions:`Sit on the ground with your knees bent and feet flat on the floor.
Hold the medicine ball with both hands in front of your chest.
Lean back slightly, engaging your abs and keeping your back straight.
Slowly twist your torso to the right, bringing the medicine ball towards the right side of your body.
Pause for a moment, then twist your torso to the left, bringing the medicine ball towards the left side of your body.
Continue alternating sides for the desired number of repetitions.`},{name:"astride jumps",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/e0WMsn52XC3D8s",id:3220,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Bend your knees and lower your body into a squat position.
Jump explosively upwards, extending your legs and arms.
While in the air, spread your legs apart and bring your arms out to the sides.
Land softly with your feet shoulder-width apart, bending your knees to absorb the impact.
Repeat for the desired number of repetitions.`},{name:"back and forth step",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Y4TmXpjJzS6uOd",id:3672,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Step forward with your right foot, bending your knee and lowering your body into a lunge position.
Push off with your right foot and step back to the starting position.
Repeat the movement with your left foot, alternating legs with each step.
Continue stepping back and forth, maintaining a steady pace.
Repeat for the desired duration or number of repetitions.`},{name:"back extension on exercise ball",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/GdG15JPmJ5OXPS",id:1314,target:"spine",instructions:`Place the stability ball on the ground and lie face down on top of it, with your hips resting on the ball and your feet against a wall or other stable surface.
Position your hands behind your head or crossed over your chest.
Engage your core and slowly lift your upper body off the ball, extending your back until your body forms a straight line from your head to your heels.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"back lever",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/troJOph4YL70p2",id:3297,target:"upper back",instructions:`Start by hanging from a pull-up bar with an overhand grip, hands slightly wider than shoulder-width apart.
Engage your core and pull your shoulder blades down and back.
Bend your knees and tuck them towards your chest.
Slowly lift your legs up, keeping them straight, until your body is parallel to the ground.
Hold this position for a few seconds, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"back pec stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PW-anV-QJXuuoK",id:1405,target:"lats",instructions:`Stand tall with your feet shoulder-width apart.
Extend your arms straight out in front of you, parallel to the ground.
Cross your arms in front of your body, with your right arm over your left arm.
Interlock your fingers and rotate your palms away from your body.
Slowly raise your arms up and away from your body, feeling a stretch in your back and chest.
Hold the stretch for 15-30 seconds, then release.
Repeat on the opposite side.`},{name:"backward jump",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/9dt0Dn4MCCJmUi",id:1473,target:"quads",instructions:`Stand with your feet shoulder-width apart.
Bend your knees slightly and jump backwards, pushing off with both feet.
Land softly on the balls of your feet, bending your knees to absorb the impact.
Repeat for the desired number of repetitions.`},{name:"balance board",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WMO4gugDGvKKYW",id:20,target:"quads",instructions:`Place the balance board on a flat surface.
Step onto the balance board with one foot, ensuring it is centered.
Slowly shift your weight onto the foot on the balance board, keeping your core engaged.
Maintain your balance and stability as you hold the position for a desired amount of time.
Repeat the exercise with the other foot.`},{name:"band alternating biceps curl",bodyPart:"upper arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/-Ftn6oEUqLFZ7r",id:968,target:"biceps",instructions:`Stand with your feet shoulder-width apart and hold the band with an underhand grip, palms facing up.
Keep your elbows close to your sides and slowly curl one arm up towards your shoulder, squeezing your biceps at the top.
Lower the arm back down to the starting position and repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"band alternating v-up",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/--Aees30cRhqfw",id:969,target:"abs",instructions:`Lie flat on your back with your legs straight and your arms extended overhead, holding the band.
Engage your abs and lift your legs and upper body off the ground simultaneously, reaching your hands towards your toes.
As you lower your legs and upper body back down, switch the position of your legs, crossing one over the other.
Repeat the movement, alternating the position of your legs with each repetition.
Continue for the desired number of repetitions.`},{name:"band assisted pull-up",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/fSKf5CuJtN2V1s",id:970,target:"lats",instructions:`Attach the band to a pull-up bar or sturdy anchor point.
Step onto the band and grip the bar with your palms facing away from you, hands slightly wider than shoulder-width apart.
Hang with your arms fully extended, keeping your core engaged and your shoulders down and back.
Pull your body up towards the bar by squeezing your shoulder blades together and driving your elbows down towards your hips.
Continue pulling until your chin is above the bar, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band assisted wheel rollerout",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/QHfgjJtq-pTjf-",id:971,target:"abs",instructions:`Kneel on the floor and hold the handles of the band with both hands, palms facing down.
Place the band on the ground in front of you and position your hands shoulder-width apart.
Engage your core and slowly roll the wheel forward, extending your body as far as you can while maintaining control.
Pause for a moment at the furthest point, then slowly roll the wheel back towards your knees to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band bench press",bodyPart:"chest",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/YQN1Vf4WdyKcMC",id:1254,target:"pectorals",instructions:`Lie flat on a bench with your feet flat on the ground and your back pressed against the bench.
Grasp the band handles with an overhand grip, slightly wider than shoulder-width apart.
Extend your arms fully, pushing the bands away from your chest.
Slowly lower the bands back down to your chest, keeping your elbows at a 90-degree angle.
Repeat for the desired number of repetitions.`},{name:"band bent-over hip extension",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/OD3PtXDivHOyoW",id:980,target:"glutes",instructions:`Attach the band to a sturdy anchor point at ankle height.
Stand facing away from the anchor point with your feet shoulder-width apart.
Step back to create tension in the band, keeping your knees slightly bent.
Hinge at the hips and lean forward, maintaining a neutral spine.
Extend your right leg straight back, squeezing your glutes at the top.
Lower your right leg back down and repeat with the left leg.
Continue alternating legs for the desired number of repetitions.`},{name:"band bicycle crunch",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/JPpzZEceCxYwlN",id:972,target:"abs",instructions:`Lie flat on your back with your hands behind your head and your knees bent.
Lift your feet off the ground and bring your right knee towards your chest while simultaneously twisting your torso to bring your left elbow towards your right knee.
Straighten your right leg while bringing your left knee towards your chest and twisting your torso to bring your right elbow towards your left knee.
Continue alternating the twisting motion, as if you are pedaling a bicycle, while keeping your core engaged throughout the movement.
Repeat for the desired number of repetitions.`},{name:"band close-grip pulldown",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/kCMxGVrlaSVdug",id:974,target:"lats",instructions:`Attach the band to a high anchor point, such as a pull-up bar or sturdy beam.
Stand facing the anchor point and grab the band with an underhand grip, hands shoulder-width apart.
Step back to create tension in the band, keeping your feet hip-width apart.
Engage your core and keep your back straight as you pull the band down towards your chest, squeezing your shoulder blades together.
Pause for a moment at the bottom of the movement, then slowly release the band back to the starting position.
Repeat for the desired number of repetitions.`},{name:"band close-grip push-up",bodyPart:"upper arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/sJ8JuH6Fm1XD9K",id:975,target:"triceps",instructions:`Place a band around your upper arms, just above the elbows.
Assume a push-up position with your hands directly under your shoulders and your body in a straight line from head to heels.
Bend your elbows and lower your chest towards the ground, keeping your elbows close to your sides.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band concentration curl",bodyPart:"upper arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/q23w-Szn4mfKDW",id:976,target:"biceps",instructions:`Sit on a bench or chair with your legs spread apart and your feet flat on the ground.
Hold one end of the band in your hand and step on the other end with your foot on the same side.
Lean forward slightly and rest your elbow on the inside of your thigh, just above the knee.
With your palm facing up, slowly curl your hand towards your shoulder, keeping your upper arm stationary.
Pause for a moment at the top, then slowly lower your hand back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"band fixed back close grip pulldown",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/-umG3gUayl7TKf",id:3117,target:"lats",instructions:`Attach the band to a fixed point above you, such as a pull-up bar or sturdy beam.
Sit down on a bench or chair facing the band, with your feet flat on the ground and your knees bent.
Grasp the band with a close grip, palms facing towards you.
Keep your back straight and engage your core.
Pull the band down towards your chest, squeezing your shoulder blades together.
Pause for a moment at the bottom of the movement, feeling the contraction in your lats.
Slowly release the band back to the starting position, maintaining control throughout the movement.
Repeat for the desired number of repetitions.`},{name:"band fixed back underhand pulldown",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/ZDBFczgu3KXZXO",id:3116,target:"lats",instructions:`Attach the band to a sturdy anchor point above your head.
Stand facing the anchor point with your feet shoulder-width apart.
Grasp the band with an underhand grip, hands slightly wider than shoulder-width apart.
Step back to create tension in the band, keeping your arms fully extended.
Engage your core and squeeze your shoulder blades together.
Pull the band down towards your chest, leading with your elbows.
Pause for a moment at the bottom of the movement, feeling the contraction in your lats.
Slowly release the tension in the band and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band front lateral raise",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/lZUwVD0pbYCPvE",id:977,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold the band in front of your thighs with your palms facing down.
Keep your arms straight and lift the band up in front of you until your arms are parallel to the ground.
Pause for a moment at the top, then slowly lower the band back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band front raise",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/QWFMrdo651iNQj",id:978,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold the band in front of your thighs with your palms facing down.
Keep your arms straight and slowly raise them forward until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band hip lift",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/Aw2H-yT51rK71h",id:1408,target:"glutes",instructions:`Lie on your back with your knees bent and feet flat on the ground.
Place a resistance band just above your knees.
Engage your glutes and core muscles.
Press your heels into the ground and lift your hips off the floor, squeezing your glutes at the top.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band horizontal pallof press",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/x45EvaaVkJlzFu",id:979,target:"abs",instructions:`Attach the band to a sturdy anchor point at waist height.
Stand perpendicular to the anchor point with your feet shoulder-width apart.
Grasp the band handle with both hands and step away from the anchor point to create tension in the band.
Bring your hands to your chest, keeping your elbows bent and close to your body.
Engage your core and maintain a stable stance.
Extend your arms straight out in front of you, pushing the band away from your body.
Hold the extended position for a few seconds, focusing on maintaining tension in your core.
Slowly bring your hands back to your chest, resisting the pull of the band.
Repeat for the desired number of repetitions.`},{name:"band jack knife sit-up",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/Hsjfq20FDAEYd5",id:981,target:"abs",instructions:`Lie flat on your back with your legs straight and your arms extended overhead, holding the band.
Engage your abs and lift your legs and upper body simultaneously, bringing your hands towards your feet.
Pause for a moment at the top, then slowly lower your legs and upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band kneeling one arm pulldown",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/66ueIPsBeGLHF4",id:983,target:"lats",instructions:`Attach the band to a sturdy anchor point above your head.
Kneel down and hold the band with one hand, palm facing down.
Extend your arm fully overhead, keeping your elbow slightly bent.
Engage your lat muscles and pull the band down towards your side, bringing your elbow towards your ribcage.
Pause for a moment at the bottom, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"band kneeling twisting crunch",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/LVGnnhfCs4JwsV",id:985,target:"abs",instructions:`Attach the band to a sturdy anchor point at waist height.
Kneel down facing away from the anchor point and hold the band with both hands, keeping your elbows bent and close to your sides.
Engage your abs and slowly twist your torso to one side, bringing your hands towards your opposite hip.
Pause for a moment, then slowly return to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"band lying hip internal rotation",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/RBt4-XMFYiJtnH",id:984,target:"glutes",instructions:`Lie on your back with your legs straight and a resistance band looped around your feet.
Bend your knees and bring them towards your chest, keeping your feet together.
Slowly rotate your knees outwards, away from each other, while keeping your feet together.
Pause for a moment at the end of the rotation, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band lying straight leg raise",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/k5US4hY3gHLZPo",id:1002,target:"abs",instructions:`Lie flat on your back with your legs straight and your feet together.
Place the band around the arches of your feet and hold the ends of the band with your hands.
Engaging your abs, lift both legs off the ground until they are perpendicular to the floor.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band one arm overhead biceps curl",bodyPart:"upper arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/nMcuF-bxPSrq3V",id:986,target:"biceps",instructions:`Stand with your feet shoulder-width apart and place one end of the band under your foot.
Hold the other end of the band with your arm fully extended overhead, palm facing forward.
Keeping your upper arm stationary, curl your forearm towards your shoulder, squeezing your biceps.
Pause for a moment at the top, then slowly lower your forearm back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"band one arm single leg split squat",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/Wjadydi7axz3wu",id:987,target:"quads",instructions:`Stand with your feet hip-width apart and place a resistance band around your ankles.
Extend one leg forward and rest the top of your foot on a bench or step behind you.
Hold onto a support with one hand for balance.
Bend your standing leg and lower your body down into a squat position, keeping your knee in line with your toes.
Push through your heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"band one arm standing low row",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/r4vr5-YGSqKvOB",id:988,target:"upper back",instructions:`Attach the band to a stable anchor point at waist height.
Stand facing the anchor point with your feet shoulder-width apart.
Hold the band with one hand, palm facing inward, and step back to create tension in the band.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Pull the band towards your waist, squeezing your shoulder blades together.
Pause for a moment at the top of the movement, then slowly release the band back to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"band one arm twisting chest press",bodyPart:"chest",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/f9o5snYc6Qlvbe",id:989,target:"pectorals",instructions:`Attach the band to a sturdy anchor point at chest height.
Stand with your side facing the anchor point and grab the band with one hand.
Step away from the anchor point to create tension in the band.
Position your feet shoulder-width apart and slightly bend your knees.
Bring your hand holding the band across your body, towards the opposite shoulder.
While maintaining tension in the band, push your hand forward and away from your body, extending your arm.
Slowly return to the starting position and repeat for the desired number of repetitions.
Switch sides and repeat the exercise with the other hand.`},{name:"band one arm twisting seated row",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/HeWXbsF1XyUEII",id:990,target:"upper back",instructions:`Sit on a bench or chair with your feet flat on the ground and your back straight.
Hold the band with one hand and extend your arm fully in front of you.
Keeping your back straight, pull the band towards your body by bending your elbow and squeezing your shoulder blades together.
At the same time, twist your torso towards the side of the pulling arm.
Pause for a moment at the top, then slowly release the tension in the band and return to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"band pull through",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/JpLNFIl-i1OcQP",id:991,target:"glutes",instructions:`Attach a resistance band to a sturdy anchor point at ground level.
Stand facing away from the anchor point with your feet shoulder-width apart.
Step forward to create tension in the band, keeping your knees slightly bent.
Hinge at the hips and push your glutes back, maintaining a slight bend in your knees.
Lower your torso until it is parallel to the ground, feeling a stretch in your hamstrings.
Drive your hips forward and squeeze your glutes to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band push sit-up",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/EFE34hJ7K7SIUS",id:992,target:"abs",instructions:`Attach the band securely to a stable anchor point.
Lie flat on your back with your knees bent and feet flat on the ground.
Hold the band with both hands and extend your arms straight up towards the ceiling.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band reverse fly",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/Nls7g-pa7NWvNu",id:993,target:"delts",instructions:`Attach the band to a stationary object at chest height.
Stand with your feet shoulder-width apart and hold the band with both hands in front of you.
Keep your arms straight and lift them out to the sides until they are parallel to the ground.
Squeeze your shoulder blades together at the top of the movement.
Slowly lower your arms back to the starting position.
Repeat for the desired number of repetitions.`},{name:"band reverse wrist curl",bodyPart:"lower arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/XGyl5Ro1ttM6GZ",id:994,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground.
Hold the band with an overhand grip, palms facing down, and wrap it around your fingers.
Rest your forearms on your thighs, with your wrists hanging off the edge.
Slowly curl your wrists upward, squeezing your forearms.
Pause for a moment at the top, then slowly lower your wrists back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band seated hip internal rotation",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/kqRaQnYA-Pi-l2",id:996,target:"glutes",instructions:`Sit on a chair or bench with your back straight and feet flat on the ground.
Place a resistance band around your thighs, just above your knees.
Keep your knees bent at a 90-degree angle and your feet shoulder-width apart.
Engage your glutes and slowly rotate your knees outward, pushing against the resistance of the band.
Pause for a moment at the end of the movement, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band seated twist",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/aRyXG1sZc1dCZT",id:1011,target:"abs",instructions:`Sit on the ground with your legs extended in front of you and your back straight.
Wrap the band around your waist and hold the ends with both hands.
Engage your abs and slowly twist your torso to one side, keeping your back straight and your feet on the ground.
Pause for a moment at the end of the twist, then slowly return to the starting position.
Repeat the twist to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"band shoulder press",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/ydWXGqNx-9DrPC",id:997,target:"delts",instructions:`Stand with your feet shoulder-width apart and place the band under your feet.
Hold the band with your palms facing forward and raise your hands to shoulder height, elbows bent.
Press the band overhead, fully extending your arms.
Pause for a moment at the top, then slowly lower the band back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"band shrug",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/xiuCNkiOG0RkNp",id:1018,target:"traps",instructions:`Stand with your feet shoulder-width apart and place the band under your feet, holding the ends with your hands.
Keep your arms straight and relaxed, and let the band hang in front of your thighs.
Engage your traps by shrugging your shoulders upward, lifting the band as high as possible.
Hold the contraction for a moment, then slowly lower your shoulders back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band side triceps extension",bodyPart:"upper arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/Tt5fkpoBGUjpVB",id:998,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold the band with both hands, palms facing down.
Extend your arms straight out to the sides, keeping them parallel to the ground.
Slowly bend your elbows and bring your hands towards your shoulders, keeping your upper arms still.
Pause for a moment, then slowly extend your arms back out to the starting position.
Repeat for the desired number of repetitions.`},{name:"band single leg calf raise",bodyPart:"lower legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/W3aNMq9qvtji9G",id:999,target:"calves",instructions:`Stand with your feet hip-width apart and place the band around the ball of your left foot.
Hold onto a stable object for balance if needed.
Slowly raise your left heel off the ground, lifting your body weight onto the ball of your foot.
Pause for a moment at the top, then slowly lower your left heel back down to the starting position.
Repeat for the desired number of repetitions, then switch to the right leg.`},{name:"band single leg reverse calf raise",bodyPart:"lower legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/yFFwD1ckM3qJrz",id:1e3,target:"calves",instructions:`Stand with your feet hip-width apart and place the band around the ball of your foot.
Hold onto a stable object for balance.
Slowly raise your heel off the ground, lifting your body weight onto the ball of your foot.
Pause for a moment at the top, then slowly lower your heel back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other leg.`},{name:"band single leg split squat",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/DLzJjxgKdyRnUs",id:1001,target:"quads",instructions:`Stand with your feet hip-width apart and place a resistance band around your ankles.
Take a big step forward with your right foot and a smaller step back with your left foot.
Bend your knees and lower your body until your right thigh is parallel to the ground, keeping your left knee slightly above the ground.
Push through your right heel to return to the starting position.
Repeat on the other side.`},{name:"band squat",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/6PhYejZENOYDV3",id:1004,target:"glutes",instructions:`Stand with your feet shoulder-width apart, with the band placed just above your knees.
Keeping your chest up and core engaged, push your hips back and bend your knees to lower into a squat position.
Make sure your knees are tracking over your toes and your weight is in your heels.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band squat row",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/T4kFKIObXBrylh",id:1003,target:"glutes",instructions:`Attach the band to a sturdy anchor point at waist height.
Stand facing the anchor point with your feet shoulder-width apart.
Hold the band handles with your palms facing each other and your arms extended in front of you.
Bend your knees and lower into a squat position, keeping your back straight and chest lifted.
From the squat position, pull the band handles towards your body, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band standing crunch",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/HerXrs9y7xrUkx",id:1005,target:"abs",instructions:`Attach the band to a sturdy anchor point at waist height.
Stand facing away from the anchor point with your feet shoulder-width apart.
Hold the band with both hands and bring it up to your chest, keeping your elbows bent and close to your body.
Engage your abs and slowly crunch forward, bringing your chest towards your knees.
Pause for a moment at the top of the crunch, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band standing rear delt row",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/PVdQ9o5XUQLeJk",id:1022,target:"delts",instructions:`Stand with your feet shoulder-width apart and place the band under your feet.
Hold the band handles with your palms facing each other and your arms extended in front of you.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Pull the band towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band standing twisting crunch",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/EPTY54rRfKWiSA",id:1007,target:"abs",instructions:`Stand with your feet shoulder-width apart and place the band around your upper back, crossing it in front of your chest.
Hold the ends of the band with your hands, keeping your elbows bent and close to your sides.
Engage your abs and twist your torso to one side, bringing your elbow towards the opposite knee.
Pause for a moment, then return to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"band step-up",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/FM5D8qYtpfZVVB",id:1008,target:"glutes",instructions:`Place a band around your thighs, just above your knees.
Stand facing a step or platform with your feet hip-width apart.
Step up onto the platform with your right foot, pushing through your heel.
Extend your left leg behind you, keeping it straight.
Lower your left foot back down to the ground.
Repeat with your left foot stepping up onto the platform.
Continue alternating legs for the desired number of repetitions.`},{name:"band stiff leg deadlift",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/t1Cu6sfhEw7QLw",id:1009,target:"glutes",instructions:`Stand with your feet shoulder-width apart and place the band around your ankles.
Hold the band with both hands in front of your thighs, palms facing your body.
Keeping your back straight and your core engaged, hinge at the hips and slowly lower your upper body towards the ground.
As you lower, push your hips back and allow your knees to bend slightly.
Lower the band towards the ground, feeling a stretch in your hamstrings.
Pause for a moment at the bottom, then engage your glutes and hamstrings to lift your upper body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"band straight back stiff leg deadlift",bodyPart:"upper legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/4fgvDrjJ79zcAK",id:1023,target:"glutes",instructions:`Stand with your feet shoulder-width apart and place the band around your upper legs.
Hold the band with both hands in front of your thighs, palms facing your body.
Keeping your back straight and your knees slightly bent, hinge at the hips and lower the band towards the ground.
Feel the stretch in your hamstrings as you lower the band.
Engage your glutes and hamstrings to lift your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"band straight leg deadlift",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/ozCGKVi2ILA-IV",id:1010,target:"spine",instructions:`Stand with your feet shoulder-width apart and place the band around your feet.
Hold the band with both hands, palms facing your body, and keep your arms straight.
Engage your core and maintain a slight bend in your knees.
Slowly hinge forward at your hips, keeping your back straight and chest lifted.
Lower the band towards the ground while keeping your legs straight.
Pause for a moment at the bottom, then squeeze your glutes and hamstrings to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band twisting overhead press",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/f7l3K2G8UXMjo7",id:1012,target:"delts",instructions:`Stand with your feet shoulder-width apart and place the band under your feet.
Hold the band handles at shoulder height with your palms facing forward.
Engage your core and press the band overhead, fully extending your arms.
As you press, twist your torso to one side, keeping your hips stable.
Pause for a moment at the top, then return to the starting position.
Repeat the press and twist on the opposite side.
Continue alternating sides for the desired number of repetitions.`},{name:"band two legs calf raise - (band under both legs) v. 2",bodyPart:"lower legs",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/ABrhtu7JwuWpkB",id:1369,target:"calves",instructions:`Stand with your feet shoulder-width apart and place a resistance band under both feet.
Hold the ends of the band with your hands for stability.
Raise your heels off the ground as high as possible, using your calves.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band underhand pulldown",bodyPart:"back",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/E8kEnjhnbpKMq0",id:1013,target:"lats",instructions:`Attach the band to a high anchor point, such as a pull-up bar or sturdy beam.
Stand facing the anchor point with your feet shoulder-width apart.
Grasp the band with an underhand grip, hands slightly wider than shoulder-width apart.
Extend your arms fully overhead, keeping your elbows slightly bent.
Engage your lats and pull the band down towards your chest, squeezing your shoulder blades together.
Pause for a moment at the bottom of the movement, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"band v-up",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/dERG8UIfN5NTde",id:1014,target:"abs",instructions:`Lie flat on your back with your legs straight and your arms extended overhead, holding the band.
Engaging your abs, lift your legs and upper body off the ground simultaneously, reaching your hands towards your toes.
Pause for a moment at the top, then slowly lower your legs and upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band vertical pallof press",bodyPart:"waist",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/uJJNf6XMbW8433",id:1015,target:"abs",instructions:`Stand with your feet shoulder-width apart and wrap the band around a sturdy object at chest height.
Hold the band with both hands and step away from the anchor point, creating tension in the band.
Position yourself perpendicular to the anchor point, with your side facing the band.
Extend your arms straight out in front of you, keeping your hands at chest height.
Engage your core and press the band away from your chest, fully extending your arms.
Hold the position for a few seconds, then slowly bring the band back towards your chest.
Repeat for the desired number of repetitions, then switch sides.`},{name:"band wrist curl",bodyPart:"lower arms",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/9iUWtV9SYvnFIE",id:1016,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground.
Hold the band with both hands, palms facing up, and rest your forearms on your thighs.
Slowly curl your wrists upward, squeezing your forearms.
Pause for a moment at the top, then slowly lower your wrists back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"band y-raise",bodyPart:"shoulders",equipment:"band",gifUrl:"https://v2.exercisedb.io/image/ONY0EC7XdzswIX",id:1017,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold the band in front of your thighs with your palms facing inwards.
Keep your arms straight and lift them up and out to the sides, forming a 'Y' shape with your body.
Squeeze your shoulder blades together at the top of the movement.
Slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"basic toe touch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/d5j090W7PkaEYP",id:3212,target:"glutes",instructions:`Stand with your feet shoulder-width apart and your arms by your sides.
Bend forward at the waist, keeping your back straight and your knees slightly bent.
Reach down towards your toes with your hands, keeping your legs as straight as possible.
Pause for a moment at the bottom, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"bear crawl",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/J884Je8m3Ajd5F",id:3360,target:"cardiovascular system",instructions:`Start on all fours with your hands directly under your shoulders and your knees directly under your hips.
Lift your knees slightly off the ground, keeping your back flat and your core engaged.
Move your right hand and left foot forward simultaneously, followed by your left hand and right foot.
Continue crawling forward, alternating your hand and foot movements.
Maintain a steady pace and keep your core tight throughout the exercise.
Continue for the desired distance or time.`},{name:"bench dip (knees bent)",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WbQ7lqTUQu5kPP",id:129,target:"triceps",instructions:`Sit on the edge of a bench or chair with your hands gripping the edge next to your hips.
Slide your butt off the bench and straighten your legs in front of you, keeping your heels on the ground.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"bench dip on floor",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/yBAIXjJ9iatwLC",id:1399,target:"triceps",instructions:`Sit on the edge of a bench or chair with your hands gripping the edge, fingers pointing forward.
Slide your butt off the bench, supporting your weight with your hands.
Lower your body by bending your elbows until your upper arms are parallel to the floor.
Push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"bench hip extension",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qkXBjO4GR77gds",id:130,target:"glutes",instructions:`Sit on a bench with your back against the bench and your feet flat on the ground.
Place your hands on the bench for support.
Engage your glutes and hamstrings, then lift your hips off the bench until your body forms a straight line from your knees to your shoulders.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"bench pull-ups",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/eVqvXUhA7EOut8",id:3019,target:"lats",instructions:`Position yourself under a bar or a sturdy horizontal surface that is at chest height.
Grab the bar or surface with an overhand grip, slightly wider than shoulder-width apart.
Hang with your arms fully extended and your body straight.
Pull your chest towards the bar or surface by squeezing your shoulder blades together and bending your elbows.
Continue pulling until your chin is above the bar or surface.
Lower yourself back down to the starting position with control.
Repeat for the desired number of repetitions.`},{name:"bent knee lying twist",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/r1SCpN0FNYLUbB",id:3639,target:"glutes",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Extend your arms out to the sides, perpendicular to your body.
Keeping your knees together, slowly lower them to one side, aiming to touch the ground with your knees.
Pause for a moment, then engage your core and slowly lift your knees back to the starting position.
Repeat the movement to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"biceps leg concentration curl",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-t4PAjEnkRKVH2",id:1770,target:"biceps",instructions:`Sit on a bench with your legs spread apart and your feet flat on the ground.
Hold a dumbbell in one hand and place your elbow on the inside of your thigh, just above the knee.
With your palm facing up, curl the dumbbell towards your shoulder while keeping your upper arm stationary.
Squeeze your biceps at the top of the movement, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"biceps narrow pull-ups",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/YS3d4ykwHZbNaj",id:139,target:"biceps",instructions:`Hang from a pull-up bar with your palms facing towards you and your hands shoulder-width apart.
Engage your core and pull yourself up towards the bar, focusing on using your biceps to lift your body.
Pause for a moment at the top, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"biceps pull-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/I0uxpkSUFqXVXr",id:140,target:"biceps",instructions:`Hang from a pull-up bar with your palms facing away from you and your hands shoulder-width apart.
Engage your core and pull yourself up by bending your elbows, bringing your chest towards the bar.
Pause at the top of the movement, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"body-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/sAMb2JWkJTiiiC",id:137,target:"triceps",instructions:`Start by placing your hands on a raised surface, such as a bench or parallel bars, with your palms facing down and fingers pointing forward.
Extend your legs out in front of you, keeping your heels on the ground and your body straight.
Lower your body by bending your elbows, keeping them close to your sides, until your upper arms are parallel to the ground.
Pause for a moment, then push through your palms to straighten your arms and lift your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight drop jump squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZL5c7rXKGhyYkP",id:3543,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Lower your body into a squat position by bending your knees and pushing your hips back.
Jump up explosively, extending your hips, knees, and ankles.
While in mid-air, quickly bring your feet together.
Land softly on the balls of your feet and immediately drop back into a squat position.
Repeat for the desired number of repetitions.`},{name:"bodyweight incline side plank",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/LnY-DNdtpJ4PIt",id:3544,target:"abs",instructions:`Start by lying on your side with your legs extended and stacked on top of each other.
Place your forearm on the ground directly below your shoulder, with your elbow bent at a 90-degree angle.
Engage your core and lift your hips off the ground, creating a straight line from your head to your feet.
Hold this position for the desired amount of time.
Lower your hips back down to the ground and repeat on the other side.`},{name:"bodyweight kneeling triceps extension",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/skrSWIiwfLxNRn",id:1771,target:"triceps",instructions:`Kneel down on the ground with your knees hip-width apart.
Place your hands on the ground in front of you, shoulder-width apart, fingers pointing forward.
Extend your legs straight behind you, balancing on your toes and hands, forming a straight line from head to heels.
Bend your elbows and lower your upper body towards the ground, keeping your elbows close to your sides.
Pause for a moment at the bottom, then push through your hands to straighten your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight side lying biceps curl",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/XPG8xPP5qZYVGQ",id:1769,target:"biceps",instructions:`Lie on your side with your legs extended and your head supported by your arm.
Hold your upper arm against your side and bend your elbow to curl your forearm towards your shoulder.
Pause for a moment at the top, then slowly lower your forearm back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight squatting row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/q7bgnZhVpSUJIX",id:3168,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding onto a sturdy object or suspension trainer with your arms extended.
Lower your body into a squat position, keeping your back straight and your knees behind your toes.
From the squat position, pull your body up towards the object or suspension trainer, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight squatting row (with towel)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/wrDSSUToL8RZCM",id:3167,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding a towel in front of you with your palms facing down.
Bend your knees and lower your body into a squat position, keeping your back straight and your chest up.
As you lower into the squat, simultaneously pull the towel towards your chest, squeezing your shoulder blades together.
Pause for a moment at the bottom of the squat, then slowly return to the starting position while extending your arms.
Repeat for the desired number of repetitions.`},{name:"bodyweight standing calf raise",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PggvkurYefIcxy",id:1373,target:"calves",instructions:`Stand with your feet shoulder-width apart, toes pointing forward.
Place your hands on a wall or stable surface for balance.
Slowly raise your heels off the ground, lifting your body weight onto the balls of your feet.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight standing close-grip one arm row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/BrdrSNfBBiLmdq",id:3156,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a dumbbell in one hand with a neutral grip.
Bend forward at the hips, keeping your back straight and your core engaged.
Pull the dumbbell up towards your chest, keeping your elbow close to your body and squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"bodyweight standing close-grip row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/0c9oOGRPjJN29v",id:3158,target:"upper back",instructions:`Stand with your feet shoulder-width apart and knees slightly bent.
Bend forward at the waist, keeping your back straight and your core engaged.
Extend your arms straight in front of you, gripping the bar or handles with a close grip.
Pull the bar or handles towards your body, squeezing your shoulder blades together.
Pause for a moment at the top of the movement, then slowly release and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight standing one arm row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/c7H49WHLOZT0IM",id:3162,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a dumbbell in one hand.
Bend forward at the hips, keeping your back straight and your core engaged.
Let the dumbbell hang straight down in front of you, with your arm fully extended.
Pull the dumbbell up towards your chest, keeping your elbow close to your body.
Squeeze your shoulder blades together at the top of the movement.
Lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"bodyweight standing one arm row (with towel)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4CSHbVXRjxroVG",id:3161,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a towel with one hand.
Bend forward at the hips, keeping your back straight and your core engaged.
Pull the towel towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the towel back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"bodyweight standing row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/mt0QGRWqxEVSOB",id:3166,target:"upper back",instructions:`Stand with your feet shoulder-width apart and knees slightly bent.
Grasp a bar or handles with an overhand grip, palms facing down.
Keep your back straight and core engaged.
Pull the bar or handles towards your body, squeezing your shoulder blades together.
Pause for a moment at the top of the movement.
Slowly release and extend your arms back to the starting position.
Repeat for the desired number of repetitions.`},{name:"bodyweight standing row (with towel)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/LlJobSBz5GjVp4",id:3165,target:"upper back",instructions:`Stand with your feet shoulder-width apart and hold a towel in front of you with both hands.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Pull the towel towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"bottoms-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/2PLYZQdlvwibT5",id:138,target:"abs",instructions:`Lie flat on your back with your legs extended and your arms by your sides.
Bend your knees and bring them towards your chest, keeping your feet off the ground.
Engaging your abs, lift your hips off the ground, bringing your knees towards your head.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"box jump down with one leg stabilization",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/T-YSMARkGBJvQ4",id:1374,target:"calves",instructions:`Stand in front of a box or platform with your feet shoulder-width apart.
Bend your knees and jump onto the box, landing softly with one foot on the box and the other foot hanging off the edge.
Stabilize yourself on the box with the foot that is on it, while keeping the other foot off the ground.
Hold this position for a few seconds, engaging your calf muscles to maintain balance.
Slowly step down with the foot that is on the box, returning to the starting position.
Repeat the exercise with the other leg.`},{name:"bridge - mountain climber (cross body)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/rjv0Lh98NPcS9X",id:2466,target:"abs",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line.
Engage your core and lift your right foot off the ground, bringing your right knee towards your left elbow.
Return your right foot to the starting position and repeat the movement with your left foot towards your right elbow.
Continue alternating sides, moving at a controlled pace.
Keep your hips level and avoid lifting your hips too high or sagging them too low.
Maintain a steady breathing pattern throughout the exercise.
Repeat for the desired number of repetitions.`},{name:"burpee",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/tlU4y3xe2sXfeM",id:1160,target:"cardiovascular system",instructions:`Start in a standing position with your feet shoulder-width apart.
Lower your body into a squat position by bending your knees and placing your hands on the floor in front of you.
Kick your feet back into a push-up position.
Perform a push-up, keeping your body in a straight line.
Jump your feet back into the squat position.
Jump up explosively, reaching your arms overhead.
Land softly and immediately lower back into a squat position to begin the next repetition.`},{name:"butt-ups",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-uP64-966MSEuF",id:870,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands by your sides, palms facing down.
Engaging your abs, lift your legs off the ground, bringing your knees towards your chest.
At the top of the movement, squeeze your abs and pause for a moment.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"butterfly yoga pose",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/lNlWJicoafMKJm",id:1494,target:"adductors",instructions:`Sit on the floor with your legs extended in front of you.
Bend your knees and bring the soles of your feet together, allowing your knees to fall out to the sides.
Hold onto your ankles or feet with your hands.
Sit up tall and lengthen your spine.
Gently press your knees down towards the floor, feeling a stretch in your inner thighs.
Hold this position for a few breaths.
To release, slowly bring your knees back up and extend your legs.`},{name:"calf push stretch with hands against wall",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6BOM5aLCAXGEWH",id:1407,target:"calves",instructions:`Stand facing a wall with your feet hip-width apart.
Place your hands against the wall at shoulder height.
Step back with one foot, keeping your heel on the ground and your leg straight.
Bend your front knee slightly and lean forward, feeling a stretch in your calf.
Hold the stretch for 20-30 seconds.
Switch legs and repeat the stretch.`},{name:"calf stretch with hands against wall",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3bkxEYXGpYs4Sf",id:1377,target:"calves",instructions:`Stand facing a wall with your feet hip-width apart.
Place your hands against the wall at shoulder height.
Step your right foot back, keeping your heel on the ground and your leg straight.
Bend your left knee and lean forward, keeping your back leg straight and your heel on the ground.
Hold the stretch for 20-30 seconds.
Switch legs and repeat the stretch.`},{name:"captains chair straight leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xP7WHyU-iNwpCu",id:2963,target:"abs",instructions:`Sit on the captain's chair with your back against the backrest and your forearms resting on the arm pads.
Keep your upper body stable and your back straight.
Engage your abs and lift your legs up in front of you, keeping them straight.
Continue lifting until your legs are parallel to the ground or as high as you can comfortably go.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"chair leg extended stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/tpLhtsE2XArNdH",id:1548,target:"quads",instructions:`Sit on the edge of a chair with your back straight and feet flat on the ground.
Extend one leg straight out in front of you, keeping your heel on the ground.
Lean forward slightly, feeling a stretch in your quadriceps.
Hold this position for 20-30 seconds.
Switch legs and repeat the stretch.`},{name:"chest and front of shoulder stretch",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/nMMozdOxOkPCkM",id:1271,target:"pectorals",instructions:`Stand tall with your feet shoulder-width apart.
Extend your arms straight out in front of you at shoulder height.
Cross your arms in front of your body, with your right arm on top of your left arm.
Interlace your fingers and press your palms together.
Gently squeeze your shoulder blades together and push your hands forward, feeling a stretch in your chest and front of your shoulders.
Hold the stretch for 20-30 seconds, then release.
Repeat for the desired number of repetitions.`},{name:"chest dip",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/8rwHNSy2aThXmJ",id:251,target:"pectorals",instructions:`Position yourself on parallel bars with your arms fully extended and your body straight.
Lower your body by bending your elbows until your shoulders are below your elbows.
Push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"chest dip (on dip-pull-up cage)",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/G2bt5wDKCV8SFz",id:1430,target:"pectorals",instructions:`Adjust the dip bars to a height that allows you to comfortably grip them.
Stand between the bars and place your hands on each bar, slightly wider than shoulder-width apart.
Jump up and straighten your arms, supporting your body weight on the bars.
Bend your knees and cross your ankles behind you.
Lower your body by bending your elbows, keeping your chest up and your shoulders down.
Continue lowering until your shoulders are below your elbows or until you feel a stretch in your chest.
Push through your palms and extend your elbows to raise your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"chest dip on straight bar",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/VbsnCmslxBvFNN",id:2462,target:"pectorals",instructions:`Grab the parallel bars with your palms facing down and your arms fully extended.
Bend your knees and cross your ankles.
Lower your body by bending your arms until your shoulders are below your elbows.
Push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"chest stretch with exercise ball",bodyPart:"chest",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/RbL0INHfshVjUg",id:1272,target:"pectorals",instructions:`Sit on the stability ball with your feet flat on the ground and your back straight.
Hold the exercise ball with both hands and extend your arms straight out in front of you.
Slowly bring the exercise ball towards your chest, feeling a stretch in your chest muscles.
Hold the stretch for a few seconds, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"chest tap push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/nknYp9pS1xlw-H",id:3216,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your body in a straight line.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
As you lower yourself, tap your chest with your right hand.
Push yourself back up to the starting position.
Repeat the movement, this time tapping your chest with your left hand.
Continue alternating sides for the desired number of repetitions.`},{name:"chin-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/NQbEK5l6wjdcey",id:1326,target:"lats",instructions:`Hang from a pull-up bar with your palms facing towards you and your hands shoulder-width apart.
Engage your core and pull your body up towards the bar, leading with your chest.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"chin-ups (narrow parallel grip)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qhvun2WQLmKIgJ",id:253,target:"upper back",instructions:`Hang from a pull-up bar with a narrow parallel grip, palms facing towards you.
Engage your back muscles and pull your body up towards the bar, keeping your elbows close to your body.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"circles knee stretch",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/n8EBGnq18CaF1W",id:257,target:"calves",instructions:`Stand with your feet shoulder-width apart and your hands on your hips.
Bend your knees slightly and lift your heels off the ground, balancing on the balls of your feet.
Keeping your knees bent, rotate your knees in a circular motion, first clockwise and then counterclockwise.
Perform the movement for the desired number of repetitions.`},{name:"clap push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/N7Rl9GhnsoCkMV",id:1273,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart.
Lower your body towards the ground by bending your elbows, keeping your core engaged.
Push through your palms explosively to propel your body off the ground.
While in mid-air, clap your hands together before landing back in the starting position.
Repeat for the desired number of repetitions.`},{name:"clock push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/mErQ1zPGmaxh13",id:258,target:"pectorals",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
As you lower, rotate your body to the left, extending your left arm straight out to the side.
Push back up to the starting position, while rotating your body to the center.
Repeat the push-up, this time rotating your body to the right and extending your right arm out to the side.
Continue alternating sides with each repetition.`},{name:"close grip chin-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/yA9lcWiwoLpqrI",id:1327,target:"lats",instructions:`Grab the pull-up bar with your palms facing towards you and your hands shoulder-width apart.
Hang from the bar with your arms fully extended and your feet off the ground.
Engage your back muscles and pull your body up towards the bar, keeping your elbows close to your body.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"close-grip push-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/e4JJvN7cFkSGc6",id:259,target:"triceps",instructions:`Start in a high plank position with your hands placed close together, directly under your shoulders.
Engage your core and lower your body towards the ground, keeping your elbows close to your sides.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"close-grip push-up (on knees)",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/0oK1C6-2QMDzDv",id:2398,target:"triceps",instructions:`Start by getting on your hands and knees, with your hands shoulder-width apart and your knees hip-width apart.
Lower your upper body towards the ground by bending your elbows, keeping them close to your sides.
Pause for a moment when your chest is just above the ground.
Push through your palms to straighten your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"cocoons",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/zUJOW5nR6EUZ9A",id:260,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"crab twist toe touch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WINjKkHGU69v5r",id:1468,target:"abs",instructions:`Start by sitting on the ground with your knees bent and feet flat on the floor.
Place your hands behind you, fingers pointing towards your feet, and lift your hips off the ground.
Extend one leg straight out in front of you while simultaneously reaching your opposite hand towards your toes.
Return to the starting position and repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"cross body crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/BoYjwGssKYHAfn",id:262,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, lift your upper body off the ground and twist to bring your right elbow towards your left knee.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat on the other side, bringing your left elbow towards your right knee.
Repeat for the desired number of repetitions.`},{name:"crunch (hands overhead)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/2Fy1JPVGy-0T8i",id:267,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Extend your arms straight above your head.
Engaging your abs, lift your upper body off the ground, curling forward towards your knees.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"crunch (on stability ball)",bodyPart:"waist",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/nVD33F0tBF5az5",id:271,target:"abs",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Lie back on the ball until your lower back is supported and your upper body is parallel to the floor.
Place your hands behind your head or across your chest.
Engage your abs and lift your upper body towards your knees, curling your torso forward.
Pause for a moment at the top of the movement, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"crunch (on stability ball, arms straight)",bodyPart:"waist",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/y-g64Or1jXBPj0",id:272,target:"abs",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Lie back on the ball until your lower back is supported and your upper body is parallel to the floor.
Place your hands behind your head or cross them over your chest.
Engage your abs and lift your upper body off the ball, curling your shoulders towards your hips.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"crunch floor",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/TnyMUKpBnfcAfv",id:274,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engage your abs and lift your shoulders off the ground, curling forward towards your knees.
Pause for a moment at the top, then slowly lower your shoulders back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"curl-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xNsvA5Fp2jK7Di",id:3016,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"curtsey squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/JIYVQ4I0Qi2eBm",id:3769,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Take a step diagonally behind and across your body with your right foot, crossing it behind your left leg.
Bend both knees as if you were curtsying, lowering your body towards the ground.
Keep your torso upright and your weight on your front foot.
Push through your front foot to return to the starting position.
Repeat on the other side, stepping diagonally behind and across your body with your left foot.`},{name:"dead bug",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6OnqLJChzxx3Vo",id:276,target:"abs",instructions:`Lie flat on your back with your arms extended towards the ceiling.
Bend your knees and lift your legs off the ground, creating a 90-degree angle at your hips and knees.
Engage your core and lower back to press your lower back into the ground.
Slowly lower your right arm and left leg towards the ground, keeping them straight and hovering just above the floor.
Pause for a moment, then return to the starting position.
Repeat the movement with your left arm and right leg.
Continue alternating sides for the desired number of repetitions.`},{name:"decline crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6vtIvegrMLfyxM",id:277,target:"abs",instructions:`Lie on a decline bench with your feet secured and your knees bent at a 90-degree angle.
Place your hands behind your head or across your chest.
Engage your abs and lift your upper body towards your knees, curling your torso.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"decline push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qTUc9uMBX2gyCi",id:279,target:"pectorals",instructions:`Place your hands on the ground slightly wider than shoulder-width apart, with your feet elevated on a stable surface.
Keep your body in a straight line from head to toe, engaging your core muscles.
Lower your chest towards the ground by bending your elbows, keeping them close to your body.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"decline sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/1lNbGtF3bfA-Yk",id:282,target:"abs",instructions:`Lie on a decline bench with your feet secured and your knees bent.
Place your hands behind your head or across your chest.
Engage your abs and lift your upper body off the bench, curling forward towards your knees.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"deep push up",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/XAir-tmxB8Ky3W",id:1274,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your body in a straight line.
Lower your chest towards the ground by bending your elbows, keeping them close to your body.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"diamond push-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/yhj27X9TExba4U",id:283,target:"triceps",instructions:`Start in a high plank position with your hands close together, forming a diamond shape with your thumbs and index fingers.
Keep your body in a straight line from head to toe, engaging your core and glutes.
Lower your chest towards the diamond shape formed by your hands, keeping your elbows close to your body.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"donkey calf raise",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/rZOajyzUqZz2AT",id:284,target:"calves",instructions:`Stand with your toes on an elevated surface, such as a step or block.
Place your hands on a stable support, such as a wall or railing, for balance.
Raise your heels as high as possible, lifting your body weight onto the balls of your feet.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"drop push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Eg6vmcS7hVF2Rn",id:1275,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart.
Lower your chest towards the ground, keeping your elbows close to your body.
Once your chest is just above the ground, quickly drop your knees to the ground.
Push yourself back up to the starting position by extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell alternate biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/lqGKEl7oKJ7mAN",id:285,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions, alternating arms.`},{name:"dumbbell alternate biceps curl (with arm blaster)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6siW0fEBHBXNF4",id:2403,target:"biceps",instructions:`Stand up straight with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing forward.
Place the arm blaster on your upper arms, ensuring a secure fit.
Keeping your upper arms stationary, exhale and curl one dumbbell up towards your shoulder while contracting your biceps.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat the movement with the opposite arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell alternate hammer preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/UHUyK7eFsmv2nE",id:1646,target:"biceps",instructions:`Sit on a preacher bench with a dumbbell in each hand, palms facing your torso and arms fully extended.
Keep your upper arms stationary and exhale as you curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell alternate preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/C0BhksDVkavQup",id:1647,target:"biceps",instructions:`Sit on a preacher bench with a dumbbell in each hand, palms facing up.
Rest your upper arms on the pad of the preacher bench, allowing your arms to fully extend.
Keeping your upper arms stationary, exhale and curl the dumbbell in your right hand as you contract your biceps.
Continue to curl the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Pause for a moment, then inhale and slowly lower the dumbbell back to the starting position.
Repeat the movement with your left arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell alternate seated hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/JOQ8N9IVWr6vmU",id:1648,target:"biceps",instructions:`Sit on a bench with a dumbbell in each hand, palms facing your torso and arms extended down.
Keep your back straight and your elbows close to your torso.
Exhale and curl the dumbbell in your right hand towards your shoulder, keeping your upper arm stationary.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Pause for a brief moment, then inhale and slowly lower the dumbbell back to the starting position.
Repeat the movement with your left arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell alternate side press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/vuVl5wSTI2jhZQ",id:286,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder height.
Press one dumbbell overhead while keeping the other dumbbell at shoulder height.
Lower the pressed dumbbell back to shoulder height while pressing the other dumbbell overhead.
Continue alternating sides for the desired number of repetitions.`},{name:"dumbbell alternating bicep curl with leg raised on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ks1aFjTcO-nWFp",id:1649,target:"biceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing forward.
Place an exercise ball behind you and position one foot on top of it, keeping your balance.
With your arms fully extended and elbows close to your sides, curl one dumbbell towards your shoulder while keeping your upper arm stationary.
Lower the dumbbell back down to the starting position and repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell alternating seated bicep curl on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BWAYF4iXZmeNjt",id:1650,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing forward and your arms fully extended.
Keeping your upper arms stationary, exhale and curl one dumbbell while rotating your forearm until your palm is facing your shoulder.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat the curl with the other arm.
Continue alternating curls for the desired number of repetitions.`},{name:"dumbbell arnold press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0D6E6Vk4fYsQOr",id:2137,target:"delts",instructions:`Sit on a bench with back support and hold a dumbbell in each hand at shoulder level, palms facing your body and elbows bent.
Press the dumbbells upward until your arms are fully extended and your palms are facing forward.
Rotate your wrists as you lift, so that your palms are facing forward at the top of the movement.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell arnold press v. 2",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bwSTANG8ChTHq5",id:287,target:"delts",instructions:`Sit on a bench with back support and hold a dumbbell in each hand at shoulder level, palms facing your body and elbows bent.
Press the dumbbells upward until your arms are fully extended and your palms are facing forward.
Rotate your wrists as you lift, so that your palms end up facing forward at the top of the movement.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell around pullover",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/k2Ika7RWlu7n9t",id:288,target:"pectorals",instructions:`Lie flat on a bench with your head at one end and your feet firmly on the ground.
Hold a dumbbell with both hands and extend your arms straight above your chest.
Keeping your arms straight, slowly lower the dumbbell behind your head in an arc motion.
Pause for a moment at the bottom, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell bench press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/-POBYlMeeMddeh",id:289,target:"pectorals",instructions:`Lie flat on a bench with your feet flat on the ground and your back pressed against the bench.
Hold a dumbbell in each hand, with your palms facing forward and your arms extended above your chest.
Lower the dumbbells slowly to the sides of your chest, keeping your elbows at a 90-degree angle.
Pause for a moment, then push the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell bench seated press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/tqvBIAoOJvh37C",id:290,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, resting on your thighs.
Lean back and position the dumbbells to the sides of your chest, palms facing forward.
Press the dumbbells upward until your arms are fully extended.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell bench squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7Mos6oADMjAJ7e",id:291,target:"glutes",instructions:`Place a dumbbell on the ground in front of a bench.
Stand facing away from the bench with your feet shoulder-width apart.
Bend at the knees and hips to lower yourself down towards the bench, keeping your chest up and back straight.
Once your glutes touch the bench, push through your heels to stand back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell bent over row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ppKLWSX743x27c",id:293,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a dumbbell in each hand with your palms facing your body.
Bend forward at the hips, keeping your back straight and your core engaged.
Let your arms hang straight down towards the floor, with your elbows slightly bent.
Pull the dumbbells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell bicep curl lunge with bowling motion",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7FdxTo1fex7E8j",id:1651,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing forward.
Take a step forward with your right foot, bending your right knee and lowering your body into a lunge position.
As you lunge forward, curl the dumbbells up towards your shoulders, keeping your elbows close to your body.
At the bottom of the lunge, rotate your torso to the right, as if you were bowling a ball.
Reverse the motion, stepping back with your right foot and returning to the starting position while lowering the dumbbells back down.
Repeat the lunge and curl motion, this time rotating your torso to the left.
Continue alternating sides for the desired number of repetitions.`},{name:"dumbbell bicep curl on exercise ball with leg raised",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/yYpk0YoAJszbkb",id:1652,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing forward and your arms fully extended.
Slowly curl the dumbbells towards your shoulders, keeping your elbows close to your sides.
Pause for a moment at the top of the movement, then slowly lower the dumbbells back to the starting position.
While performing the bicep curl, raise one leg off the ground and hold it in the air for the duration of the exercise.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell bicep curl with stork stance",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/EQ6FcJlfCHK1yg",id:1653,target:"biceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing forward.
Extend one leg behind you, balancing on the toes of that foot.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/y6yknszPn5VM8E",id:294,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell biceps curl (with arm blaster)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0lX9y87IUWnxQu",id:2401,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward.
Keep your elbows close to your torso and your upper arms stationary.
Exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell biceps curl reverse",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BWqYzNdSwAA071",id:1654,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing down and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell biceps curl squat",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/wbGZ7bSdgwfmQM",id:1655,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing forward.
Keeping your back straight and your elbows close to your sides, exhale and curl the dumbbells up towards your shoulders.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell biceps curl v sit on bosu ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/PIscQL1dBGCIu3",id:1656,target:"biceps",instructions:`Sit on a bosu ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Hold a dumbbell in each hand with your palms facing forward and your arms fully extended down by your sides.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell burpee",bodyPart:"cardio",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/y3TZl0bZuTv2rO",id:1201,target:"cardiovascular system",instructions:`Start in a standing position with your feet shoulder-width apart and a dumbbell in each hand.
Lower your body into a squat position, placing the dumbbells on the ground in front of you.
Kick your feet back into a push-up position, keeping your body in a straight line.
Perform a push-up, bending your elbows and lowering your chest towards the ground.
Jump your feet back towards your hands, landing in a squat position.
Stand up explosively, lifting the dumbbells off the ground and bringing them to your shoulders.
Press the dumbbells overhead, fully extending your arms.
Lower the dumbbells back to your shoulders and repeat the entire sequence for the desired number of repetitions.`},{name:"dumbbell clean",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/jzQUrsbGWVKG54",id:295,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Bend your knees and lower your hips into a squat position, keeping your back straight and chest up.
Explosively extend your hips and knees, driving through your heels to jump off the ground.
As you jump, shrug your shoulders and pull the dumbbells up towards your shoulders, keeping them close to your body.
Catch the dumbbells at shoulder height, with your elbows pointing forward and your palms facing up.
Lower the dumbbells back down to the starting position by reversing the movement.
Repeat for the desired number of repetitions.`},{name:"dumbbell close grip press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/I5UrPzc60q3AwJ",id:1731,target:"triceps",instructions:`Sit on a flat bench with a dumbbell in each hand, resting on your thighs.
Using your thighs to help raise the dumbbells, lift the dumbbells one at a time so that you can hold them in front of you at shoulder width.
Once at shoulder width, rotate your wrists forward so that the palms of your hands are facing away from you. This will be your starting position.
As you breathe in, slowly lower the dumbbells to your side until they are about level with your chest.
As you exhale, use your triceps to lift the dumbbells back to the starting position. Make sure to use only your triceps and do not use your forearms or biceps to help lift the dumbbells.
After a second pause at the contracted position, repeat the movement for the prescribed amount of repetitions.`},{name:"dumbbell close-grip press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/NpiotF2whiLPsS",id:296,target:"triceps",instructions:`Sit on a flat bench with a dumbbell in each hand, resting on your thighs.
Using your thighs to help raise the dumbbells, lift the dumbbells one at a time so that you can hold them in front of you at shoulder width.
Once at shoulder width, rotate your wrists forward so that the palms of your hands are facing away from you. This will be your starting position.
As you breathe in, slowly lower the dumbbells to your side until they are about level with your chest.
As you exhale, use your triceps to lift the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell concentration curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/WYHnWpgwhGHKf0",id:297,target:"biceps",instructions:`Sit on a bench with your legs spread apart and a dumbbell in one hand, resting your elbow on the inside of your thigh.
Fully extend your arm and hold the dumbbell with an underhand grip.
Keeping your upper arm stationary, exhale and curl the weight up towards your shoulder while contracting your biceps.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell contralateral forward lunge",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/43-pu6-l4bmdi1",id:3635,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Take a step forward with your right foot, keeping your back straight and core engaged.
Lower your body by bending both knees until your right thigh is parallel to the ground.
Push through your right heel to return to the starting position.
Repeat with your left leg.
Alternate legs for the desired number of repetitions.`},{name:"dumbbell cross body hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/zhSpOwuPHG8pbY",id:298,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your body.
Keep your elbows close to your torso and your upper arms stationary.
Exhale and curl the weights while contracting your biceps, bringing the dumbbells across your body towards your opposite shoulder.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell cross body hammer curl v. 2",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/RBDb5wHguUB14T",id:1657,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your body.
Keep your elbows close to your torso and your upper arms stationary.
Exhale and curl the weights while contracting your biceps, bringing the dumbbells as close to your opposite shoulder as possible.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell cuban press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/CbG24PB9P6RhLI",id:299,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder height with your palms facing down.
Keeping your core engaged and your elbows slightly bent, press the dumbbells up and overhead until your arms are fully extended.
Rotate your wrists so that your palms are facing forward.
Slowly lower the dumbbells back to the starting position, rotating your wrists back to the starting position as you do so.
Repeat for the desired number of repetitions.`},{name:"dumbbell cuban press v. 2",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6fC-zXTA0J-rnV",id:2136,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder height with your palms facing down.
Keeping your core engaged and your back straight, press the dumbbells straight up overhead until your arms are fully extended.
Rotate your wrists so that your palms are facing forward.
Lower the dumbbells back down to shoulder height, rotating your wrists back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell deadlift",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Fh6fhmvDdYm6g0",id:300,target:"glutes",instructions:`Stand with your feet shoulder-width apart, toes pointing forward.
Hold a dumbbell in each hand, palms facing your body, arms extended downwards.
Bend at your hips and knees, lowering the dumbbells towards the ground while keeping your back straight.
Push through your heels and extend your hips and knees, lifting the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline bench press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/1nGgfRsmigdFMS",id:301,target:"pectorals",instructions:`Lie down on a decline bench with your feet secured and your head lower than your hips.
Hold a dumbbell in each hand and extend your arms straight up above your chest, palms facing forward.
Lower the dumbbells slowly to the sides of your chest, keeping your elbows at a 90-degree angle.
Push the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/5eOJNk8uWykoSe",id:302,target:"pectorals",instructions:`Lie on a decline bench with your feet secured and your head lower than your hips.
Hold a dumbbell in each hand with your palms facing each other and your arms extended above your chest.
Lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then squeeze your chest muscles to bring the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline hammer press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/zSWBYKdMjVIylF",id:303,target:"pectorals",instructions:`Lie on a decline bench with your feet secured and your head lower than your hips.
Hold a dumbbell in each hand with your palms facing each other and your arms extended above your chest.
Lower the dumbbells to the sides of your chest, keeping your elbows slightly bent.
Press the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline one arm fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bJy-NHWAaGo1uN",id:1276,target:"pectorals",instructions:`Lie down on a decline bench with a dumbbell in one hand, resting it on your thigh.
Using your thigh to help raise the dumbbell, lift it up to shoulder width with your palm facing your torso.
Rotate your wrist so that the palm of your hand is facing forward.
As you breathe in, lower the dumbbell slowly to the side until you feel a stretch in your chest.
Exhale and use your chest muscles to bring the dumbbell back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell decline one arm hammer press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/XmpKJnPtcagrXv",id:1617,target:"triceps",instructions:`Lie on a decline bench with a dumbbell in one hand, resting on your chest.
Extend your arm straight up, keeping your elbow slightly bent.
Lower the dumbbell down towards your shoulder, keeping your elbow close to your body.
Press the dumbbell back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell decline shrug",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/2qu2sP70KUE4dA",id:305,target:"traps",instructions:`Set up a decline bench at a 45-degree angle.
Lie face down on the bench with your chest and stomach resting against it.
Hold a dumbbell in each hand with your arms fully extended towards the floor.
Keeping your arms straight, raise your shoulders towards your ears as high as possible.
Hold the contraction for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline shrug v. 2",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/NkhdAesjWRkqh6",id:304,target:"traps",instructions:`Set up a decline bench at a 45-degree angle.
Lie face down on the bench with your chest and stomach resting on it.
Hold a dumbbell in each hand with your palms facing each other and your arms fully extended.
Keeping your arms straight, raise your shoulders as high as possible while squeezing your shoulder blades together.
Hold the contraction for a brief pause, then lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/jQ-ufx4KJSXIwb",id:306,target:"triceps",instructions:`Lie on a decline bench with your head lower than your feet and hold a dumbbell in each hand, palms facing each other.
Extend your arms fully, keeping your elbows close to your head.
Lower the dumbbells slowly behind your head, bending your elbows.
Pause for a moment, then raise the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell decline twist fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/vOExzRg-EhyqLM",id:307,target:"pectorals",instructions:`Lie down on a decline bench with your head lower than your hips.
Hold a dumbbell in each hand with your palms facing each other and your arms extended straight up over your chest.
Lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
As you lower the dumbbells, twist your wrists so that your palms face forward at the bottom of the movement.
Reverse the motion and bring the dumbbells back up to the starting position, squeezing your chest muscles at the top.
Repeat for the desired number of repetitions.`},{name:"dumbbell finger curls",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/98ULj0HHG6oE9f",id:1437,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with an underhand grip, resting your forearm on your thigh, palm facing up.
Allow the dumbbell to roll down to your fingertips, then curl it back up by flexing your fingers.
Repeat for the desired number of repetitions, then switch to the other hand.`},{name:"dumbbell fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/GgFxnOkqt4VZSH",id:308,target:"pectorals",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other.
Extend your arms straight up over your chest, with a slight bend in your elbows.
Keeping a slight bend in your elbows, lower your arms out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then reverse the movement and bring the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/wEz4iNCBQnYRNM",id:1277,target:"pectorals",instructions:`Sit on an exercise ball and hold a dumbbell in each hand.
Walk your feet forward and roll your body down until your head, neck, and upper back are supported by the ball.
Extend your arms straight up above your chest, palms facing each other.
Bend your elbows slightly and lower your arms out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then reverse the movement and squeeze your chest muscles as you bring the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell forward lunge triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/vWCr0WdNma7eie",id:1732,target:"triceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Take a step forward with your right foot, lowering your body into a lunge position.
Keep your back straight and your chest up.
Extend your arms straight overhead, keeping your elbows close to your ears.
Lower the dumbbells behind your head by bending your elbows.
Pause for a moment, then straighten your arms to return to the starting position.
Repeat the movement for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell front raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/OzqUpYKX7EXCqB",id:310,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing your thighs.
Keeping your arms straight, exhale and lift the dumbbells in front of you until they are at shoulder level.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell front raise v. 2",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/EQFHSypghAr3Pe",id:309,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing your thighs.
Keep your back straight and engage your core.
Slowly lift the dumbbells in front of you, with your arms straight, until they are at shoulder level.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell full can lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7bDp0CGx76qJrG",id:311,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing your body.
Keep your back straight and engage your core.
Raise your arms out to the sides, keeping a slight bend in your elbows, until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell goblet squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/9Ll4mUEKcbeA1m",id:1760,target:"quads",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell vertically against your chest with both hands.
Keeping your chest up and core engaged, lower your body down into a squat position by pushing your hips back and bending your knees.
Continue lowering until your thighs are parallel to the ground, or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ThHUhYWFU8A8GP",id:313,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and rotate the palms of your hands until they are facing forward.
This will be your starting position.
Now, keeping the upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Then, inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell hammer curl on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BrceAlyhlRgLxH",id:1659,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing your body and your arms fully extended.
Keeping your upper arms stationary, exhale and curl the dumbbells while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell hammer curl v. 2",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/4Glc3dSlMnoOMs",id:312,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and rotate the palms of your hands until they are facing forward.
This will be your starting position.
Now, keeping the upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Then, inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell hammer curls (with arm blaster)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/e4x2RJc1og-UG4",id:2402,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and rotate the palms of your hands until they are facing forward.
This will be your starting position.
Now, while holding your upper arm stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Then, inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell high curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/63APprkiSbVhqb",id:1664,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward.
Keep your upper arms stationary and curl the dumbbells as high as possible while contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline alternate press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/yp2lI1WhkNbjCA",id:3545,target:"pectorals",instructions:`Sit on an incline bench with a dumbbell in each hand, resting on your thighs.
Lean back on the bench and use your thighs to help raise the dumbbells to shoulder height, palms facing forward.
Once at shoulder height, rotate your wrists so that the palms of your hands are facing forward.
Push the dumbbells up with your chest and shoulders, extending your arms fully.
Lower the dumbbells back down to the starting position, keeping your elbows slightly bent.
Repeat for the desired number of repetitions, alternating arms.`},{name:"dumbbell incline bench press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/nOLxAi1BXuJXX1",id:314,target:"pectorals",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with your feet flat on the ground and your back pressed firmly against the bench.
Hold a dumbbell in each hand, palms facing forward, and lift them to shoulder height.
Slowly lower the dumbbells to the sides of your chest, keeping your elbows at a 90-degree angle.
Push the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/LKZA3h6JQTl7tp",id:315,target:"biceps",instructions:`Sit on an incline bench with a dumbbell in each hand, palms facing forward, and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline breeding",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/zEHoKNeoPNqh5J",id:316,target:"pectorals",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with your back against the pad and feet flat on the ground.
Hold a dumbbell in each hand with an overhand grip, palms facing forward.
Start with your arms fully extended, perpendicular to the ground.
Lower the dumbbells slowly to the sides of your chest, keeping your elbows at a 90-degree angle.
Pause for a moment at the bottom, then push the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/LtqouiyAB13Lwc",id:318,target:"biceps",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand, palms facing forward.
Rest your upper arms on the incline bench and let your elbows hang down, fully extending your arms.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline curl v. 2",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bBJyOseA-B-TNM",id:317,target:"biceps",instructions:`Sit on an incline bench with a dumbbell in each hand, palms facing forward and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/FBnhFNPrn0Qqup",id:319,target:"pectorals",instructions:`Set an incline bench to a 45-degree angle.
Sit on the bench with a dumbbell in each hand, palms facing each other.
Lie back on the bench and press the dumbbells up to the starting position, directly above your chest.
Lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then squeeze your chest muscles to bring the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ppWxc0rsh030Ms",id:1278,target:"pectorals",instructions:`Set up an incline bench at a 45-degree angle.
Sit on an exercise ball and roll forward until your upper back is resting on the incline bench.
Hold a dumbbell in each hand with your palms facing each other and your arms extended above your chest.
Lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then squeeze your chest muscles to bring the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/KPTV1B4YZV-RzD",id:320,target:"biceps",instructions:`Sit on an incline bench with a dumbbell in each hand, palms facing your torso and arms fully extended.
Keep your back against the bench and your feet flat on the floor.
While keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline hammer press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/gnkFJTqnZp9A8L",id:321,target:"pectorals",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand, resting on your thighs.
Lie back on the bench and position the dumbbells at shoulder level with your palms facing each other.
Press the dumbbells up and away from your body until your arms are fully extended.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline hammer press on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ElXc3Ha4B25sT4",id:1618,target:"triceps",instructions:`Sit on an exercise ball with a dumbbell in each hand, palms facing each other.
Walk your feet forward and roll your body down the ball until your head, neck, and upper back are supported on the ball.
Hold the dumbbells at shoulder level, elbows bent and pointing out to the sides.
Press the dumbbells up and slightly inward, keeping your palms facing each other.
Extend your arms fully, squeezing your triceps at the top of the movement.
Slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline inner biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/pTM2YlYOwVmYQ0",id:322,target:"biceps",instructions:`Sit on an incline bench with a dumbbell in each hand, palms facing each other.
Rest your upper arms on the bench, allowing your elbows to hang down and your palms to face forward.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline one arm fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/2ONoqQguzjMc9A",id:1279,target:"pectorals",instructions:`Adjust the incline bench to a 30-45 degree angle.
Sit on the bench with a dumbbell in one hand, resting it on your thigh.
Lie back on the bench, keeping your feet flat on the ground.
Hold the dumbbell with your arm extended straight up over your chest.
Lower the dumbbell out to the side in a wide arc, keeping a slight bend in your elbow.
Pause when your arm is parallel to the ground, then reverse the motion to bring the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell incline one arm fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ECm9cVo2egft1z",id:1280,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in one hand.
Walk your feet forward and roll your body down until your head, neck, and upper back are supported on the ball.
Hold the dumbbell with your arm extended straight up over your chest, palm facing inwards.
Slowly lower the dumbbell out to the side, keeping a slight bend in your elbow.
Pause for a moment when your arm is parallel to the ground.
Engage your chest muscles to bring the dumbbell back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell incline one arm hammer press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/IsLs-ZYsxDQH7Z",id:1619,target:"triceps",instructions:`Sit on an incline bench with a dumbbell in one hand, resting on your thigh.
Lean back on the bench and use your thigh to help raise the dumbbell to shoulder height.
Rotate your wrist so that your palm is facing inward, towards your body.
Press the dumbbell up and away from your body, extending your arm fully.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell incline one arm hammer press on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/8dwmC8bJvq9iCY",id:1620,target:"triceps",instructions:`Sit on an exercise ball with a dumbbell in one hand.
Walk your feet forward and roll your body down until your head, neck, and upper back are supported on the ball.
Hold the dumbbell with your palm facing inward and your elbow bent at a 90-degree angle.
Press the dumbbell up towards the ceiling, straightening your arm.
Lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell incline one arm lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Gbh9DOuFo-1aix",id:323,target:"delts",instructions:`Sit on an incline bench with a dumbbell in one hand, resting it on your thigh.
Lean forward and position your upper arm against the inside of your thigh.
Raise the dumbbell to the side, keeping your arm slightly bent and your palm facing down.
Continue lifting until your arm is parallel to the floor.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell incline one arm press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/h1YWMHgYoE3HzO",id:1281,target:"pectorals",instructions:`Sit on an incline bench with a dumbbell in one hand, resting on your thigh.
Lie back on the bench and position the dumbbell at shoulder level, palm facing forward.
Press the dumbbell upward and slightly inward, extending your arm fully.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell incline one arm press on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/RsomL5jS-YNwSS",id:1282,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in one hand, feet flat on the ground.
Slowly walk your feet forward, rolling the ball until your head, neck, and upper back are supported on the ball.
Hold the dumbbell at shoulder height with your palm facing forward.
Press the dumbbell upward until your arm is fully extended.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell incline palm-in press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BU48NZbmiS4sGn",id:324,target:"pectorals",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with a dumbbell in each hand, palms facing each other.
Plant your feet firmly on the ground and keep your back straight against the bench.
Start with the dumbbells at shoulder level, elbows bent and palms facing each other.
Press the dumbbells up and away from your body, extending your arms fully.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline press on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/d-5IY83Zy0eiXv",id:1283,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in each hand, palms facing forward.
Slowly walk your feet forward, rolling your body down the ball until your head, neck, and upper back are supported on the ball.
Hold the dumbbells at shoulder level, elbows bent and pointing out to the sides.
Press the dumbbells upward, extending your arms fully.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/uuHaw5CL6D1J-W",id:325,target:"delts",instructions:`Sit on an incline bench with a dumbbell in each hand, resting on your thighs.
Lean back on the bench and raise the dumbbells to shoulder height, palms facing forward.
Keeping your back against the bench, exhale and raise the dumbbells above your head, fully extending your arms.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline rear lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/wfOYl9k4YD62eR",id:326,target:"delts",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with your chest against the backrest and hold a dumbbell in each hand.
Extend your arms straight down with your palms facing each other.
Keeping a slight bend in your elbows, raise your arms out to the sides until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ises646l2unKKX",id:327,target:"upper back",instructions:`Set up an incline bench at a 45-degree angle.
Grab a dumbbell in each hand and sit on the bench with your chest against the incline.
Extend your arms fully, allowing the dumbbells to hang straight down from your shoulders.
Pull the dumbbells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline shrug",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/uwnIfEStkUtBWw",id:329,target:"traps",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand.
Place your feet flat on the ground and let your arms hang straight down with your palms facing your body.
Keeping your arms straight, shrug your shoulders up towards your ears as high as possible.
Hold the contraction for a moment, then slowly lower your shoulders back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline t-raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/NZBcsR3d8bNn4P",id:3542,target:"delts",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand, palms facing inwards.
Lean forward and let your arms hang straight down, perpendicular to the floor.
Keeping your arms straight, raise them out to the sides until they are parallel to the floor, forming a 'T' shape with your body.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bHWw8EhoXeOKHE",id:330,target:"triceps",instructions:`Sit on an incline bench with a dumbbell in each hand, palms facing inwards.
Extend your arms fully overhead, keeping your elbows close to your head.
Lower the dumbbells behind your head by bending your elbows, keeping your upper arms stationary.
Pause for a moment, then raise the dumbbells back to the starting position by extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline twisted flyes",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/4TR6BsJne29GEF",id:331,target:"pectorals",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand, palms facing each other.
Lie back on the bench and press the dumbbells up to the starting position, directly above your chest, with your arms extended.
Lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
As you lower the dumbbells, rotate your wrists so that your palms face forward at the bottom of the movement.
Reverse the motion and bring the dumbbells back up to the starting position, squeezing your chest muscles together at the top.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline two arm extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/kzgLjSgIr97PtR",id:1733,target:"triceps",instructions:`Sit on an incline bench with a dumbbell in each hand, resting on your thighs.
Slowly lie back on the bench, keeping the dumbbells close to your chest.
Once you are fully lying down, extend your arms straight up towards the ceiling, keeping your elbows slightly bent.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell incline y-raise",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/CNtF4xp2aICsQa",id:3541,target:"upper back",instructions:`Set an incline bench to a 45-degree angle and sit on it with a dumbbell in each hand, palms facing inwards.
Lean forward slightly and let your arms hang straight down, keeping a slight bend in your elbows.
Raise your arms out to the sides and up in a Y shape until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell iron cross",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/5ovGHJzj6YBSIm",id:332,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at your sides.
Raise your arms out to the sides until they are parallel to the ground, forming a T shape with your body.
Pause for a moment, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/WFF0cDGlO4qOzk",id:333,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Bring your upper arms close to your sides, with your elbows bent at a 90-degree angle.
Extend your arms straight back, squeezing your triceps at the top of the movement.
Pause for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell kickbacks on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bvLp8Rlt-Jrgdh",id:1734,target:"triceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing inwards and your arms bent at a 90-degree angle.
Extend your arms straight back, squeezing your triceps at the top of the movement.
Pause for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell kneeling bicep curl exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/tdqoocPX68GENP",id:1660,target:"biceps",instructions:`Kneel on the floor with an exercise ball in front of you.
Place your elbows on top of the exercise ball, holding a dumbbell in each hand with your palms facing up.
Keeping your upper arms stationary, exhale and curl the dumbbells while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/a5jCJbVzJ53N15",id:334,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing your body.
Keep your back straight and engage your core.
Raise your arms out to the sides until they are parallel to the floor, keeping a slight bend in your elbows.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lateral to front raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/OSa0yl8paogZeo",id:335,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing your body.
Keep your back straight and engage your core.
Raise your arms out to the sides until they are parallel to the ground, keeping a slight bend in your elbows.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Next, raise your arms in front of you until they are parallel to the ground, again keeping a slight bend in your elbows.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lunge",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0VeviMiEq2k3PP",id:336,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Take a step forward with your right foot, lowering your body into a lunge position.
Keep your back straight and your chest up as you lower your body.
Push through your right heel to return to the starting position.
Repeat with your left leg.
Alternate legs for the desired number of repetitions.`},{name:"dumbbell lunge with bicep curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/VcGqXco02RuXnF",id:1658,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing forward.
Take a step forward with your right foot, lowering your body into a lunge position. Your right knee should be bent at a 90-degree angle and your left knee should be hovering just above the ground.
As you lunge forward, simultaneously curl the dumbbells towards your shoulders, keeping your elbows close to your body.
Pause for a moment at the bottom of the lunge, then push through your right heel to return to the starting position, lowering the dumbbells back down to your sides.
Repeat the lunge and bicep curl on the opposite side, stepping forward with your left foot.
Continue alternating sides for the desired number of repetitions.`},{name:"dumbbell lying extension (across face)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/rvBP3Xjvsa9eUz",id:337,target:"triceps",instructions:`Lie flat on a bench with your feet flat on the ground and your head at the end of the bench.
Hold a dumbbell with both hands and extend your arms straight up above your chest, palms facing each other.
Keeping your upper arms stationary, slowly lower the dumbbell in an arc behind your head until your forearms are parallel to the ground.
Pause for a moment, then contract your triceps to bring the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying alternate extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/TNZkce81dP1C40",id:1729,target:"triceps",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other.
Extend your arms straight up over your chest, keeping a slight bend in your elbows.
Lower one dumbbell down towards your head, bending at the elbow, while keeping the other arm extended.
Pause for a moment at the bottom, then raise the dumbbell back up to the starting position.
Repeat with the other arm, alternating sides for the desired number of repetitions.`},{name:"dumbbell lying elbow press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/SqvPTNtDlr7Vzr",id:338,target:"triceps",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other and arms extended straight up over your chest.
Lower the dumbbells towards your shoulders by bending your elbows, keeping your upper arms stationary.
Pause for a moment at the bottom, then press the dumbbells back up to the starting position by extending your elbows.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying external shoulder rotation",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/lXMdGoA07Xol51",id:863,target:"delts",instructions:`Lie on your side on a flat bench with your upper arm against your side and your elbow bent 90 degrees.
Hold a dumbbell in your hand with your palm facing down.
Keeping your upper arm against your side, slowly rotate your forearm upward as far as possible.
Pause for a moment at the top, then slowly lower your forearm back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell lying femoral",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/MhBUxkdMKXIQwj",id:339,target:"hamstrings",instructions:`Lie flat on your back with your legs extended and a dumbbell resting on your lower abdomen.
Bend your knees and bring the dumbbell towards your glutes, keeping your feet flat on the ground.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying hammer press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/HqCFXqC9MbnnLz",id:340,target:"pectorals",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other and arms extended straight up.
Lower the dumbbells to the sides of your chest, keeping your elbows at a 90-degree angle.
Press the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying on floor rear delt raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/R6l74RZqGEVsBI",id:2470,target:"delts",instructions:`Lie face down on the floor with a dumbbell in each hand, palms facing each other.
Extend your arms straight out in front of you, keeping a slight bend in your elbows.
Engaging your shoulder muscles, lift your arms up and out to the sides, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying one arm deltoid rear",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/K8AtFwQ3dLyDms",id:341,target:"delts",instructions:`Lie face down on a flat bench with a dumbbell in one hand, palm facing inwards.
Extend your arm straight down towards the floor, keeping it close to your body.
Raise your arm up and back, squeezing your shoulder blade towards your spine.
Pause for a moment at the top, then slowly lower your arm back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell lying one arm press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6nDoHH1T4hFcCB",id:343,target:"pectorals",instructions:`Lie flat on a bench with a dumbbell in one hand and your feet flat on the ground.
Hold the dumbbell at shoulder level with your palm facing forward.
Press the dumbbell upward until your arm is fully extended.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell lying one arm press v. 2",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/RNIb6Y5KuA4gfk",id:342,target:"pectorals",instructions:`Lie flat on a bench with your back supported and feet flat on the ground.
Hold a dumbbell in one hand with your palm facing towards your feet.
Extend your arm straight up towards the ceiling, keeping your elbow slightly bent.
Slowly lower the dumbbell down towards your chest, keeping your elbow close to your body.
Pause for a moment at the bottom, then push the dumbbell back up to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell lying one arm pronated triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/21cDbrXeIsLX5I",id:344,target:"triceps",instructions:`Lie flat on a bench with your back and head supported, and your feet flat on the ground.
Hold a dumbbell in one hand with your palm facing down, and extend your arm straight up above your shoulder.
Keeping your upper arm stationary, slowly lower the dumbbell behind your head by bending your elbow.
Pause for a moment at the bottom, then extend your arm back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell lying one arm rear lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/v05jtmmDfzDAnL",id:345,target:"delts",instructions:`Lie face down on a flat bench with a dumbbell in one hand, hanging towards the floor.
Keep your arm straight and lift the dumbbell out to the side, away from your body.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell lying one arm supinated triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/LUve7IJBLZ7oiZ",id:346,target:"triceps",instructions:`Lie flat on a bench with your back and head supported, and your feet flat on the ground.
Hold a dumbbell in one hand with an underhand grip, and extend your arm straight up above your shoulder.
Keeping your upper arm stationary, slowly lower the dumbbell behind your head by bending your elbow.
Pause for a moment at the bottom, then extend your arm back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell lying pronation",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/QI1VYLegcuU0yR",id:347,target:"forearms",instructions:`Lie flat on a bench with your chest facing down and your arms extended straight down, holding a dumbbell in each hand.
Rotate your palms so they are facing up.
Keeping your upper arms stationary, exhale and curl the dumbbells as you rotate your palms to face down.
Inhale and slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying pronation on floor",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/CPy396V17X9Orp",id:2705,target:"forearms",instructions:`Lie flat on the floor with your face down and your arms extended straight out in front of you, holding a dumbbell in each hand.
Rotate your palms so they are facing down towards the floor.
Keeping your arms straight, lift the dumbbells off the floor by contracting your forearms.
Continue lifting until your forearms are fully contracted and the dumbbells are at shoulder level.
Hold for a moment, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying pullover on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/GTqz4A7urL9ebI",id:1284,target:"pectorals",instructions:`Sit on an exercise ball and roll forward until your upper back is resting on the ball.
Hold a dumbbell with both hands and extend your arms straight up over your chest.
Slowly lower the dumbbell behind your head while keeping your arms straight.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying rear delt row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/vV1T37Hi6a8VX1",id:1328,target:"upper back",instructions:`Lie face down on a flat bench with a dumbbell in each hand, palms facing inwards.
Extend your arms straight down towards the floor, keeping a slight bend in your elbows.
Engaging your back muscles, lift the dumbbells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying rear lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Jg0L9DELmXOXGU",id:348,target:"delts",instructions:`Lie face down on a flat bench with a dumbbell in each hand, palms facing each other.
Extend your arms straight down towards the floor, keeping a slight bend in your elbows.
Engaging your shoulder muscles, lift your arms out to the sides until they are parallel to the floor.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying single extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/01icqzCb7uUOLZ",id:1735,target:"triceps",instructions:`Lie flat on a bench with a dumbbell in one hand and your arm fully extended above your chest.
Lower the dumbbell in a controlled manner towards your forehead, keeping your upper arm stationary.
Pause briefly at the bottom of the movement, then extend your arm back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell lying supination",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ZeHPFtEx2scKB3",id:349,target:"forearms",instructions:`Lie flat on a bench with your feet flat on the ground.
Hold a dumbbell in each hand with your palms facing up and your arms fully extended.
Keeping your upper arms stationary, curl the dumbbells towards your shoulders by contracting your forearms.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying supination on floor",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/MBAyBCJor6ZTeR",id:2706,target:"forearms",instructions:`Lie flat on your back on the floor with your legs extended and your arms by your sides, holding a dumbbell in each hand.
Rotate your palms to face up, keeping your elbows close to your sides.
Slowly curl the dumbbells towards your shoulders, squeezing your forearms.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying supine biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/smTR4cUNnnWCt8",id:1661,target:"biceps",instructions:`Lie flat on a bench with your back and head supported, and your feet flat on the ground.
Hold a dumbbell in each hand with your palms facing up and your arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying supine curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/FlJgIgupFuVfU4",id:350,target:"biceps",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing up and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/IlRkHhFn2uq0xn",id:351,target:"triceps",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other.
Extend your arms straight up over your chest, keeping your elbows close to your body.
Lower the dumbbells down towards your forehead, bending your elbows.
Pause for a moment, then extend your arms back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell lying wide curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bAWTurt5b2c98E",id:1662,target:"biceps",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing up and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell neutral grip bench press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/MpXrAo6HN8yBuE",id:352,target:"triceps",instructions:`Lie flat on a bench with your feet flat on the ground and your back pressed against the bench.
Hold a dumbbell in each hand with a neutral grip (palms facing each other) and your arms extended straight up over your chest.
Slowly lower the dumbbells down towards your chest, keeping your elbows close to your body.
Pause for a moment at the bottom, then push the dumbbells back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"dumbbell one arm bench fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/lF9sbAH5KmcVs6",id:1285,target:"pectorals",instructions:`Sit on a flat bench with a dumbbell in one hand, resting it on top of your thigh.
Lie back on the bench, keeping the dumbbell pressed against your thigh.
Using your free hand, help lift the dumbbell up to the starting position.
Hold the dumbbell directly above your shoulder with your arm extended and palm facing inward.
Lower the dumbbell out to the side in a wide arc, keeping a slight bend in your elbow.
Pause when your arm is parallel to the ground, then reverse the movement and bring the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms and repeat.`},{name:"dumbbell one arm bent-over row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/JhUHaW6t70cn9H",id:292,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand with your palm facing your body.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and your core engaged.
Let the dumbbell hang straight down towards the floor, with your arm fully extended.
Pull the dumbbell up towards your chest, keeping your elbow close to your body and squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell one arm chest fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BGl3YX1TRKnX0p",id:1286,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in one hand and your feet flat on the ground.
Walk your feet forward, rolling the ball until your upper back is supported on the ball and your head, neck, and shoulders are off the ball.
Extend your arm with the dumbbell straight up above your chest, palm facing inward.
Slowly lower the dumbbell out to the side, keeping a slight bend in your elbow.
Pause for a moment when your arm is parallel to the ground.
Engage your chest muscles to bring the dumbbell back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm concentration curl (on stability ball)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/-hSHK3gyJgCosQ",id:353,target:"biceps",instructions:`Sit on a stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Hold a dumbbell in one hand with your palm facing up and your arm extended down towards the floor.
Rest your elbow on the inside of your thigh, just above the knee.
Keeping your upper arm stationary, exhale and curl the dumbbell up towards your shoulder while contracting your biceps.
Pause for a moment at the top of the movement, then inhale and slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms and repeat.`},{name:"dumbbell one arm decline chest press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/DpjzTexNUxB3Pg",id:1287,target:"pectorals",instructions:`Lie on a decline bench with a dumbbell in one hand, resting on your chest.
Place your feet flat on the ground and keep your back pressed against the bench.
Extend your arm and push the dumbbell up towards the ceiling, fully extending your elbow.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/j9m1R2HAExxWOr",id:1288,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in one hand and your feet flat on the ground.
Walk your feet forward and roll your body down until your upper back is resting on the exercise ball.
Extend your arm with the dumbbell straight up above your chest, palm facing inwards.
Slowly lower the dumbbell out to the side, keeping a slight bend in your elbow.
Pause for a moment, then squeeze your chest muscles to bring the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm french press on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/LurTpNCkb2q5c6",id:1736,target:"triceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with your palm facing up and your elbow bent at a 90-degree angle.
Extend your arm straight up towards the ceiling, keeping your elbow stationary.
Slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm hammer preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/-mNv7HCNUhAA26",id:1663,target:"biceps",instructions:`Sit on a preacher bench with a dumbbell in one hand and your upper arm resting on the pad.
Hold the dumbbell with a neutral grip (palms facing your body).
Keeping your upper arm stationary, exhale and curl the dumbbell up towards your shoulder.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm hammer press on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/aVFFwKctKj23eI",id:1621,target:"triceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with your palm facing inwards and your elbow bent at a 90-degree angle.
Place your other hand on your hip for stability.
Press the dumbbell upwards, extending your arm fully.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm incline chest press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/wEq2Fv4aEbRlME",id:1289,target:"pectorals",instructions:`Adjust the incline bench to a 45-degree angle.
Sit on the bench with your back against the pad and feet flat on the ground.
Hold a dumbbell in one hand with an overhand grip, resting it on your shoulder.
Push the dumbbell up and away from your body, extending your arm fully.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/AuMlnzfoQ8o6T7",id:354,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in your right hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Bring your right elbow up to your side, keeping it bent at a 90-degree angle.
Extend your right arm straight back, squeezing your triceps at the top of the movement.
Slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell one arm lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/pEiGemj8D4xEnH",id:355,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand with your palm facing your body.
Keep your back straight and your core engaged throughout the exercise.
Raise the dumbbell to the side, keeping your arm straight and your palm facing down.
Continue lifting until your arm is parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm lateral raise with support",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6Z80fChPyobOfv",id:356,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand, with your palm facing your body.
Place your other hand on a stable surface, such as a bench or wall, for support.
Keep your back straight and engage your core.
Raise the dumbbell out to the side, keeping your arm straight and your palm facing down.
Continue lifting until your arm is parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell one arm press on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0WQM9DHFIzyE2M",id:1290,target:"pectorals",instructions:`Sit on an exercise ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Hold a dumbbell in one hand and position it at shoulder height, with your elbow bent and palm facing forward.
Slowly press the dumbbell upward until your arm is fully extended, while keeping your core engaged and maintaining balance on the exercise ball.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm prone curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Fi4sjpYkKM4WhE",id:1665,target:"biceps",instructions:`Lie face down on a flat bench with a dumbbell in one hand, palm facing down.
Extend your arm fully, letting it hang straight down towards the floor.
Keeping your upper arm stationary, curl the dumbbell up towards your shoulder by contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm prone hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0zxjKeSF6G8Mxv",id:1666,target:"biceps",instructions:`Lie face down on a flat bench with a dumbbell in one hand, palm facing your body and arm fully extended.
Keep your upper arm stationary and curl the dumbbell towards your shoulder, contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm pullover on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/dBMytiOftSxh50",id:1291,target:"pectorals",instructions:`Sit on an exercise ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Hold a dumbbell with one hand and extend your arm straight up above your chest.
Slowly lower the dumbbell behind your head while keeping your arm straight.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm reverse wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/tnP5vn1TcuK84k",id:358,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground.
Hold a dumbbell in one hand with an overhand grip, palm facing down.
Rest your forearm on your thigh, with your wrist hanging off the edge.
Slowly lower the dumbbell towards the ground by flexing your wrist.
Pause for a moment at the bottom, then slowly curl your wrist back up towards your body.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm reverse fly (with support)",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BzV8wKHIlQ3kDG",id:359,target:"delts",instructions:`Sit on a bench with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with your palm facing inwards.
Lean forward and place your free hand on the bench for support.
Keep your arm slightly bent and raise it out to the side until it is parallel to the ground.
Pause for a moment at the top, then slowly lower your arm back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm reverse grip press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ol1VAcH8xDec1l",id:1622,target:"pectorals",instructions:`Sit on a flat bench with a dumbbell in one hand, palm facing towards your body.
Place your feet flat on the ground and keep your back straight.
Raise the dumbbell to shoulder height, keeping your elbow close to your body.
Press the dumbbell upwards until your arm is fully extended.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm reverse preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/OQnDIwcPfvQt9h",id:1414,target:"biceps",instructions:`Sit on a preacher bench with your chest against the pad and your arm extended over the edge of the bench, holding a dumbbell with an underhand grip.
Lower the dumbbell slowly until your arm is fully extended.
Curl the dumbbell back up towards your shoulder, keeping your upper arm stationary.
Squeeze your biceps at the top of the movement, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm reverse spider curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/M2BbqaA52-tIMu",id:1667,target:"biceps",instructions:`Stand up straight with a dumbbell in one hand, palm facing down and arm fully extended.
Keeping your upper arm stationary, curl the dumbbell towards your shoulder by flexing your elbow.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm seated bicep curl on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/esrL-vdB77NcBU",id:1668,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with your palm facing up and your arm fully extended.
Keeping your upper arm stationary, curl the dumbbell towards your shoulder by contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm seated hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/v49KVZVDV-ZGnE",id:1669,target:"biceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in one hand with a neutral grip (palms facing each other).
Rest your elbow on the inside of your thigh, just above the knee.
Keeping your upper arm stationary, exhale and curl the dumbbell up towards your shoulder.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm seated neutral wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/yfGxITi5n4n2Z0",id:1415,target:"forearms",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in one hand, palm facing up.
Rest your forearm on your thigh, allowing your wrist to hang off the edge.
Keeping your forearm stationary, curl your wrist upward as far as possible.
Pause for a moment at the top, then slowly lower your wrist back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other hand.`},{name:"dumbbell one arm shoulder press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6Bz80boAzvlzJg",id:361,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand at shoulder level, palm facing forward.
Press the dumbbell upward until your arm is fully extended overhead.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm shoulder press v. 2",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/uOp9C1sRSPZv4m",id:360,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand at shoulder level, palm facing forward.
Engage your core and press the dumbbell straight up overhead, fully extending your arm.
Pause for a moment at the top, then slowly lower the dumbbell back to shoulder level.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm snatch",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Blz35RfNyDhluf",id:3888,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand with an overhand grip.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and chest up.
Lower the dumbbell towards the ground, keeping it close to your body.
Explosively extend your hips, knees, and ankles, driving the dumbbell upwards in a straight line.
As the dumbbell reaches shoulder height, quickly rotate your hand and punch it overhead, fully extending your arm.
Catch the dumbbell overhead with a slight bend in your knees and hips.
Lower the dumbbell back down to the starting position in a controlled manner.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm standing curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/pPAJjBx1aNejHU",id:1670,target:"biceps",instructions:`Stand up straight with a dumbbell in one hand, palm facing forward and arm fully extended.
Keeping your upper arm stationary, exhale and curl the weight upward while contracting your biceps.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm standing hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/VFJst4AgrbkyBo",id:1671,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and your upper arms stationary.
Exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell one arm triceps extension (on bench)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/kZDim2DfR0fxY9",id:362,target:"triceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in one hand and place your other hand on the bench for support.
Raise the dumbbell overhead, keeping your upper arm close to your head and your elbow pointing forward.
Lower the dumbbell behind your head by bending your elbow, keeping your upper arm stationary.
Extend your arm back up to the starting position, fully straightening your elbow.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one arm upright row",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/mwlB3EP5I4qfD6",id:363,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand with an overhand grip.
Let the dumbbell hang at arm's length in front of your thighs, with your palm facing your body.
Keeping your back straight and your core engaged, exhale and lift the dumbbell straight up towards your chin, leading with your elbow.
Pause for a moment at the top, then inhale and slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell one arm wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/hvc9T9NqZTMY9v",id:364,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground.
Hold a dumbbell in one hand with an underhand grip, resting your forearm on your thigh.
Allow your wrist to extend, letting the dumbbell roll down towards your fingers.
Slowly curl your wrist back up, bringing the dumbbell towards your forearm.
Repeat for the desired number of repetitions, then switch to the other hand.`},{name:"dumbbell one arm zottman preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/8rLoTDTRL73S3B",id:1672,target:"biceps",instructions:`Sit on a preacher curl bench and hold a dumbbell in one hand with an underhand grip.
Rest your upper arm on the preacher bench pad, allowing your arm to fully extend.
Curl the dumbbell up towards your shoulder, keeping your upper arm stationary.
At the top of the curl, rotate your wrist so that your palm faces up.
Slowly lower the dumbbell back down to the starting position, rotating your wrist back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell one leg fly on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Nf7Z-3RS6L3ueu",id:1292,target:"pectorals",instructions:`Sit on an exercise ball with a dumbbell in each hand, palms facing each other.
Place one foot on the ground and extend the other leg straight out in front of you.
Lean forward slightly and bring your arms out to the sides, keeping a slight bend in your elbows.
Slowly lower the dumbbells down and out to the sides, feeling a stretch in your chest.
Pause for a moment at the bottom, then squeeze your chest muscles to bring the dumbbells back up to the starting position.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell over bench neutral wrist curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/hiQAGMIJGMolq2",id:365,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing up.
Rest your forearms on the bench, allowing your wrists to hang off the edge.
Keeping your upper arms stationary, exhale and curl the dumbbells up towards your shoulders.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell over bench one arm neutral wrist curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/kWwIhY3eToRFfX",id:366,target:"biceps",instructions:`Sit on a bench with a dumbbell in one hand and your arm extended over the bench, palm facing up.
Keep your upper arm stationary and curl the dumbbell towards your shoulder, keeping your wrist in a neutral position.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell over bench one arm reverse wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0GaUtOvsr1bUap",id:1441,target:"forearms",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in one hand, palm facing down.
Rest your forearm on the bench with your wrist hanging off the edge.
Slowly curl your wrist upwards, bringing the dumbbell towards your forearm.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell over bench one arm wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7CayffOqWQBO9D",id:367,target:"forearms",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in one hand, palm facing down.
Rest your forearm on the bench with your wrist hanging off the edge.
Slowly curl your wrist upwards, bringing the dumbbell towards your forearm.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell over bench revers wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/12h7-M8XHYuUS6",id:368,target:"forearms",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing down.
Rest your forearms on the bench, allowing your wrists to hang off the edge.
Slowly curl your wrists upward, bringing the dumbbells towards your body.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell over bench wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/n6C51BRqHWSE4F",id:369,target:"forearms",instructions:`Sit on a bench with your forearms resting on the bench and your palms facing up, holding a dumbbell in each hand.
Allow your wrists to hang over the edge of the bench.
Slowly curl your wrists upward, squeezing your forearms at the top of the movement.
Pause for a moment, then slowly lower your wrists back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell palm rotational bent over row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/G6iwpOi1PJ-0w6",id:1329,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Bend forward at the hips, keeping your back straight and your knees slightly bent.
Let your arms hang straight down, palms facing your body.
Engage your core and pull the dumbbells up towards your chest, keeping your elbows close to your body.
As you pull the dumbbells up, rotate your palms so they face away from your body.
Squeeze your shoulder blades together at the top of the movement.
Slowly lower the dumbbells back down to the starting position, rotating your palms back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell palms in incline bench press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/9OoUzkJJB9sleB",id:1623,target:"triceps",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with your back against the backrest and feet flat on the ground.
Hold a dumbbell in each hand with an overhand grip, palms facing inwards.
Extend your arms straight up above your chest, keeping a slight bend in your elbows.
Lower the dumbbells slowly towards your shoulders, keeping your elbows close to your body.
Pause for a moment at the bottom, then press the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell peacher hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/kNEXK8UsGvhuHr",id:370,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and rotate the palms of your hands until they are facing forward.
This will be your starting position.
Now, keeping the upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Then, inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell plyo squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Y0vnYrwydb8NHg",id:371,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at your sides.
Lower your body into a squat position by bending your knees and pushing your hips back.
As you reach the bottom of the squat, explode upward, jumping off the ground.
While in the air, quickly switch the position of your feet, landing with your opposite foot forward.
Immediately lower your body back into a squat position and repeat the jump, switching your feet again.
Continue alternating the position of your feet with each jump for the desired number of repetitions.`},{name:"dumbbell preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/loKMHGlzWC0im0",id:372,target:"biceps",instructions:`Sit on a preacher curl bench with your upper arms resting on the pad and your chest against it.
Hold a dumbbell in each hand with your palms facing up and your arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell preacher curl over exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/D-h8lZklfy-Ku1",id:1673,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with an underhand grip, resting your elbow on the exercise ball.
Keeping your upper arm stationary, exhale and curl the dumbbell up towards your shoulder.
Pause for a moment at the top, then inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell press on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/A5nAFGW4jLUF7h",id:1293,target:"pectorals",instructions:`Sit on an exercise ball with your feet flat on the ground and dumbbells in each hand, resting on your thighs.
Slowly walk your feet forward, rolling the exercise ball until your lower back is supported on the ball and your knees are at a 90-degree angle.
Raise the dumbbells to shoulder height, palms facing forward.
Press the dumbbells upward until your arms are fully extended.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell pronate-grip triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/XDT5X5Gg6D5s1t",id:373,target:"triceps",instructions:`Sit on a bench or chair with your back straight and feet flat on the ground.
Hold a dumbbell with both hands, palms facing down, and extend your arms straight up overhead.
Keeping your upper arms close to your head and elbows pointing forward, slowly lower the dumbbell behind your head by bending your elbows.
Pause for a moment, then extend your arms back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell prone incline curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/jqT7MAjh-bRfcF",id:374,target:"biceps",instructions:`Adjust the bench to a 45-degree incline.
Lie face down on the bench with your chest and stomach resting against it.
Hold a dumbbell in each hand with your palms facing down and your arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell prone incline hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BcwwFU5hLrHbu6",id:1674,target:"biceps",instructions:`Adjust the bench to a 45-degree incline.
Lie face down on the bench with a dumbbell in each hand, palms facing each other.
Allow your arms to hang straight down towards the floor, keeping your elbows slightly bent.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell pullover",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/6cTt4POhMKaL5Q",id:375,target:"pectorals",instructions:`Lie flat on a bench with your head at one end and your feet on the floor.
Hold a dumbbell with both hands and extend your arms straight above your chest.
Keeping a slight bend in your elbows, slowly lower the dumbbell behind your head until you feel a stretch in your chest and shoulders.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell pullover hip extension on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/fmkYasZIndF9jz",id:1294,target:"pectorals",instructions:`Sit on an exercise ball with your feet flat on the ground and the dumbbell resting on your thighs.
Slowly walk your feet forward, rolling the exercise ball down your back until your head, neck, and upper back are supported on the ball.
Hold the dumbbell with both hands and extend your arms straight up over your chest, keeping a slight bend in your elbows.
Lower the dumbbell behind your head, keeping your arms straight and maintaining control.
Pause for a moment, then raise the dumbbell back to the starting position.
While keeping your arms extended, lift your hips off the ground, squeezing your glutes and engaging your core.
Lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell pullover on exercise ball",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/l9L8Ioi5zmKKLZ",id:1295,target:"pectorals",instructions:`Sit on an exercise ball and hold a dumbbell with both hands above your chest, arms extended.
Slowly lower the dumbbell behind your head while keeping your arms straight.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell push press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/FJe-zhZQRDS-xu",id:1700,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder level.
Bend your knees slightly and dip your body down, then explosively extend your legs and press the dumbbells overhead.
Lock out your arms at the top of the movement, then lower the dumbbells back to shoulder level.
Repeat for the desired number of repetitions.`},{name:"dumbbell raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/j1bLdnblRDRIem",id:376,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing your body.
Keep your back straight and engage your core.
Raise your arms out to the sides until they are parallel to the floor, keeping a slight bend in your elbows.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear delt raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/VUXeclT4EURemy",id:2292,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing your body.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Raise your arms out to the sides, keeping a slight bend in your elbows, until they are parallel to the floor.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear delt row_shoulder",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/MTkYkWZW7WEiI-",id:377,target:"delts",instructions:`Stand with your feet shoulder-width apart and knees slightly bent.
Hold a dumbbell in each hand with your palms facing your body.
Bend forward at the waist, keeping your back straight and your core engaged.
Extend your arms straight down towards the floor, with a slight bend in your elbows.
Raise the dumbbells out to the sides, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear fly",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/mqb1TpSCJLs27-",id:378,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Extend your arms straight down towards the ground, palms facing each other.
Keeping a slight bend in your elbows, lift your arms out to the sides and squeeze your shoulder blades together.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/yINiAn5tr56S31",id:380,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing your body.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and core engaged.
Raise your arms out to the sides, keeping a slight bend in your elbows, until they are parallel to the floor.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear lateral raise (support head)",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/sxy-ZQlTRGa01t",id:379,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Raise your arms out to the sides, keeping a slight bend in your elbows, until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rear lunge",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/2xRGkLIXnxqDWU",id:381,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Take a step backward with your right foot, lowering your body into a lunge position.
Bend your left knee and lower your body until your left thigh is parallel to the ground.
Pause for a moment, then push through your left heel to return to the starting position.
Repeat on the other side, stepping back with your left foot.`},{name:"dumbbell revers grip biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/hL8m-v5pc14i5t",id:382,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing down and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse bench press",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/2eRt1MX8G02eFZ",id:1624,target:"pectorals",instructions:`Lie flat on a bench with your feet flat on the ground and your knees bent.
Hold a dumbbell in each hand with an overhand grip, palms facing towards your feet.
Extend your arms straight up towards the ceiling, keeping a slight bend in your elbows.
Slowly lower the dumbbells towards your chest, allowing your elbows to flare out to the sides.
Pause for a moment at the bottom, then push the dumbbells back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse fly",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/5qc49M0yYzawpM",id:383,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Extend your arms straight down in front of you, palms facing each other.
Keeping a slight bend in your elbows, raise your arms out to the sides until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse grip incline bench one arm row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/j8GLJ00GHS0UTE",id:1330,target:"upper back",instructions:`Set up an incline bench at a 45-degree angle.
Place a dumbbell on the floor next to the bench.
Stand facing the bench with your feet shoulder-width apart.
Bend at the waist and place your left knee and left hand on the bench for support.
Pick up the dumbbell with your right hand using a reverse grip (palm facing down).
Keep your back straight and your core engaged.
Pull the dumbbell up towards your chest, keeping your elbow close to your body.
Squeeze your back muscles at the top of the movement.
Lower the dumbbell back down to the starting position in a controlled manner.
Repeat for the desired number of repetitions.
Switch sides and repeat the exercise with your left arm.`},{name:"dumbbell reverse grip incline bench two arm row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/mcOlifNf0gPOgJ",id:1331,target:"upper back",instructions:`Set up an incline bench at a 45-degree angle.
Sit on the bench with your chest against the backrest and your feet flat on the ground.
Hold a dumbbell in each hand with an underhand grip.
Lean forward and let your arms hang straight down, fully extended.
Pull the dumbbells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse grip row",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/fAzD61HssMu-Od",id:2327,target:"upper back",instructions:`Stand with your feet shoulder-width apart and knees slightly bent.
Hold a dumbbell in each hand with an overhand grip, palms facing your body.
Bend forward at the waist, keeping your back straight and your core engaged.
Let your arms hang straight down, fully extended, with a slight bend in your elbows.
Pull the dumbbells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/rSEgrFOxrIZ7yp",id:384,target:"biceps",instructions:`Sit on a preacher bench with your upper arms resting on the pad and your chest against the support.
Hold a dumbbell in each hand with an underhand grip, palms facing up.
Keeping your upper arms stationary, exhale and curl the dumbbells as you contract your biceps.
Continue to curl the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse spider curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/G3Ihqi4uoHvZUb",id:1675,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your body and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell reverse wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/pm6o3xWQy00Tmb",id:385,target:"forearms",instructions:`Sit on a bench or chair with your feet flat on the ground.
Hold a dumbbell in each hand with an overhand grip, palms facing down.
Rest your forearms on your thighs, allowing your wrists to hang off the edge.
Slowly curl your wrists upward, bringing the dumbbells towards your body.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell romanian deadlift",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/j0T1ACfy8w5vqZ",id:1459,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Keeping your back straight and your core engaged, hinge at the hips and lower the dumbbells towards the ground, allowing your knees to bend slightly.
Lower the dumbbells until you feel a stretch in your hamstrings, then push through your heels and engage your glutes to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell rotation reverse fly",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/3LcfDLpap3x2GL",id:386,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing inwards.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and chest up.
Raise your arms out to the sides, keeping a slight bend in your elbows, until they are parallel to the floor.
Rotate your arms so that your palms are facing downwards.
Slowly lower your arms back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell scott press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/VGA0HIL8jlGxVs",id:2397,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, palms facing forward.
Raise the dumbbells to shoulder height, with your elbows bent and palms facing forward.
Press the dumbbells upward until your arms are fully extended.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated alternate front raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/1vyagzVq0-CtXf",id:387,target:"delts",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in each hand with your palms facing your body and arms extended down by your sides.
Keeping your arms straight, raise one dumbbell in front of you until it is parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat with the other arm.
Alternate between arms for the desired number of repetitions.`},{name:"dumbbell seated alternate hammer curl on exercise ball",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/eghdzEDlgt5Vu5",id:1676,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing your body and your arms fully extended.
Keeping your upper arms stationary, exhale and curl one dumbbell up towards your shoulder while keeping your palm facing your body.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat the movement with the opposite arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell seated alternate press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/AGdh60SRxofqxo",id:388,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, palms facing forward.
Raise the dumbbells to shoulder height, with your elbows bent and palms facing forward.
Press one dumbbell up overhead, fully extending your arm.
Lower the dumbbell back down to shoulder height.
Repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell seated alternate shoulder",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/SyAFbJDPvifA7C",id:3546,target:"delts",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in each hand, palms facing inwards, and raise them to shoulder height.
Press one dumbbell up overhead while keeping the other dumbbell at shoulder height.
Lower the raised dumbbell back to shoulder height while simultaneously pressing the other dumbbell up overhead.
Continue alternating between arms for the desired number of repetitions.`},{name:"dumbbell seated bench extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/dqTV5Erpwz-CL6",id:389,target:"triceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell with both hands and extend your arms straight up above your head.
Slowly lower the dumbbell behind your head, keeping your elbows close to your ears.
Pause for a moment, then raise the dumbbell back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated bent arm lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/0DebSscVi63DmN",id:2317,target:"delts",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in each hand with your palms facing your body and your arms bent at a 90-degree angle.
Keeping your elbows bent, raise your arms out to the sides until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your arms back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated bent over alternate kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/nmi7LvHK1tTGYA",id:1730,target:"triceps",instructions:`Sit on a bench with a dumbbell in each hand, palms facing inwards.
Bend forward at the waist, keeping your back straight and parallel to the ground.
Extend one arm straight back, keeping it close to your body, until your arm is fully extended.
Pause for a moment, then slowly lower the dumbbell back to the starting position.
Repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell seated bent over triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/YK0RKuxcmjuwpP",id:1737,target:"triceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand.
Bend forward at the waist, keeping your back straight and your head up.
Extend your arms straight back, keeping your elbows close to your head.
Pause for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated bicep curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/oPp2Gd722VLBT9",id:1677,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing up.
Keep your back straight and your elbows close to your torso.
Exhale and curl the dumbbells up towards your shoulders, contracting your biceps.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated biceps curl (on stability ball)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/JFRbcZWItkrTa5",id:390,target:"biceps",instructions:`Sit on a stability ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing forward and your arms fully extended.
Keeping your upper arms stationary, exhale and curl the dumbbells while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated biceps curl to shoulder press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/iKBiLhEfasnwcl",id:3547,target:"biceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in each hand with your palms facing forward and arms fully extended.
Keeping your elbows close to your sides, curl the dumbbells up towards your shoulders.
Once your forearms are vertical, rotate your wrists so that your palms are facing forward.
Press the dumbbells overhead until your arms are fully extended.
Lower the dumbbells back down to the starting position by reversing the movement.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated calf raise",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/O5S2YeqtfYjMtL",id:1379,target:"calves",instructions:`Sit on a bench or chair with your feet flat on the ground and a dumbbell resting on your thighs.
Place the balls of your feet on a raised surface such as a step or block, with your heels hanging off the edge.
Hold onto the dumbbell for stability.
Raise your heels as high as possible, lifting your body weight onto the balls of your feet.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/cLIgS-8zZP4VD0",id:391,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and a dumbbell in each hand, palms facing forward.
Keep your back straight and your elbows close to your torso.
Exhale and curl the dumbbells up towards your shoulders, contracting your biceps.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated front raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/AbuU3sD9eusAhX",id:392,target:"delts",instructions:`Sit on a bench with your feet flat on the ground and a dumbbell in each hand, resting on your thighs.
Keep your back straight and core engaged.
Raise the dumbbells in front of you, with your palms facing down, until they are at shoulder level.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated hammer curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Xa2Ib9i-LKq7AQ",id:1678,target:"biceps",instructions:`Sit on a bench with a dumbbell in each hand, palms facing your torso and arms extended straight down.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated inner biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/iY4Ann4xEi2y3j",id:393,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing up.
Rest your upper arms on your thighs, allowing the dumbbells to hang down.
Keeping your upper arms stationary, curl the dumbbells up towards your shoulders by contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/W9N6oa1pvHVCk5",id:394,target:"triceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand.
Bend your knees slightly and lean forward from your hips, keeping your back straight.
Bring your upper arms close to your sides and keep your elbows bent at a 90-degree angle.
Extend your arms straight back, squeezing your triceps at the top of the movement.
Pause for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated lateral raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/MhUjmOf0vwAGcw",id:396,target:"delts",instructions:`Sit on a bench with your feet flat on the ground and a dumbbell in each hand, resting on your thighs.
Keep your back straight and core engaged.
Raise the dumbbells to your sides with a slight bend in your elbows, until your arms are parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated lateral raise v. 2",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/IxIsSFUSBDQmF8",id:395,target:"delts",instructions:`Sit on a bench with your feet flat on the ground and a dumbbell in each hand, resting on your thighs.
Keep your back straight and core engaged.
Raise the dumbbells to your sides with a slight bend in your elbows, until your arms are parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated neutral wrist curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/gDYVMXw8NU29K4",id:397,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing each other.
Rest your forearms on your thighs, allowing the dumbbells to hang down.
Keeping your wrists in a neutral position, curl the dumbbells up towards your shoulders.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated one arm bicep curl on exercise ball with leg raised",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/tDLdNSls00Etpn",id:1679,target:"biceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand with your palm facing up and your arm fully extended.
Place your other hand on your hip for stability.
Slowly curl the dumbbell towards your shoulder, keeping your upper arm stationary.
Pause for a moment at the top of the movement, squeezing your bicep.
Slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions.
Switch arms and repeat the exercise.`},{name:"dumbbell seated one arm kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/byBjYN5BoM5XOW",id:398,target:"triceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in one hand.
Bend your torso forward at the waist, keeping your back straight and parallel to the ground.
Extend your arm straight back, keeping your elbow close to your body.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell seated one arm rotate",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/13sO7U8Mqb32L2",id:399,target:"forearms",instructions:`Sit on a bench with your back straight and hold a dumbbell in one hand, resting it on your thigh.
Raise the dumbbell up to shoulder height, keeping your elbow close to your body.
Rotate your forearm outward, away from your body, while keeping your upper arm stationary.
Pause for a moment at the top, then slowly rotate your forearm back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell seated one leg calf raise",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/enwhjfA9hNTAd3",id:400,target:"calves",instructions:`Sit on a bench or chair with your feet flat on the ground and a dumbbell resting on your right thigh.
Extend your left leg straight out in front of you, keeping your foot flexed.
Place the ball of your right foot on an elevated surface, such as a step or weight plate.
Using your calf muscles, raise your right heel as high as possible.
Pause for a moment at the top, then slowly lower your heel back down to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"dumbbell seated one leg calf raise - hammer grip",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/xAGjcATyYkiJdQ",id:1380,target:"calves",instructions:`Sit on a bench or chair with your feet flat on the ground and a dumbbell resting on your thighs.
Place one foot on a raised surface, such as a step or block, with your heel hanging off the edge.
Hold the dumbbell with a hammer grip, meaning your palms are facing each other and your fingers are wrapped around the handle.
Keeping your core engaged and your back straight, slowly raise your heel as high as possible by pushing through the ball of your foot.
Pause for a moment at the top, then slowly lower your heel back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other leg.`},{name:"dumbbell seated one leg calf raise - palm up",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/uURdIGy3g0JKrg",id:1381,target:"calves",instructions:`Sit on a bench or chair with your back straight and your feet flat on the ground.
Hold a dumbbell in one hand and place it on top of your thigh, palm facing up.
Lift one leg off the ground and extend it in front of you, keeping your knee slightly bent.
Raise your heel as high as possible by pushing through the ball of your foot.
Pause for a moment at the top, then slowly lower your heel back down.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell seated palms up wrist curl",bodyPart:"lower arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7Kvih02ddxTAFk",id:401,target:"forearms",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in each hand, palms facing up.
Rest your forearms on your thighs, allowing your wrists to hang off the edge.
Slowly curl your wrists upward, squeezing your forearms at the top of the movement.
Pause for a moment, then lower your wrists back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ajTEodYd3zdhni",id:402,target:"biceps",instructions:`Sit on a preacher curl bench with your feet flat on the floor.
Hold a dumbbell in one hand with an underhand grip, resting your upper arm against the preacher pad.
Keeping your upper arm stationary, exhale and curl the dumbbell up towards your shoulder.
Pause for a moment at the top, then inhale and slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell seated revers grip concentration curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Pe9YG0ClvXLXuA",id:403,target:"biceps",instructions:`Sit on a bench with your feet flat on the ground and hold a dumbbell in one hand, palm facing up.
Rest your elbow on the inside of your thigh, just above the knee.
Keeping your upper arm stationary, exhale and curl the dumbbell towards your shoulder.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell seated reverse grip one arm overhead tricep extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/pohNaEmjpPozrt",id:1738,target:"triceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell with an underhand grip and extend your arm straight up overhead.
Lower the dumbbell behind your head by bending your elbow, keeping your upper arm stationary.
Pause for a moment, then extend your arm back up to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell seated shoulder press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/se9czAqs2jPH-U",id:405,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, resting on your thighs.
Raise the dumbbells to shoulder height, palms facing forward.
Press the dumbbells upward until your arms are fully extended overhead.
Pause for a moment at the top, then slowly lower the dumbbells back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated shoulder press (parallel grip)",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/qBMjW-NEiFpz8H",id:404,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, palms facing inward.
Raise the dumbbells to shoulder height, elbows bent and palms facing forward.
Press the dumbbells upward until your arms are fully extended overhead.
Pause for a moment at the top, then slowly lower the dumbbells back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"dumbbell seated triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/4jo4EUX8Su7D2W",id:2188,target:"triceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell with both hands and extend your arms straight up overhead.
Bend your elbows and lower the dumbbell behind your head, keeping your upper arms close to your ears.
Pause for a moment, then straighten your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell shrug",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/OJJ6Lr3AzGQSeU",id:406,target:"traps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand with your palms facing your body.
Keep your arms straight and let the dumbbells hang by your sides.
Raise your shoulders as high as possible, as if you are trying to touch your ears with your shoulders.
Hold the contraction for a second, then slowly lower your shoulders back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell side bend",bodyPart:"waist",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/453gUEd2wRXstV",id:407,target:"abs",instructions:`Stand up straight with your feet shoulder-width apart and hold a dumbbell in one hand, letting it hang down by your side.
Keeping your back straight and your core engaged, slowly bend sideways at the waist towards the opposite side of the dumbbell, lowering the weight as far as you comfortably can.
Pause for a moment, then slowly return to the starting position.
Repeat for the desired number of repetitions, then switch sides and repeat.`},{name:"dumbbell side lying one hand raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ECBecOo88aSMOg",id:408,target:"delts",instructions:`Lie on your side with your legs extended and your head supported by your arm.
Hold a dumbbell in your top hand with your palm facing down.
Keeping your arm straight, raise the dumbbell up to shoulder height.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell side plank with rear fly",bodyPart:"back",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/An8cQVftJStqIq",id:3664,target:"upper back",instructions:`Start by lying on your side with your legs extended and stacked on top of each other.
Place your forearm on the ground directly below your shoulder, keeping your elbow bent at a 90-degree angle.
Hold a dumbbell in your top hand, with your arm extended straight down towards the ground.
Engage your core and lift your hips off the ground, creating a straight line from your head to your heels.
While maintaining the side plank position, lift the dumbbell up towards the ceiling, squeezing your shoulder blades together.
Lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell single arm overhead carry",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/23OPoRmxVzVIo9",id:3548,target:"delts",instructions:`Stand tall with your feet shoulder-width apart, holding a dumbbell in one hand.
Raise the dumbbell overhead, fully extending your arm.
Engage your core and keep your back straight as you walk forward, maintaining the dumbbell overhead.
Continue walking for the desired distance or time.
Switch hands and repeat the exercise.`},{name:"dumbbell single leg calf raise",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/bit7lh1IvrwgTY",id:409,target:"calves",instructions:`Stand on the edge of a step or platform with your heels hanging off and your toes on the step.
Hold a dumbbell in one hand and place your other hand on a wall or railing for support.
Raise your heel as high as possible, lifting your body up onto your toes.
Pause for a moment at the top, then slowly lower your heel back down below the step.
Repeat for the desired number of repetitions, then switch to the other leg.`},{name:"dumbbell single leg deadlift",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/veqGOpz41I4Zye",id:1757,target:"glutes",instructions:`Stand with your feet hip-width apart, holding a dumbbell in your right hand.
Shift your weight onto your left leg and lift your right foot slightly off the ground.
Keeping your back straight, hinge forward at the hips and lower the dumbbell towards the ground.
At the same time, extend your right leg straight behind you, maintaining a slight bend in your left knee.
Lower the dumbbell until your torso and right leg are parallel to the ground.
Pause for a moment, then engage your glutes and hamstrings to return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell single leg deadlift with stepbox support",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/l-zt22YyNoq8uE",id:2805,target:"glutes",instructions:`Stand with your feet hip-width apart, holding a dumbbell in your right hand.
Place your left foot on a stepbox or elevated surface behind you.
Keeping your back straight and core engaged, hinge forward at the hips, lowering the dumbbell towards the ground.
As you lower the dumbbell, simultaneously lift your left leg behind you, maintaining a straight line from head to heel.
Lower the dumbbell until you feel a stretch in your right hamstring, then return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell single leg split squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/-ExaJZde-5RuPK",id:410,target:"quads",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Take a step forward with one foot and position your feet so that your front foot is flat on the ground and your back foot is elevated on a bench or step.
Lower your body by bending your front knee and hip, keeping your back knee slightly bent and your back heel off the ground.
Continue lowering until your front thigh is parallel to the ground, then push through your front heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"dumbbell single leg squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/GqUYIpeTGp1jGU",id:411,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Extend one leg forward and keep it off the ground throughout the exercise.
Bend your standing leg and lower your body down as if sitting back into a chair.
Keep your chest up and your back straight.
Pause for a moment at the bottom, then push through your heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"dumbbell squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/3i-VEawWfitaHS",id:413,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at your sides.
Keeping your chest up and core engaged, lower your body down by bending at the knees and hips, as if sitting back into a chair.
Continue lowering until your thighs are parallel to the ground, or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing alternate hammer curl and press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/VaMpwaUBL55tzU",id:3560,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your body.
Keep your elbows close to your torso and your back straight.
Exhale and curl the dumbbell in your right hand towards your shoulder, keeping your upper arm stationary.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat the curl with your left hand.
After completing the curl with your left hand, exhale and press the dumbbell in your right hand overhead.
Extend your arm fully and hold for a moment at the top.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat the press with your left hand.
Continue alternating between curls and presses for the desired number of repetitions.`},{name:"dumbbell standing alternate overhead press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/9XlRGnnyfsJIsl",id:414,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder level with your palms facing forward.
Press one dumbbell overhead, fully extending your arm.
Lower the dumbbell back to shoulder level.
Repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"dumbbell standing alternate raise",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/eKxqIDqMcJ6c63",id:415,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with your palms facing your body.
Keep your back straight and your core engaged.
Raise one dumbbell to the side, keeping your arm straight and your palm facing down.
Continue lifting until your arm is parallel to the ground.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat with the other arm.
Alternate between arms for the desired number of repetitions.`},{name:"dumbbell standing alternating tricep kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/qmK22dZBhiciwF",id:1739,target:"triceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Extend your arms straight back, keeping your elbows close to your body.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat with the other arm, alternating sides with each repetition.`},{name:"dumbbell standing around world",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/dHr5PmnLxRPbgQ",id:2143,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Extend your arms straight out to the sides at shoulder height, palms facing down.
Keeping your arms straight, slowly rotate your arms in a circular motion, bringing the dumbbells in front of your body and then overhead.
Continue the circular motion, bringing the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing bent over one arm triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/j7ha5i8he9mxAI",id:1740,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand.
Bend forward at the waist, keeping your back straight and parallel to the ground.
Extend your arm straight back, keeping your elbow close to your body.
Slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell standing bent over two arm triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/hFecA-v7zNfY9P",id:1741,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend forward at the waist, keeping your back straight and your knees slightly bent.
Extend your arms straight back, keeping your elbows close to your body.
Slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/IYn6IPMjmWzK8B",id:416,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward and arms fully extended.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing calf raise",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/cT5XEtmPbsbs7l",id:417,target:"calves",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand.
Raise your heels off the ground as high as possible, using your calves.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing concentration curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Dz7mBiJbZjSN6d",id:418,target:"biceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand, with your arm fully extended and palm facing inwards.
Place your opposite hand on your thigh for support.
Keeping your upper arm stationary, exhale and curl the dumbbell towards your shoulder by contracting your biceps.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell standing front raise above head",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/QA3FOn7eKc7PR4",id:419,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Keep your arms straight and lift the dumbbells in front of you, raising them above your head.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing inner biceps curl v. 2",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ud1xlWohOoMy0L",id:2321,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your torso.
Keep your elbows close to your torso and rotate the palms of your hands until they are facing forward.
While holding your upper arms stationary, curl the weights while contracting your biceps.
Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Slowly begin to bring the dumbbells back to the starting position as your breathe in.
Repeat for the recommended amount of repetitions.`},{name:"dumbbell standing kickback",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/mq3pb2XKWF5Ieg",id:420,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Extend your arms straight back, squeezing your triceps at the top of the movement.
Pause for a moment, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing one arm concentration curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/lR2xbnL0S65IWi",id:421,target:"biceps",instructions:`Stand up straight with your feet shoulder-width apart and hold a dumbbell in one hand, palm facing up.
Place your free hand on your thigh for support.
Keeping your upper arm stationary, exhale and curl the dumbbell towards your shoulder by contracting your biceps.
Continue to raise the dumbbell until your biceps are fully contracted and the dumbbell is at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell standing one arm curl (over incline bench)",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Ewtm1hhiOjewCT",id:422,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand with your palm facing forward.
Place your other hand on an incline bench for support.
Keeping your upper arm stationary, exhale and curl the dumbbell towards your shoulder by contracting your biceps.
Pause for a moment at the top, then inhale and slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell standing one arm curl over incline bench",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/hRln7xVknai5Da",id:1680,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand.
Place your other hand on an incline bench for support.
Keeping your upper arm stationary, curl the dumbbell towards your shoulder by contracting your biceps.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"dumbbell standing one arm extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Jjd6E02FFUfu8M",id:423,target:"triceps",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand.
Raise the dumbbell overhead, fully extending your arm.
Keep your upper arm close to your head and perpendicular to the ground.
Slowly lower the dumbbell behind your head, bending your elbow.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing one arm palm in press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/OTNzfAHapNUZ-g",id:424,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in one hand at shoulder height with your palm facing inwards.
Engage your core and keep your back straight.
Press the dumbbell upwards until your arm is fully extended.
Pause for a moment at the top, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell standing one arm reverse curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/iU32XHEFzQgNEB",id:425,target:"biceps",instructions:`Stand up straight with your feet shoulder-width apart and hold a dumbbell in one hand with an overhand grip.
Keep your arm fully extended and close to your body, with your palm facing down.
Slowly curl the dumbbell up towards your shoulder, keeping your upper arm stationary.
Pause for a moment at the top, then slowly lower the dumbbell back down to the starting position.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"dumbbell standing overhead press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/A8mJ2-j632ytkU",id:426,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder level with your palms facing forward.
Press the dumbbells upward until your arms are fully extended overhead.
Pause for a moment at the top, then slowly lower the dumbbells back down to shoulder level.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing palms in press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Gbr8ED-rCZ8QEa",id:427,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at shoulder level with your palms facing inwards.
Keeping your core engaged and your back straight, press the dumbbells upwards until your arms are fully extended overhead.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/koYgWfFjnjZWoz",id:428,target:"biceps",instructions:`Stand upright with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing forward.
Rest the back of your upper arms against the preacher bench or an incline bench, with your elbows slightly bent.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps.
Continue to raise the dumbbells until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing reverse curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Vn5iWKcLtChEXe",id:429,target:"biceps",instructions:`Stand up straight with your feet shoulder-width apart and hold a dumbbell in each hand, palms facing your body.
Keeping your upper arms stationary, exhale and curl the weights while contracting your biceps. Continue to raise the weights until your biceps are fully contracted and the dumbbells are at shoulder level.
Hold the contracted position for a brief pause as you squeeze your biceps.
Inhale and slowly begin to lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/jUMbWBUUI3GZrB",id:430,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand.
Raise the dumbbell overhead, keeping your arm straight.
Bend your elbow and lower the dumbbell behind your head, keeping your upper arm stationary.
Extend your arm back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell standing zottman preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/M4qEmvYuDgMpuK",id:2293,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward.
Place your upper arms against the preacher bench and keep your elbows slightly bent.
Curl the dumbbells up towards your shoulders while keeping your upper arms stationary.
At the top of the movement, rotate your wrists so that your palms are facing downward.
Slowly lower the dumbbells back to the starting position, rotating your wrists back to the starting position as well.
Repeat for the desired number of repetitions.`},{name:"dumbbell step up single leg balance with bicep curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/qHLrrSASRbhQHY",id:1684,target:"biceps",instructions:`Stand in front of a step or platform with a dumbbell in each hand, palms facing your body.
Place your right foot on the step, ensuring your entire foot is in contact with the surface.
Engage your core and push through your right heel to lift your body up onto the step, bringing your left knee up towards your chest.
At the top of the movement, perform a bicep curl by bending your elbows and bringing the dumbbells towards your shoulders.
Lower the dumbbells back down and simultaneously lower your left foot back to the ground.
Repeat the movement on the opposite side, stepping up with your left foot and curling the dumbbells.
Continue alternating sides for the desired number of repetitions.`},{name:"dumbbell step-up",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ur5gGc0h2ff-E7",id:431,target:"glutes",instructions:`Stand in front of a bench or step with a dumbbell in each hand, palms facing your body.
Place your right foot on the bench or step, ensuring your entire foot is in contact with the surface.
Push through your right heel and lift your body up onto the bench or step, straightening your right leg.
Bring your left foot up onto the bench or step, standing fully upright.
Step back down with your left foot, followed by your right foot, returning to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"dumbbell step-up lunge",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/V010-yfD3dbJRo",id:2796,target:"quads",instructions:`Stand in front of a step or platform with a dumbbell in each hand, palms facing your sides.
Place your right foot on the step, ensuring your entire foot is on the surface.
Push through your right heel and lift your body up onto the step, bringing your left foot up as well.
Once both feet are on the step, lower your left foot back down to the starting position, keeping your right foot on the step.
Repeat the movement, alternating which foot you step up with each time.
Continue for the desired number of repetitions.`},{name:"dumbbell step-up split squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/ZI8aEEHc7Mcswe",id:2812,target:"quads",instructions:`Stand in front of a bench or step with a dumbbell in each hand, palms facing your body.
Place your right foot on the bench or step, ensuring your entire foot is in contact with the surface.
Step up onto the bench or step with your right foot, pushing through your heel to lift your body up.
As you step up, simultaneously lift your left knee towards your chest.
Pause at the top of the movement, then slowly lower your left foot back to the ground while keeping your right foot on the bench or step.
Repeat the movement with your left foot on the bench or step.
Continue alternating between your right and left foot for the desired number of repetitions.`},{name:"dumbbell stiff leg deadlift",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/7R05p-WYJxEwYR",id:432,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Keeping your back straight and your core engaged, hinge at the hips and lower the dumbbells towards the ground, allowing a slight bend in your knees.
Lower the dumbbells until you feel a stretch in your hamstrings, then squeeze your glutes and push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell straight arm pullover",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Du5e2m0rNrtWSu",id:433,target:"pectorals",instructions:`Lie flat on a bench with your head at one end and your feet planted firmly on the ground.
Hold a dumbbell with both hands and extend your arms straight above your chest.
Keeping your arms straight, slowly lower the dumbbell behind your head in an arc-like motion.
Pause for a moment, then raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell straight leg deadlift",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/vmJJjC7X7sW5WT",id:434,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Keeping your back straight and your core engaged, hinge at the hips and lower the dumbbells towards the ground, allowing your torso to lean forward.
Continue lowering the dumbbells until you feel a stretch in your hamstrings, keeping your knees slightly bent.
Pause for a moment at the bottom, then engage your glutes and hamstrings to lift your torso back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell sumo pull through",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Be7jiXKGpa0O5M",id:2808,target:"glutes",instructions:`Stand with your feet wider than shoulder-width apart, toes pointed outwards.
Hold a dumbbell with both hands in front of your body, arms extended.
Bend your knees and lower your hips down into a squat position, keeping your back straight.
Lower the dumbbell down between your legs, keeping your arms straight.
Drive through your heels and extend your hips forward, pulling the dumbbell up and in front of your body.
Squeeze your glutes at the top of the movement, then lower the dumbbell back down between your legs.
Repeat for the desired number of repetitions.`},{name:"dumbbell supported squat",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/mLsYPW7qBPfI4R",id:2803,target:"quads",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand at your sides.
Keeping your chest up and core engaged, slowly lower your body down by bending your knees and pushing your hips back.
Continue lowering until your thighs are parallel to the ground, or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell tate press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/CHJeK8EdkuQqih",id:436,target:"triceps",instructions:`Sit on a flat bench with a dumbbell in each hand, palms facing each other.
Raise the dumbbells to shoulder height, then rotate your wrists so that your palms are facing away from you.
Press the dumbbells up until your arms are fully extended, then lower them back down to shoulder height.
Rotate your wrists back to the starting position and repeat for the desired number of repetitions.`},{name:"dumbbell tricep kickback with stork stance",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/DJ3nWNna84emY5",id:1742,target:"triceps",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in your right hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Bring your right elbow up to your side, keeping it bent at a 90-degree angle.
Extend your right arm straight back, squeezing your triceps.
Pause for a moment, then slowly lower the dumbbell back to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"dumbbell twisting bench press",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/SsouXrDjTMNNNh",id:1743,target:"triceps",instructions:`Lie flat on a bench with your feet flat on the ground and your back pressed against the bench.
Hold a dumbbell in each hand with an overhand grip, palms facing away from you.
Extend your arms straight up over your chest, keeping a slight bend in your elbows.
Lower the dumbbells down towards your chest, keeping your elbows close to your body.
As you lower the dumbbells, twist your wrists so that your palms face towards you at the bottom of the movement.
Pause for a moment at the bottom, then reverse the movement by pressing the dumbbells back up to the starting position.
As you press the dumbbells up, twist your wrists back to the starting position with palms facing away from you.
Repeat for the desired number of repetitions.`},{name:"dumbbell upright row",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/slfX3jBO31lk-p",id:437,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Let the dumbbells hang in front of your thighs, with your arms fully extended.
Keeping your back straight and your core engaged, exhale and lift the dumbbells straight up towards your chin, leading with your elbows.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell upright row (back pov)",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/xsCk7bj7NsYLv5",id:1765,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a dumbbell in each hand with an overhand grip.
Let the dumbbells hang in front of your thighs, with your arms fully extended and your palms facing your body.
Keeping your back straight and your core engaged, exhale and lift the dumbbells straight up towards your chin, leading with your elbows.
Continue lifting until the dumbbells are at shoulder height, with your elbows pointing out to the sides.
Pause for a moment at the top, then inhale and slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell upright shoulder external rotation",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/WlTrwV626kEGCg",id:864,target:"delts",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in each hand with your palms facing your body.
Raise your arms out to the sides until they are parallel to the ground, keeping your elbows slightly bent.
Rotate your arms externally, bringing the dumbbells up towards your head while keeping your elbows in the same position.
Pause for a moment at the top, then slowly lower the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell waiter biceps curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/jwoPeOoNuTjsb2",id:5201,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing forward.
Keep your upper arms close to your body and your elbows tucked in.
Slowly curl the dumbbells up towards your shoulders, keeping your wrists straight.
Pause for a moment at the top, then slowly lower the dumbbells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"dumbbell w-press",bodyPart:"shoulders",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/cZmAN7nc3mVp1t",id:438,target:"delts",instructions:`Sit on a bench with a dumbbell in each hand, palms facing forward.
Raise the dumbbells to shoulder height, elbows bent and palms facing forward.
Press the dumbbells upward until your arms are fully extended overhead.
Lower the dumbbells back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"dumbbell zottman curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/BBRZsNvhY5r26F",id:439,target:"biceps",instructions:`Stand up straight with a dumbbell in each hand, palms facing your body.
Keep your elbows close to your torso and rotate your palms to face forward.
Curl the dumbbells up to your shoulders while keeping your upper arms stationary.
At the top of the movement, rotate your wrists so that your palms are facing away from your body.
Slowly lower the dumbbells back to the starting position, rotating your palms back to facing your body.
Repeat for the desired number of repetitions.`},{name:"dumbbell zottman preacher curl",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/zXss91PtzfuM7l",id:2294,target:"biceps",instructions:`Sit on a preacher bench with a dumbbell in each hand, palms facing up and elbows resting on the pad.
Curl the dumbbells up towards your shoulders, keeping your upper arms stationary and your palms facing up.
At the top of the curl, rotate your wrists so that your palms are facing down.
Slowly lower the dumbbells back down to the starting position, rotating your wrists back to the starting position as you do so.
Repeat for the desired number of repetitions.`},{name:"dumbbells seated triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/Gt8EZznIII1Ki-",id:2189,target:"triceps",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a dumbbell in both hands with an overhand grip, and raise it above your head.
Bend your elbows and lower the dumbbell behind your head, keeping your upper arms close to your ears.
Extend your arms and raise the dumbbell back to the starting position.
Repeat for the desired number of repetitions.`},{name:"dynamic chest stretch",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/oKN4BuvYZ5b24k",id:1167,target:"pectorals",instructions:`Stand tall with your feet shoulder-width apart.
Extend your arms straight out to the sides, parallel to the ground.
Slowly bring your arms forward, crossing them in front of your body.
Feel the stretch in your chest muscles.
Hold the stretch for 10-30 seconds.
Return to the starting position and repeat for the desired number of repetitions.`},{name:"elbow dips",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/krVPteLHalf9su",id:3287,target:"triceps",instructions:`Sit on the edge of a bench or chair with your hands gripping the edge next to your hips.
Slide your hips forward off the bench and straighten your legs, keeping your heels on the ground.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench.
Pause for a moment at the bottom, then push through your hands to straighten your arms and lift your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"elbow lift - reverse push-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/DLYOCEGH4fRf4a",id:1772,target:"upper back",instructions:`Start by lying face down on the ground with your legs extended and your hands placed directly under your shoulders.
Engage your core and press through your palms to lift your upper body off the ground, keeping your elbows close to your sides.
Pause at the top for a moment, squeezing your upper back muscles.
Slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"elbow-to-knee",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Xr0r8ULGSsvJrX",id:443,target:"abs",instructions:`Start by lying flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engage your abs and lift your upper body off the ground, bringing your right elbow towards your left knee.
At the same time, bring your left knee towards your right elbow, creating a twisting motion.
Pause for a moment at the top, then slowly lower your upper body and extend your legs back to the starting position.
Repeat the movement, this time bringing your left elbow towards your right knee and your right knee towards your left elbow.
Continue alternating sides for the desired number of repetitions.`},{name:"elevator",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/9iMKU0KE9gCom6",id:3292,target:"upper back",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Place your hands on your hips or cross them in front of your chest.
Keeping your back straight, slowly bend forward at the waist, lowering your upper body towards the ground.
Pause for a moment at the bottom, then slowly raise your upper body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball alternating arm ups",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/IvDV0Uus9oevVh",id:1332,target:"lats",instructions:`Sit on the stability ball with your feet flat on the ground and your back straight.
Hold a dumbbell in each hand with your palms facing inwards and your arms extended down by your sides.
Engage your core and slowly lift one arm up towards your shoulder, keeping your elbow slightly bent.
Pause for a moment at the top, then slowly lower your arm back down to the starting position.
Repeat the movement with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"exercise ball back extension with arms extended",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/3RufjVnzYfDmFl",id:1333,target:"spine",instructions:`Place the stability ball on the ground and lie face down on top of it, with your hips resting on the ball and your feet against a wall for stability.
Extend your arms straight out in front of you, with your palms facing down.
Engage your core and slowly lift your upper body off the ball, keeping your back straight and your neck in line with your spine.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball back extension with hands behind head",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/OYBJywWNztp0N0",id:1334,target:"spine",instructions:`Place the stability ball on the ground and lie face down on top of it with your hips resting on the ball.
Position your feet against a wall or other stable surface for support.
Cross your arms behind your head, with your hands touching the back of your head.
Engage your core and slowly lift your upper body off the ball, extending your back until your body forms a straight line from your head to your hips.
Pause for a moment at the top of the movement, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball back extension with knees off ground",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/ougwr3A2SQog9Q",id:1335,target:"spine",instructions:`Place the stability ball on the ground and lie face down on top of it, with your hips resting on the ball and your feet against a wall for stability.
Position your hands behind your head or crossed over your chest.
Engage your core and slowly lift your upper body off the ball, extending your back until your body forms a straight line from your head to your heels.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball back extension with rotation",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/sXpypJIkOj0h7p",id:1336,target:"spine",instructions:`Start by lying face down on the stability ball with your hips resting on the ball and your feet firmly planted on the ground.
Place your hands behind your head or cross them over your chest.
Engage your core and slowly lift your upper body off the ball, extending your back until your body forms a straight line from your head to your heels.
Pause for a moment at the top, then slowly rotate your torso to one side, keeping your hips and legs stable.
Return to the center and repeat the rotation to the other side.
Lower your upper body back down to the starting position and repeat for the desired number of repetitions.`},{name:"exercise ball dip",bodyPart:"upper arms",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/gsGjOKr455V2dZ",id:1744,target:"triceps",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Place your hands on the ball beside your hips, fingers pointing forward.
Engage your triceps and push through your hands to lift your body off the ball, straightening your arms.
Lower your body back down by bending your elbows, keeping them close to your sides.
Repeat for the desired number of repetitions.`},{name:"exercise ball hip flexor stretch",bodyPart:"upper legs",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/vg-C41Tm2QkavC",id:1559,target:"glutes",instructions:`Place the stability ball on the ground and kneel in front of it.
Place your right foot on top of the stability ball, with your knee bent at a 90-degree angle.
Extend your left leg behind you, keeping it straight.
Lean forward, pushing your hips towards the stability ball, until you feel a stretch in your right hip flexor.
Hold the stretch for 20-30 seconds, then switch sides and repeat.`},{name:"exercise ball hug",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/myl9yr5ZbLH3Qk",id:1338,target:"spine",instructions:`Sit on the stability ball with your feet flat on the ground and your back straight.
Hold the stability ball with both hands, hugging it close to your chest.
Engage your core muscles and slowly lean back, keeping your back straight and your feet planted on the ground.
Continue leaning back until you feel a stretch in your back muscles.
Hold the position for a few seconds, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball lat stretch",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/O-LHzhI3tMNtzV",id:1339,target:"lats",instructions:`Sit on a stability ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand and extend your arm straight up overhead.
Slowly lean to the opposite side, feeling a stretch in your lat muscle.
Hold the stretch for 20-30 seconds, then return to the starting position.
Repeat on the other side.`},{name:"exercise ball lower back stretch (pyramid)",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/uePeamR25WlpQk",id:1341,target:"lats",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Slowly walk your feet forward, rolling the ball down your back until your lower back is resting on the ball.
Place your hands behind your head or cross them over your chest.
Engage your core and slowly lower your upper body towards the ground, allowing your lower back to stretch over the ball.
Hold the stretch for a few seconds, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball lying side lat stretch",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/HgI6oJpK7g1Sav",id:1342,target:"lats",instructions:`Lie on your side with your legs extended and your head supported by the stability ball.
Place your top arm on the ball for stability.
Reach your top arm overhead and allow your torso to rotate slightly.
Feel the stretch in your lat muscles on the side of your body.
Hold the stretch for 20-30 seconds, then switch sides and repeat.`},{name:"exercise ball on the wall calf raise",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/D1xC-P7cV6fEdV",id:1382,target:"calves",instructions:`Stand with your back against a wall and place an exercise ball between your lower back and the wall.
Position your feet shoulder-width apart, with your toes pointing forward.
Hold a dumbbell in each hand, with your arms extended by your sides.
Raise your heels off the ground, lifting your body weight onto the balls of your feet.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball on the wall calf raise (tennis ball between ankles)",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/JdWZOx-HKqACg9",id:3241,target:"calves",instructions:`Stand facing a wall with your feet shoulder-width apart.
Place an exercise ball between the wall and your lower back.
Hold a dumbbell in each hand, with your arms extended by your sides.
Place a tennis ball between your ankles.
Raise your heels off the ground, lifting your body up onto your toes.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball on the wall calf raise (tennis ball between knees)",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/uIzOrhsD-JR1dp",id:3240,target:"calves",instructions:`Stand with your back against a wall and place an exercise ball between your lower back and the wall.
Position your feet shoulder-width apart and slightly in front of you.
Hold a dumbbell in each hand, with your arms extended by your sides.
Place a tennis ball between your knees.
Raise your heels off the ground, lifting your body up onto your toes.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball one leg prone lower body rotation",bodyPart:"upper legs",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/uDQybtU0FfFbLq",id:1416,target:"glutes",instructions:`Lie face down on the stability ball with your hips resting on the ball and your legs extended straight behind you.
Place your hands on the ground in front of you for support.
Engage your glutes and core muscles to stabilize your body.
Slowly lift one leg off the ground, keeping it straight and parallel to the floor.
Rotate your leg outward, away from your body, while keeping your hips and upper body stable.
Pause for a moment at the end of the rotation, then slowly return your leg to the starting position.
Repeat the rotation with the other leg.
Continue alternating legs for the desired number of repetitions.`},{name:"exercise ball one legged diagonal kick hamstring curl",bodyPart:"upper legs",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/tobWt35g9G3hVw",id:1417,target:"glutes",instructions:`Start by lying on your back with your legs extended and your heels resting on top of the stability ball.
Place your arms by your sides for stability.
Engage your glutes and core muscles to lift your hips off the ground, creating a straight line from your shoulders to your heels.
Bend your right knee and bring it towards your chest, keeping your left leg extended and your foot flexed.
Kick your right leg diagonally across your body, extending it fully and engaging your hamstrings.
Slowly return your right leg to the starting position, maintaining control and stability.
Repeat the movement with your left leg, alternating sides for the desired number of repetitions.`},{name:"exercise ball pike push up",bodyPart:"chest",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/QDAClfl1I9REhy",id:1296,target:"pectorals",instructions:`Start in a push-up position with your hands on the floor and your shins resting on the stability ball.
Engage your core and lift your hips up towards the ceiling, rolling the ball towards your hands.
Keep your legs straight and your body in a pike position, forming an inverted V shape.
Bend your elbows and lower your upper body towards the floor, keeping your head in line with your hands.
Push through your hands and extend your arms to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball prone leg raise",bodyPart:"back",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/ASLs3FjcAdtknF",id:1343,target:"spine",instructions:`Lie face down on a mat with your legs extended and your toes resting on top of the stability ball.
Place your hands on the ground, shoulder-width apart, and engage your core muscles.
Keeping your legs straight, slowly lift them off the ground, using your lower back and glutes to raise them as high as possible.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"exercise ball seated hamstring stretch",bodyPart:"upper legs",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/hxXTSCphbdl4fh",id:1560,target:"hamstrings",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Slowly roll the ball forward, walking your feet out until your upper back is resting on the ball and your legs are extended straight in front of you.
Place your hands on your hips for support.
Engage your core and slowly lower your upper body towards the ground, keeping your back straight and your chest lifted.
Stop when you feel a stretch in your hamstrings, and hold the position for 20-30 seconds.
Slowly return to the starting position by pushing through your heels and using your hamstrings to pull yourself back up.
Repeat for the desired number of repetitions.`},{name:"exercise ball seated triceps stretch",bodyPart:"upper arms",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/EvItGLg1G2i3BY",id:1745,target:"triceps",instructions:`Sit on a stability ball with your feet flat on the ground and your back straight.
Hold a dumbbell in one hand and extend your arm straight up above your head.
Bend your elbow and lower the dumbbell behind your head, keeping your upper arm close to your ear.
Hold the stretch for a few seconds, then return to the starting position.
Repeat with the other arm.`},{name:"exercise ball supine triceps extension",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/CMu6umGRyziZv6",id:1746,target:"triceps",instructions:`Sit on an exercise ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Hold a dumbbell with both hands and extend your arms straight up towards the ceiling.
Slowly lower the dumbbell behind your head, keeping your elbows close to your ears.
Pause for a moment, then raise the dumbbell back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"farmers walk",bodyPart:"upper legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/sFagl-hcViPOoq",id:2133,target:"quads",instructions:`Stand up straight with a dumbbell in each hand, palms facing your sides.
Keep your back straight and your shoulders back.
Take small, controlled steps forward, maintaining an upright posture.
Continue walking for the desired distance or time.
To finish, stop walking and carefully lower the dumbbells to your sides.`},{name:"flag",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qvRjqStuHqVE85",id:3303,target:"abs",instructions:`Start by gripping a vertical pole with both hands, palms facing each other, and arms fully extended.
Engage your core and lift your legs off the ground, keeping them straight.
Using your core and upper body strength, raise your legs until they are parallel to the ground.
Hold this position for as long as you can, maintaining a straight body line.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"flexion leg sit up (bent knee)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/cJYm956mfU8tRU",id:456,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
At the same time, lift your legs off the ground, bending your knees and bringing them towards your chest.
Pause for a moment at the top, then slowly lower your upper body and legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"flexion leg sit up (straight arm)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/rX45DRsYIhvypE",id:457,target:"abs",instructions:`Lie flat on your back with your legs extended and arms straight above your head.
Engaging your abs, lift your upper body off the ground while simultaneously lifting your legs towards your chest.
Reach your hands towards your toes as you lift your upper body and legs.
Pause for a moment at the top, then slowly lower your upper body and legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"flutter kicks",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4pp6NxmwUoAtpR",id:459,target:"glutes",instructions:`Lie flat on your back with your legs extended and your hands by your sides.
Engage your core and lift your legs off the ground about 6 inches.
Keeping your legs straight, alternate lifting one leg slightly higher than the other.
Continue this fluttering motion for the desired number of repetitions.`},{name:"forward jump",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/k6lpGEa-0waTqO",id:1472,target:"quads",instructions:`Stand with your feet shoulder-width apart.
Bend your knees and lower your body into a squat position.
Swing your arms back for momentum.
Jump forward explosively, extending your hips, knees, and ankles.
Land softly on the balls of your feet and immediately go into the next jump.
Repeat for the desired number of repetitions.`},{name:"forward lunge",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/I0fhHrhgbmolNe",id:3470,target:"glutes",instructions:`Stand with your feet hip-width apart and hands on your hips.
Take a big step forward with your right foot, lowering your body into a lunge position.
Bend your right knee to about 90 degrees, keeping your knee aligned with your ankle.
Push off with your right foot and return to the starting position.
Repeat with your left leg, alternating sides for the desired number of repetitions.`},{name:"frog crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/joGsk4PvpCGuaQ",id:2429,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"frog planche",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZVQlRSmDmMnDie",id:3301,target:"abs",instructions:`Start in a push-up position with your hands shoulder-width apart and your feet together.
Bend your elbows and lower your body towards the ground, keeping your back straight.
As you lower your body, lift your feet off the ground and bring your knees towards your chest.
Hold this position for a few seconds, then extend your legs back out and push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"front lever",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/F97aH2meMJzTb4",id:3296,target:"abs",instructions:`Start by hanging from a pull-up bar with an overhand grip, hands shoulder-width apart.
Engage your core and pull your shoulder blades down and back.
Bend your knees and tuck them towards your chest.
Simultaneously, lift your legs up and extend them straight out in front of you, keeping your body parallel to the ground.
Hold this position for as long as you can, aiming for a full front lever position.
To release, slowly lower your legs back down and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"front lever reps",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-wyGjVClWFDq7g",id:3295,target:"upper back",instructions:`Hang from a pull-up bar with an overhand grip, palms facing away from you.
Engage your core and pull your shoulder blades down and back.
Keeping your body straight, lift your legs up until they are parallel to the ground.
Hold this position for as long as you can, aiming for 10-20 seconds.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"front plank with twist",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/2XeszR0pxJH2aV",id:464,target:"abs",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line from head to toe.
Engage your core and glutes to maintain a stable position.
Rotate your torso to the right, lifting your right arm and extending it towards the ceiling.
Keep your hips and legs stable as you twist.
Hold for a moment, then return to the starting position.
Repeat the twist on the left side.
Continue alternating sides for the desired number of repetitions.`},{name:"full maltese",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/HZddmoN8dUd9k2",id:3315,target:"abs",instructions:`Start by standing with your feet shoulder-width apart and your arms extended straight out to the sides.
Slowly lean forward, keeping your arms straight, until your upper body is parallel to the ground.
Engage your core and hold this position for a few seconds.
Return to the starting position by pushing through your feet and standing back up.
Repeat for the desired number of repetitions.`},{name:"full planche",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/FoY0fX-ACRlzvP",id:3299,target:"abs",instructions:`Start in a push-up position with your hands shoulder-width apart and your fingers pointing forward.
Engage your core and slowly shift your weight forward, lifting your feet off the ground.
Continue shifting your weight forward until your body is parallel to the ground, balancing on your hands.
Hold this position for as long as you can, maintaining a straight body line.
Slowly lower your feet back to the ground and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"full planche push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PsPeFEhB2s204B",id:3327,target:"pectorals",instructions:`Start in a push-up position with your hands placed slightly wider than shoulder-width apart.
Engage your core and lower your body down towards the ground, keeping your elbows close to your sides.
As you lower yourself, lean your body forward and lift your feet off the ground, balancing on your hands.
Continue to lower your body until your chest is just above the ground.
Push through your hands and extend your arms to lift your body back up to the starting position.
Maintain a straight line from your head to your heels throughout the movement.
Repeat for the desired number of repetitions.`},{name:"gironda sternum chin",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/A2OI62BvSzUTmn",id:466,target:"lats",instructions:`Stand facing a high bar with your feet shoulder-width apart.
Reach up and grab the bar with an overhand grip, slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your body straight.
Engage your lats and biceps to pull your chest up towards the bar, leading with your sternum.
Pause for a moment at the top, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"glute bridge march",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Lk1pLvGZwLoRY9",id:3561,target:"glutes",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Engage your glutes and lift your hips off the ground, forming a straight line from your knees to your shoulders.
While keeping your hips lifted, lift one foot off the ground and bring your knee towards your chest.
Lower your foot back to the ground and repeat the movement with the other leg.
Continue alternating legs in a marching motion while maintaining the bridge position.
Repeat for the desired number of repetitions.`},{name:"glute bridge two legs on bench",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xFmLJ9AnFUohff",id:3523,target:"glutes",instructions:`Sit on the edge of a bench with your back against it and your feet flat on the ground.
Place your hands on the bench beside your hips for support.
Engage your glutes and hamstrings, then lift your hips off the bench until your body forms a straight line from your knees to your shoulders.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"glute-ham raise",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/SdAOMOHMXmYdh1",id:3193,target:"hamstrings",instructions:`Adjust the glute-ham raise machine to fit your body.
Position yourself face down on the machine with your ankles secured.
Place your hands on your chest or cross them over your chest.
Engage your hamstrings and glutes to lift your upper body up towards the ceiling.
Continue lifting until your body is in a straight line from your head to your heels.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"gorilla chin",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/wyJqnM3do33im2",id:467,target:"abs",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Grasp a pull-up bar with an overhand grip, slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your palms facing away from you.
Engage your core and pull your body up towards the bar, bringing your chin above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"groin crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/MyUPaAE3pFVIZn",id:469,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, lift your legs off the ground, bringing your knees towards your chest.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"half knee bends",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6FZy6bez0e6Mnw",id:3221,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Bend your knees and lower your body down as if you were sitting back into a chair.
Keep your chest up and your weight in your heels.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"half sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/7COdvxJB7DNxkm",id:3202,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hamstring stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZY0z-iQK5BS0sC",id:1511,target:"hamstrings",instructions:`Stand with your feet shoulder-width apart.
Step forward with your right foot and shift your weight onto your right leg.
Keeping your back straight, slowly bend forward at the hips, reaching towards your right foot with both hands.
Hold the stretch for 20-30 seconds, then return to the starting position.
Repeat on the other side.`},{name:"hands clasped circular toe touch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/smvZ4MuUaLc-7w",id:3218,target:"glutes",instructions:`Stand with your feet shoulder-width apart and your hands clasped together in front of your chest.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Lower your hands towards your toes in a circular motion, reaching as far as you can without straining.
Pause for a moment at the bottom, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"hands reversed clasped circular toe touch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3CbEo7aO9RPaqQ",id:3215,target:"glutes",instructions:`Stand with your feet shoulder-width apart and your arms extended to the sides.
Bend forward at the waist, keeping your back straight and your knees slightly bent.
Reach down with your hands and clasp them together behind your legs.
Slowly raise your hands up and over your head in a circular motion, keeping your legs straight.
Continue the circular motion until your hands touch your toes.
Reverse the motion and bring your hands back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"handstand",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/AdPzdxHEj2I4ft",id:3302,target:"triceps",instructions:`Find an open space with enough room to perform a handstand.
Place your hands on the ground shoulder-width apart, fingers pointing forward.
Kick your legs up towards the wall, using your core and shoulders to maintain balance.
Once in a handstand position, engage your triceps to support your body weight.
Hold the handstand for as long as you can maintain balance.
To come down, slowly lower your legs back to the ground.
Repeat for the desired number of repetitions.`},{name:"handstand push-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/uKVrCdQqSeMRmE",id:471,target:"triceps",instructions:`Find a wall and face away from it, standing a few feet away.
Place your hands on the ground shoulder-width apart and kick your feet up against the wall, coming into a handstand position.
Bend your elbows and lower your head towards the ground, keeping your body in a straight line.
Push through your hands and extend your arms to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging leg hip raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/vAIYrfsvXA-sUn",id:1764,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your legs up by flexing your hips and knees until your thighs are parallel to the ground.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/vSJx048bCMrdph",id:472,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your legs up in front of you, keeping them straight.
Continue lifting until your legs are parallel to the ground or as high as you can comfortably go.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging oblique knee raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/hloEYF3tcRh5eW",id:1761,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your knees towards your chest, twisting your torso to the side as you do so.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat on the other side, twisting your torso in the opposite direction.
Continue alternating sides for the desired number of repetitions.`},{name:"hanging pike",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/N1eDHdIsRiVtgp",id:473,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your legs up towards the bar, keeping them straight.
Continue lifting until your body forms a 'V' shape, with your legs parallel to the ground.
Hold the position for a moment, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging straight leg hip raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZVg4AyeaTnXKGo",id:474,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your legs up in front of you until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging straight leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/vUZHXOHErFHRUw",id:475,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your legs up in front of you, keeping them straight.
Continue lifting until your legs are parallel to the ground or as high as you can comfortably go.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hanging straight twisting leg hip raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qitRa51V4Mp6QG",id:476,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your legs straight.
Engage your core and lift your legs up towards your chest, keeping them straight.
Once your legs are parallel to the ground, twist your hips to one side, bringing your legs towards that side.
Pause for a moment, then return to the starting position.
Repeat the movement, but this time twist your hips to the opposite side.
Continue alternating sides for the desired number of repetitions.`},{name:"high knee against wall",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/BfPZvQqJ1Qzgv0",id:3636,target:"cardiovascular system",instructions:`Stand facing a wall with your feet hip-width apart.
Place your hands on the wall for support.
Engage your core and lift your right knee up towards your chest, while keeping your left foot on the ground.
Quickly switch legs, bringing your left knee up towards your chest and lowering your right foot back down.
Continue alternating legs in a running motion, bringing your knees up as high as possible.
Maintain a fast pace and keep your upper body stable throughout the exercise.
Repeat for the desired duration or number of repetitions.`},{name:"hip raise (bent knee)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/V4pmymu3TgE8pX",id:484,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands by your sides, palms facing down.
Engage your core and glutes, then lift your hips off the ground until your body forms a straight line from your knees to your shoulders.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"hug keens to chest",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/8QE-9nxcf4lIGb",id:1418,target:"glutes",instructions:`Start by standing with your feet shoulder-width apart.
Bend your knees and lower your body down into a squat position.
As you squat down, bring your knees up towards your chest and hug them with your arms.
Hold this position for a moment, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"hyght dumbbell fly",bodyPart:"chest",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/B4IFFCTdKl2oQ6",id:3234,target:"pectorals",instructions:`Lie flat on a bench with a dumbbell in each hand, palms facing each other.
Extend your arms straight up over your chest, with a slight bend in your elbows.
Keeping a slight bend in your elbows, lower the dumbbells out to the sides in a wide arc until you feel a stretch in your chest.
Pause for a moment, then reverse the movement and bring the dumbbells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"hyperextension",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/MOPxC7V5XtdapS",id:489,target:"spine",instructions:`Adjust the hyperextension bench so that your upper thighs are resting on the pad and your feet are secured.
Cross your arms over your chest or place your hands behind your head.
Lower your upper body towards the ground while keeping your back straight.
Pause for a moment at the bottom, then raise your upper body back up until it is in line with your legs.
Repeat for the desired number of repetitions.`},{name:"hyperextension (on bench)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/V5S8YP9OIdXd48",id:488,target:"spine",instructions:`Adjust the hyperextension bench so that your hips are resting comfortably on the pad and your feet are secured.
Cross your arms over your chest or place your hands behind your head.
Slowly lower your upper body towards the ground while keeping your back straight.
Pause for a moment at the bottom, then raise your upper body back up until it is in line with your legs.
Repeat for the desired number of repetitions.`},{name:"impossible dips",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/1TG06m8BZDPVaM",id:3289,target:"triceps",instructions:`Position yourself between two parallel bars with your arms fully extended and your body suspended in the air.
Bend your knees and cross your ankles.
Lower your body by bending your elbows until your upper arms are parallel to the ground.
Pause for a moment, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"inchworm",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/I7V-HzgEGmh9BM",id:1471,target:"abs",instructions:`Start in a standing position with your feet hip-width apart.
Bend forward at the waist and place your hands on the ground in front of you.
Walk your hands forward until you are in a high plank position, with your body in a straight line from head to toe.
Pause for a moment, then walk your hands back towards your feet, keeping your legs as straight as possible.
Once your hands reach your feet, stand back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"inchworm v. 2",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/nj5JIBg3CU4RAl",id:3698,target:"abs",instructions:`Start in a standing position with your feet hip-width apart.
Bend forward at the waist and place your hands on the ground in front of you.
Walk your hands forward until you are in a high plank position, with your body in a straight line from head to toe.
Keeping your legs straight, walk your feet towards your hands, bringing your hips up towards the ceiling.
Continue walking your hands forward, repeating the movement for the desired number of repetitions.`},{name:"incline close-grip push-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/N7FiKIRW0yHDHj",id:490,target:"triceps",instructions:`Place your hands on an elevated surface, such as a bench or step, slightly wider than shoulder-width apart.
Extend your legs behind you, resting on the balls of your feet, with your body forming a straight line from head to heels.
Lower your chest towards the elevated surface by bending your elbows, keeping them close to your sides.
Pause for a moment at the bottom, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"incline leg hip raise (leg straight)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/bDpPzsbVBLeFaU",id:491,target:"abs",instructions:`Lie on an incline bench with your back flat against the bench and your legs extended straight out in front of you.
Place your hands on the sides of the bench for support.
Engaging your abs, lift your legs off the bench, raising them as high as you can while keeping them straight.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"incline push up depth jump",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/XuUr4oLGp5nvqk",id:492,target:"pectorals",instructions:`Find an elevated surface, such as a bench or step, and place your hands shoulder-width apart on the edge.
Step your feet back, keeping your body in a straight line from head to heels.
Lower your chest towards the edge of the surface, bending your elbows and keeping your body aligned.
Push through your palms to extend your arms and return to the starting position.
Jump off the edge of the surface, landing softly with your knees slightly bent.
Repeat the push-up and depth jump for the desired number of repetitions.`},{name:"incline push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ToMPdgHxzf6EmI",id:493,target:"pectorals",instructions:`Place your hands on an elevated surface, such as a bench or step, slightly wider than shoulder-width apart.
Extend your legs behind you, resting on the balls of your feet, creating a straight line from your head to your heels.
Lower your chest towards the elevated surface by bending your elbows, keeping your body in a straight line.
Pause for a moment at the bottom, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"incline push-up (on box)",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3vBFFs6Av8ZeG3",id:3785,target:"pectorals",instructions:`Place your hands on the edge of a box or elevated surface, slightly wider than shoulder-width apart.
Extend your legs behind you, resting on the balls of your feet, creating a straight line from your head to your heels.
Lower your chest towards the box by bending your elbows, keeping your body in a straight line.
Pause for a moment at the bottom, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"incline reverse grip push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/u5iFWyY0dyU0Y1",id:494,target:"pectorals",instructions:`Place your hands on the edge of a bench or elevated surface, slightly wider than shoulder-width apart.
Extend your legs behind you, resting on the balls of your feet, creating a straight line from your head to your heels.
Lower your chest towards the bench by bending your elbows, keeping them close to your sides.
Pause for a moment at the bottom, then push yourself back up to the starting position by extending your arms.
Repeat for the desired number of repetitions.`},{name:"incline scapula push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/OV3cdl5AHNMkju",id:3011,target:"serratus anterior",instructions:`Set up an incline bench at a 45-degree angle.
Place your hands on the bench slightly wider than shoulder-width apart.
Position your feet on the ground, hip-width apart.
Lower your chest towards the bench, keeping your elbows tucked in.
As you lower, retract your shoulder blades, squeezing your scapulae together.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"incline twisting sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/kwIjYYk3JQ4GGQ",id:495,target:"abs",instructions:`Set up an incline bench at a 45-degree angle.
Lie down on the bench with your feet secured under the foot pads.
Place your hands behind your head or across your chest.
Engage your abs and lift your upper body off the bench, curling forward.
As you curl up, twist your torso to one side, bringing your elbow towards the opposite knee.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat the movement, this time twisting your torso to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"inverse leg curl (bench support)",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4C07da7Ey7GLh8",id:496,target:"hamstrings",instructions:`Lie face down on a bench with your hips at the edge and your legs extended straight behind you.
Hold onto the bench for support.
Keeping your upper body still, bend your knees and curl your legs towards your glutes.
Pause for a moment at the top, then slowly extend your legs back to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverse leg curl (on pull-up cable machine)",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ocJHkOy-KAJIsi",id:2400,target:"hamstrings",instructions:`Adjust the cable machine so that the ankle straps are at the lowest setting.
Lie face down on the bench with your legs extended and the ankle straps attached to your feet.
Hold onto the handles of the bench for stability.
Bend your knees and curl your legs towards your glutes, squeezing your hamstrings.
Pause for a moment at the top of the movement, then slowly lower your legs back to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverted row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aY4If9TSc1LnI-",id:499,target:"upper back",instructions:`Set up a bar at waist height or use a suspension trainer.
Stand facing the bar or suspension trainer, with your feet shoulder-width apart.
Grab the bar or handles with an overhand grip, slightly wider than shoulder-width apart.
Lean back, keeping your body straight and your heels on the ground.
Pull your chest towards the bar or handles, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower yourself back to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverted row bent knees",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/uOBJFxEwuQyAK7",id:2300,target:"upper back",instructions:`Set up a bar at waist height and lie underneath it.
Grab the bar with an overhand grip, slightly wider than shoulder-width apart.
Position your body so that your heels are on the ground and your body is straight.
Pull your chest up towards the bar by squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverted row on bench",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Vu7Hg-tc8rr7tM",id:2298,target:"upper back",instructions:`Set up a bench at a height that allows your body to hang freely underneath it.
Lie face up on the ground with your head towards the bench.
Reach up and grab the bench with an overhand grip, slightly wider than shoulder-width apart.
Position your body so that your heels are on the ground and your arms are fully extended.
Engage your core and squeeze your shoulder blades together as you pull your chest up towards the bench.
Pause for a moment at the top of the movement, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverted row v. 2",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Sqf9JV0t57dh5n",id:497,target:"upper back",instructions:`Set up a bar at waist height on a Smith machine or use a suspension trainer.
Stand facing the bar or suspension trainer and grab it with an overhand grip, hands shoulder-width apart.
Walk your feet forward, leaning back until your body is at a slight angle.
Keep your body straight and pull your chest up towards the bar or handles, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"inverted row with straps",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Esx4Ty1U2veRHH",id:498,target:"upper back",instructions:`Set up a suspension trainer or straps at chest height.
Stand facing the anchor point and grab the handles with an overhand grip.
Walk your feet forward, leaning back until your body is at an angle.
Keep your body straight and engage your core.
Pull your chest towards the handles, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower yourself back to the starting position.
Repeat for the desired number of repetitions.`},{name:"iron cross stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qAvHxUhnJqZSoV",id:1419,target:"glutes",instructions:`Lie flat on your back with your arms extended out to the sides.
Raise your legs up towards the ceiling, keeping them straight.
Slowly lower your legs to one side, aiming to touch the floor with your feet.
Hold the stretch for a few seconds, then return your legs to the starting position.
Repeat the stretch on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"isometric chest squeeze",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/dY1kwteHMIjPIB",id:1297,target:"pectorals",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Extend your arms straight out in front of you, parallel to the ground, with your palms facing each other.
Squeeze your chest muscles together as hard as you can, while keeping your arms straight.
Hold this position for a few seconds, focusing on contracting your chest muscles.
Release the squeeze and relax your chest muscles.
Repeat for the desired number of repetitions.`},{name:"isometric wipers",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/33lJyKKngwIBps",id:500,target:"pectorals",instructions:`Start by lying flat on your back on a mat or bench.
Extend your arms straight out to the sides, perpendicular to your body.
Engage your core and lift both legs off the ground, keeping them together and straight.
Slowly lower your legs to one side, aiming to touch the ground with your feet while maintaining control.
Pause for a moment, then use your core to lift your legs back to the starting position.
Repeat the movement, this time lowering your legs to the opposite side.
Continue alternating sides for the desired number of repetitions.`},{name:"jack burpee",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/CYJITYZXyAYiW4",id:501,target:"cardiovascular system",instructions:`Start in a standing position with your feet shoulder-width apart.
Lower your body into a squat position, placing your hands on the ground in front of you.
Kick your feet back, landing in a push-up position.
Perform a push-up, lowering your chest to the ground and then pushing back up.
Jump your feet forward, landing in a squat position.
Jump up explosively, reaching your arms overhead.
Land softly and immediately lower back into the squat position to begin the next repetition.`},{name:"jack jump",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Fe58SG83MO7FW3",id:3224,target:"cardiovascular system",instructions:`Stand with your feet together and your arms by your sides.
Jump up, spreading your feet apart and raising your arms above your head.
As you land, quickly jump back to the starting position.
Repeat for the desired number of repetitions.`},{name:"jackknife sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/UqXa35eKx-x-gQ",id:507,target:"abs",instructions:`Lie flat on your back with your legs extended and your arms overhead.
Engage your core and lift your legs and upper body simultaneously, reaching your hands towards your toes.
Pause for a moment at the top, then slowly lower your legs and upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"janda sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/eRnq8Wu-sB5swq",id:508,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"jump squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/HmO6VKWEpA0bjT",id:514,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Lower your body into a squat position by bending your knees and pushing your hips back.
Jump explosively off the ground, extending your hips, knees, and ankles.
While in mid-air, quickly bring your arms forward for balance.
Land softly on the balls of your feet and immediately go into the next repetition.
Repeat for the desired number of repetitions.`},{name:"jump squat v. 2",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/wxj9jB4jqckgxj",id:513,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Lower your body into a squat position by bending your knees and pushing your hips back.
Jump explosively, extending your hips and knees fully.
Land softly on the balls of your feet and immediately lower your body back into a squat position.
Repeat for the desired number of repetitions.`},{name:"kettlebell advanced windmill",bodyPart:"waist",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/QmVEf4jxlNQsZu",id:517,target:"abs",instructions:`Stand with your feet wider than shoulder-width apart, toes pointing slightly outward.
Hold a kettlebell in your right hand, with your arm extended overhead and your palm facing forward.
Rotate your left foot slightly to the right, and shift your weight onto your left leg.
Bend your left knee and hinge at the hip, lowering your torso towards the left side.
Keep your right arm extended overhead and your eyes on the kettlebell.
As you lower your torso, allow your right leg to straighten and your right foot to pivot slightly.
Lower your torso until you feel a stretch in your left hamstring and your right arm is pointing towards the ground.
Pause for a moment, then engage your core and push through your left heel to return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell alternating hang clean",bodyPart:"lower arms",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/qe90sefZ4NdswE",id:518,target:"forearms",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand with an overhand grip.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and chest up.
Allow the kettlebells to hang in front of your body with your arms fully extended.
In one fluid motion, explosively extend your hips, shrug your shoulders, and pull the kettlebells up towards your shoulders.
As the kettlebells reach shoulder height, rotate your wrists and catch the kettlebells in the rack position, with your palms facing inward and the kettlebells resting on the outside of your forearms.
Lower the kettlebells back down to the starting position and repeat the movement with the opposite arm.
Continue alternating arms for the desired number of repetitions.`},{name:"kettlebell alternating press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/NYjfy2ck1D2fI-",id:520,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder height.
Press one kettlebell overhead, fully extending your arm.
Lower the kettlebell back to shoulder height.
Repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"kettlebell alternating press on floor",bodyPart:"chest",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/rEaZEXULeJPXvk",id:519,target:"pectorals",instructions:`Start by lying on your back on the floor with your knees bent and feet flat on the ground.
Hold a kettlebell in each hand, with your palms facing towards your feet and your arms extended straight up towards the ceiling.
Lower one kettlebell down towards your shoulder while keeping the other kettlebell extended straight up.
Press the lowered kettlebell back up to the starting position while simultaneously lowering the other kettlebell down towards your shoulder.
Continue alternating the press motion with each kettlebell for the desired number of repetitions.`},{name:"kettlebell alternating renegade row",bodyPart:"back",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/DPnO0jVVutUaqc",id:521,target:"upper back",instructions:`Start in a high plank position with your hands gripping the kettlebells and your feet hip-width apart.
Engage your core and keep your body in a straight line from head to heels.
Pull one kettlebell up towards your chest, keeping your elbow close to your body.
Lower the kettlebell back down to the starting position and repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"kettlebell alternating row",bodyPart:"back",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/fy5FstGPUPybMR",id:522,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a kettlebell in each hand with your palms facing your body.
Bend forward at the hips, keeping your back straight and your core engaged.
Pull one kettlebell up towards your chest, keeping your elbow close to your body and squeezing your shoulder blades together.
Lower the kettlebell back down to the starting position and repeat with the other arm.
Continue alternating arms for the desired number of repetitions.`},{name:"kettlebell arnold press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/kPg47tJmg4sJkm",id:523,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder height with your palms facing towards you.
Engage your core and press the kettlebells overhead, rotating your palms to face forward as you extend your arms.
Pause at the top of the movement, then slowly lower the kettlebells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"kettlebell bent press",bodyPart:"waist",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/QJnlTPMpCtpqjt",id:524,target:"abs",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in your right hand.
Bend your knees slightly and press the kettlebell overhead with your right arm, keeping your elbow locked.
Rotate your torso to the left, shifting your weight onto your left foot.
Bend your left knee and lower your torso towards the ground, keeping your right arm extended overhead.
As you lower, keep your eyes on the kettlebell and your chest lifted.
Once your left hand touches the ground, push through your left foot and straighten your left leg, driving your hips forward.
As you drive your hips forward, use your core and right arm to press the kettlebell back up to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell bottoms up clean from the hang position",bodyPart:"upper arms",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/qEjCRrjrX3cutc",id:525,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand with an overhand grip.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and chest up.
Allow the kettlebell to hang down between your legs, with your arm fully extended.
In one fluid motion, explosively extend your hips and knees while pulling the kettlebell up towards your shoulder.
As the kettlebell reaches shoulder height, rotate your wrist so that the bottom of the kettlebell is facing up.
Catch the kettlebell at shoulder height with your elbow bent and your palm facing up.
Lower the kettlebell back down to the starting position by reversing the movement.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell double alternating hang clean",bodyPart:"upper arms",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/tAxjWW0Ze2R8i8",id:526,target:"biceps",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand with an overhand grip.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and chest up.
Allow the kettlebells to hang straight down in front of your body.
In one fluid motion, explosively extend your hips and knees while shrugging your shoulders.
As the kettlebells rise, pull them up towards your shoulders, keeping your elbows high and out to the sides.
Catch the kettlebells at shoulder height, with your palms facing inward and your elbows pointing forward.
Lower the kettlebells back down to the starting position and repeat for the desired number of repetitions.`},{name:"kettlebell double jerk",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/1ImBfqdM3p5vQV",id:527,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder height.
Bend your knees slightly and engage your core.
Press the kettlebells overhead, fully extending your arms.
Bend your knees and quickly drop into a partial squat.
Explosively extend your hips and knees, driving the kettlebells overhead.
Lock out your arms and catch the kettlebells overhead with your knees slightly bent.
Stand up straight and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"kettlebell double push press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/XOJhad8Tj4Sew4",id:528,target:"delts",instructions:`Start by standing with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder height.
Bend your knees slightly and engage your core.
Initiate the movement by explosively extending your hips, knees, and ankles, driving the kettlebells overhead.
As the kettlebells reach the top, press them fully overhead, locking out your arms.
Lower the kettlebells back to the starting position by bending your elbows and bringing them back down to shoulder height.
Repeat for the desired number of repetitions.`},{name:"kettlebell double snatch",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/T-a8rOm8WWK4wa",id:529,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at arm's length in front of your thighs.
Bend your knees slightly and hinge forward at the hips, keeping your back flat and chest up.
In one explosive motion, extend your hips, knees, and ankles, and simultaneously pull the kettlebells up towards your shoulders.
As the kettlebells reach shoulder level, rotate your wrists and punch the kettlebells overhead, fully extending your arms.
Lower the kettlebells back down to the starting position and repeat for the desired number of repetitions.`},{name:"kettlebell double windmill",bodyPart:"waist",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/4zVsBACLZs9xtQ",id:530,target:"abs",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in your right hand.
Extend your right arm overhead, keeping your eyes on the kettlebell.
Rotate your left foot 45 degrees to the left and your right foot 90 degrees to the right.
Bend at the waist to the left, keeping your right arm extended overhead.
Lower the kettlebell towards the ground, reaching towards your left foot.
Pause for a moment, then engage your core and push through your right foot to return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell extended range one arm press on floor",bodyPart:"chest",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/GHZGGGMwfK1hgL",id:531,target:"pectorals",instructions:`Start by lying on your back on the floor with your knees bent and feet flat on the ground.
Hold a kettlebell in one hand, with your palm facing towards your feet.
Extend your arm straight up towards the ceiling, keeping your elbow locked and your wrist straight.
Slowly lower the kettlebell back down to the starting position, maintaining control throughout the movement.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"kettlebell figure 8",bodyPart:"waist",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/55gHKjFzB6J5XK",id:532,target:"abs",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Pass the kettlebell between your legs, switching hands as it reaches the back of your legs.
As the kettlebell comes forward, pass it to the other hand between your legs.
Continue passing the kettlebell between your legs in a figure 8 motion.
Maintain a steady pace and engage your core throughout the exercise.
Repeat for the desired number of repetitions.`},{name:"kettlebell front squat",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/zKHa8Wcvo2BbO8",id:533,target:"glutes",instructions:`Stand with your feet shoulder-width apart, toes slightly turned out.
Hold the kettlebell with both hands in front of your chest, close to your body.
Engage your core and keep your chest up as you lower your hips down and back, as if sitting into a chair.
Lower until your thighs are parallel to the ground, or as low as you can comfortably go.
Drive through your heels to stand back up, squeezing your glutes at the top.
Repeat for the desired number of repetitions.`},{name:"kettlebell goblet squat",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/-OcxyXtqbXPzyM",id:534,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell close to your chest with both hands.
Keeping your chest up and core engaged, lower your body down into a squat position by bending at the knees and hips.
Continue lowering until your thighs are parallel to the ground, or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"kettlebell hang clean",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/i-gGApmXXGHiw4",id:535,target:"hamstrings",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in front of your thighs.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Lower the kettlebell towards the ground, allowing it to swing between your legs.
Quickly extend your hips and knees, using the momentum to swing the kettlebell up to shoulder height.
As the kettlebell reaches shoulder height, rotate your wrists and catch the kettlebell in the rack position, with your elbow tucked in and the kettlebell resting on your forearm.
Lower the kettlebell back down to the starting position between your legs, and repeat for the desired number of repetitions.`},{name:"kettlebell lunge pass through",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/yDeLRIlYhkMph2",id:536,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in front of your chest with both hands.
Take a step forward with your right foot, lowering your body into a lunge position.
As you lunge forward, pass the kettlebell under your right thigh and transfer it to your left hand.
Push off with your right foot to return to the starting position, while simultaneously passing the kettlebell back to your right hand.
Repeat the lunge on the opposite side, passing the kettlebell under your left thigh.
Continue alternating lunges and passing the kettlebell between hands for the desired number of repetitions.`},{name:"kettlebell one arm clean and jerk",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/lLHCFWMDNIQV8J",id:537,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand with an overhand grip.
Bend your knees slightly and hinge at the hips, lowering the kettlebell between your legs.
Explosively extend your hips, knees, and ankles, using the momentum to swing the kettlebell up to shoulder height.
As the kettlebell reaches shoulder height, rotate your wrist and punch your hand straight up, locking out your arm overhead.
Lower the kettlebell back down to the starting position and repeat for the desired number of repetitions.`},{name:"kettlebell one arm floor press",bodyPart:"chest",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/zn1TnBwr9GHfZi",id:1298,target:"pectorals",instructions:`Lie flat on your back on the floor with your knees bent and feet flat on the ground.
Hold the kettlebell in one hand with your palm facing towards your feet and your arm extended straight up towards the ceiling.
Slowly lower the kettlebell towards your chest by bending your elbow, keeping your upper arm close to your body.
Pause for a moment when the kettlebell is just above your chest, then push it back up to the starting position by extending your elbow.
Repeat for the desired number of repetitions, then switch to the other arm.`},{name:"kettlebell one arm jerk",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/zMIG8QBz8xQsfn",id:538,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand at shoulder height.
Bend your knees slightly and engage your core.
Press the kettlebell overhead in a straight line, fully extending your arm.
As you press the kettlebell overhead, simultaneously dip your knees and quickly straighten them to generate momentum.
As the kettlebell reaches its highest point, quickly drop underneath it by bending your knees and hips.
Catch the kettlebell with a slight bend in your knees and hips, and your arm fully extended overhead.
Stand up straight, fully extending your knees and hips, and stabilize the kettlebell overhead.
Lower the kettlebell back to the starting position by bending your knees and hips, and repeat for the desired number of repetitions.`},{name:"kettlebell one arm military press to the side",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/PsLFJSYj6Nt89b",id:539,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand at shoulder height.
Engage your core and keep your back straight.
Press the kettlebell overhead, extending your arm fully.
Pause for a moment at the top, then slowly lower the kettlebell back to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell one arm push press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/OMfSXDda9PD2xZ",id:540,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand at shoulder level.
Bend your knees slightly and engage your core.
Press the kettlebell overhead by extending your arm and fully extending your legs.
Lower the kettlebell back to the starting position by bending your knees and bringing the kettlebell back to your shoulder.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell one arm row",bodyPart:"back",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/9BtsWJpHEZtSUQ",id:541,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand with an overhand grip.
Bend your knees slightly and hinge forward at the hips, keeping your back straight and your core engaged.
Pull the kettlebell up towards your chest, keeping your elbow close to your body and squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the kettlebell back down to the starting position.
Repeat for the desired number of repetitions, then switch sides and repeat with the other arm.`},{name:"kettlebell one arm snatch",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/yprjXXmskLnw0F",id:542,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand between your legs.
Bend your knees slightly and hinge at the hips, lowering the kettlebell towards the ground.
Explosively extend your hips and knees, using the momentum to swing the kettlebell up towards your shoulder.
As the kettlebell reaches shoulder height, rotate your hand and punch it straight up overhead, fully extending your arm.
Lower the kettlebell back down between your legs and repeat for the desired number of repetitions.`},{name:"kettlebell pirate supper legs",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/qes38aalqgwvm7",id:543,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in one hand.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Raise the kettlebell up to shoulder height, keeping your elbow close to your body.
Extend your arm fully overhead, straightening your elbow.
Lower the kettlebell back down to shoulder height, then return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kettlebell pistol squat",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/9Mw4kDmji5iFx4",id:544,target:"glutes",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in front of your chest with both hands.
Lift your left foot off the ground and extend it forward, keeping it parallel to the ground.
Slowly lower your body down into a squat position, keeping your right foot flat on the ground and your left leg extended.
Pause for a moment at the bottom of the squat, then push through your right heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"kettlebell plyo push-up",bodyPart:"chest",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/D13C1OSZY20p75",id:545,target:"pectorals",instructions:`Start in a high plank position with your hands on the kettlebells, shoulder-width apart.
Lower your chest towards the ground, keeping your elbows close to your body.
Push through your hands explosively, lifting your hands off the kettlebells and extending your arms fully.
Land softly back on the kettlebells and immediately lower your chest back down for the next repetition.
Repeat for the desired number of repetitions.`},{name:"kettlebell seated press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/Ft3dIlqg-UMfxs",id:546,target:"delts",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a kettlebell in each hand at shoulder height, palms facing forward.
Press the kettlebells overhead, fully extending your arms.
Lower the kettlebells back to shoulder height.
Repeat for the desired number of repetitions.`},{name:"kettlebell seated two arm military press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/fKKTkqTGEZNbMk",id:1438,target:"delts",instructions:`Sit on a bench with your back straight and feet flat on the ground.
Hold a kettlebell in each hand at shoulder level with your palms facing forward.
Press the kettlebells overhead by extending your arms fully.
Pause for a moment at the top, then slowly lower the kettlebells back to shoulder level.
Repeat for the desired number of repetitions.`},{name:"kettlebell seesaw press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/Xoeq1lUSkzahsH",id:547,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder height.
Press one kettlebell overhead while keeping the other kettlebell at shoulder height.
Lower the pressed kettlebell back to shoulder height while simultaneously pressing the other kettlebell overhead.
Continue alternating the pressing motion, creating a seesaw-like movement.
Repeat for the desired number of repetitions.`},{name:"kettlebell sumo high pull",bodyPart:"back",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/Pi40aLLYLerOOz",id:548,target:"traps",instructions:`Stand with your feet wider than shoulder-width apart, toes pointing outwards.
Hold a kettlebell with both hands in front of your body, arms extended downwards.
Bend your knees and lower your hips into a squat position, keeping your back straight.
Drive through your heels and explosively extend your hips and knees, pulling the kettlebell up towards your chin.
As you pull the kettlebell up, keep your elbows high and wide, and squeeze your shoulder blades together.
Lower the kettlebell back down to the starting position and repeat for the desired number of repetitions.`},{name:"kettlebell swing",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/kNVOywM4UGTnqy",id:549,target:"glutes",instructions:`Stand with your feet shoulder-width apart, toes pointed slightly outward.
Hold the kettlebell with both hands in front of your body, arms extended.
Bend your knees slightly and hinge at the hips, pushing your butt back.
Swing the kettlebell back between your legs, keeping your arms straight and maintaining a flat back.
Drive your hips forward and swing the kettlebell up to shoulder height, using the momentum generated by your hips.
Allow the kettlebell to swing back down between your legs and repeat the movement for the desired number of repetitions.`},{name:"kettlebell thruster",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/qGbyCcxv38PczY",id:550,target:"delts",instructions:`Start by standing with your feet shoulder-width apart, holding a kettlebell in front of your chest with both hands, palms facing each other.
Lower into a squat position by bending your knees and pushing your hips back, keeping your chest up and your back straight.
As you reach the bottom of the squat, explosively drive through your heels to stand up, simultaneously pressing the kettlebell overhead.
Lock out your arms at the top of the movement, fully extending your elbows.
Lower the kettlebell back to the starting position by reversing the movement, bending your elbows and lowering the weight back to your chest.
Repeat for the desired number of repetitions.`},{name:"kettlebell turkish get up (squat style)",bodyPart:"upper legs",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/xcCZflMlaGEIT1",id:551,target:"glutes",instructions:`Start by lying on your back with your legs extended and the kettlebell held in your right hand, arm fully extended above your shoulder.
Bend your right knee and place your right foot flat on the ground, keeping your left leg extended.
Pressing through your right foot, lift your hips off the ground, coming into a bridge position.
Slide your left leg underneath your body, bending your left knee and placing your left foot flat on the ground.
Rotate your torso to the left, bringing your left hand to the ground for support.
Pressing through your right foot and left hand, lift your torso off the ground, coming into a kneeling position.
From the kneeling position, stand up, keeping the kettlebell extended overhead.
Reverse the movement to return to the starting position.
Repeat the exercise on the other side, starting with the kettlebell in your left hand.`},{name:"kettlebell two arm clean",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/3HK53FBjDVZhzb",id:552,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in front of your thighs with both hands, palms facing towards you.
Bend your knees slightly and hinge at the hips, lowering the kettlebell towards the ground.
Explosively extend your hips and knees, using the momentum to pull the kettlebell up towards your shoulders.
As the kettlebell reaches shoulder height, rotate your wrists and catch the kettlebell in the rack position, with your elbows tucked in and the kettlebell resting on the back of your forearm.
Lower the kettlebell back down to the starting position and repeat for the desired number of repetitions.`},{name:"kettlebell two arm military press",bodyPart:"shoulders",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/zq4CR5t8Vf9lOj",id:553,target:"delts",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in each hand at shoulder level with your palms facing forward.
Engage your core and press the kettlebells overhead, fully extending your arms.
Pause for a moment at the top, then slowly lower the kettlebells back to the starting position.
Repeat for the desired number of repetitions.`},{name:"kettlebell two arm row",bodyPart:"back",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/AjXa2yByQa3K-Q",id:1345,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a kettlebell in each hand with your palms facing your body.
Bend forward at the hips, keeping your back straight and your core engaged.
Pull the kettlebells up towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the kettlebells back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"kettlebell windmill",bodyPart:"waist",equipment:"kettlebell",gifUrl:"https://v2.exercisedb.io/image/vjhlxNF-zGVBqZ",id:554,target:"abs",instructions:`Stand with your feet shoulder-width apart, holding a kettlebell in your right hand overhead.
Rotate your left foot outwards about 45 degrees and keep your right foot pointing forward.
Bend your torso to the left side, keeping your right arm extended overhead and your eyes on the kettlebell.
Lower your torso as far as you can while keeping your right arm straight and your left arm extended to the side.
Pause for a moment, then return to the starting position by pushing through your right foot and engaging your obliques.
Repeat for the desired number of repetitions, then switch sides.`},{name:"kick out sit",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/93bFKP7lUjfXGP",id:555,target:"hamstrings",instructions:`Sit on the edge of a bench or chair with your feet flat on the ground and your knees bent at a 90-degree angle.
Lean back slightly and place your hands on the edge of the bench or chair for support.
Engaging your hamstrings, lift your feet off the ground and extend your legs straight out in front of you.
Pause for a moment at the top, then slowly bend your knees and bring your feet back towards your body.
Repeat for the desired number of repetitions.`},{name:"kipping muscle up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/UIWwmDcdRQmO1X",id:558,target:"lats",instructions:`Start by hanging from a pull-up bar with an overhand grip, hands slightly wider than shoulder-width apart.
Engage your core and use a swinging motion to generate momentum.
As you swing forward, pull your chest towards the bar, using your lats and biceps to initiate the movement.
Continue the upward motion until your chest reaches the bar, then transition into a dip position by pushing down on the bar and extending your arms.
Lower yourself back down to the starting position by bending your arms and controlling the descent.
Repeat for the desired number of repetitions.`},{name:"knee touch crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/AVY-toroRnI977",id:3640,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, lift your shoulder blades off the ground and reach your right hand towards your left knee.
Return to the starting position and repeat, this time reaching your left hand towards your right knee.
Continue alternating sides for the desired number of repetitions.`},{name:"kneeling lat stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/pc2RACMwp5lFkp",id:1346,target:"lats",instructions:`Kneel on the ground with your knees hip-width apart and your toes pointing back.
Extend your arms overhead and interlace your fingers.
Keeping your back straight, slowly lean to the right side, feeling a stretch in your left lat muscle.
Hold the stretch for 20-30 seconds, then return to the starting position.
Repeat the stretch on the left side, leaning to the left and feeling a stretch in your right lat muscle.
Continue alternating sides for the desired number of repetitions.`},{name:"kneeling plank tap shoulder",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qJ7pljrb42lCfQ",id:3239,target:"abs",instructions:`Start in a kneeling position with your hands on the ground, shoulder-width apart.
Extend your legs behind you, resting on your toes, and lift your body into a plank position.
Keeping your core engaged and your hips stable, lift one hand off the ground and tap the opposite shoulder.
Return the hand to the ground and repeat with the other hand.
Continue alternating sides for the desired number of repetitions.`},{name:"kneeling push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-WNDO5uNhHI14m",id:3211,target:"pectorals",instructions:`Start by kneeling on the ground with your hands shoulder-width apart, fingers pointing forward.
Extend your legs behind you, resting on the balls of your feet, so that your body forms a straight line from head to heels.
Engage your core and lower your body towards the ground by bending your elbows, keeping them close to your sides.
Continue lowering until your chest is just above the ground, then push back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"korean dips",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/FTsYaXsOGieupE",id:3288,target:"pectorals",instructions:`Position yourself between two parallel bars with your arms extended and supporting your body weight.
Lower your body by bending your elbows until your upper arms are parallel to the ground.
Pause for a moment, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"l-pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/vYYmyR8wjQRQYI",id:3418,target:"lats",instructions:`Grab the pull-up bar with an overhand grip, slightly wider than shoulder-width apart.
Hang with your arms fully extended and your body straight.
Engage your lats and biceps to pull your body up towards the bar, keeping your elbows close to your body.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"l-sit on floor",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/BVr-IkvN8UH8Jy",id:3419,target:"abs",instructions:`Sit on the floor with your legs extended in front of you.
Place your hands on the floor beside your hips, fingers pointing forward.
Engage your core and lift your legs off the ground, keeping them straight.
Try to bring your legs parallel to the floor, forming an 'L' shape with your body.
Hold this position for as long as you can.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"lean planche",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aQc4han1gHjasL",id:3300,target:"abs",instructions:`Start in a push-up position with your hands shoulder-width apart and your body straight.
Engage your core and slowly shift your weight forward, bringing your shoulders past your hands.
Keep your elbows slightly bent and your body straight as you lean forward.
Hold this position for a few seconds, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"left hook. boxing",bodyPart:"shoulders",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/pOwJxep2YnviK7",id:2271,target:"delts",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Keep your left hand up to protect your face and your right hand by your chin.
Rotate your hips and pivot on your left foot as you extend your left arm forward in a punching motion.
Twist your torso and engage your core muscles to generate power in the punch.
Snap your arm back to the starting position and repeat for the desired number of repetitions.`},{name:"leg pull in flat bench",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3n6h2apusPIlPL",id:570,target:"abs",instructions:`Sit on a flat bench with your legs extended straight out in front of you.
Place your hands on the bench beside your hips for support.
Engage your abs and lift your legs off the ground, bringing your knees towards your chest.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"leg up hamstring stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/epyAmd62mwc29i",id:1576,target:"hamstrings",instructions:`Lie flat on your back with your legs extended.
Bend one knee and bring it towards your chest, holding onto your thigh or shin.
Straighten your leg as much as possible while keeping it elevated.
Hold the stretch for 20-30 seconds.
Repeat with the other leg.`},{name:"low glute bridge on floor",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/E6SsoCLGcaISLz",id:3013,target:"glutes",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your arms by your sides, palms facing down.
Engage your glutes and core, then lift your hips off the ground until your body forms a straight line from your knees to your shoulders.
Pause for a moment at the top, squeezing your glutes.
Slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"lower back curl",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ggCNcCifLnrhNl",id:1352,target:"spine",instructions:`Lie flat on your stomach with your legs extended and your arms by your sides.
Engage your glutes and hamstrings, and slowly lift your upper body off the ground, curling your back upwards.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"lunge with jump",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/OEV7AjrDhfSZN5",id:3582,target:"glutes",instructions:`Start by standing with your feet shoulder-width apart.
Take a step forward with your right foot, lowering your body into a lunge position.
Push off with your right foot and jump into the air, switching the position of your feet mid-air.
Land softly with your left foot forward and immediately lower your body into a lunge position.
Continue alternating between lunges and jumps for the desired number of repetitions.`},{name:"lunge with twist",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/htileHUPv5rjdo",id:1688,target:"abs",instructions:`Start by standing with your feet shoulder-width apart.
Take a step forward with your right foot, lowering your body into a lunge position.
As you lunge, twist your torso to the right, bringing your left elbow towards your right knee.
Pause for a moment, then return to the starting position.
Repeat on the other side, stepping forward with your left foot and twisting your torso to the left.
Continue alternating sides for the desired number of repetitions.`},{name:"lying (side) quads stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/hb6RTtBEv6wZDz",id:613,target:"quads",instructions:`Lie on your side with your legs straight.
Bend your top leg and grab your ankle or foot with your hand.
Gently pull your ankle or foot towards your glutes until you feel a stretch in your quads.
Hold the stretch for 20-30 seconds.
Release the stretch and repeat on the other side.`},{name:"lying elbow to knee",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/VLsNTrv9sVsTc8",id:2312,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engage your abs and lift your upper body off the ground, bringing your right elbow towards your left knee.
At the same time, extend your right leg straight out and lift it off the ground.
Pause for a moment, then return to the starting position.
Repeat the movement, this time bringing your left elbow towards your right knee and extending your left leg.
Continue alternating sides for the desired number of repetitions.`},{name:"lying leg raise flat bench",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xAxDcGnCU2iLti",id:620,target:"abs",instructions:`Lie flat on a flat bench with your back pressed against it.
Place your hands under your glutes for support.
Keep your legs straight and together, and lift them up towards the ceiling.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"lying leg-hip raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ud1-d1mdT8cpdq",id:865,target:"abs",instructions:`Lie flat on your back with your legs extended and your arms by your sides.
Place your hands under your glutes for support.
Engage your core and lift your legs off the ground, raising them towards the ceiling.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"march sit (wall)",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Kcm9yjZ7c228Sh",id:624,target:"glutes",instructions:`Stand with your back against a wall and your feet hip-width apart.
Slowly slide your back down the wall until your knees are bent at a 90-degree angle.
Lift your right foot off the ground and bring your knee towards your chest.
Lower your right foot back down and lift your left foot off the ground, bringing your knee towards your chest.
Continue alternating between lifting your right and left foot for the desired number of repetitions.`},{name:"medicine ball catch and overhead throw",bodyPart:"back",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/3ChYzpDFw-ndC5",id:1353,target:"lats",instructions:`Stand with your feet shoulder-width apart, holding a medicine ball in both hands at chest level.
Bend your knees slightly and engage your core.
Lower your body into a squat position, keeping your back straight and chest up.
Explosively extend your hips and legs, while simultaneously throwing the medicine ball overhead.
Release the ball at the top of the movement and catch it on the way down.
Lower your body back into the squat position and repeat for the desired number of repetitions.`},{name:"medicine ball chest pass",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/wk49wCuXQFj1IM",id:1302,target:"pectorals",instructions:`Stand with your feet shoulder-width apart, holding the medicine ball at chest level.
Extend your arms forward, pushing the medicine ball away from your chest with force.
As you release the ball, follow through with your arms and torso, transferring your weight from your back foot to your front foot.
Catch the ball as it rebounds off the wall or partner, and immediately repeat the movement.
Continue for the desired number of repetitions.`},{name:"medicine ball chest push from 3 point stance",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/oowSnm3vSIqqKr",id:1303,target:"pectorals",instructions:`Start in a 3 point stance with one hand on the medicine ball and the other hand on the ground.
Extend your legs and position your body in a straight line.
Lower your chest towards the ground while keeping your back straight.
Push the medicine ball away from your body, extending your arm fully.
Return to the starting position and repeat for the desired number of repetitions.`},{name:"medicine ball chest push multiple response",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/9vhCjrU-C7Ao8M",id:1304,target:"pectorals",instructions:`Stand with your feet shoulder-width apart, holding a medicine ball at chest level.
Extend your arms forward, pushing the medicine ball away from your chest.
Pause for a moment, then slowly bring the medicine ball back to your chest.
Repeat for the desired number of repetitions.`},{name:"medicine ball chest push single response",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/bYOa2HdDrWP4AF",id:1305,target:"pectorals",instructions:`Stand with your feet shoulder-width apart, holding the medicine ball at chest level.
Extend your arms forward, pushing the medicine ball away from your chest.
Pause for a moment, then slowly bring the medicine ball back to your chest.
Repeat for the desired number of repetitions.`},{name:"medicine ball chest push with run release",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/navY7sFahEN9V8",id:1312,target:"pectorals",instructions:`Stand with your feet shoulder-width apart, holding a medicine ball at chest level.
Step forward with your right foot and simultaneously push the medicine ball forward, extending your arms fully.
As you push the ball forward, release it and let it roll forward.
Quickly run forward and catch the ball before it hits the ground.
Once you catch the ball, bring it back to your chest and repeat the movement with your left foot forward.
Continue alternating legs and repeating the exercise for the desired number of repetitions.`},{name:"medicine ball close grip push up",bodyPart:"upper arms",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/i1bEFy9Bo3KShV",id:1701,target:"triceps",instructions:`Start in a high plank position with your hands on the medicine ball, shoulder-width apart.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
Push back up to the starting position, fully extending your arms.
Repeat for the desired number of repetitions.`},{name:"medicine ball overhead slam",bodyPart:"back",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/2344E888OIrEKL",id:1354,target:"upper back",instructions:`Stand with your feet shoulder-width apart, holding a medicine ball with both hands above your head.
Engage your core and keep your back straight.
Bend your knees slightly and forcefully slam the medicine ball down to the ground in front of you.
As you slam the ball down, use your entire body to generate power, including your shoulders and core.
Catch the ball on the bounce and repeat for the desired number of repetitions.`},{name:"medicine ball supine chest throw",bodyPart:"upper arms",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/im-efBMJe2OmmS",id:1750,target:"triceps",instructions:`Lie flat on your back on a bench with your knees bent and feet flat on the ground.
Hold the medicine ball with both hands, extending your arms straight up above your chest.
Lower the medicine ball towards your chest, keeping your elbows close to your body.
Explosively push the medicine ball upwards, extending your arms fully and throwing the ball as high as possible.
Catch the medicine ball and repeat for the desired number of repetitions.`},{name:"mixed grip chin-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/dJnDF2Y7j-FAbz",id:627,target:"lats",instructions:`Grab the pull-up bar with an underhand grip (palms facing towards you) and your hands slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your feet off the ground.
Engage your back muscles and pull your body up towards the bar, leading with your chest.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position with control.
Repeat for the desired number of repetitions.`},{name:"modified hindu push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/EoIBZb4OkkF-0z",id:3217,target:"pectorals",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet hip-width apart.
Lower your body towards the ground, bending your elbows and keeping your core engaged.
As you lower your body, shift your weight back and lift your hips up towards the ceiling, creating an inverted V shape with your body.
Continue to lower your body until your chest is just above the ground, then reverse the movement, pushing your hips back down and extending your arms to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"modified push up to lower arms",bodyPart:"lower arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-h6n0WGs72gl9Y",id:1421,target:"forearms",instructions:`Start in a push-up position with your hands directly under your shoulders and your body in a straight line.
Lower your body down towards the ground by bending your elbows, keeping them close to your sides.
Once your elbows are at a 90-degree angle, lower your forearms to the ground, keeping your elbows directly under your shoulders.
Pause for a moment, then push through your palms to lift your forearms back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"monster walk",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/i8zUuKJxqKB5tX",id:628,target:"glutes",instructions:`Place a resistance band around your ankles.
Stand with your feet shoulder-width apart and slightly bend your knees.
Take a step to the side with your right foot, maintaining tension on the resistance band.
Follow with your left foot, stepping to the side to return to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"mountain climber",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ApvOB1UkjyV27x",id:630,target:"cardiovascular system",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line.
Engage your core and bring your right knee towards your chest, then quickly switch and bring your left knee towards your chest.
Continue alternating legs in a running motion, keeping your hips low and your core engaged.
Maintain a steady pace and breathe evenly throughout the exercise.
Repeat for the desired number of repetitions.`},{name:"muscle up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Ui-kMsvfNUx9-y",id:631,target:"lats",instructions:`Start by hanging from a pull-up bar with your palms facing away from you and your arms fully extended.
Engage your core and pull your body up towards the bar, leading with your chest.
As you reach the top of the movement, transition your grip so that your palms are facing towards you.
Continue pulling yourself up until your chest is above the bar and your arms are fully flexed.
Reverse the movement by slowly lowering yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"muscle-up (on vertical bar)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/E0NFFZrfL4WiQj",id:1401,target:"lats",instructions:`Start by hanging from a vertical bar with your palms facing away from you and your arms fully extended.
Engage your core and pull your body up towards the bar, leading with your chest.
As you pull yourself up, lean back slightly and bring your elbows towards your sides.
Continue pulling until your chest reaches the bar and your elbows are fully bent.
Pause for a moment at the top, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"narrow push-up on exercise ball",bodyPart:"upper arms",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/TfGhdvcsg2Hmvq",id:2328,target:"triceps",instructions:`Place the stability ball on the ground and position yourself in a push-up position with your hands on the ball, slightly narrower than shoulder-width apart.
Engage your core and keep your body in a straight line from head to toe.
Lower your chest towards the ball by bending your elbows, keeping them close to your body.
Pause for a moment at the bottom, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"negative crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/KRwNLu7rml42vc",id:634,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"oblique crunch v. 2",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/H-ZDX0UgQ1M3nl",id:1495,target:"abs",instructions:`Lie on your back with your knees bent and feet flat on the ground.
Place your hands behind your head or cross them over your chest.
Engage your abs and lift your shoulder blades off the ground, rotating your torso to one side.
Pause for a moment, then lower your shoulder blades back down to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"oblique crunches floor",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PUAmHptHARqFgg",id:635,target:"abs",instructions:`Lie on your back with your knees bent and feet flat on the floor.
Place your hands behind your head or cross them over your chest.
Engage your abs and lift your shoulder blades off the floor, rotating your torso to one side.
Pause for a moment, then lower your shoulder blades back down to the floor.
Repeat on the other side, alternating sides with each repetition.`},{name:"one arm against wall",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/U90tSCkI34trGa",id:1355,target:"lats",instructions:`Stand facing a wall with your feet shoulder-width apart.
Extend one arm straight out in front of you and place your palm against the wall.
Engage your core and lean your body forward, keeping your arm straight and your back flat.
Slowly push against the wall with your palm, activating your lat muscles.
Hold the position for a few seconds, then release and repeat with the other arm.`},{name:"one arm chin-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/AMv9vFyNT2eNTb",id:638,target:"lats",instructions:`Stand facing a pull-up bar with your feet shoulder-width apart.
Reach up and grab the bar with an underhand grip, with one hand gripping the bar and the other hand holding your wrist for support.
Hang from the bar with your arm fully extended, keeping your body straight and your core engaged.
Pull yourself up towards the bar by bending your elbow and squeezing your back muscles.
Continue pulling until your chin is above the bar, then slowly lower yourself back down to the starting position.
Repeat for the desired number of repetitions, then switch arms and repeat.`},{name:"one arm dip",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/SV56LFHMMQs6Io",id:639,target:"triceps",instructions:`Stand facing away from a bench or chair, with your feet shoulder-width apart.
Place one hand on the bench or chair behind you, fingers pointing towards your body.
Extend your legs out in front of you, keeping your heels on the ground.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench or chair.
Pause for a moment at the bottom, then push through your palms to straighten your arms and return to the starting position.
Repeat for the desired number of repetitions, then switch sides and repeat with the other arm.`},{name:"one arm slam (with medicine ball)",bodyPart:"waist",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/W4j35mGrNywULC",id:640,target:"abs",instructions:`Stand with your feet shoulder-width apart, holding the medicine ball with one hand in front of your waist.
Bend your knees slightly and engage your core.
Raise the medicine ball above your head, fully extending your arm.
Forcefully slam the medicine ball down to the ground, using your core and shoulders to generate power.
Catch the medicine ball on the bounce and repeat for the desired number of repetitions.`},{name:"one arm towel row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/-teonHtRgR0Mc2",id:1773,target:"upper back",instructions:`Stand with your feet shoulder-width apart, knees slightly bent, and hold a towel with one hand.
Bend forward at the waist, keeping your back straight and your core engaged.
Extend your arm fully, allowing the towel to hang in front of you.
Pull the towel towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower the towel back to the starting position.
Repeat for the desired number of repetitions, then switch arms.`},{name:"one leg donkey calf raise",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/l78aTkOiRWbwmg",id:1386,target:"calves",instructions:`Stand with your feet shoulder-width apart, toes pointing forward.
Place your hands on a stable surface for support, such as a wall or a bar.
Lift one leg off the ground, keeping your knee slightly bent.
Raise your heel as high as possible, using your calf muscles.
Pause for a moment at the top, then slowly lower your heel back down.
Repeat for the desired number of repetitions, then switch legs.`},{name:"one leg floor calf raise",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/l3wMrqMgVN2Aek",id:1387,target:"calves",instructions:`Stand with your feet hip-width apart and place your hands on a wall or sturdy object for balance.
Lift one foot off the ground and balance on the other foot.
Slowly raise your heel off the ground, lifting your body up onto the ball of your foot.
Pause for a moment at the top, then slowly lower your heel back down to the starting position.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"one leg squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aqMaeMPVqD2b2i",id:1476,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Extend one leg forward, keeping it off the ground.
Bend your standing leg and lower your body down as if sitting back into a chair.
Keep your chest up and your back straight.
Push through your heel to return to the starting position.
Repeat with the other leg.`},{name:"outside leg kick push-up",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Dl878JqyqTry1q",id:642,target:"glutes",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet together.
Lower your body towards the ground by bending your elbows, keeping your back straight and core engaged.
As you push back up, kick one leg out to the side, extending it fully and engaging your glutes.
Return your leg to the starting position and repeat the push-up, alternating legs with each repetition.
Continue alternating leg kicks and push-ups for the desired number of repetitions.`},{name:"overhead triceps stretch",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/1-pXCFvgcRa5pC",id:643,target:"triceps",instructions:`Stand or sit upright with your feet shoulder-width apart.
Extend one arm overhead, bending at the elbow so that your hand reaches towards the opposite shoulder blade.
With your other hand, gently pull the elbow of the extended arm towards the opposite side of your head, feeling a stretch in your triceps.
Hold the stretch for 15-30 seconds, then release.
Repeat on the other side.`},{name:"pelvic tilt",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/jYXSu6jFrDRYpk",id:3147,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands by your sides.
Engage your abs and tilt your pelvis upward, pressing your lower back into the ground.
Hold this position for a few seconds, focusing on contracting your abs.
Release the tilt and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"pelvic tilt into bridge",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/EHvK0vQiWo00Dx",id:1422,target:"glutes",instructions:`Lie on your back with your knees bent and feet flat on the ground.
Place your arms by your sides with your palms facing down.
Engage your glutes and core muscles.
Tilt your pelvis upward, lifting your hips off the ground.
Hold the bridge position for a few seconds.
Slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"pike-to-cobra push-up",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/v1DxpcjSqMDoXw",id:3662,target:"glutes",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet together.
Engage your core and lift your hips up towards the ceiling, forming an inverted V shape with your body.
Lower your upper body towards the ground by bending your elbows, keeping them close to your body.
As you lower down, shift your weight forward and transition into a cobra pose by straightening your arms and lifting your chest up.
Reverse the movement by bending your elbows and lowering your chest back down towards the ground.
Push through your hands to return to the inverted V position.
Continue the movement by lowering your hips back down towards the ground, returning to the starting push-up position.
Repeat for the desired number of repetitions.`},{name:"plyo push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/CSzq3lLPSiVu2A",id:1306,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart.
Lower your chest towards the ground by bending your elbows, keeping your body in a straight line.
Push explosively off the ground, using your chest muscles to propel your upper body off the ground.
Land softly with your hands back in the starting position.
Repeat for the desired number of repetitions.`},{name:"posterior step to overhead reach",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/g8wVaNe3OlAEtH",id:1687,target:"abs",instructions:`Stand with your feet hip-width apart and your arms by your sides.
Take a step back with your right foot, landing on the ball of your foot.
Bend your left knee and lower your body into a lunge position.
As you lower into the lunge, simultaneously reach your arms overhead.
Pause for a moment at the bottom of the lunge, then return to the starting position by pushing through your left heel and bringing your right foot forward.
Repeat the movement on the other side, stepping back with your left foot and bending your right knee.
Continue alternating sides for the desired number of repetitions.`},{name:"potty squat",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/BIZRwfN83fAocL",id:3119,target:"abs",instructions:`Stand with your feet shoulder-width apart, toes pointing slightly outward.
Lower your body down by bending your knees and pushing your hips back as if you were sitting on a chair.
Keep your chest up and your back straight throughout the movement.
Lower yourself until your thighs are parallel to the ground or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"potty squat with support",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/T2aepqG7NIGMvN",id:3132,target:"glutes",instructions:`Stand with your feet shoulder-width apart, toes pointing slightly outward.
Hold onto a stable support, such as a chair or wall, for balance.
Lower your body down into a squat position by bending your knees and pushing your hips back.
Keep your chest up and your back straight throughout the movement.
Pause for a moment at the bottom, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"power point plank",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/jdhiAUuZY4oORs",id:3665,target:"abs",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line from head to toe.
Engage your core and squeeze your glutes to maintain a stable position.
Lower your body down onto your forearms, one arm at a time, maintaining a straight line from head to toe.
Hold this position for the desired amount of time, keeping your core and glutes engaged.
To return to the starting position, push through your forearms and lift your body back up into a high plank position.
Repeat for the desired number of repetitions.`},{name:"prisoner half sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Vwr9fpkCAJhlkt",id:3203,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"prone twist on stability ball",bodyPart:"waist",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/hkfWpYSmETT7SD",id:1707,target:"abs",instructions:`Start by lying face down on a stability ball with your feet shoulder-width apart and your toes touching the ground.
Place your hands behind your head or cross them over your chest.
Engage your core muscles and slowly lift your upper body off the ball, keeping your back straight.
Rotate your torso to one side, bringing your shoulder towards your hip. Keep your hips and legs stable throughout the movement.
Pause for a moment, then return to the starting position.
Repeat the rotation to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"pull up (neutral grip)",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ZVzZy30UK6TE2R",id:651,target:"lats",instructions:`Hang from a pull-up bar with a neutral grip (palms facing each other) and your arms fully extended.
Engage your core and squeeze your shoulder blades together.
Pull your body up towards the bar by bending your elbows and driving your elbows down towards your hips.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position with control.
Repeat for the desired number of repetitions.`},{name:"pull-in (on stability ball)",bodyPart:"waist",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/FKyiAjINNjUf5H",id:650,target:"abs",instructions:`Start by sitting on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Place your hands on the sides of the stability ball for support.
Engage your abs and slowly roll your hips forward, bringing your knees towards your chest.
Pause for a moment at the top of the movement, then slowly extend your legs back to the starting position.
Repeat for the desired number of repetitions.`},{name:"pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4UWZKpyY6R9loy",id:652,target:"lats",instructions:`Hang from a pull-up bar with your palms facing away from you and your arms fully extended.
Engage your core and squeeze your shoulder blades together.
Pull your body up towards the bar by bending your elbows and bringing your chest towards the bar.
Pause at the top of the movement, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"push and pull bodyweight",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/pBYaBOUwdN9Jad",id:1689,target:"pectorals",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your body in a straight line.
Lower your chest towards the ground by bending your elbows, keeping your body straight.
Push through your palms to extend your arms and return to the starting position.
From the push-up position, pull your chest towards the ground by bending your elbows, keeping your body straight.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"push to run",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/0h3tHJVmJq2hsS",id:3638,target:"cardiovascular system",instructions:`Start in a push-up position with your hands shoulder-width apart and your body in a straight line.
Lower your chest towards the ground by bending your elbows, keeping your body straight.
Push through your hands to extend your arms and return to the starting position.
Quickly bring one knee towards your chest, then quickly switch and bring the other knee towards your chest.
Continue alternating knees as fast as you can while maintaining good form.
Continue for the desired duration or number of repetitions.`},{name:"push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/28IMgfFEImtSia",id:662,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your feet together.
Engage your core and lower your body towards the ground by bending your elbows, keeping your body in a straight line.
Pause for a moment when your chest is just above the ground, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"push-up (on stability ball)",bodyPart:"chest",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/d46XYcNEz79cah",id:656,target:"pectorals",instructions:`Place the stability ball on the ground and position yourself facing down with your hands on the ball, shoulder-width apart.
Extend your legs straight out behind you, balancing on your toes.
Engage your core and lower your chest towards the ball by bending your elbows, keeping your body in a straight line.
Pause for a moment at the bottom, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"push-up (wall)",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ofs5iaoOESrQqL",id:659,target:"pectorals",instructions:`Stand facing a wall, about arm's length away.
Place your hands on the wall at shoulder height, slightly wider than shoulder-width apart.
Step back a few feet, keeping your body straight and your feet hip-width apart.
Bend your elbows and lower your chest towards the wall, keeping your body in a straight line.
Push back up to the starting position, straightening your arms.
Repeat for the desired number of repetitions.`},{name:"push-up (wall) v. 2",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/NxyOWOypzXY-cn",id:658,target:"pectorals",instructions:`Stand facing a wall, about arm's length away.
Place your hands on the wall at shoulder height, slightly wider than shoulder-width apart.
Step back with your feet, keeping them hip-width apart.
Engage your core and keep your body in a straight line from head to heels.
Bend your elbows and lower your chest towards the wall, keeping your body straight.
Pause for a moment, then push yourself back to the starting position.
Repeat for the desired number of repetitions.`},{name:"push-up close-grip off dumbbell",bodyPart:"upper arms",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/3MUHPSAk872GR1",id:660,target:"triceps",instructions:`Start in a push-up position with your hands placed close together, directly under your shoulders.
Hold a dumbbell in each hand, resting them on the ground.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"push-up inside leg kick",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3zVrRWtvNSWi-R",id:661,target:"glutes",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet together.
Lower your body towards the ground by bending your elbows, keeping your back straight and your core engaged.
As you push back up, lift one leg off the ground and kick it out to the side, keeping it straight.
Lower your leg back down and repeat the push-up, then switch to the other leg.
Continue alternating leg kicks with each push-up repetition.`},{name:"push-up medicine ball",bodyPart:"chest",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/gTfW7-sNwHLSIH",id:663,target:"pectorals",instructions:`Start in a high plank position with your hands on the medicine ball, shoulder-width apart.
Engage your core and lower your body towards the ground by bending your elbows, keeping your back straight.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"push-up on lower arms",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/b7JWvBDkr7QDu-",id:1467,target:"triceps",instructions:`Start in a plank position with your forearms on the ground and elbows directly below your shoulders.
Engage your core and keep your body in a straight line from head to toe.
Lower your chest towards the ground by bending your elbows, keeping them close to your body.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"push-up plus",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/0GQHQPUgbbXqHZ",id:3145,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your body in a straight line from head to heels.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
Once your chest is just above the ground, push through your hands to extend your arms and lift your upper body up.
At the top of the movement, protract your shoulder blades by pushing your upper back towards the ceiling.
Pause for a moment, then reverse the movement by retracting your shoulder blades and lowering your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"push-up to side plank",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/oNliBtWoSeVXZ-",id:664,target:"abs",instructions:`Start in a push-up position with your hands shoulder-width apart and your body in a straight line.
Lower your body towards the ground by bending your elbows, keeping your core engaged.
Push back up to the starting position.
Shift your weight onto your left hand and rotate your body to the right, lifting your right arm towards the ceiling.
Hold the side plank position for a few seconds, then return to the starting position.
Repeat the push-up and side plank on the opposite side.
Continue alternating sides for the desired number of repetitions.`},{name:"quads",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/D6rFvJdJG0WaU0",id:3533,target:"quads",instructions:`Stand with your feet shoulder-width apart.
Lower your body by bending your knees and pushing your hips back as if sitting on a chair.
Keep your chest up and your back straight.
Lower yourself until your thighs are parallel to the ground.
Push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"quarter sit-up",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PZwwMiHExHyh39",id:3201,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"quick feet v. 2",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ROHvlaaRcSV1sx",id:3552,target:"quads",instructions:`Stand with your feet shoulder-width apart and your arms by your sides.
Begin by rapidly moving your feet up and down, as if you were running in place.
Keep your movements quick and light, focusing on staying on the balls of your feet.
Continue for the desired duration or number of repetitions.`},{name:"raise single arm push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/zwltzURAgN2AN4",id:666,target:"pectorals",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet together.
Extend one arm straight out to the side, parallel to the ground.
Lower your body towards the ground by bending your elbows, keeping your back straight and core engaged.
Push back up to the starting position, using your chest muscles to lift your body.
Repeat with the other arm extended.`},{name:"rear decline bridge",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xZhiTwdP6gjzPr",id:668,target:"glutes",instructions:`Lie on your back with your feet flat on the ground and your knees bent.
Place your arms by your sides with your palms facing down.
Engage your glutes and hamstrings, and lift your hips off the ground until your body forms a straight line from your knees to your shoulders.
Hold this position for a few seconds, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"rear deltoid stretch",bodyPart:"shoulders",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/1GUFg7oDTeyFIM",id:669,target:"delts",instructions:`Stand tall with your feet shoulder-width apart.
Extend your right arm across your chest, placing your left hand on your right elbow.
Gently pull your right arm towards your left shoulder, feeling a stretch in your right shoulder.
Hold the stretch for 15-30 seconds, then release.
Repeat on the other side.`},{name:"rear pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/pqQRytXLBmTCFf",id:670,target:"lats",instructions:`Grab the pull-up bar with an overhand grip, slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your body straight.
Engage your back muscles and pull your body up towards the bar, keeping your elbows close to your body.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"resistance band hip thrusts on knees",bodyPart:"upper legs",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/-on9pA1w1HgpAK",id:3236,target:"glutes",instructions:`Start by kneeling on the ground with your knees hip-width apart and your feet flexed.
Wrap the resistance band around your thighs, just above your knees.
Place your hands on your hips or extend them out in front of you for balance.
Engage your glutes and core muscles.
Push your hips forward and squeeze your glutes as you lift your knees off the ground, extending your hips until your thighs are parallel to the ground.
Hold the position for a moment, then slowly lower your knees back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"resistance band leg extension",bodyPart:"upper legs",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/aBWHk7foj4aO3U",id:3007,target:"quads",instructions:`Attach the resistance band to a sturdy anchor point and secure it around your ankle.
Stand facing the anchor point with your feet shoulder-width apart.
Keeping your core engaged and your upper body stable, extend your leg straight out in front of you.
Pause for a moment at the top, then slowly return your leg to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"resistance band seated biceps curl",bodyPart:"upper arms",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/tTll04PYnFAz1L",id:3123,target:"biceps",instructions:`Sit on a chair or bench with your back straight and feet flat on the ground.
Hold the resistance band with an underhand grip, palms facing up, and arms extended down by your sides.
Keeping your upper arms stationary, exhale and curl the resistance band up towards your shoulders.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the resistance band back to the starting position.
Repeat for the desired number of repetitions.`},{name:"resistance band seated chest press",bodyPart:"chest",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/4aIVYZe9Xpm6pm",id:3124,target:"pectorals",instructions:`Sit on a chair or bench with your back straight and feet flat on the ground.
Hold the resistance band handles in each hand, with your palms facing down and elbows bent at a 90-degree angle.
Extend your arms forward, pushing the resistance band away from your chest.
Pause for a moment at the end of the movement, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"resistance band seated hip abduction",bodyPart:"upper legs",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/uaVvvlrFSUUvzU",id:3006,target:"abductors",instructions:`Sit on a chair or bench with your back straight and feet flat on the ground.
Wrap the resistance band around your thighs, just above your knees.
Place your hands on the sides of the chair or bench for support.
Engage your abductors (outer thigh muscles) and slowly push your knees apart, against the resistance of the band.
Pause for a moment at the end of the movement, then slowly bring your knees back together.
Repeat for the desired number of repetitions.`},{name:"resistance band seated shoulder press",bodyPart:"shoulders",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/7raOxPNEpPAj9e",id:3122,target:"delts",instructions:`Sit on a chair or bench with your back straight and feet flat on the ground.
Hold the resistance band with both hands, palms facing forward, and bring it up to shoulder level.
Press the band overhead, extending your arms fully.
Pause for a moment at the top, then slowly lower the band back down to shoulder level.
Repeat for the desired number of repetitions.`},{name:"resistance band seated straight back row",bodyPart:"back",equipment:"resistance band",gifUrl:"https://v2.exercisedb.io/image/WwO5UPBy15x-lP",id:3144,target:"upper back",instructions:`Sit on the floor with your legs extended and loop the resistance band around your feet.
Hold the ends of the resistance band with your hands, palms facing each other.
Keep your back straight and lean slightly back, engaging your core.
Pull the resistance band towards your chest, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly release the tension and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"reverse crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4VtpE904S08wat",id:872,target:"abs",instructions:`Lie flat on your back with your arms extended along your sides.
Bend your knees and lift your feet off the ground, bringing your thighs perpendicular to the floor.
Contract your abs and curl your hips off the floor, bringing your knees towards your chest.
Pause for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"reverse dip",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4XRvmX6bnNaqVB",id:672,target:"triceps",instructions:`Position yourself between two parallel bars with your arms fully extended and your body straight.
Lower your body by bending your elbows until your upper arms are parallel to the ground.
Pause for a moment, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"reverse grip pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/gMDhBT0rDm3wAQ",id:674,target:"lats",instructions:`Grab the pull-up bar with an underhand grip, hands shoulder-width apart.
Hang from the bar with your arms fully extended and your body straight.
Engage your back muscles and pull your body up towards the bar, leading with your chest.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"reverse hyper extension (on stability ball)",bodyPart:"upper legs",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/PSUYO0QlKtNcLV",id:675,target:"glutes",instructions:`Lie face down on a stability ball with your hips resting on the ball and your legs extended straight behind you.
Place your hands on the ground in front of you for stability.
Engaging your glutes and hamstrings, lift your legs up towards the ceiling as high as you can.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"reverse hyper on flat bench",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ytDWkwLXOZMPCN",id:1423,target:"glutes",instructions:`Lie face down on a flat bench with your hips at the edge and your legs hanging off the bench.
Hold onto the bench for stability.
Keeping your legs straight, raise them up towards the ceiling as high as you can.
Squeeze your glutes at the top of the movement.
Slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"reverse plank with leg lift",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/g7hm9FgZnZ06WX",id:3663,target:"abs",instructions:`Sit on the ground with your legs extended in front of you and your hands resting on the ground behind you, fingers pointing towards your feet.
Press through your hands and lift your hips off the ground, coming into a reverse plank position.
Engage your core and lift one leg off the ground, extending it straight up towards the ceiling.
Hold for a moment, then lower your leg back down.
Repeat with the other leg.
Continue alternating legs for the desired number of repetitions.`},{name:"ring dips",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Uo1fDa9PKneGfG",id:677,target:"triceps",instructions:`Start by hanging from the rings with your arms fully extended and your body straight.
Lower your body by bending your elbows until your shoulders are below your elbows.
Push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"rocking frog stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/m-eQb5fz5-rzkQ",id:2571,target:"glutes",instructions:`Start by kneeling on the ground with your knees hip-width apart.
Place your hands on the ground in front of you for support.
Slowly lean forward, shifting your weight onto your hands and extending your legs behind you.
Keep your back straight and engage your glutes as you push your hips back and up towards the ceiling.
Hold this position for a few seconds, feeling a stretch in your glutes.
Slowly return to the starting position by bending your knees and lowering your hips back down.
Repeat for the desired number of repetitions.`},{name:"rocky pull-up pulldown",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/kWeYfe5BIPLr6s",id:678,target:"lats",instructions:`Stand in front of a pull-up bar with your feet shoulder-width apart.
Reach up and grab the bar with an overhand grip, slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your body straight.
Engage your back muscles and pull your body up towards the bar, leading with your chest.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"run",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/VFt0lIgr-jCxZy",id:685,target:"cardiovascular system",instructions:`Start by standing upright with your feet hip-width apart.
Engage your core and keep your upper body relaxed.
Begin jogging in place, lifting your knees up towards your chest and landing softly on the balls of your feet.
Maintain a steady pace and continue jogging for the desired duration or distance.
Remember to breathe deeply and maintain good posture throughout the exercise.`},{name:"run (equipment)",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xbwhTUl9kOYI41",id:684,target:"cardiovascular system",instructions:`Start by standing upright with your feet hip-width apart.
Engage your core and keep your upper body relaxed.
Begin jogging in place, lifting your knees up towards your chest and landing softly on the balls of your feet.
Maintain a steady pace and continue jogging for the desired duration or distance.
Remember to breathe deeply and maintain good posture throughout the exercise.`},{name:"runners stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/IF77kgkpNUDGWX",id:1585,target:"hamstrings",instructions:`Stand with your feet hip-width apart.
Take a step forward with your right foot, keeping your left foot planted.
Bend your right knee and lower your body down, keeping your left leg straight.
Place your hands on your right thigh for support.
Hold the stretch for 20-30 seconds, then switch sides and repeat.`},{name:"russian twist",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/9VFCSf3mivcVAf",id:687,target:"abs",instructions:`Sit on the ground with your knees bent and feet flat on the floor.
Lean back slightly while keeping your back straight and your core engaged.
Hold your hands together in front of your chest or hold a weight if desired.
Lift your feet off the ground, balancing on your sit bones.
Twist your torso to the right, bringing your hands or weight towards the right side of your body.
Pause for a moment, then twist your torso to the left, bringing your hands or weight towards the left side of your body.
Continue alternating sides for the desired number of repetitions.`},{name:"scapula dips",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/IdlawHnlinW6Xy",id:3012,target:"traps",instructions:`Start by standing with your feet shoulder-width apart and your arms extended in front of you.
Bend your knees slightly and hinge forward at the hips, keeping your back straight.
Lower your body by bending your elbows and retracting your shoulder blades, as if you are trying to squeeze a pencil between them.
Pause for a moment at the bottom, then push through your hands to extend your elbows and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"scapula push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/bGKl-iQqRfJA4S",id:3021,target:"serratus anterior",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line.
Lower your chest towards the ground, keeping your elbows close to your body.
As you lower, squeeze your shoulder blades together and push your chest forward.
Pause for a moment at the bottom, then push back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"scapular pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/lhfyUzWOi9mo9K",id:688,target:"traps",instructions:`Start by hanging from a pull-up bar with your palms facing away from you and your arms fully extended.
Retract your shoulder blades by pulling them down and back.
Engage your back muscles and pull your body up towards the bar, focusing on squeezing your shoulder blades together.
Pause for a moment at the top of the movement, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"scissor jumps",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WXtR3gCE1o1xbs",id:3219,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Jump off the ground and simultaneously cross your right leg in front of your left leg.
As you land, quickly switch legs, crossing your left leg in front of your right leg.
Continue alternating legs and jumping as quickly as possible.
Repeat for the desired number of repetitions.`},{name:"seated calf stretch",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/8NcdD7K2pm5TUi",id:1390,target:"calves",instructions:`Sit on the edge of a chair or bench with your feet flat on the ground.
Extend one leg straight out in front of you, keeping your heel on the ground.
Lean forward slightly, feeling a stretch in your calf muscle.
Hold the stretch for 20-30 seconds.
Switch legs and repeat the stretch.`},{name:"seated glute stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/d-oAX4BZXn8rIA",id:1424,target:"glutes",instructions:`Sit on the ground with your legs extended in front of you.
Bend your right knee and cross your right ankle over your left thigh.
Place your right hand on the ground behind you for support.
With your left hand, gently press down on your right knee to deepen the stretch.
Hold the stretch for 30 seconds to 1 minute.
Switch sides and repeat.`},{name:"seated leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/ImgoPSC-GaUW7t",id:689,target:"abs",instructions:`Sit on a flat bench with your back straight and your feet flat on the ground.
Place your hands on the sides of the bench for support.
Keeping your legs straight, slowly raise them up in front of you until they are parallel to the ground.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"seated lower back stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4diyaNDAUftC4E",id:690,target:"lats",instructions:`Sit on the edge of a chair with your feet flat on the ground.
Place your hands on your thighs or on the sides of the chair for support.
Slowly lean forward from your hips, keeping your back straight.
Feel the stretch in your lower back and hold for 20-30 seconds.
Slowly return to the starting position and repeat for the desired number of repetitions.`},{name:"seated piriformis stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6U5LtFNpgGYEvJ",id:2567,target:"glutes",instructions:`Sit on the ground with your legs extended in front of you.
Bend your right knee and place your right foot on the outside of your left knee.
Place your left elbow on the outside of your right knee and gently twist your torso to the right.
Hold the stretch for 20-30 seconds, then switch sides and repeat.`},{name:"seated side crunch (wall)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/okW38HBXW5DlA6",id:691,target:"abs",instructions:`Sit on the floor with your back against a wall and your legs extended in front of you.
Bend your knees and place your feet flat on the floor, hip-width apart.
Place your hands behind your head with your elbows pointing outwards.
Engage your abs and lean to one side, bringing your elbow towards your hip.
Pause for a moment, then return to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"seated wide angle pose sequence",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/yOP7Bte2n7hXZE",id:1587,target:"hamstrings",instructions:`Sit on the ground with your legs extended in a wide angle.
Flex your feet and engage your quadriceps.
Place your hands on the ground behind you for support.
Keeping your back straight, lean forward from your hips.
Continue leaning forward until you feel a stretch in your hamstrings.
Hold this position for a few breaths.
Slowly release the stretch and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"self assisted inverse leg curl",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WrrVimjnpREqhU",id:697,target:"hamstrings",instructions:`Lie flat on your back on a mat or bench with your legs extended.
Place your hands by your sides or under your glutes for support.
Bend your knees and lift your feet off the ground, bringing your thighs towards your chest.
Pause for a moment at the top, then slowly lower your legs back to the starting position.
Repeat for the desired number of repetitions.`},{name:"self assisted inverse leg curl",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Y6o5WKug3PI6hF",id:1766,target:"hamstrings",instructions:`Lie face down on a leg curl machine with your legs extended and your ankles hooked under the padded lever.
Place your hands on the side handles of the machine for support.
Keeping your upper body stationary, exhale and curl your legs upward as far as possible.
Hold the contracted position for a brief pause as you squeeze your hamstrings.
Slowly lower your legs back to the starting position while inhaling.
Repeat for the desired number of repetitions.`},{name:"self assisted inverse leg curl (on floor)",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/QeqzOBinb0eK7S",id:696,target:"hamstrings",instructions:`Lie flat on your back with your legs extended and your arms by your sides.
Bend your knees and place your feet flat on the ground, hip-width apart.
Lift your hips off the ground, engaging your glutes and hamstrings.
Slowly curl your legs towards your glutes, keeping your hips lifted.
Pause for a moment at the top, then slowly extend your legs back to the starting position.
Lower your hips back down to the ground.
Repeat for the desired number of repetitions.`},{name:"semi squat jump",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aIP773KhN9n6nJ",id:3222,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Bend your knees and lower your body into a squat position.
Jump explosively, extending your hips and knees while swinging your arms for momentum.
Land softly on the balls of your feet and immediately go into the next repetition.
Repeat for the desired number of repetitions.`},{name:"short stride run",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3DDbYZkuRhcDOj",id:3656,target:"cardiovascular system",instructions:`Find an open space or a treadmill to perform the exercise.
Stand tall with your feet hip-width apart.
Start jogging in place, lifting your knees high and pumping your arms.
After a few seconds, start taking short strides forward, maintaining a quick pace.
Continue running with short strides for the desired duration or distance.`},{name:"shoulder grip pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/IYRZHG0LuRY8Iu",id:1763,target:"lats",instructions:`Grab the pull-up bar with a shoulder-width grip, palms facing away from you.
Hang freely with your arms fully extended.
Engage your back muscles and pull your body up towards the bar until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"shoulder tap",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/JXGF2luF3P3N3b",id:3699,target:"abs",instructions:`Start in a high plank position with your hands directly under your shoulders and your body in a straight line.
Engage your core and lift your right hand off the ground, reaching across to tap your left shoulder.
Place your right hand back on the ground and repeat with your left hand tapping your right shoulder.
Continue alternating shoulder taps while keeping your hips and torso stable.
Repeat for the desired number of repetitions.`},{name:"shoulder tap push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/vOyAjLy0KNhmNX",id:699,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your body in a straight line from head to heels.
Lower your body towards the ground by bending your elbows, keeping them close to your sides.
As you push back up, lift your right hand off the ground and tap your left shoulder.
Return your right hand to the ground and repeat the push-up, this time lifting your left hand and tapping your right shoulder.
Continue alternating shoulder taps with each push-up repetition.
Maintain a stable core and avoid excessive hip rotation throughout the exercise.
Repeat for the desired number of repetitions.`},{name:"side bridge hip abduction",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/d2dbVNOF-w9c5f",id:1774,target:"abductors",instructions:`Lie on your side with your legs extended and stacked on top of each other.
Prop yourself up on your forearm, keeping your elbow directly below your shoulder.
Engage your core and lift your hips off the ground, creating a straight line from your head to your feet.
While keeping your core engaged, lift your top leg as high as possible without rotating your hips.
Pause for a moment at the top, then lower your leg back down.
Repeat for the desired number of repetitions, then switch sides.`},{name:"side bridge v. 2",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/A1VQmZrkz6vy86",id:705,target:"abs",instructions:`Lie on your side with your legs extended and stacked on top of each other.
Place your forearm on the ground directly below your shoulder, with your elbow bent at a 90-degree angle.
Engage your core and lift your hips off the ground, creating a straight line from your head to your feet.
Hold this position for the desired amount of time.
Lower your hips back down to the starting position.
Repeat on the other side.`},{name:"side hip (on parallel bars)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/OTzvtUmnwVpdys",id:709,target:"abs",instructions:`Stand between two parallel bars with your feet shoulder-width apart.
Place your hands on the bars and lift your body off the ground, supporting your weight on your arms.
Engage your abs and slowly lift your legs to the side, keeping them straight.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"side hip abduction",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/glIjnOxQHBguXf",id:710,target:"abductors",instructions:`Stand with your feet shoulder-width apart and your hands on your hips.
Shift your weight to one leg and lift the opposite leg out to the side, keeping it straight.
Pause for a moment at the top, then slowly lower your leg back down to the starting position.
Repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"side lying floor stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/RbXgSTFsh3KOOD",id:1358,target:"lats",instructions:`Lie on your side with your legs straight and your bottom arm extended straight overhead.
Bend your top knee and place your foot on the ground in front of your bottom leg.
Reach your top arm over your head and grab onto something stable, like a wall or a piece of furniture.
Slowly lift your bottom leg off the ground, keeping it straight, until you feel a stretch in your side.
Hold the stretch for 20-30 seconds, then slowly lower your leg back down.
Repeat on the other side.`},{name:"side lying hip adduction",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/HFC5XmNAdF39Bl",id:3667,target:"adductors",instructions:`Lie on your side with your legs straight and stacked on top of each other.
Place your bottom arm under your head for support.
Engage your adductors and lift your top leg as high as possible without rotating your hips or leaning backward.
Pause for a moment at the top, then slowly lower your leg back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"side plank hip adduction",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/fuRgKRbFPPWVXB",id:1775,target:"adductors",instructions:`Start by lying on your side with your legs extended and stacked on top of each other.
Prop yourself up on your forearm, keeping your elbow directly below your shoulder.
Engage your core and lift your hips off the ground, creating a straight line from your head to your feet.
While maintaining the side plank position, lift your top leg towards the ceiling, keeping it straight.
Slowly lower your leg back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"side push-up",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/GctFaSrcD677K7",id:717,target:"triceps",instructions:`Start by lying on your side with your legs extended and stacked on top of each other.
Place your bottom hand on the ground directly under your shoulder, fingers pointing forward.
Press through your bottom hand to lift your body off the ground, keeping your legs straight and your core engaged.
Extend your top arm straight up towards the ceiling, creating a straight line from your head to your heels.
Lower your body back down to the starting position with control.
Repeat for the desired number of repetitions, then switch sides.`},{name:"side wrist pull stretch",bodyPart:"lower arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/QoXGoALaH6XYqu",id:721,target:"forearms",instructions:`Stand with your feet shoulder-width apart and your arms extended in front of you.
Extend your right arm out to the side, parallel to the ground, with your palm facing down.
With your left hand, grab your right hand and gently pull it towards your body, feeling a stretch in your right forearm.
Hold the stretch for 15-30 seconds, then release.
Repeat on the other side.`},{name:"side-to-side chin",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/F8oB0GM2xuvV0x",id:720,target:"lats",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Grasp a pull-up bar with an overhand grip, hands slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your body relaxed.
Pull yourself up by bending your elbows and bringing your chin towards the bar, while keeping your body straight.
Once your chin is above the bar, lower yourself back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"side-to-side toe touch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/LuoYR-RnGqNDOS",id:3213,target:"abs",instructions:`Stand with your feet shoulder-width apart and your arms extended to the sides.
Bend at the waist to the right, reaching your right hand towards your right foot while keeping your left hand extended to the side.
Return to the starting position and then bend at the waist to the left, reaching your left hand towards your left foot while keeping your right hand extended to the side.
Repeat the side-to-side bending motion for the desired number of repetitions.`},{name:"single arm push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/cMrzcHaaF6gNlJ",id:725,target:"pectorals",instructions:`Start in a push-up position with your hands shoulder-width apart and one hand placed slightly wider than the other.
Engage your core and lower your body towards the ground by bending your elbows, keeping your back straight.
As you lower yourself, shift your weight to one side and lift the opposite arm off the ground, extending it straight out to the side.
Push through your chest and triceps to raise your body back up to the starting position, while simultaneously lowering your extended arm back to the ground.
Repeat the movement, alternating the arm you extend with each repetition.`},{name:"single leg bridge with outstretched leg",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3PfsviHiagT7F5",id:3645,target:"glutes",instructions:`Lie on your back with your knees bent and feet flat on the ground.
Extend one leg straight out in front of you.
Engage your glutes and lift your hips off the ground, forming a straight line from your knees to your shoulders.
Hold for a moment at the top, then slowly lower your hips back down to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"single leg calf raise (on a dumbbell)",bodyPart:"lower legs",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/tMivqE42RzmEyx",id:727,target:"calves",instructions:`Stand with your feet hip-width apart and hold a dumbbell in one hand.
Lift one foot off the ground and balance on the other foot.
Slowly raise your heel as high as possible, using your calf muscles.
Pause for a moment at the top, then slowly lower your heel back down.
Repeat for the desired number of repetitions, then switch to the other leg.`},{name:"single leg platform slide",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/sTHhNisUrzARL7",id:730,target:"hamstrings",instructions:`Start by standing with one foot on a platform or slide board.
Bend your knee slightly and slide the foot on the platform backward, extending your leg.
Keep your core engaged and maintain a straight posture throughout the movement.
Slowly return to the starting position by sliding your foot back to the initial position.
Repeat the movement for the desired number of repetitions, then switch legs.`},{name:"single leg squat (pistol) male",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/kGjeo5DTt6O8n0",id:1759,target:"glutes",instructions:`Stand with your feet shoulder-width apart and arms extended in front of you.
Lift your right foot off the ground and extend it forward.
Slowly lower your body down by bending your left knee and pushing your hips back.
Keep your chest up and your back straight as you lower yourself down.
Lower until your left thigh is parallel to the ground, or as low as you can comfortably go.
Pause for a moment at the bottom, then push through your left heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"sissy squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/4bi8fXuvzCr1mU",id:1489,target:"quads",instructions:`Stand with your feet shoulder-width apart and your toes pointing slightly outward.
Hold onto a stable object for balance if needed.
Slowly lower your body by bending your knees and leaning back, keeping your torso upright.
Continue lowering until your thighs are parallel to the ground or as far as you can comfortably go.
Pause for a moment, then push through your heels to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"sit-up v. 2",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/wK12ZBw1b5tURO",id:735,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly lift your upper body off the ground, curling forward until your torso is at a 45-degree angle.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"sit-up with arms on chest",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/J4aqtkDoZW1YG0",id:3679,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Cross your arms over your chest.
Engaging your abs, lift your upper body off the ground towards your knees.
Pause for a moment at the top, then slowly lower your upper body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"skater hops",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/cX-jY6ZbbcN2sI",id:3361,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Bend your knees slightly and jump to the right, landing on your right foot.
As you land, swing your left leg behind your right leg and tap the ground with your left toes.
Immediately jump to the left, landing on your left foot.
As you land, swing your right leg behind your left leg and tap the ground with your right toes.
Continue alternating sides, jumping and tapping the ground with each leg.
Repeat for the desired number of repetitions.`},{name:"ski step",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/otp7oFGiqxrcch",id:3671,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart.
Bend your knees slightly and keep your back straight.
Jump to the right, landing on your right foot while swinging your left leg behind your right leg.
Immediately jump to the left, landing on your left foot while swinging your right leg behind your left leg.
Continue alternating jumps from side to side, mimicking a skiing motion.
Repeat for the desired number of repetitions.`},{name:"skin the cat",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/UORwJwlisOpCC0",id:3304,target:"upper back",instructions:`Start by hanging from a bar with your arms fully extended and your body relaxed.
Engage your core and lift your legs up, bringing your knees towards your chest.
Continue to lift your legs up and over your head, allowing your body to pass through the arms.
Once your legs are fully extended over your head, begin to lower them back down towards the starting position.
As you lower your legs, allow your body to pass back through the arms until you are hanging with your arms fully extended again.
Repeat for the desired number of repetitions.`},{name:"spell caster",bodyPart:"waist",equipment:"dumbbell",gifUrl:"https://v2.exercisedb.io/image/AkZ4qHHNBNRiSO",id:777,target:"abs",instructions:`Stand with your feet shoulder-width apart and hold a dumbbell in one hand.
Bend your knees slightly and hinge forward at the waist, keeping your back straight.
Extend your arm with the dumbbell towards the opposite foot, rotating your torso as you do so.
Return to the starting position and repeat on the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"sphinx",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/iIgVrhtuHiG9h6",id:1362,target:"spine",instructions:`Lie face down on the ground with your forearms flat on the floor, elbows directly under your shoulders.
Engage your core and lift your chest off the ground, keeping your forearms and toes on the floor.
Hold this position for a few seconds, making sure to keep your neck in a neutral position.
Slowly lower your chest back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"spider crawl push up",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/26K4gsGpN5k2Jm",id:778,target:"glutes",instructions:`Start in a push-up position with your hands slightly wider than shoulder-width apart and your feet together.
Bring your right knee towards your right elbow, keeping it off the ground.
As you bring your right knee back, simultaneously lower your body towards the ground by bending your elbows.
Push back up to the starting position and repeat with your left knee towards your left elbow.
Continue alternating sides for the desired number of repetitions.`},{name:"spine stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/In-fISLmTQaUU1",id:1363,target:"spine",instructions:`Sit on the ground with your legs extended in front of you.
Place your hands on the ground behind you, fingers pointing towards your body.
Engage your core and slowly lean back, keeping your back straight.
Continue leaning back until you feel a stretch in your spine.
Hold the stretch for a few seconds, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"spine twist",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/3OP7DphyRZy3qe",id:2329,target:"abs",instructions:`Sit on the ground with your legs extended in front of you.
Bend your knees and place your feet flat on the ground, hip-width apart.
Place your hands behind your head with your elbows pointing outwards.
Engage your abs and slowly twist your torso to the right, bringing your right elbow towards your left knee.
Pause for a moment at the end of the twist, then slowly return to the starting position.
Repeat the twist to the left side, bringing your left elbow towards your right knee.
Continue alternating sides for the desired number of repetitions.`},{name:"split squats",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/EdZGjtim6TfPKN",id:2368,target:"quads",instructions:`Stand with your feet shoulder-width apart.
Take a step forward with one foot and place it about two feet in front of the other foot.
Lower your body by bending your knees and hips, keeping your back straight.
Continue lowering until your front thigh is parallel to the ground, and your back knee is hovering just above the ground.
Pause for a moment, then push through your front heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs and repeat.`},{name:"squat to overhead reach",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aLziTflWUE2JAf",id:1685,target:"quads",instructions:`Stand with your feet shoulder-width apart and toes slightly turned out.
Lower your body down into a squat position by bending your knees and pushing your hips back.
As you come up from the squat, extend your arms overhead, reaching towards the ceiling.
Return to the starting position by lowering your arms and bending your knees to squat down again.
Repeat for the desired number of repetitions.`},{name:"squat to overhead reach with twist",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/p6cZ6acN94RMJE",id:1686,target:"quads",instructions:`Stand with your feet shoulder-width apart and toes slightly turned out.
Lower your body into a squat position by bending your knees and pushing your hips back.
As you come up from the squat, raise your arms overhead and twist your torso to one side.
Return to the starting position and repeat the squat, this time twisting your torso to the opposite side.
Continue alternating sides with each squat repetition.`},{name:"stability ball crunch (full range hands behind head)",bodyPart:"waist",equipment:"stability ball",gifUrl:"https://v2.exercisedb.io/image/GpID4wiNKTTAjg",id:2297,target:"abs",instructions:`Sit on the stability ball with your feet flat on the ground and your knees bent at a 90-degree angle.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, slowly curl your upper body forward, bringing your chest towards your knees.
Pause for a moment at the top, then slowly lower your upper body back to the starting position.
Repeat for the desired number of repetitions.`},{name:"stalder press",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/5cmls8QfIh9LnU",id:3291,target:"triceps",instructions:`Start by standing with your feet shoulder-width apart and your arms extended overhead.
Bend your knees slightly and engage your core.
Lower your body down into a squat position while keeping your arms extended overhead.
As you squat down, press your arms down towards the ground, engaging your triceps.
Pause for a moment at the bottom of the squat, then push through your heels to stand back up while simultaneously raising your arms back overhead.
Repeat for the desired number of repetitions.`},{name:"standing archer",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/TUAe2bhX1EkstU",id:3669,target:"upper back",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Extend your arms straight out in front of you at shoulder height, parallel to the ground.
Rotate your torso to the right, keeping your arms extended and your back straight.
As you rotate, extend your right arm forward and your left arm back, mimicking the motion of drawing a bowstring.
Hold the position for a moment, then return to the starting position.
Repeat the motion, this time rotating your torso to the left and extending your left arm forward and your right arm back.
Continue alternating sides for the desired number of repetitions.`},{name:"standing calf raise (on a staircase)",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/u5D8GKXAAMS4Zg",id:1490,target:"calves",instructions:`Stand on the edge of a step or a sturdy platform with your heels hanging off and your toes on the step.
Hold onto a railing or wall for balance if needed.
Slowly raise your heels as high as possible, lifting your body weight onto the balls of your feet.
Pause for a moment at the top, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"standing calves",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/C3QLHvS3AN3D07",id:1397,target:"calves",instructions:`Stand with your feet shoulder-width apart, toes pointing forward.
Raise your heels off the ground as high as possible, standing on your toes.
Hold the position for a moment, then slowly lower your heels back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"standing calves calf stretch",bodyPart:"lower legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/WEQEuNDu2XrLhH",id:1398,target:"calves",instructions:`Stand facing a wall or sturdy object, about an arm's length away.
Place your hands on the wall or object at shoulder height.
Step back with one foot, keeping your heel flat on the ground.
Bend your front knee slightly and lean forward, keeping your back leg straight.
You should feel a stretch in your calf muscle.
Hold the stretch for 20-30 seconds.
Repeat on the other leg.`},{name:"standing lateral stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/K28QI8LcmUeBUE",id:794,target:"lats",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Extend your arms straight out to the sides, parallel to the ground.
Slowly lean your upper body to one side, feeling a stretch in your side and lats.
Hold the stretch for 15-30 seconds.
Return to the starting position and repeat on the other side.
Repeat for the desired number of repetitions.`},{name:"standing single leg curl",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/0tv9ym-lgGwKgJ",id:795,target:"hamstrings",instructions:`Stand with your feet hip-width apart and your hands on your hips.
Shift your weight onto your left leg and lift your right foot off the ground, bending your knee.
Slowly curl your right heel towards your glutes, squeezing your hamstring.
Pause for a moment at the top, then slowly lower your right foot back down to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"standing wheel rollerout",bodyPart:"waist",equipment:"wheel roller",gifUrl:"https://v2.exercisedb.io/image/ihraYnywgymxry",id:796,target:"abs",instructions:`Start by standing tall with your feet shoulder-width apart and the wheel roller in front of you.
Bend at your waist and slowly roll the wheel forward, keeping your back straight and your core engaged.
Continue rolling forward until you feel a stretch in your abs and your body is extended as far as possible.
Pause for a moment, then slowly roll the wheel back towards your body, returning to the starting position.
Repeat for the desired number of repetitions.`},{name:"star jump",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/c3a-G9GZTOx-Pc",id:3223,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart and your arms by your sides.
Bend your knees slightly and jump up explosively.
As you jump, spread your legs and extend your arms out to the sides, forming a star shape with your body.
Land softly on the balls of your feet with your knees slightly bent.
Repeat for the desired number of repetitions.`},{name:"straddle maltese",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/FLZC58NSzV2JcI",id:3314,target:"abs",instructions:`Start by hanging from a pair of rings with your arms fully extended and your body in a straight line.
Spread your legs wide apart, forming a straddle position.
Engage your core and slowly lower your body until your arms are parallel to the ground.
Hold this position for a few seconds, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"straddle planche",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/TOUBtbGKkdjGRE",id:3298,target:"abs",instructions:`Start in a push-up position with your hands shoulder-width apart and your feet spread wide apart.
Engage your core and slowly shift your weight forward, bringing your shoulders over your hands.
Bend your elbows and lower your body towards the ground, keeping your elbows close to your sides.
Pause for a moment at the bottom, then push through your hands to straighten your arms and lift your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"straight leg outer hip abductor",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/TTrLAw8lDObj5u",id:1427,target:"abductors",instructions:`Lie on your side with your legs straight and stacked on top of each other.
Place your bottom arm under your head for support.
Engage your core and lift your top leg as high as possible without rotating your hips or leaning backward.
Pause for a moment at the top, then slowly lower your leg back down to the starting position.
Repeat for the desired number of repetitions, then switch sides.`},{name:"superman push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/zXAScVnSA5Q3dQ",id:803,target:"pectorals",instructions:`Start in a high plank position with your hands slightly wider than shoulder-width apart and your feet together.
Engage your core and lower your body towards the ground, keeping your elbows close to your sides.
As you lower your body, simultaneously lift your right arm and left leg off the ground, extending them straight out.
Pause for a moment at the top, then lower your arm and leg back down while pushing yourself back up to the starting position.
Repeat the movement, this time lifting your left arm and right leg.
Continue alternating sides for the desired number of repetitions.`},{name:"suspended abdominal fallout",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/kJU6qstW-ASGW7",id:805,target:"abs",instructions:`Attach a suspension trainer to a high anchor point and adjust the straps to waist height.
Stand facing away from the anchor point and hold the handles with your arms extended in front of you.
Lean forward at the waist, keeping your body straight and your core engaged.
Lower your body as far as you can while maintaining control and tension in your abs.
Pause for a moment at the bottom, then slowly raise your body back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"suspended push-up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/YaVP7W1ZUHBua1",id:806,target:"pectorals",instructions:`Find a suspension trainer and adjust it to an appropriate height.
Stand facing away from the anchor point and hold the handles with an overhand grip.
Walk your feet forward, leaning your body forward until your weight is supported by the suspension trainer.
Keep your body straight from head to heels, engage your core, and lower your chest towards the handles.
Push through your chest and arms to return to the starting position.
Repeat for the desired number of repetitions.`},{name:"suspended reverse crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/aeToUf0lkaHXsl",id:807,target:"abs",instructions:`Hang from a pull-up bar with your arms fully extended and your palms facing away from you.
Engage your core and lift your knees up towards your chest, curling your pelvis towards your ribcage.
Pause for a moment at the top, then slowly lower your knees back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"suspended row",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/AG8WHkP7URpPTM",id:808,target:"upper back",instructions:`Set up a suspension trainer at an appropriate height.
Stand facing the anchor point with your feet shoulder-width apart.
Hold the handles with an overhand grip, palms facing each other.
Lean back, keeping your body straight and your heels on the ground.
Pull your chest towards the handles, squeezing your shoulder blades together.
Pause for a moment at the top, then slowly lower yourself back to the starting position.
Repeat for the desired number of repetitions.`},{name:"suspended split squat",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/lL7beS2SQ11BS9",id:809,target:"quads",instructions:`Stand facing away from a suspension trainer with your feet shoulder-width apart.
Extend one leg forward and place the top of your foot in the foot cradle of the suspension trainer.
Bend your standing leg and lower your body down into a lunge position, keeping your chest up and your knee in line with your toes.
Push through your heel to return to the starting position.
Repeat for the desired number of repetitions, then switch legs.`},{name:"swimmer kicks v. 2",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/MtGKeBIuVX10uL",id:3433,target:"glutes",instructions:`Lie face down on a mat with your arms extended overhead.
Engage your core and lift your chest and legs off the ground simultaneously.
Kick your legs up and down in a fluttering motion, as if you were swimming.
Continue kicking for the desired number of repetitions.
Lower your chest and legs back down to the starting position.`},{name:"swing 360",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Ri7ki2YFoYKUWE",id:3318,target:"cardiovascular system",instructions:`Stand with your feet shoulder-width apart and knees slightly bent.
Hold your arms straight out in front of you, parallel to the ground.
Engage your core and swing your arms in a circular motion, rotating your torso as you do so.
Continue the circular motion, swinging your arms and rotating your torso for the desired number of repetitions.
Remember to breathe throughout the exercise.`},{name:"three bench dip",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/PS708wLdvuiRLg",id:1753,target:"triceps",instructions:`Sit on a bench with your hands gripping the edge, fingers pointing forward.
Slide your butt off the bench, supporting your weight with your hands.
Bend your elbows and lower your body until your upper arms are parallel to the ground.
Push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps dip",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/iz2WOGGnqgBZ5h",id:814,target:"triceps",instructions:`Sit on the edge of a bench or chair with your hands gripping the edge, fingers pointing forward.
Slide your butt off the bench, supporting your weight with your hands.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps dip (bench leg)",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/zsFSF7oFyrCyhs",id:812,target:"triceps",instructions:`Sit on the edge of a bench with your hands gripping the edge, fingers pointing forward.
Walk your feet forward, sliding your butt off the bench, and straighten your arms.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench.
Push through your palms to straighten your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps dip (between benches)",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/NnEu6yiZJFDkgM",id:813,target:"triceps",instructions:`Sit on a bench with your hands gripping the edge of the bench, fingers pointing forward.
Slide your butt off the bench, supporting your weight with your hands.
Bend your elbows and lower your body towards the ground, keeping your back close to the bench.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps dips floor",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/EQHqU97CG8jebi",id:815,target:"triceps",instructions:`Sit on the edge of a chair or bench with your hands next to your hips, fingers pointing forward.
Slide your butt off the front of the chair with your legs extended in front of you.
Straighten your arms, keeping a little bend in your elbows to keep tension on your triceps and off your elbow joints.
Slowly bend your elbows to lower your body toward the floor until your elbows are at about a 90-degree angle.
Once you reach the bottom of the movement, press down into the chair to straighten your elbows, returning to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps press",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/guUsJAvaRGVAf6",id:816,target:"triceps",instructions:`Stand with your feet shoulder-width apart and your knees slightly bent.
Extend your arms straight out in front of you, parallel to the ground.
Bend your elbows and lower your body towards the ground, keeping your upper arms close to your sides.
Pause for a moment at the bottom, then push yourself back up to the starting position.
Repeat for the desired number of repetitions.`},{name:"triceps stretch",bodyPart:"upper arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/2H7QBWiKeVc4L4",id:817,target:"triceps",instructions:`Stand or sit upright with your back straight.
Extend one arm overhead, bending it at the elbow.
Place your opposite hand on the bent elbow and gently pull it towards your head.
Hold the stretch for 15-30 seconds, feeling a gentle stretch in your triceps.
Release the stretch and repeat on the other arm.`},{name:"tuck crunch",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/XPi15L08izmmE8",id:871,target:"abs",instructions:`Lie flat on your back with your knees bent and feet flat on the ground.
Place your hands behind your head with your elbows pointing outwards.
Engaging your abs, lift your shoulder blades off the ground and bring your knees towards your chest, simultaneously curling your upper body towards your knees.
Pause for a moment at the top, then slowly lower your shoulder blades and extend your legs back to the starting position.
Repeat for the desired number of repetitions.`},{name:"twist hip lift",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/nVhrvfDChvvvx2",id:1466,target:"glutes",instructions:`Lie on your back with your knees bent and feet flat on the ground.
Place your hands by your sides for support.
Engage your glutes and lift your hips off the ground, forming a straight line from your knees to your shoulders.
While keeping your hips lifted, twist your lower body to the right side, bringing your knees towards the ground.
Return to the starting position and repeat the twist to the left side.
Continue alternating twists for the desired number of repetitions.`},{name:"twisted leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/5OFw2MuJXqOh3Y",id:2802,target:"abs",instructions:`Lie flat on your back with your legs extended and your arms by your sides.
Place your hands under your glutes for support.
Engage your abs and lift both legs off the ground, keeping them straight.
As you lift your legs, twist your hips to one side, bringing your legs towards your opposite shoulder.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat the movement, this time twisting your hips to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"twisted leg raise",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/yHqzil1cGNkaFI",id:2801,target:"abs",instructions:`Lie flat on your back with your legs extended and your arms by your sides.
Bend your knees and lift your legs off the ground, bringing them towards your chest.
As you lift your legs, twist your hips to one side, bringing your knees towards your opposite shoulder.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat the movement, this time twisting your hips to the other side.
Continue alternating sides for the desired number of repetitions.`},{name:"two toe touch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/Ll3wfRsFZjOQet",id:3231,target:"spine",instructions:`Stand with your feet shoulder-width apart and your arms extended out to the sides.
Bend forward at the waist, keeping your back straight and your knees slightly bent.
Reach down towards your toes with both hands, keeping your legs straight.
Pause for a moment at the bottom, then slowly return to the starting position.
Repeat for the desired number of repetitions.`},{name:"upper back stretch",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/cdsNwwc-V0fSKG",id:1365,target:"upper back",instructions:`Stand up straight with your feet shoulder-width apart.
Extend your arms straight in front of you, parallel to the ground.
Interlace your fingers and rotate your palms away from your body.
Slowly raise your arms overhead, keeping them straight and parallel to each other.
As you raise your arms, squeeze your shoulder blades together.
Hold the stretch for 15-30 seconds, then release and repeat.`},{name:"upward facing dog",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/KqQpx3FA8VdzLR",id:1366,target:"spine",instructions:`Lie face down on the floor with your legs extended behind you.
Place your hands on the floor next to your lower ribs, fingers pointing forward.
Press your hands firmly into the floor and straighten your arms, lifting your torso and thighs off the ground.
Roll your shoulders back and down, opening your chest and lifting your gaze towards the ceiling.
Hold this position for a few breaths, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"v-sit on floor",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/480XCyHBEbmJep",id:3420,target:"abs",instructions:`Sit on the floor with your legs extended in front of you.
Lean back slightly and lift your legs off the ground, keeping them straight.
Simultaneously, lift your upper body off the ground and reach your arms towards your legs.
Hold this position for a few seconds, then slowly lower your upper body and legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"vertical leg raise (on parallel bars)",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/t9O5n8qJ2tzAFp",id:826,target:"abs",instructions:`Hang from the parallel bars with your arms fully extended and your body straight.
Engage your core and lift your legs up in front of you, keeping them straight.
Continue lifting until your legs are parallel to the ground or slightly higher.
Pause for a moment at the top, then slowly lower your legs back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"walking high knees lunge",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/lxPbS3oZpFu-RK",id:3655,target:"cardiovascular system",instructions:`Stand with your feet hip-width apart.
Lift your right knee up towards your chest as high as you can while balancing on your left leg.
Step forward with your right foot and lower your body into a lunge position, bending both knees to a 90-degree angle.
Push off with your right foot and bring your left knee up towards your chest.
Step forward with your left foot and lower your body into a lunge position.
Continue alternating legs and lunging forward, keeping your core engaged and maintaining a steady pace.
Repeat for the desired number of repetitions.`},{name:"walking lunge",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/tuoY9CJaezTS1F",id:1460,target:"glutes",instructions:`Stand with your feet shoulder-width apart.
Take a step forward with your right leg, lowering your body into a lunge position.
Keep your torso upright and your front knee aligned with your ankle.
Push off with your right foot and bring your left foot forward, stepping into a lunge position with your left leg.
Continue alternating legs and walking forward, maintaining a controlled and steady pace.
Repeat for the desired number of repetitions.`},{name:"weighted seated bicep curl (on stability ball)",bodyPart:"upper arms",equipment:"medicine ball",gifUrl:"https://v2.exercisedb.io/image/4UQsfsLF6EuTvg",id:847,target:"biceps",instructions:`Sit on a stability ball with your feet flat on the ground and your back straight.
Hold a medicine ball with an underhand grip, palms facing up, and let your arms hang down by your sides.
Keeping your upper arms stationary, exhale and curl the medicine ball up towards your shoulders.
Pause for a moment at the top, squeezing your biceps.
Inhale and slowly lower the medicine ball back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"wheel rollerout",bodyPart:"waist",equipment:"wheel roller",gifUrl:"https://v2.exercisedb.io/image/Dg9tDT9L8dRNIG",id:857,target:"abs",instructions:`Kneel on the floor and place the wheel roller in front of you.
Place your hands on the handles of the wheel roller and extend your arms straight out in front of you.
Engage your core muscles and slowly roll the wheel forward, keeping your back straight and your abs tight.
Continue rolling forward until your body is fully extended and your arms are overhead.
Pause for a moment, then slowly roll the wheel back towards your knees, maintaining control and keeping your abs engaged.
Repeat for the desired number of repetitions.`},{name:"wheel run",bodyPart:"cardio",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/g57PpJlPVoBflL",id:3637,target:"cardiovascular system",instructions:`Start in a plank position with your hands on the wheel and your body straight.
Engage your core and start rolling the wheel forward by extending your arms.
Continue rolling until your body is fully extended and your arms are overhead.
Reverse the movement by pulling the wheel back towards your body, using your core and arms.
Repeat for the desired number of repetitions.`},{name:"wide grip pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/80UfEZjGykV752",id:1429,target:"lats",instructions:`Hang from a pull-up bar with your palms facing away from you and your hands wider than shoulder-width apart.
Engage your core and squeeze your shoulder blades together.
Pull your body up towards the bar until your chin is above the bar.
Lower your body back down to the starting position with control.
Repeat for the desired number of repetitions.`},{name:"wide grip rear pull-up",bodyPart:"back",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/qoVqViZhQs0rqY",id:1367,target:"lats",instructions:`Grab the pull-up bar with a wide overhand grip, hands slightly wider than shoulder-width apart.
Hang from the bar with your arms fully extended and your body straight.
Engage your back muscles and pull your body up towards the bar, leading with your chest.
Continue pulling until your chin is above the bar.
Pause for a moment at the top, then slowly lower your body back down to the starting position.
Repeat for the desired number of repetitions.`},{name:"wide hand push up",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/c-mTSuha5gq8Y9",id:1311,target:"pectorals",instructions:`Start in a high plank position with your hands wider than shoulder-width apart.
Keep your body in a straight line from head to toe.
Lower your chest towards the ground by bending your elbows, keeping them close to your sides.
Push through your palms to extend your arms and return to the starting position.
Repeat for the desired number of repetitions.`},{name:"wide-grip chest dip on high parallel bars",bodyPart:"chest",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/xF43jN-aOYeCJy",id:2363,target:"pectorals",instructions:`Position yourself on the parallel bars with your arms fully extended and your body suspended in the air.
Lean forward slightly and lower your body by bending your elbows until your chest is just above the bars.
Pause for a moment, then push yourself back up to the starting position by straightening your arms.
Repeat for the desired number of repetitions.`},{name:"wind sprints",bodyPart:"waist",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/YSgBKDxnov8wDV",id:858,target:"abs",instructions:`Find an open space or a track to perform the exercise.
Start by standing with your feet shoulder-width apart.
Begin running as fast as you can, pumping your arms and driving your knees up.
Continue sprinting for a specific distance or time period.
Rest and repeat for the desired number of repetitions.`},{name:"world greatest stretch",bodyPart:"upper legs",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/113dqQrzTriBdq",id:1604,target:"hamstrings",instructions:`Start in a lunge position with your right foot forward and your left foot back.
Place your hands on the ground on either side of your right foot.
Lower your left knee to the ground and extend your right leg, keeping your right foot flat on the ground.
Rotate your torso to the right, reaching your right arm up towards the ceiling.
Hold this position for a few seconds, then return to the starting position.
Switch sides and repeat the stretch with your left foot forward.`},{name:"wrist circles",bodyPart:"lower arms",equipment:"body weight",gifUrl:"https://v2.exercisedb.io/image/6ZNmMRGyU8VZNk",id:1428,target:"forearms",instructions:`Extend your arms straight out in front of you.
Make a fist with both hands.
Rotate your wrists in a circular motion, keeping your arms still.
Continue the wrist circles for the desired number of repetitions.`}];function Ut(){return Ut=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Ut.apply(this,arguments)}function Ts(t,e){if(t==null)return{};var i={},r=Object.keys(t),n,s;for(s=0;s<r.length;s++)n=r[s],!(e.indexOf(n)>=0)&&(i[n]=t[n]);return i}function poe(t){var e,i,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(i=poe(t[e]))&&(r&&(r+=" "),r+=i)}else for(i in t)t[i]&&(r&&(r+=" "),r+=i);return r}function Oo(){for(var t,e,i=0,r="",n=arguments.length;i<n;i++)(t=arguments[i])&&(e=poe(t))&&(r&&(r+=" "),r+=e);return r}function sp(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function foe(t){if(!sp(t))return t;const e={};return Object.keys(t).forEach(i=>{e[i]=foe(t[i])}),e}function Su(t,e,i={clone:!0}){const r=i.clone?Ut({},t):t;return sp(t)&&sp(e)&&Object.keys(e).forEach(n=>{n!=="__proto__"&&(sp(e[n])&&n in t&&sp(t[n])?r[n]=Su(t[n],e[n],i):i.clone?r[n]=sp(e[n])?foe(e[n]):e[n]:r[n]=e[n])}),r}function M0(t){let e="https://mui.com/production-error/?code="+t;for(let i=1;i<arguments.length;i+=1)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function Nl(t){if(typeof t!="string")throw new Error(M0(7));return t.charAt(0).toUpperCase()+t.slice(1)}function p9e(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const f9e=typeof window<"u"?se.useLayoutEffect:se.useEffect,m9e=f9e;function g9e({controlled:t,default:e,name:i,state:r="value"}){const{current:n}=se.useRef(t!==void 0),[s,o]=se.useState(e),a=n?t:s,l=se.useCallback(u=>{n||o(u)},[]);return[a,l]}function uM(t){const e=se.useRef(t);return m9e(()=>{e.current=t}),se.useRef((...i)=>(0,e.current)(...i)).current}function dY(...t){return se.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(i=>{p9e(i,e)})},t)}const pY={};function y9e(t,e){const i=se.useRef(pY);return i.current===pY&&(i.current=t(e)),i}const v9e=[];function b9e(t){se.useEffect(t,v9e)}class RT{constructor(){this.currentId=0,this.clear=()=>{this.currentId!==0&&(clearTimeout(this.currentId),this.currentId=0)},this.disposeEffect=()=>this.clear}static create(){return new RT}start(e,i){this.clear(),this.currentId=setTimeout(()=>{this.currentId=0,i()},e)}}function x9e(){const t=y9e(RT.create).current;return b9e(t.disposeEffect),t}let kT=!0,lN=!1;const w9e=new RT,_9e={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function S9e(t){const{type:e,tagName:i}=t;return!!(i==="INPUT"&&_9e[e]&&!t.readOnly||i==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function A9e(t){t.metaKey||t.altKey||t.ctrlKey||(kT=!0)}function VI(){kT=!1}function E9e(){this.visibilityState==="hidden"&&lN&&(kT=!0)}function M9e(t){t.addEventListener("keydown",A9e,!0),t.addEventListener("mousedown",VI,!0),t.addEventListener("pointerdown",VI,!0),t.addEventListener("touchstart",VI,!0),t.addEventListener("visibilitychange",E9e,!0)}function C9e(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return kT||S9e(e)}function P9e(){const t=se.useCallback(n=>{n!=null&&M9e(n.ownerDocument)},[]),e=se.useRef(!1);function i(){return e.current?(lN=!0,w9e.start(100,()=>{lN=!1}),e.current=!1,!0):!1}function r(n){return C9e(n)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:i,ref:t}}function moe(t,e){const i=Ut({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))i[r]=Ut({},t[r],i[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const n=t[r]||{},s=e[r];i[r]={},!s||!Object.keys(s)?i[r]=n:!n||!Object.keys(n)?i[r]=s:(i[r]=Ut({},s),Object.keys(n).forEach(o=>{i[r][o]=moe(n[o],s[o])}))}else i[r]===void 0&&(i[r]=t[r])}),i}function E_(t,e,i=void 0){const r={};return Object.keys(t).forEach(n=>{r[n]=t[n].reduce((s,o)=>{if(o){const a=e(o);a!==""&&s.push(a),i&&i[o]&&s.push(i[o])}return s},[]).join(" ")}),r}const fY=t=>t,T9e=()=>{let t=fY;return{configure(e){t=e},generate(e){return t(e)},reset(){t=fY}}},R9e=T9e(),k9e=R9e,D9e={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function ab(t,e,i="Mui"){const r=D9e[e];return r?`${i}-${r}`:`${k9e.generate(t)}-${e}`}function M_(t,e,i="Mui"){const r={};return e.forEach(n=>{r[n]=ab(t,n,i)}),r}function I9e(t,e=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,i))}function goe(t){var e=Object.create(null);return function(i){return e[i]===void 0&&(e[i]=t(i)),e[i]}}var L9e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,B9e=goe(function(t){return L9e.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function O9e(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function U9e(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var N9e=function(){function t(i){var r=this;this._insertTag=function(n){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(n,s),r.tags.push(n)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(U9e(this));var n=this.tags[this.tags.length-1];if(this.isSpeedy){var s=O9e(n);try{s.insertRule(r,s.cssRules.length)}catch{}}else n.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),oo="-ms-",sP="-moz-",Ji="-webkit-",yoe="comm",b5="rule",x5="decl",F9e="@import",voe="@keyframes",z9e="@layer",H9e=Math.abs,DT=String.fromCharCode,G9e=Object.assign;function V9e(t,e){return Ns(t,0)^45?(((e<<2^Ns(t,0))<<2^Ns(t,1))<<2^Ns(t,2))<<2^Ns(t,3):0}function boe(t){return t.trim()}function j9e(t,e){return(t=e.exec(t))?t[0]:t}function Qi(t,e,i){return t.replace(e,i)}function uN(t,e){return t.indexOf(e)}function Ns(t,e){return t.charCodeAt(e)|0}function B1(t,e,i){return t.slice(e,i)}function ph(t){return t.length}function w5(t){return t.length}function hM(t,e){return e.push(t),t}function W9e(t,e){return t.map(e).join("")}var IT=1,C0=1,xoe=0,wa=0,On=0,lb="";function LT(t,e,i,r,n,s,o){return{value:t,root:e,parent:i,type:r,props:n,children:s,line:IT,column:C0,length:o,return:""}}function kx(t,e){return G9e(LT("",null,null,"",null,null,0),t,{length:-t.length},e)}function q9e(){return On}function X9e(){return On=wa>0?Ns(lb,--wa):0,C0--,On===10&&(C0=1,IT--),On}function Xa(){return On=wa<xoe?Ns(lb,wa++):0,C0++,On===10&&(C0=1,IT++),On}function Lh(){return Ns(lb,wa)}function lC(){return wa}function C_(t,e){return B1(lb,t,e)}function O1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function woe(t){return IT=C0=1,xoe=ph(lb=t),wa=0,[]}function _oe(t){return lb="",t}function uC(t){return boe(C_(wa-1,hN(t===91?t+2:t===40?t+1:t)))}function Y9e(t){for(;(On=Lh())&&On<33;)Xa();return O1(t)>2||O1(On)>3?"":" "}function K9e(t,e){for(;--e&&Xa()&&!(On<48||On>102||On>57&&On<65||On>70&&On<97););return C_(t,lC()+(e<6&&Lh()==32&&Xa()==32))}function hN(t){for(;Xa();)switch(On){case t:return wa;case 34:case 39:t!==34&&t!==39&&hN(On);break;case 40:t===41&&hN(t);break;case 92:Xa();break}return wa}function J9e(t,e){for(;Xa()&&t+On!==47+10;)if(t+On===42+42&&Lh()===47)break;return"/*"+C_(e,wa-1)+"*"+DT(t===47?t:Xa())}function Q9e(t){for(;!O1(Lh());)Xa();return C_(t,wa)}function Z9e(t){return _oe(hC("",null,null,null,[""],t=woe(t),0,[0],t))}function hC(t,e,i,r,n,s,o,a,l){for(var u=0,c=0,h=o,d=0,p=0,f=0,m=1,g=1,y=1,v=0,b="",_=n,A=s,S=r,E=b;g;)switch(f=v,v=Xa()){case 40:if(f!=108&&Ns(E,h-1)==58){uN(E+=Qi(uC(v),"&","&\f"),"&\f")!=-1&&(y=-1);break}case 34:case 39:case 91:E+=uC(v);break;case 9:case 10:case 13:case 32:E+=Y9e(f);break;case 92:E+=K9e(lC()-1,7);continue;case 47:switch(Lh()){case 42:case 47:hM($9e(J9e(Xa(),lC()),e,i),l);break;default:E+="/"}break;case 123*m:a[u++]=ph(E)*y;case 125*m:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+c:y==-1&&(E=Qi(E,/\f/g,"")),p>0&&ph(E)-h&&hM(p>32?gY(E+";",r,i,h-1):gY(Qi(E," ","")+";",r,i,h-2),l);break;case 59:E+=";";default:if(hM(S=mY(E,e,i,u,c,n,a,b,_=[],A=[],h),s),v===123)if(c===0)hC(E,e,S,S,_,s,h,a,A);else switch(d===99&&Ns(E,3)===110?100:d){case 100:case 108:case 109:case 115:hC(t,S,S,r&&hM(mY(t,S,S,0,0,n,a,b,n,_=[],h),A),n,A,h,a,r?_:A);break;default:hC(E,S,S,S,[""],A,0,a,A)}}u=c=p=0,m=y=1,b=E="",h=o;break;case 58:h=1+ph(E),p=f;default:if(m<1){if(v==123)--m;else if(v==125&&m++==0&&X9e()==125)continue}switch(E+=DT(v),v*m){case 38:y=c>0?1:(E+="\f",-1);break;case 44:a[u++]=(ph(E)-1)*y,y=1;break;case 64:Lh()===45&&(E+=uC(Xa())),d=Lh(),c=h=ph(b=E+=Q9e(lC())),v++;break;case 45:f===45&&ph(E)==2&&(m=0)}}return s}function mY(t,e,i,r,n,s,o,a,l,u,c){for(var h=n-1,d=n===0?s:[""],p=w5(d),f=0,m=0,g=0;f<r;++f)for(var y=0,v=B1(t,h+1,h=H9e(m=o[f])),b=t;y<p;++y)(b=boe(m>0?d[y]+" "+v:Qi(v,/&\f/g,d[y])))&&(l[g++]=b);return LT(t,e,i,n===0?b5:a,l,u,c)}function $9e(t,e,i){return LT(t,e,i,yoe,DT(q9e()),B1(t,2,-2),0)}function gY(t,e,i,r){return LT(t,e,i,x5,B1(t,0,r),B1(t,r+1,-1),r)}function jv(t,e){for(var i="",r=w5(t),n=0;n<r;n++)i+=e(t[n],n,t,e)||"";return i}function eWe(t,e,i,r){switch(t.type){case z9e:if(t.children.length)break;case F9e:case x5:return t.return=t.return||t.value;case yoe:return"";case voe:return t.return=t.value+"{"+jv(t.children,r)+"}";case b5:t.value=t.props.join(",")}return ph(i=jv(t.children,r))?t.return=t.value+"{"+i+"}":""}function tWe(t){var e=w5(t);return function(i,r,n,s){for(var o="",a=0;a<e;a++)o+=t[a](i,r,n,s)||"";return o}}function iWe(t){return function(e){e.root||(e=e.return)&&t(e)}}var rWe=function(e,i,r){for(var n=0,s=0;n=s,s=Lh(),n===38&&s===12&&(i[r]=1),!O1(s);)Xa();return C_(e,wa)},nWe=function(e,i){var r=-1,n=44;do switch(O1(n)){case 0:n===38&&Lh()===12&&(i[r]=1),e[r]+=rWe(wa-1,i,r);break;case 2:e[r]+=uC(n);break;case 4:if(n===44){e[++r]=Lh()===58?"&\f":"",i[r]=e[r].length;break}default:e[r]+=DT(n)}while(n=Xa());return e},sWe=function(e,i){return _oe(nWe(woe(e),i))},yY=new WeakMap,oWe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var i=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&i.charCodeAt(0)!==58&&!yY.get(r))&&!n){yY.set(e,!0);for(var s=[],o=sWe(i,s),a=r.props,l=0,u=0;l<o.length;l++)for(var c=0;c<a.length;c++,u++)e.props[u]=s[l]?o[l].replace(/&\f/g,a[c]):a[c]+" "+o[l]}}},aWe=function(e){if(e.type==="decl"){var i=e.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(e.return="",e.value="")}};function Soe(t,e){switch(V9e(t,e)){case 5103:return Ji+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ji+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ji+t+sP+t+oo+t+t;case 6828:case 4268:return Ji+t+oo+t+t;case 6165:return Ji+t+oo+"flex-"+t+t;case 5187:return Ji+t+Qi(t,/(\w+).+(:[^]+)/,Ji+"box-$1$2"+oo+"flex-$1$2")+t;case 5443:return Ji+t+oo+"flex-item-"+Qi(t,/flex-|-self/,"")+t;case 4675:return Ji+t+oo+"flex-line-pack"+Qi(t,/align-content|flex-|-self/,"")+t;case 5548:return Ji+t+oo+Qi(t,"shrink","negative")+t;case 5292:return Ji+t+oo+Qi(t,"basis","preferred-size")+t;case 6060:return Ji+"box-"+Qi(t,"-grow","")+Ji+t+oo+Qi(t,"grow","positive")+t;case 4554:return Ji+Qi(t,/([^-])(transform)/g,"$1"+Ji+"$2")+t;case 6187:return Qi(Qi(Qi(t,/(zoom-|grab)/,Ji+"$1"),/(image-set)/,Ji+"$1"),t,"")+t;case 5495:case 3959:return Qi(t,/(image-set\([^]*)/,Ji+"$1$`$1");case 4968:return Qi(Qi(t,/(.+:)(flex-)?(.*)/,Ji+"box-pack:$3"+oo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ji+t+t;case 4095:case 3583:case 4068:case 2532:return Qi(t,/(.+)-inline(.+)/,Ji+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ph(t)-1-e>6)switch(Ns(t,e+1)){case 109:if(Ns(t,e+4)!==45)break;case 102:return Qi(t,/(.+:)(.+)-([^]+)/,"$1"+Ji+"$2-$3$1"+sP+(Ns(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~uN(t,"stretch")?Soe(Qi(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Ns(t,e+1)!==115)break;case 6444:switch(Ns(t,ph(t)-3-(~uN(t,"!important")&&10))){case 107:return Qi(t,":",":"+Ji)+t;case 101:return Qi(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ji+(Ns(t,14)===45?"inline-":"")+"box$3$1"+Ji+"$2$3$1"+oo+"$2box$3")+t}break;case 5936:switch(Ns(t,e+11)){case 114:return Ji+t+oo+Qi(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ji+t+oo+Qi(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ji+t+oo+Qi(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ji+t+oo+t+t}return t}var lWe=function(e,i,r,n){if(e.length>-1&&!e.return)switch(e.type){case x5:e.return=Soe(e.value,e.length);break;case voe:return jv([kx(e,{value:Qi(e.value,"@","@"+Ji)})],n);case b5:if(e.length)return W9e(e.props,function(s){switch(j9e(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return jv([kx(e,{props:[Qi(s,/:(read-\w+)/,":"+sP+"$1")]})],n);case"::placeholder":return jv([kx(e,{props:[Qi(s,/:(plac\w+)/,":"+Ji+"input-$1")]}),kx(e,{props:[Qi(s,/:(plac\w+)/,":"+sP+"$1")]}),kx(e,{props:[Qi(s,/:(plac\w+)/,oo+"input-$1")]})],n)}return""})}},uWe=[lWe],hWe=function(e){var i=e.key;if(i==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(m){var g=m.getAttribute("data-emotion");g.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var n=e.stylisPlugins||uWe,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(m){for(var g=m.getAttribute("data-emotion").split(" "),y=1;y<g.length;y++)s[g[y]]=!0;a.push(m)});var l,u=[oWe,aWe];{var c,h=[eWe,iWe(function(m){c.insert(m)})],d=tWe(u.concat(n,h)),p=function(g){return jv(Z9e(g),d)};l=function(g,y,v,b){c=v,p(g?g+"{"+y.styles+"}":y.styles),b&&(f.inserted[y.name]=!0)}}var f={key:i,sheet:new N9e({key:i,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return f.sheet.hydrate(a),f},Aoe={exports:{}},pr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ks=typeof Symbol=="function"&&Symbol.for,_5=ks?Symbol.for("react.element"):60103,S5=ks?Symbol.for("react.portal"):60106,BT=ks?Symbol.for("react.fragment"):60107,OT=ks?Symbol.for("react.strict_mode"):60108,UT=ks?Symbol.for("react.profiler"):60114,NT=ks?Symbol.for("react.provider"):60109,FT=ks?Symbol.for("react.context"):60110,A5=ks?Symbol.for("react.async_mode"):60111,zT=ks?Symbol.for("react.concurrent_mode"):60111,HT=ks?Symbol.for("react.forward_ref"):60112,GT=ks?Symbol.for("react.suspense"):60113,cWe=ks?Symbol.for("react.suspense_list"):60120,VT=ks?Symbol.for("react.memo"):60115,jT=ks?Symbol.for("react.lazy"):60116,dWe=ks?Symbol.for("react.block"):60121,pWe=ks?Symbol.for("react.fundamental"):60117,fWe=ks?Symbol.for("react.responder"):60118,mWe=ks?Symbol.for("react.scope"):60119;function $a(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case _5:switch(t=t.type,t){case A5:case zT:case BT:case UT:case OT:case GT:return t;default:switch(t=t&&t.$$typeof,t){case FT:case HT:case jT:case VT:case NT:return t;default:return e}}case S5:return e}}}function Eoe(t){return $a(t)===zT}pr.AsyncMode=A5;pr.ConcurrentMode=zT;pr.ContextConsumer=FT;pr.ContextProvider=NT;pr.Element=_5;pr.ForwardRef=HT;pr.Fragment=BT;pr.Lazy=jT;pr.Memo=VT;pr.Portal=S5;pr.Profiler=UT;pr.StrictMode=OT;pr.Suspense=GT;pr.isAsyncMode=function(t){return Eoe(t)||$a(t)===A5};pr.isConcurrentMode=Eoe;pr.isContextConsumer=function(t){return $a(t)===FT};pr.isContextProvider=function(t){return $a(t)===NT};pr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===_5};pr.isForwardRef=function(t){return $a(t)===HT};pr.isFragment=function(t){return $a(t)===BT};pr.isLazy=function(t){return $a(t)===jT};pr.isMemo=function(t){return $a(t)===VT};pr.isPortal=function(t){return $a(t)===S5};pr.isProfiler=function(t){return $a(t)===UT};pr.isStrictMode=function(t){return $a(t)===OT};pr.isSuspense=function(t){return $a(t)===GT};pr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===BT||t===zT||t===UT||t===OT||t===GT||t===cWe||typeof t=="object"&&t!==null&&(t.$$typeof===jT||t.$$typeof===VT||t.$$typeof===NT||t.$$typeof===FT||t.$$typeof===HT||t.$$typeof===pWe||t.$$typeof===fWe||t.$$typeof===mWe||t.$$typeof===dWe)};pr.typeOf=$a;Aoe.exports=pr;var gWe=Aoe.exports,Moe=gWe,yWe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},vWe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Coe={};Coe[Moe.ForwardRef]=yWe;Coe[Moe.Memo]=vWe;var bWe=!0;function xWe(t,e,i){var r="";return i.split(" ").forEach(function(n){t[n]!==void 0?e.push(t[n]+";"):r+=n+" "}),r}var Poe=function(e,i,r){var n=e.key+"-"+i.name;(r===!1||bWe===!1)&&e.registered[n]===void 0&&(e.registered[n]=i.styles)},wWe=function(e,i,r){Poe(e,i,r);var n=e.key+"-"+i.name;if(e.inserted[i.name]===void 0){var s=i;do e.insert(i===s?"."+n:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function _We(t){for(var e=0,i,r=0,n=t.length;n>=4;++r,n-=4)i=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,e=(i&65535)*1540483477+((i>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(n){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var SWe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},AWe=/[A-Z]|^ms/g,EWe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Toe=function(e){return e.charCodeAt(1)===45},vY=function(e){return e!=null&&typeof e!="boolean"},jI=goe(function(t){return Toe(t)?t:t.replace(AWe,"-$&").toLowerCase()}),bY=function(e,i){switch(e){case"animation":case"animationName":if(typeof i=="string")return i.replace(EWe,function(r,n,s){return fh={name:n,styles:s,next:fh},n})}return SWe[e]!==1&&!Toe(e)&&typeof i=="number"&&i!==0?i+"px":i};function U1(t,e,i){if(i==null)return"";if(i.__emotion_styles!==void 0)return i;switch(typeof i){case"boolean":return"";case"object":{if(i.anim===1)return fh={name:i.name,styles:i.styles,next:fh},i.name;if(i.styles!==void 0){var r=i.next;if(r!==void 0)for(;r!==void 0;)fh={name:r.name,styles:r.styles,next:fh},r=r.next;var n=i.styles+";";return n}return MWe(t,e,i)}case"function":{if(t!==void 0){var s=fh,o=i(t);return fh=s,U1(t,e,o)}break}}if(e==null)return i;var a=e[i];return a!==void 0?a:i}function MWe(t,e,i){var r="";if(Array.isArray(i))for(var n=0;n<i.length;n++)r+=U1(t,e,i[n])+";";else for(var s in i){var o=i[s];if(typeof o!="object")e!=null&&e[o]!==void 0?r+=s+"{"+e[o]+"}":vY(o)&&(r+=jI(s)+":"+bY(s,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var a=0;a<o.length;a++)vY(o[a])&&(r+=jI(s)+":"+bY(s,o[a])+";");else{var l=U1(t,e,o);switch(s){case"animation":case"animationName":{r+=jI(s)+":"+l+";";break}default:r+=s+"{"+l+"}"}}}return r}var xY=/label:\s*([^\s;\n{]+)\s*(;|$)/g,fh,Roe=function(e,i,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var n=!0,s="";fh=void 0;var o=e[0];o==null||o.raw===void 0?(n=!1,s+=U1(r,i,o)):s+=o[0];for(var a=1;a<e.length;a++)s+=U1(r,i,e[a]),n&&(s+=o[a]);xY.lastIndex=0;for(var l="",u;(u=xY.exec(s))!==null;)l+="-"+u[1];var c=_We(s)+l;return{name:c,styles:s,next:fh}},CWe=function(e){return e()},PWe=yG["useInsertionEffect"]?yG["useInsertionEffect"]:!1,TWe=PWe||CWe,koe=se.createContext(typeof HTMLElement<"u"?hWe({key:"css"}):null);koe.Provider;var RWe=function(e){return se.forwardRef(function(i,r){var n=se.useContext(koe);return e(i,n,r)})},Doe=se.createContext({});function kWe(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return Roe(e)}var E5=function(){var e=kWe.apply(void 0,arguments),i="animation-"+e.name;return{name:i,styles:"@keyframes "+i+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},DWe=B9e,IWe=function(e){return e!=="theme"},wY=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?DWe:IWe},_Y=function(e,i,r){var n;if(i){var s=i.shouldForwardProp;n=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof n!="function"&&r&&(n=e.__emotion_forwardProp),n},LWe=function(e){var i=e.cache,r=e.serialized,n=e.isStringTag;return Poe(i,r,n),TWe(function(){return wWe(i,r,n)}),null},BWe=function t(e,i){var r=e.__emotion_real===e,n=r&&e.__emotion_base||e,s,o;i!==void 0&&(s=i.label,o=i.target);var a=_Y(e,i,r),l=a||wY(n),u=!l("as");return function(){var c=arguments,h=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&h.push("label:"+s+";"),c[0]==null||c[0].raw===void 0)h.push.apply(h,c);else{h.push(c[0][0]);for(var d=c.length,p=1;p<d;p++)h.push(c[p],c[0][p])}var f=RWe(function(m,g,y){var v=u&&m.as||n,b="",_=[],A=m;if(m.theme==null){A={};for(var S in m)A[S]=m[S];A.theme=se.useContext(Doe)}typeof m.className=="string"?b=xWe(g.registered,_,m.className):m.className!=null&&(b=m.className+" ");var E=Roe(h.concat(_),g.registered,A);b+=g.key+"-"+E.name,o!==void 0&&(b+=" "+o);var M=u&&a===void 0?wY(v):l,R={};for(var C in m)u&&C==="as"||M(C)&&(R[C]=m[C]);return R.className=b,R.ref=y,se.createElement(se.Fragment,null,se.createElement(LWe,{cache:g,serialized:E,isStringTag:typeof v=="string"}),se.createElement(v,R))});return f.displayName=s!==void 0?s:"Styled("+(typeof n=="string"?n:n.displayName||n.name||"Component")+")",f.defaultProps=e.defaultProps,f.__emotion_real=f,f.__emotion_base=n,f.__emotion_styles=h,f.__emotion_forwardProp=a,Object.defineProperty(f,"toString",{value:function(){return"."+o}}),f.withComponent=function(m,g){return t(m,Ut({},i,g,{shouldForwardProp:_Y(f,g,!0)})).apply(void 0,h)},f}},OWe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cN=BWe.bind();OWe.forEach(function(t){cN[t]=cN(t)});/**
 * @mui/styled-engine v5.15.9
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function UWe(t,e){return cN(t,e)}const NWe=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},FWe=["values","unit","step"],zWe=t=>{const e=Object.keys(t).map(i=>({key:i,val:t[i]}))||[];return e.sort((i,r)=>i.val-r.val),e.reduce((i,r)=>Ut({},i,{[r.key]:r.val}),{})};function HWe(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:r=5}=t,n=Ts(t,FWe),s=zWe(e),o=Object.keys(s);function a(d){return`@media (min-width:${typeof e[d]=="number"?e[d]:d}${i})`}function l(d){return`@media (max-width:${(typeof e[d]=="number"?e[d]:d)-r/100}${i})`}function u(d,p){const f=o.indexOf(p);return`@media (min-width:${typeof e[d]=="number"?e[d]:d}${i}) and (max-width:${(f!==-1&&typeof e[o[f]]=="number"?e[o[f]]:p)-r/100}${i})`}function c(d){return o.indexOf(d)+1<o.length?u(d,o[o.indexOf(d)+1]):a(d)}function h(d){const p=o.indexOf(d);return p===0?a(o[1]):p===o.length-1?l(o[p]):u(d,o[o.indexOf(d)+1]).replace("@media","@media not all and")}return Ut({keys:o,values:s,up:a,down:l,between:u,only:c,not:h,unit:i},n)}const GWe={borderRadius:4},VWe=GWe;function _w(t,e){return e?Su(t,e,{clone:!1}):t}const M5={xs:0,sm:600,md:900,lg:1200,xl:1536},SY={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${M5[t]}px)`};function ku(t,e,i){const r=t.theme||{};if(Array.isArray(e)){const s=r.breakpoints||SY;return e.reduce((o,a,l)=>(o[s.up(s.keys[l])]=i(e[l]),o),{})}if(typeof e=="object"){const s=r.breakpoints||SY;return Object.keys(e).reduce((o,a)=>{if(Object.keys(s.values||M5).indexOf(a)!==-1){const l=s.up(a);o[l]=i(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return i(e)}function Ioe(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,n)=>{const s=t.up(n);return r[s]={},r},{}))||{}}function Loe(t,e){return t.reduce((i,r)=>{const n=i[r];return(!n||Object.keys(n).length===0)&&delete i[r],i},e)}function jWe(t,...e){const i=Ioe(t),r=[i,...e].reduce((n,s)=>Su(n,s),{});return Loe(Object.keys(i),r)}function WWe(t,e){if(typeof t!="object")return{};const i={},r=Object.keys(e);return Array.isArray(t)?r.forEach((n,s)=>{s<t.length&&(i[n]=!0)}):r.forEach(n=>{t[n]!=null&&(i[n]=!0)}),i}function WI({values:t,breakpoints:e,base:i}){const r=i||WWe(t,e),n=Object.keys(r);if(n.length===0)return t;let s;return n.reduce((o,a,l)=>(Array.isArray(t)?(o[a]=t[l]!=null?t[l]:t[s],s=l):typeof t=="object"?(o[a]=t[a]!=null?t[a]:t[s],s=a):o[a]=t,o),{})}function WT(t,e,i=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&i){const r=`vars.${e}`.split(".").reduce((n,s)=>n&&n[s]?n[s]:null,t);if(r!=null)return r}return e.split(".").reduce((r,n)=>r&&r[n]!=null?r[n]:null,t)}function oP(t,e,i,r=i){let n;return typeof t=="function"?n=t(i):Array.isArray(t)?n=t[i]||r:n=WT(t,i)||r,e&&(n=e(n,r,t)),n}function Pn(t){const{prop:e,cssProperty:i=t.prop,themeKey:r,transform:n}=t,s=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,u=WT(l,r)||{};return ku(o,a,h=>{let d=oP(u,n,h);return h===d&&typeof h=="string"&&(d=oP(u,n,`${e}${h==="default"?"":Nl(h)}`,h)),i===!1?d:{[i]:d}})};return s.propTypes={},s.filterProps=[e],s}function qWe(t){const e={};return i=>(e[i]===void 0&&(e[i]=t(i)),e[i])}const XWe={m:"margin",p:"padding"},YWe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},AY={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},KWe=qWe(t=>{if(t.length>2)if(AY[t])t=AY[t];else return[t];const[e,i]=t.split(""),r=XWe[e],n=YWe[i]||"";return Array.isArray(n)?n.map(s=>r+s):[r+n]}),C5=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],P5=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...C5,...P5];function P_(t,e,i,r){var n;const s=(n=WT(t,e,!1))!=null?n:i;return typeof s=="number"?o=>typeof o=="string"?o:s*o:Array.isArray(s)?o=>typeof o=="string"?o:s[o]:typeof s=="function"?s:()=>{}}function T5(t){return P_(t,"spacing",8)}function jm(t,e){if(typeof e=="string"||e==null)return e;const i=Math.abs(e),r=t(i);return e>=0?r:typeof r=="number"?-r:`-${r}`}function JWe(t,e){return i=>t.reduce((r,n)=>(r[n]=jm(e,i),r),{})}function QWe(t,e,i,r){if(e.indexOf(i)===-1)return null;const n=KWe(i),s=JWe(n,r),o=t[i];return ku(t,o,s)}function Boe(t,e){const i=T5(t.theme);return Object.keys(t).map(r=>QWe(t,e,r,i)).reduce(_w,{})}function $r(t){return Boe(t,C5)}$r.propTypes={};$r.filterProps=C5;function en(t){return Boe(t,P5)}en.propTypes={};en.filterProps=P5;function ZWe(t=8){if(t.mui)return t;const e=T5({spacing:t}),i=(...r)=>(r.length===0?[1]:r).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return i.mui=!0,i}function qT(...t){const e=t.reduce((r,n)=>(n.filterProps.forEach(s=>{r[s]=n}),r),{}),i=r=>Object.keys(r).reduce((n,s)=>e[s]?_w(n,e[s](r)):n,{});return i.propTypes={},i.filterProps=t.reduce((r,n)=>r.concat(n.filterProps),[]),i}function Pl(t){return typeof t!="number"?t:`${t}px solid`}function Gl(t,e){return Pn({prop:t,themeKey:"borders",transform:e})}const $We=Gl("border",Pl),eqe=Gl("borderTop",Pl),tqe=Gl("borderRight",Pl),iqe=Gl("borderBottom",Pl),rqe=Gl("borderLeft",Pl),nqe=Gl("borderColor"),sqe=Gl("borderTopColor"),oqe=Gl("borderRightColor"),aqe=Gl("borderBottomColor"),lqe=Gl("borderLeftColor"),uqe=Gl("outline",Pl),hqe=Gl("outlineColor"),XT=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=P_(t.theme,"shape.borderRadius",4),i=r=>({borderRadius:jm(e,r)});return ku(t,t.borderRadius,i)}return null};XT.propTypes={};XT.filterProps=["borderRadius"];qT($We,eqe,tqe,iqe,rqe,nqe,sqe,oqe,aqe,lqe,XT,uqe,hqe);const YT=t=>{if(t.gap!==void 0&&t.gap!==null){const e=P_(t.theme,"spacing",8),i=r=>({gap:jm(e,r)});return ku(t,t.gap,i)}return null};YT.propTypes={};YT.filterProps=["gap"];const KT=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=P_(t.theme,"spacing",8),i=r=>({columnGap:jm(e,r)});return ku(t,t.columnGap,i)}return null};KT.propTypes={};KT.filterProps=["columnGap"];const JT=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=P_(t.theme,"spacing",8),i=r=>({rowGap:jm(e,r)});return ku(t,t.rowGap,i)}return null};JT.propTypes={};JT.filterProps=["rowGap"];const cqe=Pn({prop:"gridColumn"}),dqe=Pn({prop:"gridRow"}),pqe=Pn({prop:"gridAutoFlow"}),fqe=Pn({prop:"gridAutoColumns"}),mqe=Pn({prop:"gridAutoRows"}),gqe=Pn({prop:"gridTemplateColumns"}),yqe=Pn({prop:"gridTemplateRows"}),vqe=Pn({prop:"gridTemplateAreas"}),bqe=Pn({prop:"gridArea"});qT(YT,KT,JT,cqe,dqe,pqe,fqe,mqe,gqe,yqe,vqe,bqe);function Wv(t,e){return e==="grey"?e:t}const xqe=Pn({prop:"color",themeKey:"palette",transform:Wv}),wqe=Pn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Wv}),_qe=Pn({prop:"backgroundColor",themeKey:"palette",transform:Wv});qT(xqe,wqe,_qe);function Na(t){return t<=1&&t!==0?`${t*100}%`:t}const Sqe=Pn({prop:"width",transform:Na}),R5=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=i=>{var r,n;const s=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[i])||M5[i];return s?((n=t.theme)==null||(n=n.breakpoints)==null?void 0:n.unit)!=="px"?{maxWidth:`${s}${t.theme.breakpoints.unit}`}:{maxWidth:s}:{maxWidth:Na(i)}};return ku(t,t.maxWidth,e)}return null};R5.filterProps=["maxWidth"];const Aqe=Pn({prop:"minWidth",transform:Na}),Eqe=Pn({prop:"height",transform:Na}),Mqe=Pn({prop:"maxHeight",transform:Na}),Cqe=Pn({prop:"minHeight",transform:Na});Pn({prop:"size",cssProperty:"width",transform:Na});Pn({prop:"size",cssProperty:"height",transform:Na});const Pqe=Pn({prop:"boxSizing"});qT(Sqe,R5,Aqe,Eqe,Mqe,Cqe,Pqe);const Tqe={border:{themeKey:"borders",transform:Pl},borderTop:{themeKey:"borders",transform:Pl},borderRight:{themeKey:"borders",transform:Pl},borderBottom:{themeKey:"borders",transform:Pl},borderLeft:{themeKey:"borders",transform:Pl},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Pl},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:XT},color:{themeKey:"palette",transform:Wv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Wv},backgroundColor:{themeKey:"palette",transform:Wv},p:{style:en},pt:{style:en},pr:{style:en},pb:{style:en},pl:{style:en},px:{style:en},py:{style:en},padding:{style:en},paddingTop:{style:en},paddingRight:{style:en},paddingBottom:{style:en},paddingLeft:{style:en},paddingX:{style:en},paddingY:{style:en},paddingInline:{style:en},paddingInlineStart:{style:en},paddingInlineEnd:{style:en},paddingBlock:{style:en},paddingBlockStart:{style:en},paddingBlockEnd:{style:en},m:{style:$r},mt:{style:$r},mr:{style:$r},mb:{style:$r},ml:{style:$r},mx:{style:$r},my:{style:$r},margin:{style:$r},marginTop:{style:$r},marginRight:{style:$r},marginBottom:{style:$r},marginLeft:{style:$r},marginX:{style:$r},marginY:{style:$r},marginInline:{style:$r},marginInlineStart:{style:$r},marginInlineEnd:{style:$r},marginBlock:{style:$r},marginBlockStart:{style:$r},marginBlockEnd:{style:$r},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:YT},rowGap:{style:JT},columnGap:{style:KT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Na},maxWidth:{style:R5},minWidth:{transform:Na},height:{transform:Na},maxHeight:{transform:Na},minHeight:{transform:Na},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},QT=Tqe;function Rqe(...t){const e=t.reduce((r,n)=>r.concat(Object.keys(n)),[]),i=new Set(e);return t.every(r=>i.size===Object.keys(r).length)}function kqe(t,e){return typeof t=="function"?t(e):t}function Dqe(){function t(i,r,n,s){const o={[i]:r,theme:n},a=s[i];if(!a)return{[i]:r};const{cssProperty:l=i,themeKey:u,transform:c,style:h}=a;if(r==null)return null;if(u==="typography"&&r==="inherit")return{[i]:r};const d=WT(n,u)||{};return h?h(o):ku(o,r,f=>{let m=oP(d,c,f);return f===m&&typeof f=="string"&&(m=oP(d,c,`${i}${f==="default"?"":Nl(f)}`,f)),l===!1?m:{[l]:m}})}function e(i){var r;const{sx:n,theme:s={}}=i||{};if(!n)return null;const o=(r=s.unstable_sxConfig)!=null?r:QT;function a(l){let u=l;if(typeof l=="function")u=l(s);else if(typeof l!="object")return l;if(!u)return null;const c=Ioe(s.breakpoints),h=Object.keys(c);let d=c;return Object.keys(u).forEach(p=>{const f=kqe(u[p],s);if(f!=null)if(typeof f=="object")if(o[p])d=_w(d,t(p,f,s,o));else{const m=ku({theme:s},f,g=>({[p]:g}));Rqe(m,f)?d[p]=e({sx:f,theme:s}):d=_w(d,m)}else d=_w(d,t(p,f,s,o))}),Loe(h,d)}return Array.isArray(n)?n.map(a):a(n)}return e}const Ooe=Dqe();Ooe.filterProps=["sx"];const k5=Ooe;function Iqe(t,e){const i=this;return i.vars&&typeof i.getColorSchemeSelector=="function"?{[i.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:i.palette.mode===t?e:{}}const Lqe=["breakpoints","palette","spacing","shape"];function ZT(t={},...e){const{breakpoints:i={},palette:r={},spacing:n,shape:s={}}=t,o=Ts(t,Lqe),a=HWe(i),l=ZWe(n);let u=Su({breakpoints:a,direction:"ltr",components:{},palette:Ut({mode:"light"},r),spacing:l,shape:Ut({},VWe,s)},o);return u.applyStyles=Iqe,u=e.reduce((c,h)=>Su(c,h),u),u.unstable_sxConfig=Ut({},QT,o==null?void 0:o.unstable_sxConfig),u.unstable_sx=function(h){return k5({sx:h,theme:this})},u}function Bqe(t){return Object.keys(t).length===0}function Oqe(t=null){const e=se.useContext(Doe);return!e||Bqe(e)?t:e}const Uqe=ZT();function Uoe(t=Uqe){return Oqe(t)}const Nqe=["sx"],Fqe=t=>{var e,i;const r={systemProps:{},otherProps:{}},n=(e=t==null||(i=t.theme)==null?void 0:i.unstable_sxConfig)!=null?e:QT;return Object.keys(t).forEach(s=>{n[s]?r.systemProps[s]=t[s]:r.otherProps[s]=t[s]}),r};function zqe(t){const{sx:e}=t,i=Ts(t,Nqe),{systemProps:r,otherProps:n}=Fqe(i);let s;return Array.isArray(e)?s=[r,...e]:typeof e=="function"?s=(...o)=>{const a=e(...o);return sp(a)?Ut({},r,a):r}:s=Ut({},r,e),Ut({},n,{sx:s})}const Hqe=["ownerState"],Gqe=["variants"],Vqe=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function jqe(t){return Object.keys(t).length===0}function Wqe(t){return typeof t=="string"&&t.charCodeAt(0)>96}function cC(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const qqe=ZT(),Xqe=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function cM({defaultTheme:t,theme:e,themeId:i}){return jqe(e)?t:e[i]||e}function Yqe(t){return t?(e,i)=>i[t]:null}function dC(t,e){let{ownerState:i}=e,r=Ts(e,Hqe);const n=typeof t=="function"?t(Ut({ownerState:i},r)):t;if(Array.isArray(n))return n.flatMap(s=>dC(s,Ut({ownerState:i},r)));if(n&&typeof n=="object"&&Array.isArray(n.variants)){const{variants:s=[]}=n;let a=Ts(n,Gqe);return s.forEach(l=>{let u=!0;typeof l.props=="function"?u=l.props(Ut({ownerState:i},r)):Object.keys(l.props).forEach(c=>{(i==null?void 0:i[c])!==l.props[c]&&r[c]!==l.props[c]&&(u=!1)}),u&&(Array.isArray(a)||(a=[a]),a.push(typeof l.style=="function"?l.style(Ut({ownerState:i},r)):l.style))}),a}return n}function Noe(t={}){const{themeId:e,defaultTheme:i=qqe,rootShouldForwardProp:r=cC,slotShouldForwardProp:n=cC}=t,s=o=>k5(Ut({},o,{theme:cM(Ut({},o,{defaultTheme:i,themeId:e}))}));return s.__mui_systemSx=!0,(o,a={})=>{NWe(o,A=>A.filter(S=>!(S!=null&&S.__mui_systemSx)));const{name:l,slot:u,skipVariantsResolver:c,skipSx:h,overridesResolver:d=Yqe(Xqe(u))}=a,p=Ts(a,Vqe),f=c!==void 0?c:u&&u!=="Root"&&u!=="root"||!1,m=h||!1;let g,y=cC;u==="Root"||u==="root"?y=r:u?y=n:Wqe(o)&&(y=void 0);const v=UWe(o,Ut({shouldForwardProp:y,label:g},p)),b=A=>typeof A=="function"&&A.__emotion_real!==A||sp(A)?S=>dC(A,Ut({},S,{theme:cM({theme:S.theme,defaultTheme:i,themeId:e})})):A,_=(A,...S)=>{let E=b(A);const M=S?S.map(b):[];l&&d&&M.push(T=>{const L=cM(Ut({},T,{defaultTheme:i,themeId:e}));if(!L.components||!L.components[l]||!L.components[l].styleOverrides)return null;const I=L.components[l].styleOverrides,D={};return Object.entries(I).forEach(([F,H])=>{D[F]=dC(H,Ut({},T,{theme:L}))}),d(T,D)}),l&&!f&&M.push(T=>{var L;const I=cM(Ut({},T,{defaultTheme:i,themeId:e})),D=I==null||(L=I.components)==null||(L=L[l])==null?void 0:L.variants;return dC({variants:D},Ut({},T,{theme:I}))}),m||M.push(s);const R=M.length-S.length;if(Array.isArray(A)&&R>0){const T=new Array(R).fill("");E=[...A,...T],E.raw=[...A.raw,...T]}const C=v(E,...M);return o.muiName&&(C.muiName=o.muiName),C};return v.withConfig&&(_.withConfig=v.withConfig),_}}const Kqe=Noe(),Jqe=Kqe;function Qqe(t){const{theme:e,name:i,props:r}=t;return!e||!e.components||!e.components[i]||!e.components[i].defaultProps?r:moe(e.components[i].defaultProps,r)}function Foe({props:t,name:e,defaultTheme:i,themeId:r}){let n=Uoe(i);return r&&(n=n[r]||n),Qqe({theme:n,name:e,props:t})}function D5(t,e=0,i=1){return I9e(t,e,i)}function Zqe(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let i=t.match(e);return i&&i[0].length===1&&(i=i.map(r=>r+r)),i?`rgb${i.length===4?"a":""}(${i.map((r,n)=>n<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Wm(t){if(t.type)return t;if(t.charAt(0)==="#")return Wm(Zqe(t));const e=t.indexOf("("),i=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(i)===-1)throw new Error(M0(9,t));let r=t.substring(e+1,t.length-1),n;if(i==="color"){if(r=r.split(" "),n=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n)===-1)throw new Error(M0(10,n))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:i,values:r,colorSpace:n}}function $T(t){const{type:e,colorSpace:i}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((n,s)=>s<3?parseInt(n,10):n):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${i} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function $qe(t){t=Wm(t);const{values:e}=t,i=e[0],r=e[1]/100,n=e[2]/100,s=r*Math.min(n,1-n),o=(u,c=(u+i/30)%12)=>n-s*Math.max(Math.min(c-3,9-c,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),$T({type:a,values:l})}function EY(t){t=Wm(t);let e=t.type==="hsl"||t.type==="hsla"?Wm($qe(t)).values:t.values;return e=e.map(i=>(t.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function e7e(t,e){const i=EY(t),r=EY(e);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)}function ky(t,e){return t=Wm(t),e=D5(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,$T(t)}function t7e(t,e){if(t=Wm(t),e=D5(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)t.values[i]*=1-e;return $T(t)}function i7e(t,e){if(t=Wm(t),e=D5(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let i=0;i<3;i+=1)t.values[i]+=(255-t.values[i])*e;else if(t.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)t.values[i]+=(1-t.values[i])*e;return $T(t)}const r7e=["component","direction","spacing","divider","children","className","useFlexGap"],n7e=ZT(),s7e=Jqe("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function o7e(t){return Foe({props:t,name:"MuiStack",defaultTheme:n7e})}function a7e(t,e){const i=se.Children.toArray(t).filter(Boolean);return i.reduce((r,n,s)=>(r.push(n),s<i.length-1&&r.push(se.cloneElement(e,{key:`separator-${s}`})),r),[])}const l7e=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],u7e=({ownerState:t,theme:e})=>{let i=Ut({display:"flex",flexDirection:"column"},ku({theme:e},WI({values:t.direction,breakpoints:e.breakpoints.values}),r=>({flexDirection:r})));if(t.spacing){const r=T5(e),n=Object.keys(e.breakpoints.values).reduce((l,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(l[u]=!0),l),{}),s=WI({values:t.direction,base:n}),o=WI({values:t.spacing,base:n});typeof s=="object"&&Object.keys(s).forEach((l,u,c)=>{if(!s[l]){const d=u>0?s[c[u-1]]:"column";s[l]=d}}),i=Su(i,ku({theme:e},o,(l,u)=>t.useFlexGap?{gap:jm(r,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${l7e(u?s[u]:t.direction)}`]:jm(r,l)}}))}return i=jWe(e.breakpoints,i),i};function h7e(t={}){const{createStyledComponent:e=s7e,useThemeProps:i=o7e,componentName:r="MuiStack"}=t,n=()=>E_({root:["root"]},l=>ab(r,l),{}),s=e(u7e);return se.forwardRef(function(l,u){const c=i(l),h=zqe(c),{component:d="div",direction:p="column",spacing:f=0,divider:m,children:g,className:y,useFlexGap:v=!1}=h,b=Ts(h,r7e),_={direction:p,spacing:f,useFlexGap:v},A=n();return U.jsx(s,Ut({as:d,ownerState:_,ref:u,className:Oo(A.root,y)},b,{children:m?a7e(g,m):g}))})}function c7e(t,e){return Ut({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const d7e={black:"#000",white:"#fff"},N1=d7e,p7e={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},f7e=p7e,m7e={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Dy=m7e,g7e={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Iy=g7e,y7e={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Dx=y7e,v7e={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ly=v7e,b7e={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},By=b7e,x7e={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Oy=x7e,w7e=["mode","contrastThreshold","tonalOffset"],MY={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:N1.white,default:N1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},qI={text:{primary:N1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:N1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function CY(t,e,i,r){const n=r.light||r,s=r.dark||r*1.5;t[e]||(t.hasOwnProperty(i)?t[e]=t[i]:e==="light"?t.light=i7e(t.main,n):e==="dark"&&(t.dark=t7e(t.main,s)))}function _7e(t="light"){return t==="dark"?{main:Ly[200],light:Ly[50],dark:Ly[400]}:{main:Ly[700],light:Ly[400],dark:Ly[800]}}function S7e(t="light"){return t==="dark"?{main:Dy[200],light:Dy[50],dark:Dy[400]}:{main:Dy[500],light:Dy[300],dark:Dy[700]}}function A7e(t="light"){return t==="dark"?{main:Iy[500],light:Iy[300],dark:Iy[700]}:{main:Iy[700],light:Iy[400],dark:Iy[800]}}function E7e(t="light"){return t==="dark"?{main:By[400],light:By[300],dark:By[700]}:{main:By[700],light:By[500],dark:By[900]}}function M7e(t="light"){return t==="dark"?{main:Oy[400],light:Oy[300],dark:Oy[700]}:{main:Oy[800],light:Oy[500],dark:Oy[900]}}function C7e(t="light"){return t==="dark"?{main:Dx[400],light:Dx[300],dark:Dx[700]}:{main:"#ed6c02",light:Dx[500],dark:Dx[900]}}function P7e(t){const{mode:e="light",contrastThreshold:i=3,tonalOffset:r=.2}=t,n=Ts(t,w7e),s=t.primary||_7e(e),o=t.secondary||S7e(e),a=t.error||A7e(e),l=t.info||E7e(e),u=t.success||M7e(e),c=t.warning||C7e(e);function h(m){return e7e(m,qI.text.primary)>=i?qI.text.primary:MY.text.primary}const d=({color:m,name:g,mainShade:y=500,lightShade:v=300,darkShade:b=700})=>{if(m=Ut({},m),!m.main&&m[y]&&(m.main=m[y]),!m.hasOwnProperty("main"))throw new Error(M0(11,g?` (${g})`:"",y));if(typeof m.main!="string")throw new Error(M0(12,g?` (${g})`:"",JSON.stringify(m.main)));return CY(m,"light",v,r),CY(m,"dark",b,r),m.contrastText||(m.contrastText=h(m.main)),m},p={dark:qI,light:MY};return Su(Ut({common:Ut({},N1),mode:e,primary:d({color:s,name:"primary"}),secondary:d({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:d({color:a,name:"error"}),warning:d({color:c,name:"warning"}),info:d({color:l,name:"info"}),success:d({color:u,name:"success"}),grey:f7e,contrastThreshold:i,getContrastText:h,augmentColor:d,tonalOffset:r},p[e]),n)}const T7e=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function R7e(t){return Math.round(t*1e5)/1e5}const PY={textTransform:"uppercase"},TY='"Roboto", "Helvetica", "Arial", sans-serif';function k7e(t,e){const i=typeof e=="function"?e(t):e,{fontFamily:r=TY,fontSize:n=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:c,pxToRem:h}=i,d=Ts(i,T7e),p=n/14,f=h||(y=>`${y/u*p}rem`),m=(y,v,b,_,A)=>Ut({fontFamily:r,fontWeight:y,fontSize:f(v),lineHeight:b},r===TY?{letterSpacing:`${R7e(_/v)}em`}:{},A,c),g={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(o,48,1.167,0),h4:m(o,34,1.235,.25),h5:m(o,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(o,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(o,16,1.5,.15),body2:m(o,14,1.43,.15),button:m(a,14,1.75,.4,PY),caption:m(o,12,1.66,.4),overline:m(o,12,2.66,1,PY),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Su(Ut({htmlFontSize:u,pxToRem:f,fontFamily:r,fontSize:n,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l},g),d,{clone:!1})}const D7e=.2,I7e=.14,L7e=.12;function Ur(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${D7e})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${I7e})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${L7e})`].join(",")}const B7e=["none",Ur(0,2,1,-1,0,1,1,0,0,1,3,0),Ur(0,3,1,-2,0,2,2,0,0,1,5,0),Ur(0,3,3,-2,0,3,4,0,0,1,8,0),Ur(0,2,4,-1,0,4,5,0,0,1,10,0),Ur(0,3,5,-1,0,5,8,0,0,1,14,0),Ur(0,3,5,-1,0,6,10,0,0,1,18,0),Ur(0,4,5,-2,0,7,10,1,0,2,16,1),Ur(0,5,5,-3,0,8,10,1,0,3,14,2),Ur(0,5,6,-3,0,9,12,1,0,3,16,2),Ur(0,6,6,-3,0,10,14,1,0,4,18,3),Ur(0,6,7,-4,0,11,15,1,0,4,20,3),Ur(0,7,8,-4,0,12,17,2,0,5,22,4),Ur(0,7,8,-4,0,13,19,2,0,5,24,4),Ur(0,7,9,-4,0,14,21,2,0,5,26,4),Ur(0,8,9,-5,0,15,22,2,0,6,28,5),Ur(0,8,10,-5,0,16,24,2,0,6,30,5),Ur(0,8,11,-5,0,17,26,2,0,6,32,5),Ur(0,9,11,-5,0,18,28,2,0,7,34,6),Ur(0,9,12,-6,0,19,29,2,0,7,36,6),Ur(0,10,13,-6,0,20,31,3,0,8,38,7),Ur(0,10,13,-6,0,21,33,3,0,8,40,7),Ur(0,10,14,-6,0,22,35,3,0,8,42,7),Ur(0,11,14,-7,0,23,36,3,0,9,44,8),Ur(0,11,15,-7,0,24,38,3,0,9,46,8)],O7e=B7e,U7e=["duration","easing","delay"],N7e={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},F7e={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function RY(t){return`${Math.round(t)}ms`}function z7e(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function H7e(t){const e=Ut({},N7e,t.easing),i=Ut({},F7e,t.duration);return Ut({getAutoHeightDuration:z7e,create:(n=["all"],s={})=>{const{duration:o=i.standard,easing:a=e.easeInOut,delay:l=0}=s;return Ts(s,U7e),(Array.isArray(n)?n:[n]).map(u=>`${u} ${typeof o=="string"?o:RY(o)} ${a} ${typeof l=="string"?l:RY(l)}`).join(",")}},t,{easing:e,duration:i})}const G7e={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},V7e=G7e,j7e=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function W7e(t={},...e){const{mixins:i={},palette:r={},transitions:n={},typography:s={}}=t,o=Ts(t,j7e);if(t.vars)throw new Error(M0(18));const a=P7e(r),l=ZT(t);let u=Su(l,{mixins:c7e(l.breakpoints,i),palette:a,shadows:O7e.slice(),typography:k7e(a,s),transitions:H7e(n),zIndex:Ut({},V7e)});return u=Su(u,o),u=e.reduce((c,h)=>Su(c,h),u),u.unstable_sxConfig=Ut({},QT,o==null?void 0:o.unstable_sxConfig),u.unstable_sx=function(h){return k5({sx:h,theme:this})},u}const q7e=W7e(),I5=q7e,L5="$$material";function ub({props:t,name:e}){return Foe({props:t,name:e,defaultTheme:I5,themeId:L5})}function X7e(t){return ab("MuiPagination",t)}M_("MuiPagination",["root","ul","outlined","text"]);const Y7e=["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"];function K7e(t={}){const{boundaryCount:e=1,componentName:i="usePagination",count:r=1,defaultPage:n=1,disabled:s=!1,hideNextButton:o=!1,hidePrevButton:a=!1,onChange:l,page:u,showFirstButton:c=!1,showLastButton:h=!1,siblingCount:d=1}=t,p=Ts(t,Y7e),[f,m]=g9e({controlled:u,default:n,name:i,state:"page"}),g=(R,C)=>{u||m(C),l&&l(R,C)},y=(R,C)=>{const T=C-R+1;return Array.from({length:T},(L,I)=>R+I)},v=y(1,Math.min(e,r)),b=y(Math.max(r-e+1,e+1),r),_=Math.max(Math.min(f-d,r-e-d*2-1),e+2),A=Math.min(Math.max(f+d,e+d*2+2),b.length>0?b[0]-2:r-1),S=[...c?["first"]:[],...a?[]:["previous"],...v,..._>e+2?["start-ellipsis"]:e+1<r-e?[e+1]:[],...y(_,A),...A<r-e-1?["end-ellipsis"]:r-e>e?[r-e]:[],...b,...o?[]:["next"],...h?["last"]:[]],E=R=>{switch(R){case"first":return 1;case"previous":return f-1;case"next":return f+1;case"last":return r;default:return null}},M=S.map(R=>typeof R=="number"?{onClick:C=>{g(C,R)},type:"page",page:R,selected:R===f,disabled:s,"aria-current":R===f?"true":void 0}:{onClick:C=>{g(C,E(R))},type:R,page:E(R),selected:!1,disabled:s||R.indexOf("ellipsis")===-1&&(R==="next"||R==="last"?f>=r:f<=1)});return Ut({items:M},p)}function J7e(t){return ab("MuiPaginationItem",t)}const Q7e=M_("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),gl=Q7e;function Z7e(){const t=Uoe(I5);return t[L5]||t}const $7e=t=>cC(t)&&t!=="classes",eXe=Noe({themeId:L5,defaultTheme:I5,rootShouldForwardProp:$7e}),Yh=eXe;function dN(t,e){return dN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dN(t,e)}function tXe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,dN(t,e)}const kY=Ho.createContext(null);function iXe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B5(t,e){var i=function(s){return e&&se.isValidElement(s)?e(s):s},r=Object.create(null);return t&&se.Children.map(t,function(n){return n}).forEach(function(n){r[n.key]=i(n)}),r}function rXe(t,e){t=t||{},e=e||{};function i(c){return c in e?e[c]:t[c]}var r=Object.create(null),n=[];for(var s in t)s in e?n.length&&(r[s]=n,n=[]):n.push(s);var o,a={};for(var l in e){if(r[l])for(o=0;o<r[l].length;o++){var u=r[l][o];a[r[l][o]]=i(u)}a[l]=i(l)}for(o=0;o<n.length;o++)a[n[o]]=i(n[o]);return a}function lm(t,e,i){return i[e]!=null?i[e]:t.props[e]}function nXe(t,e){return B5(t.children,function(i){return se.cloneElement(i,{onExited:e.bind(null,i),in:!0,appear:lm(i,"appear",t),enter:lm(i,"enter",t),exit:lm(i,"exit",t)})})}function sXe(t,e,i){var r=B5(t.children),n=rXe(e,r);return Object.keys(n).forEach(function(s){var o=n[s];if(se.isValidElement(o)){var a=s in e,l=s in r,u=e[s],c=se.isValidElement(u)&&!u.props.in;l&&(!a||c)?n[s]=se.cloneElement(o,{onExited:i.bind(null,o),in:!0,exit:lm(o,"exit",t),enter:lm(o,"enter",t)}):!l&&a&&!c?n[s]=se.cloneElement(o,{in:!1}):l&&a&&se.isValidElement(u)&&(n[s]=se.cloneElement(o,{onExited:i.bind(null,o),in:u.props.in,exit:lm(o,"exit",t),enter:lm(o,"enter",t)}))}}),n}var oXe=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},aXe={component:"div",childFactory:function(e){return e}},O5=function(t){tXe(e,t);function e(r,n){var s;s=t.call(this,r,n)||this;var o=s.handleExited.bind(iXe(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var i=e.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(n,s){var o=s.children,a=s.handleExited,l=s.firstRender;return{children:l?nXe(n,a):sXe(n,o,a),firstRender:!1}},i.handleExited=function(n,s){var o=B5(this.props.children);n.key in o||(n.props.onExited&&n.props.onExited(s),this.mounted&&this.setState(function(a){var l=Ut({},a.children);return delete l[n.key],{children:l}}))},i.render=function(){var n=this.props,s=n.component,o=n.childFactory,a=Ts(n,["component","childFactory"]),l=this.state.contextValue,u=oXe(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,s===null?Ho.createElement(kY.Provider,{value:l},u):Ho.createElement(kY.Provider,{value:l},Ho.createElement(s,a,u))},e}(Ho.Component);O5.propTypes={};O5.defaultProps=aXe;const lXe=O5;function uXe(t){const{className:e,classes:i,pulsate:r=!1,rippleX:n,rippleY:s,rippleSize:o,in:a,onExited:l,timeout:u}=t,[c,h]=se.useState(!1),d=Oo(e,i.ripple,i.rippleVisible,r&&i.ripplePulsate),p={width:o,height:o,top:-(o/2)+s,left:-(o/2)+n},f=Oo(i.child,c&&i.childLeaving,r&&i.childPulsate);return!a&&!c&&h(!0),se.useEffect(()=>{if(!a&&l!=null){const m=setTimeout(l,u);return()=>{clearTimeout(m)}}},[l,a,u]),U.jsx("span",{className:d,style:p,children:U.jsx("span",{className:f})})}const hXe=M_("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),_l=hXe,cXe=["center","classes","className"];let eR=t=>t,DY,IY,LY,BY;const pN=550,dXe=80,pXe=E5(DY||(DY=eR`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),fXe=E5(IY||(IY=eR`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),mXe=E5(LY||(LY=eR`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),gXe=Yh("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),yXe=Yh(uXe,{name:"MuiTouchRipple",slot:"Ripple"})(BY||(BY=eR`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),_l.rippleVisible,pXe,pN,({theme:t})=>t.transitions.easing.easeInOut,_l.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,_l.child,_l.childLeaving,fXe,pN,({theme:t})=>t.transitions.easing.easeInOut,_l.childPulsate,mXe,({theme:t})=>t.transitions.easing.easeInOut),vXe=se.forwardRef(function(e,i){const r=ub({props:e,name:"MuiTouchRipple"}),{center:n=!1,classes:s={},className:o}=r,a=Ts(r,cXe),[l,u]=se.useState([]),c=se.useRef(0),h=se.useRef(null);se.useEffect(()=>{h.current&&(h.current(),h.current=null)},[l]);const d=se.useRef(!1),p=x9e(),f=se.useRef(null),m=se.useRef(null),g=se.useCallback(_=>{const{pulsate:A,rippleX:S,rippleY:E,rippleSize:M,cb:R}=_;u(C=>[...C,U.jsx(yXe,{classes:{ripple:Oo(s.ripple,_l.ripple),rippleVisible:Oo(s.rippleVisible,_l.rippleVisible),ripplePulsate:Oo(s.ripplePulsate,_l.ripplePulsate),child:Oo(s.child,_l.child),childLeaving:Oo(s.childLeaving,_l.childLeaving),childPulsate:Oo(s.childPulsate,_l.childPulsate)},timeout:pN,pulsate:A,rippleX:S,rippleY:E,rippleSize:M},c.current)]),c.current+=1,h.current=R},[s]),y=se.useCallback((_={},A={},S=()=>{})=>{const{pulsate:E=!1,center:M=n||A.pulsate,fakeElement:R=!1}=A;if((_==null?void 0:_.type)==="mousedown"&&d.current){d.current=!1;return}(_==null?void 0:_.type)==="touchstart"&&(d.current=!0);const C=R?null:m.current,T=C?C.getBoundingClientRect():{width:0,height:0,left:0,top:0};let L,I,D;if(M||_===void 0||_.clientX===0&&_.clientY===0||!_.clientX&&!_.touches)L=Math.round(T.width/2),I=Math.round(T.height/2);else{const{clientX:F,clientY:H}=_.touches&&_.touches.length>0?_.touches[0]:_;L=Math.round(F-T.left),I=Math.round(H-T.top)}if(M)D=Math.sqrt((2*T.width**2+T.height**2)/3),D%2===0&&(D+=1);else{const F=Math.max(Math.abs((C?C.clientWidth:0)-L),L)*2+2,H=Math.max(Math.abs((C?C.clientHeight:0)-I),I)*2+2;D=Math.sqrt(F**2+H**2)}_!=null&&_.touches?f.current===null&&(f.current=()=>{g({pulsate:E,rippleX:L,rippleY:I,rippleSize:D,cb:S})},p.start(dXe,()=>{f.current&&(f.current(),f.current=null)})):g({pulsate:E,rippleX:L,rippleY:I,rippleSize:D,cb:S})},[n,g,p]),v=se.useCallback(()=>{y({},{pulsate:!0})},[y]),b=se.useCallback((_,A)=>{if(p.clear(),(_==null?void 0:_.type)==="touchend"&&f.current){f.current(),f.current=null,p.start(0,()=>{b(_,A)});return}f.current=null,u(S=>S.length>0?S.slice(1):S),h.current=A},[p]);return se.useImperativeHandle(i,()=>({pulsate:v,start:y,stop:b}),[v,y,b]),U.jsx(gXe,Ut({className:Oo(_l.root,s.root,o),ref:m},a,{children:U.jsx(lXe,{component:null,exit:!0,children:l})}))}),bXe=vXe;function xXe(t){return ab("MuiButtonBase",t)}const wXe=M_("MuiButtonBase",["root","disabled","focusVisible"]),_Xe=wXe,SXe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],AXe=t=>{const{disabled:e,focusVisible:i,focusVisibleClassName:r,classes:n}=t,o=E_({root:["root",e&&"disabled",i&&"focusVisible"]},xXe,n);return i&&r&&(o.root+=` ${r}`),o},EXe=Yh("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${_Xe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),MXe=se.forwardRef(function(e,i){const r=ub({props:e,name:"MuiButtonBase"}),{action:n,centerRipple:s=!1,children:o,className:a,component:l="button",disabled:u=!1,disableRipple:c=!1,disableTouchRipple:h=!1,focusRipple:d=!1,LinkComponent:p="a",onBlur:f,onClick:m,onContextMenu:g,onDragLeave:y,onFocus:v,onFocusVisible:b,onKeyDown:_,onKeyUp:A,onMouseDown:S,onMouseLeave:E,onMouseUp:M,onTouchEnd:R,onTouchMove:C,onTouchStart:T,tabIndex:L=0,TouchRippleProps:I,touchRippleRef:D,type:F}=r,H=Ts(r,SXe),z=se.useRef(null),B=se.useRef(null),j=dY(B,D),{isFocusVisibleRef:V,onFocus:q,onBlur:K,ref:le}=P9e(),[Z,oe]=se.useState(!1);u&&Z&&oe(!1),se.useImperativeHandle(n,()=>({focusVisible:()=>{oe(!0),z.current.focus()}}),[]);const[ae,ve]=se.useState(!1);se.useEffect(()=>{ve(!0)},[]);const ye=ae&&!c&&!u;se.useEffect(()=>{Z&&d&&!c&&ae&&B.current.pulsate()},[c,d,Z,ae]);function pe(ze,ge,ct=h){return uM(rt=>(ge&&ge(rt),!ct&&B.current&&B.current[ze](rt),!0))}const Se=pe("start",S),be=pe("stop",g),ee=pe("stop",y),_e=pe("stop",M),Me=pe("stop",ze=>{Z&&ze.preventDefault(),E&&E(ze)}),Ce=pe("start",T),Re=pe("stop",R),Xe=pe("stop",C),Oe=pe("stop",ze=>{K(ze),V.current===!1&&oe(!1),f&&f(ze)},!1),$=uM(ze=>{z.current||(z.current=ze.currentTarget),q(ze),V.current===!0&&(oe(!0),b&&b(ze)),v&&v(ze)}),J=()=>{const ze=z.current;return l&&l!=="button"&&!(ze.tagName==="A"&&ze.href)},we=se.useRef(!1),te=uM(ze=>{d&&!we.current&&Z&&B.current&&ze.key===" "&&(we.current=!0,B.current.stop(ze,()=>{B.current.start(ze)})),ze.target===ze.currentTarget&&J()&&ze.key===" "&&ze.preventDefault(),_&&_(ze),ze.target===ze.currentTarget&&J()&&ze.key==="Enter"&&!u&&(ze.preventDefault(),m&&m(ze))}),Y=uM(ze=>{d&&ze.key===" "&&B.current&&Z&&!ze.defaultPrevented&&(we.current=!1,B.current.stop(ze,()=>{B.current.pulsate(ze)})),A&&A(ze),m&&ze.target===ze.currentTarget&&J()&&ze.key===" "&&!ze.defaultPrevented&&m(ze)});let ce=l;ce==="button"&&(H.href||H.to)&&(ce=p);const Le={};ce==="button"?(Le.type=F===void 0?"button":F,Le.disabled=u):(!H.href&&!H.to&&(Le.role="button"),u&&(Le["aria-disabled"]=u));const X=dY(i,le,z),Ue=Ut({},r,{centerRipple:s,component:l,disabled:u,disableRipple:c,disableTouchRipple:h,focusRipple:d,tabIndex:L,focusVisible:Z}),et=AXe(Ue);return U.jsxs(EXe,Ut({as:ce,className:Oo(et.root,a),ownerState:Ue,onBlur:Oe,onClick:m,onContextMenu:be,onFocus:$,onKeyDown:te,onKeyUp:Y,onMouseDown:Se,onMouseLeave:Me,onMouseUp:_e,onDragLeave:ee,onTouchEnd:Re,onTouchMove:Xe,onTouchStart:Ce,ref:X,tabIndex:u?-1:L,type:F},Le,H,{children:[o,ye?U.jsx(bXe,Ut({ref:j,center:s},I)):null]}))}),CXe=MXe;function PXe(t){return ab("MuiSvgIcon",t)}M_("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const TXe=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],RXe=t=>{const{color:e,fontSize:i,classes:r}=t,n={root:["root",e!=="inherit"&&`color${Nl(e)}`,`fontSize${Nl(i)}`]};return E_(n,PXe,r)},kXe=Yh("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:i}=t;return[e.root,i.color!=="inherit"&&e[`color${Nl(i.color)}`],e[`fontSize${Nl(i.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var i,r,n,s,o,a,l,u,c,h,d,p,f;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(i=t.transitions)==null||(r=i.create)==null?void 0:r.call(i,"fill",{duration:(n=t.transitions)==null||(n=n.duration)==null?void 0:n.shorter}),fontSize:{inherit:"inherit",small:((s=t.typography)==null||(o=s.pxToRem)==null?void 0:o.call(s,20))||"1.25rem",medium:((a=t.typography)==null||(l=a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem",large:((u=t.typography)==null||(c=u.pxToRem)==null?void 0:c.call(u,35))||"2.1875rem"}[e.fontSize],color:(h=(d=(t.vars||t).palette)==null||(d=d[e.color])==null?void 0:d.main)!=null?h:{action:(p=(t.vars||t).palette)==null||(p=p.action)==null?void 0:p.active,disabled:(f=(t.vars||t).palette)==null||(f=f.action)==null?void 0:f.disabled,inherit:void 0}[e.color]}}),zoe=se.forwardRef(function(e,i){const r=ub({props:e,name:"MuiSvgIcon"}),{children:n,className:s,color:o="inherit",component:a="svg",fontSize:l="medium",htmlColor:u,inheritViewBox:c=!1,titleAccess:h,viewBox:d="0 0 24 24"}=r,p=Ts(r,TXe),f=se.isValidElement(n)&&n.type==="svg",m=Ut({},r,{color:o,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:c,viewBox:d,hasSvgAsChild:f}),g={};c||(g.viewBox=d);const y=RXe(m);return U.jsxs(kXe,Ut({as:a,className:Oo(y.root,s),focusable:"false",color:u,"aria-hidden":h?void 0:!0,role:h?"img":void 0,ref:i},g,p,f&&n.props,{ownerState:m,children:[f?n.props.children:n,h?U.jsx("title",{children:h}):null]}))});zoe.muiName="SvgIcon";const OY=zoe;function tR(t,e){function i(r,n){return U.jsx(OY,Ut({"data-testid":`${e}Icon`,ref:n},r,{children:t}))}return i.muiName=OY.muiName,se.memo(se.forwardRef(i))}const UY=tR(U.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage"),NY=tR(U.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage"),FY=tR(U.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),zY=tR(U.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),DXe=["className","color","component","components","disabled","page","selected","shape","size","slots","type","variant"],Hoe=(t,e)=>{const{ownerState:i}=t;return[e.root,e[i.variant],e[`size${Nl(i.size)}`],i.variant==="text"&&e[`text${Nl(i.color)}`],i.variant==="outlined"&&e[`outlined${Nl(i.color)}`],i.shape==="rounded"&&e.rounded,i.type==="page"&&e.page,(i.type==="start-ellipsis"||i.type==="end-ellipsis")&&e.ellipsis,(i.type==="previous"||i.type==="next")&&e.previousNext,(i.type==="first"||i.type==="last")&&e.firstLast]},IXe=t=>{const{classes:e,color:i,disabled:r,selected:n,size:s,shape:o,type:a,variant:l}=t,u={root:["root",`size${Nl(s)}`,l,o,i!=="standard"&&`color${Nl(i)}`,i!=="standard"&&`${l}${Nl(i)}`,r&&"disabled",n&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[a]],icon:["icon"]};return E_(u,J7e,e)},LXe=Yh("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:Hoe})(({theme:t,ownerState:e})=>Ut({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,height:"auto",[`&.${gl.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},e.size==="small"&&{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},e.size==="large"&&{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)})),BXe=Yh(CXe,{name:"MuiPaginationItem",slot:"Root",overridesResolver:Hoe})(({theme:t,ownerState:e})=>Ut({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,[`&.${gl.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${gl.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${gl.selected}`]:{backgroundColor:(t.vars||t).palette.action.selected,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:ky(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${gl.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:ky(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},[`&.${gl.disabled}`]:{opacity:1,color:(t.vars||t).palette.action.disabled,backgroundColor:(t.vars||t).palette.action.selected}}},e.size==="small"&&{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"},e.size==="large"&&{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)},e.shape==="rounded"&&{borderRadius:(t.vars||t).shape.borderRadius}),({theme:t,ownerState:e})=>Ut({},e.variant==="text"&&{[`&.${gl.selected}`]:Ut({},e.color!=="standard"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main,"&:hover":{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}},[`&.${gl.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e.color].dark}},{[`&.${gl.disabled}`]:{color:(t.vars||t).palette.action.disabled}})},e.variant==="outlined"&&{border:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${gl.selected}`]:Ut({},e.color!=="standard"&&{color:(t.vars||t).palette[e.color].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:ky(t.palette[e.color].main,.5)}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.activatedOpacity})`:ky(t.palette[e.color].main,t.palette.action.activatedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:ky(t.palette[e.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${gl.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:ky(t.palette[e.color].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity)}},{[`&.${gl.disabled}`]:{borderColor:(t.vars||t).palette.action.disabledBackground,color:(t.vars||t).palette.action.disabled}})})),OXe=Yh("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(t,e)=>e.icon})(({theme:t,ownerState:e})=>Ut({fontSize:t.typography.pxToRem(20),margin:"0 -8px"},e.size==="small"&&{fontSize:t.typography.pxToRem(18)},e.size==="large"&&{fontSize:t.typography.pxToRem(22)})),UXe=se.forwardRef(function(e,i){const r=ub({props:e,name:"MuiPaginationItem"}),{className:n,color:s="standard",component:o,components:a={},disabled:l=!1,page:u,selected:c=!1,shape:h="circular",size:d="medium",slots:p={},type:f="page",variant:m="text"}=r,g=Ts(r,DXe),y=Ut({},r,{color:s,disabled:l,selected:c,shape:h,size:d,type:f,variant:m}),v=Z7e(),b=IXe(y),A=(v.direction==="rtl"?{previous:p.next||a.next||zY,next:p.previous||a.previous||FY,last:p.first||a.first||UY,first:p.last||a.last||NY}:{previous:p.previous||a.previous||FY,next:p.next||a.next||zY,first:p.first||a.first||UY,last:p.last||a.last||NY})[f];return f==="start-ellipsis"||f==="end-ellipsis"?U.jsx(LXe,{ref:i,ownerState:y,className:Oo(b.root,n),children:""}):U.jsxs(BXe,Ut({ref:i,ownerState:y,component:o,disabled:l,className:Oo(b.root,n)},g,{children:[f==="page"&&u,A?U.jsx(OXe,{as:A,ownerState:y,className:b.icon}):null]}))}),NXe=UXe,FXe=["boundaryCount","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"],zXe=t=>{const{classes:e,variant:i}=t;return E_({root:["root",i],ul:["ul"]},X7e,e)},HXe=Yh("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:i}=t;return[e.root,e[i.variant]]}})({}),GXe=Yh("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(t,e)=>e.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function VXe(t,e,i){return t==="page"?`${i?"":"Go to "}page ${e}`:`Go to ${t} page`}const jXe=se.forwardRef(function(e,i){const r=ub({props:e,name:"MuiPagination"}),{boundaryCount:n=1,className:s,color:o="standard",count:a=1,defaultPage:l=1,disabled:u=!1,getItemAriaLabel:c=VXe,hideNextButton:h=!1,hidePrevButton:d=!1,renderItem:p=M=>U.jsx(NXe,Ut({},M)),shape:f="circular",showFirstButton:m=!1,showLastButton:g=!1,siblingCount:y=1,size:v="medium",variant:b="text"}=r,_=Ts(r,FXe),{items:A}=K7e(Ut({},r,{componentName:"Pagination"})),S=Ut({},r,{boundaryCount:n,color:o,count:a,defaultPage:l,disabled:u,getItemAriaLabel:c,hideNextButton:h,hidePrevButton:d,renderItem:p,shape:f,showFirstButton:m,showLastButton:g,siblingCount:y,size:v,variant:b}),E=zXe(S);return U.jsx(HXe,Ut({"aria-label":"pagination navigation",className:Oo(E.root,s),ownerState:S,ref:i},_,{children:U.jsx(GXe,{className:E.ul,ownerState:S,children:A.map((M,R)=>U.jsx("li",{children:p(Ut({},M,{color:o,"aria-label":c(M.type,M.page,M.selected),shape:f,size:v,variant:b}))},R))})}))}),WXe=jXe,qXe=h7e({createStyledComponent:Yh("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>ub({props:t,name:"MuiStack"})}),XXe=qXe;function YXe(){const{setPage:t,setPrevious:e,pageNumber:i,setPageNumber:r,pageLength:n}=s4(a=>a),s=o4(a=>a.setExerciseIndex),o=(a,l)=>{r(l),e(l),t(l),s(null)};return U.jsx(XXe,{spacing:9,alignItems:"center",children:U.jsx(WXe,{count:n,page:i,onChange:o})})}const KXe=t=>{const{exercises:e}=t,{exerciseIndex:i,setExerciseIndex:r}=o4(a=>a),{page:n,previous:s}=s4(a=>a),o=a=>{r(a)};return U.jsx(U.Fragment,{children:U.jsxs("ul",{className:"exercise-list",children:[e.slice(s,n).map((a,l)=>U.jsx("li",{className:`list-item ${i===l?"active":""}`,bindex:l,onClick:()=>o(l),children:a.name},a.name+a.id)),e.length===0&&"No exercises :["||U.jsx(YXe,{})]})})},JXe=()=>{var d;const{partSelected:t,setPartSelected:e}=a4(p=>p),[i,r]=se.useState([]),[n,s]=se.useState("any"),{exerciseIndex:o,setExerciseIndex:a}=o4(p=>p),{reset:l,setPageLength:u}=s4(p=>p),c=(p,f="any",m="any")=>d9e.filter(g=>g.bodyPart===p&&(f==="any"||g.equipment===f)&&(m==="any"||g.target===m)),h=p=>{s(p.target.value)};return se.useEffect(()=>{if(t!=="none"){console.log("buh"+t);const p=c(t,n);a(null),r(p),u(Math.ceil(p.length/6))}},[t,n]),U.jsx(U.Fragment,{children:U.jsxs("div",{className:"flex flex-col",children:[U.jsx("div",{children:U.jsx(KXe,{exercises:i})}),U.jsx("div",{className:"flex justify-center items-center rounded-sm shadow-md p-5 max-h-full text-white font-semibold bg-green-500 ",style:{display:"flex"},children:U.jsx("p",{children:o!==null&&((d=i[o])==null?void 0:d.instructions)})}),U.jsx("div",{className:"w-full",children:U.jsx("form",{className:"w-full",children:U.jsxs("select",{className:"w-full",id:"equipment",name:"equipment",defaultValue:"any",onChange:h,children:[U.jsx("option",{value:"any",children:"any"}),U.jsx("option",{value:"body weight",children:"body weight"}),U.jsx("option",{value:"medicine ball",children:"medicine ball"}),U.jsx("option",{value:"stability ball",children:"stability ball"}),U.jsx("option",{value:"band",children:"band"}),U.jsx("option",{value:"dumbbell",children:"dumbbell"}),U.jsx("option",{value:"kettlebell",children:"kettlebell"}),U.jsx("option",{value:"resistance band",children:"resistance band"}),U.jsx("option",{value:"wheel roller",children:"wheel roller"})]})})})]})})},QXe=({rotationX:t})=>{const e=se.useRef();let i=se.useRef(0);return toe((r,n)=>{e.current&&(e.current.rotation.y=t,e.current.rotation.x=0,i.current+=n,i.current>1&&(i.current=0))}),U.jsx(c9e,{ref:e})};function ZXe(){const[t,e]=se.useState(0),{partSelected:i,setPartSelected:r}=a4(o=>o),{currentUser:n}=se.useContext(Yo),s=o=>{e(o)};return U.jsxs(U.Fragment,{children:[U.jsx(a_,{currentUser:n}),U.jsx("div",{className:"relative w-screen h-screen flex items-center justify-center",children:U.jsxs("div",{className:"w-full h-screen grid grid-cols-2 w-full w-3/4 gap-2 mx-12",children:[U.jsxs("div",{className:"max-w-full max-h-screen",children:[U.jsx("div",{className:"z-10 w-full text-white flex justify-center items-center font-semibold text-5xl",children:U.jsx("h5",{className:"pt-12",style:{position:"absolute",zIndex:2},children:i})}),U.jsxs(b8e,{children:[U.jsx("ambientLight",{intensity:1.4}),U.jsxs(se.Suspense,{fallback:null,children:[U.jsx("color",{attach:"background",args:["#101010"]}),U.jsx(QXe,{rotationX:t})]}),U.jsx(T8e,{position:[0,-3,0],center:!0,children:U.jsx("div",{style:{marginTop:"50px",width:"300px",fontSize:"10px",borderRadius:"5px"},className:"flex justify-center items-center",children:U.jsx("input",{type:"range",min:-Math.PI,max:Math.PI,step:.01,value:t,onChange:o=>s(parseFloat(o.target.value)),style:{maxWidth:"200px"}})})})]})]}),U.jsx(JXe,{})]})})]})}const $Xe="/assets/MarcyHeadshots-128 (1)-4ea87973.jpg";function eYe(){xUe(r=>r.workout);const t=[26.6],{currentUser:e}=se.useContext(Yo),i=({target:r})=>{const[n,s]=se.useState(0),o=9e3;return se.useEffect(()=>{const a=r/o;if(n<r){const l=setTimeout(()=>s(Math.ceil(n+a)),1);return()=>clearTimeout(l)}s(r)},[n,r,o]),U.jsxs("h1",{"data-target":r,className:"counter text-9xl mt-7",children:[n.toFixed(1),"%"]})};return U.jsxs(U.Fragment,{children:[U.jsx(a_,{style:{display:"none"},currentUser:e}),U.jsxs("div",{children:[U.jsxs("div",{className:"h-screen bg-center bg-no-repeat bg-cover relative bg-red-300 z-0",children:[U.jsx(JP,{className:"h-screen bg-center bg-no-repeat bg-cover relative",scene:"https://prod.spline.design/267PHsT9Kp1A2iJ6/scene.splinecode"}),U.jsx("h1",{className:"absolute left-7 bottom-32 text-9xl mb-7",children:"Welcome to"}),U.jsxs("h1",{className:"absolute left-7 bottom-12 text-8xl",children:[U.jsx("span",{className:"text-red-600",children:"Health Sync"}),U.jsx("span",{className:"text-black",children:"."})]})]}),U.jsxs("div",{className:"h-[1000px] bg-white text-lg",children:[U.jsx("div",{className:"relative top-32 left-0 ml-28 font-bold text-2xl w-50",children:U.jsx("p",{children:"So, why did we decide to make this website?"})}),U.jsx("div",{className:"relative top-44 left-0 ml-28 font-sm text-4xl max-w-[1750px] font-bold leading-loose",children:U.jsx("h1",{children:"At HealthSync, our mission is to empower individuals in Brooklyn on their fitness journey by fostering a community-driven platform focused on exercise events, education, and personal growth."})}),U.jsx("div",{className:"relative top-64 left-0 ml-20 font-sm text-3xl leading-loose",children:U.jsx("img",{className:"rounded-sm",src:"https://images.pexels.com/photos/944690/pexels-photo-944690.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260",alt:"Smiley face",width:"900",height:"900"})})]}),U.jsxs("div",{className:"h-[1580px] bg-red-100 text-lg",children:[U.jsx("div",{className:"relative top-28 left-0 ml-40 text-lg font-medium w-50",children:U.jsxs("div",{className:"font-medium",children:[U.jsx("p",{className:"text-gray-500 text-2xl",children:"The Problem."}),U.jsx("h1",{className:" text-9xl mt-7 text-red-600",children:t.map((r,n)=>U.jsx(i,{target:r},n))}),U.jsx("p",{className:"text-5xl",children:" Of Brooklyn is considered obese "}),U.jsx("p",{className:"text-4xl mt-12 leading-loose w-11/12",children:"Brooklyn, a vibrant borough in New York City, grapples with higher obesity rates compared to many other neighborhoods. At HealthSync, we recognize the unique obstacles faced by Brooklynites on their wellness journeys. The lack of community support and motivation often hinders individuals from kickstarting and sustaining their fitness endeavors. Additionally, accessing reliable information that aligns with their lifestyle can be a challenge."})]})}),U.jsx("div",{className:"relative top-36 mt-3 left-0 font-medium text-xl",style:{width:"98vw",marginLeft:"-calc((-100vw + 100%) / 2)",marginRight:"-calc((-100vw + 100%) / 2)"},children:U.jsxs("section",{className:"early",children:[U.jsx("article",{children:U.jsx("p",{className:"right",children:"A study by the U.S. Centers for Disease Control and Prevention (CDC) revealed an alarming increase in obesity among American children and teenagers during the COVID-19 pandemic. Before the pandemic, children who were a healthy weight gained an average of 3.4 pounds per year. However, during the pandemic, this increased to 5.4 pounds. The rate of obesity rose significantly in kids aged 6 to 11, who were more dependent on their parents and may have been affected when schools suspended in-person classes."})}),U.jsxs("article",{children:[U.jsx("p",{className:"left",children:"A study released by the National Institute on Aging in 2022 highlighted that obesity rates among adults over 65 have doubled since the 1990s. Obesity is now the second leading cause of preventable death in the United States, with an estimated annual toll as high as 400,000."}),U.jsxs("p",{className:"right",children:["According to recent state Department of Health figures, nearly 59% of adults in Brooklyn are either overweight or obese. This startling statistic has prompted legislative efforts, such as Senator Kirsten Gillibrands proposal to ban trans-fats in public schools to combat childhood obesity, which often leads to adult obesity."," "]})]}),U.jsxs("article",{children:[U.jsxs("marquee",{behavior:"scroll",direction:"left",children:["According to recent state Department of Health figures, nearly 59% of adults in Brooklyn are either overweight or obese. This startling statistic has prompted legislative efforts, such as Senator Kirsten Gillibrands proposal to ban trans-fats in public schools to combat childhood obesity, which often leads to adult obesity."," "]}),U.jsx("marquee",{behavior:"scroll",direction:"right",children:"A study by the U.S. Centers for Disease Control and Prevention (CDC) revealed an alarming increase in obesity among American children and teenagers during the COVID-19 pandemic. Before the pandemic, children who were a healthy weight gained an average of 3.4 pounds per year. However, during the pandemic, this increased to 5.4 pounds. The rate of obesity rose significantly in kids aged 6 to 11, who were more dependent on their parents and may have been affected when schools suspended in-person classes."})]})]})})]}),U.jsxs("div",{className:"h-[890px] bg-white text-lg",children:[U.jsxs("div",{className:"mt-10 ml-40",children:[U.jsx("p",{className:"text-gray-500 text-2xl ",children:"Who we Serve."}),U.jsx("p",{className:"text-4xl mt-5 leading-loose w-11/12",children:"Our service is tailored for individuals in Brooklyn who are new to fitness, particularly those with little to no prior exercise experience or knowledge, offering a nurturing community, easy-to-follow guidance, and accessible resources to confidently embark on their fitness journey."})]}),U.jsx("div",{className:"relative top-16 left-0 font-sm text-3xl leading-loose ml-20",children:U.jsx("img",{className:"rounded-sm",src:"https://nationworldnews.com/wp-content/uploads/2023/03/Why-is-the-US-the-most-obese-country-in-the.jpg",alt:"Smiley face",width:"500",height:"500"})})]}),U.jsx("div",{className:"h-[100%] bg-red-100 text-lg",children:U.jsxs("div",{className:"mt-28 ml-20 mr-20 font-semibold text-lg w-50 pb-28",children:[U.jsx("p",{className:"text-5xl pt-28 pb-20",children:"Meet the Founders."}),U.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-20 max-w-full",children:[U.jsxs("div",{className:"flex flex-col max",children:[U.jsx("div",{className:" w-full",children:U.jsx("img",{className:"rounded-lg",width:"full",height:"full",src:yie,alt:"Sammy"})}),U.jsxs("div",{className:"flex flex-col text-center",children:[U.jsxs("p",{children:[U.jsx("a",{href:"",target:"_blank",rel:"noopener noreferrer",className:"founder-link"}),"Marvin Siri"]}),U.jsxs("p",{className:"text-black",children:["Full-Stack Developer &"," ",U.jsx("span",{className:"text-red-600",children:"Scrum Master"})]})]})]}),U.jsxs("div",{className:"flex flex-col max",children:[U.jsx("div",{className:" w-full",children:U.jsx("img",{className:"rounded-lg",width:"full",height:"full",src:gie,alt:"Sammy"})}),U.jsxs("div",{className:"flex flex-col text-center",children:[U.jsxs("p",{children:[U.jsx("a",{href:"",target:"_blank",rel:"noopener noreferrer",className:"founder-link"}),"Samuel Pickering"]}),U.jsx("p",{className:"text-black",children:"Backend Developer"})]})]}),U.jsxs("div",{className:"flex flex-col max",children:[U.jsx("div",{className:" w-full",children:U.jsx("img",{className:"rounded-lg",width:"full",height:"full",src:vie,alt:"Sammy"})}),U.jsxs("div",{className:"flex flex-col text-center",children:[U.jsxs("p",{children:[U.jsx("a",{href:"",target:"_blank",rel:"noopener noreferrer",className:"founder-link"}),"Ajene Barton"]}),U.jsx("p",{className:"text-black",children:"Full-Stack Developer"})]})]}),U.jsxs("div",{className:"flex flex-col max",children:[U.jsx("div",{className:" w-full",children:U.jsx("img",{className:"rounded-lg",width:"full",height:"full",src:$Xe,alt:"Sammy"})}),U.jsxs("div",{className:"flex flex-col text-center",children:[U.jsxs("p",{children:[U.jsx("a",{href:"",target:"_blank",rel:"noopener noreferrer",className:"founder-link"}),"Kory Telesford"]}),U.jsx("p",{className:"text-black",children:"Front End Developer"})]})]})]})]})})]})]})}function tYe(){const{currentUser:t}=se.useContext(Yo),[e,i]=se.useState({}),{eventid:r}=yF(),[n,s]=se.useState(0),[o,a]=se.useState(!1),[l,u]=se.useState("Loading..."),[c,h]=se.useState({}),d=Op();se.useEffect(()=>{(async()=>{const R=await NOe(r);h(R)})()},[r]);const p=async()=>{if(t){const M=await n4(t.id),R={};M.forEach(C=>{R[C.id]=!0}),i(R)}};se.useEffect(()=>{p()},[t]);const f=c&&c.tag_names?c.tag_names.split(",").map(M=>M.trim()):[],m=new Date(c.date).toLocaleString("en-US",i4),g=new Date(c.end_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),y=async()=>{const M=t.id,R=c.id;if(!(c.id in e))await r4({user_id:M,event_id:R});else{await sie({user_id:M,event_id:R});const C=await jO(R);s(C),lie(c.user_id,M)}setTimeout(async()=>{await p()},100),setTimeout(async()=>{const C=await jO(c.id);s(C)},160),aie({event_id:R,recipient_id:c.user_id,attendee_id:M,text:`
    ${t.name} joined Event ${c.title}`})},v=()=>e[c.id]?!0:c.location==="Online Class"&&c.attendee_count<4||c.location!=="Online Class"&&U.jsx("p",{children:"No"}),b=()=>{const M=new Date().getTime(),R=new Date(c.date).getTime(),C=3e5;return R-M<=C?U.jsx(Zd,{className:"flex w-full justify-center rounded-md bg-red-600 px-3 py-3 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",style:{borderRadius:"5px",background:"linear-gradient(225deg, #FED7AA, #F97316)",transition:"boxShadow 0.3s ease-in-out"},to:`/room/${c.user_id}`,children:"Link to online room"}):U.jsx("p",{children:"Your Link to the meeting will appear 5 minutes before the event."})};b();const _=()=>c.location==="Online Class"?U.jsx("div",{className:"w-full flex justify-center items-center mt-8",children:U.jsx("p",{className:"font-semibold",children:" This is an Online Class "})}):c&&o&&c.location!=="Online Class"?l:U.jsx(YOe,{location:c.location}),A=()=>{const M=t&&t.id===c.user_id,R=e[c.id];if(c.location==="Online Class")return M||R?b():U.jsx("p",{})},S=async()=>{QP({event_id:c.id}),d("/community")},E={borderRadius:"10px",background:"#e0e0e0",boxShadow:"inset -20px 20px 60px #bebebe, inset 20px -20px 60px #ffffff",width:"100%",height:"80%",color:"white",padding:"10px 15px",border:"none",cursor:"not-allowed",fontSize:"14px",transition:"background 1ms ease-in"};return U.jsxs(U.Fragment,{children:[U.jsx(a_,{currentUser:t}),U.jsxs("div",{className:"p-24 pt-20",children:[U.jsxs("h1",{className:"text-3xl font-medium mt-2",children:[" ",c.title," "]}),U.jsx("img",{src:nie(c.location),alt:"Image for event location",className:"w-full h-96 object-cover rounded-lg shadow-md mb-4 mt-7"}),U.jsxs("div",{className:"grid grid-cols-3 mt-8",children:[U.jsxs("div",{className:"col-span-2",children:[U.jsxs("h2",{className:"text-xl font-medium",children:[" ",c.location," "]}),U.jsxs("h3",{className:"text-md font-regular text-gray-500",children:[m," - ",g]}),U.jsxs("div",{className:"flex flex-row mt-7",children:[U.jsx("div",{className:"max-w-20 max-h-20 flex justify-center",children:U.jsx("img",{className:"rounded-full",src:`../upload/${c.user_profile_pic||"default.jpg"}`,width:"full",height:"full"})}),U.jsx("div",{className:"flex justify-center items-center font-medium ml-2",children:U.jsxs("p",{children:[" Hosted by ",c.user_name," "]})})]}),U.jsx("div",{className:"mt-8 h-0.5 w-5/6   bg-gray-100"}),U.jsx("div",{className:"max-w-2xl mt-5 font-normal leading-loose overflow-auto break-words",children:U.jsx("p",{children:c.description?c.description:"No Description"})})]}),U.jsxs("div",{className:"w-full h-full sticky rounded-lg border border-gray-200 p-5 shadow-md font-medium text-white",children:[U.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(M=>U.jsx("div",{className:"bg-yellow-600  rounded-full w-10/12 h-7 text-sm",children:U.jsxs("p",{className:"text-center justify-center mt-1",children:[" ",M," "]})},M))}),U.jsxs("p",{className:"text-black mt-5",children:["Attendents: ",n||c.attendee_count,c.location==="Online Class"&&U.jsx("span",{children:"/4"}),c.attendee_count>3&&c.location==="Online Class"&&U.jsx("span",{children:" No open spots available"})]}),U.jsxs("div",{className:"mt-5",children:[t&&t.id!==c.user_id&&c.id&&v()?U.jsx(uie,{joinEvent:y,eventId:c.id,joinedEvents:e}):c.location==="Online Class"?U.jsx("div",{className:"flex justify-center items-center text-black",children:c&&A()}):U.jsx("button",{style:E,children:U.jsx("p",{className:"font-bold",children:" Your Event "})}),U.jsx("div",{className:"w-full flex justify-center items-center mt-5",children:t&&t.id===c.user_id?U.jsx("button",{className:"text-red-500",onClick:S,children:"Delete Event"}):U.jsx("p",{})}),U.jsxs("p",{className:"text-black justify-center text-center mt-5 text-sm",children:[" ","Remember, don't over exert yourself."]})]})]})]}),U.jsx("div",{className:"mt-20 h-0.5  w-full   bg-gray-100"}),U.jsx("div",{className:"grid grid-cols-2"}),t&&U.jsx(XOe,{eventId:c.id,userId:t.id}),U.jsx("div",{className:"mt-20 h-0.5  w-full   bg-gray-100"}),U.jsx("h2",{className:"mt-8 text-2xl font-semibold",children:" Event Location "}),c&&_()]})]})}function iYe(){const{setCurrentUser:t}=se.useContext(Yo);return se.useEffect(()=>{TUe().then(t)},[t]),U.jsx(U.Fragment,{children:U.jsx("main",{children:U.jsxs(Whe,{children:[U.jsx(sh,{path:"/",element:U.jsx(jUe,{})}),U.jsx(sh,{path:"/dev",element:U.jsx(GUe,{})}),U.jsx(sh,{path:"/community",element:U.jsx(CUe,{})}),U.jsx(sh,{path:"/workouts",element:U.jsx(ZXe,{})}),U.jsx(sh,{path:"/about",element:U.jsx(eYe,{})}),U.jsx(sh,{path:"/users/:id",element:U.jsx(HUe,{})}),U.jsx(sh,{path:"/room/:roomid",element:U.jsx(DFe,{})}),U.jsx(sh,{path:"/event/:eventid",element:U.jsx(tYe,{})}),U.jsx(sh,{path:"*",element:U.jsx(PUe,{})})]})})})}function rYe({children:t}){const[e,i]=se.useState(null),r={currentUser:e,setCurrentUser:i};return U.jsx(Yo.Provider,{value:r,children:t})}XI.createRoot(document.getElementById("root")).render(U.jsx(rYe,{children:U.jsx(Jhe,{children:U.jsx(kFe,{children:U.jsx(iYe,{})})})}))});export default nYe();
